var projects={default:{languages:["en","fr","ru","de","es","pt","it","nl","ar","ja","ko","tr","zh","pl","lv"],dictionaries:{common_json:"cleverapps/utils/localization/common_${lang}.json",project_json:"res/localization/${lang}.json"},merge:{dictionaries:{quests_json:"res/localization/quests/quests_${lang}.json"}},homefix:{dictionaries:{farm_json:"res/localization/homefix/homefix_${lang}.json"}},farm:{dictionaries:{farm_json:"res/localization/farm/farm_${lang}.json"}},solitaire:{dictionaries:{solitaire_json:"cleverapps/utils/localization/solitaire/${lang}.json"}},match3:{dictionaries:{lang_json:"match3/res/localization/match3_${lang}.json",skin_json:"match3/res/localization/skins/${skin}/${skin}_${lang}.json"}},board:{dictionaries:{lang_json:"cleverapps/utils/localization/boardgame/boardgame_${lang}.json"},languages:["en","fr","ru","de","es","it","ja","nl"]},leagues:[30,60,100,200,500,1e3,!1],terms:"https://cleverappssg.com/legal/terms.html",
privacy:"https://cleverappssg.com/legal/privacy.html"},mergecraft:{basic:{type:"merge",metha:"none",orientation:"horizontal",staticUrl:"https://mergecraft.cleverappssg.com/publish/html5/",xsollaProjectId:"134757",xsollaLoginProject:"9e48b5cc-b306-11eb-bc85-42010aa80004",fbPixelId:"321147649405995",deployment:"https://mergecraft.cleverappssg.com",title:"MergeCraft",fakeRestApiURL:"http://localhost:3006",lives:!0,levelEditor:!0,adjust:{token:"4ck88u210vr4",purchaseToken:"2hfeqa",events:{ad_finish_rewarded:"m79fh4",ad_start_interstitial:"p0abbk",retention_2:"qa22qa",retention_7:"w2b0ti"}},stand:{staticUrl:"https://mergecraft-staging.labsystech.ru/publish/html5-staging/",deployment:"https://mergecraft-staging.labsystech.ru",xsollaLoginProject:"9b99f537-af3a-11eb-bc85-42010aa80004"},fonts:[{folder:"marvin-round-nostroke",name:"nostroke",bundle:"digits",size:62},{folder:"marvin-round",name:"default",bundle:"digits",size:45},{folder:"marvin-round",name:"default",bundle:"digits",size:62},{
folder:"marvin-round",name:"default",bundle:"digits",size:76},{folder:"formal",name:"formal",bundle:"admin",size:21}]},instant:{appId:"126844939376182",rewarded:"129195502474459",interstitial:"129195289141147",groupId:"110350677808060"},facebook:{shortname:"mergecraft",appId:"365815270676633",groupId:"mergecraftgroup",gameroom_rate_postId:"",dontLikeGameUrl_postId:"",stand:{appId:"386728805962593"}},mbga:{appId:"12026923",groupId:""},vk:{shortname:"mergecraft",appId:"7776586",groupId:"mergecraft_group",stand:{appId:"7776276"}},ok:{shortname:"mergecraft",appId:"512000742814",appKey:"CPJGFQJGDIHBABABA",groupId:"60620856950954",stand:{appId:"512000870791",appKey:"CIIKECKGDIHBABABA"}},android:{package:"com.cleverapps.mergecraft",unityGameId:""},amazon:{package:"com.cleverapps.mergecraft",id:"B0922VXRPZ"},ios:{id:"com.cleverapps.mergecraft",id:"1562149254"},mm:{appId:"783650",privateKey:"34f0c62fb0e1d0ac35d00c75acbe6cb5",groupId:"mergecraft",stand:{appId:"",privateKey:""}},fotostrana:{
appId:"mergecraft",privateKey:"33af4305d7414b380c3636f3b03fb70f",groupId:"352927",stand:{appId:"",privateKey:""}},plinga:{appId:"b5203bfef51242c39690c761321d769f"}},wondermerge:{basic:{type:"merge",metha:"none",title:"WonderMerge",fakeRestApiURL:"http://localhost:3012",languages:["en"],adjust:{token:"",purchaseToken:"",events:{}},stand:{staticUrl:"https://wondermerge-staging.labsystech.ru/publish/html5-staging/",deployment:"https://wondermerge-staging.labsystech.ru"}},facebook:{shortname:"cleverwondermerge",appId:"699542957221997",groupId:"rachelholmesfinddifferences",gameroom_rate_postId:"",dontLikeGameUrl_postId:"",stand:{appId:"597596791051962"}},android:{package:"",unityGameId:""},amazon:{package:"",id:""},ios:{id:""}},mergeriddles:{basic:{type:"match3",metha:"simple",staticUrl:"https://mergecraft.cleverappssg.com/publish/html5/",deployment:"https://mergecraft.cleverappssg.com",title:"MergeRiddles",lives:!0,fakeRestApiURL:"http://localhost:3015",languages:["en"],adjust:{token:"",
purchaseToken:"",events:{}},stand:{staticUrl:"https://mergecraft-staging.labsystech.ru/publish/html5-staging/",deployment:"https://mergecraft-staging.labsystech.ru"}},facebook:{shortname:"mergecraft",appId:"365815270676633",groupId:"MergeCraft-Community-104474434917397",gameroom_rate_postId:"",dontLikeGameUrl_postId:"",stand:{appId:"386728805962593"}},android:{package:"",unityGameId:""},amazon:{package:"",id:""},ios:{id:""}},mergeheroes:{basic:{type:"match3",metha:"simple",staticUrl:"https://wondermerge.cleverappssg.com/publish/html5/",deployment:"https://wondermerge.cleverappssg.com",title:"MergeHeroes",lives:!0,fakeRestApiURL:"http://localhost:3016",languages:["en"],adjust:{token:"",purchaseToken:"",events:{}},stand:{staticUrl:"https://wondermerge-staging.labsystech.ru/publish/html5-staging/",deployment:"https://wondermerge-staging.labsystech.ru"}},facebook:{shortname:"cleverwondermerge",appId:"699542957221997",groupId:"WonderMerge-Community-105125691516212",gameroom_rate_postId:"",
dontLikeGameUrl_postId:"",stand:{appId:"597596791051962"}},android:{package:"",unityGameId:""},amazon:{package:"",id:""},ios:{id:""}},wordheaps:{basic:{type:"board",subtype:"stacks",metha:"simple",staticUrl:"https://wordheaps.cleverappssg.com/publish/html5/",deployment:"https://wordheaps.cleverappssg.com",title:"WordHeaps",fakeRestApiURL:"http://localhost:3013",adjust:{token:"",purchaseToken:"",events:{}},stand:{staticUrl:"https://wordheaps-staging.labsystech.ru/publish/html5-staging/",deployment:"https://wordheaps-staging.labsystech.ru"},fonts:[{folder:"neris-black",name:"default",bundle:"digits",size:40},{folder:"neris-black",name:"default",bundle:"digits",size:90},{folder:"neris-black-nostroke",name:"nostroke",bundle:"digits",size:49},{folder:"neris-black-nostroke",name:"nostroke",bundle:"digits",size:90},{folder:"formal",name:"formal",bundle:"admin",size:21}]},facebook:{shortname:"cleverwordheaps",appId:"299923727721026",groupId:"wordheapscommunity",gameroom_rate_postId:"",
dontLikeGameUrl_postId:"",stand:{appId:"513633536223627"}},android:{package:"",unityGameId:""},amazon:{package:"",id:""},ios:{id:""}},differences:{basic:{type:"differences",subtype:"knockoutGame",metha:"simple",staticUrl:"https://differences.cleverappssg.com/publish/html5/",deployment:"https://differences.cleverappssg.com",title:"Differences",fakeRestApiURL:"http://localhost:3004",lives:!0,ui:"plaidui",adjust:{token:"lmk8mnhq4xs0",purchaseToken:"pnfv7v",events:{ad_finish_rewarded:"7e3jp0",ad_start_interstitial:"txnnp5"}},stand:{staticUrl:"https://differences-staging.labsystech.ru/publish/html5-staging/",deployment:"https://differences-staging.labsystech.ru"},fonts:[{folder:"russo_one",name:"default",bundle:"digits",size:35},{folder:"russo_one",name:"default",bundle:"digits",size:55},{folder:"russo_one-nostroke",name:"nostroke",bundle:"digits",size:35},{folder:"russo_one-nostroke",name:"nostroke",bundle:"digits",size:55},{folder:"formal",name:"formal",bundle:"admin",size:21}]},instant:{
appId:"466070618121604",rewarded:"466072421454757",interstitial:"466072581454741",groupId:"100462882000800"},facebook:{shortname:"cleverdifferences",appId:"278637090036923",groupId:"rachelholmesfinddifferences",gameroom_rate_postId:"",dontLikeGameUrl_postId:"",stand:{appId:"195225751884161"}},android:{package:"com.cleverapps.differences",unityGameId:""},amazon:{package:"com.cleverapps.differences",id:"B08R7PCC89"},ios:{package:"com.cleverapps.differences",id:"1546227822"},ok:{shortname:"cleverdifferences",appId:"512000594608",appKey:"CBLDBOJGDIHBABABA",groupId:"58829738606762",stand:{appId:"512000589370",appKey:"CLDPPNJGDIHBABABA"}},vk:{shortname:"cleverdifferences",appId:"7605538",groupId:"differences_group",stand:{appId:""}},mm:{appId:"782111",privateKey:"44828036769062a2148cbf76f6bd33d6",groupId:"differences",stand:{appId:"",privateKey:""}},mbga:{appId:"",groupId:""},nk:{appId:"",groupId:""},draugiem:{appId:"",groupId:""},fotostrana:{appId:"differences",
privateKey:"5b1ff4ce4c7e274ae98bf394d8d6dd37",groupId:"352931",stand:{appId:"",privateKey:""}},plinga:{appId:"120653a94b0a48cf9050fff4a258f5cf"}},tripeaks:{basic:{type:"solitaire",metha:"simple",staticUrl:"https://tripeaks.cleverappssg.com/publish/html5/",deployment:"https://tripeaks.cleverappssg.com",title:"Kings & Queens: Solitaire Tri Peaks",fakeRestApiURL:"http://localhost:3002",lives:!0,levelEditor:!0,adjust:{token:"ng66lafe248w",purchaseToken:"6nlpft",events:{ad_finish_rewarded:"zculm1",ad_start_interstitial:"yxw2sg"}},stand:{staticUrl:"https://tripeaks-staging.labsystech.ru/publish/html5-staging/",deployment:"https://tripeaks-staging.labsystech.ru"},leagues:[30,60,100,200,500,!1],fonts:[{folder:"carlito-bold-v2-2px",name:"default",bundle:"digits",size:35},{folder:"carlito-bold-v2-2px",name:"default",bundle:"digits",size:65},{folder:"carlito-bold-v2-nostroke",name:"nostroke",bundle:"digits",size:35},{folder:"carlito-bold-v2-nostroke",name:"nostroke",bundle:"digits",size:65},{
folder:"formal",name:"formal",bundle:"admin",size:21}]},instant:{appId:"582264172486698",rewarded:"583410035705445",interstitial:"583409625705486",groupId:"102297708232957"},facebook:{shortname:"tripeakscard",appId:"1079919015696954",groupId:"KingsAndQueensTripeaksCommunity",gameroom_rate_postId:"",dontLikeGameUrl_postId:"",stand:{appId:"585880102065094"}},android:{package:"com.cleverapps.tripeaks",unityGameId:""},amazon:{package:"com.cleverapps.tripeaks",id:"B08CNK8GSB"},ios:{package:"com.cleverapps.tripeaks",id:"1523134029"},ok:{shortname:"tripeaks",appId:"512000516286",appKey:"CPLBOMJGDIHBABABA",groupId:"58210808561834",stand:{appId:"512000567965",appKey:"COJLKNJGDIHBABABA"}},vk:{shortname:"tripeaks",appId:"7522400",groupId:"tripeaks_group",stand:{appId:"7522400"}},mm:{appId:"779517",privateKey:"f5117307f5652c346c8a492698ec5520",groupId:"tripeaks",stand:{appId:"",privateKey:""}},mbga:{appId:"12026813",groupId:""},nk:{appId:"kings-queens",groupId:"1419067"},draugiem:{appId:"",
groupId:""},fotostrana:{appId:"tripeaks",privateKey:"b97e8a2478376c1d7261f87ab1b2f8aa",groupId:"352512",stand:{appId:"",privateKey:""}},plinga:{appId:"344fff78cd674f62a549533551505ebb"}},spades:{basic:{type:"solitaire",metha:"simple",lives:!0,staticUrl:"https://spades.cleverappssg.com/publish/html5/",deployment:"https://spades.cleverappssg.com",title:"Spades",fakeRestApiURL:"http://localhost:3014",languages:["en"],adjust:{token:"",purchaseToken:"",events:{}},stand:{staticUrl:"https://spades-staging.labsystech.ru/publish/html5-staging/",deployment:"https://spades-staging.labsystech.ru"}},facebook:{shortname:"cleverspades",appId:"1152275768461536",groupId:"solitairekingdomcommunity",gameroom_rate_postId:"",dontLikeGameUrl_postId:"",stand:{appId:"234186548097136"}},android:{package:"",unityGameId:""},amazon:{package:"",id:""},ios:{id:""}},riddles:{basic:{metha:"hose",type:"match3",lives:!0,staticUrl:"https://riddles.gcdn.co/publish/html5/",deployment:"https://riddles.labsystech.ru",
results:!0,title:"Candy Riddles",fakeRestApiURL:"http://localhost:3007",levelEditor:!0,adjust:{token:"7h99civw80sg",purchaseToken:"pwy8hj",events:{}},stand:{staticUrl:"https://riddles-staging.labsystech.ru/publish/html5-staging/",deployment:"https://riddles-staging.labsystech.ru"},fonts:[{folder:"riffic-bold",name:"default",bundle:"digits",size:41},{folder:"riffic-bold",name:"default",bundle:"digits",size:82},{folder:"riffic-bold-nostroke",name:"nostroke",bundle:"digits",size:41},{folder:"riffic-bold-nostroke",name:"nostroke",bundle:"digits",size:82},{folder:"formal",name:"formal",bundle:"admin",size:21},{folder:"custom/marvin_compact_digits",name:"compact_digits",bundle:"compact_digits",size:42},{folder:"custom/riddles_goals",name:"goals_font",bundle:"goals_font",size:41},{folder:"custom/riddles_levels",name:"level_digits",bundle:"level_digits",size:58}]},instant:{appId:"169228177248519",rewarded:"171407780363892",interstitial:"171665730338097",groupId:"337681893427623"},facebook:{
shortname:"candyriddles",appId:"1996120880405386",groupId:"CandyRiddlesCommunity",gameroom_rate_postId:"140958473298826",dontLikeGameUrl_postId:"145984586129548",stand:{appId:"109585006443834"}},android:{package:"com.cleverapps.candyriddles",unityGameId:"500007109"},amazon:{package:"com.cleverapps.candyriddles",id:"B078YB7FBX"},ios:{package:"com.cleverapps.riddles",id:"1340236132"},ok:{shortname:"candyriddles",appId:"1269377792",appKey:"CBAMCKKMEBABABABA",groupId:"54360798855338",stand:{appId:"1270935552",appKey:"CBABPBMMEBABABABA"}},vk:{shortname:"candy_riddles",appId:"6745237",groupId:"candyriddles",stand:{appId:"6790773"}},mm:{appId:"763558",privateKey:"832ab94c8979ec52da1ce740f71d7ad7",groupId:"candyriddles",stand:{appId:"763556",privateKey:"40f493f6966593a1f447980cd30bd92c"}},mbga:{appId:"12026417",groupId:"32844341"},nk:{appId:"candy-riddles",groupId:"1417264"},draugiem:{appId:"riddles",groupId:"riddlespage",stand:{appId:"riddlesstaging",groupId:"riddlespage"}},plinga:{
appId:"639df47033804f18bf39e113ef29f4fa"},fotostrana:{appId:"candyriddles",privateKey:"00fcabb0bbbf4de8fd200683a099dc13",groupId:"352511",stand:{appId:"",privateKey:""}}},heroes:{basic:{metha:"farm",type:"match3",lives:!0,staticUrl:"https://heroes.gcdn.co/publish/html5/",deployment:"https://heroes.cleverappssg.com",results:!0,title:"Sugar Heroes",fakeRestApiURL:"http://localhost:3008",adjust:{token:"mmimvhbjk1z4",purchaseToken:"83oly9",events:{}},stand:{staticUrl:"https://heroes-staging.labsystech.ru/publish/html5-staging/",deployment:"https://heroes-staging.labsystech.ru"},fonts:[{folder:"bryndanwrite",name:"default",bundle:"digits",size:53},{folder:"bryndanwrite",name:"default",bundle:"digits",size:90},{folder:"formal",name:"formal",bundle:"admin",size:21},{folder:"bryndanwrite-nostroke",name:"nostroke",bundle:"digits",size:74},{folder:"custom/marvin_compact_digits",name:"compact_digits",bundle:"compact_digits",size:42},{folder:"custom/heroes_goals",name:"goals_font",
bundle:"goals_font",size:60}]},instant:{appId:"2096828893670802",rewarded:"2105178429502515",interstitial:"2105484592805232",groupId:"278630749647866"},facebook:{shortname:"sugarheroes",appId:"205918406663140",groupId:"sugarheroescommunity",gameroom_rate_postId:"",dontLikeGameUrl_postId:"283957348885460",stand:{appId:"148448049182010"}},android:{package:"com.cleverapps.heroes",unityGameId:""},amazon:{package:"com.cleverapps.heroes",id:"B07JMZLTV7"},ios:{package:"com.cleverapps.heroes",id:"1439884631"},ok:{shortname:"sugarheroes",appId:"1271685376",appKey:"CBACGNMMEBABABABA",groupId:"54384511877290",stand:{appId:"512000694356",appKey:"CFFJJPJGDIHBABABA"}},vk:{shortname:"sugar_heroes",appId:"6830710",groupId:"sugarheroes",stand:{appId:""}},mm:{appId:"763582",privateKey:"8558918e7b85be33743d63b68ac7be00",groupId:"sugarheroes",stand:{appId:"",privateKey:""}},mbga:{appId:"12026480",groupId:"32846074"},nk:{appId:"sugar-heroes",groupId:"1417638"},draugiem:{appId:"sugarheroes",
groupId:"sugarheroespage"},plinga:{appId:"b24567e39b5248eabe77a704dbb555a9"},fotostrana:{appId:"sugarheroes",privateKey:"5480cd9bf57b7ed5be7f2decf8541e18",groupId:"352509",stand:{appId:"",privateKey:""}}},adventure:{basic:{metha:"hose",type:"match3",lives:!0,rpg:!0,staticUrl:"https://adventure.gcdn.co/publish/html5/",deployment:"https://adventure.cleverappssg.com",title:"Secrets of Charmland",fakeRestApiURL:"http://localhost:3010",adjust:{token:"yxn8ttu1ydj4",purchaseToken:"2th34l",events:{ad_finish_rewarded:"804ekp",ad_start_interstitial:"l647mw"}},stand:{staticUrl:"https://adventure-staging.labsystech.ru/publish/html5-staging/",deployment:"https://adventure-staging.labsystech.ru"},fonts:[{folder:"marvin-round",name:"default",bundle:"digits",size:45},{folder:"marvin-round",name:"default",bundle:"digits",size:62},{folder:"formal",name:"formal",bundle:"admin",size:21},{folder:"marvin-round-nostroke",name:"nostroke",bundle:"digits",size:62},{folder:"custom/marvin_compact_digits",
name:"compact_digits",bundle:"compact_digits",size:42}]},instant:{appId:"228942985416996",rewarded:"228947032083258",interstitial:"228947125416582",groupId:"secretsofcharmlandlite"},facebook:{shortname:"secretsofcharmland",appId:"1311019545689756",groupId:"secretsofcharmland",gameroom_rate_postId:"",dontLikeGameUrl_postId:"",stand:{appId:"247075149531781"}},android:{package:"com.cleverapps.adventure",unityGameId:""},amazon:{package:"com.cleverapps.adventure",id:"B08NXG74BD"},ios:{package:"com.cleverapps.adventure",id:"1541304616"},ok:{shortname:"secretsofcharmland",appId:"512000026303",appKey:"CQLHGFJGDIHBABABA",groupId:"56035155116202",stand:{appId:"512000646929",appKey:"CCBQNOJGDIHBABABA"}},vk:{shortname:"thesecretsofcharmland",appId:"7139584",groupId:"secretsofcharmland",stand:{appId:""}},mm:{appId:"766832",privateKey:"6f8c46ea0f3720ee03b02083db09340b",groupId:"secretsofcharmland",stand:{appId:"",privateKey:""}},mbga:{appId:"",groupId:""},nk:{appId:"secrets-of-charmland",
groupId:"1419069"},draugiem:{appId:"",groupId:""},plinga:{appId:"49d17c8657104ee2806feebe41e0f2cd"}},runes:{basic:{metha:"hose",type:"match3",lives:!0,rpg:!0,staticUrl:"https://runes.gcdn.co/publish/html5/",deployment:"https://runes.cleverappssg.com",title:"Heroes of Match-3",fakeRestApiURL:"http://localhost:3011",adjust:{token:"eolgyc1elq0w",purchaseToken:"ya20wl",events:{}},stand:{staticUrl:"https://runes-staging.labsystech.ru/publish/html5-staging/",deployment:"https://runes-staging.labsystech.ru"},fonts:[{folder:"marvin-round",name:"default",bundle:"digits",size:45},{folder:"marvin-round",name:"default",bundle:"digits",size:62},{folder:"formal",name:"formal",bundle:"admin",size:21},{folder:"marvin-round-nostroke",name:"nostroke",bundle:"digits",size:62},{folder:"custom/marvin_compact_digits",name:"compact_digits",bundle:"compact_digits",size:42}]},instant:{appId:"346516946289630",rewarded:"376156803325644",interstitial:"376156129992378",groupId:"101372134583131"},facebook:{
shortname:"heroesofmatch",appId:"582954732182317",groupId:"heroesofmatch3",gameroom_rate_postId:"",dontLikeGameUrl_postId:"",stand:{appId:"320708625483001"}},android:{package:"com.cleverapps.runes",unityGameId:""},amazon:{package:"com.cleverapps.runes",id:"B07WPW533K"},ios:{package:"com.cleverapps.runes",id:"1476535667"},ok:{shortname:"heroesofmatch",appId:"1279575808",appKey:"CBAIMFENEBABABABA",groupId:"55547515044010",stand:{appId:"512000465394",appKey:"CDPKBMJGDIHBABABA"}},vk:{shortname:"heroesofmatch",appId:"7016437",groupId:"heroes_of_match",stand:{appId:""}},mm:{appId:"765770",privateKey:"e52e74b4f487b2cccf2405816652956c",groupId:"heroesmatch3",stand:{appId:"",privateKey:""}},mbga:{appId:"12026637",groupId:"32852303"},nk:{appId:"heroes-of-match-3",groupId:"1419068"},draugiem:{appId:"",groupId:""},plinga:{appId:"bfd6c484cdd9475f895bee03e3b633ff"}},wordsoup:{basic:{staticUrl:"https://wordsoup.gcdn.co/publish/html5/",deployment:"https://wordsoup.labsystech.ru",title:"Word Sauce",
type:"board",fakeRestApiURL:"http://localhost:3000",metha:"homefix",ui:"plaidui",adjust:{token:"ez2lszhmg4xs",purchaseToken:"1ghfoq",events:{ad_finish_rewarded:"g49v7g",ad_start_interstitial:"kr85gz"}},stand:{staticUrl:"https://wordsoup-staging.labsystech.ru/publish/html5-staging/",deployment:"https://wordsoup-staging.labsystech.ru"},fonts:[{folder:"russo_one",name:"default",bundle:"digits",size:35},{folder:"russo_one",name:"default",bundle:"digits",size:55},{folder:"russo_one-nostroke",name:"nostroke",bundle:"digits",size:35},{folder:"russo_one-nostroke",name:"nostroke",bundle:"digits",size:55},{folder:"formal",name:"formal",bundle:"admin",size:21}]},instant:{appId:"177170139576790",rewarded:"194546684505802",interstitial:"194552307838573",groupId:"wordsaucelite"},facebook:{shortname:"word_soup",appId:"1839614776298283",groupId:"WordSoupPuzzle",gameroom_rate_postId:"520764398277098",dontLikeGameUrl_postId:"",stand:{appId:"1847284985531262"}},android:{package:"org.cocos2dx.wordsoup",
unityGameId:""},amazon:{package:"org.cocos2dx.wordsoup",id:"B07192HTZ9"},ios:{package:"org.cocos2dx.wordsoup",id:"1236153570"},ok:{shortname:"wordsoup",appId:"512000025924",appKey:"CFEGGFJGDIHBABABA",groupId:"56042597515434",stand:{appId:"512000436024",appKey:"CJDIKLJGDIHBABABA"}},vk:{shortname:"wordsoup",appId:"7139277",groupId:"wordsauce",stand:{appId:""}},mm:{appId:"766829",privateKey:"bce7dc4c706f1c0f9f53a38586ab0f14",groupId:"wordsauce",stand:{appId:"",privateKey:""}},mbga:{appId:"",groupId:""},nk:{appId:"word-soup",groupId:"1419071"},draugiem:{appId:"",groupId:""},plinga:{appId:"8d8965a1f1af4d2b884e0bc48737925d"},fotostrana:{appId:"wordsoup",privateKey:"ec5a95876a991b883c9c4848dde8b6d8",groupId:"352514",stand:{appId:"",privateKey:""}}},crocword:{basic:{metha:"hose",staticUrl:"https://crocword.gcdn.co/publish/html5/",deployment:"https://crocword.labsystech.ru",title:"Croc Word",type:"board",fakeRestApiURL:"http://localhost:3005",ui:"cyanui",adjust:{token:"6c299ak7zkw0",
purchaseToken:"taza3r",events:{ad_finish_rewarded:"t1g1gj",ad_start_interstitial:"w692c3"}},stand:{staticUrl:"https://crocword-staging.labsystech.ru/publish/html5-staging/",deployment:"https://crocword-staging.labsystech.ru"},fonts:[{folder:"carlito-bold-v2-2px",name:"default",bundle:"digits",size:35},{folder:"carlito-bold-v2-2px",name:"default",bundle:"digits",size:65},{folder:"carlito-bold-v2-nostroke",name:"nostroke",bundle:"digits",size:35},{folder:"carlito-bold-v2-nostroke",name:"nostroke",bundle:"digits",size:65},{folder:"formal",name:"formal",bundle:"admin",size:21}]},instant:{appId:"156455286289887",rewarded:"156461976289218",interstitial:"156462162955866",groupId:"1017684138380915"},facebook:{shortname:"crocword",appId:"480756825591552",groupId:"CrocwordPuzzleCommunity",gameroom_rate_postId:"365661064045146",dontLikeGameUrl_postId:"",stand:{appId:"2040725746155240"}},android:{package:"com.cleverapps.crocword",unityGameId:""},amazon:{package:"com.cleverapps.crocword",
id:"B074JB1CB3"},ios:{package:"com.cleverapps.crocword",id:"1269673961"},ok:{shortname:"crocword",appId:"512000231014",appKey:"CHGHIIJGDIHBABABA",groupId:"56496148775082",stand:{appId:"512000309461",appKey:"CGNJLJJGDIHBABABA"}},vk:{shortname:"crocword",appId:"7234712",groupId:"crocwordgroup",stand:{appId:""}},mm:{appId:"768269",privateKey:"d4754dc73b088c188a115f27a6955a30",groupId:"crocwordgroup",stand:{appId:"",privateKey:""}},fotostrana:{appId:"crocword",privateKey:"f520f6ab3bd7fd0800700c49352315d5",groupId:"352327",stand:{appId:"",privateKey:""}},mbga:{appId:"12026781",groupId:"32861692"},nk:{appId:"crocword",groupId:"1419072"},draugiem:{appId:"",groupId:""},plinga:{appId:"3e314ff40f40472f9aefed5b046f6dcc"}},magicwords:{basic:{metha:"simple",staticUrl:"https://magicwords.labsystech.ru/publish/html5/",deployment:"https://magicwords.labsystech.ru",title:"Magic Words",fakeRestApiURL:"http://localhost:3003",type:"board",adjust:{token:"",purchaseToken:"",events:{}},stand:{
staticUrl:"https://magicwords-staging.labsystech.ru/publish/html5-staging/",deployment:"https://magicwords-staging.labsystech.ru"},fonts:[{folder:"russo_one",name:"default",bundle:"digits",size:35},{folder:"russo_one",name:"default",bundle:"digits",size:55},{folder:"russo_one-nostroke",name:"nostroke",bundle:"digits",size:35},{folder:"russo_one-nostroke",name:"nostroke",bundle:"digits",size:55},{folder:"formal",name:"formal",bundle:"admin",size:21}]},instant:{appId:"635365383471881",rewarded:"636636986678054",interstitial:"636637626677990",groupId:"214767095976110"},facebook:{shortname:"magic_words_puzzle",appId:"116453995539327",groupId:"MagicWordsGameCommunity",gameroom_rate_postId:"424848868061655",dontLikeGameUrl_postId:"",stand:{appId:"442317226120273"}},android:{package:"com.cleverapps.magicwords",unityGameId:""},amazon:{package:"com.cleverapps.magicwords",id:"B071KKB243"},ios:{package:"com.cleverapps.magicwords",id:"1256304845"},ok:{shortname:"magic_words",appId:"512000565237",
appKey:"CGPQJNJGDIHBABABA",groupId:"60937355722922",stand:{appId:"",appKey:""}},vk:{shortname:"cleverapps_magic_words",appId:"7803436",groupId:"magic_words_group",stand:{appId:""}},mm:{appId:"783608",privateKey:"dc5f9696c5a5b43246a624bb0e768f82",groupId:"magic_words",stand:{appId:"",privateKey:""}},mbga:{appId:"",groupId:""},nk:{appId:"",groupId:""},draugiem:{appId:"",groupId:""},fotostrana:{appId:"magicwords",privateKey:"ed4e75bb8e2fd91a8842737d2daec10a",groupId:"352932",stand:{appId:"",privateKey:""}},plinga:{appId:"bbbcbc5c5b53473f9bcabe802b2f5296"}},olympics:{basic:{staticUrl:"https://olympics.gcdn.co/publish/html5/",deployment:"https://olympics.labsystech.ru",title:"Word Olympics",type:"board",fakeRestApiURL:"http://localhost:3009",lives:!0,metha:"knockout",adjust:{token:"oq5rkne31atc",purchaseToken:"1jir4j",events:{}},stand:{staticUrl:"https://olympics-staging.labsystech.ru/publish/html5-staging/",deployment:"https://olympics-staging.labsystech.ru"},fonts:[{folder:"roboto-bold",
name:"default",bundle:"digits",size:40},{folder:"roboto-bold",name:"default",bundle:"digits",size:70},{folder:"roboto-bold-nostroke",name:"nostroke",bundle:"digits",size:40},{folder:"roboto-bold-nostroke",name:"nostroke",bundle:"digits",size:70},{folder:"formal",name:"formal",bundle:"admin",size:21},{folder:"custom/marvin_compact_digits",name:"compact_digits",bundle:"compact_digits",size:42}]},instant:{appId:"403603626714071",rewarded:"404667946607639",interstitial:"404667353274365",groupId:"803998833127843"},facebook:{shortname:"word_olympics",appId:"404908173269801",groupId:"WordOlympicsPuzzle",gameroom_rate_postId:"",dontLikeGameUrl_postId:"",stand:{appId:"144582389701216"}},android:{package:"com.cleverapps.olympics",unityGameId:""},amazon:{package:"com.cleverapps.olympics",id:"B07DGGRN8K"},ios:{package:"com.cleverapps.olympics",id:"1394966990"},ok:{shortname:"olympics",appId:"512000487372",appKey:"CNMQGMJGDIHBABABA",groupId:"57516329402562",stand:{appId:"512000563796",
appKey:"CFFLJNJGDIHBABABA"}},vk:{shortname:"wordolympics",appId:"7394144",groupId:"wordolympicsgoup",stand:{appId:""}},mm:{appId:"771991",privateKey:"21595777945c95784a620c87da88c1df",groupId:"wordolympicsgroup",stand:{appId:"",privateKey:""}},mbga:{appId:"",groupId:""},nk:{appId:"crossword-online",groupId:"1419073"},draugiem:{appId:"",groupId:""},fotostrana:{appId:"olympics",privateKey:"11f5cd81d3000cdff01280a75074394a",groupId:"352515",stand:{appId:"",privateKey:""}}},scramble:{basic:{metha:"simple",staticUrl:"https://scramble.gcdn.co/publish/html5/",deployment:"https://scramble.labsystech.ru",title:"Kitty Scramble",type:"board",subtype:"stacks",languages:["en","fr","ru","it","de","es","nl","pt","ja","ko"],fakeRestApiURL:"http://localhost:3001",levelEditor:!0,changeLevelsDisabled:!0,adjust:{token:"tyz2dqp6yt4w",purchaseToken:"iyhfum",events:{ad_finish_rewarded:"fz4ds8",ad_start_interstitial:"1yuq60",retention_2:"64jbgj",retention_7:"z519a2"}},stand:{
staticUrl:"https://scramble-staging.labsystech.ru/publish/html5-staging/",deployment:"https://scramble-staging.labsystech.ru"},fonts:[{folder:"neris-black",name:"default",bundle:"digits",size:40},{folder:"neris-black",name:"default",bundle:"digits",size:90},{folder:"neris-black-nostroke",name:"nostroke",bundle:"digits",size:49},{folder:"neris-black-nostroke",name:"nostroke",bundle:"digits",size:90},{folder:"formal",name:"formal",bundle:"admin",size:21}]},instant:{appId:"170256430308082",rewarded:"170975370236188",interstitial:"170976206902771",groupId:"kittyscramblelite"},facebook:{shortname:"kittyscramble",appId:"229294690917786",groupId:"kittyscramblecommunity",gameroom_rate_postId:"503600920012105",dontLikeGameUrl_postId:"",stand:{appId:"540455343011567"}},android:{package:"com.cleverapps.scramble",unityGameId:""},amazon:{package:"com.cleverapps.scramble",id:"B073RHS2TQ"},ios:{package:"com.cleverapps.scramble",id:"1256286028"},ok:{shortname:"kittyscramble",appId:"512000595430",
appKey:"CHOGBOJGDIHBABABA",groupId:"58437883658410",stand:{appId:"512000542947",appKey:"CEOJENJGDIHBABABA"}},vk:{shortname:"kittyscramble",appId:"7559026",groupId:"kittyscramble_group",stand:{appId:""}},mm:{appId:"781640",privateKey:"ea277cd8e592c36afdc068eef84052ba",groupId:"kittyscramble",stand:{appId:"",privateKey:""}},mbga:{appId:"12026922",groupId:"32869232"},nk:{appId:"kitty-scramble",groupId:"1419070"},draugiem:{appId:"",groupId:""},plinga:{appId:"944186abe50e452dac7f0e8d3e0a8814"},fotostrana:{appId:"scramble",privateKey:"e2f2fa801cdd8f976a50b78561587172",groupId:"352513",stand:{appId:"",privateKey:""}}}};"undefined"!=typeof exports&&(module.exports=projects);var cleverapps={bundles:{}},projectName=(config="undefined"!=typeof document&&document.ccConfig||cc.game.config).projectName;cleverapps.config=config[projectName],cleverapps.config.debugMode=config.debugMode,cleverapps.config.useStandFbAppId=config.useStandFbAppId,cleverapps.config.name=projectName,
cleverapps.config.prefix=projectName,cleverapps.config.restApiURL="/"+projectName+"-rest",cleverapps.config.staticUrl=config.staticUrl||"",cleverapps.config.source=config.source,cleverapps.config.version=config.version,"match3"===cleverapps.config.type&&(match3={}),cleverapps.config.languages||(cleverapps.config.languages="board"===cleverapps.config.type?projects.default.board.languages:projects.default.languages),cleverapps.config.leagues||(cleverapps.config.leagues=projects.default.leagues),cleverapps.config.prices={prolongations:[100,300,500,700,1e3],boosters:{0:{1:100,3:270,7:600},1:{1:150,3:400,7:900},2:{1:200,3:550,7:1200},3:{1:50},4:{1:150},5:{1:50},6:{1:100},7:{1:150},8:{1:100},9:{1:50},10:{1:50},11:{1:100},12:{1:150},13:{1:50},14:{1:100},15:{1:150}}};var projectAddedToNetwork=function(e,t,n){return!!n[e]&&(!!n[e][t]&&("android"===t?n[e][t].package:"ios"===t||"amazon"===t?n[e][t].id:n[e][t].appId))},generateNetworkLinks=function(e,t){var n={};for(var s in t[e])if(
projectAddedToNetwork(e,s,t)){var i=t[e][s],o=!1;switch("undefined"==typeof exports&&(o=cleverapps.config.debugMode&&i.stand&&i.stand.appId),s){case"facebook":n.facebook=o?"https://apps.facebook.com/"+i.stand.appId:"https://apps.facebook.com/"+(i.shortname?i.shortname:i.appId);break;case"android":n.android="https://play.google.com/store/apps/details?id="+i.package;break;case"amazon":n.amazon="https://www.amazon.com/dp/"+i.id;break;case"ios":n.ios="https://apps.apple.com/app/id"+i.id;break;case"instant":n.instant=i.appId;break;case"ok":o?(n.web_ok="https://ok.ru/game/"+i.stand.appId,n.mobile_ok="https://m.ok.ru/game/"+i.stand.appId):(n.web_ok="https://ok.ru/game/"+i.shortname,n.mobile_ok="https://m.ok.ru/game/"+i.shortname);break;case"vk":o?(n.web_vk="https://vk.com/app"+i.stand.appId,n.mobile_vk="vk://vk.com/app"+i.stand.appId):(n.web_vk="https://vk.com/"+i.shortname,n.mobile_vk="vk://vk.com/"+i.shortname);break;case"mm":o?(n.web_mm="https://my.mail.ru/apps/"+i.stand.appId,
n.mobile_mm="https://m.my.mail.ru/apps/"+i.stand.appId):(n.web_mm="https://my.mail.ru/apps/"+i.appId,n.mobile_mm="https://m.my.mail.ru/apps/"+i.appId);break;case"mbga":"undefined"==typeof exports&&cleverapps.config.debugMode?n.mbga="http://sb.yahoo-mbga.jp/game/"+i.appId+"/play":n.mbga="http://yahoo-mbga.jp/game/"+i.appId+"/play",n.sp_mbga="http://sp.mbga.jp/_pf_install?game_id="+i.appId;break;case"nk":n.nk="https://nk.pl/#gry-online/"+i.appId;break;case"draugiem":n.draugiem="https://www.draugiem.lv/"+i.appId;break;case"fotostrana":n.fotostrana=o?"https://fotostrana.ru/app/"+i.stand.appId:"https://fotostrana.ru/app/"+i.appId}}return n};if("undefined"!=typeof exports)module.exports=generateNetworkLinks;else{for(var project in cleverapps.projectLinks={},projects)cleverapps.projectLinks[project]=generateNetworkLinks(project,projects);var networkConfig=projects[projectName];for(var network in cleverapps.config.rate={urls:{}},cleverapps.config.helpURL={},cleverapps.config.dontLikeGameUrl={}
,networkConfig)if(projectAddedToNetwork(projectName,network,projects)){var data=networkConfig[network],useStandData=cleverapps.config.debugMode&&data.stand&&data.stand.appId;switch(network){case"facebook":config.plugin||(config.plugin={}),config.plugin.facebook={status:!0,frictionlessRequests:!0,version:"v3.3"},useStandData||cleverapps.config.useStandFbAppId?config.plugin.facebook.appId=data.stand.appId:config.plugin.facebook.appId=data.appId,cleverapps.config.facebook={url:cleverapps.projectLinks[projectName].facebook};var helpUrl="https://www.facebook.com/"+data.groupId;cleverapps.config.helpURL.default=helpUrl,cleverapps.config.rate.urls.gameroom=data.gameroom_rate_postId?helpUrl+"/posts/"+data.gameroom_rate_postId:helpUrl,cleverapps.config.rate.urls.facebook="https://www.facebook.com/games/manage/",cleverapps.config.dontLikeGameUrl.default=data.dontLikeGameUrl_postId?helpUrl+"/posts/"+data.dontLikeGameUrl_postId:helpUrl;break;case"android":cleverapps.config.android={
url:cleverapps.projectLinks[projectName].android,unityGameId:data.unityGameId},cleverapps.config.rate.urls.android="market://details?id="+data.package;break;case"amazon":cleverapps.config.amazon={url:cleverapps.projectLinks[projectName].amazon},cleverapps.config.rate.urls.amazon="amzn://apps/android?p="+data.package,cleverapps.config.dontLikeGameUrl.amazon=!1;break;case"ios":cleverapps.config.ios={url:cleverapps.projectLinks[projectName].ios},cleverapps.config.rate.urls.ios="itms-apps://itunes.apple.com/app/id"+data.id;break;case"instant":cleverapps.config.instantAds={rewarded:data.appId+"_"+data.rewarded,interstitial:data.appId+"_"+data.interstitial},cleverapps.config.helpURL.instant="https://www.facebook.com/"+data.groupId;break;case"ok":cleverapps.config.mobile_ok=useStandData?{url:cleverapps.projectLinks[projectName].mobile_ok,appId:data.stand.appId,appKey:data.stand.appKey}:{url:cleverapps.projectLinks[projectName].mobile_ok,appId:data.appId,appKey:data.appKey},
cleverapps.config.web_ok={url:cleverapps.projectLinks[projectName].web_ok},cleverapps.config.helpURL.web_ok="https://ok.ru/group/"+data.groupId,cleverapps.config.helpURL.mobile_ok="https://m.ok.ru/group/"+data.groupId;break;case"vk":cleverapps.config.vk=useStandData?{url:cleverapps.projectLinks[projectName].web_vk,appId:data.stand.appId}:{url:cleverapps.projectLinks[projectName].web_vk,appId:data.appId},cleverapps.config.helpURL.web_vk="https://vk.com/"+data.groupId,cleverapps.config.helpURL.mobile_vk="https://m.vk.com/"+data.groupId;break;case"mm":cleverapps.config.myMailRu=useStandData?{url:cleverapps.projectLinks[projectName].web_mm,appId:data.stand.appId,privateKey:data.stand.privateKey}:{url:cleverapps.projectLinks[projectName].web_mm,appId:data.appId,privateKey:data.privateKey},cleverapps.config.helpURL.web_mm="https://my.mail.ru/community/"+data.groupId,cleverapps.config.helpURL.mobile_mm="https://m.my.mail.ru/community/"+data.groupId;break;case"mbga":cleverapps.config.mbga={
url:cleverapps.projectLinks[projectName].mbga},cleverapps.config.sp_mbga={url:data.appId+"-4"},cleverapps.config.helpURL.mbga="http://yahoo-mbga.jp/group/"+data.groupId,cleverapps.config.helpURL.sp_mbga="http://sp.mbga.jp/_grp_view?g="+data.groupId;break;case"nk":cleverapps.config.nk={url:cleverapps.projectLinks[projectName].nk},cleverapps.config.helpURL.nk="https://nk.pl/#grupa/"+data.groupId;break;case"draugiem":cleverapps.config.draugiem={url:cleverapps.projectLinks[projectName].draugiem},cleverapps.config.helpURL.draugiem="https://www.draugiem.lv/"+data.groupId;break;case"plinga":cleverapps.config.plinga={appId:data.appId};break;case"fotostrana":cleverapps.config.fotostrana=useStandData?{url:cleverapps.projectLinks[projectName].fotostrana,appId:data.stand.appId,privateKey:data.stand.privateKey}:{url:cleverapps.projectLinks[projectName].fotostrana,appId:data.appId,privateKey:data.privateKey},cleverapps.config.helpURL.fotostrana="https://fotostrana.ru/public/"+data.groupId}}}
cleverapps.getRequestParameters=function(e){var t={},n=e||window.location.search;if(n)for(var s=(n=n.substr(1)).split("&"),i=0;i<s.length;i++){var o=s[i].split("="),r=o[0],a=o[1]||"";a=decodeURIComponent(a.replace(/\+/g," ")),t[r]=a}return t},cleverapps.config.debugMode&&void 0!==cleverapps.getRequestParameters(window.location.hash).dropDebugMode&&(cleverapps.config.debugMode=!1),cleverapps.EventEmitter=function(){this.bindings={}},cleverapps.EventEmitter.prototype.on=function(t,n,e){this.bindings[t]||(this.bindings[t]=[]),this.bindings[t].push(n);var s={clear:function(){if(this.bindings[t]){var e=this.bindings[t].indexOf(n);0<=e&&this.bindings[t].splice(e,1)}}.bind(this)};return e instanceof cc.Node&&e.registerCleanupCallback(s.clear),s},cleverapps.EventEmitter.prototype.off=function(e){this.bindings[e]=void 0},cleverapps.EventEmitter.prototype.purge=function(){this.bindings={}},cleverapps.EventEmitter.prototype.trigger=function(){for(var t=[],e=0;e<arguments.length;e++)t.push(
arguments[e]);var n=t.shift();this.bindings[n]&&this.bindings[n].slice().forEach(function(e){e.apply(this,t)})},cleverapps.EventsQueue=function(e){this.data=[],this.interval=cleverapps.parseInterval(e)},cleverapps.EventsQueue.prototype.add=function(e){this.data.push(e),this.data.sort(),this.shrink()},cleverapps.EventsQueue.prototype.first=function(){if(this.shrink(),0<this.data.length)return this.data[0]},cleverapps.EventsQueue.prototype.shrink=function(){for(;0<this.data.length&&this.data[0]+this.interval<=Date.now();)this.data.shift()},cleverapps.EventsQueue.prototype.getShrinkLeftTime=function(){if(0<this.data.length)return this.data[0]+this.interval-Date.now()},cleverapps.EventsQueue.prototype.size=function(){return this.shrink(),this.data.length},cleverapps.Cache=function(e){this.capacity=e||100,this.data={},this.queue=[]},cleverapps.Cache.prototype.set=function(e,t){if(!this.data[e]){var n=this.queue.indexOf(e);-1!==n&&this.queue.splice(n,1)}this.data[e]=t,this.queue.push(e),
this.queue.length>this.capacity&&(e=this.queue.shift(),delete this.data[e])},cleverapps.Cache.prototype.get=function(e){return this.data[e]},cleverapps.isRumble=function(){var e=cleverapps.metha.getMainObject().knockoutGame;return e&&e.isRumble()},cleverapps.isKnockoutGame=function(){return cleverapps.metha.getMainObject().knockoutGame},cleverapps.humanReadableNumber=function(e,t){return(parseInt(e)||0)*Episode.LEVELS_PER_EPISODE+t+1},cleverapps.humanUnReadableNumber=function(e){return{level:e%Episode.LEVELS_PER_EPISODE,episode:Math.floor(e/Episode.LEVELS_PER_EPISODE)}},cleverapps.arrayFill=function(e,t){for(var n=[],s=0;s<e;s++)n.push(t);return n},cleverapps.formatAmount=function(e){if(e<1e3)return e;var t=Math.floor(e/1e3);(e-=1e3*t)<10?e="00"+e:e<100&&(e="0"+e);return t+" "+e},cleverapps.cmp=function(e,t){return(e=JSON.stringify(e))===(t=JSON.stringify(t))},cleverapps.loadSdk=function(e,t){var n=t.onSuccess||function(){},s=t.onFailure||function(){};void 0===t.attempt&&(t.attempt=3)
;var i=document.createElement("script");t.crossorigin&&i.setAttribute("crossorigin","anonymous"),i.setAttribute("type","text/javascript"),i.setAttribute("src",e);var o=function(){clearTimeout(r),1<t.attempt?(document.body.contains(i)&&document.body.removeChild(i),t.attempt--,cleverapps.loadSdk(e,t)):s()}.bind(this);i.onload=function(){clearTimeout(r),n()},i.onerror=o;var r=setTimeout(o,3e4);document.body.appendChild(i)},cleverapps.setUrlHash=function(e){var t=cleverapps.getRequestParameters(window.location.hash);for(var n in e){var s=e[n];void 0===s?delete t[n]:t[n]=s}window.location.hash=Object.keys(t).map(function(e){return e+"="+t[e]}).join("&")},cleverapps.bySource=function(e){var t,n=cleverapps.User.calcSource();return!cc.sys.isNative&&(-1<(t=navigator.userAgent||navigator.vendor||window.opera).indexOf("FBAN")||-1<t.indexOf("FBAV"))&&(n="gameroom"),e[n]?e[n]:"gameroom"===n&&e.facebook?e.facebook:e.default?e.default:void 0},cleverapps.INTERVALS={second:1,minute:60,hour:3600,
day:86400,week:604800,month:2592e3},cleverapps.padZeroes=function(e,t){for(var n=e+"";n.length<t;)n="0"+n;return n},cleverapps.parseInterval=function(e){var t=1e3*parseInt(e);for(var n in cleverapps.INTERVALS){if(-1!==e.indexOf(n))return t*cleverapps.INTERVALS[n]}return t},cleverapps.goalCollectSound=function(){cleverapps.audio.playSound(bundles.game.urls.goal_inc_effect,{throttle:100})},cleverapps.once=function(e){return function(){e&&(e.apply(this,arguments),e=void 0)}},cleverapps.shuffle=function(e){for(var t=0;t<e.length;t++){var n=cleverapps.Random.random(e.length),s=e[t];e[t]=e[n],e[n]=s}return e},cleverapps.extractDateFromDateTime=function(e){return new Date(e).setHours(0,0,0,0)},cleverapps.extractNumber=function(e){if(e){for(var t="",n=0;n<e.length;n++){var s=e.charAt(n);s.match(/\d+/g)?t+=s:","!==s&&"."!==s||(t+=".")}return-1!==t.indexOf(".")?parseFloat(t):parseInt(t)}},cleverapps.extend=function(e,t){if(Object.assign)return Object.assign.apply(this,arguments);for(
var n=1;n<arguments.length;n++)for(var s in arguments[n])e[s]=arguments[n][s];return e},cleverapps.override=function(e,t){for(var n in t){var s=e[n],i=t[n];s instanceof cc.Color?(console.log("Override color: "+n),e[n]=i):Array.isArray(s)&&Array.isArray(i)?e[n]=i:"object"==typeof s&&"object"==typeof i?cleverapps.override(s,i):e[n]=i}return e},cleverapps.increaseStylesByKoef=function(e,t){for(var n in e){var s=e[n];if("number"==typeof s){if(Array.isArray(e))continue;cleverapps.UI.needUpdateSizes(e,n,s)&&(e[n]*=t,e[n]=Math.round(e[n]))}else"object"==typeof s&&cleverapps.UI.needUpdateSizes(e,n,s)&&cleverapps.increaseStylesByKoef(s,t)}},cleverapps.extendStyles=function(e,t){if(t.extendStylesProcessed)return t;var n=cleverapps.overrideStyles(e,t,!0);return n.extendStylesProcessed=!0,cleverapps.extend(t,n),t},cleverapps.overrideStyles=function(e,t,n){for(var s in void 0!==e&&void 0!==t||console.log(e,t),n&&(e=cleverapps.clone(e,!0)),t){var i=e[s],o=t[s]
;i instanceof cc.Color||i&&i.fnt?e[s]=o:Array.isArray(i)&&Array.isArray(o)?e[s]=o:"object"==typeof i&&"object"==typeof o?cleverapps.overrideStyles(i,o):e[s]=o}return e},cleverapps.overrideColors=function(e,t){var n=function(e){return e instanceof cc.Color||cc.sys.isNative&&e&&void 0!==e.r&&void 0!==e.g&&void 0!==e.b&&void 0!==e.a};for(var s in t){var i=e[s],o=t[s];void 0===i?e[s]=o:n(i)&&n(o)?(i.r=o.r,i.g=o.g,i.b=o.b,i.a=o.a):"object"==typeof i&&"object"==typeof o?cleverapps.overrideColors(i,o):e[s]=o}return e},cleverapps.overrideFonts=function(e,t){for(var n in t){var s=e[n],i=t[n];if(void 0===s)e[n]=i;else{if(cleverapps.config.debugMode)var o=JSON.stringify(s);if(i.size&&(s.size=i.size),i.color&&(s.color=i.color),i.scale&&(s.scale=i.scale),i.alternativeSizes&&(s.alternativeSizes=i.alternativeSizes),i.name&&(s.name=i.name),s.stroke=i.stroke,s.shadow=i.shadow,cleverapps.config.debugMode){var r=JSON.stringify(s);if(o===r)throw console.log("WAS BECOME override "+n),console.log(o,r),
"Unnecessary overrideFonts: "+n}}e[n].fnt=!0}return e},cleverapps.clone=function(e,t){if(null===e)return null;if("object"!=typeof e)return e;if(e instanceof cc.Color)return cc.color(e);if(Array.isArray(e)){for(var n=[],s=0;s<e.length;s++)t?n.push(cleverapps.clone(e[s],!0)):n.push(e[s]);return n}n={};for(var i in e)if(e[i]&&e[i].fnt)n[i]=e[i];else if(t){if(e[i]instanceof cc.Node&&cleverapps.config.debugMode)throw"clone node object with name - "+i;n[i]=cleverapps.clone(e[i],!0)}else n[i]=e[i];return n},cleverapps.accumulate=function(e,t){var n,s,i=void 0;return function(){n=this,s=arguments,void 0===i&&(i=setTimeout(function(){clearTimeout(i),i=void 0,t.apply(n,s)},e))}},cleverapps.async=function(n){return function(){var e=this,t=arguments;setTimeout(function(){n.apply(e,t)},0)}},cleverapps.extendFunc=function(n,s){return function(){var e=this._super;this._super=n;var t=s.apply(this,arguments);return this._super=e,t}},cleverapps.throttle=function(e,t,n){return n=void 0!==n?n:0,function(
){n+e<Date.now()&&(n=Date.now(),t.apply(this,arguments))}},cleverapps.postpone=function(e,t){var n,s,i;return function(){n=this,s=arguments,clearTimeout(i),i=setTimeout(function(){t.apply(n,s)},e)}},cleverapps.timeredThrottle=function(n,e,s){var i,o,r;s=void 0!==s?s:0;var a=function(){void 0!==r&&(clearTimeout(r),r=void 0),o=i=void 0},c=function(){i&&o&&(e.apply(i,o),s=Date.now()),a()};return function(){a(),i=this,o=arguments;var e=Date.now(),t=s+n-e;t<=0?c():r=setTimeout(c,t)}},cleverapps.createSet=function(e){var t={};return e.forEach(function(e){t[e]=!0}),t},cleverapps.contains=function(t,e,n){return n=n||function(e){return e},t=cleverapps.toArray(t||[]).map(n),(e=cleverapps.toArray(e||[]).map(n)).filter(function(e){return-1!==t.indexOf(e)}).length===e.length},cleverapps.substract=function(e,t,n){n=n||function(e){return e},e=e||[];var s={};return(t=t||[]).forEach(function(e){s[n(e)]=!0}),e.filter(function(e){return void 0===s[n(e)]})},cleverapps.intersect=function(e,t){e=e||[]
;var n={};return(t=t||[]).forEach(function(e){n[e]=!0}),e.filter(function(e){return void 0!==n[e]})},cleverapps.unique=function(e){if("undefined"!=typeof Set&&"function"==typeof Array.from)return Array.from(new Set(e));var t={},n=[];return e.forEach(function(e){!0!==t[e]&&(n.push(e),t[e]=!0)}),n},cleverapps.values=function(e){if(!e)return[];if(Object.values)return Object.values(e);var t=[];for(var n in e)t.push(e[n]);return t},cleverapps.callFunc=function(e){e()},cleverapps.intervalToString=function(e,t){void 0===t&&(t=!0);var n=(e=Math.ceil(e/1e3))%60,s=(e=Math.floor(e/60))%60,i=Math.floor(e/60);if(n<10&&(n="0"+n),s<10&&(s="0"+s),24<i||24===i&&(0<s||0<n)){var o=Math.floor(i/24);return i%=24,Messages.get("dayTimeString",{day:o,hr:i})}return!t&&i<=24&&0<i?Messages.get("hoursMinutesString",{hr:i,min:s}):(i<10&&(i="0"+i),(t?i+":":"")+s+":"+n)},cleverapps.isLevels=function(){return cleverapps.metha.getType()!==Metha.NONE},cleverapps.isStaging=function(){
return!cc.sys.isNative&&cleverapps.config.debugMode&&!cleverapps.isLocalhost()},cleverapps.isLocalhost=function(){return!cc.sys.isNative&&("localhost"===location.host||"127.0.0.1"===location.host||0===location.host.indexOf("192.168."))},cleverapps.isStagingHost=function(){return-1!==location.host.indexOf("staging.labsystech.ru")},cleverapps.isInstant=function(){return"instant"===cc.game.config.source},cleverapps.isOkApp=function(){var e=!cc.sys.isNative&&window&&window.navigator&&window.navigator.userAgent;return e&&0<=e.indexOf("OkApp")},cleverapps.checkStatus=function(e,t){return Array.isArray(t)||(t=[t]),Array.isArray(e)?0<e.filter(function(e){return cleverapps.checkStatus(e,t)}.bind(this)).length:-1!==t.indexOf(e)||e&&e.errorMessage&&e.errorMessage.status&&-1!==t.indexOf(e.errorMessage.status)},cleverapps.toArray=function(e){return Array.isArray(e)||null==e?e:[e]},cleverapps.wait=function(e,t){if(0!==e){var n=0;return function(){++n===e&&t()}}t()},cleverapps.waitNoMore=function(e,t
){var n=setTimeout(function(){console.log("waitNoMore timeout: "+e),n=void 0,t()},e);return function(){void 0!==n&&(clearTimeout(n),t())}},cleverapps.doubleReward=function(e){if(void 0!==e.gold&&(e.gold*=2),void 0!==e.boosters)for(var t in e.boosters)e.boosters[t]*=2;return void 0!==e.exp&&(e.exp*=2),void 0!==e.stars&&(e.stars*=2),void 0!==e.lives&&(e.lives*=2),e},cleverapps.throwAsync=function(e,t){e=e+" "+JSON.stringify((t||new Error).stack),setTimeout(function(){throw e},0)},cleverapps.isNumber=function(e){return"string"==typeof e&&e&&/^[0-9]+$/.test(e)||"number"==typeof e&&!isNaN(e)},cleverapps.castType=function(e){return"string"==typeof e&&cleverapps.isNumber(e)?parseInt(e):e},cleverapps.rangeArray=function(e,t){for(var n=[],s=e;s<=t;s++)n.push(s);return n},cleverapps.splitToChunks=function(e,t){for(var n=Math.ceil(e.length/t),s=[];0<e.length;)s.push(e.splice(0,n));return s},cleverapps.sign=function(e){return e<0?-1:0<e?1:0};var OverridesContainer=function(){this.overrides=[]}
;OverridesContainer.prototype.override=function(e,t,n){if(e){var s=e[t];e[t]=n,this.overrides.push({target:e,key:t,value:n,oldValue:s})}},OverridesContainer.prototype.unoverride=function(){var e=this.overrides;this.overrides=[],e.forEach(function(e){e.target[e.key]=e.oldValue})},void 0===Array.prototype.find&&Object.defineProperty(Array.prototype,"find",{value:function(e){if(null==this)throw TypeError('"this" is null or not defined');var t=Object(this),n=t.length>>>0;if("function"!=typeof e)throw TypeError("predicate must be a function");for(var s=arguments[1],i=0;i<n;){var o=t[i];if(e.call(s,o,i,t))return o;i++}},configurable:!0,writable:!0}),cleverapps.EXCHANGE_RATES={EUR:.9,RUB:64.23,GBP:.79,DEM:1.77,JPY:108.31,INR:70.86,FRF:5.95,CAD:1.32,AUD:1.47,BEF:36.58},cleverapps.NO_ACTION="no_action";var ResourceProcessor={addStaticUrl:function(){var e,n=function(e){return"string"==typeof e&&-1!==[".plist",".atlas"].indexOf(cc.path.extname(e))},i=function(e,t){if(
"string"==typeof e&&"@"===e.charAt(0))return e;if("string"==typeof e&&-1===e.indexOf(t))return t+e;if("font"===e.type)return e.srcs=e.srcs.map(function(e){return i(e,t)}),e;if("object"==typeof e){var n={};for(var s in e)n[s]=i(e[s],t);return n}return e},t=cleverapps.config,s=Object.keys(bundles);for(var o in s){var r=s[o],a=bundles[r],c=t.staticUrl,l="";if(cc.sys.isNative&&(c="",l=t.staticUrl.replace("html5-staging","external-staging").replace("html5","external")),c||l)for(var o in a.urls){var p=a.urls[o],d=a.external&&("string"==typeof(e=p)&&-1!==[".png",".jpg"].indexOf(cc.path.extname(e)))&&l||c;d&&(a.urls[o]=i(p,d))}c&&Object.keys(a.jsons).forEach(function(e){var t;(n(a.jsons[e])||"string"==typeof(t=a.jsons[e])&&-1!==[".json"].indexOf(cc.path.extname(t))&&"levels"===e&&a.urls.levels)&&(a.jsons[e]=i(a.jsons[e],c))}),Object.keys(a.urls).forEach(function(e){n(a.urls[e])&&(a.jsons[e]=a.urls[e])})}},calcProbablyNeed:function(){var e=["main","transition",
"language_"+cleverapps.settings.language],t=cleverapps.Plot.onStartup(void 0,!0),n=[];"object"==typeof t&&(n=t.options,t=t.scene);var s=cleverapps.bundleLoader.getClassBundles(t,this,n);return e=e.concat(s),cleverapps.config.debugMode&&e.push("dev_resources"),e=(e=cleverapps.unique(e)).filter(function(e){return void 0!==bundles[e]&&!bundles[e].noCache})}},bundles={admin:{urls:{png:"@%n-d3469fc49d.png",json:"@%n-1e29979919.json"},jsons:{plist:"@%n-d3469fc49d.plist"},frames:{annotation_icon:"#%n-button_icons-%n_annotation.png",current_icon:"#%n-button_icons-%n_current.png",hard_icon:"#%n-button_icons-%n_hot.png",update_diff_icon:"#%n-button_icons-%n_diff_icon.png",play_icon:"#%n-button_icons-%n_play.png",edit_icon:"#%n-button_icons-%n_edit.png",copy_icon:"#%n-button_icons-%n_copy.png",delete_icon:"#%n-button_icons-%n_delete.png",release_icon:"#%n-button_icons-%n_release.png",debug_icon:"#%n-button_icons-%n_debug.png",download_icon:"#%n-button_icons-%n_download.png",
update_icon:"#%n-button_icons-%n_update.png",upload_icon:"#%n-button_icons-%n_upload.png",fbProduct_icon:"#%n-button_icons-%n_fbproduct.png",left:"#%n-button_icons-left.png",right:"#%n-button_icons-right.png",left_double:"#%n-button_icons-left_double.png",right_double:"#%n-button_icons-right_double.png",number_bg:"#%n-numbers.png",area_selection:"#%n-diffr_red.png",hard_level_mark:"#%n-hard_level_pin.png",tricky_level_mark:"#%n-tricky_level_pin.png",yellow_flag:"#%n-%n_yellow_flag.png",in_process:"#%n-in_process.png",attention_icon:"#%n-attention_icon.png",regular_button:"#%n-regular_button.png",regular_button_on:"#%n-regular_button_on.png",disabled_button:"#%n-disabled_button.png",selected_button:"#%n-selected_button.png",plus_button:"#%n-plus_button.png",lvl_bg:"#%n-level_frame_regular.png",lvl_selected_bg:"#%n-level_frame_selected.png",lvl_miniature_bg:"#%n-level_miniature_frame_regular.png",tool_tip_bg:"#%n-editor_yellow_substrate.png",tool_tip_button:"#%n-description_button.png",
loading_png:"#%n-loading.png",delete_button:"#%n-delete_button.png",enlarge_button:"#%n-enlarge_button.png",language_regular:"#%n-language_regular.png",language_selected:"#%n-language_selected.png",difficulty_bar:"#%n-difficulty_bar.png",navigation_level_episode:"#%n-navigation_level_episode.png",current_arrow:"#%n-current_arrow.png",feature_bg:"#%n-features-editor_bg.png",log_entry_separator:"#%n-log_entry_separator.png",log_bg:"#%n-level_frame_add.png",gun_icon:"#%n-gun.png",admin_de:"#%n-langs-%n_de.png",admin_en:"#%n-langs-%n_en.png",admin_es:"#%n-langs-%n_es.png",admin_fr:"#%n-langs-%n_fr.png",admin_it:"#%n-langs-%n_it.png",admin_ja:"#%n-langs-%n_ja.png",admin_nl:"#%n-langs-%n_nl.png",admin_pt:"#%n-langs-%n_pt.png",admin_ru:"#%n-langs-%n_ru.png",admin_ko:"#%n-langs-%n_ko.png",formal21pt_0:"#%n-formal-21pt-0.png",formal21pt_1:"#%n-formal-21pt-1.png",formal21pt_2:"#%n-formal-21pt-2.png",formal21pt_3:"#%n-formal-21pt-3.png",formal21pt_4:"#%n-formal-21pt-4.png",
formal21pt_5:"#%n-formal-21pt-5.png",formal21pt_6:"#%n-formal-21pt-6.png",formal21pt_7:"#%n-formal-21pt-7.png",formal21pt_8:"#%n-formal-21pt-8.png",formal21pt_9:"#%n-formal-21pt-9.png",formal21pt_colon:"#%n-formal-21pt-colon.png",formal21pt_slash:"#%n-formal-21pt-slash.png",formal21pt_plus:"#%n-formal-21pt-plus.png",formal21pt_minus:"#%n-formal-21pt-minus.png",formal21pt_x:"#%n-formal-21pt-x.png",formal21pt_space:"#%n-formal-21pt-space.png",formal21pt_point:"#%n-formal-21pt-point.png",formal21pt_left_square_bracket:"#%n-formal-21pt-left_square_bracket.png",formal21pt_right_square_bracket:"#%n-formal-21pt-right_square_bracket.png",gold_small_png:"#%n-reward_icons-ruby_small.png",reward_gold_png:"#%n-reward_icons-ruby.png",reward_coin_png:"#%n-reward_icons-coin.png",reward_exp_png:"#%n-reward_icons-exp.png",reward_wand_png:"#%n-reward_icons-wand.png",reward_worker_png:"#%n-reward_icons-worker.png",reward_energy_png:"#%n-reward_icons-energy.png",
shop_energy_png:"#%n-reward_icons-energy_shop.png",shop_gold_png:"#%n-reward_icons-ruby_shop.png",shop_coin_png:"#%n-reward_icons-coin_shop.png",push_icon:"#%n-button_icons-%n_push.png",revert_icon:"#%n-button_icons-%n_rev.png",scroll_bg:"#%n-selected_button.png",scroll_content_bg:"#%n-level_frame_regular.png",loading:"#%n-loading.png",nostroke62pt_0:"#%n-marvin-round-nostroke-62pt-0.png",nostroke62pt_1:"#%n-marvin-round-nostroke-62pt-1.png",nostroke62pt_2:"#%n-marvin-round-nostroke-62pt-2.png",nostroke62pt_3:"#%n-marvin-round-nostroke-62pt-3.png",nostroke62pt_4:"#%n-marvin-round-nostroke-62pt-4.png",nostroke62pt_5:"#%n-marvin-round-nostroke-62pt-5.png",nostroke62pt_6:"#%n-marvin-round-nostroke-62pt-6.png",nostroke62pt_7:"#%n-marvin-round-nostroke-62pt-7.png",nostroke62pt_8:"#%n-marvin-round-nostroke-62pt-8.png",nostroke62pt_9:"#%n-marvin-round-nostroke-62pt-9.png",nostroke62pt_colon:"#%n-marvin-round-nostroke-62pt-colon.png",
nostroke62pt_slash:"#%n-marvin-round-nostroke-62pt-slash.png",nostroke62pt_plus:"#%n-marvin-round-nostroke-62pt-plus.png",nostroke62pt_minus:"#%n-marvin-round-nostroke-62pt-minus.png",nostroke62pt_x:"#%n-marvin-round-nostroke-62pt-x.png",nostroke62pt_space:"#%n-marvin-round-nostroke-62pt-space.png",default45pt_0:"#%n-marvin-round-45pt-0.png",default45pt_1:"#%n-marvin-round-45pt-1.png",default45pt_2:"#%n-marvin-round-45pt-2.png",default45pt_3:"#%n-marvin-round-45pt-3.png",default45pt_4:"#%n-marvin-round-45pt-4.png",default45pt_5:"#%n-marvin-round-45pt-5.png",default45pt_6:"#%n-marvin-round-45pt-6.png",default45pt_7:"#%n-marvin-round-45pt-7.png",default45pt_8:"#%n-marvin-round-45pt-8.png",default45pt_9:"#%n-marvin-round-45pt-9.png",default45pt_colon:"#%n-marvin-round-45pt-colon.png",default45pt_slash:"#%n-marvin-round-45pt-slash.png",default45pt_plus:"#%n-marvin-round-45pt-plus.png",default45pt_minus:"#%n-marvin-round-45pt-minus.png",default45pt_x:"#%n-marvin-round-45pt-x.png",
default45pt_space:"#%n-marvin-round-45pt-space.png",default62pt_0:"#%n-marvin-round-62pt-0.png",default62pt_1:"#%n-marvin-round-62pt-1.png",default62pt_2:"#%n-marvin-round-62pt-2.png",default62pt_3:"#%n-marvin-round-62pt-3.png",default62pt_4:"#%n-marvin-round-62pt-4.png",default62pt_5:"#%n-marvin-round-62pt-5.png",default62pt_6:"#%n-marvin-round-62pt-6.png",default62pt_7:"#%n-marvin-round-62pt-7.png",default62pt_8:"#%n-marvin-round-62pt-8.png",default62pt_9:"#%n-marvin-round-62pt-9.png",default62pt_colon:"#%n-marvin-round-62pt-colon.png",default62pt_slash:"#%n-marvin-round-62pt-slash.png",default62pt_plus:"#%n-marvin-round-62pt-plus.png",default62pt_minus:"#%n-marvin-round-62pt-minus.png",default62pt_x:"#%n-marvin-round-62pt-x.png",default62pt_space:"#%n-marvin-round-62pt-space.png",default76pt_0:"#%n-marvin-round-76pt-0.png",default76pt_1:"#%n-marvin-round-76pt-1.png",default76pt_2:"#%n-marvin-round-76pt-2.png",default76pt_3:"#%n-marvin-round-76pt-3.png",
default76pt_4:"#%n-marvin-round-76pt-4.png",default76pt_5:"#%n-marvin-round-76pt-5.png",default76pt_6:"#%n-marvin-round-76pt-6.png",default76pt_7:"#%n-marvin-round-76pt-7.png",default76pt_8:"#%n-marvin-round-76pt-8.png",default76pt_9:"#%n-marvin-round-76pt-9.png",default76pt_colon:"#%n-marvin-round-76pt-colon.png",default76pt_slash:"#%n-marvin-round-76pt-slash.png",default76pt_plus:"#%n-marvin-round-76pt-plus.png",default76pt_minus:"#%n-marvin-round-76pt-minus.png",default76pt_x:"#%n-marvin-round-76pt-x.png",default76pt_space:"#%n-marvin-round-76pt-space.png"}},ads_background_music:{urls:{basic:"~sounds/ads_music-07091e761d.mp3",brain_pink:"~sounds/brain_pink_music-f77c1f6493.mp3",neutral:"~sounds/neutral_music-3e2cc19851.mp3",neutral_1:"~sounds/neutral_1_music-9065945291.mp3",nature:"~sounds/nature_music-68c4787811.mp3",nature_1:"~sounds/nature_1_music-929ae12b21.mp3",fantasy:"~sounds/fantasy_music-80c0f30e5e.mp3",puzzle:"~sounds/puzzle_music-6ef102147b.mp3",
merge:"~sounds/merge_music-ef61c7f9a4.mp3",merge_adventure_music:"~sounds/merge_adventure_music-dec649ae09.mp3",merge_brave_music:"~sounds/merge_brave_music-6d26d17d20.mp3",merge_combat_music:"~sounds/merge_combat_music-b7b9079bdd.mp3",merge_inspiring_music:"~sounds/merge_inspiring_music-25cf32f79a.mp3",merge_jazz:"~sounds/merge_jazz-d280eb64d3.mp3",merge_jazz_1:"~sounds/merge_jazz_1-88aa9d44d3.mp3",merge_jazz_2:"~sounds/merge_jazz_2-b7270bb938.mp3",merge_jazz_3:"~sounds/merge_jazz_3-c06c7bc085.mp3",heroes_background_music:"~sounds/heroes_background_music-fd140b1e6a.mp3",heroes_hardmusic:"~sounds/heroes_hardmusic-74bce51edc.mp3",heroes_music:"~sounds/heroes_music-e51f9ef345.mp3",riddles_background_music:"~sounds/riddles_background_music-92c95bceb8.mp3",riddles_hardmusic:"~sounds/riddles_hardmusic-40d5ec946d.mp3",riddles_music:"~sounds/riddles_music-60edf2d619.mp3",adventure_background_music:"~sounds/adventure_background_music-82d0a3fdda.mp3",
adventure_hardmusic:"~sounds/adventure_hardmusic-ef75d8b7b1.mp3",adventure_music:"~sounds/adventure_music-e0fdd55bdf.mp3",runes_background_music:"~sounds/runes_background_music-449d690418.mp3",runes_hardmusic:"~sounds/runes_hardmusic-2f8d6c201d.mp3",runes_music:"~sounds/runes_music-7019e5075a.mp3",coins_effect:"~sounds/ads_coins-43f2b5abce.mp3",win_effect:"~sounds/win_effect-3906346e70.mp3",fireworks_effect:"~sounds/fireworks_noapplause-c9cd3d8319.mp3",fireworks_applause_effect:"~sounds/fireworks_applause-389e89ea60.mp3",king_speech:"~sounds/vox_king_says-7207a99bfe.mp3",vox_fantasy_says:"~sounds/vox_fantasy_says-81b739f428.mp3",vox_human_says:"~sounds/vox_human_says-75d83082be.mp3",vox_human_says1:"~sounds/vox_human_says1-6a440466d8.mp3",vox_human_says2:"~sounds/vox_human_says2-bb759b0c3e.mp3",vox_woman_says:"~sounds/vox_woman_says-92dada0bb4.mp3",vox_woman_says1:"~sounds/vox_woman_says1-bdbec23071.mp3"},debug:!0,targets:["web"]},ads_backgrounds_ananas_background:{urls:{
ananas_background:"@ananas_background-2c8a738d89.jpg"},debug:!0,targets:["web"]},ads_backgrounds_bg_1_xmas:{urls:{bg_1_xmas:"@bg_1_xmas-410803ab92.png"},debug:!0,targets:["web"]},ads_backgrounds_bg_2_xmas:{urls:{bg_2_xmas:"@bg_2_xmas-6d55cc499a.png"},debug:!0,targets:["web"]},ads_backgrounds_bg_3_xmas:{urls:{bg_3_xmas:"@bg_3_xmas-d512754bf9.png"},debug:!0,targets:["web"]},ads_backgrounds_bg_4_xmas:{urls:{bg_4_xmas:"@bg_4_xmas-c8bddec8b0.jpg"},debug:!0,targets:["web"]},ads_backgrounds_bg_5_xmas:{urls:{bg_5_xmas:"@bg_5_xmas-7512ca63f2.jpg"},debug:!0,targets:["web"]},ads_backgrounds_bg_6_xmas:{urls:{bg_6_xmas:"@bg_6_xmas-67e358b854.jpg"},debug:!0,targets:["web"]},ads_backgrounds_bg_armchair:{urls:{bg_armchair:"@bg_armchair-4c1e9a2c3f.png"},debug:!0,targets:["web"]},ads_backgrounds_bg_autumm:{urls:{bg_autumm:"@bg_autumm-b7d45444c6.png"},debug:!0,targets:["web"]},ads_backgrounds_bg_barn:{urls:{bg_barn:"@bg_barn-6c1ed6560a.png"},debug:!0,targets:["web"]},ads_backgrounds_bg_beach:{urls:{
bg_beach:"@bg_beach-769bb290d9.jpg"},debug:!0,targets:["web"]},ads_backgrounds_bg_blue_stripe:{urls:{bg_blue_stripe:"@bg_blue_stripe-e09ba15948.jpg"},debug:!0,targets:["web"]},ads_backgrounds_bg_bluecar:{urls:{bg_bluecar:"@bg_bluecar-c4f914a06f.png"},debug:!0,targets:["web"]},ads_backgrounds_bg_cabin:{urls:{bg_cabin:"@bg_cabin-168ecb22e4.png"},debug:!0,targets:["web"]},ads_backgrounds_bg_castle:{urls:{bg_castle:"@bg_castle-ce31db2d30.png"},debug:!0,targets:["web"]},ads_backgrounds_bg_cemetery:{urls:{bg_cemetery:"@bg_cemetery-3fe0d25e62.jpg"},debug:!0,targets:["web"]},ads_backgrounds_bg_cliff:{urls:{bg_cliff:"@bg_cliff-4a7c3c4661.png"},debug:!0,targets:["web"]},ads_backgrounds_bg_coffee:{urls:{bg_coffee:"@bg_coffee-edd46d43ac.png"},debug:!0,targets:["web"]},ads_backgrounds_bg_daily_cup:{urls:{bg_daily_cup:"@bg_daily_cup-5eced857f5.png"},debug:!0,targets:["web"]},ads_backgrounds_bg_dog:{urls:{bg_dog:"@bg_dog-4bf65a56b9.jpg"},debug:!0,targets:["web"]},ads_backgrounds_bg_dog2:{urls:{
bg_dog2:"@bg_dog2-8dadbe4e87.jpg"},debug:!0,targets:["web"]},ads_backgrounds_bg_facegirl:{urls:{bg_facegirl:"@bg_facegirl-2849400227.png"},debug:!0,targets:["web"]},ads_backgrounds_bg_field:{urls:{bg_field:"@bg_field-cd8c93ff03.jpg"},debug:!0,targets:["web"]},ads_backgrounds_bg_flowers_cup:{urls:{bg_flowers_cup:"@bg_flowers_cup-c70a8970be.png"},debug:!0,targets:["web"]},ads_backgrounds_bg_forest:{urls:{bg_forest:"@bg_forest-8cd108c447.png"},debug:!0,targets:["web"]},ads_backgrounds_bg_fruit:{urls:{bg_fruit:"@bg_fruit-df8dc3a5fd.png"},debug:!0,targets:["web"]},ads_backgrounds_bg_giraffe:{urls:{bg_giraffe:"@bg_giraffe-581140b846.png"},debug:!0,targets:["web"]},ads_backgrounds_bg_girl_mountains:{urls:{bg_girl_mountains:"@bg_girl_mountains-72108769c1.png"},debug:!0,targets:["web"]},ads_backgrounds_bg_greencar:{urls:{bg_greencar:"@bg_greencar-663bb71815.png"},debug:!0,targets:["web"]},ads_backgrounds_bg_halloween2:{urls:{bg_halloween2:"@bg_halloween2-dfe4b2a1ce.png"},debug:!0,targets:["web"
]},ads_backgrounds_bg_island:{urls:{bg_island:"@bg_island-391e1f7073.png"},debug:!0,targets:["web"]},ads_backgrounds_bg_kids_forest:{urls:{bg_kids_forest:"@bg_kids_forest-3bbc758a6e.png"},debug:!0,targets:["web"]},ads_backgrounds_bg_kitchen:{urls:{bg_kitchen:"@bg_kitchen-1babc382fd.png"},debug:!0,targets:["web"]},ads_backgrounds_bg_korea:{urls:{bg_korea:"@bg_korea-36c628a456.jpg"},debug:!0,targets:["web"]},ads_backgrounds_bg_laptop:{urls:{bg_laptop:"@bg_laptop-f2209c4432.png"},debug:!0,targets:["web"]},ads_backgrounds_bg_lighthouse:{urls:{bg_lighthouse:"@bg_lighthouse-2fbb24be1f.jpg"},debug:!0,targets:["web"]},ads_backgrounds_bg_lowpixel:{urls:{bg_lowpixel:"@bg_lowpixel-1fae9deadf.png"},debug:!0,targets:["web"]},ads_backgrounds_bg_meadow:{urls:{bg_meadow:"@bg_meadow-77af3f0ffc.png"},debug:!0,targets:["web"]},ads_backgrounds_bg_merge1:{urls:{bg_merge1:"@bg_merge1-335200c331.jpg"},debug:!0,targets:["web"]},ads_backgrounds_bg_merge10:{urls:{bg_merge10:"@bg_merge10-665eb2e1ae.jpg"},
debug:!0,targets:["web"]},ads_backgrounds_bg_merge11:{urls:{bg_merge11:"@bg_merge11-43a2d884d2.jpg"},debug:!0,targets:["web"]},ads_backgrounds_bg_merge12:{urls:{bg_merge12:"@bg_merge12-7a1e6581e2.jpg"},debug:!0,targets:["web"]},ads_backgrounds_bg_merge13:{urls:{bg_merge13:"@bg_merge13-f6a01e06f6.jpg"},debug:!0,targets:["web"]},ads_backgrounds_bg_merge2:{urls:{bg_merge2:"@bg_merge2-01752b9cca.jpg"},debug:!0,targets:["web"]},ads_backgrounds_bg_merge3:{urls:{bg_merge3:"@bg_merge3-f9e2d857f1.jpg"},debug:!0,targets:["web"]},ads_backgrounds_bg_merge4:{urls:{bg_merge4:"@bg_merge4-4ccd20a1f4.jpg"},debug:!0,targets:["web"]},ads_backgrounds_bg_merge5:{urls:{bg_merge5:"@bg_merge5-b1efdd12d8.jpg"},debug:!0,targets:["web"]},ads_backgrounds_bg_merge6:{urls:{bg_merge6:"@bg_merge6-c2666e90d3.jpg"},debug:!0,targets:["web"]},ads_backgrounds_bg_merge7:{urls:{bg_merge7:"@bg_merge7-6fbe76d337.jpg"},debug:!0,targets:["web"]},ads_backgrounds_bg_merge8:{urls:{bg_merge8:"@bg_merge8-01485956f5.jpg"},debug:!0,
targets:["web"]},ads_backgrounds_bg_merge9:{urls:{bg_merge9:"@bg_merge9-8e1c1c7cc3.jpg"},debug:!0,targets:["web"]},ads_backgrounds_bg_merge_hd1:{urls:{bg_merge_hd1:"@bg_merge_hd1-564dfa0f6b.jpg"},debug:!0,targets:["web"]},ads_backgrounds_bg_merge_hd10:{urls:{bg_merge_hd10:"@bg_merge_hd10.jpg-b826ff2f6d.png"},debug:!0,targets:["web"]},ads_backgrounds_bg_merge_hd11:{urls:{bg_merge_hd11:"@bg_merge_hd11.jpg-6f6d6e8da3.png"},debug:!0,targets:["web"]},ads_backgrounds_bg_merge_hd12:{urls:{bg_merge_hd12:"@bg_merge_hd12.jpg-2aab6a80d6.png"},debug:!0,targets:["web"]},ads_backgrounds_bg_merge_hd13:{urls:{bg_merge_hd13:"@bg_merge_hd13.jpg-d39d9ce166.png"},debug:!0,targets:["web"]},ads_backgrounds_bg_merge_hd14:{urls:{bg_merge_hd14:"@bg_merge_hd14.jpg-603b16aafd.png"},debug:!0,targets:["web"]},ads_backgrounds_bg_merge_hd2:{urls:{bg_merge_hd2:"@bg_merge_hd2-aaed25fb35.jpg"},debug:!0,targets:["web"]},ads_backgrounds_bg_merge_hd3:{urls:{bg_merge_hd3:"@bg_merge_hd3-77000c0ba3.jpg"},debug:!0,targets:[
"web"]},ads_backgrounds_bg_merge_hd4:{urls:{bg_merge_hd4:"@bg_merge_hd4-27c57a1465.jpg"},debug:!0,targets:["web"]},ads_backgrounds_bg_merge_hd5:{urls:{bg_merge_hd5:"@bg_merge_hd5-e44ce6494e.jpg"},debug:!0,targets:["web"]},ads_backgrounds_bg_merge_hd6:{urls:{bg_merge_hd6:"@bg_merge_hd6-e62be0b612.jpg"},debug:!0,targets:["web"]},ads_backgrounds_bg_merge_hd7:{urls:{bg_merge_hd7:"@bg_merge_hd7-71afe17e07.jpg"},debug:!0,targets:["web"]},ads_backgrounds_bg_merge_hd8:{urls:{bg_merge_hd8:"@bg_merge_hd8-0e99216314.jpg"},debug:!0,targets:["web"]},ads_backgrounds_bg_merge_hd9:{urls:{bg_merge_hd9:"@bg_merge_hd9.jpg-5a5765444c.png"},debug:!0,targets:["web"]},ads_backgrounds_bg_millionaire:{urls:{bg_millionaire:"@bg_millionaire-e5bb44be2c.png"},debug:!0,targets:["web"]},ads_backgrounds_bg_minimal:{urls:{bg_minimal:"@bg_minimal-eef15b6b6c.png"},debug:!0,targets:["web"]},ads_backgrounds_bg_minimal2:{urls:{bg_minimal2:"@bg_minimal2-3e4399ebea.png"},debug:!0,targets:["web"]},ads_backgrounds_bg_modern:{
urls:{bg_modern:"@bg_modern-7452a97ecf.png"},debug:!0,targets:["web"]},ads_backgrounds_bg_moon:{urls:{bg_moon:"@bg_moon-c936cf7f1e.png"},debug:!0,targets:["web"]},ads_backgrounds_bg_moto:{urls:{bg_moto:"@bg_moto-96aae61654.png"},debug:!0,targets:["web"]},ads_backgrounds_bg_newyork:{urls:{bg_newyork:"@bg_newyork-f0da7916ea.png"},debug:!0,targets:["web"]},ads_backgrounds_bg_paper:{urls:{bg_paper:"@bg_paper-4e129104d1.png"},debug:!0,targets:["web"]},ads_backgrounds_bg_pier:{urls:{bg_pier:"@bg_pier-2a63687925.jpg"},debug:!0,targets:["web"]},ads_backgrounds_bg_pinup:{urls:{bg_pinup:"@bg_pinup-9b44b7324f.png"},debug:!0,targets:["web"]},ads_backgrounds_bg_pinup_cat:{urls:{bg_pinup_cat:"@bg_pinup_cat-4eb5b25160.png"},debug:!0,targets:["web"]},ads_backgrounds_bg_pinup_dance:{urls:{bg_pinup_dance:"@bg_pinup_dance-98c6a59056.png"},debug:!0,targets:["web"]},ads_backgrounds_bg_pinup_penguin:{urls:{bg_pinup_penguin:"@bg_pinup_penguin-84747ae05d.png"},debug:!0,targets:["web"]},
ads_backgrounds_bg_pixel:{urls:{bg_pixel:"@bg_pixel-4f103afec9.png"},debug:!0,targets:["web"]},ads_backgrounds_bg_plain:{urls:{bg_plain:"@bg_plain-5df1c8e702.jpg"},debug:!0,targets:["web"]},ads_backgrounds_bg_planks:{urls:{bg_planks:"@bg_planks-4c1f19790b.png"},debug:!0,targets:["web"]},ads_backgrounds_bg_popart:{urls:{bg_popart:"@bg_popart-7ed96d35bb.png"},debug:!0,targets:["web"]},ads_backgrounds_bg_questionnaire:{urls:{bg_questionnaire:"@bg_questionnaire-8f22228a95.png"},debug:!0,targets:["web"]},ads_backgrounds_bg_redcar:{urls:{bg_redcar:"@bg_redcar-eddbf684df.png"},debug:!0,targets:["web"]},ads_backgrounds_bg_riddles:{urls:{bg_riddles:"@bg_riddles-67cf09486b.jpg"},debug:!0,targets:["web"]},ads_backgrounds_bg_riddles_2:{urls:{bg_riddles_2:"@bg_riddles_2-4f4e7391d9.jpg"},debug:!0,targets:["web"]},ads_backgrounds_bg_riddles_hard:{urls:{bg_riddles_hard:"@bg_riddles_hard-2f4264475b.jpg"},debug:!0,targets:["web"]},ads_backgrounds_bg_russian:{urls:{bg_russian:"@bg_russian-6a9a8f0b04.png"
},debug:!0,targets:["web"]},ads_backgrounds_bg_sakura:{urls:{bg_sakura:"@bg_sakura-50fabbb06c.png"},debug:!0,targets:["web"]},ads_backgrounds_bg_scramble_pattern:{urls:{bg_scramble_pattern:"@bg_scramble_pattern-c22ddb7881.png"},debug:!0,targets:["web"]},ads_backgrounds_bg_sea:{urls:{bg_sea:"@bg_sea-cdd1ad2677.png"},debug:!0,targets:["web"]},ads_backgrounds_bg_shanghai:{urls:{bg_shanghai:"@bg_shanghai-cd1d5d132b.png"},debug:!0,targets:["web"]},ads_backgrounds_bg_sheep:{urls:{bg_sheep:"@bg_sheep-15080c6634.jpg"},debug:!0,targets:["web"]},ads_backgrounds_bg_skategirl:{urls:{bg_skategirl:"@bg_skategirl-da1b80d99c.png"},debug:!0,targets:["web"]},ads_backgrounds_bg_skyscraper:{urls:{bg_skyscraper:"@bg_skyscraper-3586854b45.png"},debug:!0,targets:["web"]},ads_backgrounds_bg_steampunk:{urls:{bg_steampunk:"@bg_steampunk-887fc065a5.png"},debug:!0,targets:["web"]},ads_backgrounds_bg_stonegirl:{urls:{bg_stonegirl:"@bg_stonegirl-7f4364d09d.png"},debug:!0,targets:["web"]},ads_backgrounds_bg_sweets:{
urls:{bg_sweets:"@bg_sweets-4711a10bff.png"},debug:!0,targets:["web"]},ads_backgrounds_bg_table_coffee:{urls:{bg_table_coffee:"@bg_table_coffee-aad34a9a7b.png"},debug:!0,targets:["web"]},ads_backgrounds_bg_theatre:{urls:{bg_theatre:"@bg_theatre-504164559b.png"},debug:!0,targets:["web"]},ads_backgrounds_bg_theatre2:{urls:{bg_theatre2:"@bg_theatre2-7b227b621f.png"},debug:!0,targets:["web"]},ads_backgrounds_bg_tree:{urls:{bg_tree:"@bg_tree-d86847c40d.jpg"},debug:!0,targets:["web"]},ads_backgrounds_bg_tree1:{urls:{bg_tree1:"@bg_tree1-8ae2b2151c.jpg"},debug:!0,targets:["web"]},ads_backgrounds_bg_tree2:{urls:{bg_tree2:"@bg_tree2-84bb29b0f0.jpg"},debug:!0,targets:["web"]},ads_backgrounds_bg_tree3:{urls:{bg_tree3:"@bg_tree3-11c0a90fb1.jpg"},debug:!0,targets:["web"]},ads_backgrounds_bg_tree4:{urls:{bg_tree4:"@bg_tree4-9c8d4cd51a.jpg"},debug:!0,targets:["web"]},ads_backgrounds_bg_tree5:{urls:{bg_tree5:"@bg_tree5-b27f737978.jpg"},debug:!0,targets:["web"]},ads_backgrounds_bg_tree6:{urls:{
bg_tree6:"@bg_tree6-8524894b76.jpg"},debug:!0,targets:["web"]},ads_backgrounds_bg_tree7:{urls:{bg_tree7:"@bg_tree7-8daec8d4b8.jpg"},debug:!0,targets:["web"]},ads_backgrounds_bg_valentin:{urls:{bg_valentin:"@bg_valentin-58021e7184.png"},debug:!0,targets:["web"]},ads_backgrounds_bottom_background:{urls:{bottom_background:"@bottom_background-077b5c26e0.jpg"},debug:!0,targets:["web"]},ads_backgrounds_cheese_background:{urls:{cheese_background:"@cheese_background-11cbc65590.jpg"},debug:!0,targets:["web"]},ads_backgrounds_chocolate_background:{urls:{chocolate_background:"@chocolate_background-1b39023b01.jpg"},debug:!0,targets:["web"]},ads_backgrounds_feathers_background:{urls:{feathers_background:"@feathers_background-d37d8f640b.jpg"},debug:!0,targets:["web"]},ads_backgrounds_juice_background:{urls:{juice_background:"@juice_background-292e632d5e.jpg"},debug:!0,targets:["web"]},ads_backgrounds_merge_custom_landscape:{urls:{merge_custom_landscape:"@merge_custom_landscape-82946a6dfb.png"},
debug:!0,targets:["web"]},ads_backgrounds_merge_custom_landscape_blur:{urls:{merge_custom_landscape_blur:"@merge_custom_landscape_blur-73adbb16dc.png"},debug:!0,targets:["web"]},ads_backgrounds_merge_custom_portrait:{urls:{merge_custom_portrait:"@merge_custom_portrait-6dd3bb4fd5.png"},debug:!0,targets:["web"]},ads_backgrounds_merge_custom_portrait_blur:{urls:{merge_custom_portrait_blur:"@merge_custom_portrait_blur-c612571713.png"},debug:!0,targets:["web"]},ads_backgrounds_pyramids_bg:{urls:{pyramids_bg:"@pyramids_bg-37d9ccd593.jpg"},debug:!0,targets:["web"]},ads_backgrounds_seabeach_bg:{urls:{seabeach_bg:"@seabeach_bg-34ec9cecaa.jpg"},debug:!0,targets:["web"]},ads_backgrounds_violet_bg:{urls:{violet_bg:"@violet_bg-364080cd73.jpg"},debug:!0,targets:["web"]},ads_backgrounds_xmasbg1:{urls:{xmasbg1:"@xmasbg1-c356cc117f.jpg"},debug:!0,targets:["web"]},ads_backgrounds_xmasbg2:{urls:{xmasbg2:"@xmasbg2-4a0d4c6bd7.jpg"},debug:!0,targets:["web"]},ads_bar:{urls:{png:"@%n-4e283ff29d.png",
json:"@%n-768a12c082.json"},jsons:{plist:"@%n-4e283ff29d.plist"},frames:{"1_cristmas_santa":"#%n-bar-1_cristmas_santa.png",bar_bg_brown:"#%n-bar-bar_bg_brown.png",bar_bg_field:"#%n-bar-bar_bg_field.png",bar_bg_halloween_blue:"#%n-bar-bar_bg_halloween_blue.png",bar_bg_halloween_green:"#%n-bar-bar_bg_halloween_green.png",bar_bg_medieval:"#%n-bar-bar_bg_medieval.png",bar_bg_white:"#%n-bar-bar_bg_white.png",bar_brown:"#%n-bar-bar_brown.png",bar_green:"#%n-bar-bar_green.png",bar_halloween_blue:"#%n-bar-bar_halloween_blue.png",bar_halloween_green:"#%n-bar-bar_halloween_green.png",bar_medieval:"#%n-bar-bar_medieval.png",bar_pink:"#%n-bar-bar_pink.png",bar_purple:"#%n-bar-bar_purple.png",bg_bar_green:"#%n-bar-bg_bar_green.png",bg_gold_bar:"#%n-bar-bg_gold_bar.png",brain:"#%n-bar-brain.png",cat:"#%n-bar-cat.png",coin:"#%n-bar-coin.png",coins_pot:"#%n-bar-coins_pot.png",cookie:"#%n-bar-cookie.png",element_lvl_1_halloween_blue:"#%n-bar-element_lvl_1_halloween_blue.png",
element_lvl_1_halloween_green:"#%n-bar-element_lvl_1_halloween_green.png",element_lvl_2_halloween_blue:"#%n-bar-element_lvl_2_halloween_blue.png",element_lvl_2_halloween_green:"#%n-bar-element_lvl_2_halloween_green.png",element_lvl_3_halloween_blue:"#%n-bar-element_lvl_3_halloween_blue.png",element_lvl_3_halloween_green:"#%n-bar-element_lvl_3_halloween_green.png",element_lvl_4_halloween_blue:"#%n-bar-element_lvl_4_halloween_blue.png",element_lvl_4_halloween_green:"#%n-bar-element_lvl_4_halloween_green.png",fruitbar_green:"#%n-bar-fruitbar_green.png",fruitbar_orange_avatar:"#%n-bar-fruitbar_orange_avatar.png",fruitbar_orange_bg:"#%n-bar-fruitbar_orange_bg.png",glow_under_the_element_halloween_blue:"#%n-bar-glow_under_the_element_halloween_blue.png",glow_under_the_element_halloween_green:"#%n-bar-glow_under_the_element_halloween_green.png",gold_bar:"#%n-bar-gold_bar.png",gray_bar:"#%n-bar-gray_bar.png"},debug:!0,targets:["web"]},ads_buttons:{urls:{png:"@%n-aca4ed7de6.png",
json:"@%n-175d62fc98.json"},jsons:{plist:"@%n-aca4ed7de6.plist"},frames:{ads_purpure_button:"#%n-buttons-purpure_button1.png",ads_purpure_button_on:"#%n-buttons-purpure_button2.png"},debug:!0,targets:["web"]},ads_counter:{urls:{heartbeat_effect:"~sounds/heartbeat-fc3b9f3626.mp3",png:"@%n-b5d1300307.png",json:"@%n-702415b742.json"},jsons:{brain_json:"@jsons/brain-8ccd592401.json",heart_json:"@jsons/heart-da0f8e98e9.json",plist:"@%n-b5d1300307.plist",atlas:"@%n-b5d1300307.atlas"},frames:{underscore_png:"#%n-counter-underscore.png"},debug:!0,targets:["web"]},ads_exclamations:{urls:{exclamation_effect_0:"~sounds/exclamation_2-efe7a759e9.mp3",exclamation_effect_1:"~sounds/exclamation_2-efe7a759e9.mp3",exclamation_effect_2:"~sounds/exclamation_2-efe7a759e9.mp3",exclamation_effect_3:"~sounds/exclamation_2-efe7a759e9.mp3",png:"@%n-e38567cc49.png",json:"@%n-bf97009d33.json"},jsons:{exclamation_0:"@jsons/amazing-cdb46335e0.json",exclamation_1:"@jsons/good-6ba2017407.json",
exclamation_2:"@jsons/great-77253a79a8.json",exclamation_3:"@jsons/perfect-256b4331d7.json",atlas:"@%n-e38567cc49.atlas"},debug:!0,targets:["web"]},ads_finger:{urls:{png:"@%n-40a6e3b299.png",json:"@%n-595ea8d497.json"},jsons:{plist:"@%n-40a6e3b299.plist"},frames:{finger_png:"#%n-fingers-hand.png",finger_merge_png:"#%n-fingers-merge_hand.png",finger_halloween_png:"#%n-fingers-hand_halloween.png",finger_xmas_png:"#%n-fingers-mitten.png",finger_candy_cane:"#%n-fingers-candy_cane.png",finger_riddles_hand:"#%n-fingers-riddles_hand.png",finger_heroes_hand:"#%n-fingers-heroes_hand.png",finger_adventure_hand:"#%n-fingers-adventure_hand.png",finger_cartoon_png:"#%n-fingers-cartoon_finger.png",finger_realistic_png:"#%n-fingers-realistic_finger.png"},debug:!0,targets:["web"]},ads_keypad:{urls:{png:"@%n-a7c2681edb.png",json:"@%n-ab92c81b61.json"},jsons:{letters_bottom_stone:"@jsons/letters_bottom_stone-d338bb5840.json",letters_ice:"@jsons/letters_ice-edc392ac83.json",
letters_icecream:"@jsons/letters_icecream-09522c6082.json",letters_pillow:"@jsons/letters_pillow-8ed19aaf4c.json",letters_red:"@jsons/letters_red-1415578b3d.json",shatter_animation:"@jsons/shatter_animation-7b9914f25c.json",atlas:"@%n-a7c2681edb.atlas"},debug:!0,targets:["web"]},ads_logo:{urls:{logo_effect_1:"~sounds/logo_effect_1-ff0e590076.mp3",logo_effect_2:"~sounds/logo_effect_2-708f7c1532.mp3",logo_effect_3:"~sounds/logo_effect_3-caa603c323.mp3",logo_effect_4:"~sounds/logo_effect_4-220f73d8be.mp3",logo_effect_5:"~sounds/logo_effect_5-9e7da01b31.mp3",logo_effect_cards:"~sounds/logo_effect_cards-2379013619.mp3",logo_merge_effect:"~sounds/logo_merge_effect-78b13ebd62.mp3"},debug:!0,targets:["web"]},ads_map2d:{urls:{cloud_merge_effect:"~sounds/cloud_merge-099ef6dfe7.mp3",png:"@%n-5cc041e82d.png",json:"@%n-1d99d050c1.json"},jsons:{merge_json:"@jsons/merch-35e7e04e1d.json",collect_json:"@jsons/collect-90a64e1d03.json",highlight:"@jsons/highlight-4c3006f6bf.json",
atlas:"@%n-5cc041e82d.atlas"},debug:!0,targets:["web"]},ads_map2d_terrain_ice:{urls:{png:"@%n-bd6020de3a.png",json:"@%n-471475343e.json"},jsons:{plist:"@%n-bd6020de3a.plist"},frames:{green_board:"#%n-ice-green_board.png",green_board_angle:"#%n-ice-green_board_angle.png",ground_1:"#%n-ice-ground_1.png",ground_2:"#%n-ice-ground_2.png",grow12_both:"#%n-ice-grow12_both.png",grow12_left:"#%n-ice-grow12_left.png",grow12_right:"#%n-ice-grow12_right.png",level1_down_both:"#%n-ice-level1_down_both.png",level1_down_corner:"#%n-ice-level1_down_corner.png",level1_down_left:"#%n-ice-level1_down_left.png",level1_down_left_only:"#%n-ice-level1_down_left_only.png",level1_down_right:"#%n-ice-level1_down_right.png",level1_down_right_only:"#%n-ice-level1_down_right_only.png",level1_left_corner:"#%n-ice-level1_left_corner.png",level1_left_inner:"#%n-ice-level1_left_inner.png",level1_left_inner_last:"#%n-ice-level1_left_inner_last.png",level1_right_corner:"#%n-ice-level1_right_corner.png",
level1_right_inner:"#%n-ice-level1_right_inner.png",level1_right_inner_last:"#%n-ice-level1_right_inner_last.png",level1_up_both:"#%n-ice-level1_up_both.png",level1_up_corner:"#%n-ice-level1_up_corner.png",level1_up_left_only:"#%n-ice-level1_up_left_only.png",level1_up_left_only_last:"#%n-ice-level1_up_left_only_last.png",level1_up_right_only:"#%n-ice-level1_up_right_only.png",level1_up_right_only_last:"#%n-ice-level1_up_right_only_last.png",level2_left_inner:"#%n-ice-level2_left_inner.png",level2_left_inner_last:"#%n-ice-level2_left_inner_last.png",level2_right_inner:"#%n-ice-level2_right_inner.png",level2_right_inner_last:"#%n-ice-level2_right_inner_last.png",level2_up_both:"#%n-ice-level2_up_both.png",level2_up_both2:"#%n-ice-level2_up_both2.png",level2_up_corner:"#%n-ice-level2_up_corner.png",level2_up_corner2:"#%n-ice-level2_up_corner2.png",level2_up_left_only:"#%n-ice-level2_up_left_only.png",level2_up_left_only2:"#%n-ice-level2_up_left_only2.png",
level2_up_left_only_last:"#%n-ice-level2_up_left_only_last.png",level2_up_right_only:"#%n-ice-level2_up_right_only.png",level2_up_right_only2:"#%n-ice-level2_up_right_only2.png",level2_up_right_only_last:"#%n-ice-level2_up_right_only_last.png",side_angle_2:"#%n-ice-side_angle_2.png",water_up_both:"#%n-ice-water_up_both.png",water_up_left_only:"#%n-ice-water_up_left_only.png",water_up_left_only_last:"#%n-ice-water_up_left_only_last.png",water_up_right_only:"#%n-ice-water_up_right_only.png",water_up_right_only_last:"#%n-ice-water_up_right_only_last.png"},debug:!0,targets:["web"]},ads_map2d_terrain_purple:{urls:{png:"@%n-434eaa8d4c.png",json:"@%n-9eac156e3a.json"},jsons:{plist:"@%n-434eaa8d4c.plist"},frames:{green_board:"#%n-purple-green_board.png",green_board_angle:"#%n-purple-green_board_angle.png",ground_1:"#%n-purple-ground_1.png",ground_2:"#%n-purple-ground_2.png",grow12_both:"#%n-purple-grow12_both.png",grow12_corner:"#%n-purple-grow12_corner.png",
grow12_left:"#%n-purple-grow12_left.png",grow12_right:"#%n-purple-grow12_right.png",level1_down_both:"#%n-purple-level1_down_both.png",level1_down_corner:"#%n-purple-level1_down_corner.png",level1_down_left:"#%n-purple-level1_down_left.png",level1_down_left_only:"#%n-purple-level1_down_left_only.png",level1_down_right:"#%n-purple-level1_down_right.png",level1_down_right_only:"#%n-purple-level1_down_right_only.png",level1_left_corner:"#%n-purple-level1_left_corner.png",level1_left_inner:"#%n-purple-level1_left_inner.png",level1_left_inner_last:"#%n-purple-level1_left_inner_last.png",level1_right_corner:"#%n-purple-level1_right_corner.png",level1_right_inner:"#%n-purple-level1_right_inner.png",level1_right_inner_last:"#%n-purple-level1_right_inner_last.png",level1_up_both:"#%n-purple-level1_up_both.png",level1_up_corner:"#%n-purple-level1_up_corner.png",level1_up_left_only:"#%n-purple-level1_up_left_only.png",level1_up_left_only_last:"#%n-purple-level1_up_left_only_last.png",
level1_up_right_only:"#%n-purple-level1_up_right_only.png",level1_up_right_only_last:"#%n-purple-level1_up_right_only_last.png",level2_left_inner:"#%n-purple-level2_left_inner.png",level2_left_inner_last:"#%n-purple-level2_left_inner_last.png",level2_right_inner:"#%n-purple-level2_right_inner.png",level2_right_inner_last:"#%n-purple-level2_right_inner_last.png",level2_up_both:"#%n-purple-level2_up_both.png",level2_up_both2:"#%n-purple-level2_up_both2.png",level2_up_corner:"#%n-purple-level2_up_corner.png",level2_up_corner2:"#%n-purple-level2_up_corner2.png",level2_up_left_only:"#%n-purple-level2_up_left_only.png",level2_up_left_only2:"#%n-purple-level2_up_left_only2.png",level2_up_left_only_last:"#%n-purple-level2_up_left_only_last.png",level2_up_right_only:"#%n-purple-level2_up_right_only.png",level2_up_right_only2:"#%n-purple-level2_up_right_only2.png",level2_up_right_only_last:"#%n-purple-level2_up_right_only_last.png",side_angle_2:"#%n-purple-side_angle_2.png",
water_up_both:"#%n-purple-water_up_both.png",water_up_left_only:"#%n-purple-water_up_left_only.png",water_up_left_only_last:"#%n-purple-water_up_left_only_last.png",water_up_right_only:"#%n-purple-water_up_right_only.png",water_up_right_only_last:"#%n-purple-water_up_right_only_last.png"},debug:!0,targets:["web"]},ads_map2d_terrain_sand:{urls:{png:"@%n-cf047761b4.png",json:"@%n-8d755e35d5.json"},jsons:{plist:"@%n-cf047761b4.plist"},frames:{green_board:"#%n-sand-green_board.png",green_board_angle:"#%n-sand-green_board_angle.png",ground_1:"#%n-sand-ground_1.png",ground_2:"#%n-sand-ground_2.png",grow12_both:"#%n-sand-grow12_both.png",grow12_corner:"#%n-sand-grow12_corner.png",grow12_left:"#%n-sand-grow12_left.png",grow12_right:"#%n-sand-grow12_right.png",level1_down_both:"#%n-sand-level1_down_both.png",level1_down_corner:"#%n-sand-level1_down_corner.png",level1_down_left:"#%n-sand-level1_down_left.png",level1_down_left_only:"#%n-sand-level1_down_left_only.png",
level1_down_right:"#%n-sand-level1_down_right.png",level1_down_right_only:"#%n-sand-level1_down_right_only.png",level1_left_corner:"#%n-sand-level1_left_corner.png",level1_left_inner:"#%n-sand-level1_left_inner.png",level1_left_inner_last:"#%n-sand-level1_left_inner_last.png",level1_right_corner:"#%n-sand-level1_right_corner.png",level1_right_inner:"#%n-sand-level1_right_inner.png",level1_right_inner_last:"#%n-sand-level1_right_inner_last.png",level1_up_both:"#%n-sand-level1_up_both.png",level1_up_corner:"#%n-sand-level1_up_corner.png",level1_up_left_only:"#%n-sand-level1_up_left_only.png",level1_up_left_only_last:"#%n-sand-level1_up_left_only_last.png",level1_up_right_only:"#%n-sand-level1_up_right_only.png",level1_up_right_only_last:"#%n-sand-level1_up_right_only_last.png",level2_left_inner:"#%n-sand-level2_left_inner.png",level2_left_inner_last:"#%n-sand-level2_left_inner_last.png",level2_right_inner:"#%n-sand-level2_right_inner.png",
level2_right_inner_last:"#%n-sand-level2_right_inner_last.png",level2_up_both:"#%n-sand-level2_up_both.png",level2_up_both2:"#%n-sand-level2_up_both2.png",level2_up_corner:"#%n-sand-level2_up_corner.png",level2_up_corner2:"#%n-sand-level2_up_corner2.png",level2_up_left_only:"#%n-sand-level2_up_left_only.png",level2_up_left_only2:"#%n-sand-level2_up_left_only2.png",level2_up_left_only_last:"#%n-sand-level2_up_left_only_last.png",level2_up_right_only:"#%n-sand-level2_up_right_only.png",level2_up_right_only2:"#%n-sand-level2_up_right_only2.png",level2_up_right_only_last:"#%n-sand-level2_up_right_only_last.png",side_angle_2:"#%n-sand-side_angle_2.png",water_up_left_only:"#%n-sand-water_up_left_only.png",water_up_left_only_last:"#%n-sand-water_up_left_only_last.png",water_up_right_only:"#%n-sand-water_up_right_only.png",water_up_right_only_last:"#%n-sand-water_up_right_only_last.png"},debug:!0,targets:["web"]},ads_menu:{urls:{png:"@%n-87755f914b.png",json:"@%n-44c947c800.json"},jsons:{
plist:"@%n-87755f914b.plist"},frames:{cat_0:"#%n-cat_0.png",cat_1:"#%n-cat_1.png",cat_2:"#%n-cat_2.png",title_blue:"#%n-title_blue.png",title_orange:"#%n-title_orange.png",title_red:"#%n-title_red.png"},debug:!0,targets:["web"]},ads_scale:{urls:{electro_brain_effect:"~sounds/electro_brain-c79cdf8513.mp3",png:"@%n-0306b6d991.png",json:"@%n-17f90fd377.json"},jsons:{brain_pointer:"@jsons/smartbrain-c85815f9fc.json",brain_cute_pointer:"@jsons/cutebrain-a45a1ec5c7.json",witch_pointer_json:"@jsons/witch_animation-9b9dc7dc23.json",colorcupid_heart_json:"@jsons/colorcupid_heart-19aa9beb21.json",solidcupid_heart_json:"@jsons/solidcupid_heart-3adab32088.json",plist:"@%n-0306b6d991.plist",atlas:"@%n-0306b6d991.atlas"},frames:{einstein_brown_bg:"#%n-scale-smartbrain_brown_einstein_brown.png",einstein_yellow_bg:"#%n-scale-smartbrain_white_einstein_yellow.png",cute_brain_bg:"#%n-scale-cutebrain_grandma_pink.png",witch_bg:"#%n-scale-witch_house.png",witch_pointer:"#%n-scale-witch.png",
xmas_bar:"#%n-scale-xmas_bar.png",xmas_santa_bar:"#%n-scale-xmas_santa_bar.png",cupid_heart_scale:"#%n-scale-cupid_heart_scale.png"},debug:!0,targets:["web"]},ads_sfx_common:{urls:{ads_win_1:"~sounds/ads_win_1-022a291661.mp3",ads_win_2:"~sounds/ads_win_2-fd4acf3c56.mp3",ads_win_3:"~sounds/ads_win_3-12f9747274.mp3",bear_choice:"~sounds/bear_choice-cb10e429b1.mp3",bear_says:"~sounds/bear_says-aff725f95f.mp3",character_selection:"~sounds/character_selection-654bdaefa5.mp3",goblin_choice:"~sounds/goblin_choice-73986ca46d.mp3",goblin_says:"~sounds/goblin_says-2b1360a529.mp3",island_emerging:"~sounds/island_emerging-9cb1ea2f4b.mp3",laugh_female:"~sounds/laugh_female-03ec151601.mp3",laugh_female_1:"~sounds/laugh_female_1-16d5e62f1c.mp3",laugh_king:"~sounds/laugh_king-8854b7247a.mp3",laugh_knight:"~sounds/laugh_knight-67647ad575.mp3",merge_effect1:"~sounds/merge_effect1-c05f58d62d.mp3",merge_effect2:"~sounds/merge_effect2-7df540d699.mp3",spawn_landing2:"~sounds/spawn_landing2-169e1e03fb.mp3",
swipe:"~sounds/swipe-ac85d34b97.mp3"},debug:!0,targets:["web"]},ads_spines:{urls:{png:"@%n-0b60deeb68.png",json:"@%n-5873b696fa.json"},jsons:{grandpa_json:"@jsons/grandpa-edb7c9d2b3.json",grandma_json:"@jsons/grandma-78e8d2e3e1.json",snowman_json:"@jsons/snowman-2345d31f9d.json",xmas_tree_json:"@jsons/tree-6db997a1f8.json",clouds_json:"@jsons/clouds-fc1cf17bef.json",grandma_intro_json:"@jsons/grandma-951bb40d52.json",grandpa_intro_json:"@jsons/grandpa-bceb817598.json",grandpa_valentine_intro_json:"@jsons/grandpa_valentine-9590e3adc9.json",dialog_json:"@jsons/dialog-7ff588238c.json",dialog_no_clouds:"@jsons/dialog_no_clouds-9e9aeff8bf.json",energy_bug:"@jsons/energy_bug-ff67bfebde.json",energy_bug_midle:"@jsons/energy_bug_midle-378cad2860.json",energy_bug_mini:"@jsons/energy_bug_mini-4bbd959009.json",emeralda:"@jsons/emeralda-d44fafd08e.json",enchantress:"@jsons/enchantress-96f4ac96ff.json",king:"@jsons/king-16f7082732.json",bear:"@jsons/bear-c16fb05c11.json",
troll:"@jsons/troll-cfda66417d.json",green_island:"@jsons/green_island-c1f445c229.json",ice_island:"@jsons/ice_island-64446d3fcc.json",sand_island:"@jsons/sand_island-f5dc7e5e22.json",harvest_pumpkin:"@jsons/harvest_pumpkin-a90ef63fdf.json",merge_sapphire:"@jsons/merge_sapphire-c5444655f2.json",merge_wand:"@jsons/merge_wand-a9e083e48a.json",atlas:"@%n-0b60deeb68.atlas"},debug:!0,targets:["web"]},ads_sprites:{urls:{png:"@%n-eed6579204.png",json:"@%n-0aae0e712a.json"},jsons:{plist:"@%n-eed6579204.plist"},frames:{build_combo:"#%n-sprites-build_combo.png",build_dwarf:"#%n-sprites-build_dwarf.png",coins:"#%n-sprites-coins.png",design_fence:"#%n-sprites-design_fence.png",design_fence_left:"#%n-sprites-design_fence_left.png",design_fence_left_landscape:"#%n-sprites-design_fence_left_landscape.png",design_fence_right:"#%n-sprites-design_fence_right.png",design_fence_right_landscape:"#%n-sprites-design_fence_right_landscape.png",energy:"#%n-sprites-energy.png",
harvest_bed:"#%n-sprites-harvest_bed.png",harvest_shovel:"#%n-sprites-harvest_shovel.png",level:"#%n-sprites-level.png",marketing_buble_cake:"#%n-sprites-marketing_buble_cake.png",marketing_cloud:"#%n-sprites-marketing_cloud.png",marketing_corn:"#%n-sprites-marketing_corn.png",marketing_hero_svin:"#%n-sprites-marketing_hero_svin.png",marketing_korol:"#%n-sprites-marketing_korol.png",marketing_light_effect:"#%n-sprites-marketing_light_effect.png",marketing_magic:"#%n-sprites-marketing_magic.png",marketing_scroll:"#%n-sprites-marketing_scroll.png",marketing_strawberry:"#%n-sprites-marketing_strawberry.png",marketing_tower:"#%n-sprites-marketing_tower.png",marketing_tree:"#%n-sprites-marketing_tree.png",new_sceenshot_text:"#%n-sprites-new_sceenshot_text.png",screenshot_text:"#%n-sprites-screenshot_text.png",select_hero:"#%n-sprites-select_hero.png",tree_1:"#%n-sprites-tree_1.png",tree_2:"#%n-sprites-tree_2.png",wands:"#%n-sprites-wands.png"},debug:!0,targets:["web"]},ads_title:{urls:{
png:"@%n-f4f3e20ad1.png",json:"@%n-f2b49f8d80.json"},jsons:{plist:"@%n-f4f3e20ad1.plist"},frames:{autumn_bg:"#%n-substrate-autumn_title.png",shanghai_bg:"#%n-substrate-shanghai_title.png",wood_bg:"#%n-substrate-wood_title.png",halloween_bg:"#%n-substrate-halloween_title.png",newyork_bg:"#%n-substrate-newyork_title.png",darkred_word_bg:"#%n-substrate-darkred_word.png",darkred_letter_bg:"#%n-substrate-darkred_letter.png",blackpurple_word_bg:"#%n-substrate-blackpurple_word.png",blackpurple_letter_bg:"#%n-substrate-blackpurple_letter.png",darkpurple_word_bg:"#%n-substrate-darkpurple_word.png",darkpurple_letter_bg:"#%n-substrate-darkpurple_letter.png",blueorange_word_bg:"#%n-substrate-blueorange_word.png",blueorange_letter_bg:"#%n-substrate-blueorange_letter.png",pinkblue_word_bg:"#%n-substrate-pinkblue_word.png",letter_keypad_bg_halloween_green_bg:"#%n-substrate-letter_keypad_bg_halloween_green.png",ribbon_title:"#%n-substrate-ribbon_title.png",dark_title:"#%n-substrate-dark_title.png",
pink_title:"#%n-substrate-pink_title.png",hexagreen_letter_bg:"#%n-substrate-hexagreen_letter.png",blueblue_letter_bg:"#%n-substrate-blueblue_letter.png",pinup_dance_bg:"#%n-substrate-pinup_dance.png",table_bg:"#%n-substrate-table_bg.png",black_title:"#%n-substrate-black_title.png",light_grey_field:"#%n-substrate-light_grey_field.png",brown_field:"#%n-substrate-brown_field.png",transparent_white_title:"#%n-substrate-transparent_white_title.png",violet_flower_mini:"#%n-substrate-violet_flower_mini.png",seabeach_starfish_mini:"#%n-substrate-seabeach_starfish_mini.png",pyramid_mini:"#%n-substrate-pyramid_mini.png",cherry_mini:"#%n-substrate-cherry_mini.png",ananas_mini:"#%n-substrate-ananas_mini.png",seashell_mini:"#%n-substrate-seashell_mini.png",cheese_mini:"#%n-substrate-cheese_mini.png",feather_mini:"#%n-substrate-feather_mini.png",orange_mini:"#%n-substrate-orange_mini.png",coin_add:"#%n-substrate-coin_add.png",coin_bar:"#%n-substrate-coin_bar.png",
wood_counter_bar:"#%n-substrate-wood_counter.png",rays:"#%n-substrate-rays.png",picture_1:"#%n-substrate-picture_1.png",picture_2:"#%n-substrate-picture_2.png",seabeach_title:"#%n-substrate-seabeach_title.png",merge_logo:"#%n-substrate-merge_logo.png",merge_logo_ru:"#%n-substrate-merge_logo_ru.png",fleid_frame_dark:"#%n-substrate-fleid_frame_dark.png",text_bg_merge:"#%n-substrate-mini_bg.png",text_bg_merge_arrow:"#%n-substrate-mini_bg_arrow.png",text_bg_blue:"#%n-substrate-text_bg_blue.png",text_bg_green:"#%n-substrate-text_bg_green.png",text_bg_green_arrow:"#%n-substrate-text_bg_green_arrow.png"},debug:!0,targets:["web"]},ads_transition:{urls:{transition_effect:"~sounds/curtain-c5490e2983.mp3",tile_transition_effect:"~sounds/tile_transition-ce1d394f9c.mp3"},debug:!0,targets:["web"]},ads_tree:{urls:{progress_effect:"~sounds/progress-afab20c956.mp3",dog_yip_effect:"~sounds/dog_yip-7299e33adf.mp3",cat_meow_effect:"~sounds/cat_meow-606abe0100.mp3",
cat_purr_effect:"~sounds/cat_purr-df1b274867.mp3",foliage_effect:"~sounds/foliage-edcff252ea.mp3",snowman_progress_effect:"~sounds/snowman-689970839a.mp3",snowman_pass_effect:"~sounds/christmas_pass-56a43eddc6.mp3",tree_progress_effect:"~sounds/tree-0098a6093c.mp3",png:"@%n-6c17dfa0b5.png",json:"@%n-7a1873158c.json"},jsons:{dog_json:"@jsons/dog-a45f7877bf.json",cat_json:"@jsons/cat-3405f1aa5c.json",xmas_cat_json:"@jsons/hero_xmas-7dc97951c4.json",tree_json:"@jsons/tree-a62d30dbeb.json",tree_in_pot_json:"@jsons/tree_in_pot-7e4eef640e.json",snowman_json:"@jsons/snowman-2345d31f9d.json",xmas_tree_json:"@jsons/tree-6db997a1f8.json",atlas:"@%n-6c17dfa0b5.atlas"},debug:!0,targets:["web"]},ads_words_list:{urls:{strike_effect:"~sounds/strikethrough-6f7b949dbf.mp3",strike_effect_valentine:"~sounds/arrow_fly-be6bf2d76c.mp3",png:"@%n-c82f237fb3.png",json:"@%n-9e0afaa478.json"},jsons:{strike_json:"@jsons/strike-ef7ddbb8c0.json",sparkles_json:"@jsons/animation-6f92f6f792.json",
plist:"@%n-c82f237fb3.plist",atlas:"@%n-c82f237fb3.atlas"},frames:{ananas_yellow_wbg:"#%n-words_list-ananas_yellow_wbg.png",blackblue_word:"#%n-words_list-blackblue_word.png",blackpurple_word:"#%n-words_list-blackpurple_word.png",blue_ice_wbg:"#%n-words_list-blue_ice_wbg.png",blueblue_word:"#%n-words_list-blueblue_word.png",blueorange_word:"#%n-words_list-blueorange_word.png",bottom_bllue_wbg:"#%n-words_list-bottom_bllue_wbg.png",bottom_pink_wbg:"#%n-words_list-bottom_pink_wbg.png",cheese_red_wbg:"#%n-words_list-cheese_red_wbg.png",cheese_yellow_wbg:"#%n-words_list-cheese_yellow_wbg.png",chocolate_dark_wbg:"#%n-words_list-chocolate_dark_wbg.png",chocolate_pink_wbg:"#%n-words_list-chocolate_pink_wbg.png",cyanorange_word:"#%n-words_list-cyanorange_word.png",darkpurple_word:"#%n-words_list-darkpurple_word.png",darkred_word:"#%n-words_list-darkred_word.png",greyblue_word:"#%n-words_list-greyblue_word.png",greygrey_word:"#%n-words_list-greygrey_word.png",
hexagreen_word:"#%n-words_list-hexagreen_word.png",hexaindigo_word:"#%n-words_list-hexaindigo_word.png",juice_orange_wbg:"#%n-words_list-juice_orange_wbg.png",marbelbrown_word:"#%n-words_list-marbelbrown_word.png",marbelyellow_word:"#%n-words_list-marbelyellow_word.png",orange_word:"#%n-words_list-orange_word.png",orangeline_valentine_word_bg:"#%n-words_list-orangeline_valentine_word_bg.png",pillow_green_wbg:"#%n-words_list-pillow_green_wbg.png",pillow_pink_wbg:"#%n-words_list-pillow_pink_wbg.png",pinkblue_word:"#%n-words_list-pinkblue_word.png",pinkpink_word:"#%n-words_list-pinkpink_word.png",seabeach_substrate:"#%n-words_list-seabeach_substrate.png",seabeach_substrate_white:"#%n-words_list-seabeach_substrate_white.png",violet_substrate:"#%n-words_list-violet_substrate.png",violet_turquoise_substare:"#%n-words_list-violet_turquoise_substare.png",woodbrown_word:"#%n-words_list-woodbrown_word.png",woodwhite_word:"#%n-words_list-woodwhite_word.png",
yellow_word:"#%n-words_list-yellow_word.png"},debug:!0,targets:["web"]},ads_words_result:{urls:{show_effect:"~sounds/counter-2ac74abdf1.mp3",png:"@%n-169a89f1fd.png",json:"@%n-6f72b1dbea.json"},jsons:{grandpa_json:"@jsons/grandpa-edb7c9d2b3.json",plist:"@%n-169a89f1fd.plist",atlas:"@%n-169a89f1fd.atlas"},frames:{line_png:"#%n-words_result-line.png"}},avatar:{urls:{},injectTo:["main"],frameIds:["%n_frame","%n_frame2"],jsonIds:[],soundIds:[],unpackedIds:[]},battle_pass:{urls:{png:"@%n-4a8b7e987f.png",json:"@%n-ea7a4b0bc5.json"},jsons:{ticket_json:"@jsons/battlepass_ticket-56dc4d77d4.json",shining_json:"@jsons/blik_pass-67ae82156e.json",plist:"@%n-4a8b7e987f.plist",atlas:"@%n-4a8b7e987f.atlas"},frames:{progress_gradient:"#%n-gradient_goldpass.png",progress_lines:"#%n-batlepass_brown.png",progress_bar:"#%n-goldpass_bar.png",progress_substrate:"#%n-goldpass_bar_bg.png",progress_arrows:"#%n-goldpass_bar_scala.png",progress_star:"#%n-goldpass_star.png",
ticket_background:"#%n-under_bg_goldpass.png",description_background:"#%n-under_worker_batlepass.png",build_task_icon:"#%n-worker_batlepass.png",shining:"#%n-blik_pass.png",timer_substrate:"#%n-timer_substrate.png",timer_icon:"#%n-timer_icon.png",guide_button_png:"#%n-guide_button.png",guide_button_on_png:"#%n-guide_button_on.png",offer_badge:"#%n-offer_badge.png",icon_background:"#%n-icon_background.png",icon_ribbon:"#%n-icon_ribbon.png"}},beatfriendwindow:{urls:{png:"@%n-9cd2fd2bb8.png",json:"@%n-c5a6085512.json"},jsons:{plist:"@%n-9cd2fd2bb8.plist"},frames:{beat_friend_bg_png:"#%n-windows-beat_friend_bg.png"}},bonus_round_window:{urls:{}},bonus_world_easter:{urls:{png:"@%n-eaf8db3173.png",json:"@%n-510528802b.json"},jsons:{plist:"@%n-eaf8db3173.plist"},frames:{nostroke62pt_0:"#%n-marvin-round-nostroke-62pt-0.png",nostroke62pt_1:"#%n-marvin-round-nostroke-62pt-1.png",nostroke62pt_2:"#%n-marvin-round-nostroke-62pt-2.png",nostroke62pt_3:"#%n-marvin-round-nostroke-62pt-3.png",
nostroke62pt_4:"#%n-marvin-round-nostroke-62pt-4.png",nostroke62pt_5:"#%n-marvin-round-nostroke-62pt-5.png",nostroke62pt_6:"#%n-marvin-round-nostroke-62pt-6.png",nostroke62pt_7:"#%n-marvin-round-nostroke-62pt-7.png",nostroke62pt_8:"#%n-marvin-round-nostroke-62pt-8.png",nostroke62pt_9:"#%n-marvin-round-nostroke-62pt-9.png",nostroke62pt_colon:"#%n-marvin-round-nostroke-62pt-colon.png",nostroke62pt_slash:"#%n-marvin-round-nostroke-62pt-slash.png",nostroke62pt_plus:"#%n-marvin-round-nostroke-62pt-plus.png",nostroke62pt_minus:"#%n-marvin-round-nostroke-62pt-minus.png",nostroke62pt_x:"#%n-marvin-round-nostroke-62pt-x.png",nostroke62pt_space:"#%n-marvin-round-nostroke-62pt-space.png",default45pt_0:"#%n-marvin-round-45pt-0.png",default45pt_1:"#%n-marvin-round-45pt-1.png",default45pt_2:"#%n-marvin-round-45pt-2.png",default45pt_3:"#%n-marvin-round-45pt-3.png",default45pt_4:"#%n-marvin-round-45pt-4.png",default45pt_5:"#%n-marvin-round-45pt-5.png",default45pt_6:"#%n-marvin-round-45pt-6.png",
default45pt_7:"#%n-marvin-round-45pt-7.png",default45pt_8:"#%n-marvin-round-45pt-8.png",default45pt_9:"#%n-marvin-round-45pt-9.png",default45pt_colon:"#%n-marvin-round-45pt-colon.png",default45pt_slash:"#%n-marvin-round-45pt-slash.png",default45pt_plus:"#%n-marvin-round-45pt-plus.png",default45pt_minus:"#%n-marvin-round-45pt-minus.png",default45pt_x:"#%n-marvin-round-45pt-x.png",default45pt_space:"#%n-marvin-round-45pt-space.png",default62pt_0:"#%n-marvin-round-62pt-0.png",default62pt_1:"#%n-marvin-round-62pt-1.png",default62pt_2:"#%n-marvin-round-62pt-2.png",default62pt_3:"#%n-marvin-round-62pt-3.png",default62pt_4:"#%n-marvin-round-62pt-4.png",default62pt_5:"#%n-marvin-round-62pt-5.png",default62pt_6:"#%n-marvin-round-62pt-6.png",default62pt_7:"#%n-marvin-round-62pt-7.png",default62pt_8:"#%n-marvin-round-62pt-8.png",default62pt_9:"#%n-marvin-round-62pt-9.png",default62pt_colon:"#%n-marvin-round-62pt-colon.png",default62pt_slash:"#%n-marvin-round-62pt-slash.png",
default62pt_plus:"#%n-marvin-round-62pt-plus.png",default62pt_minus:"#%n-marvin-round-62pt-minus.png",default62pt_x:"#%n-marvin-round-62pt-x.png",default62pt_space:"#%n-marvin-round-62pt-space.png",default76pt_0:"#%n-marvin-round-76pt-0.png",default76pt_1:"#%n-marvin-round-76pt-1.png",default76pt_2:"#%n-marvin-round-76pt-2.png",default76pt_3:"#%n-marvin-round-76pt-3.png",default76pt_4:"#%n-marvin-round-76pt-4.png",default76pt_5:"#%n-marvin-round-76pt-5.png",default76pt_6:"#%n-marvin-round-76pt-6.png",default76pt_7:"#%n-marvin-round-76pt-7.png",default76pt_8:"#%n-marvin-round-76pt-8.png",default76pt_9:"#%n-marvin-round-76pt-9.png",default76pt_colon:"#%n-marvin-round-76pt-colon.png",default76pt_slash:"#%n-marvin-round-76pt-slash.png",default76pt_plus:"#%n-marvin-round-76pt-plus.png",default76pt_minus:"#%n-marvin-round-76pt-minus.png",default76pt_x:"#%n-marvin-round-76pt-x.png",default76pt_space:"#%n-marvin-round-76pt-space.png"}},bonus_world_summer:{urls:{png:"@%n-50ce70c53d.png",
json:"@%n-02d09e25cb.json"},jsons:{plist:"@%n-50ce70c53d.plist"},frames:{nostroke62pt_0:"#%n-marvin-round-nostroke-62pt-0.png",nostroke62pt_1:"#%n-marvin-round-nostroke-62pt-1.png",nostroke62pt_2:"#%n-marvin-round-nostroke-62pt-2.png",nostroke62pt_3:"#%n-marvin-round-nostroke-62pt-3.png",nostroke62pt_4:"#%n-marvin-round-nostroke-62pt-4.png",nostroke62pt_5:"#%n-marvin-round-nostroke-62pt-5.png",nostroke62pt_6:"#%n-marvin-round-nostroke-62pt-6.png",nostroke62pt_7:"#%n-marvin-round-nostroke-62pt-7.png",nostroke62pt_8:"#%n-marvin-round-nostroke-62pt-8.png",nostroke62pt_9:"#%n-marvin-round-nostroke-62pt-9.png",nostroke62pt_colon:"#%n-marvin-round-nostroke-62pt-colon.png",nostroke62pt_slash:"#%n-marvin-round-nostroke-62pt-slash.png",nostroke62pt_plus:"#%n-marvin-round-nostroke-62pt-plus.png",nostroke62pt_minus:"#%n-marvin-round-nostroke-62pt-minus.png",nostroke62pt_x:"#%n-marvin-round-nostroke-62pt-x.png",nostroke62pt_space:"#%n-marvin-round-nostroke-62pt-space.png",
default45pt_0:"#%n-marvin-round-45pt-0.png",default45pt_1:"#%n-marvin-round-45pt-1.png",default45pt_2:"#%n-marvin-round-45pt-2.png",default45pt_3:"#%n-marvin-round-45pt-3.png",default45pt_4:"#%n-marvin-round-45pt-4.png",default45pt_5:"#%n-marvin-round-45pt-5.png",default45pt_6:"#%n-marvin-round-45pt-6.png",default45pt_7:"#%n-marvin-round-45pt-7.png",default45pt_8:"#%n-marvin-round-45pt-8.png",default45pt_9:"#%n-marvin-round-45pt-9.png",default45pt_colon:"#%n-marvin-round-45pt-colon.png",default45pt_slash:"#%n-marvin-round-45pt-slash.png",default45pt_plus:"#%n-marvin-round-45pt-plus.png",default45pt_minus:"#%n-marvin-round-45pt-minus.png",default45pt_x:"#%n-marvin-round-45pt-x.png",default45pt_space:"#%n-marvin-round-45pt-space.png",default62pt_0:"#%n-marvin-round-62pt-0.png",default62pt_1:"#%n-marvin-round-62pt-1.png",default62pt_2:"#%n-marvin-round-62pt-2.png",default62pt_3:"#%n-marvin-round-62pt-3.png",default62pt_4:"#%n-marvin-round-62pt-4.png",
default62pt_5:"#%n-marvin-round-62pt-5.png",default62pt_6:"#%n-marvin-round-62pt-6.png",default62pt_7:"#%n-marvin-round-62pt-7.png",default62pt_8:"#%n-marvin-round-62pt-8.png",default62pt_9:"#%n-marvin-round-62pt-9.png",default62pt_colon:"#%n-marvin-round-62pt-colon.png",default62pt_slash:"#%n-marvin-round-62pt-slash.png",default62pt_plus:"#%n-marvin-round-62pt-plus.png",default62pt_minus:"#%n-marvin-round-62pt-minus.png",default62pt_x:"#%n-marvin-round-62pt-x.png",default62pt_space:"#%n-marvin-round-62pt-space.png",default76pt_0:"#%n-marvin-round-76pt-0.png",default76pt_1:"#%n-marvin-round-76pt-1.png",default76pt_2:"#%n-marvin-round-76pt-2.png",default76pt_3:"#%n-marvin-round-76pt-3.png",default76pt_4:"#%n-marvin-round-76pt-4.png",default76pt_5:"#%n-marvin-round-76pt-5.png",default76pt_6:"#%n-marvin-round-76pt-6.png",default76pt_7:"#%n-marvin-round-76pt-7.png",default76pt_8:"#%n-marvin-round-76pt-8.png",default76pt_9:"#%n-marvin-round-76pt-9.png",
default76pt_colon:"#%n-marvin-round-76pt-colon.png",default76pt_slash:"#%n-marvin-round-76pt-slash.png",default76pt_plus:"#%n-marvin-round-76pt-plus.png",default76pt_minus:"#%n-marvin-round-76pt-minus.png",default76pt_x:"#%n-marvin-round-76pt-x.png",default76pt_space:"#%n-marvin-round-76pt-space.png"}},bonus_world_valentines:{urls:{png:"@%n-fb25065a40.png",json:"@%n-3a1ab1cf75.json"},jsons:{plist:"@%n-fb25065a40.plist"},frames:{nostroke62pt_0:"#%n-marvin-round-nostroke-62pt-0.png",nostroke62pt_1:"#%n-marvin-round-nostroke-62pt-1.png",nostroke62pt_2:"#%n-marvin-round-nostroke-62pt-2.png",nostroke62pt_3:"#%n-marvin-round-nostroke-62pt-3.png",nostroke62pt_4:"#%n-marvin-round-nostroke-62pt-4.png",nostroke62pt_5:"#%n-marvin-round-nostroke-62pt-5.png",nostroke62pt_6:"#%n-marvin-round-nostroke-62pt-6.png",nostroke62pt_7:"#%n-marvin-round-nostroke-62pt-7.png",nostroke62pt_8:"#%n-marvin-round-nostroke-62pt-8.png",nostroke62pt_9:"#%n-marvin-round-nostroke-62pt-9.png",
nostroke62pt_colon:"#%n-marvin-round-nostroke-62pt-colon.png",nostroke62pt_slash:"#%n-marvin-round-nostroke-62pt-slash.png",nostroke62pt_plus:"#%n-marvin-round-nostroke-62pt-plus.png",nostroke62pt_minus:"#%n-marvin-round-nostroke-62pt-minus.png",nostroke62pt_x:"#%n-marvin-round-nostroke-62pt-x.png",nostroke62pt_space:"#%n-marvin-round-nostroke-62pt-space.png",default45pt_0:"#%n-marvin-round-45pt-0.png",default45pt_1:"#%n-marvin-round-45pt-1.png",default45pt_2:"#%n-marvin-round-45pt-2.png",default45pt_3:"#%n-marvin-round-45pt-3.png",default45pt_4:"#%n-marvin-round-45pt-4.png",default45pt_5:"#%n-marvin-round-45pt-5.png",default45pt_6:"#%n-marvin-round-45pt-6.png",default45pt_7:"#%n-marvin-round-45pt-7.png",default45pt_8:"#%n-marvin-round-45pt-8.png",default45pt_9:"#%n-marvin-round-45pt-9.png",default45pt_colon:"#%n-marvin-round-45pt-colon.png",default45pt_slash:"#%n-marvin-round-45pt-slash.png",default45pt_plus:"#%n-marvin-round-45pt-plus.png",
default45pt_minus:"#%n-marvin-round-45pt-minus.png",default45pt_x:"#%n-marvin-round-45pt-x.png",default45pt_space:"#%n-marvin-round-45pt-space.png",default62pt_0:"#%n-marvin-round-62pt-0.png",default62pt_1:"#%n-marvin-round-62pt-1.png",default62pt_2:"#%n-marvin-round-62pt-2.png",default62pt_3:"#%n-marvin-round-62pt-3.png",default62pt_4:"#%n-marvin-round-62pt-4.png",default62pt_5:"#%n-marvin-round-62pt-5.png",default62pt_6:"#%n-marvin-round-62pt-6.png",default62pt_7:"#%n-marvin-round-62pt-7.png",default62pt_8:"#%n-marvin-round-62pt-8.png",default62pt_9:"#%n-marvin-round-62pt-9.png",default62pt_colon:"#%n-marvin-round-62pt-colon.png",default62pt_slash:"#%n-marvin-round-62pt-slash.png",default62pt_plus:"#%n-marvin-round-62pt-plus.png",default62pt_minus:"#%n-marvin-round-62pt-minus.png",default62pt_x:"#%n-marvin-round-62pt-x.png",default62pt_space:"#%n-marvin-round-62pt-space.png",default76pt_0:"#%n-marvin-round-76pt-0.png",default76pt_1:"#%n-marvin-round-76pt-1.png",
default76pt_2:"#%n-marvin-round-76pt-2.png",default76pt_3:"#%n-marvin-round-76pt-3.png",default76pt_4:"#%n-marvin-round-76pt-4.png",default76pt_5:"#%n-marvin-round-76pt-5.png",default76pt_6:"#%n-marvin-round-76pt-6.png",default76pt_7:"#%n-marvin-round-76pt-7.png",default76pt_8:"#%n-marvin-round-76pt-8.png",default76pt_9:"#%n-marvin-round-76pt-9.png",default76pt_colon:"#%n-marvin-round-76pt-colon.png",default76pt_slash:"#%n-marvin-round-76pt-slash.png",default76pt_plus:"#%n-marvin-round-76pt-plus.png",default76pt_minus:"#%n-marvin-round-76pt-minus.png",default76pt_x:"#%n-marvin-round-76pt-x.png",default76pt_space:"#%n-marvin-round-76pt-space.png"}},bonusworkerwindow:{urls:{},injectTo:["main"],frameIds:["info_background","timer_substrate","sanglass_timer_icon"],jsonIds:[],soundIds:[],unpackedIds:[]},boosters_before:{urls:{},injectTo:["main"],frameIds:[],jsonIds:[],soundIds:[],unpackedIds:[]},boosters_sale:{urls:{}},browser_resources:{urls:{left_bg:"@left_bg-f3a9f3f672.jpg",
right_bg:"@right_bg-1c7fd1cdaf.jpg"}},buildable:{urls:{},injectTo:["game"],frameIds:["%n_exclamation"],jsonIds:["%n_below_json","%n_above_json"],soundIds:["build_start_effect","build_finish_effect"],unpackedIds:[]},buttons:{urls:{},injectTo:["game","main"],frameIds:["window_button_png","window_button_on_png","window_button_disabled_png","blue_button_png","blue_button_on_png","small_blue_button","small_blue_button_on"],jsonIds:[],soundIds:[],unpackedIds:[]},buttons_main:{urls:{},injectTo:["main"],frameIds:["window_close_png","window_close_on_png","blue_button_png","blue_button_on_png","help_button_png","help_button_on_png","exit_button_icon","scene_exit_button","small_green_button","small_green_button_on","small_blue_button","small_blue_button_on","music_off_png","music_on_png","sound_off_png","sound_on_png","close_small","close_small_on","red_button","red_button_on"],jsonIds:[],soundIds:[],unpackedIds:[]},buyfogwindow:{urls:{png:"@%n-a8917dd606.png",json:"@%n-f1f634d3fb.json"},jsons:{
island_items_json:"@jsons/mediterranean_cay-3db7e4bcea.json",plist:"@%n-a8917dd606.plist",atlas:"@%n-a8917dd606.atlas"},frames:{button_block:"#%n-orderswindow-icon_background.png"}},castle:{urls:{},injectTo:["game"],frameIds:[],jsonIds:["%n_animation_json"],soundIds:[],unpackedIds:[]},centerhint:{urls:{},injectTo:["main"],frameIds:["worker_hint_png"],jsonIds:[],soundIds:[],unpackedIds:[]},chat:{urls:{window_bg:"@window_bg-122eed08e5.jpg",strict_font_ttf:{type:"font",name:"Rubic",srcs:["~%n/all/font.ttf","~%n/all/font.eot"]},png:"@%n-9cc19994c6.png",json:"@%n-1293cae7d7.json"},jsons:{plist:"@%n-9cc19994c6.plist"},frames:{dialog_box_green:"#%n-dialog_box.png",dialog_box_white:"#%n-dialog_box_2.png",icon_back:"#%n-icon_back.png",panel_off:"#%n-panel_off.png",panel_on:"#%n-panel_on.png",panelup:"#%n-panelup.png",paneldown:"#%n-paneldown.png",textbox:"#%n-textbox.png",checkmark_tmp:"#%n-checkmark_0.png",checkmark_sent:"#%n-checkmark_1.png",checkmark_read:"#%n-checkmark_2.png",
checkmark_gift:"#%n-checkmark_yes.png",gift_bg:"#%n-gift_bg.png",accept_button:"#%n-button_accept.png",accept_button_on:"#%n-button_accept_press.png",no_button:"#%n-no_button.png",no_button_on:"#%n-no_button_press.png"}},chests:{urls:{},injectTo:["game"],frameIds:[],jsonIds:["chest_animation_json"],soundIds:[],unpackedIds:[]},collectible:{urls:{},injectTo:["game"],frameIds:[],jsonIds:[],soundIds:["fruit_fly_finish_effect","coins_fly_finish_effect","wand_fly_finish_effect","exp_fly_finish_effect"],unpackedIds:[]},combo_background:{urls:{},injectTo:["game"],frameIds:[],jsonIds:["%n_json","%n_particles_json"],soundIds:[],unpackedIds:[]},confirmexit_window:{urls:{}},controlbuttons:{urls:{},injectTo:["game","main"],frameIds:["menu_icon_png","button_png","button_on_png","fullscreen_icon_png","back_button_png","back_button_on_png","back_icon_png"],jsonIds:[],soundIds:[],unpackedIds:[]},cryptex:{urls:{}},daily_cup:{urls:{}},daily_minigame_window:{urls:{}},dailytasks:{urls:{
png:"@%n-1fcf233e92.png",json:"@%n-6235c2001c.json"},jsons:{plist:"@%n-1fcf233e92.plist"},frames:{daily_task_icon_0_png:"#%n-dailytask_fb_icon.png",daily_task_icon_1_png:"#%n-icon1.png",daily_task_icon_2_png:"#%n-icon2.png",daily_task_icon_3_png:"#%n-icon3.png",daily_task_icon_4_png:"#%n-level_open.png",daily_task_icon_6_png:"#%n-free_moves_friends.png",daily_task_icon_7_png:"#%n-adicon.png",daily_task_icon_13_png:"#%n-coin_task.png",daily_task_icon_17_png:"#%n-hint_task.png",daily_task_icon_19_png:"#%n-episode_task.png",daily_task_icon_20_png:"#%n-gift_task.png",daily_task_icon_22_png:"#%n-overtake_task.png",daily_task_icon_23_png:"#%n-bonus_task.png",missions_easy_bg_png:"#%n-mission-easy_frame_1.png",missions_medium_bg_png:"#%n-mission-medium_frame_1.png",missions_hard_bg_png:"#%n-mission-hard_frame_1.png",missions_frame_white_png:"#%n-mission-frame_white.png",missions_frame_green_png:"#%n-mission-frame_green.png",daily_task_icon_bg_png:"#%n-dailytask_icon_bg.png",
daily_task_missions_easy_top_png:"#%n-mission-easy_top_1.png",daily_task_missions_medium_top_png:"#%n-mission-medium_top_1.png",daily_task_missions_hard_top_png:"#%n-mission-hard_top_1.png"}},dev_resources:{urls:{png:"@%n-10cd506b88.png",json:"@%n-e532845024.json"},jsons:{plist:"@%n-10cd506b88.plist"},frames:{border:"#%n-border_2px.png",modes_slider_bg:"#%n-modes_slider_bg.png",modes_slider_selected:"#%n-modes_slider_selected.png"}},dialogues:{urls:{},injectTo:["main"],frameIds:["bg_png","dialogue_name","arrow_png","bg_minimal_png"],jsonIds:["default_json","worker_json","dwarf_json","king_json","bear_json","elf_json","warlock_json","troll_json","miner_json","seller_json"],soundIds:[],unpackedIds:[]},dialogues_minimal:{urls:{png:"@%n-d656e37a9e.png",json:"@%n-b4d44db62f.json"},jsons:{dialogue_minimal_json:"@jsons/dwarf_minimal-de8f7ab500.json",worker_minimal_json:"@jsons/worker_minimal-371af214fc.json",dwarf_minimal_json:"@jsons/dwarf_minimal-de8f7ab500.json",
king_minimal_json:"@jsons/king_minimal-58263414df.json",bear_minimal_json:"@jsons/bear_minimal-c0a1142c83.json",elf_minimal_json:"@jsons/elf_minimal-6aa3492faa.json",warlock_minimal_json:"@jsons/warlock_minimal-01d7adcdfb.json",troll_minimal_json:"@jsons/troll_minimal-e250aba704.json",plist:"@%n-d656e37a9e.plist",atlas:"@%n-d656e37a9e.atlas"},frames:{bg_minimal_png:"#%n-dialogues-bg.png"}},digits:{urls:{},injectTo:["minesweeper","bonus_world_summer","bonus_world_easter","bonus_world_valentines","shop_user_gold_view","admin","tile_shop","game","main"],frameIds:["nostroke62pt_0","nostroke62pt_1","nostroke62pt_2","nostroke62pt_3","nostroke62pt_4","nostroke62pt_5","nostroke62pt_6","nostroke62pt_7","nostroke62pt_8","nostroke62pt_9","nostroke62pt_colon","nostroke62pt_slash","nostroke62pt_plus","nostroke62pt_minus","nostroke62pt_x","nostroke62pt_space","default45pt_0","default45pt_1","default45pt_2","default45pt_3","default45pt_4","default45pt_5","default45pt_6","default45pt_7",
"default45pt_8","default45pt_9","default45pt_colon","default45pt_slash","default45pt_plus","default45pt_minus","default45pt_x","default45pt_space","default62pt_0","default62pt_1","default62pt_2","default62pt_3","default62pt_4","default62pt_5","default62pt_6","default62pt_7","default62pt_8","default62pt_9","default62pt_colon","default62pt_slash","default62pt_plus","default62pt_minus","default62pt_x","default62pt_space","default76pt_0","default76pt_1","default76pt_2","default76pt_3","default76pt_4","default76pt_5","default76pt_6","default76pt_7","default76pt_8","default76pt_9","default76pt_colon","default76pt_slash","default76pt_plus","default76pt_minus","default76pt_x","default76pt_space"],jsonIds:[],soundIds:[],unpackedIds:[]},discreteprogress:{urls:{},injectTo:["game"],frameIds:["dp_background","dp_stroke","dp_progress_0","dp_progress_1","dp_progress_2","dp_progress_3","dp_background_small","dp_stroke_small","dp_progress_0_small","dp_progress_1_small","dp_progress_2_small",
"dp_progress_3_small"],jsonIds:[],soundIds:[],unpackedIds:[]},easter:{urls:{}},editor:{urls:{png:"@%n-8f0e93f2a5.png",json:"@%n-ce326af3de.json"},jsons:{plist:"@%n-8f0e93f2a5.plist"},frames:{editor_button:"#%n-admin-regular_button.png",editor_select:"#%n-%n_select.png",editor_button_off:"#%n-%n_button_off.png",editor_button_on:"#%n-%n_button_on.png",editor_clear_icon:"#%n-%n_clear.png",editor_play_icon:"#%n-%n_play.png",editor_undo_icon:"#%n-undo.png",editor_arrow_left:"#%n-%n_arrow_left.png",editor_arrow_right:"#%n-%n_arrow_right.png",editor_arrow_up:"#%n-%n_arrow_up.png",editor_arrow_down:"#%n-%n_arrow_down.png",editor_plus_icon:"#%n-%n_plus.png",editor_minus_icon:"#%n-%n_minus.png",editor_tabs_button_off:"#%n-%n_cards_button_off.png",editor_tabs_button_on:"#%n-%n_cards_button_on.png"}},energy_feast:{urls:{png:"@%n-780f609090.png",json:"@%n-f1f86a6806.json"},jsons:{json:"@jsons/%n-2ae1a644cb.json",rules_json:"@jsons/%n_rules-c5e4a9a4ce.json",
energy_feast_json:"@jsons/energyfeastmissionwindow-10519fded8.json",energy_feast_big_bug_json:"@jsons/energy_bug-9631723f88.json",energy_feast_medium_bug_json:"@jsons/energy_bug_midle-378cad2860.json",energy_feast_small_bug_json:"@jsons/energy_bug_mini-4bbd959009.json",atlas:"@%n-780f609090.atlas"}},energylotterywindow:{urls:{open_lot_effect:"~sounds/lottery_open-9b80fced7f.mp3",png:"@%n-58e72db1bd.png",json:"@%n-a30908fcea.json"},jsons:{energy_lottery_json:"@jsons/lottery_window-e23d1bab1e.json",energy_lottery_icon_json:"@jsons/lottery_target-058e7bc2c4.json",energy_lottery_axe_json:"@jsons/lottery_target_axe-8b315d2d86.json",atlas:"@%n-58e72db1bd.atlas"}},energyup:{urls:{},injectTo:["main"],frameIds:["button_energy_png"],jsonIds:[],soundIds:[],unpackedIds:[]},episode_0:{urls:{levels:"../../cleverapps/res/mergecraft/levels/0.json"},jsons:{levels:"../../cleverapps/res/mergecraft/levels/0.json"},episodeNo:0,levelsAmount:1,hard:[],tricky:[],language:"en",noCache:!0},episode_ads:{urls:{
levels:"../../cleverapps/res/mergecraft/levels/ads.json"},jsons:{levels:"../../cleverapps/res/mergecraft/levels/ads.json"},episodeNo:"ads",levelsAmount:60,hard:[],tricky:[],language:"en",noCache:!0},episode_coming_soon:{urls:{},levelPositions:"levels_1"},episode_editor:{urls:{levels:"../../cleverapps/res/mergecraft/levels/editor.json"},jsons:{levels:"../../cleverapps/res/mergecraft/levels/editor.json"},episodeNo:"editor",levelsAmount:1,hard:[],tricky:[],language:"en",noCache:!0},episode_tests:{urls:{levels:"../../cleverapps/res/mergecraft/levels/tests.json"},jsons:{levels:"../../cleverapps/res/mergecraft/levels/tests.json"},episodeNo:"tests",levelsAmount:13,hard:[],tricky:[],language:"en",noCache:!0},exclamations:{urls:{},injectTo:["game"],frameIds:[],jsonIds:["animation"],soundIds:[],unpackedIds:[]},extrawindow:{urls:{}},favorite_sale:{urls:{png:"@%n-6685027b50.png",json:"@%n-b6b550b0ff.json"},jsons:{plist:"@%n-6685027b50.plist"},frames:{plus_png:"#%n-plus_big.png"}},finger:{urls:{},
injectTo:["game","main"],frameIds:["tutorial_click_png","tutorial_hand_png"],jsonIds:[],soundIds:[],unpackedIds:[]},finish_episode_0:{urls:{episode_finish_image:{}}},finish_episode_0_ru:{urls:{episode_finish_image:{}}},finish_episode_1:{urls:{episode_finish_image:{}}},finish_episode_1_ru:{urls:{episode_finish_image:{}}},finish_episode_window:{urls:{}},fireworks:{urls:{}},flying:{urls:{},injectTo:["game"],frameIds:["%n_coin_png","%n_energy_png","%n_wand_png","%n_ruby_png","%n_exp_png"],jsonIds:[],soundIds:[],unpackedIds:[]},fog:{urls:{},injectTo:["game"],frameIds:["%n_png","%n2_png","%n_down_left_png","%n_down_right_png","%n_up_left_png","%n_up_right_png","%n_blocker_png","%n_blocker_cloud_png","button_wand_png"],jsonIds:[],soundIds:[],unpackedIds:[]},fruit:{urls:{},injectTo:["game"],frameIds:[],jsonIds:["%n_growing_json","%n_ripe_json","%n_ready_json"],soundIds:[],unpackedIds:[]},game:{urls:{background_music_game:"~sounds/music-ec69870ba2.mp3",
merge_effect:"~sounds/merge-e4e5546e39.mp3",new_order_effect:"~sounds/new_order-5c4e628f54.mp3",prize_view_created_effect:"~sounds/prize_view_created-2ab1bf8cfb.mp3",spawn_start_effect:"~sounds/spawn_start-2a94083a1c.mp3",spawn_landing_effect:"~sounds/spawn_landing-7a01ef36e5.mp3",spawn_fail_effect:"~sounds/spawn_fail-fdaf8d74be.mp3",spawn_beetle_effect:"~sounds/beetles_collect-45552f26d7.mp3",specialoffer_appearance_effect:"~sounds/merchant_appearance-2b35d35856.mp3",specialoffer_window_effect:"~sounds/merchant_window-bed8e8d86f.mp3",specialoffer_buying_effect:"~sounds/build_finish-b77cae7e58.mp3",specialoffer_destruction_effect:"~sounds/merchant_disappearance-afcf5922f0.mp3",specialoffer_helicopter_effect:"~sounds/helicopter-e232bb32d1.mp3",instantworker_build_effect:"~sounds/build_robot-aad7453d1d.mp3",unit_desturction_effect:"~sounds/remove_thing-91a578ee13.mp3",coins_drop_effect:"~sounds/coins_drop-887037b04e.mp3",upgradable_build_effect:"~sounds/build_castle-506cac56a5.mp3",
pixel_fly_effect:"~sounds/beetles-be60a9cb4f.mp3",pixel_spawn_effect:"~sounds/beetles_emergence-5aaae60895.mp3",barrel_appear_sfx:"~sounds/barrel-ef78b26e8a.mp3",particle_texture:"@particle_texture-1f5ee453a5.png",build_start_effect:"~sounds/build_start-89fef2be77.mp3",build_finish_effect:"~sounds/build_finish-b77cae7e58.mp3",mining_start_effect:"~sounds/mining_ground_start-d433e147de.mp3",mining_wood_start_effect:"~sounds/mining_wood_start-53bf2d0df8.mp3",mining_stone_start_effect:"~sounds/mining_stone_start-f5be5d43a5.mp3",mining_wagon_start_effect:"~sounds/mining_metal_start-d3cc3f14da.mp3",fruit_fly_finish_effect:"~sounds/fruit_fly-1545a6f0d2.mp3",coins_fly_finish_effect:"~sounds/coins_fly-48c8f148ba.mp3",wand_fly_finish_effect:"~sounds/wand_fly-532f1d572a.mp3",exp_fly_finish_effect:"~sounds/progress_fly-a84efaa03e.mp3",png:"@%n-476adb4f1f.png",json:"@%n-c7363d833b.json"},jsons:{hint_button_arrow_json:"@jsons/hint_button_arrow-008e7a2d92.json",
coins_reward_json:"@jsons/coins_reward-9f92bd9090.json",combo_background_json:"@jsons/combo_glow_fx-3a7047dbce.json",combo_background_particles_json:"@jsons/combo_glow_fx_particles-2810d15005.json",crown_json:"@jsons/level_crown-e904aad65e.json",pack_icon_json:"@jsons/icon_pack1-7fbeaf6294.json",pack1_icon_json:"@jsons/icon_pack2-cc85b06051.json",pack2_icon_json:"@jsons/icon_pack3-01a54e22d1.json",energy_feast_icon_json:"@jsons/energy_tournament-0c6bde045e.json",battlepass_icon_json:"@jsons/battlepass_icon-9b2581bfc4.json",orders_json:"@jsons/orders_icon-3704aded22.json",units_shop_json:"@jsons/market_icon-b2c01578b1.json",units_library_json:"@jsons/units_icon-b7f7e718c4.json",animation:"@jsons/exclamation-35af20d755.json",recipe_bubble_down_json:"@jsons/artifacts_fx_down-1267ba4947.json",recipe_bubble_up_json:"@jsons/artifacts_fx_up-d925abbab0.json",buy_fog_tile_json:"@jsons/island_fx-e1dda0faf8.json",change_stage_cloud_json:"@jsons/change_stage_cloud-75b91d9cc3.json",
appearance_json:"@jsons/appearance-9e5ca9f3e9.json",destruction_json:"@jsons/destruction-921b98d783.json",reward_highlight_json:"@jsons/reward_highlight-301f6517a1.json",flickering_json:"@jsons/flickering-4e399f86fb.json",merge_json:"@jsons/merge_effect-36644caa10.json",hint_json:"@jsons/hint-72b78cc889.json",rays_json:"@jsons/rays-3e73ee9a62.json",pixels_json:"@jsons/bug-84e2e85223.json",adsbarrel_json:"@jsons/barrel-c505763d4c.json",bonus_shining_json:"@jsons/bonus_shining-b92e59c120.json",specialoffer_helicopter_json:"@jsons/specialoffer_helicopter-9a5c4aee75.json",battle_star:"@jsons/batlepass_star-91902393b4.json",particles_drag_json:"~%n/all/jsons/particle_drag-fe3c84b9a8.json",particles_spawn_json:"~%n/all/jsons/particle_spawn-f85df30f5d.json",particles_collect_json:"~%n/all/jsons/particle_collect-0ca24e371d.json",levelup_path_json:"~%n/all/jsons/levelup_path-47ce4f0d5b.json",buildable_below_json:"@jsons/building_completion_down-5e32ffeee2.json",
buildable_above_json:"@jsons/building_completion_up-965cd41bbc.json",mining_start_json:"@jsons/dwarf-fe7fb74f18.json",timer_json:"@jsons/sandglass-5ec0151b4c.json",fruit_growing_json:"@jsons/growing_plant-7134cde171.json",fruit_ripe_json:"@jsons/ripe_plant-13509ffc59.json",fruit_ready_json:"@jsons/fruit_ready-a0e953db7c.json",castle_animation_json:"@jsons/castle_animation-76ec3dd840.json",shine_animation_json:"@jsons/gem_animation-8bc76ded63.json",chest_animation_json:"@jsons/treasure-f735f61bf6.json",prize_shining_json:"@jsons/prize_shining-6d22f85df0.json",unit_bamboo10:"@jsons/bamboo_stage10-2b8273dae0.json",unit_bamboo11:"@jsons/bamboo_stage11-22c933802f.json",unit_bamboogenerator1:"@jsons/bamboogenerator_stage1-b2df0cceac.json",unit_bamboogenerator2:"@jsons/bamboogenerator_stage2-425e9e0ba1.json",unit_bamboogenerator3:"@jsons/bamboogenerator_stage3-b3a1c9b0b4.json",unit_bear7:"@jsons/bear_stage7-5cd4b6b667.json",unit_dwarf2:"@jsons/dwarf_stage2-7d56c72510.json",
unit_elf8:"@jsons/elf_stage8-5179d15722.json",unit_king4:"@jsons/king_stage4-7962c495dd.json",unit_sapphire11:"@jsons/sapphire_stage11-727de2ebc1.json",unit_sapphire12:"@jsons/sapphire_stage12-c55dce6bd5.json",unit_sapphiregenerator1:"@jsons/sapphiregenerator_stage1-76d5b48e99.json",unit_sapphiregenerator2:"@jsons/sapphiregenerator_stage2-e9b2036852.json",unit_sapphiregenerator3:"@jsons/sapphiregenerator_stage3-bd8ab58bb7.json",unit_specialoffer1:"@jsons/specialoffer_stage1-4cc375ce00.json",unit_stone10:"@jsons/stone_stage10-2ee1915290.json",unit_stone11:"@jsons/stone_stage11-c60b6415bc.json",unit_stonegenerator1:"@jsons/stonegenerator_stage1-d3968925dc.json",unit_stonegenerator2:"@jsons/stonegenerator_stage2-0aab40802d.json",unit_stonegenerator3:"@jsons/stonegenerator_stage3-14099c3c16.json",unit_troll10:"@jsons/troll_stage10-d0e5f5d2b2.json",unit_wagon10:"@jsons/wagon_stage10-61e5f61a89.json",unit_wagon11:"@jsons/wagon_stage11-6a551cf1ac.json",
unit_wagongenerator1:"@jsons/wagongenerator_stage1-16beb4ef1c.json",unit_wagongenerator2:"@jsons/wagongenerator_stage2-bced3cd7b1.json",unit_wagongenerator3:"@jsons/wagongenerator_stage3-f76c43d67f.json",unit_wands1:"@jsons/wands_stage1-535476df2f.json",unit_wands2:"@jsons/wands_stage2-5b3cd3b124.json",unit_wands3:"@jsons/wands_stage3-742c20d24e.json",unit_wands4:"@jsons/wands_stage4-d94ad946f6.json",unit_wands5:"@jsons/wands_stage5-d9b2d0d3e1.json",unit_wands6:"@jsons/wands_stage6-a067e2a882.json",unit_warlock9:"@jsons/warlock_stage9-510edb7c9c.json",unit_wood9:"@jsons/wood_stage9-795fc48e1c.json",unit_wood10:"@jsons/wood_stage10-d944fe5492.json",unit_woodgenerator1:"@jsons/woodgenerator_stage1-adb1dc400c.json",unit_woodgenerator2:"@jsons/woodgenerator_stage2-f73d0647d0.json",unit_woodgenerator3:"@jsons/woodgenerator_stage3-4f76fc159e.json",unit_worker5:"@jsons/worker_stage5-594a29e321.json",plist:"@%n-476adb4f1f.plist",atlas:"@%n-476adb4f1f.atlas"},frames:{
ratewindow_on:"#%n-rate-star.png",mission_star0_png:"#%n-missions-mission_star_0.png",mission_star1_png:"#%n-missions-mission_star_1.png",adicon_png:"#%n-shared-adicon.png",tutorial_click_png:"#%n-tutorial-circle.png",tutorial_hand_png:"#%n-tutorial-hand.png",nostroke62pt_0:"#%n-marvin-round-nostroke-62pt-0.png",nostroke62pt_1:"#%n-marvin-round-nostroke-62pt-1.png",nostroke62pt_2:"#%n-marvin-round-nostroke-62pt-2.png",nostroke62pt_3:"#%n-marvin-round-nostroke-62pt-3.png",nostroke62pt_4:"#%n-marvin-round-nostroke-62pt-4.png",nostroke62pt_5:"#%n-marvin-round-nostroke-62pt-5.png",nostroke62pt_6:"#%n-marvin-round-nostroke-62pt-6.png",nostroke62pt_7:"#%n-marvin-round-nostroke-62pt-7.png",nostroke62pt_8:"#%n-marvin-round-nostroke-62pt-8.png",nostroke62pt_9:"#%n-marvin-round-nostroke-62pt-9.png",nostroke62pt_colon:"#%n-marvin-round-nostroke-62pt-colon.png",nostroke62pt_slash:"#%n-marvin-round-nostroke-62pt-slash.png",nostroke62pt_plus:"#%n-marvin-round-nostroke-62pt-plus.png",
nostroke62pt_minus:"#%n-marvin-round-nostroke-62pt-minus.png",nostroke62pt_x:"#%n-marvin-round-nostroke-62pt-x.png",nostroke62pt_space:"#%n-marvin-round-nostroke-62pt-space.png",default45pt_0:"#%n-marvin-round-45pt-0.png",default45pt_1:"#%n-marvin-round-45pt-1.png",default45pt_2:"#%n-marvin-round-45pt-2.png",default45pt_3:"#%n-marvin-round-45pt-3.png",default45pt_4:"#%n-marvin-round-45pt-4.png",default45pt_5:"#%n-marvin-round-45pt-5.png",default45pt_6:"#%n-marvin-round-45pt-6.png",default45pt_7:"#%n-marvin-round-45pt-7.png",default45pt_8:"#%n-marvin-round-45pt-8.png",default45pt_9:"#%n-marvin-round-45pt-9.png",default45pt_colon:"#%n-marvin-round-45pt-colon.png",default45pt_slash:"#%n-marvin-round-45pt-slash.png",default45pt_plus:"#%n-marvin-round-45pt-plus.png",default45pt_minus:"#%n-marvin-round-45pt-minus.png",default45pt_x:"#%n-marvin-round-45pt-x.png",default45pt_space:"#%n-marvin-round-45pt-space.png",default62pt_0:"#%n-marvin-round-62pt-0.png",
default62pt_1:"#%n-marvin-round-62pt-1.png",default62pt_2:"#%n-marvin-round-62pt-2.png",default62pt_3:"#%n-marvin-round-62pt-3.png",default62pt_4:"#%n-marvin-round-62pt-4.png",default62pt_5:"#%n-marvin-round-62pt-5.png",default62pt_6:"#%n-marvin-round-62pt-6.png",default62pt_7:"#%n-marvin-round-62pt-7.png",default62pt_8:"#%n-marvin-round-62pt-8.png",default62pt_9:"#%n-marvin-round-62pt-9.png",default62pt_colon:"#%n-marvin-round-62pt-colon.png",default62pt_slash:"#%n-marvin-round-62pt-slash.png",default62pt_plus:"#%n-marvin-round-62pt-plus.png",default62pt_minus:"#%n-marvin-round-62pt-minus.png",default62pt_x:"#%n-marvin-round-62pt-x.png",default62pt_space:"#%n-marvin-round-62pt-space.png",default76pt_0:"#%n-marvin-round-76pt-0.png",default76pt_1:"#%n-marvin-round-76pt-1.png",default76pt_2:"#%n-marvin-round-76pt-2.png",default76pt_3:"#%n-marvin-round-76pt-3.png",default76pt_4:"#%n-marvin-round-76pt-4.png",default76pt_5:"#%n-marvin-round-76pt-5.png",
default76pt_6:"#%n-marvin-round-76pt-6.png",default76pt_7:"#%n-marvin-round-76pt-7.png",default76pt_8:"#%n-marvin-round-76pt-8.png",default76pt_9:"#%n-marvin-round-76pt-9.png",default76pt_colon:"#%n-marvin-round-76pt-colon.png",default76pt_slash:"#%n-marvin-round-76pt-slash.png",default76pt_plus:"#%n-marvin-round-76pt-plus.png",default76pt_minus:"#%n-marvin-round-76pt-minus.png",default76pt_x:"#%n-marvin-round-76pt-x.png",default76pt_space:"#%n-marvin-round-76pt-space.png",menu_icon_png:"#%n-controlbuttons-menu.png",button_png:"#%n-controlbuttons-menu_button.png",button_on_png:"#%n-controlbuttons-menu_button_on.png",fullscreen_icon_png:"#%n-controlbuttons-fullscreen_icon.png",back_button_png:"#%n-controlbuttons-back_button.png",back_button_on_png:"#%n-controlbuttons-back_button_on.png",back_icon_png:"#%n-controlbuttons-back.png",life_png:"#%n-menubar-energy.png",coin_png:"#%n-menubar-ruby.png",menubar_bg_png:"#%n-menubar-bar_bg.png",plus_button_png:"#%n-menubar-plus.png",
plus_button_on_png:"#%n-menubar-plus_on.png",bar_timer_png:"#%n-menubar-bar_timer.png",small_timer_icon_png:"#%n-menubar-timer.png",menubar_attention_png:"#%n-orderswindow-attention_exclamation_large.png",menubar_progress_png:"#%n-level-progressbar.png",menubar_round_bg_png:"#%n-level-level_round.png",merge_coin_png:"#%n-menubar-coin.png",merge_wand_png:"#%n-menubar-wand.png",merge_worker_png:"#%n-menubar-worker.png",window_button_png:"#%n-buttons-button.png",window_button_on_png:"#%n-buttons-button_on.png",window_button_disabled_png:"#%n-buttons-button_off.png",blue_button_png:"#%n-buttons-button_blue.png",blue_button_on_png:"#%n-buttons-button_blue_on.png",small_blue_button:"#%n-buttons-small_blue_button.png",small_blue_button_on:"#%n-buttons-small_blue_button_on.png",icon_bg:"#%n-sidebar-icon_bg.png",lock:"#%n-sidebar-lock_sidebar.png",attention_png:"#%n-orderswindow-attention_exclamation_large.png",icon_text_bg:"#%n-sidebar-icon_text_bg.png",
caption_bg:"#%n-sidebar-icon_text_bg.png",gamemessage_bg_png:"#%n-%n_message-level_msg_bg.png",grounded_bg:"#%n-woodsource-grounded.png",generator_star_on:"#%n-woodgenerator-star_on.png",generator_star_off:"#%n-woodgenerator-star_off.png",bar_png:"#%n-bar.png",bar_bg_png:"#%n-bar_bg.png",pickaxe:"#%n-dragonmine-pickaxe.png",seller_icon:"#%n-ui-seller_icon.png",hint_background_png:"#%n-dialogues-bg.png",upgradable_level_png:"#%n-ui-upgradable_level.png",upgradable_bar_png:"#%n-ui-upgradable_bar.png",upgradable_bar_bg_png:"#%n-ui-upgradable_bar_bg.png",guide_button_png:"#%n-ui-guide_button.png",guide_button_on_png:"#%n-ui-guide_button_on.png",first_place_prize_png:"#%n-treasure-stage3.png",second_place_prize_png:"#%n-treasure-stage2.png",third_place_prize_png:"#%n-treasure-stage1.png",stand_ground:"#%n-ui-ground.png",green_ground_1:"#%n-green-ground_1.png",green_ground_2:"#%n-green-ground_2.png",grow12_right:"#%n-green-grow12_right.png",grow12_left:"#%n-green-grow12_left.png",
grow12_corner:"#%n-green-grow12_corner.png",grow12_both:"#%n-green-grow12_both.png",level1_up_corner:"#%n-green-level1_up_corner.png",level1_down_corner:"#%n-green-level1_down_corner.png",level1_left_corner:"#%n-green-level1_left_corner.png",level1_right_corner:"#%n-green-level1_right_corner.png",level2_up_corner:"#%n-green-level2_up_corner.png",level1_up_both:"#%n-green-level1_up_both.png",level1_up_right_only:"#%n-green-level1_up_right_only.png",level1_up_right_only_last:"#%n-green-level1_up_right_only_last.png",level1_up_left_only:"#%n-green-level1_up_left_only.png",level1_up_left_only_last:"#%n-green-level1_up_left_only_last.png",level2_up_both:"#%n-green-level2_up_both.png",level2_up_right_only:"#%n-green-level2_up_right_only.png",level2_up_right_only_last:"#%n-green-level2_up_right_only_last.png",level2_up_left_only:"#%n-green-level2_up_left_only.png",level2_up_left_only_last:"#%n-green-level2_up_left_only_last.png",level1_down_both:"#%n-green-level1_down_both.png",
level1_down_right_only:"#%n-green-level1_down_right_only.png",level1_down_left_only:"#%n-green-level1_down_left_only.png",level1_left_inner:"#%n-green-level1_left_inner.png",level1_left_inner_last:"#%n-green-level1_left_inner_last.png",level1_right_inner:"#%n-green-level1_right_inner.png",level1_right_inner_last:"#%n-green-level1_right_inner_last.png",level2_left_inner:"#%n-green-level2_left_inner.png",level2_left_inner_last:"#%n-green-level2_left_inner_last.png",level2_right_inner:"#%n-green-level2_right_inner.png",level2_right_inner_last:"#%n-green-level2_right_inner_last.png",water:"#%n-terrain-water.png",buildable_exclamation:"#%n-ui-small_exclamation.png",fog_png:"#%n-cloud2-cloud_1.png",fog2_png:"#%n-cloud2-cloud_2.png",fog_down_left_png:"#%n-cloud2-cloud_down_left.png",fog_down_right_png:"#%n-cloud2-cloud_down_right.png",fog_up_left_png:"#%n-cloud2-cloud_up_left.png",fog_up_right_png:"#%n-cloud2-cloud_up_right.png",fog_blocker_png:"#%n-cloud-lock.png",
fog_blocker_cloud_png:"#%n-cloud-lock_cloud.png",button_wand_png:"#%n-buttons-button_wand.png",flying_coin_png:"#%n-flying-coin.png",flying_energy_png:"#%n-flying-energy.png",flying_wand_png:"#%n-flying-wand.png",flying_ruby_png:"#%n-flying-ruby.png",flying_exp_png:"#%n-flying-exp.png",background:"#%n-ui-%n_ui_bg.png",background_warning:"#%n-infoview-%n_ui_bg2.png",pointer:"#%n-infoview-%n_ui_bg_pointer.png",pointer2:"#%n-infoview-%n_ui_bg_pointer_small.png",pointer2_warning:"#%n-infoview-%n_ui_bg_pointer2_small.png",timer_substrate:"#%n-ui-timer_substrate.png",timer_icon_png:"#%n-infoview-%n_ui_clock.png",timer_ribbon_icon_png:"#%n-infoview-clock_with_ribbon.png",watch_ad_icon:"#%n-ui-speedup_watch_icon.png",progress_background:"#%n-discreteprogress-bar_bg.png",progress_stroke:"#%n-discreteprogress-stroke_dark.png",progress_bar:"#%n-discreteprogress-bar_red.png",small_attention_exclamation:"#%n-orderswindow-attention_exclamation.png",
small_attention_exclamation_disabled:"#%n-orderswindow-attention_exclamation_gray.png",small_ok_exclamation:"#%n-orderswindow-attention_ok.png",attention_ok:"#%n-orderswindow-attention_ok_large.png",attention_exclamation:"#%n-orderswindow-attention_exclamation_large.png",attention_exclamation_disabled:"#%n-orderswindow-attention_exclamation_gray_large.png",attention_sandglass:"#%n-orderswindow-attention_sandglass_large.png",attention_coin:"#%n-orderswindow-attention_coin_large.png",icon_background:"#%n-orderswindow-icon_background.png",icon_background_light:"#%n-orderswindow-icon_background_light.png",icon_background_disabled:"#%n-orderswindow-icon_background_disabled.png",icon_blocker:"#%n-orderswindow-order_lock.png",next_arrow:"#%n-orderswindow-next_arrow.png",timer:"#%n-infoview-%n_ui_clock.png",dwarf_head:"#%n-infoview-dwarf_head.png",instant_dwarf_head:"#%n-infoview-instant_dwarf_head.png",button_coin_png:"#%n-buttons-button_ruby.png",
dp_background:"#%n-discreteprogress-bar_bg.png",dp_stroke:"#%n-discreteprogress-stroke_dark.png",dp_progress_0:"#%n-discreteprogress-bar_0.png",dp_progress_1:"#%n-discreteprogress-bar_1.png",dp_progress_2:"#%n-discreteprogress-bar_2.png",dp_progress_3:"#%n-discreteprogress-bar_3.png",dp_background_small:"#%n-discreteprogress-bar_bg_small.png",dp_stroke_small:"#%n-discreteprogress-stroke_white_small.png",dp_progress_0_small:"#%n-discreteprogress-bar_0_small.png",dp_progress_1_small:"#%n-discreteprogress-bar_1_small.png",dp_progress_2_small:"#%n-discreteprogress-bar_2_small.png",dp_progress_3_small:"#%n-discreteprogress-bar_3_small.png",small_icon_dwarf:"#%n-heroes-dwarf_small.png",small_icon_king:"#%n-heroes-king_small.png",small_icon_bear:"#%n-heroes-bear_small.png",small_icon_elf:"#%n-heroes-elf_small.png",small_icon_warlock:"#%n-heroes-warlock_small.png",small_icon_troll:"#%n-heroes-troll_small.png",fog_icon_png:"#%n-icons-fog.png",unit_apple1:"#%n-apple-stage1.png",
unit_apple2:"#%n-apple-stage2.png",unit_apple3:"#%n-apple-stage3.png",unit_apple4:"#%n-apple-stage4.png",unit_apple5:"#%n-apple-stage5.png",unit_apple6:"#%n-apple-stage6.png",unit_bamboo1:"#%n-bamboo-stage1.png",unit_bamboo2:"#%n-bamboo-stage2.png",unit_bamboo3:"#%n-bamboo-stage3.png",unit_bamboo4:"#%n-bamboo-stage4.png",unit_bamboo5:"#%n-bamboo-stage5.png",unit_bamboo6:"#%n-bamboo-stage6.png",unit_bamboo7:"#%n-bamboo-stage7.png",unit_bamboo8:"#%n-bamboo-stage8.png",unit_bamboo9:"#%n-bamboo-stage9.png",unit_bamboochest1:"#%n-bamboochest-stage1.png",unit_bamboochest2:"#%n-bamboochest-stage2.png",unit_bamboochest3:"#%n-bamboochest-stage3.png",unit_bamboosource1:"#%n-bamboosource-stage1.png",unit_bamboosource2:"#%n-bamboosource-stage2.png",unit_bamboosource3:"#%n-bamboosource-stage3.png",unit_bamboosource4:"#%n-bamboosource-stage4.png",unit_bamboosource5:"#%n-bamboosource-stage5.png",unit_bamboosource6:"#%n-bamboosource-stage6.png",unit_bear1:"#%n-bear-stage1.png",
unit_bear2:"#%n-bear-stage2.png",unit_bear3:"#%n-bear-stage3.png",unit_bear4:"#%n-bear-stage4.png",unit_bear5:"#%n-bear-stage5.png",unit_bear6:"#%n-bear-stage6.png",unit_candies1:"#%n-candies-stage1.png",unit_candies2:"#%n-candies-stage2.png",unit_candies3:"#%n-candies-stage3.png",unit_candies4:"#%n-candies-stage4.png",unit_candies5:"#%n-candies-stage5.png",unit_candies6:"#%n-candies-stage6.png",unit_coins1:"#%n-coins-stage1.png",unit_coins2:"#%n-coins-stage2.png",unit_coins3:"#%n-coins-stage3.png",unit_coins4:"#%n-coins-stage4.png",unit_coins5:"#%n-coins-stage5.png",unit_coins6:"#%n-coins-stage6.png",unit_coins7:"#%n-coins-stage7.png",unit_coins8:"#%n-coins-stage8.png",unit_corn1:"#%n-corn-stage1.png",unit_corn2:"#%n-corn-stage2.png",unit_corn3:"#%n-corn-stage3.png",unit_corn4:"#%n-corn-stage4.png",unit_corn5:"#%n-corn-stage5.png",unit_corn6:"#%n-corn-stage6.png",unit_crystal1:"#%n-crystal-stage1.png",unit_crystal2:"#%n-crystal-stage2.png",unit_crystal3:"#%n-crystal-stage3.png",
unit_crystal4:"#%n-crystal-stage4.png",unit_decorator1:"#%n-decorator-stage1.png",unit_dishes1:"#%n-dishes-stage1.png",unit_dishes2:"#%n-dishes-stage2.png",unit_dishes3:"#%n-dishes-stage3.png",unit_dishes4:"#%n-dishes-stage4.png",unit_dishes5:"#%n-dishes-stage5.png",unit_dishes6:"#%n-dishes-stage6.png",unit_dishes7:"#%n-dishes-stage7.png",unit_dishes8:"#%n-dishes-stage8.png",unit_dishes9:"#%n-dishes-stage9.png",unit_dishes10:"#%n-dishes-stage10.png",unit_dishes11:"#%n-dishes-stage11.png",unit_dishes12:"#%n-dishes-stage12.png",unit_dishes13:"#%n-dishes-stage13.png",unit_dishes14:"#%n-dishes-stage14.png",unit_dishes15:"#%n-dishes-stage15.png",unit_dishes16:"#%n-dishes-stage16.png",unit_dishes17:"#%n-dishes-stage17.png",unit_dishes18:"#%n-dishes-stage18.png",unit_dishes19:"#%n-dishes-stage19.png",unit_dishes20:"#%n-dishes-stage20.png",unit_dragonmine1:"#%n-dragonmine-stage1.png",unit_dwarf1:"#%n-dwarf-stage1.png",unit_elf1:"#%n-elf-stage1.png",unit_elf2:"#%n-elf-stage2.png",
unit_elf3:"#%n-elf-stage3.png",unit_elf4:"#%n-elf-stage4.png",unit_elf5:"#%n-elf-stage5.png",unit_elf6:"#%n-elf-stage6.png",unit_elf7:"#%n-elf-stage7.png",unit_freechest1:"#%n-freechest-stage1.png",unit_herochest1:"#%n-herochest-stage1.png",unit_iron1:"#%n-iron-stage1.png",unit_iron2:"#%n-iron-stage2.png",unit_iron3:"#%n-iron-stage3.png",unit_iron4:"#%n-iron-stage4.png",unit_iron5:"#%n-iron-stage5.png",unit_iron6:"#%n-iron-stage6.png",unit_iron7:"#%n-iron-stage7.png",unit_iron8:"#%n-iron-stage8.png",unit_iron9:"#%n-iron-stage9.png",unit_iron10:"#%n-iron-stage10.png",unit_king1:"#%n-king-stage1.png",unit_king2:"#%n-king-stage2.png",unit_king3:"#%n-king-stage3.png",unit_magicplant1:"#%n-magicplant-stage1.png",unit_magicplant2:"#%n-magicplant-stage2.png",unit_magicplant3:"#%n-magicplant-stage3.png",unit_magicplant4:"#%n-magicplant-stage4.png",unit_magicplant5:"#%n-magicplant-stage5.png",unit_magicplant6:"#%n-magicplant-stage6.png",unit_magicplant7:"#%n-magicplant-stage7.png",
unit_magicplant8:"#%n-magicplant-stage8.png",unit_magicplant9:"#%n-magicplant-stage9.png",unit_mushrooms1:"#%n-mushrooms-stage1.png",unit_mushrooms2:"#%n-mushrooms-stage2.png",unit_mushrooms3:"#%n-mushrooms-stage3.png",unit_mushrooms4:"#%n-mushrooms-stage4.png",unit_mushrooms5:"#%n-mushrooms-stage5.png",unit_mushrooms6:"#%n-mushrooms-stage6.png",unit_rubies1:"#%n-rubies-stage1.png",unit_rubies2:"#%n-rubies-stage2.png",unit_rubies3:"#%n-rubies-stage3.png",unit_rubies4:"#%n-rubies-stage4.png",unit_rubies5:"#%n-rubies-stage5.png",unit_rubies6:"#%n-rubies-stage6.png",unit_rubiesplant1:"#%n-rubiesplant-stage1.png",unit_rubiesplant2:"#%n-rubiesplant-stage2.png",unit_rubiesplant3:"#%n-rubiesplant-stage3.png",unit_sacks1:"#%n-sacks-stage1.png",unit_sacks2:"#%n-sacks-stage2.png",unit_sacks3:"#%n-sacks-stage3.png",unit_sapphire1:"#%n-sapphire-stage1.png",unit_sapphire2:"#%n-sapphire-stage2.png",unit_sapphire3:"#%n-sapphire-stage3.png",unit_sapphire4:"#%n-sapphire-stage4.png",
unit_sapphire5:"#%n-sapphire-stage5.png",unit_sapphire6:"#%n-sapphire-stage6.png",unit_sapphire7:"#%n-sapphire-stage7.png",unit_sapphire8:"#%n-sapphire-stage8.png",unit_sapphire9:"#%n-sapphire-stage9.png",unit_sapphire10:"#%n-sapphire-stage10.png",unit_sapphirechest1:"#%n-sapphirechest-stage1.png",unit_sapphirechest2:"#%n-sapphirechest-stage2.png",unit_sapphirechest3:"#%n-sapphirechest-stage3.png",unit_sapphiresource1:"#%n-sapphiresource-stage1.png",unit_sapphiresource2:"#%n-sapphiresource-stage2.png",unit_sapphiresource3:"#%n-sapphiresource-stage3.png",unit_sapphiresource4:"#%n-sapphiresource-stage4.png",unit_sapphiresource5:"#%n-sapphiresource-stage5.png",unit_sapphiresource6:"#%n-sapphiresource-stage6.png",unit_stone1:"#%n-stone-stage1.png",unit_stone2:"#%n-stone-stage2.png",unit_stone3:"#%n-stone-stage3.png",unit_stone4:"#%n-stone-stage4.png",unit_stone5:"#%n-stone-stage5.png",unit_stone6:"#%n-stone-stage6.png",unit_stone7:"#%n-stone-stage7.png",unit_stone8:"#%n-stone-stage8.png",
unit_stone9:"#%n-stone-stage9.png",unit_stonechest1:"#%n-stonechest-stage1.png",unit_stonechest2:"#%n-stonechest-stage2.png",unit_stonechest3:"#%n-stonechest-stage3.png",unit_stonesource1:"#%n-stonesource-stage1.png",unit_stonesource2:"#%n-stonesource-stage2.png",unit_stonesource3:"#%n-stonesource-stage3.png",unit_stonesource4:"#%n-stonesource-stage4.png",unit_stonesource5:"#%n-stonesource-stage5.png",unit_stonesource6:"#%n-stonesource-stage6.png",unit_strawberry1:"#%n-strawberry-stage1.png",unit_strawberry2:"#%n-strawberry-stage2.png",unit_strawberry3:"#%n-strawberry-stage3.png",unit_strawberry4:"#%n-strawberry-stage4.png",unit_strawberry5:"#%n-strawberry-stage5.png",unit_strawberry6:"#%n-strawberry-stage6.png",unit_treasure1:"#%n-treasure-stage1.png",unit_treasure2:"#%n-treasure-stage2.png",unit_treasure3:"#%n-treasure-stage3.png",unit_troll1:"#%n-troll-stage1.png",unit_troll2:"#%n-troll-stage2.png",unit_troll3:"#%n-troll-stage3.png",unit_troll4:"#%n-troll-stage4.png",
unit_troll5:"#%n-troll-stage5.png",unit_troll6:"#%n-troll-stage6.png",unit_troll7:"#%n-troll-stage7.png",unit_troll8:"#%n-troll-stage8.png",unit_troll9:"#%n-troll-stage9.png",unit_wagon1:"#%n-wagon-stage1.png",unit_wagon2:"#%n-wagon-stage2.png",unit_wagon3:"#%n-wagon-stage3.png",unit_wagon4:"#%n-wagon-stage4.png",unit_wagon5:"#%n-wagon-stage5.png",unit_wagon6:"#%n-wagon-stage6.png",unit_wagon7:"#%n-wagon-stage7.png",unit_wagon8:"#%n-wagon-stage8.png",unit_wagon9:"#%n-wagon-stage9.png",unit_wagonchest1:"#%n-wagonchest-stage1.png",unit_wagonchest2:"#%n-wagonchest-stage2.png",unit_wagonchest3:"#%n-wagonchest-stage3.png",unit_wagonsource1:"#%n-wagonsource-stage1.png",unit_wagonsource2:"#%n-wagonsource-stage2.png",unit_wagonsource3:"#%n-wagonsource-stage3.png",unit_wagonsource4:"#%n-wagonsource-stage4.png",unit_wagonsource5:"#%n-wagonsource-stage5.png",unit_wagonsource6:"#%n-wagonsource-stage6.png",unit_warlock1:"#%n-warlock-stage1.png",unit_warlock2:"#%n-warlock-stage2.png",
unit_warlock3:"#%n-warlock-stage3.png",unit_warlock4:"#%n-warlock-stage4.png",unit_warlock5:"#%n-warlock-stage5.png",unit_warlock6:"#%n-warlock-stage6.png",unit_warlock7:"#%n-warlock-stage7.png",unit_warlock8:"#%n-warlock-stage8.png",unit_wheat1:"#%n-wheat-stage1.png",unit_wheat2:"#%n-wheat-stage2.png",unit_wheat3:"#%n-wheat-stage3.png",unit_wheat4:"#%n-wheat-stage4.png",unit_wheat5:"#%n-wheat-stage5.png",unit_wheat6:"#%n-wheat-stage6.png",unit_wood1:"#%n-wood-stage1.png",unit_wood2:"#%n-wood-stage2.png",unit_wood3:"#%n-wood-stage3.png",unit_wood4:"#%n-wood-stage4.png",unit_wood5:"#%n-wood-stage5.png",unit_wood6:"#%n-wood-stage6.png",unit_wood7:"#%n-wood-stage7.png",unit_wood8:"#%n-wood-stage8.png",unit_woodchest1:"#%n-woodchest-stage1.png",unit_woodchest2:"#%n-woodchest-stage2.png",unit_woodchest3:"#%n-woodchest-stage3.png",unit_woodsource1:"#%n-woodsource-stage1.png",unit_woodsource2:"#%n-woodsource-stage2.png",unit_woodsource3:"#%n-woodsource-stage3.png",
unit_woodsource4:"#%n-woodsource-stage4.png",unit_woodsource5:"#%n-woodsource-stage5.png",unit_woodsource6:"#%n-woodsource-stage6.png",unit_worker1:"#%n-worker-stage1.png",unit_worker2:"#%n-worker-stage2.png",unit_worker3:"#%n-worker-stage3.png",unit_worker4:"#%n-worker-stage4.png",bush5:"#%n-decorators-bush5.png",decorator_acorn:"#%n-decorators-decorator_acorn.png",decorator_break_left:"#%n-decorators-decorator_break_left.png",decorator_break_right:"#%n-decorators-decorator_break_right.png",decorator_bush:"#%n-decorators-decorator_bush.png",decorator_bush2:"#%n-decorators-decorator_bush2.png",decorator_bush3:"#%n-decorators-decorator_bush3.png",decorator_bush4:"#%n-decorators-decorator_bush4.png",decorator_bush6:"#%n-decorators-decorator_bush6.png",decorator_cactus_1:"#%n-decorators-decorator_cactus_1.png",decorator_cactus_2:"#%n-decorators-decorator_cactus_2.png",decorator_cave:"#%n-decorators-decorator_cave.png",decorator_cave2:"#%n-decorators-decorator_cave2.png",
decorator_cave3:"#%n-decorators-decorator_cave3.png",decorator_columns:"#%n-decorators-decorator_columns.png",decorator_crystal:"#%n-decorators-decorator_crystal.png",decorator_door:"#%n-decorators-decorator_door.png",decorator_dragon_tale:"#%n-decorators-decorator_dragon_tale.png",decorator_eggs:"#%n-decorators-decorator_eggs.png",decorator_eggs2:"#%n-decorators-decorator_eggs2.png",decorator_fence:"#%n-decorators-decorator_fence.png",decorator_frozen_tree:"#%n-decorators-decorator_frozen_tree.png",decorator_gem1:"#%n-decorators-decorator_gem1.png",decorator_gem10:"#%n-decorators-decorator_gem10.png",decorator_gem11:"#%n-decorators-decorator_gem11.png",decorator_gem2:"#%n-decorators-decorator_gem2.png",decorator_gem3:"#%n-decorators-decorator_gem3.png",decorator_gem4:"#%n-decorators-decorator_gem4.png",decorator_gem5:"#%n-decorators-decorator_gem5.png",decorator_gem6:"#%n-decorators-decorator_gem6.png",decorator_gem7:"#%n-decorators-decorator_gem7.png",
decorator_gem8:"#%n-decorators-decorator_gem8.png",decorator_gem9:"#%n-decorators-decorator_gem9.png",decorator_green_stone:"#%n-decorators-decorator_green_stone.png",decorator_green_stone1:"#%n-decorators-decorator_green_stone1.png",decorator_ice_arc:"#%n-decorators-decorator_ice_arc.png",decorator_ice_cave:"#%n-decorators-decorator_ice_cave.png",decorator_ice_crystall:"#%n-decorators-decorator_ice_crystall.png",decorator_ice_crystall_2:"#%n-decorators-decorator_ice_crystall_2.png",decorator_ice_eggs:"#%n-decorators-decorator_ice_eggs.png",decorator_ice_fir:"#%n-decorators-decorator_ice_fir.png",decorator_ice_siderock:"#%n-decorators-decorator_ice_siderock.png",decorator_ice_stairway:"#%n-decorators-decorator_ice_stairway.png",decorator_icerock_1:"#%n-decorators-decorator_icerock_1.png",decorator_icerock_10:"#%n-decorators-decorator_icerock_10.png",decorator_icerock_2:"#%n-decorators-decorator_icerock_2.png",decorator_icerock_3:"#%n-decorators-decorator_icerock_3.png",
decorator_icerock_4:"#%n-decorators-decorator_icerock_4.png",decorator_icerock_5:"#%n-decorators-decorator_icerock_5.png",decorator_icerock_6:"#%n-decorators-decorator_icerock_6.png",decorator_icerock_7:"#%n-decorators-decorator_icerock_7.png",decorator_icerock_8:"#%n-decorators-decorator_icerock_8.png",decorator_icerock_9:"#%n-decorators-decorator_icerock_9.png",decorator_iglu:"#%n-decorators-decorator_iglu.png",decorator_island:"#%n-decorators-decorator_island.png",decorator_lava:"#%n-decorators-decorator_lava.png",decorator_leaf:"#%n-decorators-decorator_leaf.png",decorator_leaf2:"#%n-decorators-decorator_leaf2.png",decorator_leaf3:"#%n-decorators-decorator_leaf3.png",decorator_leaf4:"#%n-decorators-decorator_leaf4.png",decorator_leaf_stone:"#%n-decorators-decorator_leaf_stone.png",decorator_leaf_stone2:"#%n-decorators-decorator_leaf_stone2.png",decorator_light_plant:"#%n-decorators-decorator_light_plant.png",decorator_light_plant1:"#%n-decorators-decorator_light_plant1.png",
decorator_lilies:"#%n-decorators-decorator_lilies.png",decorator_mushroom1:"#%n-decorators-decorator_mushroom1.png",decorator_mushroom2:"#%n-decorators-decorator_mushroom2.png",decorator_pillar1:"#%n-decorators-decorator_pillar1.png",decorator_pillar2:"#%n-decorators-decorator_pillar2.png",decorator_pillar3:"#%n-decorators-decorator_pillar3.png",decorator_pillar4:"#%n-decorators-decorator_pillar4.png",decorator_plant:"#%n-decorators-decorator_plant.png",decorator_plant2:"#%n-decorators-decorator_plant2.png",decorator_plant3:"#%n-decorators-decorator_plant3.png",decorator_rock:"#%n-decorators-decorator_rock.png",decorator_rock10:"#%n-decorators-decorator_rock10.png",decorator_rock11:"#%n-decorators-decorator_rock11.png",decorator_rock12:"#%n-decorators-decorator_rock12.png",decorator_rock13:"#%n-decorators-decorator_rock13.png",decorator_rock14:"#%n-decorators-decorator_rock14.png",decorator_rock15:"#%n-decorators-decorator_rock15.png",
decorator_rock16:"#%n-decorators-decorator_rock16.png",decorator_rock17:"#%n-decorators-decorator_rock17.png",decorator_rock18:"#%n-decorators-decorator_rock18.png",decorator_rock19:"#%n-decorators-decorator_rock19.png",decorator_rock2:"#%n-decorators-decorator_rock2.png",decorator_rock20:"#%n-decorators-decorator_rock20.png",decorator_rock3:"#%n-decorators-decorator_rock3.png",decorator_rock4:"#%n-decorators-decorator_rock4.png",decorator_rock5:"#%n-decorators-decorator_rock5.png",decorator_rock6:"#%n-decorators-decorator_rock6.png",decorator_rock7:"#%n-decorators-decorator_rock7.png",decorator_rock8:"#%n-decorators-decorator_rock8.png",decorator_rock9:"#%n-decorators-decorator_rock9.png",decorator_roots:"#%n-decorators-decorator_roots.png",decorator_roots2:"#%n-decorators-decorator_roots2.png",decorator_roots3:"#%n-decorators-decorator_roots3.png",decorator_roots4:"#%n-decorators-decorator_roots4.png",decorator_sandcave_1:"#%n-decorators-decorator_sandcave_1.png",
decorator_sandcave_2:"#%n-decorators-decorator_sandcave_2.png",decorator_sandcave_3:"#%n-decorators-decorator_sandcave_3.png",decorator_sandcave_4:"#%n-decorators-decorator_sandcave_4.png",decorator_sandcave_5:"#%n-decorators-decorator_sandcave_5.png",decorator_sandcave_6:"#%n-decorators-decorator_sandcave_6.png",decorator_sandrock_1:"#%n-decorators-decorator_sandrock_1.png",decorator_sandrock_2:"#%n-decorators-decorator_sandrock_2.png",decorator_sandrock_3:"#%n-decorators-decorator_sandrock_3.png",decorator_sandrock_4:"#%n-decorators-decorator_sandrock_4.png",decorator_sandstone:"#%n-decorators-decorator_sandstone.png",decorator_slope:"#%n-decorators-decorator_slope.png",decorator_snowman:"#%n-decorators-decorator_snowman.png",decorator_stairs:"#%n-decorators-decorator_stairs.png",decorator_stone1:"#%n-decorators-decorator_stone1.png",decorator_stone2:"#%n-decorators-decorator_stone2.png",decorator_stone4:"#%n-decorators-decorator_stone4.png",
decorator_stone5:"#%n-decorators-decorator_stone5.png",decorator_tree:"#%n-decorators-decorator_tree.png",decorator_tumbleweed:"#%n-decorators-decorator_tumbleweed.png",decorator_water_grid:"#%n-decorators-decorator_water_grid.png",decorator_water_stone:"#%n-decorators-decorator_water_stone.png",decorator_water_stone1:"#%n-decorators-decorator_water_stone1.png",decorator_waterfall:"#%n-decorators-decorator_waterfall.png",decorator_waterfall2:"#%n-decorators-decorator_waterfall2.png",decorator_waterice:"#%n-decorators-decorator_waterice.png"}},game_background:{urls:{background:{}}},game_background_hard:{urls:{background:{}}},gamemessage:{urls:{},injectTo:["game"],frameIds:["%n_bg_png"],jsonIds:[],soundIds:[],unpackedIds:[]},git:{urls:{},injectTo:["admin","wysiwyg"],frameIds:["push_icon","revert_icon","regular_button","regular_button_on","delete_button","scroll_bg","scroll_content_bg","loading"],jsonIds:[],soundIds:[],unpackedIds:[]},guidewindow:{urls:{png:"@%n-532b9b460e.png",
json:"@%n-f72c9292da.json"},jsons:{plist:"@%n-532b9b460e.plist"},frames:{stage_background:"#%n-%n_stage_background.png",upper_arrow:"#%n-%n_up_arrow.png",lower_arrow:"#%n-%n_down_arrow.png",blue_light:"#%n-%n_blue_light.png",blue_light_foreground:"#%n-%n_blue_light2.png",blue_light_tears:"#%n-%n_blue_light3.png",yellow_light:"#%n-%n_yellow_light.png",white_arrows:"#%n-%n_white_arrow.png",white_arrow_up:"#%n-%n_white_arrowup.png",white_plus:"#%n-%n_white_plus.png",three_white_arrows:"#%n-%n_white_three_arrow.png",crystals:"#%n-%n_crystal.png",progress:"#%n-%n_progressbar.png",tile_light:"#%n-%n_tile_light.png",guide_attention:"#%n-orderswindow-attention_exclamation.png",guide_rays:"#%n-%n_score_rays.png",energies:"#%n-%n_energy.png",treasure:"#%n-treasure-stage3.png",rating:"#%n-%n_rating.png",worker_with_building:"#%n-worker_batlepass.png",prizes_heap:"#%n-prizes_heap.png",guide_stage_1:"#%n-%n_mines.png",guide_stage_2:"#%n-%n_pickaxe.png",guide_prize:"#%n-%n_rewards.png"}},halloween:{
urls:{png:"@%n-122b4b8c6d.png",json:"@%n-89b9fddda2.json"},jsons:{halloween_jack_json:"@jsons/%n_jack-26aa44dede.json",halloween_candle_json:"@jsons/%n_candle-fedb3d9112.json",halloween_owls_json:"@jsons/%n_owls-e2cf4ee13f.json",plist:"@%n-122b4b8c6d.plist",atlas:"@%n-122b4b8c6d.atlas"},frames:{halloween_web_bottom:"#%n-%n_decor_1.png",halloween_web_top:"#%n-%n_decor_2.png",halloween_decor_forest:"#%n-%n_decor_forest.png",halloween_pumpkins:"#%n-%n_pumpkins.png",halloween_roots_top_left:"#%n-%n_roots_top_left.png",halloween_roots_top_right:"#%n-%n_roots_top_right.png"}},help_from_friends:{urls:{}},hero:{urls:{},injectTo:["main"],frameIds:[],jsonIds:[],soundIds:[],unpackedIds:[]},infoview:{urls:{},injectTo:["game"],frameIds:["timer","dwarf_head","instant_dwarf_head","button_coin_png"],jsonIds:[],soundIds:[],unpackedIds:[]},language_ar:{urls:{json:"@%n-43f0809844.json"},jsons:{common_json:"~%n/all/jsons/common_ar-473105ba0a.json",project_json:"~%n/all/jsons/ar-fd7f1a2582.json",
quests_json:"~%n/all/jsons/quests_ar-21ae15a9bd.json"}},language_de:{urls:{json:"@%n-c78c7875ee.json"},jsons:{common_json:"~%n/all/jsons/common_de-b9d00aa1f7.json",project_json:"~%n/all/jsons/de-b1b69f9988.json",quests_json:"~%n/all/jsons/quests_de-4d30488b79.json"}},language_en:{urls:{json:"@%n-5b6f86e666.json"},jsons:{common_json:"~%n/all/jsons/common_en-77bfe8bdab.json",project_json:"~%n/all/jsons/en-3502fac293.json",quests_json:"~%n/all/jsons/quests_en-73ad70f501.json"}},language_es:{urls:{json:"@%n-3cfd640bd6.json"},jsons:{common_json:"~%n/all/jsons/common_es-a151cdf986.json",project_json:"~%n/all/jsons/es-9609417260.json",quests_json:"~%n/all/jsons/quests_es-c4e7ff5c3c.json"}},language_fr:{urls:{json:"@%n-bbf440db73.json"},jsons:{common_json:"~%n/all/jsons/common_fr-fa8b0ac9be.json",project_json:"~%n/all/jsons/fr-918b962c61.json",quests_json:"~%n/all/jsons/quests_fr-a3801a33c0.json"}},language_it:{urls:{json:"@%n-f0ffc564a5.json"},jsons:{
common_json:"~%n/all/jsons/common_it-b1df4dc493.json",project_json:"~%n/all/jsons/it-b0f90dc89e.json",quests_json:"~%n/all/jsons/quests_it-96247aa3b2.json"}},language_ja:{urls:{json:"@%n-eca4af14bf.json"},jsons:{common_json:"~%n/all/jsons/common_ja-fcd18248bb.json",project_json:"~%n/all/jsons/ja-ca63825478.json",quests_json:"~%n/all/jsons/quests_ja-e2de458e21.json"}},language_ko:{urls:{json:"@%n-8917e23785.json"},jsons:{common_json:"~%n/all/jsons/common_ko-b44779db2d.json",project_json:"~%n/all/jsons/ko-0ce6c9c325.json",quests_json:"~%n/all/jsons/quests_ko-3e9a21216c.json"}},language_lv:{urls:{json:"@%n-358b547665.json"},jsons:{common_json:"~%n/all/jsons/common_lv-27a577c99d.json",project_json:"~%n/all/jsons/lv-cfb8bb7640.json",quests_json:"~%n/all/jsons/quests_lv-269870c8c2.json"}},language_nl:{urls:{json:"@%n-c0278b9118.json"},jsons:{common_json:"~%n/all/jsons/common_nl-7213b05c5d.json",project_json:"~%n/all/jsons/nl-697c46aabd.json",
quests_json:"~%n/all/jsons/quests_nl-591f1c0944.json"}},language_pl:{urls:{json:"@%n-2a027b0c7a.json"},jsons:{common_json:"~%n/all/jsons/common_pl-b0392fcc00.json",project_json:"~%n/all/jsons/pl-82cc6b82a2.json",quests_json:"~%n/all/jsons/quests_pl-f15f0c0fb7.json"}},language_pt:{urls:{json:"@%n-e08d5615d0.json"},jsons:{common_json:"~%n/all/jsons/common_pt-9a968a6e4d.json",project_json:"~%n/all/jsons/pt-4d3caaf079.json",quests_json:"~%n/all/jsons/quests_pt-ffead03750.json"}},language_ru:{urls:{json:"@%n-02bc0109f5.json"},jsons:{common_json:"~%n/all/jsons/common_ru-c816e00d6f.json",project_json:"~%n/all/jsons/ru-515ea58b57.json",quests_json:"~%n/all/jsons/quests_ru-9c8b907bf3.json"}},language_tr:{urls:{json:"@%n-9c9f273c56.json"},jsons:{common_json:"~%n/all/jsons/common_tr-8d8931b806.json",project_json:"~%n/all/jsons/tr-5773798fa7.json",quests_json:"~%n/all/jsons/quests_tr-626a20291f.json"}},language_zh:{urls:{json:"@%n-d9c6a57ab3.json"},jsons:{
common_json:"~%n/all/jsons/common_zh-1c326f6929.json",project_json:"~%n/all/jsons/zh-3662b11836.json",quests_json:"~%n/all/jsons/quests_zh-7a982a3c21.json"}},languageswindow:{urls:{png:"@%n-3f7c8c7a12.png",json:"@%n-87396ff51c.json"},jsons:{plist:"@%n-3f7c8c7a12.plist"},frames:{buttoncheck_png:"#%n-languages-check.png",buttonbg_png:"#%n-languages-bg.png",buttonbg_on_png:"#%n-languages-bg_on.png"}},lantern:{urls:{}},lantern_window:{urls:{}},levelupwindow:{urls:{levelup_effect:"~sounds/levelup-e235634d89.mp3",png:"@%n-213a712a39.png",json:"@%n-877d3f77bf.json"},jsons:{levelup_json:"@jsons/levelup-127644b63e.json",atlas:"@%n-213a712a39.atlas"}},loading_scene_backgrounds:{urls:{background:"@background-9aad858ebb.jpg"}},lose_window:{urls:{png:"@%n-d19d689b13.png",json:"@%n-f994ebbd6d.json"},jsons:{lose_json:"@jsons/lose-5481b24ffc.json",atlas:"@%n-d19d689b13.atlas"}},lottery:{urls:{},injectTo:["tile_shop","main"],frameIds:[],jsonIds:[],soundIds:[],unpackedIds:[]},magic_tournament:{urls:{}},
main:{urls:{click_effect:"~sounds/click-3d30f98dd7.mp3",coins_effect:"~sounds/coins-8e71c0d2cf.mp3",notification_effect:"~sounds/notification-4fd5211563.mp3",window_effect:"~sounds/window-f2adec4f73.mp3",reward_window_effect:"~sounds/reward-6fd002b7a1.mp3",basefont_ttf:{type:"font",name:"Marvin-Round",srcs:["~%n/all/marvin_round.ttf","~%n/all/marvin_round.eot"]},png:"@%n-690f81cf88.png",json:"@%n-7401da59c4.json"},jsons:{share_json:"~%n/all/jsons/share-107f96e29c.json",wait_json:"@jsons/loading-d6cee9aa0e.json",reward_spine_json:"@jsons/reward_animation-287c7e5ee5.json",friday_schedule:{url:"cleverapps/utils/events/client/mergecraftschedule.json",data:"[]",inline:!0},play_button_transition_json:"@jsons/play_button_transition-86d4e931e5.json",quests_data_json:{url:"cleverapps/src/mergecraft/quests_data.json",
data:'{"spreadsheet":{"url":"https://docs.google.com/spreadsheets/d/1r89PbbHDEOJXDOrYFo41WHDyi2jaQYQv6_8AAEsyZYs/","sheet":4},"quests":{"wheat_3":{"dialogue":[{"text":"messages:Quest.wheat_3.step1","person":"dwarf"}],"goal":1,"prize":{"exp":20,"coins":15}},"dishes_0":{"dialogue":[{"text":"messages:Quest.dishes_0.step1","person":"dwarf"}],"goal":1,"prize":{"exp":50,"coins":5}},"woodsource_1_1":{"dialogue":[{"text":"messages:Quest.woodsource_1_1.step1","person":"dwarf","person2":"worker_right"},{"text":"messages:Quest.woodsource_1_1.step2","person":"worker_right","person2":"dwarf"},{"text":"messages:Quest.woodsource_1_1.step3","person":"dwarf","person2":"worker_right"},{"text":"messages:Quest.woodsource_1_1.step4","person":"worker_right","person2":"dwarf"}],"goal":2,"prize":{"exp":55,"coins":15}},"woodsource_1_0":{"goal":3,"prize":{"exp":20,"coins":25}},"wood_1":{"dialogue":[{"text":"messages:Quest.wood_1.step1","person":"dwarf","person2":"worker_right"},{"text":"messages:Quest.wood_1.step2","person":"worker_right","person2":"dwarf"}],"goal":3,"prize":{"exp":50,"coins":10}},"wood_2":{"dialogue":[{"text":"messages:Quest.wood_2.step1","person":"worker"}],"goal":2,"prize":{"exp":20,"coins":15}},"wood_3":{"dialogue":[{"text":"messages:Quest.wood_3.step1","person":"dwarf","person2":"worker_right"},{"text":"messages:Quest.wood_3.step2","person":"worker_right","person2":"dwarf"},{"text":"messages:Quest.wood_3.step3","person":"dwarf","person2":"worker_right"}],"goal":2,"prize":{"exp":30,"coins":100}},"wood_4":{"dialogue":[{"text":"messages:Quest.wood_4.step1","person":"dwarf","person2":"worker_right"},{"text":"messages:Quest.wood_4.step2","person":"worker_right","person2":"dwarf"}],"goal":2,"prize":{"exp":100,"coins":5}},"wood_5":{"dialogue":[{"text":"messages:Quest.wood_5.step1","person":"dwarf","person2":"worker_right"},{"text":"messages:Quest.wood_5.step2","person":"worker_right","person2":"dwarf"}],"goal":2,"prize":{"exp":100,"coins":10}},"wood_6":{"dialogue":[{"text":"messages:Quest.wood_6.step1","person":"dwarf","person2":"worker_right"},{"text":"messages:Quest.wood_6.step2","person":"worker_right","person2":"dwarf"}],"goal":2,"prize":{"exp":150,"coins":10}},"wood_7":{"dialogue":[{"text":"messages:Quest.wood_7.step1","person":"dwarf","person2":"worker_right"},{"text":"messages:Quest.wood_7.step2","person":"worker_right","person2":"dwarf"}],"goal":2,"prize":{"exp":200,"coins":10}},"king_1":{"dialogue":[{"text":"messages:Quest.king_1.step1","person":"dwarf","person2":"worker_right"},{"text":"messages:Quest.king_1.step2","person":"worker_right","person2":"dwarf"}],"goal":1,"prize":{"exp":25,"coins":10}},"king_2":{"dialogue":[{"text":"messages:Quest.king_2.step1","person":"dwarf","person2":"worker_right"},{"text":"messages:Quest.king_2.step2","person":"worker_right","person2":"dwarf"}],"goal":1,"prize":{"exp":50,"coins":100}},"king_3":{"dialogue":[{"text":"messages:Quest.king_3.step1","person":"dwarf","person2":"worker_right"},{"text":"messages:Quest.king_3.step2","person":"worker_right","person2":"dwarf"}],"goal":1,"prize":{"exp":50,"coins":5}},"dragonisland_1":{"dialogue":[{"text":"messages:Quest.dragonisland_1.step1","person":"dwarf","person2":"worker_right"},{"text":"messages:Quest.dragonisland_1.step2","person":"worker_right","person2":"dwarf"},{"text":"messages:Quest.dragonisland_1.step3","person":"dwarf","person2":"worker_right"},{"text":"messages:Quest.dragonisland_1.step4","person":"worker_right","person2":"dwarf"}],"goal":1,"prize":{"exp":50,"coins":5}},"bear_1":{"dialogue":[{"text":"messages:Quest.bear_1.step1","person":"dwarf","person2":"worker_right"},{"text":"messages:Quest.bear_1.step2","person":"worker_right","person2":"dwarf"},{"text":"messages:Quest.bear_1.step3","person":"dwarf","person2":"worker_right"},{"text":"messages:Quest.bear_1.step4","person":"king_right","person2":"dwarf"}],"goal":1,"prize":{"exp":20,"coins":5}},"bear_2":{"dialogue":[{"text":"messages:Quest.bear_2.step1","person":"dwarf","person2":"worker_right"},{"text":"messages:Quest.bear_2.step2","person":"worker_right","person2":"dwarf"},{"text":"messages:Quest.bear_2.step3","person":"dwarf","person2":"worker_right"},{"text":"messages:Quest.bear_2.step4","person":"king_right","person2":"dwarf"}],"goal":1,"prize":{"exp":25,"coins":5}},"bear_3":{"dialogue":[{"text":"messages:Quest.bear_3.step1","person":"dwarf","person2":"worker_right"},{"text":"messages:Quest.bear_3.step2","person":"worker_right","person2":"dwarf"},{"text":"messages:Quest.bear_3.step3","person":"dwarf","person2":"worker_right"}],"goal":1,"prize":{"exp":50,"coins":100}},"bear_4":{"dialogue":[{"text":"messages:Quest.bear_4.step1","person":"king","person2":"worker_right"},{"text":"messages:Quest.bear_4.step2","person":"worker_right","person2":"king"}],"goal":1,"prize":{"exp":75,"coins":5}},"bear_5":{"dialogue":[{"text":"messages:Quest.bear_5.step1","person":"dwarf","person2":"worker_right"},{"text":"messages:Quest.bear_5.step2","person":"worker_right","person2":"dwarf"},{"text":"messages:Quest.bear_5.step3","person":"dwarf","person2":"worker_right"},{"text":"messages:Quest.bear_5.step4","person":"worker_right","person2":"dwarf"}],"goal":1,"prize":{"exp":100,"coins":5}},"bear_6":{"dialogue":[{"text":"messages:Quest.bear_6.step1","person":"worker","person2":"king_right"},{"text":"messages:Quest.bear_6.step2","person":"king_right","person2":"worker"}],"goal":1,"prize":{"exp":125,"coins":5}},"candies_4":{"dialogue":[{"text":"messages:Quest.candies_4.step1","person":"dwarf","person2":"worker_right"},{"text":"messages:Quest.candies_4.step2","person":"worker_right","person2":"dwarf"}],"goal":5,"prize":{"exp":50,"coins":5}},"wood_9":{"dialogue":[{"text":"messages:Quest.wood_9.step1","person":"dwarf","person2":"worker_right"},{"text":"messages:Quest.wood_9.step2","person":"worker_right","person2":"dwarf"},{"text":"messages:Quest.wood_9.step3","person":"dwarf","person2":"worker_right"},{"text":"messages:Quest.wood_9.step4","person":"worker_right","person2":"dwarf"},{"text":"messages:Quest.wood_9.step5","person":"dwarf","person2":"worker_right"}],"goal":1,"prize":{"exp":500,"coins":150}},"wheat_4":{"goal":11,"prize":{"exp":50,"coins":5}},"stone_1":{"dialogue":[{"text":"messages:Quest.stone_1.step1","person":"dwarf","person2":"king_right"},{"text":"messages:Quest.stone_1.step2","person":"king_right","person2":"dwarf"}],"goal":3,"prize":{"exp":20,"coins":5}},"stone_2":{"dialogue":[{"text":"messages:Quest.stone_2.step1","person":"dwarf","person2":"worker_right"},{"text":"messages:Quest.stone_2.step2","person":"worker_right","person2":"dwarf"}],"goal":2,"prize":{"exp":25,"coins":5}},"stone_3":{"dialogue":[{"text":"messages:Quest.stone_3.step1","person":"dwarf","person2":"worker_right"},{"text":"messages:Quest.stone_3.step2","person":"worker_right","person2":"dwarf"},{"text":"messages:Quest.stone_3.step3","person":"dwarf","person2":"worker_right"}],"goal":2,"prize":{"exp":50,"coins":5}},"stone_4":{"dialogue":[{"text":"messages:Quest.stone_4.step1","person":"dwarf","person2":"worker_right"},{"text":"messages:Quest.stone_4.step2","person":"worker_right","person2":"dwarf"}],"goal":2,"prize":{"exp":75,"coins":5}},"stone_5":{"dialogue":[{"text":"messages:Quest.stone_5.step1","person":"king","person2":"worker_right"},{"text":"messages:Quest.stone_5.step2","person":"worker_right","person2":"king"}],"goal":2,"prize":{"exp":100,"coins":5}},"stone_6":{"dialogue":[{"text":"messages:Quest.stone_6.step1","person":"king","person2":"dwarf_right"},{"text":"messages:Quest.stone_6.step2","person":"dwarf_right","person2":"king"}],"goal":2,"prize":{"exp":125,"coins":10}},"stone_7":{"dialogue":[{"text":"messages:Quest.stone_7.step1","person":"dwarf","person2":"worker_right"},{"text":"messages:Quest.stone_7.step2","person":"worker_right","person2":"dwarf"}],"goal":2,"prize":{"exp":150,"coins":10}},"stone_8":{"dialogue":[{"text":"messages:Quest.stone_8.step1","person":"worker","person2":"dwarf_right"},{"text":"messages:Quest.stone_8.step2","person":"dwarf_right","person2":"worker"}],"goal":2,"prize":{"exp":175,"coins":10}},"stone_10":{"dialogue":[{"text":"messages:Quest.stone_10.step1","person":"king","person2":"worker_right"},{"text":"messages:Quest.stone_10.step2","person":"worker_right","person2":"king"},{"text":"messages:Quest.stone_10.step3","person":"dwarf_right","person2":"king"}],"goal":1,"prize":{"exp":500,"coins":150}},"wagon_1":{"dialogue":[{"text":"messages:Quest.wagon_1.step1","person":"worker","person2":"dwarf_right"},{"text":"messages:Quest.wagon_1.step2","person":"dwarf_right","person2":"worker"},{"text":"messages:Quest.wagon_1.step3","person":"bear_right","person2":"worker"}],"goal":3,"prize":{"exp":20,"coins":5}},"wagon_2":{"dialogue":[{"text":"messages:Quest.wagon_2.step1","person":"worker","person2":"bear_right"},{"text":"messages:Quest.wagon_2.step2","person":"bear_right","person2":"worker"}],"goal":2,"prize":{"exp":25,"coins":5}},"wagon_3":{"dialogue":[{"text":"messages:Quest.wagon_3.step1","person":"dwarf","person2":"bear_right"},{"text":"messages:Quest.wagon_3.step2","person":"worker_right","person2":"dwarf"}],"goal":2,"prize":{"exp":50,"coins":5}},"wagon_4":{"dialogue":[{"text":"messages:Quest.wagon_4.step1","person":"king","person2":"bear_right"},{"text":"messages:Quest.wagon_4.step2","person":"bear_right","person2":"king"},{"text":"messages:Quest.wagon_4.step3","person":"dwarf","person2":"bear_right"},{"text":"messages:Quest.wagon_4.step4","person":"worker_right","person2":"dwarf"}],"goal":2,"prize":{"exp":75,"coins":5}},"wagon_5":{"dialogue":[{"text":"messages:Quest.wagon_5.step1","person":"dwarf","person2":"worker_right"},{"text":"messages:Quest.wagon_5.step2","person":"worker_right","person2":"dwarf"},{"text":"messages:Quest.wagon_5.step3","person":"dwarf","person2":"worker_right"},{"text":"messages:Quest.wagon_5.step4","person":"bear_right","person2":"dwarf"}],"goal":2,"prize":{"exp":100,"coins":5}},"wagon_6":{"dialogue":[{"text":"messages:Quest.wagon_6.step1","person":"king","person2":"dwarf_right"},{"text":"messages:Quest.wagon_6.step2","person":"dwarf_right","person2":"king"},{"text":"messages:Quest.wagon_6.step3","person":"bear","person2":"dwarf_right"}],"goal":2,"prize":{"exp":125,"coins":10}},"wagon_7":{"dialogue":[{"text":"messages:Quest.wagon_7.step1","person":"dwarf","person2":"bear_right"},{"text":"messages:Quest.wagon_7.step2","person":"bear_right","person2":"dwarf"}],"goal":2,"prize":{"exp":150,"coins":10}},"wagon_8":{"dialogue":[{"text":"messages:Quest.wagon_8.step1","person":"dwarf","person2":"bear_right"},{"text":"messages:Quest.wagon_8.step2","person":"worker","person2":"bear_right"},{"text":"messages:Quest.wagon_8.step3","person":"bear_right","person2":"worker"}],"goal":2,"prize":{"exp":175,"coins":10}},"wagon_10":{"dialogue":[{"text":"messages:Quest.wagon_10.step1","person":"bear","person2":"worker_right"},{"text":"messages:Quest.wagon_10.step2","person":"worker_right","person2":"bear"},{"text":"messages:Quest.wagon_10.step3","person":"dwarf_right","person2":"bear"}],"goal":1,"prize":{"exp":500,"coins":150}},"elf_1":{"dialogue":[{"text":"messages:Quest.elf_1.step1","person":"dwarf","person2":"bear_right"},{"text":"messages:Quest.elf_1.step2","person":"bear_right","person2":"dwarf"},{"text":"messages:Quest.elf_1.step3","person":"dwarf","person2":"bear_right"},{"text":"messages:Quest.elf_1.step4","person":"worker_right","person2":"dwarf"}],"goal":1,"prize":{"exp":20,"coins":5}},"elf_2":{"dialogue":[{"text":"messages:Quest.elf_2.step1","person":"bear","person2":"king_right"},{"text":"messages:Quest.elf_2.step2","person":"king_right","person2":"bear"}],"goal":1,"prize":{"exp":25,"coins":5}},"elf_3":{"dialogue":[{"text":"messages:Quest.elf_3.step1","person":"dwarf","person2":"worker_right"},{"text":"messages:Quest.elf_3.step2","person":"worker_right","person2":"dwarf"},{"text":"messages:Quest.elf_3.step3","person":"bear_right","person2":"dwarf"},{"text":"messages:Quest.elf_3.step4","person":"king","person2":"bear_right"}],"goal":1,"prize":{"exp":50,"coins":5}},"elf_4":{"dialogue":[{"text":"messages:Quest.elf_4.step1","person":"dwarf","person2":"worker_right"},{"text":"messages:Quest.elf_4.step2","person":"worker_right","person2":"dwarf"},{"text":"messages:Quest.elf_4.step3","person":"dwarf","person2":"worker_right"}],"goal":1,"prize":{"exp":75,"coins":5}},"elf_5":{"dialogue":[{"text":"messages:Quest.elf_5.step1","person":"dwarf","person2":"bear_right"},{"text":"messages:Quest.elf_5.step2","person":"bear_right","person2":"dwarf"},{"text":"messages:Quest.elf_5.step3","person":"dwarf","person2":"bear_right"},{"text":"messages:Quest.elf_5.step4","person":"bear_right","person2":"dwarf"}],"goal":1,"prize":{"exp":100,"coins":5}},"elf_6":{"dialogue":[{"text":"messages:Quest.elf_6.step1","person":"king","person2":"worker_right"},{"text":"messages:Quest.elf_6.step2","person":"worker_right","person2":"king"}],"goal":1,"prize":{"exp":125,"coins":10}},"elf_7":{"dialogue":[{"text":"messages:Quest.elf_7.step1","person":"dwarf","person2":"worker_right"},{"text":"messages:Quest.elf_7.step2","person":"worker_right","person2":"dwarf"}],"goal":1,"prize":{"exp":150,"coins":10}},"warlock_1":{"dialogue":[{"text":"messages:Quest.warlock_1.step1","person":"dwarf","person2":"bear_right"},{"text":"messages:Quest.warlock_1.step2","person":"bear_right","person2":"dwarf"},{"text":"messages:Quest.warlock_1.step3","person":"dwarf","person2":"bear_right"},{"text":"messages:Quest.warlock_1.step4","person":"bear_right","person2":"dwarf"}],"goal":1,"prize":{"exp":20,"coins":5}},"warlock_2":{"dialogue":[{"text":"messages:Quest.warlock_2.step1","person":"dwarf","person2":"worker_right"},{"text":"messages:Quest.warlock_2.step2","person":"worker_right","person2":"dwarf"},{"text":"messages:Quest.warlock_2.step3","person":"dwarf","person2":"worker_right"},{"text":"messages:Quest.warlock_2.step4","person":"worker_right","person2":"dwarf"}],"goal":1,"prize":{"exp":25,"coins":5}},"warlock_3":{"dialogue":[{"text":"messages:Quest.warlock_3.step1","person":"dwarf","person2":"bear_right"},{"text":"messages:Quest.warlock_3.step2","person":"bear_right","person2":"dwarf"},{"text":"messages:Quest.warlock_3.step3","person":"dwarf","person2":"bear_right"}],"goal":1,"prize":{"exp":50,"coins":5}},"warlock_4":{"dialogue":[{"text":"messages:Quest.warlock_4.step1","person":"elf","person2":"dwarf_right"},{"text":"messages:Quest.warlock_4.step2","person":"dwarf_right","person2":"elf"},{"text":"messages:Quest.warlock_4.step3","person":"elf","person2":"dwarf_right"}],"goal":1,"prize":{"exp":75,"coins":5}},"warlock_5":{"dialogue":[{"text":"messages:Quest.warlock_5.step1","person":"king","person2":"elf_right"},{"text":"messages:Quest.warlock_5.step2","person":"elf_right","person2":"king"},{"text":"messages:Quest.warlock_5.step3","person":"king","person2":"elf_right"}],"goal":1,"prize":{"exp":100,"coins":5}},"warlock_6":{"dialogue":[{"text":"messages:Quest.warlock_6.step1","person":"dwarf","person2":"bear_right"},{"text":"messages:Quest.warlock_6.step2","person":"bear_right","person2":"dwarf"},{"text":"messages:Quest.warlock_6.step3","person":"dwarf","person2":"bear_right"}],"goal":1,"prize":{"exp":125,"coins":10}},"warlock_7":{"dialogue":[{"text":"messages:Quest.warlock_7.step1","person":"dwarf","person2":"elf_right"},{"text":"messages:Quest.warlock_7.step2","person":"elf_right","person2":"dwarf"}],"goal":1,"prize":{"exp":150,"coins":10}},"warlock_8":{"dialogue":[{"text":"messages:Quest.warlock_8.step1","person":"king","person2":"worker_right"},{"text":"messages:Quest.warlock_8.step2","person":"worker_right","person2":"king"}],"goal":1,"prize":{"exp":175,"coins":10}},"magicplant_1":{"dialogue":[{"text":"messages:Quest.magicplant_1.step1","person":"dwarf","person2":"worker_right"},{"text":"messages:Quest.magicplant_1.step2","person":"worker_right","person2":"dwarf"},{"text":"messages:Quest.magicplant_1.step3","person":"dwarf","person2":"worker_right"}],"goal":1,"prize":{"exp":20,"coins":5}},"magicplant_2":{"dialogue":[{"text":"messages:Quest.magicplant_2.step1","person":"worker","person2":"dwarf_right"},{"text":"messages:Quest.magicplant_2.step2","person":"dwarf_right","person2":"worker"},{"text":"messages:Quest.magicplant_2.step3","person":"worker","person2":"dwarf_right"},{"text":"messages:Quest.magicplant_2.step4","person":"dwarf_right","person2":"worker"}],"goal":1,"prize":{"exp":25,"coins":5}},"magicplant_3":{"dialogue":[{"text":"messages:Quest.magicplant_3.step1","person":"dwarf","person2":"worker_right"},{"text":"messages:Quest.magicplant_3.step2","person":"worker_right","person2":"dwarf"}],"goal":1,"prize":{"exp":50,"coins":5}},"magicplant_4":{"dialogue":[{"text":"messages:Quest.magicplant_4.step1","person":"dwarf","person2":"worker_right"},{"text":"messages:Quest.magicplant_4.step2","person":"worker_right","person2":"dwarf"},{"text":"messages:Quest.magicplant_4.step3","person":"dwarf","person2":"worker_right"},{"text":"messages:Quest.magicplant_4.step4","person":"worker_right","person2":"dwarf"}],"goal":1,"prize":{"exp":75,"coins":5}},"magicplant_5":{"dialogue":[{"text":"messages:Quest.magicplant_5.step1","person":"dwarf","person2":"worker_right"},{"text":"messages:Quest.magicplant_5.step2","person":"worker_right","person2":"dwarf"},{"text":"messages:Quest.magicplant_5.step3","person":"dwarf","person2":"worker_right"}],"goal":1,"prize":{"exp":100,"coins":5}},"magicplant_6":{"dialogue":[{"text":"messages:Quest.magicplant_6.step1","person":"dwarf","person2":"worker_right"},{"text":"messages:Quest.magicplant_6.step2","person":"worker_right","person2":"dwarf"},{"text":"messages:Quest.magicplant_6.step3","person":"dwarf","person2":"worker_right"},{"text":"messages:Quest.magicplant_6.step4","person":"worker_right","person2":"dwarf"}],"goal":1,"prize":{"exp":125,"coins":10}},"magicplant_7":{"dialogue":[{"text":"messages:Quest.magicplant_7.step1","person":"dwarf","person2":"worker_right"},{"text":"messages:Quest.magicplant_7.step2","person":"worker_right","person2":"dwarf"}],"goal":1,"prize":{"exp":150,"coins":10}},"magicplant_8":{"dialogue":[{"text":"messages:Quest.magicplant_8.step1","person":"dwarf","person2":"worker_right"},{"text":"messages:Quest.magicplant_8.step2","person":"worker_right","person2":"dwarf"},{"text":"messages:Quest.magicplant_8.step3","person":"dwarf","person2":"worker_right"},{"text":"messages:Quest.magicplant_8.step4","person":"worker_right","person2":"dwarf"}],"goal":1,"prize":{"exp":175,"coins":10}},"troll_1":{"dialogue":[{"text":"messages:Quest.troll_1.step1","person":"dwarf","person2":"worker_right"},{"text":"messages:Quest.troll_1.step2","person":"worker_right","person2":"dwarf"}],"goal":1,"prize":{"exp":20,"coins":5}},"troll_2":{"dialogue":[{"text":"messages:Quest.troll_2.step1","person":"dwarf","person2":"bear_right"},{"text":"messages:Quest.troll_2.step2","person":"bear_right","person2":"dwarf"},{"text":"messages:Quest.troll_2.step3","person":"dwarf","person2":"bear_right"}],"goal":1,"prize":{"exp":25,"coins":5}},"troll_3":{"dialogue":[{"text":"messages:Quest.troll_3.step1","person":"bear","person2":"elf_right"},{"text":"messages:Quest.troll_3.step2","person":"elf_right","person2":"bear"},{"text":"messages:Quest.troll_3.step3","person":"bear","person2":"elf_right"}],"goal":1,"prize":{"exp":50,"coins":5}},"troll_4":{"dialogue":[{"text":"messages:Quest.troll_4.step1","person":"dwarf","person2":"worker_right"},{"text":"messages:Quest.troll_4.step2","person":"worker_right","person2":"dwarf"}],"goal":1,"prize":{"exp":75,"coins":5}},"troll_5":{"dialogue":[{"text":"messages:Quest.troll_5.step1","person":"king","person2":"warlock_right"},{"text":"messages:Quest.troll_5.step2","person":"warlock_right","person2":"king"},{"text":"messages:Quest.troll_5.step3","person":"king","person2":"warlock_right"}],"goal":1,"prize":{"exp":100,"coins":5}},"troll_6":{"dialogue":[{"text":"messages:Quest.troll_6.step1","person":"dwarf","person2":"elf_right"},{"text":"messages:Quest.troll_6.step2","person":"elf_right","person2":"dwarf"},{"text":"messages:Quest.troll_6.step3","person":"dwarf","person2":"elf_right"},{"text":"messages:Quest.troll_6.step4","person":"elf_right","person2":"dwarf"}],"goal":1,"prize":{"exp":125,"coins":10}},"troll_7":{"dialogue":[{"text":"messages:Quest.troll_7.step1","person":"dwarf","person2":"worker_right"},{"text":"messages:Quest.troll_7.step2","person":"worker_right","person2":"dwarf"}],"goal":1,"prize":{"exp":150,"coins":10}},"troll_8":{"dialogue":[{"text":"messages:Quest.troll_8.step1","person":"dwarf","person2":"king_right"},{"text":"messages:Quest.troll_8.step2","person":"king_right","person2":"dwarf"}],"goal":1,"prize":{"exp":175,"coins":10}},"troll_9":{"dialogue":[{"text":"messages:Quest.troll_9.step1","person":"king","person2":"warlock_right"},{"text":"messages:Quest.troll_9.step2","person":"warlock_right","person2":"king"},{"text":"messages:Quest.troll_9.step3","person":"elf_right","person2":"king"}],"goal":1,"prize":{"exp":200,"coins":10}},"bamboo_1":{"dialogue":[{"text":"messages:Quest.bamboo_1.step1","person":"dwarf","person2":"bear_right"},{"text":"messages:Quest.bamboo_1.step2","person":"bear_right","person2":"dwarf"},{"text":"messages:Quest.bamboo_1.step3","person":"dwarf","person2":"bear_right"}],"goal":3,"prize":{"exp":20,"coins":5}},"bamboo_2":{"dialogue":[{"text":"messages:Quest.bamboo_2.step1","person":"dwarf","person2":"worker_right"},{"text":"messages:Quest.bamboo_2.step2","person":"worker_right","person2":"dwarf"}],"goal":2,"prize":{"exp":25,"coins":5}},"bamboo_3":{"dialogue":[{"text":"messages:Quest.bamboo_3.step1","person":"dwarf","person2":"bear_right"},{"text":"messages:Quest.bamboo_3.step2","person":"bear_right","person2":"dwarf"},{"text":"messages:Quest.bamboo_3.step3","person":"dwarf","person2":"worker_right"}],"goal":2,"prize":{"exp":50,"coins":5}},"bamboo_4":{"dialogue":[{"text":"messages:Quest.bamboo_4.step1","person":"dwarf","person2":"elf_right"},{"text":"messages:Quest.bamboo_4.step2","person":"elf_right","person2":"dwarf"},{"text":"messages:Quest.bamboo_4.step3","person":"dwarf","person2":"elf_right"}],"goal":2,"prize":{"exp":75,"coins":5}},"bamboo_5":{"dialogue":[{"text":"messages:Quest.bamboo_5.step1","person":"king","person2":"worker_right"},{"text":"messages:Quest.bamboo_5.step2","person":"worker_right","person2":"king"},{"text":"messages:Quest.bamboo_5.step3","person":"king","person2":"worker_right"}],"goal":2,"prize":{"exp":100,"coins":5}},"bamboo_6":{"dialogue":[{"text":"messages:Quest.bamboo_6.step1","person":"worker","person2":"dwarf_right"},{"text":"messages:Quest.bamboo_6.step2","person":"dwarf_right","person2":"worker"},{"text":"messages:Quest.bamboo_6.step3","person":"worker","person2":"dwarf_right"}],"goal":2,"prize":{"exp":125,"coins":10}},"bamboo_7":{"dialogue":[{"text":"messages:Quest.bamboo_7.step1","person":"dwarf","person2":"worker_right"},{"text":"messages:Quest.bamboo_7.step2","person":"worker_right","person2":"dwarf"},{"text":"messages:Quest.bamboo_7.step3","person":"bear_right","person2":"dwarf"}],"goal":2,"prize":{"exp":150,"coins":10}},"bamboo_8":{"dialogue":[{"text":"messages:Quest.bamboo_8.step1","person":"dwarf","person2":"worker_right"},{"text":"messages:Quest.bamboo_8.step2","person":"worker_right","person2":"dwarf"}],"goal":2,"prize":{"exp":175,"coins":10}},"bamboo_10":{"dialogue":[{"text":"messages:Quest.bamboo_10.step1","person":"dwarf","person2":"worker_right"},{"text":"messages:Quest.bamboo_10.step2","person":"worker_right","person2":"dwarf"}],"goal":1,"prize":{"exp":200,"coins":10}},"sapphire_1":{"dialogue":[{"text":"messages:Quest.sapphire_1.step1","person":"dwarf","person2":"worker_right"},{"text":"messages:Quest.sapphire_1.step2","person":"worker_right","person2":"dwarf"},{"text":"messages:Quest.sapphire_1.step3","person":"dwarf","person2":"worker_right"}],"goal":3,"prize":{"exp":20,"coins":5}},"sapphire_2":{"dialogue":[{"text":"messages:Quest.sapphire_2.step1","person":"dwarf","person2":"worker_right"},{"text":"messages:Quest.sapphire_2.step2","person":"worker_right","person2":"dwarf"}],"goal":2,"prize":{"exp":25,"coins":5}},"sapphire_3":{"dialogue":[{"text":"messages:Quest.sapphire_3.step1","person":"dwarf","person2":"worker_right"},{"text":"messages:Quest.sapphire_3.step2","person":"worker_right","person2":"dwarf"}],"goal":2,"prize":{"exp":50,"coins":5}},"sapphire_4":{"dialogue":[{"text":"messages:Quest.sapphire_4.step1","person":"bear","person2":"worker_right"},{"text":"messages:Quest.sapphire_4.step2","person":"dwarf_right","person2":"bear"},{"text":"messages:Quest.sapphire_4.step3","person":"worker_right","person2":"bear"}],"goal":2,"prize":{"exp":75,"coins":5}},"sapphire_5":{"dialogue":[{"text":"messages:Quest.sapphire_5.step1","person":"elf","person2":"worker_right"},{"text":"messages:Quest.sapphire_5.step2","person":"worker_right","person2":"elf"},{"text":"messages:Quest.sapphire_5.step3","person":"elf","person2":"worker_right"}],"goal":2,"prize":{"exp":100,"coins":5}},"sapphire_6":{"dialogue":[{"text":"messages:Quest.sapphire_6.step1","person":"dwarf","person2":"worker_right"},{"text":"messages:Quest.sapphire_6.step2","person":"worker_right","person2":"dwarf"},{"text":"messages:Quest.sapphire_6.step3","person":"dwarf","person2":"worker_right"}],"goal":2,"prize":{"exp":125,"coins":10}},"sapphire_7":{"dialogue":[{"text":"messages:Quest.sapphire_7.step1","person":"worker","person2":"dwarf_right"},{"text":"messages:Quest.sapphire_7.step2","person":"dwarf_right","person2":"worker"},{"text":"messages:Quest.sapphire_7.step3","person":"worker","person2":"dwarf_right"}],"goal":2,"prize":{"exp":150,"coins":10}},"sapphire_8":{"dialogue":[{"text":"messages:Quest.sapphire_8.step1","person":"dwarf","person2":"bear_right"},{"text":"messages:Quest.sapphire_8.step2","person":"bear_right","person2":"dwarf"},{"text":"messages:Quest.sapphire_8.step3","person":"dwarf","person2":"bear_right"},{"text":"messages:Quest.sapphire_8.step4","person":"bear_right","person2":"dwarf"}],"goal":2,"prize":{"exp":175,"coins":10}},"sapphire_9":{"dialogue":[{"text":"messages:Quest.sapphire_9.step1","person":"worker","person2":"dwarf_right"},{"text":"messages:Quest.sapphire_9.step2","person":"dwarf_right","person2":"worker"},{"text":"messages:Quest.sapphire_9.step3","person":"worker","person2":"dwarf_right"},{"text":"messages:Quest.sapphire_9.step4","person":"dwarf_right","person2":"worker"}],"goal":2,"prize":{"exp":200,"coins":10}},"sapphire_11":{"dialogue":[{"text":"messages:Quest.sapphire_11.step1","person":"dwarf","person2":"elf_right"},{"text":"messages:Quest.sapphire_11.step2","person":"elf_right","person2":"dwarf"},{"text":"messages:Quest.sapphire_11.step3","person":"dwarf","person2":"elf_right"},{"text":"messages:Quest.sapphire_11.step4","person":"elf_right","person2":"dwarf"}],"goal":1,"prize":{"exp":225,"coins":15}},"knight_1":{"dialogue":[{"text":"messages:Quest.knight_1.step1","person":"dwarf","person2":"king_right"},{"text":"messages:Quest.knight_1.step2","person":"king_right","person2":"dwarf"}],"goal":1,"prize":{"exp":20,"coins":5}},"knight_2":{"dialogue":[{"text":"messages:Quest.knight_2.step1","person":"dwarf","person2":"troll_right"},{"text":"messages:Quest.knight_2.step2","person":"troll_right","person2":"dwarf"},{"text":"messages:Quest.knight_2.step3","person":"dwarf","person2":"troll_right"},{"text":"messages:Quest.knight_2.step4","person":"troll_right","person2":"dwarf"}],"goal":1,"prize":{"exp":25,"coins":5}},"knight_3":{"dialogue":[{"text":"messages:Quest.knight_3.step1","person":"dwarf","person2":"bear_right"},{"text":"messages:Quest.knight_3.step2","person":"bear_right","person2":"dwarf"},{"text":"messages:Quest.knight_3.step3","person":"dwarf","person2":"bear_right"},{"text":"messages:Quest.knight_3.step4","person":"bear_right","person2":"dwarf"}],"goal":1,"prize":{"exp":50,"coins":5}},"knight_4":{"dialogue":[{"text":"messages:Quest.knight_4.step1","person":"worker","person2":"dwarf_right"},{"text":"messages:Quest.knight_4.step2","person":"dwarf_right","person2":"worker"},{"text":"messages:Quest.knight_4.step3","person":"worker","person2":"dwarf_right"},{"text":"messages:Quest.knight_4.step4","person":"dwarf_right","person2":"worker"}],"goal":1,"prize":{"exp":75,"coins":5}},"knight_5":{"dialogue":[{"text":"messages:Quest.knight_5.step1","person":"dwarf","person2":"warlock_right"},{"text":"messages:Quest.knight_5.step2","person":"warlock_right","person2":"dwarf"},{"text":"messages:Quest.knight_5.step3","person":"dwarf","person2":"warlock_right"}],"goal":1,"prize":{"exp":100,"coins":5}},"knight_6":{"dialogue":[{"text":"messages:Quest.knight_6.step1","person":"dwarf","person2":"worker_right"},{"text":"messages:Quest.knight_6.step2","person":"worker_right","person2":"dwarf"},{"text":"messages:Quest.knight_6.step3","person":"dwarf","person2":"worker_right"},{"text":"messages:Quest.knight_6.step4","person":"worker_right","person2":"dwarf"}],"goal":1,"prize":{"exp":125,"coins":10}},"knight_7":{"dialogue":[{"text":"messages:Quest.knight_7.step1","person":"king","person2":"worker_right"},{"text":"messages:Quest.knight_7.step2","person":"worker_right","person2":"king"}],"goal":1,"prize":{"exp":150,"coins":10}},"knight_8":{"dialogue":[{"text":"messages:Quest.knight_8.step1","person":"worker","person2":"dwarf_right"},{"text":"messages:Quest.knight_8.step2","person":"dwarf_right","person2":"worker"},{"text":"messages:Quest.knight_8.step3","person":"worker","person2":"dwarf_right"}],"goal":1,"prize":{"exp":175,"coins":10}},"knight_9":{"dialogue":[{"text":"messages:Quest.knight_9.step1","person":"bear","person2":"dwarf_right"},{"text":"messages:Quest.knight_9.step2","person":"dwarf_right","person2":"bear"},{"text":"messages:Quest.knight_9.step3","person":"bear","person2":"dwarf_right"}],"goal":1,"prize":{"exp":200,"coins":10}},"knight_10":{"dialogue":[{"text":"messages:Quest.knight_10.step1","person":"dwarf","person2":"worker_right"},{"text":"messages:Quest.knight_10.step2","person":"worker_right","person2":"dwarf"},{"text":"messages:Quest.knight_10.step3","person":"dwarf","person2":"worker_right"}],"goal":1,"prize":{"exp":225,"coins":15}}}}',
inline:!0},crown_json:"@jsons/level_crown-e904aad65e.json",pack_icon_json:"@jsons/icon_pack1-7fbeaf6294.json",pack1_icon_json:"@jsons/icon_pack2-cc85b06051.json",pack2_icon_json:"@jsons/icon_pack3-01a54e22d1.json",energy_feast_icon_json:"@jsons/energy_tournament-0c6bde045e.json",battlepass_icon_json:"@jsons/battlepass_icon-9b2581bfc4.json",orders_json:"@jsons/orders_icon-3704aded22.json",units_shop_json:"@jsons/market_icon-b2c01578b1.json",units_library_json:"@jsons/units_icon-b7f7e718c4.json",transition_json:"@jsons/transition-1def927b5d.json",default_json:"@jsons/dwarf_dialogue-9a98cb93aa.json",worker_json:"@jsons/worker_dialogue-15774db988.json",dwarf_json:"@jsons/dwarf_dialogue-9a98cb93aa.json",king_json:"@jsons/king_dialogue-d39ef28038.json",bear_json:"@jsons/bear_dialogue-278fac3cde.json",elf_json:"@jsons/elf_dialogue-02edab26ca.json",warlock_json:"@jsons/warlock_dialogue-7e6976dbfc.json",troll_json:"@jsons/troll_dialogue-948b91fed2.json",
miner_json:"@jsons/miner_dialogue-a25b10be99.json",seller_json:"@jsons/seller-bbdbd6ffb6.json",ow_rewards_highlight_json:"@jsons/orders-202ff163f6.json",plist:"@%n-690f81cf88.plist",atlas:"@%n-690f81cf88.atlas"},frames:{notification_bg_png:"#%n-notification-notification_bg.png",fb_icon_png:"#%n-socialicons-fb_icon.png",ok_icon_png:"#%n-socialicons-ok_icon.png",vk_icon_png:"#%n-socialicons-vk_icon.png",nk_icon_png:"#%n-socialicons-nk_icon.png",mm_icon_png:"#%n-socialicons-mm_icon.png",fs_icon_png:"#%n-socialicons-fs_icon.png",draugiem_icon_png:"#%n-socialicons-draugiem_icon.png",mobage_icon_png:"#%n-socialicons-mobage_icon.png",google_icon_png:"#%n-socialicons-google_icon.png",apple_icon_png:"#%n-socialicons-apple_icon.png",white_button_png:"#%n-socialicons-white_button.png",white_outline_button_png:"#%n-socialicons-white_outline_button.png",white_outline_button_on_png:"#%n-socialicons-white_outline_button_on.png",white_shadow_button_png:"#%n-socialicons-white_shadow_button.png",
white_shadow_button_on_png:"#%n-socialicons-white_shadow_button_on.png",blue_outline_button_png:"#%n-socialicons-blue_outline_button.png",blue_outline_button_on_png:"#%n-socialicons-blue_outline_button_on.png",select_friend_checkbox:"#%n-selectfriends-checkbox_sf.png",select_friend_checkbox_selected:"#%n-selectfriends-checkbox_mark.png",light_bg_png:"#%n-tournament-light_bg.png",light_bg_you_png:"#%n-tournament-light_bg_you.png",row_player_png:"#%n-tournament-row_player.png",row_you_png:"#%n-tournament-row_you.png",levelstart_cup_1:"#%n-leaderboard-1_place.png",levelstart_cup_2:"#%n-leaderboard-2_place.png",levelstart_cup_3:"#%n-leaderboard-3_place.png",shop_tab_off:"#%n-orderswindow-tab_2.png",shop_tab_on:"#%n-orderswindow-tab_1.png",wood_bg:"#%n-orderswindow-game_ui_tab_bg.png",android_avatar:"#%n-avatars-android_avatar.png",ios_avatar:"#%n-avatars-ios_avatar.png",user_avatar:"#%n-avatars-user_avatar.png",default_avatar:"#%n-avatars-default_avatar.jpg",
window_title_bg_png:"#%n-windows-window_title_bg.png",mission_letter_png:"#%n-missions-mission_letter.png",tooltip_bg_png:"#%n-tooltip-box.png",tooltip_shadow_arrow_png:"#%n-tooltip-arrow.png",tooltip_arrow_png:"#%n-tooltip-arrow2.png",gold_small_png:"#%n-reward_icons-ruby_small.png",reward_gold_png:"#%n-reward_icons-ruby.png",reward_coin_png:"#%n-reward_icons-coin.png",reward_exp_png:"#%n-reward_icons-exp.png",reward_wand_png:"#%n-reward_icons-wand.png",reward_worker_png:"#%n-reward_icons-worker.png",reward_energy_png:"#%n-reward_icons-energy.png",shop_energy_png:"#%n-reward_icons-energy_shop.png",shop_gold_png:"#%n-reward_icons-ruby_shop.png",shop_coin_png:"#%n-reward_icons-coin_shop.png",window_bg_png:"#%n-orderswindow-game_ui_tab_bg.png",tab_attention:"#%n-orderswindow-attention_exclamation_large.png",tab_icon_specials:"#%n-tabs-specials.png",tab_icon_orders:"#%n-tabs-orders.png",tab_icon_recipes:"#%n-tabs-recipes.png",tab_icon_ingredients:"#%n-tabs-ingredients.png",
tab_icon_chest:"#%n-tabs-chest.png",tab_icon_fruit:"#%n-tabs-fruit.png",tab_icon_heroes:"#%n-tabs-heroes.png",tab_icon_resource:"#%n-tabs-resource.png",tab_icon_source:"#%n-tabs-source.png",tab_icon_valuable:"#%n-tabs-valuable.png",window_title_background:"#%n-orderswindow-game_ui_tab_header_on.png",window_foreground_png:"#%n-orderswindow-foreground.png",window_close_png:"#%n-orderswindow-close_button.png",window_close_on_png:"#%n-orderswindow-close_button_on.png",adicon_png:"#%n-shared-adicon.png",tutorial_click_png:"#%n-tutorial-circle.png",tutorial_hand_png:"#%n-tutorial-hand.png",nostroke62pt_0:"#%n-marvin-round-nostroke-62pt-0.png",nostroke62pt_1:"#%n-marvin-round-nostroke-62pt-1.png",nostroke62pt_2:"#%n-marvin-round-nostroke-62pt-2.png",nostroke62pt_3:"#%n-marvin-round-nostroke-62pt-3.png",nostroke62pt_4:"#%n-marvin-round-nostroke-62pt-4.png",nostroke62pt_5:"#%n-marvin-round-nostroke-62pt-5.png",nostroke62pt_6:"#%n-marvin-round-nostroke-62pt-6.png",
nostroke62pt_7:"#%n-marvin-round-nostroke-62pt-7.png",nostroke62pt_8:"#%n-marvin-round-nostroke-62pt-8.png",nostroke62pt_9:"#%n-marvin-round-nostroke-62pt-9.png",nostroke62pt_colon:"#%n-marvin-round-nostroke-62pt-colon.png",nostroke62pt_slash:"#%n-marvin-round-nostroke-62pt-slash.png",nostroke62pt_plus:"#%n-marvin-round-nostroke-62pt-plus.png",nostroke62pt_minus:"#%n-marvin-round-nostroke-62pt-minus.png",nostroke62pt_x:"#%n-marvin-round-nostroke-62pt-x.png",nostroke62pt_space:"#%n-marvin-round-nostroke-62pt-space.png",default45pt_0:"#%n-marvin-round-45pt-0.png",default45pt_1:"#%n-marvin-round-45pt-1.png",default45pt_2:"#%n-marvin-round-45pt-2.png",default45pt_3:"#%n-marvin-round-45pt-3.png",default45pt_4:"#%n-marvin-round-45pt-4.png",default45pt_5:"#%n-marvin-round-45pt-5.png",default45pt_6:"#%n-marvin-round-45pt-6.png",default45pt_7:"#%n-marvin-round-45pt-7.png",default45pt_8:"#%n-marvin-round-45pt-8.png",default45pt_9:"#%n-marvin-round-45pt-9.png",
default45pt_colon:"#%n-marvin-round-45pt-colon.png",default45pt_slash:"#%n-marvin-round-45pt-slash.png",default45pt_plus:"#%n-marvin-round-45pt-plus.png",default45pt_minus:"#%n-marvin-round-45pt-minus.png",default45pt_x:"#%n-marvin-round-45pt-x.png",default45pt_space:"#%n-marvin-round-45pt-space.png",default62pt_0:"#%n-marvin-round-62pt-0.png",default62pt_1:"#%n-marvin-round-62pt-1.png",default62pt_2:"#%n-marvin-round-62pt-2.png",default62pt_3:"#%n-marvin-round-62pt-3.png",default62pt_4:"#%n-marvin-round-62pt-4.png",default62pt_5:"#%n-marvin-round-62pt-5.png",default62pt_6:"#%n-marvin-round-62pt-6.png",default62pt_7:"#%n-marvin-round-62pt-7.png",default62pt_8:"#%n-marvin-round-62pt-8.png",default62pt_9:"#%n-marvin-round-62pt-9.png",default62pt_colon:"#%n-marvin-round-62pt-colon.png",default62pt_slash:"#%n-marvin-round-62pt-slash.png",default62pt_plus:"#%n-marvin-round-62pt-plus.png",default62pt_minus:"#%n-marvin-round-62pt-minus.png",default62pt_x:"#%n-marvin-round-62pt-x.png",
default62pt_space:"#%n-marvin-round-62pt-space.png",default76pt_0:"#%n-marvin-round-76pt-0.png",default76pt_1:"#%n-marvin-round-76pt-1.png",default76pt_2:"#%n-marvin-round-76pt-2.png",default76pt_3:"#%n-marvin-round-76pt-3.png",default76pt_4:"#%n-marvin-round-76pt-4.png",default76pt_5:"#%n-marvin-round-76pt-5.png",default76pt_6:"#%n-marvin-round-76pt-6.png",default76pt_7:"#%n-marvin-round-76pt-7.png",default76pt_8:"#%n-marvin-round-76pt-8.png",default76pt_9:"#%n-marvin-round-76pt-9.png",default76pt_colon:"#%n-marvin-round-76pt-colon.png",default76pt_slash:"#%n-marvin-round-76pt-slash.png",default76pt_plus:"#%n-marvin-round-76pt-plus.png",default76pt_minus:"#%n-marvin-round-76pt-minus.png",default76pt_x:"#%n-marvin-round-76pt-x.png",default76pt_space:"#%n-marvin-round-76pt-space.png",toolbar_attention_icon_png:"#%n-orderswindow-attention_exclamation.png",menu_icon_png:"#%n-controlbuttons-menu.png",button_png:"#%n-controlbuttons-menu_button.png",
button_on_png:"#%n-controlbuttons-menu_button_on.png",fullscreen_icon_png:"#%n-controlbuttons-fullscreen_icon.png",back_button_png:"#%n-controlbuttons-back_button.png",back_button_on_png:"#%n-controlbuttons-back_button_on.png",back_icon_png:"#%n-controlbuttons-back.png",life_png:"#%n-menubar-energy.png",coin_png:"#%n-menubar-ruby.png",menubar_bg_png:"#%n-menubar-bar_bg.png",plus_button_png:"#%n-menubar-plus.png",plus_button_on_png:"#%n-menubar-plus_on.png",bar_timer_png:"#%n-menubar-bar_timer.png",small_timer_icon_png:"#%n-menubar-timer.png",menubar_attention_png:"#%n-orderswindow-attention_exclamation_large.png",menubar_progress_png:"#%n-level-progressbar.png",menubar_round_bg_png:"#%n-level-level_round.png",merge_coin_png:"#%n-menubar-coin.png",merge_wand_png:"#%n-menubar-wand.png",merge_worker_png:"#%n-menubar-worker.png",window_button_png:"#%n-buttons-button.png",window_button_on_png:"#%n-buttons-button_on.png",window_button_disabled_png:"#%n-buttons-button_off.png",
blue_button_png:"#%n-buttons-button_blue.png",blue_button_on_png:"#%n-buttons-button_blue_on.png",small_blue_button:"#%n-buttons-small_blue_button.png",small_blue_button_on:"#%n-buttons-small_blue_button_on.png",help_button_png:"#%n-buttons-help_small.png",help_button_on_png:"#%n-buttons-help_small_on.png",exit_button_icon:"#%n-buttons-exit_icon.png",scene_exit_button:"#%n-buttons-scene_exit.png",small_green_button:"#%n-buttons-small_green_button.png",small_green_button_on:"#%n-buttons-small_green_button_on.png",music_off_png:"#%n-sounds-music_off.png",music_on_png:"#%n-sounds-music_on.png",sound_off_png:"#%n-sounds-sound_off.png",sound_on_png:"#%n-sounds-sound_on.png",close_small:"#%n-buttons-close_small.png",close_small_on:"#%n-buttons-close_small_on.png",red_button:"#%n-buttons-red_button.png",red_button_on:"#%n-buttons-red_button_on.png",icon_bg:"#%n-sidebar-icon_bg.png",lock:"#%n-sidebar-lock_sidebar.png",attention_png:"#%n-orderswindow-attention_exclamation_large.png",
icon_text_bg:"#%n-sidebar-icon_text_bg.png",caption_bg:"#%n-sidebar-icon_text_bg.png",bounty_ready_icon:"#%n-friend_messages-bounty_ready_icon.png",accept_stuck_coins_icon:"#%n-friend_messages-accept_stuck_coins_icon.png",avatar_frame:"#%n-avatars-avatar_frame.png",avatar_frame2:"#%n-avatars-avatar_frame2.png",bg_png:"#%n-dialogues-bg.png",dialogue_name:"#%n-dialogues-char_name_bg.png",arrow_png:"#%n-dialogues-arrow_bg.png",bg_minimal_png:"#%n-dialogues-mini_bg.png",ow_details_background:"#%n-orderswindow-details_background.png",hero_background:"#%n-orderswindow-hero_bg.png",hero_selected_background:"#%n-orderswindow-chosen_hero_bg.png",plus_separator:"#%n-orderswindow-plus.png",equal_separator:"#%n-orderswindow-equally.png",worker_hint_png:"#%n-hint-worker_hint.png",info_background:"#%n-orderswindow-icon_background.png",timer_substrate:"#%n-game-bar_bg.png",sanglass_timer_icon:"#%n-speedup-speedup_sandglass.png",ow_tab_header_on:"#%n-orderswindow-game_ui_tab_header_on.png",
ow_scroll_background:"#%n-orderswindow-hero_bg.png",icon_unknown:"#%n-heroes-unknown.png",icon_dwarf:"#%n-heroes-dwarf.png",icon_king:"#%n-heroes-king.png",icon_bear:"#%n-heroes-bear.png",icon_elf:"#%n-heroes-elf.png",icon_warlock:"#%n-heroes-warlock.png",icon_troll:"#%n-heroes-troll.png",horizontal_scroll_foreground:"#%n-orderswindow-horizontal_scroll_foreground.png",timer_icon:"#%n-speedup-speedup_clock.png",button_energy_png:"#%n-buttons-button_energy.png"}},map_decorators:{urls:{},injectTo:["game"],frameIds:["bush5","decorator_acorn","decorator_break_left","decorator_break_right","decorator_bush","decorator_bush2","decorator_bush3","decorator_bush4","decorator_bush6","decorator_cactus_1","decorator_cactus_2","decorator_cave","decorator_cave2","decorator_cave3","decorator_columns","decorator_crystal","decorator_door","decorator_dragon_tale","decorator_eggs","decorator_eggs2","decorator_fence","decorator_frozen_tree","decorator_gem1","decorator_gem10","decorator_gem11",
"decorator_gem2","decorator_gem3","decorator_gem4","decorator_gem5","decorator_gem6","decorator_gem7","decorator_gem8","decorator_gem9","decorator_green_stone","decorator_green_stone1","decorator_ice_arc","decorator_ice_cave","decorator_ice_crystall","decorator_ice_crystall_2","decorator_ice_eggs","decorator_ice_fir","decorator_ice_siderock","decorator_ice_stairway","decorator_icerock_1","decorator_icerock_10","decorator_icerock_2","decorator_icerock_3","decorator_icerock_4","decorator_icerock_5","decorator_icerock_6","decorator_icerock_7","decorator_icerock_8","decorator_icerock_9","decorator_iglu","decorator_island","decorator_lava","decorator_leaf","decorator_leaf2","decorator_leaf3","decorator_leaf4","decorator_leaf_stone","decorator_leaf_stone2","decorator_light_plant","decorator_light_plant1","decorator_lilies","decorator_mushroom1","decorator_mushroom2","decorator_pillar1","decorator_pillar2","decorator_pillar3","decorator_pillar4","decorator_plant","decorator_plant2",
"decorator_plant3","decorator_rock","decorator_rock10","decorator_rock11","decorator_rock12","decorator_rock13","decorator_rock14","decorator_rock15","decorator_rock16","decorator_rock17","decorator_rock18","decorator_rock19","decorator_rock2","decorator_rock20","decorator_rock3","decorator_rock4","decorator_rock5","decorator_rock6","decorator_rock7","decorator_rock8","decorator_rock9","decorator_roots","decorator_roots2","decorator_roots3","decorator_roots4","decorator_sandcave_1","decorator_sandcave_2","decorator_sandcave_3","decorator_sandcave_4","decorator_sandcave_5","decorator_sandcave_6","decorator_sandrock_1","decorator_sandrock_2","decorator_sandrock_3","decorator_sandrock_4","decorator_sandstone","decorator_slope","decorator_snowman","decorator_stairs","decorator_stone1","decorator_stone2","decorator_stone4","decorator_stone5","decorator_tree","decorator_tumbleweed","decorator_water_grid","decorator_water_stone","decorator_water_stone1","decorator_waterfall",
"decorator_waterfall2","decorator_waterice"],jsonIds:[],soundIds:[],unpackedIds:[]},memorial:{urls:{}},menubar:{urls:{},injectTo:["minesweeper","game","main","race"],frameIds:["life_png","coin_png","%n_bg_png","plus_button_png","plus_button_on_png","bar_timer_png","small_timer_icon_png","%n_attention_png","%n_progress_png","%n_round_bg_png","merge_coin_png","merge_wand_png","merge_worker_png"],jsonIds:["crown_json"],soundIds:[],unpackedIds:[]},merge:{urls:{},injectTo:["game"],frameIds:["grounded_bg","generator_star_on","generator_star_off","bar_png","bar_bg_png","pickaxe","seller_icon","hint_background_png","upgradable_level_png","upgradable_bar_png","upgradable_bar_bg_png","guide_button_png","guide_button_on_png","first_place_prize_png","second_place_prize_png","third_place_prize_png","stand_ground"],jsonIds:["recipe_bubble_down_json","recipe_bubble_up_json","buy_fog_tile_json","change_stage_cloud_json","appearance_json","destruction_json","reward_highlight_json","flickering_json",
"%n_json","hint_json","rays_json","pixels_json","adsbarrel_json","bonus_shining_json","specialoffer_helicopter_json","battle_star"],soundIds:["%n_effect","new_order_effect","prize_view_created_effect","spawn_start_effect","spawn_landing_effect","spawn_fail_effect","spawn_beetle_effect","specialoffer_appearance_effect","specialoffer_window_effect","specialoffer_buying_effect","specialoffer_destruction_effect","specialoffer_helicopter_effect","instantworker_build_effect","unit_desturction_effect","coins_drop_effect","upgradable_build_effect","pixel_fly_effect","pixel_spawn_effect","barrel_appear_sfx"],unpackedIds:[]},mergeui:{urls:{},injectTo:["game"],frameIds:["background","background_warning","pointer","pointer2","pointer2_warning","timer_substrate","timer_icon_png","timer_ribbon_icon_png","watch_ad_icon","progress_background","progress_stroke","progress_bar","small_attention_exclamation","small_attention_exclamation_disabled","small_ok_exclamation","attention_ok",
"attention_exclamation","attention_exclamation_disabled","attention_sandglass","attention_coin","icon_background","icon_background_light","icon_background_disabled","icon_blocker","next_arrow"],jsonIds:["timer_json"],soundIds:[],unpackedIds:[]},metha_simple_main:{urls:{}},metha_top_layer_0:{urls:{}},mineable:{urls:{},injectTo:["game"],frameIds:[],jsonIds:["mining_start_json"],soundIds:["mining_start_effect","mining_wood_start_effect","mining_stone_start_effect","mining_wagon_start_effect"],unpackedIds:[]},minesweeper:{urls:{background:"@mine_bg-80472b209d.jpg",pickaxe_sfx:"~sounds/sh_s_mine_pick-0a4b67c384.mp3",bomb_sfx:"~sounds/sh_s_mine_bomb-138b718681.mp3",mine_vin_sfx:"~sounds/mine_bonus-f9a6fcbb66.mp3",miner_fail_sfx:"~sounds/dwarf_lose-dd54669226.mp3",miner_good_sfx:"~sounds/dwarf_win-d54cd1a686.mp3",victory_sfx:"~sounds/sh_s_mine_win-b422bddbd6.mp3",buy_continue_sfx:"~sounds/sh_s_mine_no_bomb-d6e71bc122.mp3",mine_music:"~sounds/mine_music-6e08d898f5.mp3",
png:"@%n-35860b2507.png",json:"@%n-1224778b5f.json"},jsons:{minesweeper:"@jsons/%n-60875f8d45.json",bg_json:"@jsons/mine_bg-8f1ab5b900.json",custom_cursor_json:"@jsons/pickaxe-ef40eb38d2.json",victory_animation:"@jsons/mine_victory-673e41778e.json",crown_json:"@jsons/level_crown-e904aad65e.json",plist:"@%n-35860b2507.plist",atlas:"@%n-35860b2507.atlas"},frames:{progressbar:"#%n-progressbar.png",guide_button_png:"#%n-guide_button.png",guide_button_on_png:"#%n-guide_button_on.png",details_background:"#%n-orderswindow-icon_background.png",gold_small_png:"#%n-reward_icons-ruby_small.png",reward_gold_png:"#%n-reward_icons-ruby.png",reward_coin_png:"#%n-reward_icons-coin.png",reward_exp_png:"#%n-reward_icons-exp.png",reward_wand_png:"#%n-reward_icons-wand.png",reward_worker_png:"#%n-reward_icons-worker.png",reward_energy_png:"#%n-reward_icons-energy.png",shop_energy_png:"#%n-reward_icons-energy_shop.png",shop_gold_png:"#%n-reward_icons-ruby_shop.png",
shop_coin_png:"#%n-reward_icons-coin_shop.png",nostroke62pt_0:"#%n-marvin-round-nostroke-62pt-0.png",nostroke62pt_1:"#%n-marvin-round-nostroke-62pt-1.png",nostroke62pt_2:"#%n-marvin-round-nostroke-62pt-2.png",nostroke62pt_3:"#%n-marvin-round-nostroke-62pt-3.png",nostroke62pt_4:"#%n-marvin-round-nostroke-62pt-4.png",nostroke62pt_5:"#%n-marvin-round-nostroke-62pt-5.png",nostroke62pt_6:"#%n-marvin-round-nostroke-62pt-6.png",nostroke62pt_7:"#%n-marvin-round-nostroke-62pt-7.png",nostroke62pt_8:"#%n-marvin-round-nostroke-62pt-8.png",nostroke62pt_9:"#%n-marvin-round-nostroke-62pt-9.png",nostroke62pt_colon:"#%n-marvin-round-nostroke-62pt-colon.png",nostroke62pt_slash:"#%n-marvin-round-nostroke-62pt-slash.png",nostroke62pt_plus:"#%n-marvin-round-nostroke-62pt-plus.png",nostroke62pt_minus:"#%n-marvin-round-nostroke-62pt-minus.png",nostroke62pt_x:"#%n-marvin-round-nostroke-62pt-x.png",nostroke62pt_space:"#%n-marvin-round-nostroke-62pt-space.png",default45pt_0:"#%n-marvin-round-45pt-0.png",
default45pt_1:"#%n-marvin-round-45pt-1.png",default45pt_2:"#%n-marvin-round-45pt-2.png",default45pt_3:"#%n-marvin-round-45pt-3.png",default45pt_4:"#%n-marvin-round-45pt-4.png",default45pt_5:"#%n-marvin-round-45pt-5.png",default45pt_6:"#%n-marvin-round-45pt-6.png",default45pt_7:"#%n-marvin-round-45pt-7.png",default45pt_8:"#%n-marvin-round-45pt-8.png",default45pt_9:"#%n-marvin-round-45pt-9.png",default45pt_colon:"#%n-marvin-round-45pt-colon.png",default45pt_slash:"#%n-marvin-round-45pt-slash.png",default45pt_plus:"#%n-marvin-round-45pt-plus.png",default45pt_minus:"#%n-marvin-round-45pt-minus.png",default45pt_x:"#%n-marvin-round-45pt-x.png",default45pt_space:"#%n-marvin-round-45pt-space.png",default62pt_0:"#%n-marvin-round-62pt-0.png",default62pt_1:"#%n-marvin-round-62pt-1.png",default62pt_2:"#%n-marvin-round-62pt-2.png",default62pt_3:"#%n-marvin-round-62pt-3.png",default62pt_4:"#%n-marvin-round-62pt-4.png",default62pt_5:"#%n-marvin-round-62pt-5.png",
default62pt_6:"#%n-marvin-round-62pt-6.png",default62pt_7:"#%n-marvin-round-62pt-7.png",default62pt_8:"#%n-marvin-round-62pt-8.png",default62pt_9:"#%n-marvin-round-62pt-9.png",default62pt_colon:"#%n-marvin-round-62pt-colon.png",default62pt_slash:"#%n-marvin-round-62pt-slash.png",default62pt_plus:"#%n-marvin-round-62pt-plus.png",default62pt_minus:"#%n-marvin-round-62pt-minus.png",default62pt_x:"#%n-marvin-round-62pt-x.png",default62pt_space:"#%n-marvin-round-62pt-space.png",default76pt_0:"#%n-marvin-round-76pt-0.png",default76pt_1:"#%n-marvin-round-76pt-1.png",default76pt_2:"#%n-marvin-round-76pt-2.png",default76pt_3:"#%n-marvin-round-76pt-3.png",default76pt_4:"#%n-marvin-round-76pt-4.png",default76pt_5:"#%n-marvin-round-76pt-5.png",default76pt_6:"#%n-marvin-round-76pt-6.png",default76pt_7:"#%n-marvin-round-76pt-7.png",default76pt_8:"#%n-marvin-round-76pt-8.png",default76pt_9:"#%n-marvin-round-76pt-9.png",default76pt_colon:"#%n-marvin-round-76pt-colon.png",
default76pt_slash:"#%n-marvin-round-76pt-slash.png",default76pt_plus:"#%n-marvin-round-76pt-plus.png",default76pt_minus:"#%n-marvin-round-76pt-minus.png",default76pt_x:"#%n-marvin-round-76pt-x.png",default76pt_space:"#%n-marvin-round-76pt-space.png",life_png:"#%n-menubar-energy.png",coin_png:"#%n-menubar-ruby.png",menubar_bg_png:"#%n-menubar-bar_bg.png",plus_button_png:"#%n-menubar-plus.png",plus_button_on_png:"#%n-menubar-plus_on.png",bar_timer_png:"#%n-menubar-bar_timer.png",small_timer_icon_png:"#%n-menubar-timer.png",menubar_attention_png:"#%n-orderswindow-attention_exclamation_large.png",menubar_progress_png:"#%n-level-progressbar.png",menubar_round_bg_png:"#%n-level-level_round.png",merge_coin_png:"#%n-menubar-coin.png",merge_wand_png:"#%n-menubar-wand.png",merge_worker_png:"#%n-menubar-worker.png"}},moves:{urls:{},injectTo:["game"],frameIds:[],jsonIds:[],soundIds:[],unpackedIds:[]},newelements:{urls:{quest_new_effect:"~sounds/quest_new-b06184316e.mp3",
quest_completed_effect:"~sounds/quest_completed-2f7bbc5994.mp3",png:"@%n-c8afb63b6c.png",json:"@%n-dae52a0d5f.json"},jsons:{scroll_json:"@jsons/scroll-a3150f37dd.json",shining_json:"@jsons/shining-7974626fa1.json",plist:"@%n-c8afb63b6c.plist",atlas:"@%n-c8afb63b6c.atlas"},frames:{elements_icon_bg:"#%n-icon_bg.png"}},openchestwindow:{urls:{},injectTo:["game"],frameIds:["icon_background","icon_background_light"],jsonIds:[],soundIds:[],unpackedIds:[]},orderswindow:{urls:{},injectTo:["main"],frameIds:["ow_details_background","hero_background","hero_selected_background","plus_separator","equal_separator"],jsonIds:["ow_rewards_highlight_json"],soundIds:[],unpackedIds:[]},particle:{urls:{},injectTo:["game"],frameIds:[],jsonIds:["%ns_drag_json","%ns_spawn_json","%ns_collect_json","levelup_path_json"],soundIds:[],unpackedIds:["%n_texture"]},piggybank_window:{urls:{}},promotion_adventure_en:{urls:{image:"@adventure-5d35db83ca.jpg"}},promotion_adventure_ru:{urls:{image:"@adventure-81c39864ca.jpg"
}},promotion_crocword_de:{urls:{image:"@crocword-8e180fa28c.jpg"}},promotion_crocword_en:{urls:{image:"@crocword-50a3c2e09b.jpg"}},promotion_crocword_es:{urls:{image:"@crocword-5d726c18ef.jpg"}},promotion_crocword_fr:{urls:{image:"@crocword-b29ec54414.jpg"}},promotion_crocword_it:{urls:{image:"@crocword-52921a2490.jpg"}},promotion_crocword_ru:{urls:{image:"@crocword-04c2173528.jpg"}},promotion_differences_en:{urls:{image:"@differences-f96d4306e7.jpg"}},promotion_differences_ru:{urls:{image:"@differences-247f801ff4.jpg"}},promotion_heroes_en:{urls:{image:"@heroes-a832bb6d6d.jpg"}},promotion_heroes_ru:{urls:{image:"@heroes-09bae5b254.jpg"}},promotion_magicwords_de:{urls:{image:"@magicwords-27fe6117a0.jpg"}},promotion_magicwords_en:{urls:{image:"@magicwords-04657482ac.jpg"}},promotion_magicwords_es:{urls:{image:"@magicwords-9992e631df.jpg"}},promotion_magicwords_fr:{urls:{image:"@magicwords-39ad2d700d.jpg"}},promotion_magicwords_it:{urls:{image:"@magicwords-da3d9e149d.jpg"}},
promotion_magicwords_ru:{urls:{image:"@magicwords-27091fcfcc.jpg"}},promotion_mergecraft_en:{urls:{image:"@mergecraft-14d19e6dc3.jpg"}},promotion_mergecraft_ru:{urls:{image:"@mergecraft-801c1a3952.jpg"}},promotion_olympics_de:{urls:{image:"@olympics-499c616821.jpg"}},promotion_olympics_en:{urls:{image:"@olympics-fb3fadbc6f.jpg"}},promotion_olympics_es:{urls:{image:"@olympics-767b28ab28.jpg"}},promotion_olympics_fr:{urls:{image:"@olympics-28fa89a300.jpg"}},promotion_olympics_it:{urls:{image:"@olympics-a9eb2d4445.jpg"}},promotion_olympics_ru:{urls:{image:"@olympics-657a1659cd.jpg"}},promotion_riddles_en:{urls:{image:"@riddles-6e4a64f461.jpg"}},promotion_riddles_ru:{urls:{image:"@riddles-a04f70fa4d.jpg"}},promotion_runes_en:{urls:{image:"@runes-4189fa6106.jpg"}},promotion_runes_ru:{urls:{image:"@runes-8ea348dfc8.jpg"}},promotion_scramble_en:{urls:{image:"@scramble-245e9c08c0.jpg"}},promotion_scramble_fr:{urls:{image:"@scramble-da8e269592.jpg"}},promotion_scramble_ru:{urls:{
image:"@scramble-5a0aa23d2f.jpg"}},promotion_tripeaks_de:{urls:{image:"@tripeaks-d748eb75e8.jpg"}},promotion_tripeaks_en:{urls:{image:"@tripeaks-228cedda9d.jpg"}},promotion_tripeaks_es:{urls:{image:"@tripeaks-e80b0dbc61.jpg"}},promotion_tripeaks_fr:{urls:{image:"@tripeaks-c7665a69ae.jpg"}},promotion_tripeaks_it:{urls:{image:"@tripeaks-82d49cd2e2.jpg"}},promotion_tripeaks_ru:{urls:{image:"@tripeaks-2efc59480b.jpg"}},promotion_wordsoup_de:{urls:{image:"@wordsoup-8392808e0c.jpg"}},promotion_wordsoup_en:{urls:{image:"@wordsoup-26337c641b.jpg"}},promotion_wordsoup_es:{urls:{image:"@wordsoup-cde236a3a6.jpg"}},promotion_wordsoup_fr:{urls:{image:"@wordsoup-d02f7f9b50.jpg"}},promotion_wordsoup_it:{urls:{image:"@wordsoup-c9f4605075.jpg"}},promotion_wordsoup_ru:{urls:{image:"@wordsoup-4b87340634.jpg"}},puzzle15:{urls:{cubes_effect:"~sounds/cubes-4a31d42903.mp3",puzzle_click_effect:"~sounds/puzzle_click-a4d9342793.mp3",open_cubes_effect:"~sounds/open_cubes-9d80090fbe.mp3",png:"@%n-97e542135a.png",
json:"@%n-5825352e92.json"},jsons:{sparkle_json:"@jsons/sparkle-2cbca30ceb.json",plist:"@%n-97e542135a.plist",atlas:"@%n-97e542135a.atlas"},frames:{unit1:"#%n-merge-1cristall_red.png",unit2:"#%n-merge-2chesticon.png",unit3:"#%n-merge-3cubokicon.png",unit4:"#%n-merge-4cubikicon.png",unit5:"#%n-merge-5giftbox.png",unit6:"#%n-merge-6clipsgame.png",unit7:"#%n-merge-7jokericon.png",unit8:"#%n-merge-8magniticon.png",unit9:"#%n-merge-9bowicon.png",unit10:"#%n-merge-10hearticon.png",unit11:"#%n-merge-11clubsicon.png",unit12:"#%n-merge-12spadesicon.png",unit13:"#%n-merge-13diamondsicon.png",unit14:"#%n-merge-14bombicon.png",unit15:"#%n-merge-15lockicon.png",unit16:"#%n-merge-16jeverlyicon.png",unit17:"#%n-merge-17cherryicon.png",unit18:"#%n-merge-18dollarsicon.png",unit19:"#%n-merge-19coinicon.png",unit20:"#%n-merge-20dollarcoin.png",unit21:"#%n-merge-21staricon.png",unit22:"#%n-merge-22glassesicon.png",tile:"#%n-merge-tail.png",table_frame:"#%n-merge-table_frame.png",
picture1:"#%n-picture-picture1.png",picture2:"#%n-picture-picture2.png",picture3:"#%n-picture-picture3.png",picture4:"#%n-picture-picture4.png",picture5:"#%n-picture-picture5.png",picture6:"#%n-picture-picture6.png",picture7:"#%n-picture-picture7.png",picture8:"#%n-picture-picture8.png",picture9:"#%n-picture-picture9.png",pictureFull:"#%n-picture-picture_full.png",pictureTile:"#%n-picture-piece.png",digit1:"#%n-picture-1.png",digit2:"#%n-picture-2.png",digit3:"#%n-picture-3.png",digit4:"#%n-picture-4.png",digit5:"#%n-picture-5.png",digit6:"#%n-picture-6.png",digit7:"#%n-picture-7.png",digit8:"#%n-picture-8.png",picture_frame:"#%n-picture-picture_bg.png",move_arrows:"#%n-picture-move_arrows.png",connect_line:"#%n-static-connect_line.png",detach_square:"#%n-static-detach_square.png",unit_star:"#%n-static-unit_star.png"},debug:!0,targets:["web"]},race:{urls:{png:"@%n-30afdc27b4.png",json:"@%n-ccc0c710e3.json"},jsons:{crown_json:"@jsons/level_crown-e904aad65e.json",
plist:"@%n-30afdc27b4.plist",atlas:"@%n-30afdc27b4.atlas"},frames:{life_png:"#%n-menubar-energy.png",coin_png:"#%n-menubar-ruby.png",menubar_bg_png:"#%n-menubar-bar_bg.png",plus_button_png:"#%n-menubar-plus.png",plus_button_on_png:"#%n-menubar-plus_on.png",bar_timer_png:"#%n-menubar-bar_timer.png",small_timer_icon_png:"#%n-menubar-timer.png",menubar_attention_png:"#%n-orderswindow-attention_exclamation_large.png",menubar_progress_png:"#%n-level-progressbar.png",menubar_round_bg_png:"#%n-level-level_round.png",merge_coin_png:"#%n-menubar-coin.png",merge_wand_png:"#%n-menubar-wand.png",merge_worker_png:"#%n-menubar-worker.png"}},raffle_window:{urls:{}},request_center:{urls:{},injectTo:["main"],frameIds:["bounty_ready_icon","accept_stuck_coins_icon"],jsonIds:[],soundIds:[],unpackedIds:[]},reward_element:{urls:{},injectTo:["game"],frameIds:[],jsonIds:[],soundIds:[],unpackedIds:[]},reward_icons:{urls:{},injectTo:["minesweeper","tile_shop","main","shop_user_gold_view","admin"],frameIds:[
"gold_small_png","reward_gold_png","reward_coin_png","reward_exp_png","reward_wand_png","reward_worker_png","reward_energy_png","shop_energy_png","shop_gold_png","shop_coin_png"],jsonIds:[],soundIds:[],unpackedIds:[]},rose_tournament:{urls:{}},rotate_phone:{urls:{rotate_png:"@phoneturn_horizontal-b996b69ae0.png"}},ruby_tournament:{urls:{}},screenshots:{urls:{dialogue_bg:"@dialogue_bg-496e9933b5.png",stars_left:"@stars_left-b17e940430.png",stars_right:"@stars_right-81e125906f.png",snowflake_left:"@snowflake_left-2af05dbaa0.png",snowflake_right:"@snowflake_right-2da817d596.png",snow_cover:"@snow_cover-9b8801034e.png",firework_effect:"~sounds/firework-d9e4d4e1be.mp3",png:"@%n-1cb466bba1.png",json:"@%n-d153201b1d.json"},jsons:{fail_json:"@jsons/fail-a4d762c869.json",logo_json:"@jsons/logo-a7cb786dc4.json",plist:"@%n-1cb466bba1.plist",atlas:"@%n-1cb466bba1.atlas"},frames:{avatar_friend_1:"#%n-avatar_friend_1.png",avatar_friend_2:"#%n-avatar_friend_2.png",avatar_user:"#%n-avatar_user.png",
avatar_1:"#%n-avatar_1.png",avatar_2:"#%n-avatar_2.png",avatar_3:"#%n-avatar_3.png",avatar_4:"#%n-avatar_4.png",avatar_5:"#%n-avatar_5.png",avatar_6:"#%n-avatar_6.png",avatar_7:"#%n-avatar_7.png",avatar_8:"#%n-avatar_8.png",avatar_1_ar:"#%n-avatar_1_ar.jpg",avatar_2_ar:"#%n-avatar_2_ar.jpg",avatar_3_ar:"#%n-avatar_3_ar.jpg",avatar_4_ar:"#%n-avatar_4_ar.jpg",avatar_5_ar:"#%n-avatar_5_ar.jpg",avatar_6_ar:"#%n-avatar_6_ar.jpg",avatar_7_ar:"#%n-avatar_7_ar.jpg",avatar_8_ar:"#%n-avatar_8_ar.jpg",avatar_1_it:"#%n-avatar_1_it.jpg",avatar_2_it:"#%n-avatar_2_it.png",avatar_3_it:"#%n-avatar_3_it.jpg",avatar_4_it:"#%n-avatar_4_it.jpg",avatar_5_it:"#%n-avatar_5_it.jpg",avatar_6_it:"#%n-avatar_6_it.jpg",avatar_7_it:"#%n-avatar_7_it.jpg",avatar_8_it:"#%n-avatar_8_it.png",avatar_1_ja:"#%n-avatar_1_ja.png",avatar_2_ja:"#%n-avatar_2_ja.png",avatar_3_ja:"#%n-avatar_3_ja.png",avatar_4_ja:"#%n-avatar_4_ja.png",avatar_5_ja:"#%n-avatar_5_ja.png",avatar_6_ja:"#%n-avatar_6_ja.png",
avatar_7_ja:"#%n-avatar_7_ja.png",avatar_8_ja:"#%n-avatar_8_ja.png",avatar_1_ko:"#%n-avatar_1_ko.jpg",avatar_2_ko:"#%n-avatar_2_ko.jpg",avatar_3_ko:"#%n-avatar_3_ko.jpg",avatar_4_ko:"#%n-avatar_4_ko.jpg",avatar_5_ko:"#%n-avatar_5_ko.jpg",avatar_6_ko:"#%n-avatar_6_ko.jpg",avatar_7_ko:"#%n-avatar_7_ko.jpg",avatar_8_ko:"#%n-avatar_8_ko.jpg",avatar_1_tr:"#%n-avatar_1_tr.jpg",avatar_2_tr:"#%n-avatar_2_tr.jpg",avatar_3_tr:"#%n-avatar_3_tr.jpg",avatar_4_tr:"#%n-avatar_4_tr.jpg",avatar_5_tr:"#%n-avatar_5_tr.jpg",avatar_6_tr:"#%n-avatar_6_tr.jpg",avatar_7_tr:"#%n-avatar_7_tr.jpg",avatar_8_tr:"#%n-avatar_8_tr.jpg",avatar_1_zh:"#%n-avatar_1_zh.jpg",avatar_2_zh:"#%n-avatar_2_zh.jpg",avatar_3_zh:"#%n-avatar_3_zh.png",avatar_4_zh:"#%n-avatar_4_zh.jpg",avatar_5_zh:"#%n-avatar_5_zh.jpg",avatar_6_zh:"#%n-avatar_6_zh.jpg",avatar_7_zh:"#%n-avatar_7_zh.jpg",avatar_8_zh:"#%n-avatar_8_zh.jpg",line_png:"#%n-line.png"},debug:!0,targets:["web"]},select_friend_window:{urls:{},injectTo:["main"],frameIds:[],
jsonIds:[],soundIds:[],unpackedIds:[]},shared:{urls:{},injectTo:["game","main"],frameIds:["adicon_png"],jsonIds:[],soundIds:[],unpackedIds:[]},shine:{urls:{},injectTo:["game"],frameIds:[],jsonIds:["%n_animation_json"],soundIds:[],unpackedIds:[]},shop_user_gold_view:{urls:{png:"@%n-7f74e3051e.png",json:"@%n-49590da71d.json"},jsons:{plist:"@%n-7f74e3051e.plist"},frames:{gold_small_png:"#%n-reward_icons-ruby_small.png",reward_gold_png:"#%n-reward_icons-ruby.png",reward_coin_png:"#%n-reward_icons-coin.png",reward_exp_png:"#%n-reward_icons-exp.png",reward_wand_png:"#%n-reward_icons-wand.png",reward_worker_png:"#%n-reward_icons-worker.png",reward_energy_png:"#%n-reward_icons-energy.png",shop_energy_png:"#%n-reward_icons-energy_shop.png",shop_gold_png:"#%n-reward_icons-ruby_shop.png",shop_coin_png:"#%n-reward_icons-coin_shop.png",nostroke62pt_0:"#%n-marvin-round-nostroke-62pt-0.png",nostroke62pt_1:"#%n-marvin-round-nostroke-62pt-1.png",nostroke62pt_2:"#%n-marvin-round-nostroke-62pt-2.png",
nostroke62pt_3:"#%n-marvin-round-nostroke-62pt-3.png",nostroke62pt_4:"#%n-marvin-round-nostroke-62pt-4.png",nostroke62pt_5:"#%n-marvin-round-nostroke-62pt-5.png",nostroke62pt_6:"#%n-marvin-round-nostroke-62pt-6.png",nostroke62pt_7:"#%n-marvin-round-nostroke-62pt-7.png",nostroke62pt_8:"#%n-marvin-round-nostroke-62pt-8.png",nostroke62pt_9:"#%n-marvin-round-nostroke-62pt-9.png",nostroke62pt_colon:"#%n-marvin-round-nostroke-62pt-colon.png",nostroke62pt_slash:"#%n-marvin-round-nostroke-62pt-slash.png",nostroke62pt_plus:"#%n-marvin-round-nostroke-62pt-plus.png",nostroke62pt_minus:"#%n-marvin-round-nostroke-62pt-minus.png",nostroke62pt_x:"#%n-marvin-round-nostroke-62pt-x.png",nostroke62pt_space:"#%n-marvin-round-nostroke-62pt-space.png",default45pt_0:"#%n-marvin-round-45pt-0.png",default45pt_1:"#%n-marvin-round-45pt-1.png",default45pt_2:"#%n-marvin-round-45pt-2.png",default45pt_3:"#%n-marvin-round-45pt-3.png",default45pt_4:"#%n-marvin-round-45pt-4.png",
default45pt_5:"#%n-marvin-round-45pt-5.png",default45pt_6:"#%n-marvin-round-45pt-6.png",default45pt_7:"#%n-marvin-round-45pt-7.png",default45pt_8:"#%n-marvin-round-45pt-8.png",default45pt_9:"#%n-marvin-round-45pt-9.png",default45pt_colon:"#%n-marvin-round-45pt-colon.png",default45pt_slash:"#%n-marvin-round-45pt-slash.png",default45pt_plus:"#%n-marvin-round-45pt-plus.png",default45pt_minus:"#%n-marvin-round-45pt-minus.png",default45pt_x:"#%n-marvin-round-45pt-x.png",default45pt_space:"#%n-marvin-round-45pt-space.png",default62pt_0:"#%n-marvin-round-62pt-0.png",default62pt_1:"#%n-marvin-round-62pt-1.png",default62pt_2:"#%n-marvin-round-62pt-2.png",default62pt_3:"#%n-marvin-round-62pt-3.png",default62pt_4:"#%n-marvin-round-62pt-4.png",default62pt_5:"#%n-marvin-round-62pt-5.png",default62pt_6:"#%n-marvin-round-62pt-6.png",default62pt_7:"#%n-marvin-round-62pt-7.png",default62pt_8:"#%n-marvin-round-62pt-8.png",default62pt_9:"#%n-marvin-round-62pt-9.png",
default62pt_colon:"#%n-marvin-round-62pt-colon.png",default62pt_slash:"#%n-marvin-round-62pt-slash.png",default62pt_plus:"#%n-marvin-round-62pt-plus.png",default62pt_minus:"#%n-marvin-round-62pt-minus.png",default62pt_x:"#%n-marvin-round-62pt-x.png",default62pt_space:"#%n-marvin-round-62pt-space.png",default76pt_0:"#%n-marvin-round-76pt-0.png",default76pt_1:"#%n-marvin-round-76pt-1.png",default76pt_2:"#%n-marvin-round-76pt-2.png",default76pt_3:"#%n-marvin-round-76pt-3.png",default76pt_4:"#%n-marvin-round-76pt-4.png",default76pt_5:"#%n-marvin-round-76pt-5.png",default76pt_6:"#%n-marvin-round-76pt-6.png",default76pt_7:"#%n-marvin-round-76pt-7.png",default76pt_8:"#%n-marvin-round-76pt-8.png",default76pt_9:"#%n-marvin-round-76pt-9.png",default76pt_colon:"#%n-marvin-round-76pt-colon.png",default76pt_slash:"#%n-marvin-round-76pt-slash.png",default76pt_plus:"#%n-marvin-round-76pt-plus.png",default76pt_minus:"#%n-marvin-round-76pt-minus.png",default76pt_x:"#%n-marvin-round-76pt-x.png",
default76pt_space:"#%n-marvin-round-76pt-space.png"}},sidebar:{urls:{},injectTo:["game","main"],frameIds:["icon_bg","lock","attention_png","icon_text_bg","caption_bg"],jsonIds:["pack_icon_json","pack1_icon_json","pack2_icon_json","energy_feast_icon_json","battlepass_icon_json","orders_json","units_shop_json","units_library_json"],soundIds:[],unpackedIds:[]},simple:{urls:{}},slot_machine:{urls:{}},sounds:{urls:{}},speedup:{urls:{},injectTo:["main"],frameIds:["timer_substrate","timer_icon"],jsonIds:[],soundIds:[],unpackedIds:[]},starchest_window:{urls:{}},starter_pack:{urls:{starter_pack_effect:"~sounds/%n-fedcb853ee.mp3",png:"@%n-b2c0b06d0b.png",json:"@%n-d1182eb3e4.json"},jsons:{pack_json:"@jsons/%n-f2985a0f7d.json",atlas:"@%n-b2c0b06d0b.atlas"}},store_links:{urls:{amazon_png:"@amazon-fff217ce99.png",ios_png:"@appstore-7ca2da36e4.png",android_png:"@googleplay-d959d72ee5.png"}},stuck_window:{urls:{}},subscription_window:{urls:{}},temp_good_finish_window:{urls:{}},tile_shop:{urls:{
badge_appear_effect:"~sounds/badge_appear-7102ce72e2.mp3",png:"@%n-e2723a08c2.png",json:"@%n-3c96dfee1c.json"},jsons:{shop_sparkles_small_json:"@jsons/shop_sparkles_small-11e96d2c9e.json",shop_sparkles_large_json:"@jsons/shop_sparkles_large-cba75331e0.json",plist:"@%n-e2723a08c2.plist",atlas:"@%n-e2723a08c2.atlas"},frames:{shop_tile_bg_png:"#%n-shop_bg_white.png",feature_tile_bg_png:"#%n-shop_bg_best.png",feature_button_png:"#%n-feature_tile_button.png",feature_button_on_png:"#%n-feature_tile_button_on.png",shop_badge_bestseller_png:"#%n-shop_best_seller.png",tile_stripe_png:"#%n-shop_red_ribbon.png",tile_best_stripe_png:"#%n-shop_red_ribbon_best.png",askLives_png:"#%n-life_friends.png",red_stripe_png:"#%n-shop_purple_ribbon.png",unlimitedLives_png:"#%n-energy_for_video.png",shop_gold1_png:"#%n-shop_coins_500.png",shop_gold2_png:"#%n-shop_coins_500.png",shop_gold3_png:"#%n-shop_coins_1800.png",heap_gold_png:"#%n-shop_coins_3800.png",shop_gold4_png:"#%n-shop_coins_6000.png",
shop_gold5_png:"#%n-shop_coins_25000.png",small_shop_button:"#%n-small_shop_button.png",small_shop_button_on:"#%n-small_shop_button_on.png",ok_icon_png:"#%n-socialicons-ok_icon.png",shop_discount_png:"#%n-shop_sale_ribbon.png",shop_discount_png_off:"#%n-shop_sale_ribbon_off.png",tile_best_stripe_png_off:"#%n-shop_red_ribbon_best_off.png",energy_for_coins_png:"#%n-energy_for_coins.png",energy_for_coins_png_off:"#%n-energy_for_coins_off.png",energy_for_video_png:"#%n-energy_for_video.png",energy_for_video_png_off:"#%n-energy_for_video_off.png",energy_lottery_png:"#%n-energy_lottery.png",energy_lottery_png_off:"#%n-energy_lottery_off.png",soft_currency_small_png:"#%n-soft_currency_small.png",soft_currency_medium_png:"#%n-soft_currency_medium.png",soft_currency_large_png:"#%n-soft_currency_large.png",feature_button_off_png:"#%n-shop_button_off.png",small_shop_button_off:"#%n-shop_button_off.png",shop_timer_icon_png:"#%n-infoview-game_ui_clock.png",
gold_small_png:"#%n-reward_icons-ruby_small.png",reward_gold_png:"#%n-reward_icons-ruby.png",reward_coin_png:"#%n-reward_icons-coin.png",reward_exp_png:"#%n-reward_icons-exp.png",reward_wand_png:"#%n-reward_icons-wand.png",reward_worker_png:"#%n-reward_icons-worker.png",reward_energy_png:"#%n-reward_icons-energy.png",shop_energy_png:"#%n-reward_icons-energy_shop.png",shop_gold_png:"#%n-reward_icons-ruby_shop.png",shop_coin_png:"#%n-reward_icons-coin_shop.png",nostroke62pt_0:"#%n-marvin-round-nostroke-62pt-0.png",nostroke62pt_1:"#%n-marvin-round-nostroke-62pt-1.png",nostroke62pt_2:"#%n-marvin-round-nostroke-62pt-2.png",nostroke62pt_3:"#%n-marvin-round-nostroke-62pt-3.png",nostroke62pt_4:"#%n-marvin-round-nostroke-62pt-4.png",nostroke62pt_5:"#%n-marvin-round-nostroke-62pt-5.png",nostroke62pt_6:"#%n-marvin-round-nostroke-62pt-6.png",nostroke62pt_7:"#%n-marvin-round-nostroke-62pt-7.png",nostroke62pt_8:"#%n-marvin-round-nostroke-62pt-8.png",
nostroke62pt_9:"#%n-marvin-round-nostroke-62pt-9.png",nostroke62pt_colon:"#%n-marvin-round-nostroke-62pt-colon.png",nostroke62pt_slash:"#%n-marvin-round-nostroke-62pt-slash.png",nostroke62pt_plus:"#%n-marvin-round-nostroke-62pt-plus.png",nostroke62pt_minus:"#%n-marvin-round-nostroke-62pt-minus.png",nostroke62pt_x:"#%n-marvin-round-nostroke-62pt-x.png",nostroke62pt_space:"#%n-marvin-round-nostroke-62pt-space.png",default45pt_0:"#%n-marvin-round-45pt-0.png",default45pt_1:"#%n-marvin-round-45pt-1.png",default45pt_2:"#%n-marvin-round-45pt-2.png",default45pt_3:"#%n-marvin-round-45pt-3.png",default45pt_4:"#%n-marvin-round-45pt-4.png",default45pt_5:"#%n-marvin-round-45pt-5.png",default45pt_6:"#%n-marvin-round-45pt-6.png",default45pt_7:"#%n-marvin-round-45pt-7.png",default45pt_8:"#%n-marvin-round-45pt-8.png",default45pt_9:"#%n-marvin-round-45pt-9.png",default45pt_colon:"#%n-marvin-round-45pt-colon.png",default45pt_slash:"#%n-marvin-round-45pt-slash.png",
default45pt_plus:"#%n-marvin-round-45pt-plus.png",default45pt_minus:"#%n-marvin-round-45pt-minus.png",default45pt_x:"#%n-marvin-round-45pt-x.png",default45pt_space:"#%n-marvin-round-45pt-space.png",default62pt_0:"#%n-marvin-round-62pt-0.png",default62pt_1:"#%n-marvin-round-62pt-1.png",default62pt_2:"#%n-marvin-round-62pt-2.png",default62pt_3:"#%n-marvin-round-62pt-3.png",default62pt_4:"#%n-marvin-round-62pt-4.png",default62pt_5:"#%n-marvin-round-62pt-5.png",default62pt_6:"#%n-marvin-round-62pt-6.png",default62pt_7:"#%n-marvin-round-62pt-7.png",default62pt_8:"#%n-marvin-round-62pt-8.png",default62pt_9:"#%n-marvin-round-62pt-9.png",default62pt_colon:"#%n-marvin-round-62pt-colon.png",default62pt_slash:"#%n-marvin-round-62pt-slash.png",default62pt_plus:"#%n-marvin-round-62pt-plus.png",default62pt_minus:"#%n-marvin-round-62pt-minus.png",default62pt_x:"#%n-marvin-round-62pt-x.png",default62pt_space:"#%n-marvin-round-62pt-space.png",default76pt_0:"#%n-marvin-round-76pt-0.png",
default76pt_1:"#%n-marvin-round-76pt-1.png",default76pt_2:"#%n-marvin-round-76pt-2.png",default76pt_3:"#%n-marvin-round-76pt-3.png",default76pt_4:"#%n-marvin-round-76pt-4.png",default76pt_5:"#%n-marvin-round-76pt-5.png",default76pt_6:"#%n-marvin-round-76pt-6.png",default76pt_7:"#%n-marvin-round-76pt-7.png",default76pt_8:"#%n-marvin-round-76pt-8.png",default76pt_9:"#%n-marvin-round-76pt-9.png",default76pt_colon:"#%n-marvin-round-76pt-colon.png",default76pt_slash:"#%n-marvin-round-76pt-slash.png",default76pt_plus:"#%n-marvin-round-76pt-plus.png",default76pt_minus:"#%n-marvin-round-76pt-minus.png",default76pt_x:"#%n-marvin-round-76pt-x.png",default76pt_space:"#%n-marvin-round-76pt-space.png"}},tiles:{urls:{},injectTo:["game"],frameIds:["green_ground_1","green_ground_2","grow12_right","grow12_left","grow12_corner","grow12_both","level1_up_corner","level1_down_corner","level1_left_corner","level1_right_corner","level2_up_corner","level1_up_both","level1_up_right_only",
"level1_up_right_only_last","level1_up_left_only","level1_up_left_only_last","level2_up_both","level2_up_right_only","level2_up_right_only_last","level2_up_left_only","level2_up_left_only_last","level1_down_both","level1_down_right_only","level1_down_left_only","level1_left_inner","level1_left_inner_last","level1_right_inner","level1_right_inner_last","level2_left_inner","level2_left_inner_last","level2_right_inner","level2_right_inner_last","water"],jsonIds:[],soundIds:[],unpackedIds:[]},toolbar:{urls:{},injectTo:["main"],frameIds:["%n_attention_icon_png"],jsonIds:[],soundIds:[],unpackedIds:[]},tooltip:{urls:{},injectTo:["main"],frameIds:["%n_bg_png","%n_shadow_arrow_png","%n_arrow_png"],jsonIds:[],soundIds:[],unpackedIds:[]},transition:{urls:{},injectTo:["main"],frameIds:[],jsonIds:["%n_json"],soundIds:[],unpackedIds:[]},treasuresearch:{urls:{}},tulpan_tournament:{urls:{}},unit_apple:{urls:{},injectTo:["game"],frameIds:["%n1","%n2","%n3","%n4","%n5","%n6"],jsonIds:[],soundIds:[],
unpackedIds:[]},unit_bamboo:{urls:{},injectTo:["game"],frameIds:["%n1","%n2","%n3","%n4","%n5","%n6","%n7","%n8","%n9"],jsonIds:["%n10","%n11"],soundIds:[],unpackedIds:[]},unit_bamboochest:{urls:{},injectTo:["game"],frameIds:["%n1","%n2","%n3"],jsonIds:[],soundIds:[],unpackedIds:[]},unit_bamboogenerator:{urls:{},injectTo:["game"],frameIds:[],jsonIds:["%n1","%n2","%n3"],soundIds:[],unpackedIds:[]},unit_bamboosource:{urls:{},injectTo:["game"],frameIds:["%n1","%n2","%n3","%n4","%n5","%n6"],jsonIds:[],soundIds:[],unpackedIds:[]},unit_bear:{urls:{},injectTo:["game"],frameIds:["%n1","%n2","%n3","%n4","%n5","%n6"],jsonIds:["%n7"],soundIds:[],unpackedIds:[]},unit_candies:{urls:{},injectTo:["game"],frameIds:["%n1","%n2","%n3","%n4","%n5","%n6"],jsonIds:[],soundIds:[],unpackedIds:[]},unit_coins:{urls:{},injectTo:["game"],frameIds:["%n1","%n2","%n3","%n4","%n5","%n6","%n7","%n8"],jsonIds:[],soundIds:[],unpackedIds:[]},unit_corn:{urls:{},injectTo:["game"],frameIds:["%n1","%n2","%n3","%n4","%n5",
"%n6"],jsonIds:[],soundIds:[],unpackedIds:[]},unit_crystal:{urls:{},injectTo:["game"],frameIds:["%n1","%n2","%n3","%n4"],jsonIds:[],soundIds:[],unpackedIds:[]},unit_decorator:{urls:{},injectTo:["game"],frameIds:["%n1"],jsonIds:[],soundIds:[],unpackedIds:[]},unit_dishes:{urls:{},injectTo:["game"],frameIds:["%n1","%n2","%n3","%n4","%n5","%n6","%n7","%n8","%n9","%n10","%n11","%n12","%n13","%n14","%n15","%n16","%n17","%n18","%n19","%n20"],jsonIds:[],soundIds:[],unpackedIds:[]},unit_dragonmine:{urls:{},injectTo:["game"],frameIds:["%n1"],jsonIds:[],soundIds:[],unpackedIds:[]},unit_dwarf:{urls:{},injectTo:["game"],frameIds:["%n1"],jsonIds:["%n2"],soundIds:[],unpackedIds:[]},unit_elf:{urls:{},injectTo:["game"],frameIds:["%n1","%n2","%n3","%n4","%n5","%n6","%n7"],jsonIds:["%n8"],soundIds:[],unpackedIds:[]},unit_freechest:{urls:{},injectTo:["game"],frameIds:["%n1"],jsonIds:[],soundIds:[],unpackedIds:[]},unit_herochest:{urls:{},injectTo:["game"],frameIds:["%n1"],jsonIds:[],soundIds:[],
unpackedIds:[]},unit_heroes:{urls:{},injectTo:["game"],frameIds:[],jsonIds:[],soundIds:[],unpackedIds:[]},unit_icons:{urls:{},injectTo:["game"],frameIds:["small_icon_dwarf","small_icon_king","small_icon_bear","small_icon_elf","small_icon_warlock","small_icon_troll","fog_icon_png"],jsonIds:[],soundIds:[],unpackedIds:[]},unit_iron:{urls:{},injectTo:["game"],frameIds:["%n1","%n2","%n3","%n4","%n5","%n6","%n7","%n8","%n9","%n10"],jsonIds:[],soundIds:[],unpackedIds:[]},unit_king:{urls:{},injectTo:["game"],frameIds:["%n1","%n2","%n3"],jsonIds:["%n4"],soundIds:[],unpackedIds:[]},unit_knight:{urls:{},injectTo:["game"],frameIds:[],jsonIds:[],soundIds:[],unpackedIds:[]},unit_magicplant:{urls:{},injectTo:["game"],frameIds:["%n1","%n2","%n3","%n4","%n5","%n6","%n7","%n8","%n9"],jsonIds:[],soundIds:[],unpackedIds:[]},unit_mushrooms:{urls:{},injectTo:["game"],frameIds:["%n1","%n2","%n3","%n4","%n5","%n6"],jsonIds:[],soundIds:[],unpackedIds:[]},unit_rubies:{urls:{},injectTo:["game"],frameIds:["%n1",
"%n2","%n3","%n4","%n5","%n6"],jsonIds:[],soundIds:[],unpackedIds:[]},unit_rubiesplant:{urls:{},injectTo:["game"],frameIds:["%n1","%n2","%n3"],jsonIds:[],soundIds:[],unpackedIds:[]},unit_sacks:{urls:{},injectTo:["game"],frameIds:["%n1","%n2","%n3"],jsonIds:[],soundIds:[],unpackedIds:[]},unit_sapphire:{urls:{},injectTo:["game"],frameIds:["%n1","%n2","%n3","%n4","%n5","%n6","%n7","%n8","%n9","%n10"],jsonIds:["%n11","%n12"],soundIds:[],unpackedIds:[]},unit_sapphirechest:{urls:{},injectTo:["game"],frameIds:["%n1","%n2","%n3"],jsonIds:[],soundIds:[],unpackedIds:[]},unit_sapphiregenerator:{urls:{},injectTo:["game"],frameIds:[],jsonIds:["%n1","%n2","%n3"],soundIds:[],unpackedIds:[]},unit_sapphiresource:{urls:{},injectTo:["game"],frameIds:["%n1","%n2","%n3","%n4","%n5","%n6"],jsonIds:[],soundIds:[],unpackedIds:[]},unit_specialoffer:{urls:{},injectTo:["game"],frameIds:[],jsonIds:["%n1"],soundIds:[],unpackedIds:[]},unit_stone:{urls:{},injectTo:["game"],frameIds:["%n1","%n2","%n3","%n4","%n5",
"%n6","%n7","%n8","%n9"],jsonIds:["%n10","%n11"],soundIds:[],unpackedIds:[]},unit_stonechest:{urls:{},injectTo:["game"],frameIds:["%n1","%n2","%n3"],jsonIds:[],soundIds:[],unpackedIds:[]},unit_stonegenerator:{urls:{},injectTo:["game"],frameIds:[],jsonIds:["%n1","%n2","%n3"],soundIds:[],unpackedIds:[]},unit_stonesource:{urls:{},injectTo:["game"],frameIds:["%n1","%n2","%n3","%n4","%n5","%n6"],jsonIds:[],soundIds:[],unpackedIds:[]},unit_strawberry:{urls:{},injectTo:["game"],frameIds:["%n1","%n2","%n3","%n4","%n5","%n6"],jsonIds:[],soundIds:[],unpackedIds:[]},unit_treasure:{urls:{},injectTo:["game"],frameIds:["%n1","%n2","%n3"],jsonIds:[],soundIds:[],unpackedIds:[]},unit_troll:{urls:{},injectTo:["game"],frameIds:["%n1","%n2","%n3","%n4","%n5","%n6","%n7","%n8","%n9"],jsonIds:["%n10"],soundIds:[],unpackedIds:[]},unit_wagon:{urls:{},injectTo:["game"],frameIds:["%n1","%n2","%n3","%n4","%n5","%n6","%n7","%n8","%n9"],jsonIds:["%n10","%n11"],soundIds:[],unpackedIds:[]},unit_wagonchest:{urls:{},
injectTo:["game"],frameIds:["%n1","%n2","%n3"],jsonIds:[],soundIds:[],unpackedIds:[]},unit_wagongenerator:{urls:{},injectTo:["game"],frameIds:[],jsonIds:["%n1","%n2","%n3"],soundIds:[],unpackedIds:[]},unit_wagonsource:{urls:{},injectTo:["game"],frameIds:["%n1","%n2","%n3","%n4","%n5","%n6"],jsonIds:[],soundIds:[],unpackedIds:[]},unit_wands:{urls:{},injectTo:["game"],frameIds:[],jsonIds:["%n1","%n2","%n3","%n4","%n5","%n6"],soundIds:[],unpackedIds:[]},unit_warlock:{urls:{},injectTo:["game"],frameIds:["%n1","%n2","%n3","%n4","%n5","%n6","%n7","%n8"],jsonIds:["%n9"],soundIds:[],unpackedIds:[]},unit_wheat:{urls:{},injectTo:["game"],frameIds:["%n1","%n2","%n3","%n4","%n5","%n6"],jsonIds:[],soundIds:[],unpackedIds:[]},unit_wood:{urls:{},injectTo:["game"],frameIds:["%n1","%n2","%n3","%n4","%n5","%n6","%n7","%n8"],jsonIds:["%n9","%n10"],soundIds:[],unpackedIds:[]},unit_woodchest:{urls:{},injectTo:["game"],frameIds:["%n1","%n2","%n3"],jsonIds:[],soundIds:[],unpackedIds:[]},unit_woodgenerator:{
urls:{},injectTo:["game"],frameIds:[],jsonIds:["%n1","%n2","%n3"],soundIds:[],unpackedIds:[]},unit_woodsource:{urls:{},injectTo:["game"],frameIds:["%n1","%n2","%n3","%n4","%n5","%n6"],jsonIds:[],soundIds:[],unpackedIds:[]},unit_worker:{urls:{},injectTo:["game"],frameIds:["%n1","%n2","%n3","%n4"],jsonIds:["%n5"],soundIds:[],unpackedIds:[]},unitoncell:{urls:{},injectTo:["game"],frameIds:[],jsonIds:["prize_shining_json"],soundIds:[],unpackedIds:[]},units_shop:{urls:{png:"@%n-47114eaf2e.png",json:"@%n-7715aa2a54.json"},jsons:{plist:"@%n-47114eaf2e.plist"},frames:{bg_png:"#%n-market-market_bg.png",lock_png:"#%n-market-market_lock.png",title_png:"#%n-market-market_title.png",cart_top_png:"#%n-market-market_cart.png",cart_bottom_png:"#%n-market-market_cart_bg.png",amount_bg_png:"#%n-tile_shop-shop_red_ribbon_best.png"}},unitslibrarywindow:{urls:{},injectTo:["main"],frameIds:["ow_tab_header_on","ow_scroll_background","ow_details_background","icon_unknown","icon_dwarf","icon_king","icon_bear",
"icon_elf","icon_warlock","icon_troll","horizontal_scroll_foreground"],jsonIds:[],soundIds:[],unpackedIds:[]},valentines:{urls:{}},victorywindow:{urls:{png:"@%n-8716db0f85.png",json:"@%n-d94f2578fe.json"},jsons:{plist:"@%n-8716db0f85.plist"},frames:{level_victory_reward_bg:"#%n-victory-reward_bg.png"}},video_ads:{urls:{emergence_box_effect:"~sounds/emergence_box-000db587ce.mp3",jump_box_effect:"~sounds/jump_box-76742f55f5.mp3",win_effect:"~sounds/win_1-99e673e0cb.mp3",logo_effect:"~sounds/logo_effect_4-220f73d8be.mp3",arrow_fly_effect:"~sounds/arrow_fly-be6bf2d76c.mp3",arrow_hit_effect:"~sounds/arrow_hit-2b34ddaf2d.mp3",valentine_victory_effect:"~sounds/valentine_win-73991e88ae.mp3",png:"@%n-acd567e127.png",json:"@%n-986e1d1c8c.json"},jsons:{boosters_sale_prize_json:"@jsons/boosters_sale_prize-d310b6263f.json",transition_clouds_json:"@jsons/transition-e808d9814b.json",atlas:"@%n-acd567e127.atlas"},debug:!0,targets:["web"]},video_ads_first_trial:{urls:{
background_music:"~sounds/ads_music-07091e761d.mp3"},debug:!0,targets:["web"]},wardrobe_window:{urls:{}},windows:{urls:{},injectTo:["main"],frameIds:["window_bg_png","tab_attention","tab_icon_specials","tab_icon_orders","tab_icon_recipes","tab_icon_ingredients","tab_icon_chest","tab_icon_fruit","tab_icon_heroes","tab_icon_resource","tab_icon_source","tab_icon_valuable","window_title_background","window_foreground_png","window_close_png","window_close_on_png"],jsonIds:[],soundIds:[],unpackedIds:[]},world_map:{urls:{}},wysiwyg:{urls:{strict_font_ttf:{type:"font",name:"Rubic",srcs:["~%n/all/font.ttf","~%n/all/font.eot"]},png:"@%n-938bb3d152.png",json:"@%n-a11d35accd.json"},jsons:{plist:"@%n-938bb3d152.plist"},frames:{component:"#%n-component.png",component_frame:"#%n-component_frame.png",attach_frame:"#%n-attach_frame.png",window_bg:"#%n-window_bg.png",plus:"#%n-plus.png",back:"#%n-back.png",delete:"#%n-delete.png",copy:"#%n-copy.png",move_up:"#%n-move_up.png",
move_down:"#%n-move_down.png",paste:"#%n-paste.png",button_on:"#%n-button_on.png",button_off:"#%n-button_off.png",dropdown:"#%n-dropdown.png",loading:"#%n-admin-loading.png",scenario_item:"#%n-scenario_item.png",clip_item:"#%n-clip_item.png",preview_frame:"#%n-preview_frame.png",preview_control:"#%n-preview_control.png",component_item:"#%n-component_item.png",directory_item:"#%n-directory_item.png",component_item_hidden:"#%n-component_item_hidden.png",sound_icon:"#%n-sound_icon.png",emulator:"#%n-iphone.png",fullscreen_icon:"#%n-fullscreen_icon.png",iphone_icon:"#%n-iphone_icon.png",video_icon:"#%n-video_icon.png",adsgame:"#%n-components-adsgame.png",adsage:"#%n-components-adsage.png",adshand:"#%n-components-adshand.png",adslogo:"#%n-components-adslogo.png",adsplay:"#%n-components-adsplay.png",adspuzzle15:"#%n-components-adspuzzle15.png",adsscale:"#%n-components-adsscale.png",adsprogressbar:"#%n-components-adsprogressbar.png",adsspine:"#%n-components-adsspine.png",
adstree:"#%n-components-adstree.png",adssprite:"#%n-components-adssprite.png",adstable:"#%n-components-adstable.png",adskeypad:"#%n-components-adskeypad.png",adswordslist:"#%n-components-adswordslist.png",adswordsresult:"#%n-components-adswordsresult.png",adstext:"#%n-components-adstext.png",adssound:"#%n-components-adssound.png",adstransition:"#%n-components-adstransition.png",adsfireworks:"#%n-components-adsfireworks.png",adsexclamations:"#%n-components-adsexclamations.png",adsmenu:"#%n-components-adsmenu.png",adshint:"#%n-components-adshint.png",adscounter:"#%n-components-adscounter.png",adsmap2d:"#%n-components-adsmap2d.png",adsfield:"#%n-components-adsfield.png",adsinfopanel:"#%n-components-adsinfopanel.png",adssidebar:"#%n-components-adssidebar.png",adsmenubar:"#%n-components-adsmenubar.png",adscontrolspanel:"#%n-components-adscontrolspanel.png",adsenergyfeast:"#%n-components-adsenergyfeast.png",adsshadowlayer:"#%n-components-adsshadowlayer.png",
adscurrent:"#%n-components-adscurrent.png",adshintbooster:"#%n-components-adshintbooster.png",adsshuffle:"#%n-components-adsshuffle.png",adspixelsswarm:"#%n-components-adsbug.png",push_icon:"#%n-button_icons-admin_push.png",revert_icon:"#%n-button_icons-admin_rev.png",regular_button:"#%n-admin-regular_button.png",regular_button_on:"#%n-admin-regular_button_on.png",delete_button:"#%n-admin-delete_button.png",scroll_bg:"#%n-admin-selected_button.png",scroll_content_bg:"#%n-admin-level_frame_regular.png"}},xmas:{urls:{}}},buildConfig={resolutions:{highstaging:{scale:1,id:"highstaging",height:1334,options:{pngcrush:!1,depth:6}}},target:"web",env:"staging",buildDir:"publish/html5-staging",packLevels:0},resolutions=buildConfig.resolutions,unpackedBundles={admin:{"#%n-button_icons-%n_annotation.png":"cleverapps/res/admin/button_icons/admin_annotation.png","#%n-button_icons-%n_current.png":"cleverapps/res/admin/button_icons/admin_current.png",
"#%n-button_icons-%n_hot.png":"cleverapps/res/admin/button_icons/admin_hot.png","#%n-button_icons-%n_diff_icon.png":"cleverapps/res/admin/button_icons/admin_diff_icon.png","#%n-button_icons-%n_play.png":"cleverapps/res/admin/button_icons/admin_play.png","#%n-button_icons-%n_edit.png":"cleverapps/res/admin/button_icons/admin_edit.png","#%n-button_icons-%n_copy.png":"cleverapps/res/admin/button_icons/admin_copy.png","#%n-button_icons-%n_delete.png":"cleverapps/res/admin/button_icons/admin_delete.png","#%n-button_icons-%n_release.png":"cleverapps/res/admin/button_icons/admin_release.png","#%n-button_icons-%n_debug.png":"cleverapps/res/admin/button_icons/admin_debug.png","#%n-button_icons-%n_download.png":"cleverapps/res/admin/button_icons/admin_download.png","#%n-button_icons-%n_update.png":"cleverapps/res/admin/button_icons/admin_update.png","#%n-button_icons-%n_upload.png":"cleverapps/res/admin/button_icons/admin_upload.png",
"#%n-button_icons-%n_fbproduct.png":"cleverapps/res/admin/button_icons/admin_fbproduct.png","#%n-button_icons-left.png":"cleverapps/res/admin/button_icons/left.png","#%n-button_icons-right.png":"cleverapps/res/admin/button_icons/right.png","#%n-button_icons-left_double.png":"cleverapps/res/admin/button_icons/left_double.png","#%n-button_icons-right_double.png":"cleverapps/res/admin/button_icons/right_double.png","#%n-numbers.png":"cleverapps/res/admin/numbers.png","#%n-diffr_red.png":"cleverapps/res/admin/diffr_red.png","#%n-hard_level_pin.png":"cleverapps/res/admin/hard_level_pin.png","#%n-tricky_level_pin.png":"cleverapps/res/admin/tricky_level_pin.png","#%n-%n_yellow_flag.png":"cleverapps/res/admin/admin_yellow_flag.png","#%n-in_process.png":"cleverapps/res/admin/in_process.png","#%n-attention_icon.png":"cleverapps/res/admin/attention_icon.png","#%n-regular_button.png":"cleverapps/res/admin/regular_button.png","#%n-regular_button_on.png":"cleverapps/res/admin/regular_button_on.png",
"#%n-disabled_button.png":"cleverapps/res/admin/disabled_button.png","#%n-selected_button.png":"cleverapps/res/admin/selected_button.png","#%n-plus_button.png":"cleverapps/res/admin/plus_button.png","#%n-level_frame_regular.png":"cleverapps/res/admin/level_frame_regular.png","#%n-level_frame_selected.png":"cleverapps/res/admin/level_frame_selected.png","#%n-level_miniature_frame_regular.png":"cleverapps/res/admin/level_miniature_frame_regular.png","#%n-editor_yellow_substrate.png":"cleverapps/res/admin/editor_yellow_substrate.png","#%n-description_button.png":"cleverapps/res/admin/description_button.png","#%n-loading.png":"cleverapps/res/admin/loading.png","#%n-delete_button.png":"cleverapps/res/admin/delete_button.png","#%n-enlarge_button.png":"cleverapps/res/admin/enlarge_button.png","#%n-language_regular.png":"cleverapps/res/admin/language_regular.png","#%n-language_selected.png":"cleverapps/res/admin/language_selected.png",
"#%n-difficulty_bar.png":"cleverapps/res/admin/difficulty_bar.png","#%n-navigation_level_episode.png":"cleverapps/res/admin/navigation_level_episode.png","#%n-current_arrow.png":"cleverapps/res/admin/current_arrow.png","#%n-features-editor_bg.png":"cleverapps/res/admin/features/editor_bg.png","#%n-log_entry_separator.png":"cleverapps/res/admin/log_entry_separator.png","#%n-level_frame_add.png":"cleverapps/res/admin/level_frame_add.png","#%n-gun.png":"cleverapps/res/admin/gun.png","#%n-langs-%n_de.png":"cleverapps/res/admin/langs/admin_de.png","#%n-langs-%n_en.png":"cleverapps/res/admin/langs/admin_en.png","#%n-langs-%n_es.png":"cleverapps/res/admin/langs/admin_es.png","#%n-langs-%n_fr.png":"cleverapps/res/admin/langs/admin_fr.png","#%n-langs-%n_it.png":"cleverapps/res/admin/langs/admin_it.png","#%n-langs-%n_ja.png":"cleverapps/res/admin/langs/admin_ja.png","#%n-langs-%n_nl.png":"cleverapps/res/admin/langs/admin_nl.png","#%n-langs-%n_pt.png":"cleverapps/res/admin/langs/admin_pt.png",
"#%n-langs-%n_ru.png":"cleverapps/res/admin/langs/admin_ru.png","#%n-langs-%n_ko.png":"cleverapps/res/admin/langs/admin_ko.png","#%n-formal-21pt-0.png":"cleverapps/res/common/fonts/formal/21pt/0.png","#%n-formal-21pt-1.png":"cleverapps/res/common/fonts/formal/21pt/1.png","#%n-formal-21pt-2.png":"cleverapps/res/common/fonts/formal/21pt/2.png","#%n-formal-21pt-3.png":"cleverapps/res/common/fonts/formal/21pt/3.png","#%n-formal-21pt-4.png":"cleverapps/res/common/fonts/formal/21pt/4.png","#%n-formal-21pt-5.png":"cleverapps/res/common/fonts/formal/21pt/5.png","#%n-formal-21pt-6.png":"cleverapps/res/common/fonts/formal/21pt/6.png","#%n-formal-21pt-7.png":"cleverapps/res/common/fonts/formal/21pt/7.png","#%n-formal-21pt-8.png":"cleverapps/res/common/fonts/formal/21pt/8.png","#%n-formal-21pt-9.png":"cleverapps/res/common/fonts/formal/21pt/9.png","#%n-formal-21pt-colon.png":"cleverapps/res/common/fonts/formal/21pt/colon.png",
"#%n-formal-21pt-slash.png":"cleverapps/res/common/fonts/formal/21pt/slash.png","#%n-formal-21pt-plus.png":"cleverapps/res/common/fonts/formal/21pt/plus.png","#%n-formal-21pt-minus.png":"cleverapps/res/common/fonts/formal/21pt/minus.png","#%n-formal-21pt-x.png":"cleverapps/res/common/fonts/formal/21pt/x.png","#%n-formal-21pt-space.png":"cleverapps/res/common/fonts/formal/21pt/space.png","#%n-formal-21pt-point.png":"cleverapps/res/common/fonts/formal/21pt/point.png","#%n-formal-21pt-left_square_bracket.png":"cleverapps/res/common/fonts/formal/21pt/left_square_bracket.png","#%n-formal-21pt-right_square_bracket.png":"cleverapps/res/common/fonts/formal/21pt/right_square_bracket.png","#%n-reward_icons-ruby_small.png":"cleverapps/res/mergecraft/bundles/reward_icons/ruby_small.png","#%n-reward_icons-ruby.png":"cleverapps/res/mergecraft/bundles/reward_icons/ruby.png","#%n-reward_icons-coin.png":"cleverapps/res/mergecraft/bundles/reward_icons/coin.png",
"#%n-reward_icons-exp.png":"cleverapps/res/mergecraft/bundles/reward_icons/exp.png","#%n-reward_icons-wand.png":"cleverapps/res/mergecraft/bundles/reward_icons/wand.png","#%n-reward_icons-worker.png":"cleverapps/res/mergecraft/bundles/reward_icons/worker.png","#%n-reward_icons-energy.png":"cleverapps/res/mergecraft/bundles/reward_icons/energy.png","#%n-reward_icons-energy_shop.png":"cleverapps/res/mergecraft/bundles/reward_icons/energy_shop.png","#%n-reward_icons-ruby_shop.png":"cleverapps/res/mergecraft/bundles/reward_icons/ruby_shop.png","#%n-reward_icons-coin_shop.png":"cleverapps/res/mergecraft/bundles/reward_icons/coin_shop.png","#%n-button_icons-%n_push.png":"cleverapps/res/admin/button_icons/admin_push.png","#%n-button_icons-%n_rev.png":"cleverapps/res/admin/button_icons/admin_rev.png","#%n-marvin-round-nostroke-62pt-0.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/0.png",
"#%n-marvin-round-nostroke-62pt-1.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/1.png","#%n-marvin-round-nostroke-62pt-2.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/2.png","#%n-marvin-round-nostroke-62pt-3.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/3.png","#%n-marvin-round-nostroke-62pt-4.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/4.png","#%n-marvin-round-nostroke-62pt-5.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/5.png","#%n-marvin-round-nostroke-62pt-6.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/6.png","#%n-marvin-round-nostroke-62pt-7.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/7.png","#%n-marvin-round-nostroke-62pt-8.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/8.png","#%n-marvin-round-nostroke-62pt-9.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/9.png",
"#%n-marvin-round-nostroke-62pt-colon.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/colon.png","#%n-marvin-round-nostroke-62pt-slash.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/slash.png","#%n-marvin-round-nostroke-62pt-plus.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/plus.png","#%n-marvin-round-nostroke-62pt-minus.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/minus.png","#%n-marvin-round-nostroke-62pt-x.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/x.png","#%n-marvin-round-nostroke-62pt-space.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/space.png","#%n-marvin-round-45pt-0.png":"cleverapps/res/common/fonts/marvin-round/45pt/0.png","#%n-marvin-round-45pt-1.png":"cleverapps/res/common/fonts/marvin-round/45pt/1.png","#%n-marvin-round-45pt-2.png":"cleverapps/res/common/fonts/marvin-round/45pt/2.png","#%n-marvin-round-45pt-3.png":"cleverapps/res/common/fonts/marvin-round/45pt/3.png",
"#%n-marvin-round-45pt-4.png":"cleverapps/res/common/fonts/marvin-round/45pt/4.png","#%n-marvin-round-45pt-5.png":"cleverapps/res/common/fonts/marvin-round/45pt/5.png","#%n-marvin-round-45pt-6.png":"cleverapps/res/common/fonts/marvin-round/45pt/6.png","#%n-marvin-round-45pt-7.png":"cleverapps/res/common/fonts/marvin-round/45pt/7.png","#%n-marvin-round-45pt-8.png":"cleverapps/res/common/fonts/marvin-round/45pt/8.png","#%n-marvin-round-45pt-9.png":"cleverapps/res/common/fonts/marvin-round/45pt/9.png","#%n-marvin-round-45pt-colon.png":"cleverapps/res/common/fonts/marvin-round/45pt/colon.png","#%n-marvin-round-45pt-slash.png":"cleverapps/res/common/fonts/marvin-round/45pt/slash.png","#%n-marvin-round-45pt-plus.png":"cleverapps/res/common/fonts/marvin-round/45pt/plus.png","#%n-marvin-round-45pt-minus.png":"cleverapps/res/common/fonts/marvin-round/45pt/minus.png","#%n-marvin-round-45pt-x.png":"cleverapps/res/common/fonts/marvin-round/45pt/x.png",
"#%n-marvin-round-45pt-space.png":"cleverapps/res/common/fonts/marvin-round/45pt/space.png","#%n-marvin-round-62pt-0.png":"cleverapps/res/common/fonts/marvin-round/62pt/0.png","#%n-marvin-round-62pt-1.png":"cleverapps/res/common/fonts/marvin-round/62pt/1.png","#%n-marvin-round-62pt-2.png":"cleverapps/res/common/fonts/marvin-round/62pt/2.png","#%n-marvin-round-62pt-3.png":"cleverapps/res/common/fonts/marvin-round/62pt/3.png","#%n-marvin-round-62pt-4.png":"cleverapps/res/common/fonts/marvin-round/62pt/4.png","#%n-marvin-round-62pt-5.png":"cleverapps/res/common/fonts/marvin-round/62pt/5.png","#%n-marvin-round-62pt-6.png":"cleverapps/res/common/fonts/marvin-round/62pt/6.png","#%n-marvin-round-62pt-7.png":"cleverapps/res/common/fonts/marvin-round/62pt/7.png","#%n-marvin-round-62pt-8.png":"cleverapps/res/common/fonts/marvin-round/62pt/8.png","#%n-marvin-round-62pt-9.png":"cleverapps/res/common/fonts/marvin-round/62pt/9.png",
"#%n-marvin-round-62pt-colon.png":"cleverapps/res/common/fonts/marvin-round/62pt/colon.png","#%n-marvin-round-62pt-slash.png":"cleverapps/res/common/fonts/marvin-round/62pt/slash.png","#%n-marvin-round-62pt-plus.png":"cleverapps/res/common/fonts/marvin-round/62pt/plus.png","#%n-marvin-round-62pt-minus.png":"cleverapps/res/common/fonts/marvin-round/62pt/minus.png","#%n-marvin-round-62pt-x.png":"cleverapps/res/common/fonts/marvin-round/62pt/x.png","#%n-marvin-round-62pt-space.png":"cleverapps/res/common/fonts/marvin-round/62pt/space.png","#%n-marvin-round-76pt-0.png":"cleverapps/res/common/fonts/marvin-round/76pt/0.png","#%n-marvin-round-76pt-1.png":"cleverapps/res/common/fonts/marvin-round/76pt/1.png","#%n-marvin-round-76pt-2.png":"cleverapps/res/common/fonts/marvin-round/76pt/2.png","#%n-marvin-round-76pt-3.png":"cleverapps/res/common/fonts/marvin-round/76pt/3.png","#%n-marvin-round-76pt-4.png":"cleverapps/res/common/fonts/marvin-round/76pt/4.png",
"#%n-marvin-round-76pt-5.png":"cleverapps/res/common/fonts/marvin-round/76pt/5.png","#%n-marvin-round-76pt-6.png":"cleverapps/res/common/fonts/marvin-round/76pt/6.png","#%n-marvin-round-76pt-7.png":"cleverapps/res/common/fonts/marvin-round/76pt/7.png","#%n-marvin-round-76pt-8.png":"cleverapps/res/common/fonts/marvin-round/76pt/8.png","#%n-marvin-round-76pt-9.png":"cleverapps/res/common/fonts/marvin-round/76pt/9.png","#%n-marvin-round-76pt-colon.png":"cleverapps/res/common/fonts/marvin-round/76pt/colon.png","#%n-marvin-round-76pt-slash.png":"cleverapps/res/common/fonts/marvin-round/76pt/slash.png","#%n-marvin-round-76pt-plus.png":"cleverapps/res/common/fonts/marvin-round/76pt/plus.png","#%n-marvin-round-76pt-minus.png":"cleverapps/res/common/fonts/marvin-round/76pt/minus.png","#%n-marvin-round-76pt-x.png":"cleverapps/res/common/fonts/marvin-round/76pt/x.png","#%n-marvin-round-76pt-space.png":"cleverapps/res/common/fonts/marvin-round/76pt/space.png"},ads_background_music:{},
ads_backgrounds_ananas_background:{},ads_backgrounds_bg_1_xmas:{},ads_backgrounds_bg_2_xmas:{},ads_backgrounds_bg_3_xmas:{},ads_backgrounds_bg_4_xmas:{},ads_backgrounds_bg_5_xmas:{},ads_backgrounds_bg_6_xmas:{},ads_backgrounds_bg_armchair:{},ads_backgrounds_bg_autumm:{},ads_backgrounds_bg_barn:{},ads_backgrounds_bg_beach:{},ads_backgrounds_bg_blue_stripe:{},ads_backgrounds_bg_bluecar:{},ads_backgrounds_bg_cabin:{},ads_backgrounds_bg_castle:{},ads_backgrounds_bg_cemetery:{},ads_backgrounds_bg_cliff:{},ads_backgrounds_bg_coffee:{},ads_backgrounds_bg_daily_cup:{},ads_backgrounds_bg_dog:{},ads_backgrounds_bg_dog2:{},ads_backgrounds_bg_facegirl:{},ads_backgrounds_bg_field:{},ads_backgrounds_bg_flowers_cup:{},ads_backgrounds_bg_forest:{},ads_backgrounds_bg_fruit:{},ads_backgrounds_bg_giraffe:{},ads_backgrounds_bg_girl_mountains:{},ads_backgrounds_bg_greencar:{},ads_backgrounds_bg_halloween2:{},ads_backgrounds_bg_island:{},ads_backgrounds_bg_kids_forest:{},ads_backgrounds_bg_kitchen:{},
ads_backgrounds_bg_korea:{},ads_backgrounds_bg_laptop:{},ads_backgrounds_bg_lighthouse:{},ads_backgrounds_bg_lowpixel:{},ads_backgrounds_bg_meadow:{},ads_backgrounds_bg_merge1:{},ads_backgrounds_bg_merge10:{},ads_backgrounds_bg_merge11:{},ads_backgrounds_bg_merge12:{},ads_backgrounds_bg_merge13:{},ads_backgrounds_bg_merge2:{},ads_backgrounds_bg_merge3:{},ads_backgrounds_bg_merge4:{},ads_backgrounds_bg_merge5:{},ads_backgrounds_bg_merge6:{},ads_backgrounds_bg_merge7:{},ads_backgrounds_bg_merge8:{},ads_backgrounds_bg_merge9:{},ads_backgrounds_bg_merge_hd1:{},ads_backgrounds_bg_merge_hd10:{},ads_backgrounds_bg_merge_hd11:{},ads_backgrounds_bg_merge_hd12:{},ads_backgrounds_bg_merge_hd13:{},ads_backgrounds_bg_merge_hd14:{},ads_backgrounds_bg_merge_hd2:{},ads_backgrounds_bg_merge_hd3:{},ads_backgrounds_bg_merge_hd4:{},ads_backgrounds_bg_merge_hd5:{},ads_backgrounds_bg_merge_hd6:{},ads_backgrounds_bg_merge_hd7:{},ads_backgrounds_bg_merge_hd8:{},ads_backgrounds_bg_merge_hd9:{},
ads_backgrounds_bg_millionaire:{},ads_backgrounds_bg_minimal:{},ads_backgrounds_bg_minimal2:{},ads_backgrounds_bg_modern:{},ads_backgrounds_bg_moon:{},ads_backgrounds_bg_moto:{},ads_backgrounds_bg_newyork:{},ads_backgrounds_bg_paper:{},ads_backgrounds_bg_pier:{},ads_backgrounds_bg_pinup:{},ads_backgrounds_bg_pinup_cat:{},ads_backgrounds_bg_pinup_dance:{},ads_backgrounds_bg_pinup_penguin:{},ads_backgrounds_bg_pixel:{},ads_backgrounds_bg_plain:{},ads_backgrounds_bg_planks:{},ads_backgrounds_bg_popart:{},ads_backgrounds_bg_questionnaire:{},ads_backgrounds_bg_redcar:{},ads_backgrounds_bg_riddles:{},ads_backgrounds_bg_riddles_2:{},ads_backgrounds_bg_riddles_hard:{},ads_backgrounds_bg_russian:{},ads_backgrounds_bg_sakura:{},ads_backgrounds_bg_scramble_pattern:{},ads_backgrounds_bg_sea:{},ads_backgrounds_bg_shanghai:{},ads_backgrounds_bg_sheep:{},ads_backgrounds_bg_skategirl:{},ads_backgrounds_bg_skyscraper:{},ads_backgrounds_bg_steampunk:{},ads_backgrounds_bg_stonegirl:{},
ads_backgrounds_bg_sweets:{},ads_backgrounds_bg_table_coffee:{},ads_backgrounds_bg_theatre:{},ads_backgrounds_bg_theatre2:{},ads_backgrounds_bg_tree:{},ads_backgrounds_bg_tree1:{},ads_backgrounds_bg_tree2:{},ads_backgrounds_bg_tree3:{},ads_backgrounds_bg_tree4:{},ads_backgrounds_bg_tree5:{},ads_backgrounds_bg_tree6:{},ads_backgrounds_bg_tree7:{},ads_backgrounds_bg_valentin:{},ads_backgrounds_bottom_background:{},ads_backgrounds_cheese_background:{},ads_backgrounds_chocolate_background:{},ads_backgrounds_feathers_background:{},ads_backgrounds_juice_background:{},ads_backgrounds_merge_custom_landscape:{},ads_backgrounds_merge_custom_landscape_blur:{},ads_backgrounds_merge_custom_portrait:{},ads_backgrounds_merge_custom_portrait_blur:{},ads_backgrounds_pyramids_bg:{},ads_backgrounds_seabeach_bg:{},ads_backgrounds_violet_bg:{},ads_backgrounds_xmasbg1:{},ads_backgrounds_xmasbg2:{},ads_bar:{"#%n-bar-1_cristmas_santa.png":"cleverapps/res/bundles/ads/bar/1_cristmas_santa.png",
"#%n-bar-bar_bg_brown.png":"cleverapps/res/bundles/ads/bar/bar_bg_brown.png","#%n-bar-bar_bg_field.png":"cleverapps/res/bundles/ads/bar/bar_bg_field.png","#%n-bar-bar_bg_halloween_blue.png":"cleverapps/res/bundles/ads/bar/bar_bg_halloween_blue.png","#%n-bar-bar_bg_halloween_green.png":"cleverapps/res/bundles/ads/bar/bar_bg_halloween_green.png","#%n-bar-bar_bg_medieval.png":"cleverapps/res/bundles/ads/bar/bar_bg_medieval.png","#%n-bar-bar_bg_white.png":"cleverapps/res/bundles/ads/bar/bar_bg_white.png","#%n-bar-bar_brown.png":"cleverapps/res/bundles/ads/bar/bar_brown.png","#%n-bar-bar_green.png":"cleverapps/res/bundles/ads/bar/bar_green.png","#%n-bar-bar_halloween_blue.png":"cleverapps/res/bundles/ads/bar/bar_halloween_blue.png","#%n-bar-bar_halloween_green.png":"cleverapps/res/bundles/ads/bar/bar_halloween_green.png","#%n-bar-bar_medieval.png":"cleverapps/res/bundles/ads/bar/bar_medieval.png","#%n-bar-bar_pink.png":"cleverapps/res/bundles/ads/bar/bar_pink.png",
"#%n-bar-bar_purple.png":"cleverapps/res/bundles/ads/bar/bar_purple.png","#%n-bar-bg_bar_green.png":"cleverapps/res/bundles/ads/bar/bg_bar_green.png","#%n-bar-bg_gold_bar.png":"cleverapps/res/bundles/ads/bar/bg_gold_bar.png","#%n-bar-brain.png":"cleverapps/res/bundles/ads/bar/brain.png","#%n-bar-cat.png":"cleverapps/res/bundles/ads/bar/cat.png","#%n-bar-coin.png":"cleverapps/res/bundles/ads/bar/coin.png","#%n-bar-coins_pot.png":"cleverapps/res/bundles/ads/bar/coins_pot.png","#%n-bar-cookie.png":"cleverapps/res/bundles/ads/bar/cookie.png","#%n-bar-element_lvl_1_halloween_blue.png":"cleverapps/res/bundles/ads/bar/element_lvl_1_halloween_blue.png","#%n-bar-element_lvl_1_halloween_green.png":"cleverapps/res/bundles/ads/bar/element_lvl_1_halloween_green.png","#%n-bar-element_lvl_2_halloween_blue.png":"cleverapps/res/bundles/ads/bar/element_lvl_2_halloween_blue.png","#%n-bar-element_lvl_2_halloween_green.png":"cleverapps/res/bundles/ads/bar/element_lvl_2_halloween_green.png",
"#%n-bar-element_lvl_3_halloween_blue.png":"cleverapps/res/bundles/ads/bar/element_lvl_3_halloween_blue.png","#%n-bar-element_lvl_3_halloween_green.png":"cleverapps/res/bundles/ads/bar/element_lvl_3_halloween_green.png","#%n-bar-element_lvl_4_halloween_blue.png":"cleverapps/res/bundles/ads/bar/element_lvl_4_halloween_blue.png","#%n-bar-element_lvl_4_halloween_green.png":"cleverapps/res/bundles/ads/bar/element_lvl_4_halloween_green.png","#%n-bar-fruitbar_green.png":"cleverapps/res/bundles/ads/bar/fruitbar_green.png","#%n-bar-fruitbar_orange_avatar.png":"cleverapps/res/bundles/ads/bar/fruitbar_orange_avatar.png","#%n-bar-fruitbar_orange_bg.png":"cleverapps/res/bundles/ads/bar/fruitbar_orange_bg.png","#%n-bar-glow_under_the_element_halloween_blue.png":"cleverapps/res/bundles/ads/bar/glow_under_the_element_halloween_blue.png","#%n-bar-glow_under_the_element_halloween_green.png":"cleverapps/res/bundles/ads/bar/glow_under_the_element_halloween_green.png",
"#%n-bar-gold_bar.png":"cleverapps/res/bundles/ads/bar/gold_bar.png","#%n-bar-gray_bar.png":"cleverapps/res/bundles/ads/bar/gray_bar.png"},ads_buttons:{"#%n-buttons-purpure_button1.png":"cleverapps/res/bundles/ads/buttons/purpure_button1.png","#%n-buttons-purpure_button2.png":"cleverapps/res/bundles/ads/buttons/purpure_button2.png"},ads_counter:{"#%n-counter-underscore.png":"cleverapps/res/bundles/ads/counter/underscore.png","@jsons/brain-8ccd592401.json":"cleverapps/res/bundles/ads/counter/brain/brain.json","@jsons/heart-da0f8e98e9.json":"cleverapps/res/bundles/ads/counter/heart/heart.json"},ads_exclamations:{"@jsons/amazing-cdb46335e0.json":"cleverapps/res/bundles/ads/exclamations/amazing.json","@jsons/good-6ba2017407.json":"cleverapps/res/bundles/ads/exclamations/good.json","@jsons/great-77253a79a8.json":"cleverapps/res/bundles/ads/exclamations/great.json","@jsons/perfect-256b4331d7.json":"cleverapps/res/bundles/ads/exclamations/perfect.json"},ads_finger:{
"#%n-fingers-hand.png":"cleverapps/res/bundles/ads/fingers/hand.png","#%n-fingers-merge_hand.png":"cleverapps/res/bundles/ads/fingers/merge_hand.png","#%n-fingers-hand_halloween.png":"cleverapps/res/bundles/ads/fingers/hand_halloween.png","#%n-fingers-mitten.png":"cleverapps/res/bundles/ads/fingers/mitten.png","#%n-fingers-candy_cane.png":"cleverapps/res/bundles/ads/fingers/candy_cane.png","#%n-fingers-riddles_hand.png":"cleverapps/res/bundles/ads/fingers/riddles_hand.png","#%n-fingers-heroes_hand.png":"cleverapps/res/bundles/ads/fingers/heroes_hand.png","#%n-fingers-adventure_hand.png":"cleverapps/res/bundles/ads/fingers/adventure_hand.png","#%n-fingers-cartoon_finger.png":"cleverapps/res/bundles/ads/fingers/cartoon_finger.png","#%n-fingers-realistic_finger.png":"cleverapps/res/bundles/ads/fingers/realistic_finger.png"},ads_keypad:{"@jsons/letters_bottom_stone-d338bb5840.json":"cleverapps/res/bundles/ads/letters/letters_bottom_stone/letters_bottom_stone.json",
"@jsons/letters_ice-edc392ac83.json":"cleverapps/res/bundles/ads/letters/letters_ice/letters_ice.json","@jsons/letters_icecream-09522c6082.json":"cleverapps/res/bundles/ads/letters/letters_icecream/letters_icecream.json","@jsons/letters_pillow-8ed19aaf4c.json":"cleverapps/res/bundles/ads/letters/letters_pillow/letters_pillow.json","@jsons/letters_red-1415578b3d.json":"cleverapps/res/bundles/ads/letters/letters_red/letters_red.json","@jsons/shatter_animation-7b9914f25c.json":"cleverapps/res/bundles/ads/letters/shatter_animation/shatter_animation.json"},ads_logo:{},ads_map2d:{"@jsons/merch-35e7e04e1d.json":"cleverapps/res/bundles/ads/merge/merch/merch.json","@jsons/collect-90a64e1d03.json":"cleverapps/res/bundles/ads/merge/collect/collect.json","@jsons/highlight-4c3006f6bf.json":"cleverapps/res/bundles/ads/merge/highlight/highlight.json"},ads_map2d_terrain_ice:{"#%n-ice-green_board.png":"cleverapps/res/bundles/ads/merge/terrain/ice/green_board.png",
"#%n-ice-green_board_angle.png":"cleverapps/res/bundles/ads/merge/terrain/ice/green_board_angle.png","#%n-ice-ground_1.png":"cleverapps/res/bundles/ads/merge/terrain/ice/ground_1.png","#%n-ice-ground_2.png":"cleverapps/res/bundles/ads/merge/terrain/ice/ground_2.png","#%n-ice-grow12_both.png":"cleverapps/res/bundles/ads/merge/terrain/ice/grow12_both.png","#%n-ice-grow12_left.png":"cleverapps/res/bundles/ads/merge/terrain/ice/grow12_left.png","#%n-ice-grow12_right.png":"cleverapps/res/bundles/ads/merge/terrain/ice/grow12_right.png","#%n-ice-level1_down_both.png":"cleverapps/res/bundles/ads/merge/terrain/ice/level1_down_both.png","#%n-ice-level1_down_corner.png":"cleverapps/res/bundles/ads/merge/terrain/ice/level1_down_corner.png","#%n-ice-level1_down_left.png":"cleverapps/res/bundles/ads/merge/terrain/ice/level1_down_left.png","#%n-ice-level1_down_left_only.png":"cleverapps/res/bundles/ads/merge/terrain/ice/level1_down_left_only.png",
"#%n-ice-level1_down_right.png":"cleverapps/res/bundles/ads/merge/terrain/ice/level1_down_right.png","#%n-ice-level1_down_right_only.png":"cleverapps/res/bundles/ads/merge/terrain/ice/level1_down_right_only.png","#%n-ice-level1_left_corner.png":"cleverapps/res/bundles/ads/merge/terrain/ice/level1_left_corner.png","#%n-ice-level1_left_inner.png":"cleverapps/res/bundles/ads/merge/terrain/ice/level1_left_inner.png","#%n-ice-level1_left_inner_last.png":"cleverapps/res/bundles/ads/merge/terrain/ice/level1_left_inner_last.png","#%n-ice-level1_right_corner.png":"cleverapps/res/bundles/ads/merge/terrain/ice/level1_right_corner.png","#%n-ice-level1_right_inner.png":"cleverapps/res/bundles/ads/merge/terrain/ice/level1_right_inner.png","#%n-ice-level1_right_inner_last.png":"cleverapps/res/bundles/ads/merge/terrain/ice/level1_right_inner_last.png","#%n-ice-level1_up_both.png":"cleverapps/res/bundles/ads/merge/terrain/ice/level1_up_both.png",
"#%n-ice-level1_up_corner.png":"cleverapps/res/bundles/ads/merge/terrain/ice/level1_up_corner.png","#%n-ice-level1_up_left_only.png":"cleverapps/res/bundles/ads/merge/terrain/ice/level1_up_left_only.png","#%n-ice-level1_up_left_only_last.png":"cleverapps/res/bundles/ads/merge/terrain/ice/level1_up_left_only_last.png","#%n-ice-level1_up_right_only.png":"cleverapps/res/bundles/ads/merge/terrain/ice/level1_up_right_only.png","#%n-ice-level1_up_right_only_last.png":"cleverapps/res/bundles/ads/merge/terrain/ice/level1_up_right_only_last.png","#%n-ice-level2_left_inner.png":"cleverapps/res/bundles/ads/merge/terrain/ice/level2_left_inner.png","#%n-ice-level2_left_inner_last.png":"cleverapps/res/bundles/ads/merge/terrain/ice/level2_left_inner_last.png","#%n-ice-level2_right_inner.png":"cleverapps/res/bundles/ads/merge/terrain/ice/level2_right_inner.png","#%n-ice-level2_right_inner_last.png":"cleverapps/res/bundles/ads/merge/terrain/ice/level2_right_inner_last.png",
"#%n-ice-level2_up_both.png":"cleverapps/res/bundles/ads/merge/terrain/ice/level2_up_both.png","#%n-ice-level2_up_both2.png":"cleverapps/res/bundles/ads/merge/terrain/ice/level2_up_both2.png","#%n-ice-level2_up_corner.png":"cleverapps/res/bundles/ads/merge/terrain/ice/level2_up_corner.png","#%n-ice-level2_up_corner2.png":"cleverapps/res/bundles/ads/merge/terrain/ice/level2_up_corner2.png","#%n-ice-level2_up_left_only.png":"cleverapps/res/bundles/ads/merge/terrain/ice/level2_up_left_only.png","#%n-ice-level2_up_left_only2.png":"cleverapps/res/bundles/ads/merge/terrain/ice/level2_up_left_only2.png","#%n-ice-level2_up_left_only_last.png":"cleverapps/res/bundles/ads/merge/terrain/ice/level2_up_left_only_last.png","#%n-ice-level2_up_right_only.png":"cleverapps/res/bundles/ads/merge/terrain/ice/level2_up_right_only.png","#%n-ice-level2_up_right_only2.png":"cleverapps/res/bundles/ads/merge/terrain/ice/level2_up_right_only2.png",
"#%n-ice-level2_up_right_only_last.png":"cleverapps/res/bundles/ads/merge/terrain/ice/level2_up_right_only_last.png","#%n-ice-side_angle_2.png":"cleverapps/res/bundles/ads/merge/terrain/ice/side_angle_2.png","#%n-ice-water_up_both.png":"cleverapps/res/bundles/ads/merge/terrain/ice/water_up_both.png","#%n-ice-water_up_left_only.png":"cleverapps/res/bundles/ads/merge/terrain/ice/water_up_left_only.png","#%n-ice-water_up_left_only_last.png":"cleverapps/res/bundles/ads/merge/terrain/ice/water_up_left_only_last.png","#%n-ice-water_up_right_only.png":"cleverapps/res/bundles/ads/merge/terrain/ice/water_up_right_only.png","#%n-ice-water_up_right_only_last.png":"cleverapps/res/bundles/ads/merge/terrain/ice/water_up_right_only_last.png"},ads_map2d_terrain_purple:{"#%n-purple-green_board.png":"cleverapps/res/bundles/ads/merge/terrain/purple/green_board.png","#%n-purple-green_board_angle.png":"cleverapps/res/bundles/ads/merge/terrain/purple/green_board_angle.png",
"#%n-purple-ground_1.png":"cleverapps/res/bundles/ads/merge/terrain/purple/ground_1.png","#%n-purple-ground_2.png":"cleverapps/res/bundles/ads/merge/terrain/purple/ground_2.png","#%n-purple-grow12_both.png":"cleverapps/res/bundles/ads/merge/terrain/purple/grow12_both.png","#%n-purple-grow12_corner.png":"cleverapps/res/bundles/ads/merge/terrain/purple/grow12_corner.png","#%n-purple-grow12_left.png":"cleverapps/res/bundles/ads/merge/terrain/purple/grow12_left.png","#%n-purple-grow12_right.png":"cleverapps/res/bundles/ads/merge/terrain/purple/grow12_right.png","#%n-purple-level1_down_both.png":"cleverapps/res/bundles/ads/merge/terrain/purple/level1_down_both.png","#%n-purple-level1_down_corner.png":"cleverapps/res/bundles/ads/merge/terrain/purple/level1_down_corner.png","#%n-purple-level1_down_left.png":"cleverapps/res/bundles/ads/merge/terrain/purple/level1_down_left.png","#%n-purple-level1_down_left_only.png":"cleverapps/res/bundles/ads/merge/terrain/purple/level1_down_left_only.png",
"#%n-purple-level1_down_right.png":"cleverapps/res/bundles/ads/merge/terrain/purple/level1_down_right.png","#%n-purple-level1_down_right_only.png":"cleverapps/res/bundles/ads/merge/terrain/purple/level1_down_right_only.png","#%n-purple-level1_left_corner.png":"cleverapps/res/bundles/ads/merge/terrain/purple/level1_left_corner.png","#%n-purple-level1_left_inner.png":"cleverapps/res/bundles/ads/merge/terrain/purple/level1_left_inner.png","#%n-purple-level1_left_inner_last.png":"cleverapps/res/bundles/ads/merge/terrain/purple/level1_left_inner_last.png","#%n-purple-level1_right_corner.png":"cleverapps/res/bundles/ads/merge/terrain/purple/level1_right_corner.png","#%n-purple-level1_right_inner.png":"cleverapps/res/bundles/ads/merge/terrain/purple/level1_right_inner.png","#%n-purple-level1_right_inner_last.png":"cleverapps/res/bundles/ads/merge/terrain/purple/level1_right_inner_last.png","#%n-purple-level1_up_both.png":"cleverapps/res/bundles/ads/merge/terrain/purple/level1_up_both.png",
"#%n-purple-level1_up_corner.png":"cleverapps/res/bundles/ads/merge/terrain/purple/level1_up_corner.png","#%n-purple-level1_up_left_only.png":"cleverapps/res/bundles/ads/merge/terrain/purple/level1_up_left_only.png","#%n-purple-level1_up_left_only_last.png":"cleverapps/res/bundles/ads/merge/terrain/purple/level1_up_left_only_last.png","#%n-purple-level1_up_right_only.png":"cleverapps/res/bundles/ads/merge/terrain/purple/level1_up_right_only.png","#%n-purple-level1_up_right_only_last.png":"cleverapps/res/bundles/ads/merge/terrain/purple/level1_up_right_only_last.png","#%n-purple-level2_left_inner.png":"cleverapps/res/bundles/ads/merge/terrain/purple/level2_left_inner.png","#%n-purple-level2_left_inner_last.png":"cleverapps/res/bundles/ads/merge/terrain/purple/level2_left_inner_last.png","#%n-purple-level2_right_inner.png":"cleverapps/res/bundles/ads/merge/terrain/purple/level2_right_inner.png",
"#%n-purple-level2_right_inner_last.png":"cleverapps/res/bundles/ads/merge/terrain/purple/level2_right_inner_last.png","#%n-purple-level2_up_both.png":"cleverapps/res/bundles/ads/merge/terrain/purple/level2_up_both.png","#%n-purple-level2_up_both2.png":"cleverapps/res/bundles/ads/merge/terrain/purple/level2_up_both2.png","#%n-purple-level2_up_corner.png":"cleverapps/res/bundles/ads/merge/terrain/purple/level2_up_corner.png","#%n-purple-level2_up_corner2.png":"cleverapps/res/bundles/ads/merge/terrain/purple/level2_up_corner2.png","#%n-purple-level2_up_left_only.png":"cleverapps/res/bundles/ads/merge/terrain/purple/level2_up_left_only.png","#%n-purple-level2_up_left_only2.png":"cleverapps/res/bundles/ads/merge/terrain/purple/level2_up_left_only2.png","#%n-purple-level2_up_left_only_last.png":"cleverapps/res/bundles/ads/merge/terrain/purple/level2_up_left_only_last.png","#%n-purple-level2_up_right_only.png":"cleverapps/res/bundles/ads/merge/terrain/purple/level2_up_right_only.png",
"#%n-purple-level2_up_right_only2.png":"cleverapps/res/bundles/ads/merge/terrain/purple/level2_up_right_only2.png","#%n-purple-level2_up_right_only_last.png":"cleverapps/res/bundles/ads/merge/terrain/purple/level2_up_right_only_last.png","#%n-purple-side_angle_2.png":"cleverapps/res/bundles/ads/merge/terrain/purple/side_angle_2.png","#%n-purple-water_up_both.png":"cleverapps/res/bundles/ads/merge/terrain/purple/water_up_both.png","#%n-purple-water_up_left_only.png":"cleverapps/res/bundles/ads/merge/terrain/purple/water_up_left_only.png","#%n-purple-water_up_left_only_last.png":"cleverapps/res/bundles/ads/merge/terrain/purple/water_up_left_only_last.png","#%n-purple-water_up_right_only.png":"cleverapps/res/bundles/ads/merge/terrain/purple/water_up_right_only.png","#%n-purple-water_up_right_only_last.png":"cleverapps/res/bundles/ads/merge/terrain/purple/water_up_right_only_last.png"},ads_map2d_terrain_sand:{
"#%n-sand-green_board.png":"cleverapps/res/bundles/ads/merge/terrain/sand/green_board.png","#%n-sand-green_board_angle.png":"cleverapps/res/bundles/ads/merge/terrain/sand/green_board_angle.png","#%n-sand-ground_1.png":"cleverapps/res/bundles/ads/merge/terrain/sand/ground_1.png","#%n-sand-ground_2.png":"cleverapps/res/bundles/ads/merge/terrain/sand/ground_2.png","#%n-sand-grow12_both.png":"cleverapps/res/bundles/ads/merge/terrain/sand/grow12_both.png","#%n-sand-grow12_corner.png":"cleverapps/res/bundles/ads/merge/terrain/sand/grow12_corner.png","#%n-sand-grow12_left.png":"cleverapps/res/bundles/ads/merge/terrain/sand/grow12_left.png","#%n-sand-grow12_right.png":"cleverapps/res/bundles/ads/merge/terrain/sand/grow12_right.png","#%n-sand-level1_down_both.png":"cleverapps/res/bundles/ads/merge/terrain/sand/level1_down_both.png","#%n-sand-level1_down_corner.png":"cleverapps/res/bundles/ads/merge/terrain/sand/level1_down_corner.png",
"#%n-sand-level1_down_left.png":"cleverapps/res/bundles/ads/merge/terrain/sand/level1_down_left.png","#%n-sand-level1_down_left_only.png":"cleverapps/res/bundles/ads/merge/terrain/sand/level1_down_left_only.png","#%n-sand-level1_down_right.png":"cleverapps/res/bundles/ads/merge/terrain/sand/level1_down_right.png","#%n-sand-level1_down_right_only.png":"cleverapps/res/bundles/ads/merge/terrain/sand/level1_down_right_only.png","#%n-sand-level1_left_corner.png":"cleverapps/res/bundles/ads/merge/terrain/sand/level1_left_corner.png","#%n-sand-level1_left_inner.png":"cleverapps/res/bundles/ads/merge/terrain/sand/level1_left_inner.png","#%n-sand-level1_left_inner_last.png":"cleverapps/res/bundles/ads/merge/terrain/sand/level1_left_inner_last.png","#%n-sand-level1_right_corner.png":"cleverapps/res/bundles/ads/merge/terrain/sand/level1_right_corner.png","#%n-sand-level1_right_inner.png":"cleverapps/res/bundles/ads/merge/terrain/sand/level1_right_inner.png",
"#%n-sand-level1_right_inner_last.png":"cleverapps/res/bundles/ads/merge/terrain/sand/level1_right_inner_last.png","#%n-sand-level1_up_both.png":"cleverapps/res/bundles/ads/merge/terrain/sand/level1_up_both.png","#%n-sand-level1_up_corner.png":"cleverapps/res/bundles/ads/merge/terrain/sand/level1_up_corner.png","#%n-sand-level1_up_left_only.png":"cleverapps/res/bundles/ads/merge/terrain/sand/level1_up_left_only.png","#%n-sand-level1_up_left_only_last.png":"cleverapps/res/bundles/ads/merge/terrain/sand/level1_up_left_only_last.png","#%n-sand-level1_up_right_only.png":"cleverapps/res/bundles/ads/merge/terrain/sand/level1_up_right_only.png","#%n-sand-level1_up_right_only_last.png":"cleverapps/res/bundles/ads/merge/terrain/sand/level1_up_right_only_last.png","#%n-sand-level2_left_inner.png":"cleverapps/res/bundles/ads/merge/terrain/sand/level2_left_inner.png","#%n-sand-level2_left_inner_last.png":"cleverapps/res/bundles/ads/merge/terrain/sand/level2_left_inner_last.png",
"#%n-sand-level2_right_inner.png":"cleverapps/res/bundles/ads/merge/terrain/sand/level2_right_inner.png","#%n-sand-level2_right_inner_last.png":"cleverapps/res/bundles/ads/merge/terrain/sand/level2_right_inner_last.png","#%n-sand-level2_up_both.png":"cleverapps/res/bundles/ads/merge/terrain/sand/level2_up_both.png","#%n-sand-level2_up_both2.png":"cleverapps/res/bundles/ads/merge/terrain/sand/level2_up_both2.png","#%n-sand-level2_up_corner.png":"cleverapps/res/bundles/ads/merge/terrain/sand/level2_up_corner.png","#%n-sand-level2_up_corner2.png":"cleverapps/res/bundles/ads/merge/terrain/sand/level2_up_corner2.png","#%n-sand-level2_up_left_only.png":"cleverapps/res/bundles/ads/merge/terrain/sand/level2_up_left_only.png","#%n-sand-level2_up_left_only2.png":"cleverapps/res/bundles/ads/merge/terrain/sand/level2_up_left_only2.png","#%n-sand-level2_up_left_only_last.png":"cleverapps/res/bundles/ads/merge/terrain/sand/level2_up_left_only_last.png",
"#%n-sand-level2_up_right_only.png":"cleverapps/res/bundles/ads/merge/terrain/sand/level2_up_right_only.png","#%n-sand-level2_up_right_only2.png":"cleverapps/res/bundles/ads/merge/terrain/sand/level2_up_right_only2.png","#%n-sand-level2_up_right_only_last.png":"cleverapps/res/bundles/ads/merge/terrain/sand/level2_up_right_only_last.png","#%n-sand-side_angle_2.png":"cleverapps/res/bundles/ads/merge/terrain/sand/side_angle_2.png","#%n-sand-water_up_left_only.png":"cleverapps/res/bundles/ads/merge/terrain/sand/water_up_left_only.png","#%n-sand-water_up_left_only_last.png":"cleverapps/res/bundles/ads/merge/terrain/sand/water_up_left_only_last.png","#%n-sand-water_up_right_only.png":"cleverapps/res/bundles/ads/merge/terrain/sand/water_up_right_only.png","#%n-sand-water_up_right_only_last.png":"cleverapps/res/bundles/ads/merge/terrain/sand/water_up_right_only_last.png"},ads_menu:{"#%n-cat_0.png":"cleverapps/res/bundles/ads/ads_menu/cat_0.png",
"#%n-cat_1.png":"cleverapps/res/bundles/ads/ads_menu/cat_1.png","#%n-cat_2.png":"cleverapps/res/bundles/ads/ads_menu/cat_2.png","#%n-title_blue.png":"cleverapps/res/bundles/ads/ads_menu/title_blue.png","#%n-title_orange.png":"cleverapps/res/bundles/ads/ads_menu/title_orange.png","#%n-title_red.png":"cleverapps/res/bundles/ads/ads_menu/title_red.png"},ads_scale:{"#%n-scale-smartbrain_brown_einstein_brown.png":"cleverapps/res/bundles/ads/scale/smartbrain_brown_einstein_brown.png","#%n-scale-smartbrain_white_einstein_yellow.png":"cleverapps/res/bundles/ads/scale/smartbrain_white_einstein_yellow.png","#%n-scale-cutebrain_grandma_pink.png":"cleverapps/res/bundles/ads/scale/cutebrain_grandma_pink.png","#%n-scale-witch_house.png":"cleverapps/res/bundles/ads/scale/witch_house.png","#%n-scale-witch.png":"cleverapps/res/bundles/ads/scale/witch.png","#%n-scale-xmas_bar.png":"cleverapps/res/bundles/ads/scale/xmas_bar.png",
"#%n-scale-xmas_santa_bar.png":"cleverapps/res/bundles/ads/scale/xmas_santa_bar.png","#%n-scale-cupid_heart_scale.png":"cleverapps/res/bundles/ads/scale/cupid_heart_scale.png","@jsons/smartbrain-c85815f9fc.json":"cleverapps/res/bundles/ads/scale/spines/smartbrain.json","@jsons/cutebrain-a45a1ec5c7.json":"cleverapps/res/bundles/ads/scale/spines/cutebrain.json","@jsons/witch_animation-9b9dc7dc23.json":"cleverapps/res/bundles/ads/scale/spines/witch_animation.json","@jsons/colorcupid_heart-19aa9beb21.json":"cleverapps/res/bundles/ads/scale/spines/colorcupid_heart.json","@jsons/solidcupid_heart-3adab32088.json":"cleverapps/res/bundles/ads/scale/spines/solidcupid_heart.json"},ads_sfx_common:{"~sounds/ads_win_1-022a291661.mp3":"cleverapps/res/bundles/ads/sfx/common/ads_win_1.mp3","~sounds/ads_win_2-fd4acf3c56.mp3":"cleverapps/res/bundles/ads/sfx/common/ads_win_2.mp3","~sounds/ads_win_3-12f9747274.mp3":"cleverapps/res/bundles/ads/sfx/common/ads_win_3.mp3",
"~sounds/bear_choice-cb10e429b1.mp3":"cleverapps/res/bundles/ads/sfx/common/bear_choice.mp3","~sounds/bear_says-aff725f95f.mp3":"cleverapps/res/bundles/ads/sfx/common/bear_says.mp3","~sounds/character_selection-654bdaefa5.mp3":"cleverapps/res/bundles/ads/sfx/common/character_selection.mp3","~sounds/goblin_choice-73986ca46d.mp3":"cleverapps/res/bundles/ads/sfx/common/goblin_choice.mp3","~sounds/goblin_says-2b1360a529.mp3":"cleverapps/res/bundles/ads/sfx/common/goblin_says.mp3","~sounds/island_emerging-9cb1ea2f4b.mp3":"cleverapps/res/bundles/ads/sfx/common/island_emerging.mp3","~sounds/laugh_female-03ec151601.mp3":"cleverapps/res/bundles/ads/sfx/common/laugh_female.mp3","~sounds/laugh_female_1-16d5e62f1c.mp3":"cleverapps/res/bundles/ads/sfx/common/laugh_female_1.mp3","~sounds/laugh_king-8854b7247a.mp3":"cleverapps/res/bundles/ads/sfx/common/laugh_king.mp3","~sounds/laugh_knight-67647ad575.mp3":"cleverapps/res/bundles/ads/sfx/common/laugh_knight.mp3",
"~sounds/merge_effect1-c05f58d62d.mp3":"cleverapps/res/bundles/ads/sfx/common/merge_effect1.mp3","~sounds/merge_effect2-7df540d699.mp3":"cleverapps/res/bundles/ads/sfx/common/merge_effect2.mp3","~sounds/spawn_landing2-169e1e03fb.mp3":"cleverapps/res/bundles/ads/sfx/common/spawn_landing2.mp3","~sounds/swipe-ac85d34b97.mp3":"cleverapps/res/bundles/ads/sfx/common/swipe.mp3"},ads_spines:{"@jsons/grandpa-edb7c9d2b3.json":"cleverapps/res/bundles/ads/words_result/grandpa/grandpa.json","@jsons/grandma-78e8d2e3e1.json":"cleverapps/res/bundles/ads/words_result/grandma/grandma.json","@jsons/snowman-2345d31f9d.json":"cleverapps/res/bundles/ads/xmas/snowman/snowman.json","@jsons/tree-6db997a1f8.json":"cleverapps/res/bundles/ads/xmas/tree/tree.json","@jsons/clouds-fc1cf17bef.json":"cleverapps/res/bundles/ads/clouds/clouds.json","@jsons/grandma-951bb40d52.json":"cleverapps/res/bundles/ads/spines/grandma/grandma.json",
"@jsons/grandpa-bceb817598.json":"cleverapps/res/bundles/ads/spines/grandpa/grandpa.json","@jsons/grandpa_valentine-9590e3adc9.json":"cleverapps/res/bundles/ads/spines/grandpa/grandpa_valentine.json","@jsons/dialog-7ff588238c.json":"cleverapps/res/bundles/ads/spines/dialog/dialog.json","@jsons/dialog_no_clouds-9e9aeff8bf.json":"cleverapps/res/bundles/ads/spines/dialog_no_clouds/dialog_no_clouds.json","@jsons/energy_bug-ff67bfebde.json":"cleverapps/res/bundles/ads/spines/energyfeast/energy_bug.json","@jsons/energy_bug_midle-378cad2860.json":"cleverapps/res/bundles/ads/spines/energyfeast/energy_bug_midle.json","@jsons/energy_bug_mini-4bbd959009.json":"cleverapps/res/bundles/ads/spines/energyfeast/energy_bug_mini.json","@jsons/emeralda-d44fafd08e.json":"cleverapps/res/bundles/ads/spines/merge_heroes/emeralda.json","@jsons/enchantress-96f4ac96ff.json":"cleverapps/res/bundles/ads/spines/merge_heroes/enchantress.json",
"@jsons/king-16f7082732.json":"cleverapps/res/bundles/ads/spines/merge_heroes/king.json","@jsons/bear-c16fb05c11.json":"cleverapps/res/bundles/ads/spines/merge_heroes/bear.json","@jsons/troll-cfda66417d.json":"cleverapps/res/bundles/ads/spines/merge_heroes/troll.json","@jsons/green_island-c1f445c229.json":"cleverapps/res/bundles/ads/spines/merge_islands/green_island/green_island.json","@jsons/ice_island-64446d3fcc.json":"cleverapps/res/bundles/ads/spines/merge_islands/ice_island/ice_island.json","@jsons/sand_island-f5dc7e5e22.json":"cleverapps/res/bundles/ads/spines/merge_islands/sand_island/sand_island.json","@jsons/harvest_pumpkin-a90ef63fdf.json":"cleverapps/res/bundles/ads/spines/merge_islands/harvest_pumpkin/harvest_pumpkin.json","@jsons/merge_sapphire-c5444655f2.json":"cleverapps/res/bundles/ads/spines/merge_islands/merge_sapphire/merge_sapphire.json","@jsons/merge_wand-a9e083e48a.json":"cleverapps/res/bundles/ads/spines/merge_islands/merge_wand/merge_wand.json"},ads_sprites:{
"#%n-sprites-build_combo.png":"cleverapps/res/bundles/ads/sprites/build_combo.png","#%n-sprites-build_dwarf.png":"cleverapps/res/bundles/ads/sprites/build_dwarf.png","#%n-sprites-coins.png":"cleverapps/res/bundles/ads/sprites/coins.png","#%n-sprites-design_fence.png":"cleverapps/res/bundles/ads/sprites/design_fence.png","#%n-sprites-design_fence_left.png":"cleverapps/res/bundles/ads/sprites/design_fence_left.png","#%n-sprites-design_fence_left_landscape.png":"cleverapps/res/bundles/ads/sprites/design_fence_left_landscape.png","#%n-sprites-design_fence_right.png":"cleverapps/res/bundles/ads/sprites/design_fence_right.png","#%n-sprites-design_fence_right_landscape.png":"cleverapps/res/bundles/ads/sprites/design_fence_right_landscape.png","#%n-sprites-energy.png":"cleverapps/res/bundles/ads/sprites/energy.png","#%n-sprites-harvest_bed.png":"cleverapps/res/bundles/ads/sprites/harvest_bed.png","#%n-sprites-harvest_shovel.png":"cleverapps/res/bundles/ads/sprites/harvest_shovel.png",
"#%n-sprites-level.png":"cleverapps/res/bundles/ads/sprites/level.png","#%n-sprites-marketing_buble_cake.png":"cleverapps/res/bundles/ads/sprites/marketing_buble_cake.png","#%n-sprites-marketing_cloud.png":"cleverapps/res/bundles/ads/sprites/marketing_cloud.png","#%n-sprites-marketing_corn.png":"cleverapps/res/bundles/ads/sprites/marketing_corn.png","#%n-sprites-marketing_hero_svin.png":"cleverapps/res/bundles/ads/sprites/marketing_hero_svin.png","#%n-sprites-marketing_korol.png":"cleverapps/res/bundles/ads/sprites/marketing_korol.png","#%n-sprites-marketing_light_effect.png":"cleverapps/res/bundles/ads/sprites/marketing_light_effect.png","#%n-sprites-marketing_magic.png":"cleverapps/res/bundles/ads/sprites/marketing_magic.png","#%n-sprites-marketing_scroll.png":"cleverapps/res/bundles/ads/sprites/marketing_scroll.png","#%n-sprites-marketing_strawberry.png":"cleverapps/res/bundles/ads/sprites/marketing_strawberry.png",
"#%n-sprites-marketing_tower.png":"cleverapps/res/bundles/ads/sprites/marketing_tower.png","#%n-sprites-marketing_tree.png":"cleverapps/res/bundles/ads/sprites/marketing_tree.png","#%n-sprites-new_sceenshot_text.png":"cleverapps/res/bundles/ads/sprites/new_sceenshot_text.png","#%n-sprites-screenshot_text.png":"cleverapps/res/bundles/ads/sprites/screenshot_text.png","#%n-sprites-select_hero.png":"cleverapps/res/bundles/ads/sprites/select_hero.png","#%n-sprites-tree_1.png":"cleverapps/res/bundles/ads/sprites/tree_1.png","#%n-sprites-tree_2.png":"cleverapps/res/bundles/ads/sprites/tree_2.png","#%n-sprites-wands.png":"cleverapps/res/bundles/ads/sprites/wands.png"},ads_title:{"#%n-substrate-autumn_title.png":"cleverapps/res/bundles/ads/substrate/autumn_title.png","#%n-substrate-shanghai_title.png":"cleverapps/res/bundles/ads/substrate/shanghai_title.png","#%n-substrate-wood_title.png":"cleverapps/res/bundles/ads/substrate/wood_title.png",
"#%n-substrate-halloween_title.png":"cleverapps/res/bundles/ads/substrate/halloween_title.png","#%n-substrate-newyork_title.png":"cleverapps/res/bundles/ads/substrate/newyork_title.png","#%n-substrate-darkred_word.png":"cleverapps/res/bundles/ads/substrate/darkred_word.png","#%n-substrate-darkred_letter.png":"cleverapps/res/bundles/ads/substrate/darkred_letter.png","#%n-substrate-blackpurple_word.png":"cleverapps/res/bundles/ads/substrate/blackpurple_word.png","#%n-substrate-blackpurple_letter.png":"cleverapps/res/bundles/ads/substrate/blackpurple_letter.png","#%n-substrate-darkpurple_word.png":"cleverapps/res/bundles/ads/substrate/darkpurple_word.png","#%n-substrate-darkpurple_letter.png":"cleverapps/res/bundles/ads/substrate/darkpurple_letter.png","#%n-substrate-blueorange_word.png":"cleverapps/res/bundles/ads/substrate/blueorange_word.png","#%n-substrate-blueorange_letter.png":"cleverapps/res/bundles/ads/substrate/blueorange_letter.png",
"#%n-substrate-pinkblue_word.png":"cleverapps/res/bundles/ads/substrate/pinkblue_word.png","#%n-substrate-letter_keypad_bg_halloween_green.png":"cleverapps/res/bundles/ads/substrate/letter_keypad_bg_halloween_green.png","#%n-substrate-ribbon_title.png":"cleverapps/res/bundles/ads/substrate/ribbon_title.png","#%n-substrate-dark_title.png":"cleverapps/res/bundles/ads/substrate/dark_title.png","#%n-substrate-pink_title.png":"cleverapps/res/bundles/ads/substrate/pink_title.png","#%n-substrate-hexagreen_letter.png":"cleverapps/res/bundles/ads/substrate/hexagreen_letter.png","#%n-substrate-blueblue_letter.png":"cleverapps/res/bundles/ads/substrate/blueblue_letter.png","#%n-substrate-pinup_dance.png":"cleverapps/res/bundles/ads/substrate/pinup_dance.png","#%n-substrate-table_bg.png":"cleverapps/res/bundles/ads/substrate/table_bg.png","#%n-substrate-black_title.png":"cleverapps/res/bundles/ads/substrate/black_title.png",
"#%n-substrate-light_grey_field.png":"cleverapps/res/bundles/ads/substrate/light_grey_field.png","#%n-substrate-brown_field.png":"cleverapps/res/bundles/ads/substrate/brown_field.png","#%n-substrate-transparent_white_title.png":"cleverapps/res/bundles/ads/substrate/transparent_white_title.png","#%n-substrate-violet_flower_mini.png":"cleverapps/res/bundles/ads/substrate/violet_flower_mini.png","#%n-substrate-seabeach_starfish_mini.png":"cleverapps/res/bundles/ads/substrate/seabeach_starfish_mini.png","#%n-substrate-pyramid_mini.png":"cleverapps/res/bundles/ads/substrate/pyramid_mini.png","#%n-substrate-cherry_mini.png":"cleverapps/res/bundles/ads/substrate/cherry_mini.png","#%n-substrate-ananas_mini.png":"cleverapps/res/bundles/ads/substrate/ananas_mini.png","#%n-substrate-seashell_mini.png":"cleverapps/res/bundles/ads/substrate/seashell_mini.png","#%n-substrate-cheese_mini.png":"cleverapps/res/bundles/ads/substrate/cheese_mini.png",
"#%n-substrate-feather_mini.png":"cleverapps/res/bundles/ads/substrate/feather_mini.png","#%n-substrate-orange_mini.png":"cleverapps/res/bundles/ads/substrate/orange_mini.png","#%n-substrate-coin_add.png":"cleverapps/res/bundles/ads/substrate/coin_add.png","#%n-substrate-coin_bar.png":"cleverapps/res/bundles/ads/substrate/coin_bar.png","#%n-substrate-wood_counter.png":"cleverapps/res/bundles/ads/substrate/wood_counter.png","#%n-substrate-rays.png":"cleverapps/res/bundles/ads/substrate/rays.png","#%n-substrate-picture_1.png":"cleverapps/res/bundles/ads/substrate/picture_1.png","#%n-substrate-picture_2.png":"cleverapps/res/bundles/ads/substrate/picture_2.png","#%n-substrate-seabeach_title.png":"cleverapps/res/bundles/ads/substrate/seabeach_title.png","#%n-substrate-merge_logo.png":"cleverapps/res/bundles/ads/substrate/merge_logo.png","#%n-substrate-merge_logo_ru.png":"cleverapps/res/bundles/ads/substrate/merge_logo_ru.png",
"#%n-substrate-fleid_frame_dark.png":"cleverapps/res/bundles/ads/substrate/fleid_frame_dark.png","#%n-substrate-mini_bg.png":"cleverapps/res/bundles/ads/substrate/mini_bg.png","#%n-substrate-mini_bg_arrow.png":"cleverapps/res/bundles/ads/substrate/mini_bg_arrow.png","#%n-substrate-text_bg_blue.png":"cleverapps/res/bundles/ads/substrate/text_bg_blue.png","#%n-substrate-text_bg_green.png":"cleverapps/res/bundles/ads/substrate/text_bg_green.png","#%n-substrate-text_bg_green_arrow.png":"cleverapps/res/bundles/ads/substrate/text_bg_green_arrow.png"},ads_transition:{},ads_tree:{"@jsons/dog-a45f7877bf.json":"cleverapps/res/bundles/ads/dog/dog.json","@jsons/cat-3405f1aa5c.json":"cleverapps/res/bundles/ads/cat/cat.json","@jsons/hero_xmas-7dc97951c4.json":"cleverapps/res/bundles/ads/xmas/cat/hero_xmas.json","@jsons/tree-a62d30dbeb.json":"cleverapps/res/bundles/ads/tree/tree.json","@jsons/tree_in_pot-7e4eef640e.json":"cleverapps/res/bundles/ads/tree/tree_in_pot.json",
"@jsons/snowman-2345d31f9d.json":"cleverapps/res/bundles/ads/xmas/snowman/snowman.json","@jsons/tree-6db997a1f8.json":"cleverapps/res/bundles/ads/xmas/tree/tree.json"},ads_words_list:{"#%n-words_list-ananas_yellow_wbg.png":"cleverapps/res/bundles/ads/words_list/ananas_yellow_wbg.png","#%n-words_list-blackblue_word.png":"cleverapps/res/bundles/ads/words_list/blackblue_word.png","#%n-words_list-blackpurple_word.png":"cleverapps/res/bundles/ads/words_list/blackpurple_word.png","#%n-words_list-blue_ice_wbg.png":"cleverapps/res/bundles/ads/words_list/blue_ice_wbg.png","#%n-words_list-blueblue_word.png":"cleverapps/res/bundles/ads/words_list/blueblue_word.png","#%n-words_list-blueorange_word.png":"cleverapps/res/bundles/ads/words_list/blueorange_word.png","#%n-words_list-bottom_bllue_wbg.png":"cleverapps/res/bundles/ads/words_list/bottom_bllue_wbg.png","#%n-words_list-bottom_pink_wbg.png":"cleverapps/res/bundles/ads/words_list/bottom_pink_wbg.png",
"#%n-words_list-cheese_red_wbg.png":"cleverapps/res/bundles/ads/words_list/cheese_red_wbg.png","#%n-words_list-cheese_yellow_wbg.png":"cleverapps/res/bundles/ads/words_list/cheese_yellow_wbg.png","#%n-words_list-chocolate_dark_wbg.png":"cleverapps/res/bundles/ads/words_list/chocolate_dark_wbg.png","#%n-words_list-chocolate_pink_wbg.png":"cleverapps/res/bundles/ads/words_list/chocolate_pink_wbg.png","#%n-words_list-cyanorange_word.png":"cleverapps/res/bundles/ads/words_list/cyanorange_word.png","#%n-words_list-darkpurple_word.png":"cleverapps/res/bundles/ads/words_list/darkpurple_word.png","#%n-words_list-darkred_word.png":"cleverapps/res/bundles/ads/words_list/darkred_word.png","#%n-words_list-greyblue_word.png":"cleverapps/res/bundles/ads/words_list/greyblue_word.png","#%n-words_list-greygrey_word.png":"cleverapps/res/bundles/ads/words_list/greygrey_word.png","#%n-words_list-hexagreen_word.png":"cleverapps/res/bundles/ads/words_list/hexagreen_word.png",
"#%n-words_list-hexaindigo_word.png":"cleverapps/res/bundles/ads/words_list/hexaindigo_word.png","#%n-words_list-juice_orange_wbg.png":"cleverapps/res/bundles/ads/words_list/juice_orange_wbg.png","#%n-words_list-marbelbrown_word.png":"cleverapps/res/bundles/ads/words_list/marbelbrown_word.png","#%n-words_list-marbelyellow_word.png":"cleverapps/res/bundles/ads/words_list/marbelyellow_word.png","#%n-words_list-orange_word.png":"cleverapps/res/bundles/ads/words_list/orange_word.png","#%n-words_list-orangeline_valentine_word_bg.png":"cleverapps/res/bundles/ads/words_list/orangeline_valentine_word_bg.png","#%n-words_list-pillow_green_wbg.png":"cleverapps/res/bundles/ads/words_list/pillow_green_wbg.png","#%n-words_list-pillow_pink_wbg.png":"cleverapps/res/bundles/ads/words_list/pillow_pink_wbg.png","#%n-words_list-pinkblue_word.png":"cleverapps/res/bundles/ads/words_list/pinkblue_word.png","#%n-words_list-pinkpink_word.png":"cleverapps/res/bundles/ads/words_list/pinkpink_word.png",
"#%n-words_list-seabeach_substrate.png":"cleverapps/res/bundles/ads/words_list/seabeach_substrate.png","#%n-words_list-seabeach_substrate_white.png":"cleverapps/res/bundles/ads/words_list/seabeach_substrate_white.png","#%n-words_list-violet_substrate.png":"cleverapps/res/bundles/ads/words_list/violet_substrate.png","#%n-words_list-violet_turquoise_substare.png":"cleverapps/res/bundles/ads/words_list/violet_turquoise_substare.png","#%n-words_list-woodbrown_word.png":"cleverapps/res/bundles/ads/words_list/woodbrown_word.png","#%n-words_list-woodwhite_word.png":"cleverapps/res/bundles/ads/words_list/woodwhite_word.png","#%n-words_list-yellow_word.png":"cleverapps/res/bundles/ads/words_list/yellow_word.png","@jsons/strike-ef7ddbb8c0.json":"cleverapps/res/bundles/ads/words_list/strike/strike.json","@jsons/animation-6f92f6f792.json":"cleverapps/res/bundles/ads/words_list/animation/animation.json"},ads_words_result:{
"#%n-words_result-line.png":"cleverapps/res/bundles/ads/words_result/line.png","@jsons/grandpa-edb7c9d2b3.json":"cleverapps/res/bundles/ads/words_result/grandpa/grandpa.json"},avatar:{},battle_pass:{"#%n-gradient_goldpass.png":"cleverapps/res/mergecraft/bundles/battle_pass/gradient_goldpass.png","#%n-batlepass_brown.png":"cleverapps/res/mergecraft/bundles/battle_pass/batlepass_brown.png","#%n-goldpass_bar.png":"cleverapps/res/mergecraft/bundles/battle_pass/goldpass_bar.png","#%n-goldpass_bar_bg.png":"cleverapps/res/mergecraft/bundles/battle_pass/goldpass_bar_bg.png","#%n-goldpass_bar_scala.png":"cleverapps/res/mergecraft/bundles/battle_pass/goldpass_bar_scala.png","#%n-goldpass_star.png":"cleverapps/res/mergecraft/bundles/battle_pass/goldpass_star.png","#%n-under_bg_goldpass.png":"cleverapps/res/mergecraft/bundles/battle_pass/under_bg_goldpass.png","#%n-under_worker_batlepass.png":"cleverapps/res/mergecraft/bundles/battle_pass/under_worker_batlepass.png",
"#%n-worker_batlepass.png":"cleverapps/res/mergecraft/bundles/battle_pass/worker_batlepass.png","#%n-blik_pass.png":"cleverapps/res/mergecraft/bundles/battle_pass/blik_pass.png","#%n-timer_substrate.png":"cleverapps/res/mergecraft/bundles/battle_pass/timer_substrate.png","#%n-timer_icon.png":"cleverapps/res/mergecraft/bundles/battle_pass/timer_icon.png","#%n-guide_button.png":"cleverapps/res/mergecraft/bundles/battle_pass/guide_button.png","#%n-guide_button_on.png":"cleverapps/res/mergecraft/bundles/battle_pass/guide_button_on.png","#%n-offer_badge.png":"cleverapps/res/mergecraft/bundles/battle_pass/offer_badge.png","#%n-icon_background.png":"cleverapps/res/mergecraft/bundles/battle_pass/icon_background.png","#%n-icon_ribbon.png":"cleverapps/res/mergecraft/bundles/battle_pass/icon_ribbon.png","@jsons/battlepass_ticket-56dc4d77d4.json":"cleverapps/res/mergecraft/bundles/battle_pass/ticket/battlepass_ticket.json",
"@jsons/blik_pass-67ae82156e.json":"cleverapps/res/mergecraft/bundles/battle_pass/blik_pass/blik_pass.json"},beatfriendwindow:{"#%n-windows-beat_friend_bg.png":"cleverapps/res/mergecraft/windows/beat_friend_bg.png"},bonus_round_window:{},bonus_world_easter:{"#%n-marvin-round-nostroke-62pt-0.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/0.png","#%n-marvin-round-nostroke-62pt-1.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/1.png","#%n-marvin-round-nostroke-62pt-2.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/2.png","#%n-marvin-round-nostroke-62pt-3.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/3.png","#%n-marvin-round-nostroke-62pt-4.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/4.png","#%n-marvin-round-nostroke-62pt-5.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/5.png","#%n-marvin-round-nostroke-62pt-6.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/6.png",
"#%n-marvin-round-nostroke-62pt-7.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/7.png","#%n-marvin-round-nostroke-62pt-8.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/8.png","#%n-marvin-round-nostroke-62pt-9.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/9.png","#%n-marvin-round-nostroke-62pt-colon.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/colon.png","#%n-marvin-round-nostroke-62pt-slash.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/slash.png","#%n-marvin-round-nostroke-62pt-plus.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/plus.png","#%n-marvin-round-nostroke-62pt-minus.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/minus.png","#%n-marvin-round-nostroke-62pt-x.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/x.png","#%n-marvin-round-nostroke-62pt-space.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/space.png",
"#%n-marvin-round-45pt-0.png":"cleverapps/res/common/fonts/marvin-round/45pt/0.png","#%n-marvin-round-45pt-1.png":"cleverapps/res/common/fonts/marvin-round/45pt/1.png","#%n-marvin-round-45pt-2.png":"cleverapps/res/common/fonts/marvin-round/45pt/2.png","#%n-marvin-round-45pt-3.png":"cleverapps/res/common/fonts/marvin-round/45pt/3.png","#%n-marvin-round-45pt-4.png":"cleverapps/res/common/fonts/marvin-round/45pt/4.png","#%n-marvin-round-45pt-5.png":"cleverapps/res/common/fonts/marvin-round/45pt/5.png","#%n-marvin-round-45pt-6.png":"cleverapps/res/common/fonts/marvin-round/45pt/6.png","#%n-marvin-round-45pt-7.png":"cleverapps/res/common/fonts/marvin-round/45pt/7.png","#%n-marvin-round-45pt-8.png":"cleverapps/res/common/fonts/marvin-round/45pt/8.png","#%n-marvin-round-45pt-9.png":"cleverapps/res/common/fonts/marvin-round/45pt/9.png","#%n-marvin-round-45pt-colon.png":"cleverapps/res/common/fonts/marvin-round/45pt/colon.png",
"#%n-marvin-round-45pt-slash.png":"cleverapps/res/common/fonts/marvin-round/45pt/slash.png","#%n-marvin-round-45pt-plus.png":"cleverapps/res/common/fonts/marvin-round/45pt/plus.png","#%n-marvin-round-45pt-minus.png":"cleverapps/res/common/fonts/marvin-round/45pt/minus.png","#%n-marvin-round-45pt-x.png":"cleverapps/res/common/fonts/marvin-round/45pt/x.png","#%n-marvin-round-45pt-space.png":"cleverapps/res/common/fonts/marvin-round/45pt/space.png","#%n-marvin-round-62pt-0.png":"cleverapps/res/common/fonts/marvin-round/62pt/0.png","#%n-marvin-round-62pt-1.png":"cleverapps/res/common/fonts/marvin-round/62pt/1.png","#%n-marvin-round-62pt-2.png":"cleverapps/res/common/fonts/marvin-round/62pt/2.png","#%n-marvin-round-62pt-3.png":"cleverapps/res/common/fonts/marvin-round/62pt/3.png","#%n-marvin-round-62pt-4.png":"cleverapps/res/common/fonts/marvin-round/62pt/4.png","#%n-marvin-round-62pt-5.png":"cleverapps/res/common/fonts/marvin-round/62pt/5.png",
"#%n-marvin-round-62pt-6.png":"cleverapps/res/common/fonts/marvin-round/62pt/6.png","#%n-marvin-round-62pt-7.png":"cleverapps/res/common/fonts/marvin-round/62pt/7.png","#%n-marvin-round-62pt-8.png":"cleverapps/res/common/fonts/marvin-round/62pt/8.png","#%n-marvin-round-62pt-9.png":"cleverapps/res/common/fonts/marvin-round/62pt/9.png","#%n-marvin-round-62pt-colon.png":"cleverapps/res/common/fonts/marvin-round/62pt/colon.png","#%n-marvin-round-62pt-slash.png":"cleverapps/res/common/fonts/marvin-round/62pt/slash.png","#%n-marvin-round-62pt-plus.png":"cleverapps/res/common/fonts/marvin-round/62pt/plus.png","#%n-marvin-round-62pt-minus.png":"cleverapps/res/common/fonts/marvin-round/62pt/minus.png","#%n-marvin-round-62pt-x.png":"cleverapps/res/common/fonts/marvin-round/62pt/x.png","#%n-marvin-round-62pt-space.png":"cleverapps/res/common/fonts/marvin-round/62pt/space.png","#%n-marvin-round-76pt-0.png":"cleverapps/res/common/fonts/marvin-round/76pt/0.png",
"#%n-marvin-round-76pt-1.png":"cleverapps/res/common/fonts/marvin-round/76pt/1.png","#%n-marvin-round-76pt-2.png":"cleverapps/res/common/fonts/marvin-round/76pt/2.png","#%n-marvin-round-76pt-3.png":"cleverapps/res/common/fonts/marvin-round/76pt/3.png","#%n-marvin-round-76pt-4.png":"cleverapps/res/common/fonts/marvin-round/76pt/4.png","#%n-marvin-round-76pt-5.png":"cleverapps/res/common/fonts/marvin-round/76pt/5.png","#%n-marvin-round-76pt-6.png":"cleverapps/res/common/fonts/marvin-round/76pt/6.png","#%n-marvin-round-76pt-7.png":"cleverapps/res/common/fonts/marvin-round/76pt/7.png","#%n-marvin-round-76pt-8.png":"cleverapps/res/common/fonts/marvin-round/76pt/8.png","#%n-marvin-round-76pt-9.png":"cleverapps/res/common/fonts/marvin-round/76pt/9.png","#%n-marvin-round-76pt-colon.png":"cleverapps/res/common/fonts/marvin-round/76pt/colon.png","#%n-marvin-round-76pt-slash.png":"cleverapps/res/common/fonts/marvin-round/76pt/slash.png",
"#%n-marvin-round-76pt-plus.png":"cleverapps/res/common/fonts/marvin-round/76pt/plus.png","#%n-marvin-round-76pt-minus.png":"cleverapps/res/common/fonts/marvin-round/76pt/minus.png","#%n-marvin-round-76pt-x.png":"cleverapps/res/common/fonts/marvin-round/76pt/x.png","#%n-marvin-round-76pt-space.png":"cleverapps/res/common/fonts/marvin-round/76pt/space.png"},bonus_world_summer:{"#%n-marvin-round-nostroke-62pt-0.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/0.png","#%n-marvin-round-nostroke-62pt-1.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/1.png","#%n-marvin-round-nostroke-62pt-2.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/2.png","#%n-marvin-round-nostroke-62pt-3.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/3.png","#%n-marvin-round-nostroke-62pt-4.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/4.png","#%n-marvin-round-nostroke-62pt-5.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/5.png",
"#%n-marvin-round-nostroke-62pt-6.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/6.png","#%n-marvin-round-nostroke-62pt-7.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/7.png","#%n-marvin-round-nostroke-62pt-8.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/8.png","#%n-marvin-round-nostroke-62pt-9.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/9.png","#%n-marvin-round-nostroke-62pt-colon.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/colon.png","#%n-marvin-round-nostroke-62pt-slash.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/slash.png","#%n-marvin-round-nostroke-62pt-plus.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/plus.png","#%n-marvin-round-nostroke-62pt-minus.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/minus.png","#%n-marvin-round-nostroke-62pt-x.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/x.png",
"#%n-marvin-round-nostroke-62pt-space.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/space.png","#%n-marvin-round-45pt-0.png":"cleverapps/res/common/fonts/marvin-round/45pt/0.png","#%n-marvin-round-45pt-1.png":"cleverapps/res/common/fonts/marvin-round/45pt/1.png","#%n-marvin-round-45pt-2.png":"cleverapps/res/common/fonts/marvin-round/45pt/2.png","#%n-marvin-round-45pt-3.png":"cleverapps/res/common/fonts/marvin-round/45pt/3.png","#%n-marvin-round-45pt-4.png":"cleverapps/res/common/fonts/marvin-round/45pt/4.png","#%n-marvin-round-45pt-5.png":"cleverapps/res/common/fonts/marvin-round/45pt/5.png","#%n-marvin-round-45pt-6.png":"cleverapps/res/common/fonts/marvin-round/45pt/6.png","#%n-marvin-round-45pt-7.png":"cleverapps/res/common/fonts/marvin-round/45pt/7.png","#%n-marvin-round-45pt-8.png":"cleverapps/res/common/fonts/marvin-round/45pt/8.png","#%n-marvin-round-45pt-9.png":"cleverapps/res/common/fonts/marvin-round/45pt/9.png",
"#%n-marvin-round-45pt-colon.png":"cleverapps/res/common/fonts/marvin-round/45pt/colon.png","#%n-marvin-round-45pt-slash.png":"cleverapps/res/common/fonts/marvin-round/45pt/slash.png","#%n-marvin-round-45pt-plus.png":"cleverapps/res/common/fonts/marvin-round/45pt/plus.png","#%n-marvin-round-45pt-minus.png":"cleverapps/res/common/fonts/marvin-round/45pt/minus.png","#%n-marvin-round-45pt-x.png":"cleverapps/res/common/fonts/marvin-round/45pt/x.png","#%n-marvin-round-45pt-space.png":"cleverapps/res/common/fonts/marvin-round/45pt/space.png","#%n-marvin-round-62pt-0.png":"cleverapps/res/common/fonts/marvin-round/62pt/0.png","#%n-marvin-round-62pt-1.png":"cleverapps/res/common/fonts/marvin-round/62pt/1.png","#%n-marvin-round-62pt-2.png":"cleverapps/res/common/fonts/marvin-round/62pt/2.png","#%n-marvin-round-62pt-3.png":"cleverapps/res/common/fonts/marvin-round/62pt/3.png","#%n-marvin-round-62pt-4.png":"cleverapps/res/common/fonts/marvin-round/62pt/4.png",
"#%n-marvin-round-62pt-5.png":"cleverapps/res/common/fonts/marvin-round/62pt/5.png","#%n-marvin-round-62pt-6.png":"cleverapps/res/common/fonts/marvin-round/62pt/6.png","#%n-marvin-round-62pt-7.png":"cleverapps/res/common/fonts/marvin-round/62pt/7.png","#%n-marvin-round-62pt-8.png":"cleverapps/res/common/fonts/marvin-round/62pt/8.png","#%n-marvin-round-62pt-9.png":"cleverapps/res/common/fonts/marvin-round/62pt/9.png","#%n-marvin-round-62pt-colon.png":"cleverapps/res/common/fonts/marvin-round/62pt/colon.png","#%n-marvin-round-62pt-slash.png":"cleverapps/res/common/fonts/marvin-round/62pt/slash.png","#%n-marvin-round-62pt-plus.png":"cleverapps/res/common/fonts/marvin-round/62pt/plus.png","#%n-marvin-round-62pt-minus.png":"cleverapps/res/common/fonts/marvin-round/62pt/minus.png","#%n-marvin-round-62pt-x.png":"cleverapps/res/common/fonts/marvin-round/62pt/x.png","#%n-marvin-round-62pt-space.png":"cleverapps/res/common/fonts/marvin-round/62pt/space.png",
"#%n-marvin-round-76pt-0.png":"cleverapps/res/common/fonts/marvin-round/76pt/0.png","#%n-marvin-round-76pt-1.png":"cleverapps/res/common/fonts/marvin-round/76pt/1.png","#%n-marvin-round-76pt-2.png":"cleverapps/res/common/fonts/marvin-round/76pt/2.png","#%n-marvin-round-76pt-3.png":"cleverapps/res/common/fonts/marvin-round/76pt/3.png","#%n-marvin-round-76pt-4.png":"cleverapps/res/common/fonts/marvin-round/76pt/4.png","#%n-marvin-round-76pt-5.png":"cleverapps/res/common/fonts/marvin-round/76pt/5.png","#%n-marvin-round-76pt-6.png":"cleverapps/res/common/fonts/marvin-round/76pt/6.png","#%n-marvin-round-76pt-7.png":"cleverapps/res/common/fonts/marvin-round/76pt/7.png","#%n-marvin-round-76pt-8.png":"cleverapps/res/common/fonts/marvin-round/76pt/8.png","#%n-marvin-round-76pt-9.png":"cleverapps/res/common/fonts/marvin-round/76pt/9.png","#%n-marvin-round-76pt-colon.png":"cleverapps/res/common/fonts/marvin-round/76pt/colon.png",
"#%n-marvin-round-76pt-slash.png":"cleverapps/res/common/fonts/marvin-round/76pt/slash.png","#%n-marvin-round-76pt-plus.png":"cleverapps/res/common/fonts/marvin-round/76pt/plus.png","#%n-marvin-round-76pt-minus.png":"cleverapps/res/common/fonts/marvin-round/76pt/minus.png","#%n-marvin-round-76pt-x.png":"cleverapps/res/common/fonts/marvin-round/76pt/x.png","#%n-marvin-round-76pt-space.png":"cleverapps/res/common/fonts/marvin-round/76pt/space.png"},bonus_world_valentines:{"#%n-marvin-round-nostroke-62pt-0.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/0.png","#%n-marvin-round-nostroke-62pt-1.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/1.png","#%n-marvin-round-nostroke-62pt-2.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/2.png","#%n-marvin-round-nostroke-62pt-3.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/3.png","#%n-marvin-round-nostroke-62pt-4.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/4.png",
"#%n-marvin-round-nostroke-62pt-5.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/5.png","#%n-marvin-round-nostroke-62pt-6.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/6.png","#%n-marvin-round-nostroke-62pt-7.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/7.png","#%n-marvin-round-nostroke-62pt-8.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/8.png","#%n-marvin-round-nostroke-62pt-9.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/9.png","#%n-marvin-round-nostroke-62pt-colon.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/colon.png","#%n-marvin-round-nostroke-62pt-slash.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/slash.png","#%n-marvin-round-nostroke-62pt-plus.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/plus.png","#%n-marvin-round-nostroke-62pt-minus.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/minus.png",
"#%n-marvin-round-nostroke-62pt-x.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/x.png","#%n-marvin-round-nostroke-62pt-space.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/space.png","#%n-marvin-round-45pt-0.png":"cleverapps/res/common/fonts/marvin-round/45pt/0.png","#%n-marvin-round-45pt-1.png":"cleverapps/res/common/fonts/marvin-round/45pt/1.png","#%n-marvin-round-45pt-2.png":"cleverapps/res/common/fonts/marvin-round/45pt/2.png","#%n-marvin-round-45pt-3.png":"cleverapps/res/common/fonts/marvin-round/45pt/3.png","#%n-marvin-round-45pt-4.png":"cleverapps/res/common/fonts/marvin-round/45pt/4.png","#%n-marvin-round-45pt-5.png":"cleverapps/res/common/fonts/marvin-round/45pt/5.png","#%n-marvin-round-45pt-6.png":"cleverapps/res/common/fonts/marvin-round/45pt/6.png","#%n-marvin-round-45pt-7.png":"cleverapps/res/common/fonts/marvin-round/45pt/7.png","#%n-marvin-round-45pt-8.png":"cleverapps/res/common/fonts/marvin-round/45pt/8.png",
"#%n-marvin-round-45pt-9.png":"cleverapps/res/common/fonts/marvin-round/45pt/9.png","#%n-marvin-round-45pt-colon.png":"cleverapps/res/common/fonts/marvin-round/45pt/colon.png","#%n-marvin-round-45pt-slash.png":"cleverapps/res/common/fonts/marvin-round/45pt/slash.png","#%n-marvin-round-45pt-plus.png":"cleverapps/res/common/fonts/marvin-round/45pt/plus.png","#%n-marvin-round-45pt-minus.png":"cleverapps/res/common/fonts/marvin-round/45pt/minus.png","#%n-marvin-round-45pt-x.png":"cleverapps/res/common/fonts/marvin-round/45pt/x.png","#%n-marvin-round-45pt-space.png":"cleverapps/res/common/fonts/marvin-round/45pt/space.png","#%n-marvin-round-62pt-0.png":"cleverapps/res/common/fonts/marvin-round/62pt/0.png","#%n-marvin-round-62pt-1.png":"cleverapps/res/common/fonts/marvin-round/62pt/1.png","#%n-marvin-round-62pt-2.png":"cleverapps/res/common/fonts/marvin-round/62pt/2.png","#%n-marvin-round-62pt-3.png":"cleverapps/res/common/fonts/marvin-round/62pt/3.png",
"#%n-marvin-round-62pt-4.png":"cleverapps/res/common/fonts/marvin-round/62pt/4.png","#%n-marvin-round-62pt-5.png":"cleverapps/res/common/fonts/marvin-round/62pt/5.png","#%n-marvin-round-62pt-6.png":"cleverapps/res/common/fonts/marvin-round/62pt/6.png","#%n-marvin-round-62pt-7.png":"cleverapps/res/common/fonts/marvin-round/62pt/7.png","#%n-marvin-round-62pt-8.png":"cleverapps/res/common/fonts/marvin-round/62pt/8.png","#%n-marvin-round-62pt-9.png":"cleverapps/res/common/fonts/marvin-round/62pt/9.png","#%n-marvin-round-62pt-colon.png":"cleverapps/res/common/fonts/marvin-round/62pt/colon.png","#%n-marvin-round-62pt-slash.png":"cleverapps/res/common/fonts/marvin-round/62pt/slash.png","#%n-marvin-round-62pt-plus.png":"cleverapps/res/common/fonts/marvin-round/62pt/plus.png","#%n-marvin-round-62pt-minus.png":"cleverapps/res/common/fonts/marvin-round/62pt/minus.png","#%n-marvin-round-62pt-x.png":"cleverapps/res/common/fonts/marvin-round/62pt/x.png",
"#%n-marvin-round-62pt-space.png":"cleverapps/res/common/fonts/marvin-round/62pt/space.png","#%n-marvin-round-76pt-0.png":"cleverapps/res/common/fonts/marvin-round/76pt/0.png","#%n-marvin-round-76pt-1.png":"cleverapps/res/common/fonts/marvin-round/76pt/1.png","#%n-marvin-round-76pt-2.png":"cleverapps/res/common/fonts/marvin-round/76pt/2.png","#%n-marvin-round-76pt-3.png":"cleverapps/res/common/fonts/marvin-round/76pt/3.png","#%n-marvin-round-76pt-4.png":"cleverapps/res/common/fonts/marvin-round/76pt/4.png","#%n-marvin-round-76pt-5.png":"cleverapps/res/common/fonts/marvin-round/76pt/5.png","#%n-marvin-round-76pt-6.png":"cleverapps/res/common/fonts/marvin-round/76pt/6.png","#%n-marvin-round-76pt-7.png":"cleverapps/res/common/fonts/marvin-round/76pt/7.png","#%n-marvin-round-76pt-8.png":"cleverapps/res/common/fonts/marvin-round/76pt/8.png","#%n-marvin-round-76pt-9.png":"cleverapps/res/common/fonts/marvin-round/76pt/9.png",
"#%n-marvin-round-76pt-colon.png":"cleverapps/res/common/fonts/marvin-round/76pt/colon.png","#%n-marvin-round-76pt-slash.png":"cleverapps/res/common/fonts/marvin-round/76pt/slash.png","#%n-marvin-round-76pt-plus.png":"cleverapps/res/common/fonts/marvin-round/76pt/plus.png","#%n-marvin-round-76pt-minus.png":"cleverapps/res/common/fonts/marvin-round/76pt/minus.png","#%n-marvin-round-76pt-x.png":"cleverapps/res/common/fonts/marvin-round/76pt/x.png","#%n-marvin-round-76pt-space.png":"cleverapps/res/common/fonts/marvin-round/76pt/space.png"},bonusworkerwindow:{},boosters_before:{},boosters_sale:{},browser_resources:{},buildable:{},buttons:{},buttons_main:{},buyfogwindow:{"#%n-orderswindow-icon_background.png":"cleverapps/res/mergecraft/game/ui/orderswindow/icon_background.png","@jsons/mediterranean_cay-3db7e4bcea.json":"cleverapps/res/mergecraft/game/ui/mediterranean_cay/mediterranean_cay.json"},castle:{},centerhint:{},chat:{
"#%n-dialog_box.png":"cleverapps/res/ui/plaid/chat/dialog_box.png","#%n-dialog_box_2.png":"cleverapps/res/ui/plaid/chat/dialog_box_2.png","#%n-icon_back.png":"cleverapps/res/ui/plaid/chat/icon_back.png","#%n-panel_off.png":"cleverapps/res/ui/plaid/chat/panel_off.png","#%n-panel_on.png":"cleverapps/res/ui/plaid/chat/panel_on.png","#%n-panelup.png":"cleverapps/res/ui/plaid/chat/panelup.png","#%n-paneldown.png":"cleverapps/res/ui/plaid/chat/paneldown.png","#%n-textbox.png":"cleverapps/res/ui/plaid/chat/textbox.png","#%n-checkmark_0.png":"cleverapps/res/ui/plaid/chat/checkmark_0.png","#%n-checkmark_1.png":"cleverapps/res/ui/plaid/chat/checkmark_1.png","#%n-checkmark_2.png":"cleverapps/res/ui/plaid/chat/checkmark_2.png","#%n-checkmark_yes.png":"cleverapps/res/ui/plaid/chat/checkmark_yes.png","#%n-gift_bg.png":"cleverapps/res/ui/plaid/chat/gift_bg.png","#%n-button_accept.png":"cleverapps/res/ui/plaid/chat/button_accept.png",
"#%n-button_accept_press.png":"cleverapps/res/ui/plaid/chat/button_accept_press.png","#%n-no_button.png":"cleverapps/res/ui/plaid/chat/no_button.png","#%n-no_button_press.png":"cleverapps/res/ui/plaid/chat/no_button_press.png"},chests:{},collectible:{},combo_background:{},confirmexit_window:{},controlbuttons:{},cryptex:{},daily_cup:{},daily_minigame_window:{},dailytasks:{"#%n-dailytask_fb_icon.png":"cleverapps/res/bundles/dailytasks/dailytask_fb_icon.png","#%n-icon1.png":"cleverapps/res/mergecraft/dailytasks/icon1.png","#%n-icon2.png":"cleverapps/res/mergecraft/dailytasks/icon2.png","#%n-icon3.png":"cleverapps/res/mergecraft/dailytasks/icon3.png","#%n-level_open.png":"cleverapps/res/mergecraft/dailytasks/level_open.png","#%n-free_moves_friends.png":"cleverapps/res/mergecraft/dailytasks/free_moves_friends.png","#%n-adicon.png":"cleverapps/res/mergecraft/dailytasks/adicon.png","#%n-coin_task.png":"cleverapps/res/mergecraft/dailytasks/coin_task.png",
"#%n-hint_task.png":"cleverapps/res/mergecraft/dailytasks/hint_task.png","#%n-episode_task.png":"cleverapps/res/mergecraft/dailytasks/episode_task.png","#%n-gift_task.png":"cleverapps/res/mergecraft/dailytasks/gift_task.png","#%n-overtake_task.png":"cleverapps/res/mergecraft/dailytasks/overtake_task.png","#%n-bonus_task.png":"cleverapps/res/mergecraft/dailytasks/bonus_task.png","#%n-mission-easy_frame_1.png":"cleverapps/res/mergecraft/windows/mission/easy_frame_1.png","#%n-mission-medium_frame_1.png":"cleverapps/res/mergecraft/windows/mission/medium_frame_1.png","#%n-mission-hard_frame_1.png":"cleverapps/res/mergecraft/windows/mission/hard_frame_1.png","#%n-mission-frame_white.png":"cleverapps/res/mergecraft/windows/mission/frame_white.png","#%n-mission-frame_green.png":"cleverapps/res/mergecraft/windows/mission/frame_green.png","#%n-dailytask_icon_bg.png":"cleverapps/res/mergecraft/dailytasks/dailytask_icon_bg.png",
"#%n-mission-easy_top_1.png":"cleverapps/res/mergecraft/windows/mission/easy_top_1.png","#%n-mission-medium_top_1.png":"cleverapps/res/mergecraft/windows/mission/medium_top_1.png","#%n-mission-hard_top_1.png":"cleverapps/res/mergecraft/windows/mission/hard_top_1.png"},dev_resources:{"#%n-border_2px.png":"cleverapps/res/bundles/dev_resources/border_2px.png","#%n-modes_slider_bg.png":"cleverapps/res/bundles/dev_resources/modes_slider_bg.png","#%n-modes_slider_selected.png":"cleverapps/res/bundles/dev_resources/modes_slider_selected.png"},dialogues:{},dialogues_minimal:{"#%n-dialogues-bg.png":"cleverapps/res/mergecraft/bundles/dialogues/bg.png","@jsons/dwarf_minimal-de8f7ab500.json":"cleverapps/res/mergecraft/bundles/dialogues/dwarf_minimal/dwarf_minimal.json","@jsons/worker_minimal-371af214fc.json":"cleverapps/res/mergecraft/bundles/dialogues/worker_minimal/worker_minimal.json",
"@jsons/king_minimal-58263414df.json":"cleverapps/res/mergecraft/bundles/dialogues/king_minimal/king_minimal.json","@jsons/bear_minimal-c0a1142c83.json":"cleverapps/res/mergecraft/bundles/dialogues/bear_minimal/bear_minimal.json","@jsons/elf_minimal-6aa3492faa.json":"cleverapps/res/mergecraft/bundles/dialogues/elf_minimal/elf_minimal.json","@jsons/warlock_minimal-01d7adcdfb.json":"cleverapps/res/mergecraft/bundles/dialogues/warlock_minimal/warlock_minimal.json","@jsons/troll_minimal-e250aba704.json":"cleverapps/res/mergecraft/bundles/dialogues/troll_minimal/troll_minimal.json"},digits:{},discreteprogress:{},easter:{},editor:{"#%n-admin-regular_button.png":"cleverapps/res/admin/regular_button.png","#%n-%n_select.png":"cleverapps/res/editor/editor_select.png","#%n-%n_button_off.png":"cleverapps/res/editor/editor_button_off.png","#%n-%n_button_on.png":"cleverapps/res/editor/editor_button_on.png","#%n-%n_clear.png":"cleverapps/res/editor/editor_clear.png",
"#%n-%n_play.png":"cleverapps/res/editor/editor_play.png","#%n-undo.png":"cleverapps/res/editor/undo.png","#%n-%n_arrow_left.png":"cleverapps/res/editor/editor_arrow_left.png","#%n-%n_arrow_right.png":"cleverapps/res/editor/editor_arrow_right.png","#%n-%n_arrow_up.png":"cleverapps/res/editor/editor_arrow_up.png","#%n-%n_arrow_down.png":"cleverapps/res/editor/editor_arrow_down.png","#%n-%n_plus.png":"cleverapps/res/editor/editor_plus.png","#%n-%n_minus.png":"cleverapps/res/editor/editor_minus.png","#%n-%n_cards_button_off.png":"cleverapps/res/editor/editor_cards_button_off.png","#%n-%n_cards_button_on.png":"cleverapps/res/editor/editor_cards_button_on.png"},energy_feast:{"@jsons/%n-2ae1a644cb.json":"cleverapps/res/mergecraft/bundles/energy_feast/energy_feast.json","@jsons/%n_rules-c5e4a9a4ce.json":"cleverapps/res/mergecraft/bundles/energy_feast_rules/energy_feast_rules.json",
"@jsons/energyfeastmissionwindow-10519fded8.json":"cleverapps/res/mergecraft/game/ui/energyfeastmissionwindow/energyfeastmissionwindow.json","@jsons/energy_bug-9631723f88.json":"cleverapps/res/mergecraft/game/ui/energyfeastmissionwindow/energy_bug.json","@jsons/energy_bug_midle-378cad2860.json":"cleverapps/res/mergecraft/game/ui/energyfeastmissionwindow/energy_bug_midle.json","@jsons/energy_bug_mini-4bbd959009.json":"cleverapps/res/mergecraft/game/ui/energyfeastmissionwindow/energy_bug_mini.json"},energylotterywindow:{"@jsons/lottery_window-e23d1bab1e.json":"cleverapps/res/mergecraft/game/ui/energylotterywindow/lottery_window.json","@jsons/lottery_target-058e7bc2c4.json":"cleverapps/res/mergecraft/game/ui/energylotterywindow/lottery_target.json","@jsons/lottery_target_axe-8b315d2d86.json":"cleverapps/res/mergecraft/game/ui/energylotterywindow/lottery_target_axe.json","~sounds/lottery_open-9b80fced7f.mp3":"cleverapps/res/mergecraft/sfx/game/lottery_open.mp3"},energyup:{},episode_0:{},
episode_ads:{},episode_coming_soon:{},episode_editor:{},episode_tests:{},exclamations:{},extrawindow:{},favorite_sale:{"#%n-plus_big.png":"cleverapps/res/mergecraft/bundles/favorite_sale/plus_big.png"},finger:{},finish_episode_0:{},finish_episode_0_ru:{},finish_episode_1:{},finish_episode_1_ru:{},finish_episode_window:{},fireworks:{},flying:{},fog:{},fruit:{},game:{"#%n-rate-star.png":"cleverapps/res/mergecraft/windows/rate/star.png","#%n-missions-mission_star_0.png":"cleverapps/res/mergecraft/missions/mission_star_0.png","#%n-missions-mission_star_1.png":"cleverapps/res/mergecraft/missions/mission_star_1.png","#%n-shared-adicon.png":"cleverapps/res/mergecraft/shared/adicon.png","#%n-tutorial-circle.png":"cleverapps/res/mergecraft/tutorial/circle.png","#%n-tutorial-hand.png":"cleverapps/res/mergecraft/tutorial/hand.png","#%n-marvin-round-nostroke-62pt-0.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/0.png",
"#%n-marvin-round-nostroke-62pt-1.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/1.png","#%n-marvin-round-nostroke-62pt-2.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/2.png","#%n-marvin-round-nostroke-62pt-3.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/3.png","#%n-marvin-round-nostroke-62pt-4.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/4.png","#%n-marvin-round-nostroke-62pt-5.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/5.png","#%n-marvin-round-nostroke-62pt-6.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/6.png","#%n-marvin-round-nostroke-62pt-7.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/7.png","#%n-marvin-round-nostroke-62pt-8.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/8.png","#%n-marvin-round-nostroke-62pt-9.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/9.png",
"#%n-marvin-round-nostroke-62pt-colon.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/colon.png","#%n-marvin-round-nostroke-62pt-slash.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/slash.png","#%n-marvin-round-nostroke-62pt-plus.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/plus.png","#%n-marvin-round-nostroke-62pt-minus.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/minus.png","#%n-marvin-round-nostroke-62pt-x.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/x.png","#%n-marvin-round-nostroke-62pt-space.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/space.png","#%n-marvin-round-45pt-0.png":"cleverapps/res/common/fonts/marvin-round/45pt/0.png","#%n-marvin-round-45pt-1.png":"cleverapps/res/common/fonts/marvin-round/45pt/1.png","#%n-marvin-round-45pt-2.png":"cleverapps/res/common/fonts/marvin-round/45pt/2.png","#%n-marvin-round-45pt-3.png":"cleverapps/res/common/fonts/marvin-round/45pt/3.png",
"#%n-marvin-round-45pt-4.png":"cleverapps/res/common/fonts/marvin-round/45pt/4.png","#%n-marvin-round-45pt-5.png":"cleverapps/res/common/fonts/marvin-round/45pt/5.png","#%n-marvin-round-45pt-6.png":"cleverapps/res/common/fonts/marvin-round/45pt/6.png","#%n-marvin-round-45pt-7.png":"cleverapps/res/common/fonts/marvin-round/45pt/7.png","#%n-marvin-round-45pt-8.png":"cleverapps/res/common/fonts/marvin-round/45pt/8.png","#%n-marvin-round-45pt-9.png":"cleverapps/res/common/fonts/marvin-round/45pt/9.png","#%n-marvin-round-45pt-colon.png":"cleverapps/res/common/fonts/marvin-round/45pt/colon.png","#%n-marvin-round-45pt-slash.png":"cleverapps/res/common/fonts/marvin-round/45pt/slash.png","#%n-marvin-round-45pt-plus.png":"cleverapps/res/common/fonts/marvin-round/45pt/plus.png","#%n-marvin-round-45pt-minus.png":"cleverapps/res/common/fonts/marvin-round/45pt/minus.png","#%n-marvin-round-45pt-x.png":"cleverapps/res/common/fonts/marvin-round/45pt/x.png",
"#%n-marvin-round-45pt-space.png":"cleverapps/res/common/fonts/marvin-round/45pt/space.png","#%n-marvin-round-62pt-0.png":"cleverapps/res/common/fonts/marvin-round/62pt/0.png","#%n-marvin-round-62pt-1.png":"cleverapps/res/common/fonts/marvin-round/62pt/1.png","#%n-marvin-round-62pt-2.png":"cleverapps/res/common/fonts/marvin-round/62pt/2.png","#%n-marvin-round-62pt-3.png":"cleverapps/res/common/fonts/marvin-round/62pt/3.png","#%n-marvin-round-62pt-4.png":"cleverapps/res/common/fonts/marvin-round/62pt/4.png","#%n-marvin-round-62pt-5.png":"cleverapps/res/common/fonts/marvin-round/62pt/5.png","#%n-marvin-round-62pt-6.png":"cleverapps/res/common/fonts/marvin-round/62pt/6.png","#%n-marvin-round-62pt-7.png":"cleverapps/res/common/fonts/marvin-round/62pt/7.png","#%n-marvin-round-62pt-8.png":"cleverapps/res/common/fonts/marvin-round/62pt/8.png","#%n-marvin-round-62pt-9.png":"cleverapps/res/common/fonts/marvin-round/62pt/9.png",
"#%n-marvin-round-62pt-colon.png":"cleverapps/res/common/fonts/marvin-round/62pt/colon.png","#%n-marvin-round-62pt-slash.png":"cleverapps/res/common/fonts/marvin-round/62pt/slash.png","#%n-marvin-round-62pt-plus.png":"cleverapps/res/common/fonts/marvin-round/62pt/plus.png","#%n-marvin-round-62pt-minus.png":"cleverapps/res/common/fonts/marvin-round/62pt/minus.png","#%n-marvin-round-62pt-x.png":"cleverapps/res/common/fonts/marvin-round/62pt/x.png","#%n-marvin-round-62pt-space.png":"cleverapps/res/common/fonts/marvin-round/62pt/space.png","#%n-marvin-round-76pt-0.png":"cleverapps/res/common/fonts/marvin-round/76pt/0.png","#%n-marvin-round-76pt-1.png":"cleverapps/res/common/fonts/marvin-round/76pt/1.png","#%n-marvin-round-76pt-2.png":"cleverapps/res/common/fonts/marvin-round/76pt/2.png","#%n-marvin-round-76pt-3.png":"cleverapps/res/common/fonts/marvin-round/76pt/3.png","#%n-marvin-round-76pt-4.png":"cleverapps/res/common/fonts/marvin-round/76pt/4.png",
"#%n-marvin-round-76pt-5.png":"cleverapps/res/common/fonts/marvin-round/76pt/5.png","#%n-marvin-round-76pt-6.png":"cleverapps/res/common/fonts/marvin-round/76pt/6.png","#%n-marvin-round-76pt-7.png":"cleverapps/res/common/fonts/marvin-round/76pt/7.png","#%n-marvin-round-76pt-8.png":"cleverapps/res/common/fonts/marvin-round/76pt/8.png","#%n-marvin-round-76pt-9.png":"cleverapps/res/common/fonts/marvin-round/76pt/9.png","#%n-marvin-round-76pt-colon.png":"cleverapps/res/common/fonts/marvin-round/76pt/colon.png","#%n-marvin-round-76pt-slash.png":"cleverapps/res/common/fonts/marvin-round/76pt/slash.png","#%n-marvin-round-76pt-plus.png":"cleverapps/res/common/fonts/marvin-round/76pt/plus.png","#%n-marvin-round-76pt-minus.png":"cleverapps/res/common/fonts/marvin-round/76pt/minus.png","#%n-marvin-round-76pt-x.png":"cleverapps/res/common/fonts/marvin-round/76pt/x.png","#%n-marvin-round-76pt-space.png":"cleverapps/res/common/fonts/marvin-round/76pt/space.png",
"#%n-controlbuttons-menu.png":"cleverapps/res/mergecraft/controlbuttons/menu.png","#%n-controlbuttons-menu_button.png":"cleverapps/res/mergecraft/controlbuttons/menu_button.png","#%n-controlbuttons-menu_button_on.png":"cleverapps/res/mergecraft/controlbuttons/menu_button_on.png","#%n-controlbuttons-fullscreen_icon.png":"cleverapps/res/mergecraft/controlbuttons/fullscreen_icon.png","#%n-controlbuttons-back_button.png":"cleverapps/res/mergecraft/controlbuttons/back_button.png","#%n-controlbuttons-back_button_on.png":"cleverapps/res/mergecraft/controlbuttons/back_button_on.png","#%n-controlbuttons-back.png":"cleverapps/res/mergecraft/controlbuttons/back.png","#%n-menubar-energy.png":"cleverapps/res/mergecraft/menubar/energy.png","#%n-menubar-ruby.png":"cleverapps/res/mergecraft/menubar/ruby.png","#%n-menubar-bar_bg.png":"cleverapps/res/mergecraft/menubar/bar_bg.png","#%n-menubar-plus.png":"cleverapps/res/mergecraft/menubar/plus.png",
"#%n-menubar-plus_on.png":"cleverapps/res/mergecraft/menubar/plus_on.png","#%n-menubar-bar_timer.png":"cleverapps/res/mergecraft/menubar/bar_timer.png","#%n-menubar-timer.png":"cleverapps/res/mergecraft/menubar/timer.png","#%n-orderswindow-attention_exclamation_large.png":"cleverapps/res/mergecraft/game/ui/orderswindow/attention_exclamation_large.png","#%n-level-progressbar.png":"cleverapps/res/mergecraft/level/progressbar.png","#%n-level-level_round.png":"cleverapps/res/mergecraft/level/level_round.png","#%n-menubar-coin.png":"cleverapps/res/mergecraft/menubar/coin.png","#%n-menubar-wand.png":"cleverapps/res/mergecraft/menubar/wand.png","#%n-menubar-worker.png":"cleverapps/res/mergecraft/menubar/worker.png","#%n-buttons-button.png":"cleverapps/res/mergecraft/buttons/button.png","#%n-buttons-button_on.png":"cleverapps/res/mergecraft/buttons/button_on.png","#%n-buttons-button_off.png":"cleverapps/res/mergecraft/buttons/button_off.png",
"#%n-buttons-button_blue.png":"cleverapps/res/mergecraft/buttons/button_blue.png","#%n-buttons-button_blue_on.png":"cleverapps/res/mergecraft/buttons/button_blue_on.png","#%n-buttons-small_blue_button.png":"cleverapps/res/mergecraft/buttons/small_blue_button.png","#%n-buttons-small_blue_button_on.png":"cleverapps/res/mergecraft/buttons/small_blue_button_on.png","#%n-sidebar-icon_bg.png":"cleverapps/res/mergecraft/sidebar/icon_bg.png","#%n-sidebar-lock_sidebar.png":"cleverapps/res/bundles/sidebar/lock_sidebar.png","#%n-sidebar-icon_text_bg.png":"cleverapps/res/mergecraft/sidebar/icon_text_bg.png","#%n-%n_message-level_msg_bg.png":"cleverapps/res/mergecraft/bundles/game_message/level_msg_bg.png","#%n-woodsource-grounded.png":"cleverapps/res/mergecraft/game/units/woodsource/grounded.png","#%n-woodgenerator-star_on.png":"cleverapps/res/mergecraft/game/units/woodgenerator/star_on.png","#%n-woodgenerator-star_off.png":"cleverapps/res/mergecraft/game/units/woodgenerator/star_off.png",
"#%n-bar.png":"cleverapps/res/mergecraft/game/bar.png","#%n-bar_bg.png":"cleverapps/res/mergecraft/game/bar_bg.png","#%n-dragonmine-pickaxe.png":"cleverapps/res/mergecraft/game/units/dragonmine/pickaxe.png","#%n-ui-seller_icon.png":"cleverapps/res/mergecraft/game/ui/seller_icon.png","#%n-dialogues-bg.png":"cleverapps/res/mergecraft/bundles/dialogues/bg.png","#%n-ui-upgradable_level.png":"cleverapps/res/mergecraft/game/ui/upgradable_level.png","#%n-ui-upgradable_bar.png":"cleverapps/res/mergecraft/game/ui/upgradable_bar.png","#%n-ui-upgradable_bar_bg.png":"cleverapps/res/mergecraft/game/ui/upgradable_bar_bg.png","#%n-ui-guide_button.png":"cleverapps/res/mergecraft/game/ui/guide_button.png","#%n-ui-guide_button_on.png":"cleverapps/res/mergecraft/game/ui/guide_button_on.png","#%n-treasure-stage3.png":"cleverapps/res/mergecraft/game/units/treasure/stage3.png","#%n-treasure-stage2.png":"cleverapps/res/mergecraft/game/units/treasure/stage2.png",
"#%n-treasure-stage1.png":"cleverapps/res/mergecraft/game/units/treasure/stage1.png","#%n-ui-ground.png":"cleverapps/res/mergecraft/game/ui/ground.png","#%n-green-ground_1.png":"cleverapps/res/mergecraft/game/terrain/green/ground_1.png","#%n-green-ground_2.png":"cleverapps/res/mergecraft/game/terrain/green/ground_2.png","#%n-green-grow12_right.png":"cleverapps/res/mergecraft/game/terrain/green/grow12_right.png","#%n-green-grow12_left.png":"cleverapps/res/mergecraft/game/terrain/green/grow12_left.png","#%n-green-grow12_corner.png":"cleverapps/res/mergecraft/game/terrain/green/grow12_corner.png","#%n-green-grow12_both.png":"cleverapps/res/mergecraft/game/terrain/green/grow12_both.png","#%n-green-level1_up_corner.png":"cleverapps/res/mergecraft/game/terrain/green/level1_up_corner.png","#%n-green-level1_down_corner.png":"cleverapps/res/mergecraft/game/terrain/green/level1_down_corner.png",
"#%n-green-level1_left_corner.png":"cleverapps/res/mergecraft/game/terrain/green/level1_left_corner.png","#%n-green-level1_right_corner.png":"cleverapps/res/mergecraft/game/terrain/green/level1_right_corner.png","#%n-green-level2_up_corner.png":"cleverapps/res/mergecraft/game/terrain/green/level2_up_corner.png","#%n-green-level1_up_both.png":"cleverapps/res/mergecraft/game/terrain/green/level1_up_both.png","#%n-green-level1_up_right_only.png":"cleverapps/res/mergecraft/game/terrain/green/level1_up_right_only.png","#%n-green-level1_up_right_only_last.png":"cleverapps/res/mergecraft/game/terrain/green/level1_up_right_only_last.png","#%n-green-level1_up_left_only.png":"cleverapps/res/mergecraft/game/terrain/green/level1_up_left_only.png","#%n-green-level1_up_left_only_last.png":"cleverapps/res/mergecraft/game/terrain/green/level1_up_left_only_last.png","#%n-green-level2_up_both.png":"cleverapps/res/mergecraft/game/terrain/green/level2_up_both.png",
"#%n-green-level2_up_right_only.png":"cleverapps/res/mergecraft/game/terrain/green/level2_up_right_only.png","#%n-green-level2_up_right_only_last.png":"cleverapps/res/mergecraft/game/terrain/green/level2_up_right_only_last.png","#%n-green-level2_up_left_only.png":"cleverapps/res/mergecraft/game/terrain/green/level2_up_left_only.png","#%n-green-level2_up_left_only_last.png":"cleverapps/res/mergecraft/game/terrain/green/level2_up_left_only_last.png","#%n-green-level1_down_both.png":"cleverapps/res/mergecraft/game/terrain/green/level1_down_both.png","#%n-green-level1_down_right_only.png":"cleverapps/res/mergecraft/game/terrain/green/level1_down_right_only.png","#%n-green-level1_down_left_only.png":"cleverapps/res/mergecraft/game/terrain/green/level1_down_left_only.png","#%n-green-level1_left_inner.png":"cleverapps/res/mergecraft/game/terrain/green/level1_left_inner.png","#%n-green-level1_left_inner_last.png":"cleverapps/res/mergecraft/game/terrain/green/level1_left_inner_last.png",
"#%n-green-level1_right_inner.png":"cleverapps/res/mergecraft/game/terrain/green/level1_right_inner.png","#%n-green-level1_right_inner_last.png":"cleverapps/res/mergecraft/game/terrain/green/level1_right_inner_last.png","#%n-green-level2_left_inner.png":"cleverapps/res/mergecraft/game/terrain/green/level2_left_inner.png","#%n-green-level2_left_inner_last.png":"cleverapps/res/mergecraft/game/terrain/green/level2_left_inner_last.png","#%n-green-level2_right_inner.png":"cleverapps/res/mergecraft/game/terrain/green/level2_right_inner.png","#%n-green-level2_right_inner_last.png":"cleverapps/res/mergecraft/game/terrain/green/level2_right_inner_last.png","#%n-terrain-water.png":"cleverapps/res/mergecraft/game/terrain/water.png","#%n-ui-small_exclamation.png":"cleverapps/res/mergecraft/game/ui/small_exclamation.png","#%n-cloud2-cloud_1.png":"cleverapps/res/mergecraft/cloud/cloud2/cloud_1.png","#%n-cloud2-cloud_2.png":"cleverapps/res/mergecraft/cloud/cloud2/cloud_2.png",
"#%n-cloud2-cloud_down_left.png":"cleverapps/res/mergecraft/cloud/cloud2/cloud_down_left.png","#%n-cloud2-cloud_down_right.png":"cleverapps/res/mergecraft/cloud/cloud2/cloud_down_right.png","#%n-cloud2-cloud_up_left.png":"cleverapps/res/mergecraft/cloud/cloud2/cloud_up_left.png","#%n-cloud2-cloud_up_right.png":"cleverapps/res/mergecraft/cloud/cloud2/cloud_up_right.png","#%n-cloud-lock.png":"cleverapps/res/mergecraft/cloud/lock.png","#%n-cloud-lock_cloud.png":"cleverapps/res/mergecraft/cloud/lock_cloud.png","#%n-buttons-button_wand.png":"cleverapps/res/mergecraft/game/ui/buttons/button_wand.png","#%n-flying-coin.png":"cleverapps/res/mergecraft/game/flying/coin.png","#%n-flying-energy.png":"cleverapps/res/mergecraft/game/flying/energy.png","#%n-flying-wand.png":"cleverapps/res/mergecraft/game/flying/wand.png","#%n-flying-ruby.png":"cleverapps/res/mergecraft/game/flying/ruby.png","#%n-flying-exp.png":"cleverapps/res/mergecraft/game/flying/exp.png",
"#%n-ui-%n_ui_bg.png":"cleverapps/res/mergecraft/game/ui/game_ui_bg.png","#%n-infoview-%n_ui_bg2.png":"cleverapps/res/mergecraft/game/ui/infoview/game_ui_bg2.png","#%n-infoview-%n_ui_bg_pointer.png":"cleverapps/res/mergecraft/game/ui/infoview/game_ui_bg_pointer.png","#%n-infoview-%n_ui_bg_pointer_small.png":"cleverapps/res/mergecraft/game/ui/infoview/game_ui_bg_pointer_small.png","#%n-infoview-%n_ui_bg_pointer2_small.png":"cleverapps/res/mergecraft/game/ui/infoview/game_ui_bg_pointer2_small.png","#%n-ui-timer_substrate.png":"cleverapps/res/mergecraft/game/ui/timer_substrate.png","#%n-infoview-%n_ui_clock.png":"cleverapps/res/mergecraft/game/ui/infoview/game_ui_clock.png","#%n-infoview-clock_with_ribbon.png":"cleverapps/res/mergecraft/game/ui/infoview/clock_with_ribbon.png","#%n-ui-speedup_watch_icon.png":"cleverapps/res/mergecraft/game/ui/speedup_watch_icon.png","#%n-discreteprogress-bar_bg.png":"cleverapps/res/mergecraft/game/ui/discreteprogress/bar_bg.png",
"#%n-discreteprogress-stroke_dark.png":"cleverapps/res/mergecraft/game/ui/discreteprogress/stroke_dark.png","#%n-discreteprogress-bar_red.png":"cleverapps/res/mergecraft/game/ui/discreteprogress/bar_red.png","#%n-orderswindow-attention_exclamation.png":"cleverapps/res/mergecraft/game/ui/orderswindow/attention_exclamation.png","#%n-orderswindow-attention_exclamation_gray.png":"cleverapps/res/mergecraft/game/ui/orderswindow/attention_exclamation_gray.png","#%n-orderswindow-attention_ok.png":"cleverapps/res/mergecraft/game/ui/orderswindow/attention_ok.png","#%n-orderswindow-attention_ok_large.png":"cleverapps/res/mergecraft/game/ui/orderswindow/attention_ok_large.png","#%n-orderswindow-attention_exclamation_gray_large.png":"cleverapps/res/mergecraft/game/ui/orderswindow/attention_exclamation_gray_large.png","#%n-orderswindow-attention_sandglass_large.png":"cleverapps/res/mergecraft/game/ui/orderswindow/attention_sandglass_large.png",
"#%n-orderswindow-attention_coin_large.png":"cleverapps/res/mergecraft/game/ui/orderswindow/attention_coin_large.png","#%n-orderswindow-icon_background.png":"cleverapps/res/mergecraft/game/ui/orderswindow/icon_background.png","#%n-orderswindow-icon_background_light.png":"cleverapps/res/mergecraft/game/ui/orderswindow/icon_background_light.png","#%n-orderswindow-icon_background_disabled.png":"cleverapps/res/mergecraft/game/ui/orderswindow/icon_background_disabled.png","#%n-orderswindow-order_lock.png":"cleverapps/res/mergecraft/game/ui/orderswindow/order_lock.png","#%n-orderswindow-next_arrow.png":"cleverapps/res/mergecraft/game/ui/orderswindow/next_arrow.png","#%n-infoview-dwarf_head.png":"cleverapps/res/mergecraft/game/ui/infoview/dwarf_head.png","#%n-infoview-instant_dwarf_head.png":"cleverapps/res/mergecraft/game/ui/infoview/instant_dwarf_head.png","#%n-buttons-button_ruby.png":"cleverapps/res/mergecraft/game/ui/buttons/button_ruby.png",
"#%n-discreteprogress-bar_0.png":"cleverapps/res/mergecraft/game/ui/discreteprogress/bar_0.png","#%n-discreteprogress-bar_1.png":"cleverapps/res/mergecraft/game/ui/discreteprogress/bar_1.png","#%n-discreteprogress-bar_2.png":"cleverapps/res/mergecraft/game/ui/discreteprogress/bar_2.png","#%n-discreteprogress-bar_3.png":"cleverapps/res/mergecraft/game/ui/discreteprogress/bar_3.png","#%n-discreteprogress-bar_bg_small.png":"cleverapps/res/mergecraft/game/ui/discreteprogress/bar_bg_small.png","#%n-discreteprogress-stroke_white_small.png":"cleverapps/res/mergecraft/game/ui/discreteprogress/stroke_white_small.png","#%n-discreteprogress-bar_0_small.png":"cleverapps/res/mergecraft/game/ui/discreteprogress/bar_0_small.png","#%n-discreteprogress-bar_1_small.png":"cleverapps/res/mergecraft/game/ui/discreteprogress/bar_1_small.png","#%n-discreteprogress-bar_2_small.png":"cleverapps/res/mergecraft/game/ui/discreteprogress/bar_2_small.png",
"#%n-discreteprogress-bar_3_small.png":"cleverapps/res/mergecraft/game/ui/discreteprogress/bar_3_small.png","#%n-heroes-dwarf_small.png":"cleverapps/res/mergecraft/game/ui/icons/heroes/dwarf_small.png","#%n-heroes-king_small.png":"cleverapps/res/mergecraft/game/ui/icons/heroes/king_small.png","#%n-heroes-bear_small.png":"cleverapps/res/mergecraft/game/ui/icons/heroes/bear_small.png","#%n-heroes-elf_small.png":"cleverapps/res/mergecraft/game/ui/icons/heroes/elf_small.png","#%n-heroes-warlock_small.png":"cleverapps/res/mergecraft/game/ui/icons/heroes/warlock_small.png","#%n-heroes-troll_small.png":"cleverapps/res/mergecraft/game/ui/icons/heroes/troll_small.png","#%n-icons-fog.png":"cleverapps/res/mergecraft/game/ui/icons/fog.png","#%n-apple-stage1.png":"cleverapps/res/mergecraft/game/units/apple/stage1.png","#%n-apple-stage2.png":"cleverapps/res/mergecraft/game/units/apple/stage2.png","#%n-apple-stage3.png":"cleverapps/res/mergecraft/game/units/apple/stage3.png",
"#%n-apple-stage4.png":"cleverapps/res/mergecraft/game/units/apple/stage4.png","#%n-apple-stage5.png":"cleverapps/res/mergecraft/game/units/apple/stage5.png","#%n-apple-stage6.png":"cleverapps/res/mergecraft/game/units/apple/stage6.png","#%n-bamboo-stage1.png":"cleverapps/res/mergecraft/game/units/bamboo/stage1.png","#%n-bamboo-stage2.png":"cleverapps/res/mergecraft/game/units/bamboo/stage2.png","#%n-bamboo-stage3.png":"cleverapps/res/mergecraft/game/units/bamboo/stage3.png","#%n-bamboo-stage4.png":"cleverapps/res/mergecraft/game/units/bamboo/stage4.png","#%n-bamboo-stage5.png":"cleverapps/res/mergecraft/game/units/bamboo/stage5.png","#%n-bamboo-stage6.png":"cleverapps/res/mergecraft/game/units/bamboo/stage6.png","#%n-bamboo-stage7.png":"cleverapps/res/mergecraft/game/units/bamboo/stage7.png","#%n-bamboo-stage8.png":"cleverapps/res/mergecraft/game/units/bamboo/stage8.png","#%n-bamboo-stage9.png":"cleverapps/res/mergecraft/game/units/bamboo/stage9.png",
"#%n-bamboochest-stage1.png":"cleverapps/res/mergecraft/game/units/bamboochest/stage1.png","#%n-bamboochest-stage2.png":"cleverapps/res/mergecraft/game/units/bamboochest/stage2.png","#%n-bamboochest-stage3.png":"cleverapps/res/mergecraft/game/units/bamboochest/stage3.png","#%n-bamboosource-stage1.png":"cleverapps/res/mergecraft/game/units/bamboosource/stage1.png","#%n-bamboosource-stage2.png":"cleverapps/res/mergecraft/game/units/bamboosource/stage2.png","#%n-bamboosource-stage3.png":"cleverapps/res/mergecraft/game/units/bamboosource/stage3.png","#%n-bamboosource-stage4.png":"cleverapps/res/mergecraft/game/units/bamboosource/stage4.png","#%n-bamboosource-stage5.png":"cleverapps/res/mergecraft/game/units/bamboosource/stage5.png","#%n-bamboosource-stage6.png":"cleverapps/res/mergecraft/game/units/bamboosource/stage6.png","#%n-bear-stage1.png":"cleverapps/res/mergecraft/game/units/bear/stage1.png","#%n-bear-stage2.png":"cleverapps/res/mergecraft/game/units/bear/stage2.png",
"#%n-bear-stage3.png":"cleverapps/res/mergecraft/game/units/bear/stage3.png","#%n-bear-stage4.png":"cleverapps/res/mergecraft/game/units/bear/stage4.png","#%n-bear-stage5.png":"cleverapps/res/mergecraft/game/units/bear/stage5.png","#%n-bear-stage6.png":"cleverapps/res/mergecraft/game/units/bear/stage6.png","#%n-candies-stage1.png":"cleverapps/res/mergecraft/game/units/candies/stage1.png","#%n-candies-stage2.png":"cleverapps/res/mergecraft/game/units/candies/stage2.png","#%n-candies-stage3.png":"cleverapps/res/mergecraft/game/units/candies/stage3.png","#%n-candies-stage4.png":"cleverapps/res/mergecraft/game/units/candies/stage4.png","#%n-candies-stage5.png":"cleverapps/res/mergecraft/game/units/candies/stage5.png","#%n-candies-stage6.png":"cleverapps/res/mergecraft/game/units/candies/stage6.png","#%n-coins-stage1.png":"cleverapps/res/mergecraft/game/units/coins/stage1.png","#%n-coins-stage2.png":"cleverapps/res/mergecraft/game/units/coins/stage2.png",
"#%n-coins-stage3.png":"cleverapps/res/mergecraft/game/units/coins/stage3.png","#%n-coins-stage4.png":"cleverapps/res/mergecraft/game/units/coins/stage4.png","#%n-coins-stage5.png":"cleverapps/res/mergecraft/game/units/coins/stage5.png","#%n-coins-stage6.png":"cleverapps/res/mergecraft/game/units/coins/stage6.png","#%n-coins-stage7.png":"cleverapps/res/mergecraft/game/units/coins/stage7.png","#%n-coins-stage8.png":"cleverapps/res/mergecraft/game/units/coins/stage8.png","#%n-corn-stage1.png":"cleverapps/res/mergecraft/game/units/corn/stage1.png","#%n-corn-stage2.png":"cleverapps/res/mergecraft/game/units/corn/stage2.png","#%n-corn-stage3.png":"cleverapps/res/mergecraft/game/units/corn/stage3.png","#%n-corn-stage4.png":"cleverapps/res/mergecraft/game/units/corn/stage4.png","#%n-corn-stage5.png":"cleverapps/res/mergecraft/game/units/corn/stage5.png","#%n-corn-stage6.png":"cleverapps/res/mergecraft/game/units/corn/stage6.png",
"#%n-crystal-stage1.png":"cleverapps/res/mergecraft/game/units/crystal/stage1.png","#%n-crystal-stage2.png":"cleverapps/res/mergecraft/game/units/crystal/stage2.png","#%n-crystal-stage3.png":"cleverapps/res/mergecraft/game/units/crystal/stage3.png","#%n-crystal-stage4.png":"cleverapps/res/mergecraft/game/units/crystal/stage4.png","#%n-decorator-stage1.png":"cleverapps/res/mergecraft/game/units/decorator/stage1.png","#%n-dishes-stage1.png":"cleverapps/res/mergecraft/game/units/dishes/stage1.png","#%n-dishes-stage2.png":"cleverapps/res/mergecraft/game/units/dishes/stage2.png","#%n-dishes-stage3.png":"cleverapps/res/mergecraft/game/units/dishes/stage3.png","#%n-dishes-stage4.png":"cleverapps/res/mergecraft/game/units/dishes/stage4.png","#%n-dishes-stage5.png":"cleverapps/res/mergecraft/game/units/dishes/stage5.png","#%n-dishes-stage6.png":"cleverapps/res/mergecraft/game/units/dishes/stage6.png","#%n-dishes-stage7.png":"cleverapps/res/mergecraft/game/units/dishes/stage7.png",
"#%n-dishes-stage8.png":"cleverapps/res/mergecraft/game/units/dishes/stage8.png","#%n-dishes-stage9.png":"cleverapps/res/mergecraft/game/units/dishes/stage9.png","#%n-dishes-stage10.png":"cleverapps/res/mergecraft/game/units/dishes/stage10.png","#%n-dishes-stage11.png":"cleverapps/res/mergecraft/game/units/dishes/stage11.png","#%n-dishes-stage12.png":"cleverapps/res/mergecraft/game/units/dishes/stage12.png","#%n-dishes-stage13.png":"cleverapps/res/mergecraft/game/units/dishes/stage13.png","#%n-dishes-stage14.png":"cleverapps/res/mergecraft/game/units/dishes/stage14.png","#%n-dishes-stage15.png":"cleverapps/res/mergecraft/game/units/dishes/stage15.png","#%n-dishes-stage16.png":"cleverapps/res/mergecraft/game/units/dishes/stage16.png","#%n-dishes-stage17.png":"cleverapps/res/mergecraft/game/units/dishes/stage17.png","#%n-dishes-stage18.png":"cleverapps/res/mergecraft/game/units/dishes/stage18.png","#%n-dishes-stage19.png":"cleverapps/res/mergecraft/game/units/dishes/stage19.png",
"#%n-dishes-stage20.png":"cleverapps/res/mergecraft/game/units/dishes/stage20.png","#%n-dragonmine-stage1.png":"cleverapps/res/mergecraft/game/units/dragonmine/stage1.png","#%n-dwarf-stage1.png":"cleverapps/res/mergecraft/game/units/dwarf/stage1.png","#%n-elf-stage1.png":"cleverapps/res/mergecraft/game/units/elf/stage1.png","#%n-elf-stage2.png":"cleverapps/res/mergecraft/game/units/elf/stage2.png","#%n-elf-stage3.png":"cleverapps/res/mergecraft/game/units/elf/stage3.png","#%n-elf-stage4.png":"cleverapps/res/mergecraft/game/units/elf/stage4.png","#%n-elf-stage5.png":"cleverapps/res/mergecraft/game/units/elf/stage5.png","#%n-elf-stage6.png":"cleverapps/res/mergecraft/game/units/elf/stage6.png","#%n-elf-stage7.png":"cleverapps/res/mergecraft/game/units/elf/stage7.png","#%n-freechest-stage1.png":"cleverapps/res/mergecraft/game/units/freechest/stage1.png","#%n-herochest-stage1.png":"cleverapps/res/mergecraft/game/units/herochest/stage1.png",
"#%n-iron-stage1.png":"cleverapps/res/mergecraft/game/units/iron/stage1.png","#%n-iron-stage2.png":"cleverapps/res/mergecraft/game/units/iron/stage2.png","#%n-iron-stage3.png":"cleverapps/res/mergecraft/game/units/iron/stage3.png","#%n-iron-stage4.png":"cleverapps/res/mergecraft/game/units/iron/stage4.png","#%n-iron-stage5.png":"cleverapps/res/mergecraft/game/units/iron/stage5.png","#%n-iron-stage6.png":"cleverapps/res/mergecraft/game/units/iron/stage6.png","#%n-iron-stage7.png":"cleverapps/res/mergecraft/game/units/iron/stage7.png","#%n-iron-stage8.png":"cleverapps/res/mergecraft/game/units/iron/stage8.png","#%n-iron-stage9.png":"cleverapps/res/mergecraft/game/units/iron/stage9.png","#%n-iron-stage10.png":"cleverapps/res/mergecraft/game/units/iron/stage10.png","#%n-king-stage1.png":"cleverapps/res/mergecraft/game/units/king/stage1.png","#%n-king-stage2.png":"cleverapps/res/mergecraft/game/units/king/stage2.png",
"#%n-king-stage3.png":"cleverapps/res/mergecraft/game/units/king/stage3.png","#%n-magicplant-stage1.png":"cleverapps/res/mergecraft/game/units/magicplant/stage1.png","#%n-magicplant-stage2.png":"cleverapps/res/mergecraft/game/units/magicplant/stage2.png","#%n-magicplant-stage3.png":"cleverapps/res/mergecraft/game/units/magicplant/stage3.png","#%n-magicplant-stage4.png":"cleverapps/res/mergecraft/game/units/magicplant/stage4.png","#%n-magicplant-stage5.png":"cleverapps/res/mergecraft/game/units/magicplant/stage5.png","#%n-magicplant-stage6.png":"cleverapps/res/mergecraft/game/units/magicplant/stage6.png","#%n-magicplant-stage7.png":"cleverapps/res/mergecraft/game/units/magicplant/stage7.png","#%n-magicplant-stage8.png":"cleverapps/res/mergecraft/game/units/magicplant/stage8.png","#%n-magicplant-stage9.png":"cleverapps/res/mergecraft/game/units/magicplant/stage9.png","#%n-mushrooms-stage1.png":"cleverapps/res/mergecraft/game/units/mushrooms/stage1.png",
"#%n-mushrooms-stage2.png":"cleverapps/res/mergecraft/game/units/mushrooms/stage2.png","#%n-mushrooms-stage3.png":"cleverapps/res/mergecraft/game/units/mushrooms/stage3.png","#%n-mushrooms-stage4.png":"cleverapps/res/mergecraft/game/units/mushrooms/stage4.png","#%n-mushrooms-stage5.png":"cleverapps/res/mergecraft/game/units/mushrooms/stage5.png","#%n-mushrooms-stage6.png":"cleverapps/res/mergecraft/game/units/mushrooms/stage6.png","#%n-rubies-stage1.png":"cleverapps/res/mergecraft/game/units/rubies/stage1.png","#%n-rubies-stage2.png":"cleverapps/res/mergecraft/game/units/rubies/stage2.png","#%n-rubies-stage3.png":"cleverapps/res/mergecraft/game/units/rubies/stage3.png","#%n-rubies-stage4.png":"cleverapps/res/mergecraft/game/units/rubies/stage4.png","#%n-rubies-stage5.png":"cleverapps/res/mergecraft/game/units/rubies/stage5.png","#%n-rubies-stage6.png":"cleverapps/res/mergecraft/game/units/rubies/stage6.png",
"#%n-rubiesplant-stage1.png":"cleverapps/res/mergecraft/game/units/rubiesplant/stage1.png","#%n-rubiesplant-stage2.png":"cleverapps/res/mergecraft/game/units/rubiesplant/stage2.png","#%n-rubiesplant-stage3.png":"cleverapps/res/mergecraft/game/units/rubiesplant/stage3.png","#%n-sacks-stage1.png":"cleverapps/res/mergecraft/game/units/sacks/stage1.png","#%n-sacks-stage2.png":"cleverapps/res/mergecraft/game/units/sacks/stage2.png","#%n-sacks-stage3.png":"cleverapps/res/mergecraft/game/units/sacks/stage3.png","#%n-sapphire-stage1.png":"cleverapps/res/mergecraft/game/units/sapphire/stage1.png","#%n-sapphire-stage2.png":"cleverapps/res/mergecraft/game/units/sapphire/stage2.png","#%n-sapphire-stage3.png":"cleverapps/res/mergecraft/game/units/sapphire/stage3.png","#%n-sapphire-stage4.png":"cleverapps/res/mergecraft/game/units/sapphire/stage4.png","#%n-sapphire-stage5.png":"cleverapps/res/mergecraft/game/units/sapphire/stage5.png",
"#%n-sapphire-stage6.png":"cleverapps/res/mergecraft/game/units/sapphire/stage6.png","#%n-sapphire-stage7.png":"cleverapps/res/mergecraft/game/units/sapphire/stage7.png","#%n-sapphire-stage8.png":"cleverapps/res/mergecraft/game/units/sapphire/stage8.png","#%n-sapphire-stage9.png":"cleverapps/res/mergecraft/game/units/sapphire/stage9.png","#%n-sapphire-stage10.png":"cleverapps/res/mergecraft/game/units/sapphire/stage10.png","#%n-sapphirechest-stage1.png":"cleverapps/res/mergecraft/game/units/sapphirechest/stage1.png","#%n-sapphirechest-stage2.png":"cleverapps/res/mergecraft/game/units/sapphirechest/stage2.png","#%n-sapphirechest-stage3.png":"cleverapps/res/mergecraft/game/units/sapphirechest/stage3.png","#%n-sapphiresource-stage1.png":"cleverapps/res/mergecraft/game/units/sapphiresource/stage1.png","#%n-sapphiresource-stage2.png":"cleverapps/res/mergecraft/game/units/sapphiresource/stage2.png",
"#%n-sapphiresource-stage3.png":"cleverapps/res/mergecraft/game/units/sapphiresource/stage3.png","#%n-sapphiresource-stage4.png":"cleverapps/res/mergecraft/game/units/sapphiresource/stage4.png","#%n-sapphiresource-stage5.png":"cleverapps/res/mergecraft/game/units/sapphiresource/stage5.png","#%n-sapphiresource-stage6.png":"cleverapps/res/mergecraft/game/units/sapphiresource/stage6.png","#%n-stone-stage1.png":"cleverapps/res/mergecraft/game/units/stone/stage1.png","#%n-stone-stage2.png":"cleverapps/res/mergecraft/game/units/stone/stage2.png","#%n-stone-stage3.png":"cleverapps/res/mergecraft/game/units/stone/stage3.png","#%n-stone-stage4.png":"cleverapps/res/mergecraft/game/units/stone/stage4.png","#%n-stone-stage5.png":"cleverapps/res/mergecraft/game/units/stone/stage5.png","#%n-stone-stage6.png":"cleverapps/res/mergecraft/game/units/stone/stage6.png","#%n-stone-stage7.png":"cleverapps/res/mergecraft/game/units/stone/stage7.png",
"#%n-stone-stage8.png":"cleverapps/res/mergecraft/game/units/stone/stage8.png","#%n-stone-stage9.png":"cleverapps/res/mergecraft/game/units/stone/stage9.png","#%n-stonechest-stage1.png":"cleverapps/res/mergecraft/game/units/stonechest/stage1.png","#%n-stonechest-stage2.png":"cleverapps/res/mergecraft/game/units/stonechest/stage2.png","#%n-stonechest-stage3.png":"cleverapps/res/mergecraft/game/units/stonechest/stage3.png","#%n-stonesource-stage1.png":"cleverapps/res/mergecraft/game/units/stonesource/stage1.png","#%n-stonesource-stage2.png":"cleverapps/res/mergecraft/game/units/stonesource/stage2.png","#%n-stonesource-stage3.png":"cleverapps/res/mergecraft/game/units/stonesource/stage3.png","#%n-stonesource-stage4.png":"cleverapps/res/mergecraft/game/units/stonesource/stage4.png","#%n-stonesource-stage5.png":"cleverapps/res/mergecraft/game/units/stonesource/stage5.png","#%n-stonesource-stage6.png":"cleverapps/res/mergecraft/game/units/stonesource/stage6.png",
"#%n-strawberry-stage1.png":"cleverapps/res/mergecraft/game/units/strawberry/stage1.png","#%n-strawberry-stage2.png":"cleverapps/res/mergecraft/game/units/strawberry/stage2.png","#%n-strawberry-stage3.png":"cleverapps/res/mergecraft/game/units/strawberry/stage3.png","#%n-strawberry-stage4.png":"cleverapps/res/mergecraft/game/units/strawberry/stage4.png","#%n-strawberry-stage5.png":"cleverapps/res/mergecraft/game/units/strawberry/stage5.png","#%n-strawberry-stage6.png":"cleverapps/res/mergecraft/game/units/strawberry/stage6.png","#%n-troll-stage1.png":"cleverapps/res/mergecraft/game/units/troll/stage1.png","#%n-troll-stage2.png":"cleverapps/res/mergecraft/game/units/troll/stage2.png","#%n-troll-stage3.png":"cleverapps/res/mergecraft/game/units/troll/stage3.png","#%n-troll-stage4.png":"cleverapps/res/mergecraft/game/units/troll/stage4.png","#%n-troll-stage5.png":"cleverapps/res/mergecraft/game/units/troll/stage5.png",
"#%n-troll-stage6.png":"cleverapps/res/mergecraft/game/units/troll/stage6.png","#%n-troll-stage7.png":"cleverapps/res/mergecraft/game/units/troll/stage7.png","#%n-troll-stage8.png":"cleverapps/res/mergecraft/game/units/troll/stage8.png","#%n-troll-stage9.png":"cleverapps/res/mergecraft/game/units/troll/stage9.png","#%n-wagon-stage1.png":"cleverapps/res/mergecraft/game/units/wagon/stage1.png","#%n-wagon-stage2.png":"cleverapps/res/mergecraft/game/units/wagon/stage2.png","#%n-wagon-stage3.png":"cleverapps/res/mergecraft/game/units/wagon/stage3.png","#%n-wagon-stage4.png":"cleverapps/res/mergecraft/game/units/wagon/stage4.png","#%n-wagon-stage5.png":"cleverapps/res/mergecraft/game/units/wagon/stage5.png","#%n-wagon-stage6.png":"cleverapps/res/mergecraft/game/units/wagon/stage6.png","#%n-wagon-stage7.png":"cleverapps/res/mergecraft/game/units/wagon/stage7.png","#%n-wagon-stage8.png":"cleverapps/res/mergecraft/game/units/wagon/stage8.png",
"#%n-wagon-stage9.png":"cleverapps/res/mergecraft/game/units/wagon/stage9.png","#%n-wagonchest-stage1.png":"cleverapps/res/mergecraft/game/units/wagonchest/stage1.png","#%n-wagonchest-stage2.png":"cleverapps/res/mergecraft/game/units/wagonchest/stage2.png","#%n-wagonchest-stage3.png":"cleverapps/res/mergecraft/game/units/wagonchest/stage3.png","#%n-wagonsource-stage1.png":"cleverapps/res/mergecraft/game/units/wagonsource/stage1.png","#%n-wagonsource-stage2.png":"cleverapps/res/mergecraft/game/units/wagonsource/stage2.png","#%n-wagonsource-stage3.png":"cleverapps/res/mergecraft/game/units/wagonsource/stage3.png","#%n-wagonsource-stage4.png":"cleverapps/res/mergecraft/game/units/wagonsource/stage4.png","#%n-wagonsource-stage5.png":"cleverapps/res/mergecraft/game/units/wagonsource/stage5.png","#%n-wagonsource-stage6.png":"cleverapps/res/mergecraft/game/units/wagonsource/stage6.png","#%n-warlock-stage1.png":"cleverapps/res/mergecraft/game/units/warlock/stage1.png",
"#%n-warlock-stage2.png":"cleverapps/res/mergecraft/game/units/warlock/stage2.png","#%n-warlock-stage3.png":"cleverapps/res/mergecraft/game/units/warlock/stage3.png","#%n-warlock-stage4.png":"cleverapps/res/mergecraft/game/units/warlock/stage4.png","#%n-warlock-stage5.png":"cleverapps/res/mergecraft/game/units/warlock/stage5.png","#%n-warlock-stage6.png":"cleverapps/res/mergecraft/game/units/warlock/stage6.png","#%n-warlock-stage7.png":"cleverapps/res/mergecraft/game/units/warlock/stage7.png","#%n-warlock-stage8.png":"cleverapps/res/mergecraft/game/units/warlock/stage8.png","#%n-wheat-stage1.png":"cleverapps/res/mergecraft/game/units/wheat/stage1.png","#%n-wheat-stage2.png":"cleverapps/res/mergecraft/game/units/wheat/stage2.png","#%n-wheat-stage3.png":"cleverapps/res/mergecraft/game/units/wheat/stage3.png","#%n-wheat-stage4.png":"cleverapps/res/mergecraft/game/units/wheat/stage4.png","#%n-wheat-stage5.png":"cleverapps/res/mergecraft/game/units/wheat/stage5.png",
"#%n-wheat-stage6.png":"cleverapps/res/mergecraft/game/units/wheat/stage6.png","#%n-wood-stage1.png":"cleverapps/res/mergecraft/game/units/wood/stage1.png","#%n-wood-stage2.png":"cleverapps/res/mergecraft/game/units/wood/stage2.png","#%n-wood-stage3.png":"cleverapps/res/mergecraft/game/units/wood/stage3.png","#%n-wood-stage4.png":"cleverapps/res/mergecraft/game/units/wood/stage4.png","#%n-wood-stage5.png":"cleverapps/res/mergecraft/game/units/wood/stage5.png","#%n-wood-stage6.png":"cleverapps/res/mergecraft/game/units/wood/stage6.png","#%n-wood-stage7.png":"cleverapps/res/mergecraft/game/units/wood/stage7.png","#%n-wood-stage8.png":"cleverapps/res/mergecraft/game/units/wood/stage8.png","#%n-woodchest-stage1.png":"cleverapps/res/mergecraft/game/units/woodchest/stage1.png","#%n-woodchest-stage2.png":"cleverapps/res/mergecraft/game/units/woodchest/stage2.png","#%n-woodchest-stage3.png":"cleverapps/res/mergecraft/game/units/woodchest/stage3.png",
"#%n-woodsource-stage1.png":"cleverapps/res/mergecraft/game/units/woodsource/stage1.png","#%n-woodsource-stage2.png":"cleverapps/res/mergecraft/game/units/woodsource/stage2.png","#%n-woodsource-stage3.png":"cleverapps/res/mergecraft/game/units/woodsource/stage3.png","#%n-woodsource-stage4.png":"cleverapps/res/mergecraft/game/units/woodsource/stage4.png","#%n-woodsource-stage5.png":"cleverapps/res/mergecraft/game/units/woodsource/stage5.png","#%n-woodsource-stage6.png":"cleverapps/res/mergecraft/game/units/woodsource/stage6.png","#%n-worker-stage1.png":"cleverapps/res/mergecraft/game/units/worker/stage1.png","#%n-worker-stage2.png":"cleverapps/res/mergecraft/game/units/worker/stage2.png","#%n-worker-stage3.png":"cleverapps/res/mergecraft/game/units/worker/stage3.png","#%n-worker-stage4.png":"cleverapps/res/mergecraft/game/units/worker/stage4.png","#%n-decorators-bush5.png":"cleverapps/res/mergecraft/game/decorators/bush5.png",
"#%n-decorators-decorator_acorn.png":"cleverapps/res/mergecraft/game/decorators/decorator_acorn.png","#%n-decorators-decorator_break_left.png":"cleverapps/res/mergecraft/game/decorators/decorator_break_left.png","#%n-decorators-decorator_break_right.png":"cleverapps/res/mergecraft/game/decorators/decorator_break_right.png","#%n-decorators-decorator_bush.png":"cleverapps/res/mergecraft/game/decorators/decorator_bush.png","#%n-decorators-decorator_bush2.png":"cleverapps/res/mergecraft/game/decorators/decorator_bush2.png","#%n-decorators-decorator_bush3.png":"cleverapps/res/mergecraft/game/decorators/decorator_bush3.png","#%n-decorators-decorator_bush4.png":"cleverapps/res/mergecraft/game/decorators/decorator_bush4.png","#%n-decorators-decorator_bush6.png":"cleverapps/res/mergecraft/game/decorators/decorator_bush6.png","#%n-decorators-decorator_cactus_1.png":"cleverapps/res/mergecraft/game/decorators/decorator_cactus_1.png",
"#%n-decorators-decorator_cactus_2.png":"cleverapps/res/mergecraft/game/decorators/decorator_cactus_2.png","#%n-decorators-decorator_cave.png":"cleverapps/res/mergecraft/game/decorators/decorator_cave.png","#%n-decorators-decorator_cave2.png":"cleverapps/res/mergecraft/game/decorators/decorator_cave2.png","#%n-decorators-decorator_cave3.png":"cleverapps/res/mergecraft/game/decorators/decorator_cave3.png","#%n-decorators-decorator_columns.png":"cleverapps/res/mergecraft/game/decorators/decorator_columns.png","#%n-decorators-decorator_crystal.png":"cleverapps/res/mergecraft/game/decorators/decorator_crystal.png","#%n-decorators-decorator_door.png":"cleverapps/res/mergecraft/game/decorators/decorator_door.png","#%n-decorators-decorator_dragon_tale.png":"cleverapps/res/mergecraft/game/decorators/decorator_dragon_tale.png","#%n-decorators-decorator_eggs.png":"cleverapps/res/mergecraft/game/decorators/decorator_eggs.png",
"#%n-decorators-decorator_eggs2.png":"cleverapps/res/mergecraft/game/decorators/decorator_eggs2.png","#%n-decorators-decorator_fence.png":"cleverapps/res/mergecraft/game/decorators/decorator_fence.png","#%n-decorators-decorator_frozen_tree.png":"cleverapps/res/mergecraft/game/decorators/decorator_frozen_tree.png","#%n-decorators-decorator_gem1.png":"cleverapps/res/mergecraft/game/decorators/decorator_gem1.png","#%n-decorators-decorator_gem10.png":"cleverapps/res/mergecraft/game/decorators/decorator_gem10.png","#%n-decorators-decorator_gem11.png":"cleverapps/res/mergecraft/game/decorators/decorator_gem11.png","#%n-decorators-decorator_gem2.png":"cleverapps/res/mergecraft/game/decorators/decorator_gem2.png","#%n-decorators-decorator_gem3.png":"cleverapps/res/mergecraft/game/decorators/decorator_gem3.png","#%n-decorators-decorator_gem4.png":"cleverapps/res/mergecraft/game/decorators/decorator_gem4.png",
"#%n-decorators-decorator_gem5.png":"cleverapps/res/mergecraft/game/decorators/decorator_gem5.png","#%n-decorators-decorator_gem6.png":"cleverapps/res/mergecraft/game/decorators/decorator_gem6.png","#%n-decorators-decorator_gem7.png":"cleverapps/res/mergecraft/game/decorators/decorator_gem7.png","#%n-decorators-decorator_gem8.png":"cleverapps/res/mergecraft/game/decorators/decorator_gem8.png","#%n-decorators-decorator_gem9.png":"cleverapps/res/mergecraft/game/decorators/decorator_gem9.png","#%n-decorators-decorator_green_stone.png":"cleverapps/res/mergecraft/game/decorators/decorator_green_stone.png","#%n-decorators-decorator_green_stone1.png":"cleverapps/res/mergecraft/game/decorators/decorator_green_stone1.png","#%n-decorators-decorator_ice_arc.png":"cleverapps/res/mergecraft/game/decorators/decorator_ice_arc.png","#%n-decorators-decorator_ice_cave.png":"cleverapps/res/mergecraft/game/decorators/decorator_ice_cave.png",
"#%n-decorators-decorator_ice_crystall.png":"cleverapps/res/mergecraft/game/decorators/decorator_ice_crystall.png","#%n-decorators-decorator_ice_crystall_2.png":"cleverapps/res/mergecraft/game/decorators/decorator_ice_crystall_2.png","#%n-decorators-decorator_ice_eggs.png":"cleverapps/res/mergecraft/game/decorators/decorator_ice_eggs.png","#%n-decorators-decorator_ice_fir.png":"cleverapps/res/mergecraft/game/decorators/decorator_ice_fir.png","#%n-decorators-decorator_ice_siderock.png":"cleverapps/res/mergecraft/game/decorators/decorator_ice_siderock.png","#%n-decorators-decorator_ice_stairway.png":"cleverapps/res/mergecraft/game/decorators/decorator_ice_stairway.png","#%n-decorators-decorator_icerock_1.png":"cleverapps/res/mergecraft/game/decorators/decorator_icerock_1.png","#%n-decorators-decorator_icerock_10.png":"cleverapps/res/mergecraft/game/decorators/decorator_icerock_10.png",
"#%n-decorators-decorator_icerock_2.png":"cleverapps/res/mergecraft/game/decorators/decorator_icerock_2.png","#%n-decorators-decorator_icerock_3.png":"cleverapps/res/mergecraft/game/decorators/decorator_icerock_3.png","#%n-decorators-decorator_icerock_4.png":"cleverapps/res/mergecraft/game/decorators/decorator_icerock_4.png","#%n-decorators-decorator_icerock_5.png":"cleverapps/res/mergecraft/game/decorators/decorator_icerock_5.png","#%n-decorators-decorator_icerock_6.png":"cleverapps/res/mergecraft/game/decorators/decorator_icerock_6.png","#%n-decorators-decorator_icerock_7.png":"cleverapps/res/mergecraft/game/decorators/decorator_icerock_7.png","#%n-decorators-decorator_icerock_8.png":"cleverapps/res/mergecraft/game/decorators/decorator_icerock_8.png","#%n-decorators-decorator_icerock_9.png":"cleverapps/res/mergecraft/game/decorators/decorator_icerock_9.png","#%n-decorators-decorator_iglu.png":"cleverapps/res/mergecraft/game/decorators/decorator_iglu.png",
"#%n-decorators-decorator_island.png":"cleverapps/res/mergecraft/game/decorators/decorator_island.png","#%n-decorators-decorator_lava.png":"cleverapps/res/mergecraft/game/decorators/decorator_lava.png","#%n-decorators-decorator_leaf.png":"cleverapps/res/mergecraft/game/decorators/decorator_leaf.png","#%n-decorators-decorator_leaf2.png":"cleverapps/res/mergecraft/game/decorators/decorator_leaf2.png","#%n-decorators-decorator_leaf3.png":"cleverapps/res/mergecraft/game/decorators/decorator_leaf3.png","#%n-decorators-decorator_leaf4.png":"cleverapps/res/mergecraft/game/decorators/decorator_leaf4.png","#%n-decorators-decorator_leaf_stone.png":"cleverapps/res/mergecraft/game/decorators/decorator_leaf_stone.png","#%n-decorators-decorator_leaf_stone2.png":"cleverapps/res/mergecraft/game/decorators/decorator_leaf_stone2.png","#%n-decorators-decorator_light_plant.png":"cleverapps/res/mergecraft/game/decorators/decorator_light_plant.png",
"#%n-decorators-decorator_light_plant1.png":"cleverapps/res/mergecraft/game/decorators/decorator_light_plant1.png","#%n-decorators-decorator_lilies.png":"cleverapps/res/mergecraft/game/decorators/decorator_lilies.png","#%n-decorators-decorator_mushroom1.png":"cleverapps/res/mergecraft/game/decorators/decorator_mushroom1.png","#%n-decorators-decorator_mushroom2.png":"cleverapps/res/mergecraft/game/decorators/decorator_mushroom2.png","#%n-decorators-decorator_pillar1.png":"cleverapps/res/mergecraft/game/decorators/decorator_pillar1.png","#%n-decorators-decorator_pillar2.png":"cleverapps/res/mergecraft/game/decorators/decorator_pillar2.png","#%n-decorators-decorator_pillar3.png":"cleverapps/res/mergecraft/game/decorators/decorator_pillar3.png","#%n-decorators-decorator_pillar4.png":"cleverapps/res/mergecraft/game/decorators/decorator_pillar4.png","#%n-decorators-decorator_plant.png":"cleverapps/res/mergecraft/game/decorators/decorator_plant.png",
"#%n-decorators-decorator_plant2.png":"cleverapps/res/mergecraft/game/decorators/decorator_plant2.png","#%n-decorators-decorator_plant3.png":"cleverapps/res/mergecraft/game/decorators/decorator_plant3.png","#%n-decorators-decorator_rock.png":"cleverapps/res/mergecraft/game/decorators/decorator_rock.png","#%n-decorators-decorator_rock10.png":"cleverapps/res/mergecraft/game/decorators/decorator_rock10.png","#%n-decorators-decorator_rock11.png":"cleverapps/res/mergecraft/game/decorators/decorator_rock11.png","#%n-decorators-decorator_rock12.png":"cleverapps/res/mergecraft/game/decorators/decorator_rock12.png","#%n-decorators-decorator_rock13.png":"cleverapps/res/mergecraft/game/decorators/decorator_rock13.png","#%n-decorators-decorator_rock14.png":"cleverapps/res/mergecraft/game/decorators/decorator_rock14.png","#%n-decorators-decorator_rock15.png":"cleverapps/res/mergecraft/game/decorators/decorator_rock15.png",
"#%n-decorators-decorator_rock16.png":"cleverapps/res/mergecraft/game/decorators/decorator_rock16.png","#%n-decorators-decorator_rock17.png":"cleverapps/res/mergecraft/game/decorators/decorator_rock17.png","#%n-decorators-decorator_rock18.png":"cleverapps/res/mergecraft/game/decorators/decorator_rock18.png","#%n-decorators-decorator_rock19.png":"cleverapps/res/mergecraft/game/decorators/decorator_rock19.png","#%n-decorators-decorator_rock2.png":"cleverapps/res/mergecraft/game/decorators/decorator_rock2.png","#%n-decorators-decorator_rock20.png":"cleverapps/res/mergecraft/game/decorators/decorator_rock20.png","#%n-decorators-decorator_rock3.png":"cleverapps/res/mergecraft/game/decorators/decorator_rock3.png","#%n-decorators-decorator_rock4.png":"cleverapps/res/mergecraft/game/decorators/decorator_rock4.png","#%n-decorators-decorator_rock5.png":"cleverapps/res/mergecraft/game/decorators/decorator_rock5.png",
"#%n-decorators-decorator_rock6.png":"cleverapps/res/mergecraft/game/decorators/decorator_rock6.png","#%n-decorators-decorator_rock7.png":"cleverapps/res/mergecraft/game/decorators/decorator_rock7.png","#%n-decorators-decorator_rock8.png":"cleverapps/res/mergecraft/game/decorators/decorator_rock8.png","#%n-decorators-decorator_rock9.png":"cleverapps/res/mergecraft/game/decorators/decorator_rock9.png","#%n-decorators-decorator_roots.png":"cleverapps/res/mergecraft/game/decorators/decorator_roots.png","#%n-decorators-decorator_roots2.png":"cleverapps/res/mergecraft/game/decorators/decorator_roots2.png","#%n-decorators-decorator_roots3.png":"cleverapps/res/mergecraft/game/decorators/decorator_roots3.png","#%n-decorators-decorator_roots4.png":"cleverapps/res/mergecraft/game/decorators/decorator_roots4.png","#%n-decorators-decorator_sandcave_1.png":"cleverapps/res/mergecraft/game/decorators/decorator_sandcave_1.png",
"#%n-decorators-decorator_sandcave_2.png":"cleverapps/res/mergecraft/game/decorators/decorator_sandcave_2.png","#%n-decorators-decorator_sandcave_3.png":"cleverapps/res/mergecraft/game/decorators/decorator_sandcave_3.png","#%n-decorators-decorator_sandcave_4.png":"cleverapps/res/mergecraft/game/decorators/decorator_sandcave_4.png","#%n-decorators-decorator_sandcave_5.png":"cleverapps/res/mergecraft/game/decorators/decorator_sandcave_5.png","#%n-decorators-decorator_sandcave_6.png":"cleverapps/res/mergecraft/game/decorators/decorator_sandcave_6.png","#%n-decorators-decorator_sandrock_1.png":"cleverapps/res/mergecraft/game/decorators/decorator_sandrock_1.png","#%n-decorators-decorator_sandrock_2.png":"cleverapps/res/mergecraft/game/decorators/decorator_sandrock_2.png","#%n-decorators-decorator_sandrock_3.png":"cleverapps/res/mergecraft/game/decorators/decorator_sandrock_3.png","#%n-decorators-decorator_sandrock_4.png":"cleverapps/res/mergecraft/game/decorators/decorator_sandrock_4.png",
"#%n-decorators-decorator_sandstone.png":"cleverapps/res/mergecraft/game/decorators/decorator_sandstone.png","#%n-decorators-decorator_slope.png":"cleverapps/res/mergecraft/game/decorators/decorator_slope.png","#%n-decorators-decorator_snowman.png":"cleverapps/res/mergecraft/game/decorators/decorator_snowman.png","#%n-decorators-decorator_stairs.png":"cleverapps/res/mergecraft/game/decorators/decorator_stairs.png","#%n-decorators-decorator_stone1.png":"cleverapps/res/mergecraft/game/decorators/decorator_stone1.png","#%n-decorators-decorator_stone2.png":"cleverapps/res/mergecraft/game/decorators/decorator_stone2.png","#%n-decorators-decorator_stone4.png":"cleverapps/res/mergecraft/game/decorators/decorator_stone4.png","#%n-decorators-decorator_stone5.png":"cleverapps/res/mergecraft/game/decorators/decorator_stone5.png","#%n-decorators-decorator_tree.png":"cleverapps/res/mergecraft/game/decorators/decorator_tree.png",
"#%n-decorators-decorator_tumbleweed.png":"cleverapps/res/mergecraft/game/decorators/decorator_tumbleweed.png","#%n-decorators-decorator_water_grid.png":"cleverapps/res/mergecraft/game/decorators/decorator_water_grid.png","#%n-decorators-decorator_water_stone.png":"cleverapps/res/mergecraft/game/decorators/decorator_water_stone.png","#%n-decorators-decorator_water_stone1.png":"cleverapps/res/mergecraft/game/decorators/decorator_water_stone1.png","#%n-decorators-decorator_waterfall.png":"cleverapps/res/mergecraft/game/decorators/decorator_waterfall.png","#%n-decorators-decorator_waterfall2.png":"cleverapps/res/mergecraft/game/decorators/decorator_waterfall2.png","#%n-decorators-decorator_waterice.png":"cleverapps/res/mergecraft/game/decorators/decorator_waterice.png","@jsons/hint_button_arrow-008e7a2d92.json":"cleverapps/res/spines/hint_button_arrow/hint_button_arrow.json","@jsons/coins_reward-9f92bd9090.json":"cleverapps/res/spines/coins_reward/coins_reward.json",
"@jsons/combo_glow_fx-3a7047dbce.json":"cleverapps/res/mergecraft/bundles/combo_background/combo_glow_fx.json","@jsons/combo_glow_fx_particles-2810d15005.json":"cleverapps/res/mergecraft/bundles/combo_background/combo_glow_fx_particles.json","@jsons/level_crown-e904aad65e.json":"cleverapps/res/mergecraft/level/level_crown/level_crown.json","@jsons/icon_pack1-7fbeaf6294.json":"cleverapps/res/mergecraft/sidebar/pack1/icon_pack1.json","@jsons/icon_pack2-cc85b06051.json":"cleverapps/res/mergecraft/sidebar/pack2/icon_pack2.json","@jsons/icon_pack3-01a54e22d1.json":"cleverapps/res/mergecraft/sidebar/pack3/icon_pack3.json","@jsons/energy_tournament-0c6bde045e.json":"cleverapps/res/mergecraft/sidebar/energy_feast/energy_tournament.json","@jsons/battlepass_icon-9b2581bfc4.json":"cleverapps/res/mergecraft/sidebar/battlepass/battlepass_icon.json","@jsons/orders_icon-3704aded22.json":"cleverapps/res/mergecraft/sidebar/orders/orders_icon.json",
"@jsons/market_icon-b2c01578b1.json":"cleverapps/res/mergecraft/sidebar/market/market_icon.json","@jsons/units_icon-b7f7e718c4.json":"cleverapps/res/mergecraft/sidebar/units/units_icon.json","@jsons/exclamation-35af20d755.json":"cleverapps/res/bundles/high/exclamations/exclamation.json","@jsons/artifacts_fx_down-1267ba4947.json":"cleverapps/res/mergecraft/game/artefact/artifacts_fx_down.json","@jsons/artifacts_fx_up-d925abbab0.json":"cleverapps/res/mergecraft/game/artefact/artifacts_fx_up.json","@jsons/island_fx-e1dda0faf8.json":"cleverapps/res/mergecraft/game/island_fx/island_fx.json","@jsons/change_stage_cloud-75b91d9cc3.json":"cleverapps/res/mergecraft/game/change_stage_cloud/change_stage_cloud.json","@jsons/appearance-9e5ca9f3e9.json":"cleverapps/res/mergecraft/game/appearance/appearance.json","@jsons/destruction-921b98d783.json":"cleverapps/res/mergecraft/game/destruction/destruction.json",
"@jsons/reward_highlight-301f6517a1.json":"cleverapps/res/mergecraft/game/reward_highlight/reward_highlight.json","@jsons/flickering-4e399f86fb.json":"cleverapps/res/mergecraft/game/flickering/flickering.json","@jsons/merge_effect-36644caa10.json":"cleverapps/res/mergecraft/merge_effect/merge_effect.json","@jsons/hint-72b78cc889.json":"cleverapps/res/mergecraft/game/hint/hint.json","@jsons/rays-3e73ee9a62.json":"cleverapps/res/mergecraft/game/rays/rays.json","@jsons/bug-84e2e85223.json":"cleverapps/res/mergecraft/game/bug/bug.json","@jsons/barrel-c505763d4c.json":"cleverapps/res/mergecraft/game/barrel/barrel.json","@jsons/bonus_shining-b92e59c120.json":"cleverapps/res/mergecraft/game/ui/bonus_shining/bonus_shining.json","@jsons/specialoffer_helicopter-9a5c4aee75.json":"cleverapps/res/mergecraft/game/specialoffer_helicopter/specialoffer_helicopter.json","@jsons/batlepass_star-91902393b4.json":"cleverapps/res/mergecraft/game/batlepass_star/batlepass_star.json",
"@jsons/building_completion_down-5e32ffeee2.json":"cleverapps/res/mergecraft/game/building_completion/building_completion_down.json","@jsons/building_completion_up-965cd41bbc.json":"cleverapps/res/mergecraft/game/building_completion/building_completion_up.json","@jsons/dwarf-fe7fb74f18.json":"cleverapps/res/mergecraft/characters/dwarf/dwarf.json","@jsons/sandglass-5ec0151b4c.json":"cleverapps/res/mergecraft/game/ui/sandglass/sandglass.json","@jsons/growing_plant-7134cde171.json":"cleverapps/res/mergecraft/game/growing_plant/growing_plant.json","@jsons/ripe_plant-13509ffc59.json":"cleverapps/res/mergecraft/game/ripe_plant/ripe_plant.json","@jsons/fruit_ready-a0e953db7c.json":"cleverapps/res/mergecraft/game/fruit_ready/fruit_ready.json","@jsons/castle_animation-76ec3dd840.json":"cleverapps/res/mergecraft/game/castle_animation/castle_animation.json","@jsons/gem_animation-8bc76ded63.json":"cleverapps/res/mergecraft/game/gem_animation/gem_animation.json",
"@jsons/treasure-f735f61bf6.json":"cleverapps/res/mergecraft/game/units/treasure/treasure.json","@jsons/prize_shining-6d22f85df0.json":"cleverapps/res/mergecraft/game/ui/prize_shining/prize_shining.json","@jsons/bamboo_stage10-2b8273dae0.json":"cleverapps/res/mergecraft/game/units/bamboo/stage10/bamboo_stage10.json","@jsons/bamboo_stage11-22c933802f.json":"cleverapps/res/mergecraft/game/units/bamboo/stage11/bamboo_stage11.json","@jsons/bamboogenerator_stage1-b2df0cceac.json":"cleverapps/res/mergecraft/game/units/bamboogenerator/stage1/bamboogenerator_stage1.json","@jsons/bamboogenerator_stage2-425e9e0ba1.json":"cleverapps/res/mergecraft/game/units/bamboogenerator/stage2/bamboogenerator_stage2.json","@jsons/bamboogenerator_stage3-b3a1c9b0b4.json":"cleverapps/res/mergecraft/game/units/bamboogenerator/stage3/bamboogenerator_stage3.json","@jsons/bear_stage7-5cd4b6b667.json":"cleverapps/res/mergecraft/game/units/bear/stage7/bear_stage7.json",
"@jsons/dwarf_stage2-7d56c72510.json":"cleverapps/res/mergecraft/game/units/dwarf/stage2/dwarf_stage2.json","@jsons/elf_stage8-5179d15722.json":"cleverapps/res/mergecraft/game/units/elf/stage8/elf_stage8.json","@jsons/king_stage4-7962c495dd.json":"cleverapps/res/mergecraft/game/units/king/stage4/king_stage4.json","@jsons/sapphire_stage11-727de2ebc1.json":"cleverapps/res/mergecraft/game/units/sapphire/stage11/sapphire_stage11.json","@jsons/sapphire_stage12-c55dce6bd5.json":"cleverapps/res/mergecraft/game/units/sapphire/stage12/sapphire_stage12.json","@jsons/sapphiregenerator_stage1-76d5b48e99.json":"cleverapps/res/mergecraft/game/units/sapphiregenerator/stage1/sapphiregenerator_stage1.json","@jsons/sapphiregenerator_stage2-e9b2036852.json":"cleverapps/res/mergecraft/game/units/sapphiregenerator/stage2/sapphiregenerator_stage2.json","@jsons/sapphiregenerator_stage3-bd8ab58bb7.json":"cleverapps/res/mergecraft/game/units/sapphiregenerator/stage3/sapphiregenerator_stage3.json",
"@jsons/specialoffer_stage1-4cc375ce00.json":"cleverapps/res/mergecraft/game/units/specialoffer/stage1/specialoffer_stage1.json","@jsons/stone_stage10-2ee1915290.json":"cleverapps/res/mergecraft/game/units/stone/stage10/stone_stage10.json","@jsons/stone_stage11-c60b6415bc.json":"cleverapps/res/mergecraft/game/units/stone/stage11/stone_stage11.json","@jsons/stonegenerator_stage1-d3968925dc.json":"cleverapps/res/mergecraft/game/units/stonegenerator/stage1/stonegenerator_stage1.json","@jsons/stonegenerator_stage2-0aab40802d.json":"cleverapps/res/mergecraft/game/units/stonegenerator/stage2/stonegenerator_stage2.json","@jsons/stonegenerator_stage3-14099c3c16.json":"cleverapps/res/mergecraft/game/units/stonegenerator/stage3/stonegenerator_stage3.json","@jsons/troll_stage10-d0e5f5d2b2.json":"cleverapps/res/mergecraft/game/units/troll/stage10/troll_stage10.json","@jsons/wagon_stage10-61e5f61a89.json":"cleverapps/res/mergecraft/game/units/wagon/stage10/wagon_stage10.json",
"@jsons/wagon_stage11-6a551cf1ac.json":"cleverapps/res/mergecraft/game/units/wagon/stage11/wagon_stage11.json","@jsons/wagongenerator_stage1-16beb4ef1c.json":"cleverapps/res/mergecraft/game/units/wagongenerator/stage1/wagongenerator_stage1.json","@jsons/wagongenerator_stage2-bced3cd7b1.json":"cleverapps/res/mergecraft/game/units/wagongenerator/stage2/wagongenerator_stage2.json","@jsons/wagongenerator_stage3-f76c43d67f.json":"cleverapps/res/mergecraft/game/units/wagongenerator/stage3/wagongenerator_stage3.json","@jsons/wands_stage1-535476df2f.json":"cleverapps/res/mergecraft/game/units/wands/stage1/wands_stage1.json","@jsons/wands_stage2-5b3cd3b124.json":"cleverapps/res/mergecraft/game/units/wands/stage2/wands_stage2.json","@jsons/wands_stage3-742c20d24e.json":"cleverapps/res/mergecraft/game/units/wands/stage3/wands_stage3.json","@jsons/wands_stage4-d94ad946f6.json":"cleverapps/res/mergecraft/game/units/wands/stage4/wands_stage4.json",
"@jsons/wands_stage5-d9b2d0d3e1.json":"cleverapps/res/mergecraft/game/units/wands/stage5/wands_stage5.json","@jsons/wands_stage6-a067e2a882.json":"cleverapps/res/mergecraft/game/units/wands/stage6/wands_stage6.json","@jsons/warlock_stage9-510edb7c9c.json":"cleverapps/res/mergecraft/game/units/warlock/stage9/warlock_stage9.json","@jsons/wood_stage9-795fc48e1c.json":"cleverapps/res/mergecraft/game/units/wood/stage9/wood_stage9.json","@jsons/wood_stage10-d944fe5492.json":"cleverapps/res/mergecraft/game/units/wood/stage10/wood_stage10.json","@jsons/woodgenerator_stage1-adb1dc400c.json":"cleverapps/res/mergecraft/game/units/woodgenerator/stage1/woodgenerator_stage1.json","@jsons/woodgenerator_stage2-f73d0647d0.json":"cleverapps/res/mergecraft/game/units/woodgenerator/stage2/woodgenerator_stage2.json","@jsons/woodgenerator_stage3-4f76fc159e.json":"cleverapps/res/mergecraft/game/units/woodgenerator/stage3/woodgenerator_stage3.json",
"@jsons/worker_stage5-594a29e321.json":"cleverapps/res/mergecraft/game/units/worker/stage5/worker_stage5.json","~sounds/merge-e4e5546e39.mp3":"cleverapps/res/mergecraft/sfx/game/merge.mp3","~sounds/new_order-5c4e628f54.mp3":"cleverapps/res/mergecraft/sfx/game/new_order.mp3","~sounds/prize_view_created-2ab1bf8cfb.mp3":"cleverapps/res/mergecraft/sfx/game/prize_view_created.mp3","~sounds/spawn_start-2a94083a1c.mp3":"cleverapps/res/mergecraft/sfx/game/spawn_start.mp3","~sounds/spawn_landing-7a01ef36e5.mp3":"cleverapps/res/mergecraft/sfx/game/spawn_landing.mp3","~sounds/spawn_fail-fdaf8d74be.mp3":"cleverapps/res/mergecraft/sfx/game/spawn_fail.mp3","~sounds/beetles_collect-45552f26d7.mp3":"cleverapps/res/mergecraft/sfx/game/beetles_collect.mp3","~sounds/merchant_appearance-2b35d35856.mp3":"cleverapps/res/mergecraft/sfx/game/merchant_appearance.mp3","~sounds/merchant_window-bed8e8d86f.mp3":"cleverapps/res/mergecraft/sfx/game/merchant_window.mp3",
"~sounds/build_finish-b77cae7e58.mp3":"cleverapps/res/mergecraft/sfx/game/build_finish.mp3","~sounds/merchant_disappearance-afcf5922f0.mp3":"cleverapps/res/mergecraft/sfx/game/merchant_disappearance.mp3","~sounds/helicopter-e232bb32d1.mp3":"cleverapps/res/mergecraft/sfx/game/helicopter.mp3","~sounds/build_robot-aad7453d1d.mp3":"cleverapps/res/mergecraft/sfx/game/build_robot.mp3","~sounds/remove_thing-91a578ee13.mp3":"cleverapps/res/mergecraft/sfx/game/remove_thing.mp3","~sounds/coins_drop-887037b04e.mp3":"cleverapps/res/mergecraft/sfx/game/coins_drop.mp3","~sounds/build_castle-506cac56a5.mp3":"cleverapps/res/mergecraft/sfx/game/build_castle.mp3","~sounds/beetles-be60a9cb4f.mp3":"cleverapps/res/mergecraft/sfx/game/beetles.mp3","~sounds/beetles_emergence-5aaae60895.mp3":"cleverapps/res/mergecraft/sfx/game/beetles_emergence.mp3","~sounds/barrel-ef78b26e8a.mp3":"cleverapps/res/mergecraft/sfx/game/barrel.mp3",
"~sounds/build_start-89fef2be77.mp3":"cleverapps/res/mergecraft/sfx/game/build_start.mp3","~sounds/mining_ground_start-d433e147de.mp3":"cleverapps/res/mergecraft/sfx/game/mining_ground_start.mp3","~sounds/mining_wood_start-53bf2d0df8.mp3":"cleverapps/res/mergecraft/sfx/game/mining_wood_start.mp3","~sounds/mining_stone_start-f5be5d43a5.mp3":"cleverapps/res/mergecraft/sfx/game/mining_stone_start.mp3","~sounds/mining_metal_start-d3cc3f14da.mp3":"cleverapps/res/mergecraft/sfx/game/mining_metal_start.mp3","~sounds/fruit_fly-1545a6f0d2.mp3":"cleverapps/res/mergecraft/sfx/game/fruit_fly.mp3","~sounds/coins_fly-48c8f148ba.mp3":"cleverapps/res/mergecraft/sfx/game/coins_fly.mp3","~sounds/wand_fly-532f1d572a.mp3":"cleverapps/res/mergecraft/sfx/game/wand_fly.mp3","~sounds/progress_fly-a84efaa03e.mp3":"cleverapps/res/mergecraft/sfx/game/progress_fly.mp3"},game_background:{},game_background_hard:{},gamemessage:{},git:{},guidewindow:{
"#%n-%n_stage_background.png":"cleverapps/res/mergecraft/game/ui/guidewindow/guidewindow_stage_background.png","#%n-%n_up_arrow.png":"cleverapps/res/mergecraft/game/ui/guidewindow/guidewindow_up_arrow.png","#%n-%n_down_arrow.png":"cleverapps/res/mergecraft/game/ui/guidewindow/guidewindow_down_arrow.png","#%n-%n_blue_light.png":"cleverapps/res/mergecraft/game/ui/guidewindow/guidewindow_blue_light.png","#%n-%n_blue_light2.png":"cleverapps/res/mergecraft/game/ui/guidewindow/guidewindow_blue_light2.png","#%n-%n_blue_light3.png":"cleverapps/res/mergecraft/game/ui/guidewindow/guidewindow_blue_light3.png","#%n-%n_yellow_light.png":"cleverapps/res/mergecraft/game/ui/guidewindow/guidewindow_yellow_light.png","#%n-%n_white_arrow.png":"cleverapps/res/mergecraft/game/ui/guidewindow/guidewindow_white_arrow.png","#%n-%n_white_arrowup.png":"cleverapps/res/mergecraft/game/ui/guidewindow/guidewindow_white_arrowup.png",
"#%n-%n_white_plus.png":"cleverapps/res/mergecraft/game/ui/guidewindow/guidewindow_white_plus.png","#%n-%n_white_three_arrow.png":"cleverapps/res/mergecraft/game/ui/guidewindow/guidewindow_white_three_arrow.png","#%n-%n_crystal.png":"cleverapps/res/mergecraft/game/ui/guidewindow/guidewindow_crystal.png","#%n-%n_progressbar.png":"cleverapps/res/mergecraft/game/ui/guidewindow/guidewindow_progressbar.png","#%n-%n_tile_light.png":"cleverapps/res/mergecraft/game/ui/guidewindow/guidewindow_tile_light.png","#%n-orderswindow-attention_exclamation.png":"cleverapps/res/mergecraft/game/ui/orderswindow/attention_exclamation.png","#%n-%n_score_rays.png":"cleverapps/res/mergecraft/game/ui/guidewindow/guidewindow_score_rays.png","#%n-%n_energy.png":"cleverapps/res/mergecraft/game/ui/guidewindow/guidewindow_energy.png","#%n-treasure-stage3.png":"cleverapps/res/mergecraft/game/units/treasure/stage3.png","#%n-%n_rating.png":"cleverapps/res/mergecraft/game/ui/guidewindow/guidewindow_rating.png",
"#%n-worker_batlepass.png":"cleverapps/res/mergecraft/game/ui/guidewindow/worker_batlepass.png","#%n-prizes_heap.png":"cleverapps/res/mergecraft/game/ui/guidewindow/prizes_heap.png","#%n-%n_mines.png":"cleverapps/res/mergecraft/game/ui/guidewindow/guidewindow_mines.png","#%n-%n_pickaxe.png":"cleverapps/res/mergecraft/game/ui/guidewindow/guidewindow_pickaxe.png","#%n-%n_rewards.png":"cleverapps/res/mergecraft/game/ui/guidewindow/guidewindow_rewards.png"},halloween:{"#%n-%n_decor_1.png":"cleverapps/res/bundles/halloween/halloween_decor_1.png","#%n-%n_decor_2.png":"cleverapps/res/bundles/halloween/halloween_decor_2.png","#%n-%n_decor_forest.png":"cleverapps/res/bundles/halloween/halloween_decor_forest.png","#%n-%n_pumpkins.png":"cleverapps/res/bundles/halloween/halloween_pumpkins.png","#%n-%n_roots_top_left.png":"cleverapps/res/bundles/halloween/halloween_roots_top_left.png","#%n-%n_roots_top_right.png":"cleverapps/res/bundles/halloween/halloween_roots_top_right.png",
"@jsons/%n_jack-26aa44dede.json":"cleverapps/res/bundles/halloween/shop_animation/halloween_jack.json","@jsons/%n_candle-fedb3d9112.json":"cleverapps/res/bundles/halloween/game_windows_animation/halloween_candle.json","@jsons/%n_owls-e2cf4ee13f.json":"cleverapps/res/bundles/halloween/toolbar_windows_animation/halloween_owls.json"},help_from_friends:{},hero:{},infoview:{},language_ar:{},language_de:{},language_en:{},language_es:{},language_fr:{},language_it:{},language_ja:{},language_ko:{},language_lv:{},language_nl:{},language_pl:{},language_pt:{},language_ru:{},language_tr:{},language_zh:{},languageswindow:{"#%n-languages-check.png":"cleverapps/res/mergecraft/windows/languages/check.png","#%n-languages-bg.png":"cleverapps/res/mergecraft/windows/languages/bg.png","#%n-languages-bg_on.png":"cleverapps/res/mergecraft/windows/languages/bg_on.png"},lantern:{},lantern_window:{},levelupwindow:{"@jsons/levelup-127644b63e.json":"cleverapps/res/mergecraft/windows/levelup/levelup.json",
"~sounds/levelup-e235634d89.mp3":"cleverapps/res/mergecraft/sfx/game/levelup.mp3"},loading_scene_backgrounds:{},lose_window:{"@jsons/lose-5481b24ffc.json":"cleverapps/res/mergecraft/spines/lose/lose.json"},lottery:{},magic_tournament:{},main:{"#%n-notification-notification_bg.png":"cleverapps/res/mergecraft/notification/notification_bg.png","#%n-socialicons-fb_icon.png":"cleverapps/res/socialicons/fb_icon.png","#%n-socialicons-ok_icon.png":"cleverapps/res/socialicons/ok_icon.png","#%n-socialicons-vk_icon.png":"cleverapps/res/socialicons/vk_icon.png","#%n-socialicons-nk_icon.png":"cleverapps/res/socialicons/nk_icon.png","#%n-socialicons-mm_icon.png":"cleverapps/res/socialicons/mm_icon.png","#%n-socialicons-fs_icon.png":"cleverapps/res/socialicons/fs_icon.png","#%n-socialicons-draugiem_icon.png":"cleverapps/res/socialicons/draugiem_icon.png","#%n-socialicons-mobage_icon.png":"cleverapps/res/socialicons/mobage_icon.png",
"#%n-socialicons-google_icon.png":"cleverapps/res/socialicons/google_icon.png","#%n-socialicons-apple_icon.png":"cleverapps/res/socialicons/apple_icon.png","#%n-socialicons-white_button.png":"cleverapps/res/socialicons/white_button.png","#%n-socialicons-white_outline_button.png":"cleverapps/res/socialicons/white_outline_button.png","#%n-socialicons-white_outline_button_on.png":"cleverapps/res/socialicons/white_outline_button_on.png","#%n-socialicons-white_shadow_button.png":"cleverapps/res/socialicons/white_shadow_button.png","#%n-socialicons-white_shadow_button_on.png":"cleverapps/res/socialicons/white_shadow_button_on.png","#%n-socialicons-blue_outline_button.png":"cleverapps/res/socialicons/blue_outline_button.png","#%n-socialicons-blue_outline_button_on.png":"cleverapps/res/socialicons/blue_outline_button_on.png","#%n-selectfriends-checkbox_sf.png":"cleverapps/res/mergecraft/windows/selectfriends/checkbox_sf.png",
"#%n-selectfriends-checkbox_mark.png":"cleverapps/res/mergecraft/windows/selectfriends/checkbox_mark.png","#%n-tournament-light_bg.png":"cleverapps/res/mergecraft/windows/tournament/light_bg.png","#%n-tournament-light_bg_you.png":"cleverapps/res/mergecraft/windows/tournament/light_bg_you.png","#%n-tournament-row_player.png":"cleverapps/res/mergecraft/windows/tournament/row_player.png","#%n-tournament-row_you.png":"cleverapps/res/mergecraft/windows/tournament/row_you.png","#%n-leaderboard-1_place.png":"cleverapps/res/mergecraft/windows/leaderboard/1_place.png","#%n-leaderboard-2_place.png":"cleverapps/res/mergecraft/windows/leaderboard/2_place.png","#%n-leaderboard-3_place.png":"cleverapps/res/mergecraft/windows/leaderboard/3_place.png","#%n-orderswindow-tab_2.png":"cleverapps/res/mergecraft/game/ui/orderswindow/tab_2.png","#%n-orderswindow-tab_1.png":"cleverapps/res/mergecraft/game/ui/orderswindow/tab_1.png",
"#%n-orderswindow-game_ui_tab_bg.png":"cleverapps/res/mergecraft/game/ui/orderswindow/game_ui_tab_bg.png","#%n-avatars-android_avatar.png":"cleverapps/res/avatars/android_avatar-46fa3ef33f.png","#%n-avatars-ios_avatar.png":"cleverapps/res/avatars/ios_avatar-98224def0b.png","#%n-avatars-user_avatar.png":"cleverapps/res/mergecraft/avatars/user_avatar.png","#%n-avatars-default_avatar.jpg":"cleverapps/res/mergecraft/avatars/default_avatar.jpg","#%n-windows-window_title_bg.png":"cleverapps/res/mergecraft/windows/window_title_bg.png","#%n-missions-mission_letter.png":"cleverapps/res/mergecraft/missions/mission_letter.png","#%n-tooltip-box.png":"cleverapps/res/ui/plaid/tooltip/box.png","#%n-tooltip-arrow.png":"cleverapps/res/ui/plaid/tooltip/arrow.png","#%n-tooltip-arrow2.png":"cleverapps/res/ui/plaid/tooltip/arrow2.png","#%n-reward_icons-ruby_small.png":"cleverapps/res/mergecraft/bundles/reward_icons/ruby_small.png","#%n-reward_icons-ruby.png":"cleverapps/res/mergecraft/bundles/reward_icons/ruby.png",
"#%n-reward_icons-coin.png":"cleverapps/res/mergecraft/bundles/reward_icons/coin.png","#%n-reward_icons-exp.png":"cleverapps/res/mergecraft/bundles/reward_icons/exp.png","#%n-reward_icons-wand.png":"cleverapps/res/mergecraft/bundles/reward_icons/wand.png","#%n-reward_icons-worker.png":"cleverapps/res/mergecraft/bundles/reward_icons/worker.png","#%n-reward_icons-energy.png":"cleverapps/res/mergecraft/bundles/reward_icons/energy.png","#%n-reward_icons-energy_shop.png":"cleverapps/res/mergecraft/bundles/reward_icons/energy_shop.png","#%n-reward_icons-ruby_shop.png":"cleverapps/res/mergecraft/bundles/reward_icons/ruby_shop.png","#%n-reward_icons-coin_shop.png":"cleverapps/res/mergecraft/bundles/reward_icons/coin_shop.png","#%n-orderswindow-attention_exclamation_large.png":"cleverapps/res/mergecraft/game/ui/orderswindow/attention_exclamation_large.png","#%n-tabs-specials.png":"cleverapps/res/mergecraft/game/ui/icons/tabs/specials.png",
"#%n-tabs-orders.png":"cleverapps/res/mergecraft/game/ui/icons/tabs/orders.png","#%n-tabs-recipes.png":"cleverapps/res/mergecraft/game/ui/icons/tabs/recipes.png","#%n-tabs-ingredients.png":"cleverapps/res/mergecraft/game/ui/icons/tabs/ingredients.png","#%n-tabs-chest.png":"cleverapps/res/mergecraft/game/ui/icons/tabs/chest.png","#%n-tabs-fruit.png":"cleverapps/res/mergecraft/game/ui/icons/tabs/fruit.png","#%n-tabs-heroes.png":"cleverapps/res/mergecraft/game/ui/icons/tabs/heroes.png","#%n-tabs-resource.png":"cleverapps/res/mergecraft/game/ui/icons/tabs/resource.png","#%n-tabs-source.png":"cleverapps/res/mergecraft/game/ui/icons/tabs/source.png","#%n-tabs-valuable.png":"cleverapps/res/mergecraft/game/ui/icons/tabs/valuable.png","#%n-orderswindow-game_ui_tab_header_on.png":"cleverapps/res/mergecraft/game/ui/orderswindow/game_ui_tab_header_on.png","#%n-orderswindow-foreground.png":"cleverapps/res/mergecraft/game/ui/orderswindow/foreground.png",
"#%n-orderswindow-close_button.png":"cleverapps/res/mergecraft/game/ui/orderswindow/close_button.png","#%n-orderswindow-close_button_on.png":"cleverapps/res/mergecraft/game/ui/orderswindow/close_button_on.png","#%n-shared-adicon.png":"cleverapps/res/mergecraft/shared/adicon.png","#%n-tutorial-circle.png":"cleverapps/res/mergecraft/tutorial/circle.png","#%n-tutorial-hand.png":"cleverapps/res/mergecraft/tutorial/hand.png","#%n-marvin-round-nostroke-62pt-0.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/0.png","#%n-marvin-round-nostroke-62pt-1.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/1.png","#%n-marvin-round-nostroke-62pt-2.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/2.png","#%n-marvin-round-nostroke-62pt-3.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/3.png","#%n-marvin-round-nostroke-62pt-4.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/4.png",
"#%n-marvin-round-nostroke-62pt-5.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/5.png","#%n-marvin-round-nostroke-62pt-6.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/6.png","#%n-marvin-round-nostroke-62pt-7.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/7.png","#%n-marvin-round-nostroke-62pt-8.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/8.png","#%n-marvin-round-nostroke-62pt-9.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/9.png","#%n-marvin-round-nostroke-62pt-colon.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/colon.png","#%n-marvin-round-nostroke-62pt-slash.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/slash.png","#%n-marvin-round-nostroke-62pt-plus.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/plus.png","#%n-marvin-round-nostroke-62pt-minus.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/minus.png",
"#%n-marvin-round-nostroke-62pt-x.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/x.png","#%n-marvin-round-nostroke-62pt-space.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/space.png","#%n-marvin-round-45pt-0.png":"cleverapps/res/common/fonts/marvin-round/45pt/0.png","#%n-marvin-round-45pt-1.png":"cleverapps/res/common/fonts/marvin-round/45pt/1.png","#%n-marvin-round-45pt-2.png":"cleverapps/res/common/fonts/marvin-round/45pt/2.png","#%n-marvin-round-45pt-3.png":"cleverapps/res/common/fonts/marvin-round/45pt/3.png","#%n-marvin-round-45pt-4.png":"cleverapps/res/common/fonts/marvin-round/45pt/4.png","#%n-marvin-round-45pt-5.png":"cleverapps/res/common/fonts/marvin-round/45pt/5.png","#%n-marvin-round-45pt-6.png":"cleverapps/res/common/fonts/marvin-round/45pt/6.png","#%n-marvin-round-45pt-7.png":"cleverapps/res/common/fonts/marvin-round/45pt/7.png","#%n-marvin-round-45pt-8.png":"cleverapps/res/common/fonts/marvin-round/45pt/8.png",
"#%n-marvin-round-45pt-9.png":"cleverapps/res/common/fonts/marvin-round/45pt/9.png","#%n-marvin-round-45pt-colon.png":"cleverapps/res/common/fonts/marvin-round/45pt/colon.png","#%n-marvin-round-45pt-slash.png":"cleverapps/res/common/fonts/marvin-round/45pt/slash.png","#%n-marvin-round-45pt-plus.png":"cleverapps/res/common/fonts/marvin-round/45pt/plus.png","#%n-marvin-round-45pt-minus.png":"cleverapps/res/common/fonts/marvin-round/45pt/minus.png","#%n-marvin-round-45pt-x.png":"cleverapps/res/common/fonts/marvin-round/45pt/x.png","#%n-marvin-round-45pt-space.png":"cleverapps/res/common/fonts/marvin-round/45pt/space.png","#%n-marvin-round-62pt-0.png":"cleverapps/res/common/fonts/marvin-round/62pt/0.png","#%n-marvin-round-62pt-1.png":"cleverapps/res/common/fonts/marvin-round/62pt/1.png","#%n-marvin-round-62pt-2.png":"cleverapps/res/common/fonts/marvin-round/62pt/2.png","#%n-marvin-round-62pt-3.png":"cleverapps/res/common/fonts/marvin-round/62pt/3.png",
"#%n-marvin-round-62pt-4.png":"cleverapps/res/common/fonts/marvin-round/62pt/4.png","#%n-marvin-round-62pt-5.png":"cleverapps/res/common/fonts/marvin-round/62pt/5.png","#%n-marvin-round-62pt-6.png":"cleverapps/res/common/fonts/marvin-round/62pt/6.png","#%n-marvin-round-62pt-7.png":"cleverapps/res/common/fonts/marvin-round/62pt/7.png","#%n-marvin-round-62pt-8.png":"cleverapps/res/common/fonts/marvin-round/62pt/8.png","#%n-marvin-round-62pt-9.png":"cleverapps/res/common/fonts/marvin-round/62pt/9.png","#%n-marvin-round-62pt-colon.png":"cleverapps/res/common/fonts/marvin-round/62pt/colon.png","#%n-marvin-round-62pt-slash.png":"cleverapps/res/common/fonts/marvin-round/62pt/slash.png","#%n-marvin-round-62pt-plus.png":"cleverapps/res/common/fonts/marvin-round/62pt/plus.png","#%n-marvin-round-62pt-minus.png":"cleverapps/res/common/fonts/marvin-round/62pt/minus.png","#%n-marvin-round-62pt-x.png":"cleverapps/res/common/fonts/marvin-round/62pt/x.png",
"#%n-marvin-round-62pt-space.png":"cleverapps/res/common/fonts/marvin-round/62pt/space.png","#%n-marvin-round-76pt-0.png":"cleverapps/res/common/fonts/marvin-round/76pt/0.png","#%n-marvin-round-76pt-1.png":"cleverapps/res/common/fonts/marvin-round/76pt/1.png","#%n-marvin-round-76pt-2.png":"cleverapps/res/common/fonts/marvin-round/76pt/2.png","#%n-marvin-round-76pt-3.png":"cleverapps/res/common/fonts/marvin-round/76pt/3.png","#%n-marvin-round-76pt-4.png":"cleverapps/res/common/fonts/marvin-round/76pt/4.png","#%n-marvin-round-76pt-5.png":"cleverapps/res/common/fonts/marvin-round/76pt/5.png","#%n-marvin-round-76pt-6.png":"cleverapps/res/common/fonts/marvin-round/76pt/6.png","#%n-marvin-round-76pt-7.png":"cleverapps/res/common/fonts/marvin-round/76pt/7.png","#%n-marvin-round-76pt-8.png":"cleverapps/res/common/fonts/marvin-round/76pt/8.png","#%n-marvin-round-76pt-9.png":"cleverapps/res/common/fonts/marvin-round/76pt/9.png",
"#%n-marvin-round-76pt-colon.png":"cleverapps/res/common/fonts/marvin-round/76pt/colon.png","#%n-marvin-round-76pt-slash.png":"cleverapps/res/common/fonts/marvin-round/76pt/slash.png","#%n-marvin-round-76pt-plus.png":"cleverapps/res/common/fonts/marvin-round/76pt/plus.png","#%n-marvin-round-76pt-minus.png":"cleverapps/res/common/fonts/marvin-round/76pt/minus.png","#%n-marvin-round-76pt-x.png":"cleverapps/res/common/fonts/marvin-round/76pt/x.png","#%n-marvin-round-76pt-space.png":"cleverapps/res/common/fonts/marvin-round/76pt/space.png","#%n-orderswindow-attention_exclamation.png":"cleverapps/res/mergecraft/game/ui/orderswindow/attention_exclamation.png","#%n-controlbuttons-menu.png":"cleverapps/res/mergecraft/controlbuttons/menu.png","#%n-controlbuttons-menu_button.png":"cleverapps/res/mergecraft/controlbuttons/menu_button.png","#%n-controlbuttons-menu_button_on.png":"cleverapps/res/mergecraft/controlbuttons/menu_button_on.png",
"#%n-controlbuttons-fullscreen_icon.png":"cleverapps/res/mergecraft/controlbuttons/fullscreen_icon.png","#%n-controlbuttons-back_button.png":"cleverapps/res/mergecraft/controlbuttons/back_button.png","#%n-controlbuttons-back_button_on.png":"cleverapps/res/mergecraft/controlbuttons/back_button_on.png","#%n-controlbuttons-back.png":"cleverapps/res/mergecraft/controlbuttons/back.png","#%n-menubar-energy.png":"cleverapps/res/mergecraft/menubar/energy.png","#%n-menubar-ruby.png":"cleverapps/res/mergecraft/menubar/ruby.png","#%n-menubar-bar_bg.png":"cleverapps/res/mergecraft/menubar/bar_bg.png","#%n-menubar-plus.png":"cleverapps/res/mergecraft/menubar/plus.png","#%n-menubar-plus_on.png":"cleverapps/res/mergecraft/menubar/plus_on.png","#%n-menubar-bar_timer.png":"cleverapps/res/mergecraft/menubar/bar_timer.png","#%n-menubar-timer.png":"cleverapps/res/mergecraft/menubar/timer.png","#%n-level-progressbar.png":"cleverapps/res/mergecraft/level/progressbar.png",
"#%n-level-level_round.png":"cleverapps/res/mergecraft/level/level_round.png","#%n-menubar-coin.png":"cleverapps/res/mergecraft/menubar/coin.png","#%n-menubar-wand.png":"cleverapps/res/mergecraft/menubar/wand.png","#%n-menubar-worker.png":"cleverapps/res/mergecraft/menubar/worker.png","#%n-buttons-button.png":"cleverapps/res/mergecraft/buttons/button.png","#%n-buttons-button_on.png":"cleverapps/res/mergecraft/buttons/button_on.png","#%n-buttons-button_off.png":"cleverapps/res/mergecraft/buttons/button_off.png","#%n-buttons-button_blue.png":"cleverapps/res/mergecraft/buttons/button_blue.png","#%n-buttons-button_blue_on.png":"cleverapps/res/mergecraft/buttons/button_blue_on.png","#%n-buttons-small_blue_button.png":"cleverapps/res/mergecraft/buttons/small_blue_button.png","#%n-buttons-small_blue_button_on.png":"cleverapps/res/mergecraft/buttons/small_blue_button_on.png","#%n-buttons-help_small.png":"cleverapps/res/mergecraft/buttons/help_small.png",
"#%n-buttons-help_small_on.png":"cleverapps/res/mergecraft/buttons/help_small_on.png","#%n-buttons-exit_icon.png":"cleverapps/res/mergecraft/buttons/exit_icon.png","#%n-buttons-scene_exit.png":"cleverapps/res/mergecraft/buttons/scene_exit.png","#%n-buttons-small_green_button.png":"cleverapps/res/mergecraft/buttons/small_green_button.png","#%n-buttons-small_green_button_on.png":"cleverapps/res/mergecraft/buttons/small_green_button_on.png","#%n-sounds-music_off.png":"cleverapps/res/mergecraft/buttons/sounds/music_off.png","#%n-sounds-music_on.png":"cleverapps/res/mergecraft/buttons/sounds/music_on.png","#%n-sounds-sound_off.png":"cleverapps/res/mergecraft/buttons/sounds/sound_off.png","#%n-sounds-sound_on.png":"cleverapps/res/mergecraft/buttons/sounds/sound_on.png","#%n-buttons-close_small.png":"cleverapps/res/mergecraft/buttons/close_small.png","#%n-buttons-close_small_on.png":"cleverapps/res/mergecraft/buttons/close_small_on.png",
"#%n-buttons-red_button.png":"cleverapps/res/mergecraft/buttons/red_button.png","#%n-buttons-red_button_on.png":"cleverapps/res/mergecraft/buttons/red_button_on.png","#%n-sidebar-icon_bg.png":"cleverapps/res/mergecraft/sidebar/icon_bg.png","#%n-sidebar-lock_sidebar.png":"cleverapps/res/bundles/sidebar/lock_sidebar.png","#%n-sidebar-icon_text_bg.png":"cleverapps/res/mergecraft/sidebar/icon_text_bg.png","#%n-friend_messages-bounty_ready_icon.png":"cleverapps/res/mergecraft/friend_messages/bounty_ready_icon.png","#%n-friend_messages-accept_stuck_coins_icon.png":"cleverapps/res/mergecraft/friend_messages/accept_stuck_coins_icon.png","#%n-avatars-avatar_frame.png":"cleverapps/res/avatars/avatar_frame-c5b3956aac.png","#%n-avatars-avatar_frame2.png":"cleverapps/res/avatars/avatar_frame2-2da1cffe98.png","#%n-dialogues-bg.png":"cleverapps/res/mergecraft/bundles/dialogues/bg.png","#%n-dialogues-char_name_bg.png":"cleverapps/res/mergecraft/bundles/dialogues/char_name_bg.png",
"#%n-dialogues-arrow_bg.png":"cleverapps/res/mergecraft/bundles/dialogues/arrow_bg.png","#%n-dialogues-mini_bg.png":"cleverapps/res/mergecraft/bundles/dialogues/mini_bg.png","#%n-orderswindow-details_background.png":"cleverapps/res/mergecraft/game/ui/orderswindow/details_background.png","#%n-orderswindow-hero_bg.png":"cleverapps/res/mergecraft/game/ui/orderswindow/hero_bg.png","#%n-orderswindow-chosen_hero_bg.png":"cleverapps/res/mergecraft/game/ui/orderswindow/chosen_hero_bg.png","#%n-orderswindow-plus.png":"cleverapps/res/mergecraft/game/ui/orderswindow/plus.png","#%n-orderswindow-equally.png":"cleverapps/res/mergecraft/game/ui/orderswindow/equally.png","#%n-hint-worker_hint.png":"cleverapps/res/mergecraft/game/ui/hint/worker_hint.png","#%n-orderswindow-icon_background.png":"cleverapps/res/mergecraft/game/ui/orderswindow/icon_background.png","#%n-game-bar_bg.png":"cleverapps/res/mergecraft/game/bar_bg.png",
"#%n-speedup-speedup_sandglass.png":"cleverapps/res/mergecraft/game/ui/speedup/speedup_sandglass.png","#%n-heroes-unknown.png":"cleverapps/res/mergecraft/game/ui/icons/heroes/unknown.png","#%n-heroes-dwarf.png":"cleverapps/res/mergecraft/game/ui/icons/heroes/dwarf.png","#%n-heroes-king.png":"cleverapps/res/mergecraft/game/ui/icons/heroes/king.png","#%n-heroes-bear.png":"cleverapps/res/mergecraft/game/ui/icons/heroes/bear.png","#%n-heroes-elf.png":"cleverapps/res/mergecraft/game/ui/icons/heroes/elf.png","#%n-heroes-warlock.png":"cleverapps/res/mergecraft/game/ui/icons/heroes/warlock.png","#%n-heroes-troll.png":"cleverapps/res/mergecraft/game/ui/icons/heroes/troll.png","#%n-orderswindow-horizontal_scroll_foreground.png":"cleverapps/res/mergecraft/game/ui/orderswindow/horizontal_scroll_foreground.png","#%n-speedup-speedup_clock.png":"cleverapps/res/mergecraft/game/ui/speedup/speedup_clock.png","#%n-buttons-button_energy.png":"cleverapps/res/mergecraft/game/ui/buttons/button_energy.png",
"@jsons/loading-d6cee9aa0e.json":"cleverapps/res/mergecraft/wait/loading.json","@jsons/reward_animation-287c7e5ee5.json":"cleverapps/res/mergecraft/spines/reward/reward_animation.json","@jsons/play_button_transition-86d4e931e5.json":"cleverapps/res/spines/play_button_transition/play_button_transition.json","@jsons/level_crown-e904aad65e.json":"cleverapps/res/mergecraft/level/level_crown/level_crown.json","@jsons/icon_pack1-7fbeaf6294.json":"cleverapps/res/mergecraft/sidebar/pack1/icon_pack1.json","@jsons/icon_pack2-cc85b06051.json":"cleverapps/res/mergecraft/sidebar/pack2/icon_pack2.json","@jsons/icon_pack3-01a54e22d1.json":"cleverapps/res/mergecraft/sidebar/pack3/icon_pack3.json","@jsons/energy_tournament-0c6bde045e.json":"cleverapps/res/mergecraft/sidebar/energy_feast/energy_tournament.json","@jsons/battlepass_icon-9b2581bfc4.json":"cleverapps/res/mergecraft/sidebar/battlepass/battlepass_icon.json",
"@jsons/orders_icon-3704aded22.json":"cleverapps/res/mergecraft/sidebar/orders/orders_icon.json","@jsons/market_icon-b2c01578b1.json":"cleverapps/res/mergecraft/sidebar/market/market_icon.json","@jsons/units_icon-b7f7e718c4.json":"cleverapps/res/mergecraft/sidebar/units/units_icon.json","@jsons/transition-1def927b5d.json":"cleverapps/res/mergecraft/transition/transition.json","@jsons/dwarf_dialogue-9a98cb93aa.json":"cleverapps/res/mergecraft/bundles/dialogues/dwarf/dwarf_dialogue.json","@jsons/worker_dialogue-15774db988.json":"cleverapps/res/mergecraft/bundles/dialogues/worker/worker_dialogue.json","@jsons/king_dialogue-d39ef28038.json":"cleverapps/res/mergecraft/bundles/dialogues/king/king_dialogue.json","@jsons/bear_dialogue-278fac3cde.json":"cleverapps/res/mergecraft/bundles/dialogues/bear/bear_dialogue.json","@jsons/elf_dialogue-02edab26ca.json":"cleverapps/res/mergecraft/bundles/dialogues/elf/elf_dialogue.json",
"@jsons/warlock_dialogue-7e6976dbfc.json":"cleverapps/res/mergecraft/bundles/dialogues/warlock/warlock_dialogue.json","@jsons/troll_dialogue-948b91fed2.json":"cleverapps/res/mergecraft/bundles/dialogues/troll/troll_dialogue.json","@jsons/miner_dialogue-a25b10be99.json":"cleverapps/res/mergecraft/bundles/dialogues/miner/miner_dialogue.json","@jsons/seller-bbdbd6ffb6.json":"cleverapps/res/mergecraft/bundles/dialogues/seller/seller.json","@jsons/orders-202ff163f6.json":"cleverapps/res/mergecraft/game/ui/orderswindow/orders/orders.json","~sounds/click-3d30f98dd7.mp3":"cleverapps/res/mergecraft/sfx/main/click.mp3","~sounds/coins-8e71c0d2cf.mp3":"cleverapps/res/mergecraft/sfx/main/coins.mp3","~sounds/notification-4fd5211563.mp3":"cleverapps/res/mergecraft/sfx/main/notification.mp3","~sounds/window-f2adec4f73.mp3":"cleverapps/res/mergecraft/sfx/main/window.mp3","~sounds/reward-6fd002b7a1.mp3":"cleverapps/res/mergecraft/sfx/game/reward.mp3"},map_decorators:{},memorial:{},menubar:{},merge:{},
mergeui:{},metha_simple_main:{},metha_top_layer_0:{},mineable:{},minesweeper:{"#%n-progressbar.png":"cleverapps/res/mergecraft/bundles/minesweeper/progressbar.png","#%n-guide_button.png":"cleverapps/res/mergecraft/bundles/minesweeper/guide_button.png","#%n-guide_button_on.png":"cleverapps/res/mergecraft/bundles/minesweeper/guide_button_on.png","#%n-orderswindow-icon_background.png":"cleverapps/res/mergecraft/game/ui/orderswindow/icon_background.png","#%n-reward_icons-ruby_small.png":"cleverapps/res/mergecraft/bundles/reward_icons/ruby_small.png","#%n-reward_icons-ruby.png":"cleverapps/res/mergecraft/bundles/reward_icons/ruby.png","#%n-reward_icons-coin.png":"cleverapps/res/mergecraft/bundles/reward_icons/coin.png","#%n-reward_icons-exp.png":"cleverapps/res/mergecraft/bundles/reward_icons/exp.png","#%n-reward_icons-wand.png":"cleverapps/res/mergecraft/bundles/reward_icons/wand.png","#%n-reward_icons-worker.png":"cleverapps/res/mergecraft/bundles/reward_icons/worker.png",
"#%n-reward_icons-energy.png":"cleverapps/res/mergecraft/bundles/reward_icons/energy.png","#%n-reward_icons-energy_shop.png":"cleverapps/res/mergecraft/bundles/reward_icons/energy_shop.png","#%n-reward_icons-ruby_shop.png":"cleverapps/res/mergecraft/bundles/reward_icons/ruby_shop.png","#%n-reward_icons-coin_shop.png":"cleverapps/res/mergecraft/bundles/reward_icons/coin_shop.png","#%n-marvin-round-nostroke-62pt-0.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/0.png","#%n-marvin-round-nostroke-62pt-1.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/1.png","#%n-marvin-round-nostroke-62pt-2.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/2.png","#%n-marvin-round-nostroke-62pt-3.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/3.png","#%n-marvin-round-nostroke-62pt-4.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/4.png","#%n-marvin-round-nostroke-62pt-5.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/5.png",
"#%n-marvin-round-nostroke-62pt-6.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/6.png","#%n-marvin-round-nostroke-62pt-7.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/7.png","#%n-marvin-round-nostroke-62pt-8.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/8.png","#%n-marvin-round-nostroke-62pt-9.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/9.png","#%n-marvin-round-nostroke-62pt-colon.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/colon.png","#%n-marvin-round-nostroke-62pt-slash.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/slash.png","#%n-marvin-round-nostroke-62pt-plus.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/plus.png","#%n-marvin-round-nostroke-62pt-minus.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/minus.png","#%n-marvin-round-nostroke-62pt-x.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/x.png",
"#%n-marvin-round-nostroke-62pt-space.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/space.png","#%n-marvin-round-45pt-0.png":"cleverapps/res/common/fonts/marvin-round/45pt/0.png","#%n-marvin-round-45pt-1.png":"cleverapps/res/common/fonts/marvin-round/45pt/1.png","#%n-marvin-round-45pt-2.png":"cleverapps/res/common/fonts/marvin-round/45pt/2.png","#%n-marvin-round-45pt-3.png":"cleverapps/res/common/fonts/marvin-round/45pt/3.png","#%n-marvin-round-45pt-4.png":"cleverapps/res/common/fonts/marvin-round/45pt/4.png","#%n-marvin-round-45pt-5.png":"cleverapps/res/common/fonts/marvin-round/45pt/5.png","#%n-marvin-round-45pt-6.png":"cleverapps/res/common/fonts/marvin-round/45pt/6.png","#%n-marvin-round-45pt-7.png":"cleverapps/res/common/fonts/marvin-round/45pt/7.png","#%n-marvin-round-45pt-8.png":"cleverapps/res/common/fonts/marvin-round/45pt/8.png","#%n-marvin-round-45pt-9.png":"cleverapps/res/common/fonts/marvin-round/45pt/9.png",
"#%n-marvin-round-45pt-colon.png":"cleverapps/res/common/fonts/marvin-round/45pt/colon.png","#%n-marvin-round-45pt-slash.png":"cleverapps/res/common/fonts/marvin-round/45pt/slash.png","#%n-marvin-round-45pt-plus.png":"cleverapps/res/common/fonts/marvin-round/45pt/plus.png","#%n-marvin-round-45pt-minus.png":"cleverapps/res/common/fonts/marvin-round/45pt/minus.png","#%n-marvin-round-45pt-x.png":"cleverapps/res/common/fonts/marvin-round/45pt/x.png","#%n-marvin-round-45pt-space.png":"cleverapps/res/common/fonts/marvin-round/45pt/space.png","#%n-marvin-round-62pt-0.png":"cleverapps/res/common/fonts/marvin-round/62pt/0.png","#%n-marvin-round-62pt-1.png":"cleverapps/res/common/fonts/marvin-round/62pt/1.png","#%n-marvin-round-62pt-2.png":"cleverapps/res/common/fonts/marvin-round/62pt/2.png","#%n-marvin-round-62pt-3.png":"cleverapps/res/common/fonts/marvin-round/62pt/3.png","#%n-marvin-round-62pt-4.png":"cleverapps/res/common/fonts/marvin-round/62pt/4.png",
"#%n-marvin-round-62pt-5.png":"cleverapps/res/common/fonts/marvin-round/62pt/5.png","#%n-marvin-round-62pt-6.png":"cleverapps/res/common/fonts/marvin-round/62pt/6.png","#%n-marvin-round-62pt-7.png":"cleverapps/res/common/fonts/marvin-round/62pt/7.png","#%n-marvin-round-62pt-8.png":"cleverapps/res/common/fonts/marvin-round/62pt/8.png","#%n-marvin-round-62pt-9.png":"cleverapps/res/common/fonts/marvin-round/62pt/9.png","#%n-marvin-round-62pt-colon.png":"cleverapps/res/common/fonts/marvin-round/62pt/colon.png","#%n-marvin-round-62pt-slash.png":"cleverapps/res/common/fonts/marvin-round/62pt/slash.png","#%n-marvin-round-62pt-plus.png":"cleverapps/res/common/fonts/marvin-round/62pt/plus.png","#%n-marvin-round-62pt-minus.png":"cleverapps/res/common/fonts/marvin-round/62pt/minus.png","#%n-marvin-round-62pt-x.png":"cleverapps/res/common/fonts/marvin-round/62pt/x.png","#%n-marvin-round-62pt-space.png":"cleverapps/res/common/fonts/marvin-round/62pt/space.png",
"#%n-marvin-round-76pt-0.png":"cleverapps/res/common/fonts/marvin-round/76pt/0.png","#%n-marvin-round-76pt-1.png":"cleverapps/res/common/fonts/marvin-round/76pt/1.png","#%n-marvin-round-76pt-2.png":"cleverapps/res/common/fonts/marvin-round/76pt/2.png","#%n-marvin-round-76pt-3.png":"cleverapps/res/common/fonts/marvin-round/76pt/3.png","#%n-marvin-round-76pt-4.png":"cleverapps/res/common/fonts/marvin-round/76pt/4.png","#%n-marvin-round-76pt-5.png":"cleverapps/res/common/fonts/marvin-round/76pt/5.png","#%n-marvin-round-76pt-6.png":"cleverapps/res/common/fonts/marvin-round/76pt/6.png","#%n-marvin-round-76pt-7.png":"cleverapps/res/common/fonts/marvin-round/76pt/7.png","#%n-marvin-round-76pt-8.png":"cleverapps/res/common/fonts/marvin-round/76pt/8.png","#%n-marvin-round-76pt-9.png":"cleverapps/res/common/fonts/marvin-round/76pt/9.png","#%n-marvin-round-76pt-colon.png":"cleverapps/res/common/fonts/marvin-round/76pt/colon.png",
"#%n-marvin-round-76pt-slash.png":"cleverapps/res/common/fonts/marvin-round/76pt/slash.png","#%n-marvin-round-76pt-plus.png":"cleverapps/res/common/fonts/marvin-round/76pt/plus.png","#%n-marvin-round-76pt-minus.png":"cleverapps/res/common/fonts/marvin-round/76pt/minus.png","#%n-marvin-round-76pt-x.png":"cleverapps/res/common/fonts/marvin-round/76pt/x.png","#%n-marvin-round-76pt-space.png":"cleverapps/res/common/fonts/marvin-round/76pt/space.png","#%n-menubar-energy.png":"cleverapps/res/mergecraft/menubar/energy.png","#%n-menubar-ruby.png":"cleverapps/res/mergecraft/menubar/ruby.png","#%n-menubar-bar_bg.png":"cleverapps/res/mergecraft/menubar/bar_bg.png","#%n-menubar-plus.png":"cleverapps/res/mergecraft/menubar/plus.png","#%n-menubar-plus_on.png":"cleverapps/res/mergecraft/menubar/plus_on.png","#%n-menubar-bar_timer.png":"cleverapps/res/mergecraft/menubar/bar_timer.png","#%n-menubar-timer.png":"cleverapps/res/mergecraft/menubar/timer.png",
"#%n-orderswindow-attention_exclamation_large.png":"cleverapps/res/mergecraft/game/ui/orderswindow/attention_exclamation_large.png","#%n-level-progressbar.png":"cleverapps/res/mergecraft/level/progressbar.png","#%n-level-level_round.png":"cleverapps/res/mergecraft/level/level_round.png","#%n-menubar-coin.png":"cleverapps/res/mergecraft/menubar/coin.png","#%n-menubar-wand.png":"cleverapps/res/mergecraft/menubar/wand.png","#%n-menubar-worker.png":"cleverapps/res/mergecraft/menubar/worker.png","@jsons/%n-60875f8d45.json":"cleverapps/res/mergecraft/bundles/minesweeper/minesweeper/minesweeper.json","@jsons/mine_bg-8f1ab5b900.json":"cleverapps/res/mergecraft/bundles/minesweeper/mine_bg/mine_bg.json","@jsons/pickaxe-ef40eb38d2.json":"cleverapps/res/mergecraft/bundles/minesweeper/pickaxe/pickaxe.json","@jsons/mine_victory-673e41778e.json":"cleverapps/res/mergecraft/bundles/minesweeper/mine_victory/mine_victory.json",
"@jsons/level_crown-e904aad65e.json":"cleverapps/res/mergecraft/level/level_crown/level_crown.json","~sounds/sh_s_mine_pick-0a4b67c384.mp3":"cleverapps/res/mergecraft/bundles/minesweeper/sh_s_mine_pick.mp3","~sounds/sh_s_mine_bomb-138b718681.mp3":"cleverapps/res/mergecraft/bundles/minesweeper/sh_s_mine_bomb.mp3","~sounds/mine_bonus-f9a6fcbb66.mp3":"cleverapps/res/mergecraft/bundles/minesweeper/mine_bonus.mp3","~sounds/dwarf_lose-dd54669226.mp3":"cleverapps/res/mergecraft/bundles/minesweeper/dwarf_lose.mp3","~sounds/dwarf_win-d54cd1a686.mp3":"cleverapps/res/mergecraft/bundles/minesweeper/dwarf_win.mp3","~sounds/sh_s_mine_win-b422bddbd6.mp3":"cleverapps/res/mergecraft/bundles/minesweeper/sh_s_mine_win.mp3","~sounds/sh_s_mine_no_bomb-d6e71bc122.mp3":"cleverapps/res/mergecraft/bundles/minesweeper/sh_s_mine_no_bomb.mp3","~sounds/mine_music-6e08d898f5.mp3":"cleverapps/res/mergecraft/bundles/minesweeper/mine_music.mp3"},moves:{},newelements:{
"#%n-icon_bg.png":"cleverapps/res/mergecraft/game/ui/newelements/icon_bg.png","@jsons/scroll-a3150f37dd.json":"cleverapps/res/mergecraft/game/ui/newelements/scroll/scroll.json","@jsons/shining-7974626fa1.json":"cleverapps/res/mergecraft/game/ui/quests/shining/shining.json","~sounds/quest_new-b06184316e.mp3":"cleverapps/res/mergecraft/sfx/game/quest_new.mp3","~sounds/quest_completed-2f7bbc5994.mp3":"cleverapps/res/mergecraft/sfx/game/quest_completed.mp3"},openchestwindow:{},orderswindow:{},particle:{},piggybank_window:{},promotion_adventure_en:{},promotion_adventure_ru:{},promotion_crocword_de:{},promotion_crocword_en:{},promotion_crocword_es:{},promotion_crocword_fr:{},promotion_crocword_it:{},promotion_crocword_ru:{},promotion_differences_en:{},promotion_differences_ru:{},promotion_heroes_en:{},promotion_heroes_ru:{},promotion_magicwords_de:{},promotion_magicwords_en:{},promotion_magicwords_es:{},promotion_magicwords_fr:{},promotion_magicwords_it:{},promotion_magicwords_ru:{},
promotion_mergecraft_en:{},promotion_mergecraft_ru:{},promotion_olympics_de:{},promotion_olympics_en:{},promotion_olympics_es:{},promotion_olympics_fr:{},promotion_olympics_it:{},promotion_olympics_ru:{},promotion_riddles_en:{},promotion_riddles_ru:{},promotion_runes_en:{},promotion_runes_ru:{},promotion_scramble_en:{},promotion_scramble_fr:{},promotion_scramble_ru:{},promotion_tripeaks_de:{},promotion_tripeaks_en:{},promotion_tripeaks_es:{},promotion_tripeaks_fr:{},promotion_tripeaks_it:{},promotion_tripeaks_ru:{},promotion_wordsoup_de:{},promotion_wordsoup_en:{},promotion_wordsoup_es:{},promotion_wordsoup_fr:{},promotion_wordsoup_it:{},promotion_wordsoup_ru:{},puzzle15:{"#%n-merge-1cristall_red.png":"cleverapps/res/bundles/ads/puzzle15/merge/1cristall_red.png","#%n-merge-2chesticon.png":"cleverapps/res/bundles/ads/puzzle15/merge/2chesticon.png","#%n-merge-3cubokicon.png":"cleverapps/res/bundles/ads/puzzle15/merge/3cubokicon.png",
"#%n-merge-4cubikicon.png":"cleverapps/res/bundles/ads/puzzle15/merge/4cubikicon.png","#%n-merge-5giftbox.png":"cleverapps/res/bundles/ads/puzzle15/merge/5giftbox.png","#%n-merge-6clipsgame.png":"cleverapps/res/bundles/ads/puzzle15/merge/6clipsgame.png","#%n-merge-7jokericon.png":"cleverapps/res/bundles/ads/puzzle15/merge/7jokericon.png","#%n-merge-8magniticon.png":"cleverapps/res/bundles/ads/puzzle15/merge/8magniticon.png","#%n-merge-9bowicon.png":"cleverapps/res/bundles/ads/puzzle15/merge/9bowicon.png","#%n-merge-10hearticon.png":"cleverapps/res/bundles/ads/puzzle15/merge/10hearticon.png","#%n-merge-11clubsicon.png":"cleverapps/res/bundles/ads/puzzle15/merge/11clubsicon.png","#%n-merge-12spadesicon.png":"cleverapps/res/bundles/ads/puzzle15/merge/12spadesicon.png","#%n-merge-13diamondsicon.png":"cleverapps/res/bundles/ads/puzzle15/merge/13diamondsicon.png","#%n-merge-14bombicon.png":"cleverapps/res/bundles/ads/puzzle15/merge/14bombicon.png",
"#%n-merge-15lockicon.png":"cleverapps/res/bundles/ads/puzzle15/merge/15lockicon.png","#%n-merge-16jeverlyicon.png":"cleverapps/res/bundles/ads/puzzle15/merge/16jeverlyicon.png","#%n-merge-17cherryicon.png":"cleverapps/res/bundles/ads/puzzle15/merge/17cherryicon.png","#%n-merge-18dollarsicon.png":"cleverapps/res/bundles/ads/puzzle15/merge/18dollarsicon.png","#%n-merge-19coinicon.png":"cleverapps/res/bundles/ads/puzzle15/merge/19coinicon.png","#%n-merge-20dollarcoin.png":"cleverapps/res/bundles/ads/puzzle15/merge/20dollarcoin.png","#%n-merge-21staricon.png":"cleverapps/res/bundles/ads/puzzle15/merge/21staricon.png","#%n-merge-22glassesicon.png":"cleverapps/res/bundles/ads/puzzle15/merge/22glassesicon.png","#%n-merge-tail.png":"cleverapps/res/bundles/ads/puzzle15/merge/tail.png","#%n-merge-table_frame.png":"cleverapps/res/bundles/ads/puzzle15/merge/table_frame.png","#%n-picture-picture1.png":"cleverapps/res/bundles/ads/puzzle15/picture/picture1.png",
"#%n-picture-picture2.png":"cleverapps/res/bundles/ads/puzzle15/picture/picture2.png","#%n-picture-picture3.png":"cleverapps/res/bundles/ads/puzzle15/picture/picture3.png","#%n-picture-picture4.png":"cleverapps/res/bundles/ads/puzzle15/picture/picture4.png","#%n-picture-picture5.png":"cleverapps/res/bundles/ads/puzzle15/picture/picture5.png","#%n-picture-picture6.png":"cleverapps/res/bundles/ads/puzzle15/picture/picture6.png","#%n-picture-picture7.png":"cleverapps/res/bundles/ads/puzzle15/picture/picture7.png","#%n-picture-picture8.png":"cleverapps/res/bundles/ads/puzzle15/picture/picture8.png","#%n-picture-picture9.png":"cleverapps/res/bundles/ads/puzzle15/picture/picture9.png","#%n-picture-picture_full.png":"cleverapps/res/bundles/ads/puzzle15/picture/picture_full.png","#%n-picture-piece.png":"cleverapps/res/bundles/ads/puzzle15/picture/piece.png","#%n-picture-1.png":"cleverapps/res/bundles/ads/puzzle15/picture/1.png",
"#%n-picture-2.png":"cleverapps/res/bundles/ads/puzzle15/picture/2.png","#%n-picture-3.png":"cleverapps/res/bundles/ads/puzzle15/picture/3.png","#%n-picture-4.png":"cleverapps/res/bundles/ads/puzzle15/picture/4.png","#%n-picture-5.png":"cleverapps/res/bundles/ads/puzzle15/picture/5.png","#%n-picture-6.png":"cleverapps/res/bundles/ads/puzzle15/picture/6.png","#%n-picture-7.png":"cleverapps/res/bundles/ads/puzzle15/picture/7.png","#%n-picture-8.png":"cleverapps/res/bundles/ads/puzzle15/picture/8.png","#%n-picture-picture_bg.png":"cleverapps/res/bundles/ads/puzzle15/picture/picture_bg.png","#%n-picture-move_arrows.png":"cleverapps/res/bundles/ads/puzzle15/picture/move_arrows.png","#%n-static-connect_line.png":"cleverapps/res/bundles/ads/puzzle15/static/connect_line.png","#%n-static-detach_square.png":"cleverapps/res/bundles/ads/puzzle15/static/detach_square.png","#%n-static-unit_star.png":"cleverapps/res/bundles/ads/puzzle15/static/unit_star.png",
"@jsons/sparkle-2cbca30ceb.json":"cleverapps/res/bundles/ads/puzzle15/sparkle/sparkle.json"},race:{"#%n-menubar-energy.png":"cleverapps/res/mergecraft/menubar/energy.png","#%n-menubar-ruby.png":"cleverapps/res/mergecraft/menubar/ruby.png","#%n-menubar-bar_bg.png":"cleverapps/res/mergecraft/menubar/bar_bg.png","#%n-menubar-plus.png":"cleverapps/res/mergecraft/menubar/plus.png","#%n-menubar-plus_on.png":"cleverapps/res/mergecraft/menubar/plus_on.png","#%n-menubar-bar_timer.png":"cleverapps/res/mergecraft/menubar/bar_timer.png","#%n-menubar-timer.png":"cleverapps/res/mergecraft/menubar/timer.png","#%n-orderswindow-attention_exclamation_large.png":"cleverapps/res/mergecraft/game/ui/orderswindow/attention_exclamation_large.png","#%n-level-progressbar.png":"cleverapps/res/mergecraft/level/progressbar.png","#%n-level-level_round.png":"cleverapps/res/mergecraft/level/level_round.png","#%n-menubar-coin.png":"cleverapps/res/mergecraft/menubar/coin.png",
"#%n-menubar-wand.png":"cleverapps/res/mergecraft/menubar/wand.png","#%n-menubar-worker.png":"cleverapps/res/mergecraft/menubar/worker.png","@jsons/level_crown-e904aad65e.json":"cleverapps/res/mergecraft/level/level_crown/level_crown.json"},raffle_window:{},request_center:{},reward_element:{},reward_icons:{},rose_tournament:{},rotate_phone:{},ruby_tournament:{},screenshots:{"#%n-avatar_friend_1.png":"cleverapps/res/bundles/screenshots/avatar_friend_1.png","#%n-avatar_friend_2.png":"cleverapps/res/bundles/screenshots/avatar_friend_2.png","#%n-avatar_user.png":"cleverapps/res/bundles/screenshots/avatar_user.png","#%n-avatar_1.png":"cleverapps/res/bundles/screenshots/avatar_1.png","#%n-avatar_2.png":"cleverapps/res/bundles/screenshots/avatar_2.png","#%n-avatar_3.png":"cleverapps/res/bundles/screenshots/avatar_3.png","#%n-avatar_4.png":"cleverapps/res/bundles/screenshots/avatar_4.png","#%n-avatar_5.png":"cleverapps/res/bundles/screenshots/avatar_5.png",
"#%n-avatar_6.png":"cleverapps/res/bundles/screenshots/avatar_6.png","#%n-avatar_7.png":"cleverapps/res/bundles/screenshots/avatar_7.png","#%n-avatar_8.png":"cleverapps/res/bundles/screenshots/avatar_8.png","#%n-avatar_1_ar.jpg":"cleverapps/res/bundles/screenshots/avatar_1_ar.jpg","#%n-avatar_2_ar.jpg":"cleverapps/res/bundles/screenshots/avatar_2_ar.jpg","#%n-avatar_3_ar.jpg":"cleverapps/res/bundles/screenshots/avatar_3_ar.jpg","#%n-avatar_4_ar.jpg":"cleverapps/res/bundles/screenshots/avatar_4_ar.jpg","#%n-avatar_5_ar.jpg":"cleverapps/res/bundles/screenshots/avatar_5_ar.jpg","#%n-avatar_6_ar.jpg":"cleverapps/res/bundles/screenshots/avatar_6_ar.jpg","#%n-avatar_7_ar.jpg":"cleverapps/res/bundles/screenshots/avatar_7_ar.jpg","#%n-avatar_8_ar.jpg":"cleverapps/res/bundles/screenshots/avatar_8_ar.jpg","#%n-avatar_1_it.jpg":"cleverapps/res/bundles/screenshots/avatar_1_it.jpg","#%n-avatar_2_it.png":"cleverapps/res/bundles/screenshots/avatar_2_it.png",
"#%n-avatar_3_it.jpg":"cleverapps/res/bundles/screenshots/avatar_3_it.jpg","#%n-avatar_4_it.jpg":"cleverapps/res/bundles/screenshots/avatar_4_it.jpg","#%n-avatar_5_it.jpg":"cleverapps/res/bundles/screenshots/avatar_5_it.jpg","#%n-avatar_6_it.jpg":"cleverapps/res/bundles/screenshots/avatar_6_it.jpg","#%n-avatar_7_it.jpg":"cleverapps/res/bundles/screenshots/avatar_7_it.jpg","#%n-avatar_8_it.png":"cleverapps/res/bundles/screenshots/avatar_8_it.png","#%n-avatar_1_ja.png":"cleverapps/res/bundles/screenshots/avatar_1_ja.png","#%n-avatar_2_ja.png":"cleverapps/res/bundles/screenshots/avatar_2_ja.png","#%n-avatar_3_ja.png":"cleverapps/res/bundles/screenshots/avatar_3_ja.png","#%n-avatar_4_ja.png":"cleverapps/res/bundles/screenshots/avatar_4_ja.png","#%n-avatar_5_ja.png":"cleverapps/res/bundles/screenshots/avatar_5_ja.png","#%n-avatar_6_ja.png":"cleverapps/res/bundles/screenshots/avatar_6_ja.png","#%n-avatar_7_ja.png":"cleverapps/res/bundles/screenshots/avatar_7_ja.png",
"#%n-avatar_8_ja.png":"cleverapps/res/bundles/screenshots/avatar_8_ja.png","#%n-avatar_1_ko.jpg":"cleverapps/res/bundles/screenshots/avatar_1_ko.jpg","#%n-avatar_2_ko.jpg":"cleverapps/res/bundles/screenshots/avatar_2_ko.jpg","#%n-avatar_3_ko.jpg":"cleverapps/res/bundles/screenshots/avatar_3_ko.jpg","#%n-avatar_4_ko.jpg":"cleverapps/res/bundles/screenshots/avatar_4_ko.jpg","#%n-avatar_5_ko.jpg":"cleverapps/res/bundles/screenshots/avatar_5_ko.jpg","#%n-avatar_6_ko.jpg":"cleverapps/res/bundles/screenshots/avatar_6_ko.jpg","#%n-avatar_7_ko.jpg":"cleverapps/res/bundles/screenshots/avatar_7_ko.jpg","#%n-avatar_8_ko.jpg":"cleverapps/res/bundles/screenshots/avatar_8_ko.jpg","#%n-avatar_1_tr.jpg":"cleverapps/res/bundles/screenshots/avatar_1_tr.jpg","#%n-avatar_2_tr.jpg":"cleverapps/res/bundles/screenshots/avatar_2_tr.jpg","#%n-avatar_3_tr.jpg":"cleverapps/res/bundles/screenshots/avatar_3_tr.jpg","#%n-avatar_4_tr.jpg":"cleverapps/res/bundles/screenshots/avatar_4_tr.jpg",
"#%n-avatar_5_tr.jpg":"cleverapps/res/bundles/screenshots/avatar_5_tr.jpg","#%n-avatar_6_tr.jpg":"cleverapps/res/bundles/screenshots/avatar_6_tr.jpg","#%n-avatar_7_tr.jpg":"cleverapps/res/bundles/screenshots/avatar_7_tr.jpg","#%n-avatar_8_tr.jpg":"cleverapps/res/bundles/screenshots/avatar_8_tr.jpg","#%n-avatar_1_zh.jpg":"cleverapps/res/bundles/screenshots/avatar_1_zh.jpg","#%n-avatar_2_zh.jpg":"cleverapps/res/bundles/screenshots/avatar_2_zh.jpg","#%n-avatar_3_zh.png":"cleverapps/res/bundles/screenshots/avatar_3_zh.png","#%n-avatar_4_zh.jpg":"cleverapps/res/bundles/screenshots/avatar_4_zh.jpg","#%n-avatar_5_zh.jpg":"cleverapps/res/bundles/screenshots/avatar_5_zh.jpg","#%n-avatar_6_zh.jpg":"cleverapps/res/bundles/screenshots/avatar_6_zh.jpg","#%n-avatar_7_zh.jpg":"cleverapps/res/bundles/screenshots/avatar_7_zh.jpg","#%n-avatar_8_zh.jpg":"cleverapps/res/bundles/screenshots/avatar_8_zh.jpg","#%n-line.png":"cleverapps/res/bundles/screenshots/line.png",
"@jsons/fail-a4d762c869.json":"cleverapps/res/bundles/screenshots/videos/fail.json","@jsons/logo-a7cb786dc4.json":"cleverapps/res/mergecraft/bundles/screenshots/logo/logo.json","~sounds/firework-d9e4d4e1be.mp3":"cleverapps/res/bundles/ads/sfx/firework.mp3"},select_friend_window:{},shared:{},shine:{},shop_user_gold_view:{"#%n-reward_icons-ruby_small.png":"cleverapps/res/mergecraft/bundles/reward_icons/ruby_small.png","#%n-reward_icons-ruby.png":"cleverapps/res/mergecraft/bundles/reward_icons/ruby.png","#%n-reward_icons-coin.png":"cleverapps/res/mergecraft/bundles/reward_icons/coin.png","#%n-reward_icons-exp.png":"cleverapps/res/mergecraft/bundles/reward_icons/exp.png","#%n-reward_icons-wand.png":"cleverapps/res/mergecraft/bundles/reward_icons/wand.png","#%n-reward_icons-worker.png":"cleverapps/res/mergecraft/bundles/reward_icons/worker.png","#%n-reward_icons-energy.png":"cleverapps/res/mergecraft/bundles/reward_icons/energy.png",
"#%n-reward_icons-energy_shop.png":"cleverapps/res/mergecraft/bundles/reward_icons/energy_shop.png","#%n-reward_icons-ruby_shop.png":"cleverapps/res/mergecraft/bundles/reward_icons/ruby_shop.png","#%n-reward_icons-coin_shop.png":"cleverapps/res/mergecraft/bundles/reward_icons/coin_shop.png","#%n-marvin-round-nostroke-62pt-0.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/0.png","#%n-marvin-round-nostroke-62pt-1.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/1.png","#%n-marvin-round-nostroke-62pt-2.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/2.png","#%n-marvin-round-nostroke-62pt-3.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/3.png","#%n-marvin-round-nostroke-62pt-4.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/4.png","#%n-marvin-round-nostroke-62pt-5.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/5.png",
"#%n-marvin-round-nostroke-62pt-6.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/6.png","#%n-marvin-round-nostroke-62pt-7.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/7.png","#%n-marvin-round-nostroke-62pt-8.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/8.png","#%n-marvin-round-nostroke-62pt-9.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/9.png","#%n-marvin-round-nostroke-62pt-colon.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/colon.png","#%n-marvin-round-nostroke-62pt-slash.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/slash.png","#%n-marvin-round-nostroke-62pt-plus.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/plus.png","#%n-marvin-round-nostroke-62pt-minus.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/minus.png","#%n-marvin-round-nostroke-62pt-x.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/x.png",
"#%n-marvin-round-nostroke-62pt-space.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/space.png","#%n-marvin-round-45pt-0.png":"cleverapps/res/common/fonts/marvin-round/45pt/0.png","#%n-marvin-round-45pt-1.png":"cleverapps/res/common/fonts/marvin-round/45pt/1.png","#%n-marvin-round-45pt-2.png":"cleverapps/res/common/fonts/marvin-round/45pt/2.png","#%n-marvin-round-45pt-3.png":"cleverapps/res/common/fonts/marvin-round/45pt/3.png","#%n-marvin-round-45pt-4.png":"cleverapps/res/common/fonts/marvin-round/45pt/4.png","#%n-marvin-round-45pt-5.png":"cleverapps/res/common/fonts/marvin-round/45pt/5.png","#%n-marvin-round-45pt-6.png":"cleverapps/res/common/fonts/marvin-round/45pt/6.png","#%n-marvin-round-45pt-7.png":"cleverapps/res/common/fonts/marvin-round/45pt/7.png","#%n-marvin-round-45pt-8.png":"cleverapps/res/common/fonts/marvin-round/45pt/8.png","#%n-marvin-round-45pt-9.png":"cleverapps/res/common/fonts/marvin-round/45pt/9.png",
"#%n-marvin-round-45pt-colon.png":"cleverapps/res/common/fonts/marvin-round/45pt/colon.png","#%n-marvin-round-45pt-slash.png":"cleverapps/res/common/fonts/marvin-round/45pt/slash.png","#%n-marvin-round-45pt-plus.png":"cleverapps/res/common/fonts/marvin-round/45pt/plus.png","#%n-marvin-round-45pt-minus.png":"cleverapps/res/common/fonts/marvin-round/45pt/minus.png","#%n-marvin-round-45pt-x.png":"cleverapps/res/common/fonts/marvin-round/45pt/x.png","#%n-marvin-round-45pt-space.png":"cleverapps/res/common/fonts/marvin-round/45pt/space.png","#%n-marvin-round-62pt-0.png":"cleverapps/res/common/fonts/marvin-round/62pt/0.png","#%n-marvin-round-62pt-1.png":"cleverapps/res/common/fonts/marvin-round/62pt/1.png","#%n-marvin-round-62pt-2.png":"cleverapps/res/common/fonts/marvin-round/62pt/2.png","#%n-marvin-round-62pt-3.png":"cleverapps/res/common/fonts/marvin-round/62pt/3.png","#%n-marvin-round-62pt-4.png":"cleverapps/res/common/fonts/marvin-round/62pt/4.png",
"#%n-marvin-round-62pt-5.png":"cleverapps/res/common/fonts/marvin-round/62pt/5.png","#%n-marvin-round-62pt-6.png":"cleverapps/res/common/fonts/marvin-round/62pt/6.png","#%n-marvin-round-62pt-7.png":"cleverapps/res/common/fonts/marvin-round/62pt/7.png","#%n-marvin-round-62pt-8.png":"cleverapps/res/common/fonts/marvin-round/62pt/8.png","#%n-marvin-round-62pt-9.png":"cleverapps/res/common/fonts/marvin-round/62pt/9.png","#%n-marvin-round-62pt-colon.png":"cleverapps/res/common/fonts/marvin-round/62pt/colon.png","#%n-marvin-round-62pt-slash.png":"cleverapps/res/common/fonts/marvin-round/62pt/slash.png","#%n-marvin-round-62pt-plus.png":"cleverapps/res/common/fonts/marvin-round/62pt/plus.png","#%n-marvin-round-62pt-minus.png":"cleverapps/res/common/fonts/marvin-round/62pt/minus.png","#%n-marvin-round-62pt-x.png":"cleverapps/res/common/fonts/marvin-round/62pt/x.png","#%n-marvin-round-62pt-space.png":"cleverapps/res/common/fonts/marvin-round/62pt/space.png",
"#%n-marvin-round-76pt-0.png":"cleverapps/res/common/fonts/marvin-round/76pt/0.png","#%n-marvin-round-76pt-1.png":"cleverapps/res/common/fonts/marvin-round/76pt/1.png","#%n-marvin-round-76pt-2.png":"cleverapps/res/common/fonts/marvin-round/76pt/2.png","#%n-marvin-round-76pt-3.png":"cleverapps/res/common/fonts/marvin-round/76pt/3.png","#%n-marvin-round-76pt-4.png":"cleverapps/res/common/fonts/marvin-round/76pt/4.png","#%n-marvin-round-76pt-5.png":"cleverapps/res/common/fonts/marvin-round/76pt/5.png","#%n-marvin-round-76pt-6.png":"cleverapps/res/common/fonts/marvin-round/76pt/6.png","#%n-marvin-round-76pt-7.png":"cleverapps/res/common/fonts/marvin-round/76pt/7.png","#%n-marvin-round-76pt-8.png":"cleverapps/res/common/fonts/marvin-round/76pt/8.png","#%n-marvin-round-76pt-9.png":"cleverapps/res/common/fonts/marvin-round/76pt/9.png","#%n-marvin-round-76pt-colon.png":"cleverapps/res/common/fonts/marvin-round/76pt/colon.png",
"#%n-marvin-round-76pt-slash.png":"cleverapps/res/common/fonts/marvin-round/76pt/slash.png","#%n-marvin-round-76pt-plus.png":"cleverapps/res/common/fonts/marvin-round/76pt/plus.png","#%n-marvin-round-76pt-minus.png":"cleverapps/res/common/fonts/marvin-round/76pt/minus.png","#%n-marvin-round-76pt-x.png":"cleverapps/res/common/fonts/marvin-round/76pt/x.png","#%n-marvin-round-76pt-space.png":"cleverapps/res/common/fonts/marvin-round/76pt/space.png"},sidebar:{},simple:{},slot_machine:{},sounds:{},speedup:{},starchest_window:{},starter_pack:{"@jsons/%n-f2985a0f7d.json":"cleverapps/res/mergecraft/bundles/packs/starter_pack.json","~sounds/%n-fedcb853ee.mp3":"cleverapps/res/mergecraft/sfx/game/starter_pack.mp3"},store_links:{},stuck_window:{},subscription_window:{},temp_good_finish_window:{},tile_shop:{"#%n-shop_bg_white.png":"cleverapps/res/mergecraft/tile_shop/shop_bg_white.png","#%n-shop_bg_best.png":"cleverapps/res/mergecraft/tile_shop/shop_bg_best.png",
"#%n-feature_tile_button.png":"cleverapps/res/mergecraft/tile_shop/feature_tile_button.png","#%n-feature_tile_button_on.png":"cleverapps/res/mergecraft/tile_shop/feature_tile_button_on.png","#%n-shop_best_seller.png":"cleverapps/res/mergecraft/tile_shop/shop_best_seller.png","#%n-shop_red_ribbon.png":"cleverapps/res/mergecraft/tile_shop/shop_red_ribbon.png","#%n-shop_red_ribbon_best.png":"cleverapps/res/mergecraft/tile_shop/shop_red_ribbon_best.png","#%n-life_friends.png":"cleverapps/res/mergecraft/tile_shop/life_friends.png","#%n-shop_purple_ribbon.png":"cleverapps/res/mergecraft/tile_shop/shop_purple_ribbon.png","#%n-energy_for_video.png":"cleverapps/res/mergecraft/tile_shop/energy_for_video.png","#%n-shop_coins_500.png":"cleverapps/res/mergecraft/tile_shop/shop_coins_500.png","#%n-shop_coins_1800.png":"cleverapps/res/mergecraft/tile_shop/shop_coins_1800.png","#%n-shop_coins_3800.png":"cleverapps/res/mergecraft/tile_shop/shop_coins_3800.png",
"#%n-shop_coins_6000.png":"cleverapps/res/mergecraft/tile_shop/shop_coins_6000.png","#%n-shop_coins_25000.png":"cleverapps/res/mergecraft/tile_shop/shop_coins_25000.png","#%n-small_shop_button.png":"cleverapps/res/mergecraft/tile_shop/small_shop_button.png","#%n-small_shop_button_on.png":"cleverapps/res/mergecraft/tile_shop/small_shop_button_on.png","#%n-socialicons-ok_icon.png":"cleverapps/res/socialicons/ok_icon.png","#%n-shop_sale_ribbon.png":"cleverapps/res/mergecraft/tile_shop/shop_sale_ribbon.png","#%n-shop_sale_ribbon_off.png":"cleverapps/res/mergecraft/tile_shop/shop_sale_ribbon_off.png","#%n-shop_red_ribbon_best_off.png":"cleverapps/res/mergecraft/tile_shop/shop_red_ribbon_best_off.png","#%n-energy_for_coins.png":"cleverapps/res/mergecraft/tile_shop/energy_for_coins.png","#%n-energy_for_coins_off.png":"cleverapps/res/mergecraft/tile_shop/energy_for_coins_off.png","#%n-energy_for_video_off.png":"cleverapps/res/mergecraft/tile_shop/energy_for_video_off.png",
"#%n-energy_lottery.png":"cleverapps/res/mergecraft/tile_shop/energy_lottery.png","#%n-energy_lottery_off.png":"cleverapps/res/mergecraft/tile_shop/energy_lottery_off.png","#%n-soft_currency_small.png":"cleverapps/res/mergecraft/tile_shop/soft_currency_small.png","#%n-soft_currency_medium.png":"cleverapps/res/mergecraft/tile_shop/soft_currency_medium.png","#%n-soft_currency_large.png":"cleverapps/res/mergecraft/tile_shop/soft_currency_large.png","#%n-shop_button_off.png":"cleverapps/res/mergecraft/tile_shop/shop_button_off.png","#%n-infoview-game_ui_clock.png":"cleverapps/res/mergecraft/game/ui/infoview/game_ui_clock.png","#%n-reward_icons-ruby_small.png":"cleverapps/res/mergecraft/bundles/reward_icons/ruby_small.png","#%n-reward_icons-ruby.png":"cleverapps/res/mergecraft/bundles/reward_icons/ruby.png","#%n-reward_icons-coin.png":"cleverapps/res/mergecraft/bundles/reward_icons/coin.png","#%n-reward_icons-exp.png":"cleverapps/res/mergecraft/bundles/reward_icons/exp.png",
"#%n-reward_icons-wand.png":"cleverapps/res/mergecraft/bundles/reward_icons/wand.png","#%n-reward_icons-worker.png":"cleverapps/res/mergecraft/bundles/reward_icons/worker.png","#%n-reward_icons-energy.png":"cleverapps/res/mergecraft/bundles/reward_icons/energy.png","#%n-reward_icons-energy_shop.png":"cleverapps/res/mergecraft/bundles/reward_icons/energy_shop.png","#%n-reward_icons-ruby_shop.png":"cleverapps/res/mergecraft/bundles/reward_icons/ruby_shop.png","#%n-reward_icons-coin_shop.png":"cleverapps/res/mergecraft/bundles/reward_icons/coin_shop.png","#%n-marvin-round-nostroke-62pt-0.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/0.png","#%n-marvin-round-nostroke-62pt-1.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/1.png","#%n-marvin-round-nostroke-62pt-2.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/2.png","#%n-marvin-round-nostroke-62pt-3.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/3.png",
"#%n-marvin-round-nostroke-62pt-4.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/4.png","#%n-marvin-round-nostroke-62pt-5.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/5.png","#%n-marvin-round-nostroke-62pt-6.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/6.png","#%n-marvin-round-nostroke-62pt-7.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/7.png","#%n-marvin-round-nostroke-62pt-8.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/8.png","#%n-marvin-round-nostroke-62pt-9.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/9.png","#%n-marvin-round-nostroke-62pt-colon.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/colon.png","#%n-marvin-round-nostroke-62pt-slash.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/slash.png","#%n-marvin-round-nostroke-62pt-plus.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/plus.png",
"#%n-marvin-round-nostroke-62pt-minus.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/minus.png","#%n-marvin-round-nostroke-62pt-x.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/x.png","#%n-marvin-round-nostroke-62pt-space.png":"cleverapps/res/common/fonts/marvin-round-nostroke/62pt/space.png","#%n-marvin-round-45pt-0.png":"cleverapps/res/common/fonts/marvin-round/45pt/0.png","#%n-marvin-round-45pt-1.png":"cleverapps/res/common/fonts/marvin-round/45pt/1.png","#%n-marvin-round-45pt-2.png":"cleverapps/res/common/fonts/marvin-round/45pt/2.png","#%n-marvin-round-45pt-3.png":"cleverapps/res/common/fonts/marvin-round/45pt/3.png","#%n-marvin-round-45pt-4.png":"cleverapps/res/common/fonts/marvin-round/45pt/4.png","#%n-marvin-round-45pt-5.png":"cleverapps/res/common/fonts/marvin-round/45pt/5.png","#%n-marvin-round-45pt-6.png":"cleverapps/res/common/fonts/marvin-round/45pt/6.png","#%n-marvin-round-45pt-7.png":"cleverapps/res/common/fonts/marvin-round/45pt/7.png",
"#%n-marvin-round-45pt-8.png":"cleverapps/res/common/fonts/marvin-round/45pt/8.png","#%n-marvin-round-45pt-9.png":"cleverapps/res/common/fonts/marvin-round/45pt/9.png","#%n-marvin-round-45pt-colon.png":"cleverapps/res/common/fonts/marvin-round/45pt/colon.png","#%n-marvin-round-45pt-slash.png":"cleverapps/res/common/fonts/marvin-round/45pt/slash.png","#%n-marvin-round-45pt-plus.png":"cleverapps/res/common/fonts/marvin-round/45pt/plus.png","#%n-marvin-round-45pt-minus.png":"cleverapps/res/common/fonts/marvin-round/45pt/minus.png","#%n-marvin-round-45pt-x.png":"cleverapps/res/common/fonts/marvin-round/45pt/x.png","#%n-marvin-round-45pt-space.png":"cleverapps/res/common/fonts/marvin-round/45pt/space.png","#%n-marvin-round-62pt-0.png":"cleverapps/res/common/fonts/marvin-round/62pt/0.png","#%n-marvin-round-62pt-1.png":"cleverapps/res/common/fonts/marvin-round/62pt/1.png","#%n-marvin-round-62pt-2.png":"cleverapps/res/common/fonts/marvin-round/62pt/2.png",
"#%n-marvin-round-62pt-3.png":"cleverapps/res/common/fonts/marvin-round/62pt/3.png","#%n-marvin-round-62pt-4.png":"cleverapps/res/common/fonts/marvin-round/62pt/4.png","#%n-marvin-round-62pt-5.png":"cleverapps/res/common/fonts/marvin-round/62pt/5.png","#%n-marvin-round-62pt-6.png":"cleverapps/res/common/fonts/marvin-round/62pt/6.png","#%n-marvin-round-62pt-7.png":"cleverapps/res/common/fonts/marvin-round/62pt/7.png","#%n-marvin-round-62pt-8.png":"cleverapps/res/common/fonts/marvin-round/62pt/8.png","#%n-marvin-round-62pt-9.png":"cleverapps/res/common/fonts/marvin-round/62pt/9.png","#%n-marvin-round-62pt-colon.png":"cleverapps/res/common/fonts/marvin-round/62pt/colon.png","#%n-marvin-round-62pt-slash.png":"cleverapps/res/common/fonts/marvin-round/62pt/slash.png","#%n-marvin-round-62pt-plus.png":"cleverapps/res/common/fonts/marvin-round/62pt/plus.png","#%n-marvin-round-62pt-minus.png":"cleverapps/res/common/fonts/marvin-round/62pt/minus.png",
"#%n-marvin-round-62pt-x.png":"cleverapps/res/common/fonts/marvin-round/62pt/x.png","#%n-marvin-round-62pt-space.png":"cleverapps/res/common/fonts/marvin-round/62pt/space.png","#%n-marvin-round-76pt-0.png":"cleverapps/res/common/fonts/marvin-round/76pt/0.png","#%n-marvin-round-76pt-1.png":"cleverapps/res/common/fonts/marvin-round/76pt/1.png","#%n-marvin-round-76pt-2.png":"cleverapps/res/common/fonts/marvin-round/76pt/2.png","#%n-marvin-round-76pt-3.png":"cleverapps/res/common/fonts/marvin-round/76pt/3.png","#%n-marvin-round-76pt-4.png":"cleverapps/res/common/fonts/marvin-round/76pt/4.png","#%n-marvin-round-76pt-5.png":"cleverapps/res/common/fonts/marvin-round/76pt/5.png","#%n-marvin-round-76pt-6.png":"cleverapps/res/common/fonts/marvin-round/76pt/6.png","#%n-marvin-round-76pt-7.png":"cleverapps/res/common/fonts/marvin-round/76pt/7.png","#%n-marvin-round-76pt-8.png":"cleverapps/res/common/fonts/marvin-round/76pt/8.png",
"#%n-marvin-round-76pt-9.png":"cleverapps/res/common/fonts/marvin-round/76pt/9.png","#%n-marvin-round-76pt-colon.png":"cleverapps/res/common/fonts/marvin-round/76pt/colon.png","#%n-marvin-round-76pt-slash.png":"cleverapps/res/common/fonts/marvin-round/76pt/slash.png","#%n-marvin-round-76pt-plus.png":"cleverapps/res/common/fonts/marvin-round/76pt/plus.png","#%n-marvin-round-76pt-minus.png":"cleverapps/res/common/fonts/marvin-round/76pt/minus.png","#%n-marvin-round-76pt-x.png":"cleverapps/res/common/fonts/marvin-round/76pt/x.png","#%n-marvin-round-76pt-space.png":"cleverapps/res/common/fonts/marvin-round/76pt/space.png","@jsons/shop_sparkles_small-11e96d2c9e.json":"cleverapps/res/bundles/shop_sparkles/shop_sparkles_small.json","@jsons/shop_sparkles_large-cba75331e0.json":"cleverapps/res/bundles/shop_sparkles/shop_sparkles_large.json","~sounds/badge_appear-7102ce72e2.mp3":"cleverapps/res/common/sfx/tile_shop/badge_appear.mp3"},tiles:{},toolbar:{},tooltip:{},transition:{},
treasuresearch:{},tulpan_tournament:{},unit_apple:{},unit_bamboo:{},unit_bamboochest:{},unit_bamboogenerator:{},unit_bamboosource:{},unit_bear:{},unit_candies:{},unit_coins:{},unit_corn:{},unit_crystal:{},unit_decorator:{},unit_dishes:{},unit_dragonmine:{},unit_dwarf:{},unit_elf:{},unit_freechest:{},unit_herochest:{},unit_heroes:{},unit_icons:{},unit_iron:{},unit_king:{},unit_knight:{},unit_magicplant:{},unit_mushrooms:{},unit_rubies:{},unit_rubiesplant:{},unit_sacks:{},unit_sapphire:{},unit_sapphirechest:{},unit_sapphiregenerator:{},unit_sapphiresource:{},unit_specialoffer:{},unit_stone:{},unit_stonechest:{},unit_stonegenerator:{},unit_stonesource:{},unit_strawberry:{},unit_treasure:{},unit_troll:{},unit_wagon:{},unit_wagonchest:{},unit_wagongenerator:{},unit_wagonsource:{},unit_wands:{},unit_warlock:{},unit_wheat:{},unit_wood:{},unit_woodchest:{},unit_woodgenerator:{},unit_woodsource:{},unit_worker:{},unitoncell:{},units_shop:{
"#%n-market-market_bg.png":"cleverapps/res/mergecraft/market/market_bg.png","#%n-market-market_lock.png":"cleverapps/res/mergecraft/market/market_lock.png","#%n-market-market_title.png":"cleverapps/res/mergecraft/market/market_title.png","#%n-market-market_cart.png":"cleverapps/res/mergecraft/market/market_cart.png","#%n-market-market_cart_bg.png":"cleverapps/res/mergecraft/market/market_cart_bg.png","#%n-tile_shop-shop_red_ribbon_best.png":"cleverapps/res/mergecraft/tile_shop/shop_red_ribbon_best.png"},unitslibrarywindow:{},valentines:{},victorywindow:{"#%n-victory-reward_bg.png":"cleverapps/res/mergecraft/windows/victory/reward_bg.png"},video_ads:{"@jsons/boosters_sale_prize-d310b6263f.json":"cleverapps/res/bundles/ads/prize_box/boosters_sale_prize.json","@jsons/transition-e808d9814b.json":"cleverapps/res/ui/jam/transition/transition.json"},video_ads_first_trial:{},wardrobe_window:{},windows:{},world_map:{},wysiwyg:{"#%n-component.png":"cleverapps/res/wysiwyg/component.png",
"#%n-component_frame.png":"cleverapps/res/wysiwyg/component_frame.png","#%n-attach_frame.png":"cleverapps/res/wysiwyg/attach_frame.png","#%n-window_bg.png":"cleverapps/res/wysiwyg/window_bg.png","#%n-plus.png":"cleverapps/res/wysiwyg/plus.png","#%n-back.png":"cleverapps/res/wysiwyg/back.png","#%n-delete.png":"cleverapps/res/wysiwyg/delete.png","#%n-copy.png":"cleverapps/res/wysiwyg/copy.png","#%n-move_up.png":"cleverapps/res/wysiwyg/move_up.png","#%n-move_down.png":"cleverapps/res/wysiwyg/move_down.png","#%n-paste.png":"cleverapps/res/wysiwyg/paste.png","#%n-button_on.png":"cleverapps/res/wysiwyg/button_on.png","#%n-button_off.png":"cleverapps/res/wysiwyg/button_off.png","#%n-dropdown.png":"cleverapps/res/wysiwyg/dropdown.png","#%n-admin-loading.png":"cleverapps/res/admin/loading.png","#%n-scenario_item.png":"cleverapps/res/wysiwyg/scenario_item.png","#%n-clip_item.png":"cleverapps/res/wysiwyg/clip_item.png","#%n-preview_frame.png":"cleverapps/res/wysiwyg/preview_frame.png",
"#%n-preview_control.png":"cleverapps/res/wysiwyg/preview_control.png","#%n-component_item.png":"cleverapps/res/wysiwyg/component_item.png","#%n-directory_item.png":"cleverapps/res/wysiwyg/directory_item.png","#%n-component_item_hidden.png":"cleverapps/res/wysiwyg/component_item_hidden.png","#%n-sound_icon.png":"cleverapps/res/wysiwyg/sound_icon.png","#%n-iphone.png":"cleverapps/res/wysiwyg/iphone.png","#%n-fullscreen_icon.png":"cleverapps/res/wysiwyg/fullscreen_icon.png","#%n-iphone_icon.png":"cleverapps/res/wysiwyg/iphone_icon.png","#%n-video_icon.png":"cleverapps/res/wysiwyg/video_icon.png","#%n-components-adsgame.png":"cleverapps/res/wysiwyg/components/adsgame.png","#%n-components-adsage.png":"cleverapps/res/wysiwyg/components/adsage.png","#%n-components-adshand.png":"cleverapps/res/wysiwyg/components/adshand.png","#%n-components-adslogo.png":"cleverapps/res/wysiwyg/components/adslogo.png","#%n-components-adsplay.png":"cleverapps/res/wysiwyg/components/adsplay.png",
"#%n-components-adspuzzle15.png":"cleverapps/res/wysiwyg/components/adspuzzle15.png","#%n-components-adsscale.png":"cleverapps/res/wysiwyg/components/adsscale.png","#%n-components-adsprogressbar.png":"cleverapps/res/wysiwyg/components/adsprogressbar.png","#%n-components-adsspine.png":"cleverapps/res/wysiwyg/components/adsspine.png","#%n-components-adstree.png":"cleverapps/res/wysiwyg/components/adstree.png","#%n-components-adssprite.png":"cleverapps/res/wysiwyg/components/adssprite.png","#%n-components-adstable.png":"cleverapps/res/wysiwyg/components/adstable.png","#%n-components-adskeypad.png":"cleverapps/res/wysiwyg/components/adskeypad.png","#%n-components-adswordslist.png":"cleverapps/res/wysiwyg/components/adswordslist.png","#%n-components-adswordsresult.png":"cleverapps/res/wysiwyg/components/adswordsresult.png","#%n-components-adstext.png":"cleverapps/res/wysiwyg/components/adstext.png","#%n-components-adssound.png":"cleverapps/res/wysiwyg/components/adssound.png",
"#%n-components-adstransition.png":"cleverapps/res/wysiwyg/components/adstransition.png","#%n-components-adsfireworks.png":"cleverapps/res/wysiwyg/components/adsfireworks.png","#%n-components-adsexclamations.png":"cleverapps/res/wysiwyg/components/adsexclamations.png","#%n-components-adsmenu.png":"cleverapps/res/wysiwyg/components/adsmenu.png","#%n-components-adshint.png":"cleverapps/res/wysiwyg/components/adshint.png","#%n-components-adscounter.png":"cleverapps/res/wysiwyg/components/adscounter.png","#%n-components-adsmap2d.png":"cleverapps/res/wysiwyg/components/adsmap2d.png","#%n-components-adsfield.png":"cleverapps/res/wysiwyg/components/adsfield.png","#%n-components-adsinfopanel.png":"cleverapps/res/wysiwyg/components/adsinfopanel.png","#%n-components-adssidebar.png":"cleverapps/res/wysiwyg/components/adssidebar.png","#%n-components-adsmenubar.png":"cleverapps/res/wysiwyg/components/adsmenubar.png",
"#%n-components-adscontrolspanel.png":"cleverapps/res/wysiwyg/components/adscontrolspanel.png","#%n-components-adsenergyfeast.png":"cleverapps/res/wysiwyg/components/adsenergyfeast.png","#%n-components-adsshadowlayer.png":"cleverapps/res/wysiwyg/components/adsshadowlayer.png","#%n-components-adscurrent.png":"cleverapps/res/wysiwyg/components/adscurrent.png","#%n-components-adshintbooster.png":"cleverapps/res/wysiwyg/components/adshintbooster.png","#%n-components-adsshuffle.png":"cleverapps/res/wysiwyg/components/adsshuffle.png","#%n-components-adsbug.png":"cleverapps/res/wysiwyg/components/adsbug.png","#%n-button_icons-admin_push.png":"cleverapps/res/admin/button_icons/admin_push.png","#%n-button_icons-admin_rev.png":"cleverapps/res/admin/button_icons/admin_rev.png","#%n-admin-regular_button.png":"cleverapps/res/admin/regular_button.png","#%n-admin-regular_button_on.png":"cleverapps/res/admin/regular_button_on.png","#%n-admin-delete_button.png":"cleverapps/res/admin/delete_button.png",
"#%n-admin-selected_button.png":"cleverapps/res/admin/selected_button.png","#%n-admin-level_frame_regular.png":"cleverapps/res/admin/level_frame_regular.png"},xmas:{}},unpackedMap={},unmifiyBundlesRec=function(e,t,n){var s=e[t];if("object"==typeof s)for(var i in s)unmifiyBundlesRec(s,i,n);else"string"==typeof s&&(s=(s=(s=s.replace("@","~%n/%r/")).replace("~","res/packed/")).replace(new RegExp("%n","g"),n),void 0!==unpackedBundles&&unpackedBundles[n]&&unpackedBundles[n][e[t]]&&(unpackedMap[s]=unpackedBundles[n][e[t]]),e[t]=s)},isVirtualLink=function(e){return"string"==typeof e&&"@"===e.charAt(0)},parseVirtualLink=function(e){return{bundle:e.substr(1,e.indexOf("#")-1),id:e.substr(e.lastIndexOf("#")+1)}},processVirtualUrl=function(e,t){if(!isVirtualLink(e))return e;var n=parseVirtualLink(e),s=bundles[n.bundle];for(var i in s.injectTo){var o=s.injectTo[i];if(cleverapps.bundleLoader.isLoaded(o))return bundles[o].urls[n.id]}if(t&&t.useUnusedBundles)for(var i in s.injectTo){o=s.injectTo[i]
;if(cleverapps.bundleLoader.isUnused(o))return bundles[o].urls[n.id]}var r="no urlId "+e+" for bundle "+n.bundle;if(console.log(r),cleverapps.config.debugMode)throw r},getVirtualLinkType=function(e){return e.split("#")[1]},processVirtualImage=function(e){if(!isVirtualLink(e))return e;var t=getVirtualLinkType(e);return"frame"===t?processVirtualFrame(e):"url"===t?processVirtualUrl(e):void 0},processVirtualFrame=function(e){if(!isVirtualLink(e))return e;var t=parseVirtualLink(e),n=bundles[t.bundle];for(var s in n.injectTo){var i=n.injectTo[s];if(cleverapps.bundleLoader.isLoaded(i))return bundles[i].frames[t.id]}var o="no frameId "+e+" for bundle "+t.bundle;if(console.log(o),cleverapps.config.debugMode)throw o},processVirtualJson=function(e){if(!isVirtualLink(e))return e;var t=parseVirtualLink(e),n=bundles[t.bundle];for(var s in n.injectTo){var i=n.injectTo[s];if(cleverapps.bundleLoader.isLoaded(i))return bundles[i].jsons[t.id]}var o="no json "+e+" for bundle "+t.bundle;if(console.log(o),
cleverapps.config.debugMode)throw o},processInlineJSONs=function(e){for(var t in e.jsons){var n=e.jsons[t];if(n.inline){var s=JSON.parse(n.data),i=n.url;cc.loader.cache[i]=s,e.jsons[t]=i}}},unminifyBundles=function(e){for(var t in e=e||Object.keys(bundles)){var n=e[t];unmifiyBundlesRec(bundles,n,n),bundles[n].frames||(bundles[n].frames={}),bundles[n].jsons||(bundles[n].jsons={}),processInlineJSONs(bundles[n]);var s=bundles[n];s.injectTo&&s.frameIds&&(s.frameIds.forEach(function(e){s.frames[e]="@"+n+"#frame#"+e}),delete s.frameIds),s.injectTo&&s.jsonIds&&(s.jsonIds.forEach(function(e){s.jsons[e]="@"+n+"#json#"+e}),delete s.jsonIds),s.injectTo&&s.soundIds&&(s.soundIds.forEach(function(e){s.urls[e]="@"+n+"#url#"+e}),delete s.soundIds),s.injectTo&&s.unpackedIds&&(s.unpackedIds.forEach(function(e){s.urls[e]="@"+n+"#url#"+e}),delete s.unpackedIds)}void 0!==unpackedBundles&&(unpackedBundles=void 0,delete unpackedMap[bundles.dev_resources.frames.border])};unminifyBundles(),
ResourceProcessor.addStaticUrl();var Bundle=function(e){this.name=e,this.data=bundles[e]};Bundle.prototype.onLoad=function(){var e=cc.loader.getRes(this.data.urls.json);for(var t in e){var n=this.data.jsons[t],s=e[t];"string"==typeof n&&".plist"===cc.path.extname(n)&&(s=cc.plistParser.parse(s)),cc.loader.cache[n]=s}this.data.jsons.plist&&cc.spriteFrameCache.addSpriteFrames(this.data.jsons.plist)},Bundle.prototype.isResourceSound=function(e){return!!e&&(e.music||"string"==typeof e&&(-1!==e.indexOf("/sfx/")||-1!==e.indexOf(".mp3")))},Bundle.prototype.listSoundUrls=function(){return cc.sys.isWebViewAudio?[]:cleverapps.values(this.data.urls).filter(function(e){return this.isResourceSound(e)&&!isVirtualLink(e)}.bind(this))},Bundle.prototype.listUrls=function(){return cleverapps.values(this.data.urls).filter(function(e){return!this.isResourceSound(e)&&!isVirtualLink(e)}.bind(this))},Bundle.prototype.listJsons=function(){return cleverapps.values(this.data.jsons)},
Bundle.prototype.injectTo=function(t){["urls","frames","jsons"].forEach(function(e){cleverapps.extend(t,this.data[e])},this)};var BundleLoader=function(){this.handles={},this.blockedCounter=0,this.unusedResources={},this.unusedBundles={},this.waitWindow=void 0,this.onceFinishLoadCallback=void 0};BundleLoader.prototype.whenLoadFinish=function(e){0===this.blockedCounter?e():this.onceFinishLoadCallback=cleverapps.once(e)},BundleLoader.prototype.addBlockWindow=function(){if(0===this.blockedCounter){var e=cc.director.getRunningScene();e&&e.scene&&!cleverapps.scenes.isLoaderScene()&&!this.waitWindow&&(this.waitWindow=new WaitWindow)}this.blockedCounter++},BundleLoader.prototype.removeBlockWindow=function(){this.blockedCounter--,this.blockedCounter<=0&&(this.waitWindow&&(this.waitWindow.close(),this.waitWindow=void 0),this.onceFinishLoadCallback&&this.onceFinishLoadCallback())},BundleLoader.prototype.onFailure=function(e,t){var n=this.getHandle(e),s=n&&n.onFailures
;cleverapps.eventLogger.logEvent(cleverapps.EVENTS.FAIL_BUNDLE+e),n&&n.blocked?(this.waitWindow&&(this.waitWindow.close(),this.waitWindow=!1),new RestartWindow):this.deleteBundle(e,!0),cleverapps.versionChecker.isClientVersionActual()&&!cleverapps.config.debugMode&&cleverapps.checkStatus(t,404)&&setTimeout(function(){throw"load actual bundle "+e+" 404 error"},0),s&&s.forEach(function(e){e(t)})},BundleLoader.prototype.loadBundles=function(e,t){var n=t&&t.onSuccess||function(){},s=t&&t.onFailure,i=cleverapps.wait(e&&e.length||0,n);s&&(s=cleverapps.once(s));for(var o=0;o<e.length;o++){var r={onSuccess:i,onFailure:s,blocked:t&&t.blocked};this.loadBundle(e[o],r)}},BundleLoader.prototype.getHandle=function(e){return this.handles[e]},BundleLoader.prototype.countLoaded=function(e){if(Array.isArray(e))return e.filter(function(e){return this.countLoaded(e)}.bind(this)).length;var t=this.getHandle(e);return t&&t.loaded?1:0},BundleLoader.prototype.isLoaded=function(e){return Array.isArray(e)||(e=[
e]),this.countLoaded(e)===e.length},BundleLoader.prototype.loadBundle=function(t,e){if(t&&t.loadBundle)t.loadBundle(e);else{var n=bundles[t],s=this.getHandle(t),i=(e=e||{}).onSuccess,o=e.onFailure,r=e.blocked;if(s)return s.counter++,void(s.loaded?i&&i(n):(i&&s.onSuccesses.push(i),o&&s.onFailures.push(o),!s.blocked&&r&&(s.blocked=!0,this.addBlockWindow())));var a=[];i&&(a=Array.isArray(i)?i:[i]);var c=[];o&&(c=Array.isArray(o)?o:[o]);var l={loaded:!1,counter:1,onSuccesses:a,onFailures:c,blocked:r};if(this.handles[t]=l,r&&this.addBlockWindow(),l.onLoadedUrls=cleverapps.once(function(){l.loaded=!0,l.blocked&&this.removeBlockWindow(),new Bundle(t).onLoad();for(var e=0;e<l.onSuccesses.length;e++)a[e].call(this,n);delete l.onSuccesses,delete l.onFailures,delete l.blocked}.bind(this)),bundles[t].injectTo)l.onLoadedUrls();else{var p=3,d=function(){if(this.getHandle(t)){var e=cc.game.config.noCache;n.noCache&&!e&&(cc.game.config.noCache=!0),cc.loader.load(new Bundle(t).listUrls(),function(e){
e?(console.log("load failed",e,JSON.stringify(new Bundle(t).listUrls())),p<=1||cleverapps.checkStatus(e,404)?cleverapps.versionChecker.loadClientVersion(function(){this.onFailure(t,e)}.bind(this)):(p--,d())):(l.onLoadedUrls(),cc.loader.load(new Bundle(t).listSoundUrls()))}.bind(this)),cc.game.config.noCache=e}}.bind(this);d()}}},BundleLoader.prototype.checkUrlUseInLoadedBundles=function(e){for(var t in this.handles){var n=new Bundle(t),s=n.listUrls().concat(n.listSoundUrls());for(var i in s)if(s[i]===e)return!0}return!1},BundleLoader.prototype.deleteBundles=function(e){if(e)for(var t=0;t<e.length;t++)this.deleteBundle(e[t])},BundleLoader.prototype.deleteBundle=function(e,t){var n=this.handles[e];if(void 0!==n&&-1===["main","transition","episodes_resources"].indexOf(e)&&(n.counter--,!(0<n.counter||bundles[e].storage)))if(bundles[e].injectTo)delete this.handles[e];else{t||n.loaded||!n.blocked||console.log("Remove blocked loading bundle (maybe error!)",e),n.loaded&&this.clearOverrides(n)
;var s=new Bundle(e),i=s.listUrls().concat(s.listSoundUrls());for(var o in n.onLoadedUrls=function(){},delete this.handles[e],i){var r=i[o];this.checkUrlUseInLoadedBundles(r)||(this.unusedResources[r]=!0)}this.unusedBundles[e]=!0}},BundleLoader.prototype.override=function(e,t,n,s){e.overrides=e.overrides||new OverridesContainer,e.overrides.override(t,n,s)},BundleLoader.prototype.clearOverrides=function(e){e.overrides&&(e.unoverride(),delete e.overrides)},BundleLoader.prototype.isUnused=function(e){return!this.isLoaded(e)&&this.unusedBundles[e]},BundleLoader.prototype.clearUnusedResources=function(){var e=cc.director.getRunningScene();e&&!e.stopListeners&&e.sceneBundles&&e.performRecursive(function(e){e.refreshVirtualSpriteFrame&&e.refreshVirtualSpriteFrame()});var t=this.unusedResources;for(var n in t)if(!this.checkUrlUseInLoadedBundles(n)){var s=cc.textureCache.getTextureForKey(n);s&&(cc.spriteFrameCache.removeSpriteFramesFromTexture(s),cc.textureCache.removeTextureForKey(n)),
cc.loader.release(n)}this.unusedResources={},Object.keys(this.unusedBundles).forEach(function(e){bundles[e].injectTo||this.handles[e]||new Bundle(e).listJsons().forEach(function(e){delete cleverapps.Spine.cache[e]})}.bind(this)),this.unusedBundles={}},BundleLoader.prototype.getClassBundles=function(e,t,n){var s=[];return"function"==typeof e.BUNDLES?s=e.BUNDLES.apply(t,n):Array.isArray(e.BUNDLES)&&(s=e.BUNDLES),cleverapps.skins.getBundle()&&s.push(cleverapps.skins.getBundle()),s},BundleLoader.prototype.allLoaded=function(e){return 0===e.filter(function(e){return bundles[e]&&!this.isLoaded(e)},this).length};var cleverapps_events={APP_INITIALIZE:"app_initialize",PUSH_IOS:"push_ios",BEFORE_LEAVE_WINDOW:"before_leave_window",BEFORE_LEAVE_CATCH:"before_leave_catch",BOOKMARK:"bookmark",JOIN_GROUP:"join_group",AD_READY:"ad_ready",AD_START:"ad_start",AD_FINISH:"ad_finish",HINT_USED:"hint_used",REWARD_RECEIVED:"reward_received",SHOP_OPEN:"shop_open",TILE_SHOP_OPEN:"tile_shop_open",DAU:"dau",
DAU_LANGUAGE:"dau_language",USER_GOLD_DAU:"user_gold_dau",UNIQUE_START:"lev_start",UNIQUE_FINISH:"lev_finish",ERROR_AMOUNT:"error_amount",DAU_WFRIENDS_0:"dau_wfriends_0",DAU_WFRIENDS_1:"dau_wfriends_1",DAU_WFRIENDS_2:"dau_wfriends_2",DAU_WFRIENDS_3:"dau_wfriends_3",DAU_WFRIENDS_4:"dau_wfriends_4",DAU_WFRIENDS_5:"dau_wfriends_5",RETENTION_0:"retention_0",RETENTION_1:"retention_1",RETENTION_2:"retention_2",RETENTION_3:"retention_3",RETENTION_7:"retention_7",RETENTION_14:"retention_14",RETENTION_30:"retention_30",PRODUCT_BOUGHT:"product_bought",PRODUCT_BOUGHT_LANGUAGE:"product_bought_language",PURCHASE_VALIDATE_SUCCESS:"purchase_validate_success",PURCHASE_VALIDATE_FAILURE:"purchase_validate_failure",MOVES_SHOW:"moves_show",MOVES_BOUGHT:"moves_bought",MOVES_USED_FORCE:"moves_used_force",UNDO_USED:"undo",UNDO_USED_FORCE:"undo_force",BOMB_MOVES_BOUGHT:"bomb_moves_bought",LIVES_BOUGHT:"lives_bought",LIVES_FOR_VIDEO_SHOP:"lives_video_shop",BONUS_WORKER_BOUGHT:"bonus_worker_bought",
SOFT_CURRENCY_BUY:"soft_buy",SOFT_CURRENCY_COST:"soft_cost",SHARE:"share",SHARE_ITEM:"share_item",BOOSTERS_BOUGHT:"boosters_bought",BOOSTERS_BOUGHT_ITEM:"boosters_bought_item",BOOSTERS_EXECUTE:"boosters_execute",STAR_CHEST_OPEN:"star_chest_open",STAR_CHEST_OPEN_ITEM:"star_chest_open_item",DAILY_BONUS:"daily_bonus",DAILY_BONUS_DOUBLE:"daily_bonus_double",UNITS_SHOP_RUBY:"units_shop_ruby",UNITS_SHOP_COINS:"units_shop_coins",UNITS_SHOP_ITEM:"units_shop_item",SPECIAL_OFFER_COUNT:"special_offer_count",SPECIAL_OFFER_BUY:"special_offer_buy",SPECIAL_OFFER_RUBY:"special_offer_ruby",ENERGY_FEAST_PACK_BUY:"energy_feast_pack_buy",ENERGY_FEAST_PACK_RUBY:"energy_feast_pack_ruby",MONEY_FOG_RUBY:"money_fog_ruby",MONEY_FOG:"money_fog",GUN_FORCE:"gun_force",DAILY_TASKS_FORCE:"daily_tasks_force",FREE_HINT_FORCE:"free_hint_force",FREE_PAINT_FORCE:"free_paint_force",HEROES_AVAILABLE_FORCE:"heroes_available_force",LANTERN_FORCE:"lantern_force",FIRST_BOOSTERS_BEFORE:"first_boosters_before",
SECOND_BOOSTERS_BEFORE:"second_boosters_before",THIRD_BOOSTERS_BEFORE:"third_boosters_before",FREE_WILDCARD_FORCE:"free_wildcard_force",FREE_UNDO_FORCE:"free_undo_force",FREE_ADD_MOVES_FORCE:"free_add_moves_force",MOVES_FOR_BUY_SUCCESS:"moves_for_buy_success",MOVES_FOR_BUY_SHOW:"moves_for_buy_show",MOVES_FOR_VIDEO_SUCCESS:"moves_for_video_success",MOVES_FOR_VIDEO_SHOW:"moves_for_video_show",LIVES_FOR_VIDEO_SUCCESS:"lives_for_video_success",LIVES_FOR_VIDEO_SHOW:"lives_for_video_show",COINS_FOR_VIDEO_SUCCESS:"coins_for_video_success",COINS_FOR_VIDEO_SHOW:"coins_for_video_show",HINT_FOR_INVITE_SUCCESS:"hint_for_invite_success",HINT_FOR_INVITE_SHOW:"hint_for_invite_show",SIGN_IN_REWARD:"sign_in_reward",HELP_BY_FIVE_ATTEMPTS:"help_by_five_attemts",HELP_BY_ATTEMPTS_DAU:"help_by_attemts_dau",HELP_BY_ATTEMPTS_ONE_AND_MORE:"help_by_attemts_1_and_more",HELP_BY_ATTEMPTS_THREE_AND_MORE:"help_by_attemts_3_and_more",HELP_BY_ATTEMPTS_FIVE_AND_MORE:"help_by_attemts_5_and_more",FREE_MOVES:"free_moves",
FREE_BOMB_MOVES:"free_bomb_moves",RATE_WINDOW:"rate_window",RATE_SEND:"rate_send",RATE_1:"rate_1",RATE_2:"rate_2",RATE_3:"rate_3",RATE_4:"rate_4",RATE_5:"rate_5",TUTORIAL_STEP_1:"tutorial_step_1",TUTORIAL_STEP_2:"tutorial_step_2",TUTORIAL_STEP_3:"tutorial_step_3",TUTORIAL_COMPLETED:"fb_mobile_tutorial_completion",LEVEL_PASS_EVENT:"level_passed",LEVEL_START:"level_start",LEVEL_FINISH:"level_finish",LEVEL_GIVEUP:"level_giveup",ACHIEVED_LEVEL:"fb_mobile_level_achieved",LEVEL_PASSED_TIME:"level_passed_time",LEVEL_STARS:"level_stars",LEVEL_LEFT_MOVES:"level_left_moves",LEVEL_UP:"level_up",LEVEL_FPS:"level_fps",PLAY_TIMES:"play_times",MESSAGE_SENT_FRIEND:"message_friend",MESSAGE_SENT_INVITE:"message_invite",MESSAGE_SENT_PREFIX:"message_sent_",MESSAGE_CANCEL_PREFIX:"message_cancel_",MESSAGE_ERROR:"message_error",FAKEFB_BY_TIMEOUT:"fakefb_by_timeout",FAKEFB_BY_SCRIPT_ERROR:"fakefb_by_script_error",FACEBOOK_INITED:"facebook_inited",PAYER_PROMO_FOUND:"payer_promo_found",
PAYER_PROMO_SHOW:"payer_promo_show",PAYER_PROMO_BUY:"payer_promo_buy",PAYER_PROMO_DONE:"payer_promo_done",BOUNTY_OPENED:"bounty_opened",PACKWINDOW_OPENED:"packwindow_opened",PACK_STARTED:"pack_started",PACK_BOUGHT:"pack_bought",PACK_BOUGHT_WITH_PAYMENT:"pack_bought_with_payment",FREE_HINT_SHOWED:"free_hint_showed",TOURNAMENT_LEVEL_PLACE:"tournament_level_place",VIRAL_SENT_NONE:"viral_sent0",VIRAL_SENT_3:"viral_sent3",VIRAL_SENT_REST:"viral_sent_rest",FPS_AUTO:"fps_auto",FPS_LOW:"fps_low",FPS_HIGH:"fps_high",REWARDED_AVAILABLE:"rewarded_available",REWARDED_WATCHED:"rewarded_watched",MAKE_CHOICE:"make_choice",REDO_CHOICE:"redo_choice",BUY_CHOICE:"buy_choice",REWARDED_CHOICE:"rewarded_choice",REWARDED_SHARE:"rewarded_share_1",REWARDED_HINT:"rewarded_hint_1",REWARDED_ADD_MOVES:"rewarded_add_moves_1",REWARDED_ADD_LIVES:"rewarded_add_lives_1",REWARDED_ADD_COINS:"rewarded_add_coins_1",REWARDED_TOOLBAR:"rewarded_toolbar_1",REWARDED_DAILY_BONUS:"rewarded_dailybonus_1",
REWARDED_TOOLBAR_WINDOW_SHOW:"rewarded_toolbar_window_show",REWARDED_TOOLBAR_WINDOW_CLOSE:"rewarded_toolbar_window_close",REWARD_BUY:"reward_buy",LEADERS_WINDOW_OPEN:"leaders_window_open",NEW_LEAGUE:"new_league",PERIODIC_BONUS_FORCE:"periodic_bonus_force",BONUS_ROUND_FORCE:"bonus_round_force",GIVEUP_ATTENTION:"giveup_attention",GIVEUP_MISSION:"giveup_mission",GIVEUP_CHANGE:"giveup_change",GIVEUP_ATTENTION_NEARLY:"giveup_attention1",GIVEUP_CHANGE_NEARLY:"giveup_change1",SESSION_DAILY_TASK_AVAILABLE:"session_daily_task_available",SESSION_DAILY_TASK_FINISH:"session_daily_task_finish",SESSION_DAILY_TASK_REWARD:"session_daily_task_reward",SESSION_DAILY_TASK_OPEN_WINDOW:"session_daily_task_open_window",DAILY_TASK_CREATE:"daily_task_create",DAILY_TASK_REWARD:"daily_task_rewarded",DAILY_TASKS_OPEN_WINDOW:"daily_tasks_open_window",DAILY_TASKS_START:"daily_tasks_start",SPEND_COINS:"spend_coins",FB_SPEND_COINS:"fb_mobile_spent_credits",FBLOGINORINVITE_LOGIN:"extra_login",
FBLOGINORINVITE_INVITE:"extra_invite",HIGHSCORE_INVITE:"extra_highscore_invite",BOOSTER_CELL_ADDED:"booster_cell_added",BOOSTER_CELL_COLLECTED:"booster_cell_collected",BOOSTER_CELL_RECEIVED:"booster_cell_recevied",BUY_MOVES:"buy_moves_",MISSION_FINISH:"mission_finish",COMBO_PRIZE:"combo_3",COOKIEJAR_REWARD:"cookiejar_reward",GUN_SHOT_FORCE:"gunshotforce",GUN_SHOT:"gunshot",FAIL_BUNDLE:"fail_bundle_",PIGGY_BANK:"piggy_bank",PIGGY_BANK_LEVEL:"piggy_bank_level_",ACTIVE_TIME:"active_time",CHRISTMAS_FORCE:"christmas_force",CRYPTEX_REWARD:"cryptex_reward",CRYPTEX_FAIL:"cryptex_fail",WIN_KNOCKOUT:"win_knockout",LOSE_KNOCKOUT:"lose_knockout",SUBSCRIPTION_WINDOW_OPEN:"subscription_window_open",SUBSCRIPTION_REWARD:"subscription_reward",SUBSCRIPTION_BOUGHT:"subscription_bought",SUBSCRIPTION_CANCELLED:"subscription_cancelled",DAILY_CUP_REWARD:"daily_cup_reward",DAILY_CUP_DAU:"daily_cup_dau",DAILY_CUP_PLAYERS:"daily_cup_players",INSTANT_SHORTCUT_SHOW:"instant_shortcut_show",
INSTANT_SHORTCUT:"instant_shortcut",INSTANT_BOT_SHOW:"instant_bot_show",INSTANT_BOT_ERROR:"instant_bot_error",INSTANT_BOT:"instant_bot",INSTANT_UPDATE:"instant_update",INSTANT_PAYMENT:"instant_payment_",INSTANT_CONSUME:"instant_consume_",MISSION_DAU:"mission_dau",MISSION_START_DAU:"mission_start_dau",FAVORITE_REGULAR:"favorite_regular",FAVORITE_PRODUCT_BOUGHT:"favorite_sale_product_bought",LANTERN_COMBO_NO_PLACE:"lantern_combo_no_place",LANTERN_MULTICOLOR_NO_PLACE:"lantern_multicolor_no_place",BOOSTER_COMBO_NO_PLACE:"booster_combo_no_place",BOOSTER_MULTICOLOR_NO_PLACE:"booster_multicolor_no_place",BATTLE_PASS_FINISH_TASK:"battle_pass_finish_task",BATTLE_PASS_RECEIVED:"battle_pass_received",BATTLE_PASS_RECEIVED_PREMIUM:"battle_pass_received_premium",BATTLE_PASS_BOUGHT:"battle_pass_bought",RACE_FREE_REWARD:"race_free_reward",RACE_BUY_PREM:"race_buy_prem",RACE_FINISH_PLACE:"race_finish_place",RACE_LEVELS_PASSED:"race_levels_passed",RACE_LEVELS_PASSED_PREM:"race_levels_passed_prem",
METHA_ITEM:"metha_item",METHA_LEVEL:"metha_level",MINIGAME_FINISH:"minigame_finish",MINIGAME_REWARD:"minigame_reward",MINESWEEPER_START:"minesweeper_start",MINESWEEPER_VICTORY:"minesweeper_victory",MINESWEEPER_CONTINUE:"minesweeper_continue",MINESWEEPER_CONTINUE_RUBY:"minesweeper_continue_ruby",LOCALSTORAGE_CLEARED:"localstorage_cleared",LOCALSTORAGE_ERROR_SET_ITEM:"localstorage_error_set_item",RAFFLE_RESULT_UPDATE:"raffle_result_update",PAYMENT_OPEN:"payment_open",PAYMENT_CANCEL:"payment_cancel",PAYMENT_FAILURE:"payment_failure",PAYMENT_NOT_INITIALIZED:"payment_not_initialized",PAYMENT_NOT_REFRESHED:"payment_not_refreshed",PAYMENT_SUCCESS:"payment_success",TREASURE_SEARCH_START:"treasure_search_start",TREASURE_SEARCH_FINISH:"treasure_search_finish",SIMPLE_METHA_BACKGROUND:"simple_metha_background",CARD_SKIN_CHANGED:"card_skin_changed",CARD_SKIN_BOUGHT_USING_COINS:"card_skin_bought_using_coins",LOGIN:"login",SIGN_UP:"sign_up",TUTORIAL_COMPLETE:"tutorial_complete",
TUTORIAL_BEGIN:"tutorial_begin",SEARCH:"search",PRESENT_OFFER:"present_offer",JOIN_GROUP:"join_group",SELECT_CONTENT:"select_content",UNLOCK_ACHIEVEMENT:"unlock_achievement",POST_SCORE:"post_score",BONUS_WORLD_LEVEL:"bonus_world_level",PRODUCT_BOUGHT_BONUS_WORLD:"product_bought_bonus_world",BONUS_WORLD_DAU:"bonus_world_dau",BONUS_WORLD_LEVEL_DAU:"bonus_world_level_dau"};"undefined"!=typeof module&&(module.exports=cleverapps_events),cleverapps.setupResolution=function(){var c;cc.view.enableRetina(!0),cc.view.adjustViewPort(!0);var e=cleverapps.setupDesignResolution=function(e){var T=cc.view.getFrameSize();if(e=e||{},cc.sys.isMobile||"undefined"==typeof window||(T={width:window.innerWidth,height:window.innerHeight},c=window.innerHeight),!(T.width<cleverapps.SETUP_RESOLUTION_MIN_FRAME_SIZE||T.height<cleverapps.SETUP_RESOLUTION_MIN_FRAME_SIZE)&&(void 0===cleverapps.rightOrientation||(cleverapps.rightOrientation="horizontal"===cleverapps.config.orientation?T.width>T.height:T.width<T.height,
cleverapps.rotatePhoneInfo(cleverapps.rightOrientation),cleverapps.rightOrientation))){void 0!==cleverapps&&cleverapps.decCanvasHeight&&T.height>cleverapps.decCanvasHeight&&(T.height-=cleverapps.decCanvasHeight),e.sceneMaxWidthOverride&&(cleverapps.styles.SCENE_MAX_WIDTH=e.sceneMaxWidthOverride),e.width&&(T.width=e.width),e.height&&(T.height=e.height);var t=T.width/T.height;if(T.width&&T.height){var n={width:T.width,height:T.height};cleverapps.info.setKeyValue("resolution",n)}var s=cleverapps.styles.SCENE_HEIGHT,i=s*t;if(i<cleverapps.styles.SCENE_MIN_WIDTH&&(s=(i=cleverapps.styles.SCENE_MIN_WIDTH)/t),cc.sys.isNative)cc.view.setDesignResolutionSize(i,s,cc.ResolutionPolicy.SHOW_ALL);else{var o=cc.ContainerStrategy.extend({apply:function(e,t){var n,s,i=T.width,o=T.height,r=cc.container.style,a=t.width,c=t.height,l=i/a,p=o/c;l<p?(n=i,s=c*l):(n=a*p,s=o);var d=Math.round((i-n)/2);n=Math.round(n),s=Math.round(s),this._setupContainer(e,n,s),e._isRotated?r.marginLeft=o+"px":r.margin="0",
r.paddingLeft="0",r.paddingRight="0",r.paddingTop="0",r.paddingBottom="0",r.padding="0",r.margin="0 "+d+"px";var u=document.getElementById("bg");u&&(u.style.position="absolute",u.style.left="0px",u.style.top="0px");var h=document.getElementById("LeftBg");if(h)if(0<d){h.style.width=d+1+"px";var g=bundles.browser_resources.urls.left_bg||bundles.browser_resources.urls.pattern_bg_png;g&&(h.style.backgroundImage="url('"+g+"')")}else h.style.width="0";var v=document.getElementById("RightBg");if(v)if(0<d){v.style.left=d+n-1+"px",v.style.width=i-d-n+2+"px";var m=bundles.browser_resources.urls.right_bg||bundles.browser_resources.urls.pattern_bg_png;m&&(v.style.backgroundImage="url('"+m+"')")}else v.style.width="0";var f=document.getElementById("LeftSideBar"),_=document.getElementById("RightSideBar");if(f&&bundles.browser_resources.urls.sidebar){var y=cleverapps.styles.SIDEBAR_WIDTH,w=Math.ceil(y*s/1334),b=Math.ceil(5*s/1334);b<cleverapps.styles.MIN_SIDEBAR_X&&(b=cleverapps.styles.MIN_SIDEBAR_X)
,0<d?(f.style.left=d-w+b+"px",f.style.width=w+"px",f.style.backgroundImage="url('"+bundles.browser_resources.urls.sidebar+"')",_.style.left=d+n-b+"px",_.style.width=w+"px",_.style.backgroundImage="url('"+bundles.browser_resources.urls.sidebar+"')"):(f.style.width="0",_.style.width="0")}}});if(cleverapps.isInstant()&&cleverapps.styles.INSTANT_SCENE_MAX_WIDTH&&(cleverapps.styles.SCENE_MAX_WIDTH=cleverapps.styles.INSTANT_SCENE_MAX_WIDTH),i>cleverapps.styles.SCENE_MAX_WIDTH){var r=resolutions[cleverapps.settings.calcResolution()].horizontal;i=void 0!==cleverapps.styles.SCENE_HORIZONTAL_WIDTH&&i>=cleverapps.styles.SCENE_HORIZONTAL_WIDTH&&(T.height<cleverapps.styles.SCENE_HORIZONTAL_MAX_HEIGHT||r||cleverapps.wideMode&&cleverapps.wideMode.mode===cleverapps.WideMode.HORIZONTAL)?cleverapps.styles.SCENE_HORIZONTAL_WIDTH:cleverapps.styles.SCENE_MAX_WIDTH}var a=new cc.ResolutionPolicy(new o,cc.ContentStrategy.SHOW_ALL);cc.view.setDesignResolutionSize(i,s,a),
void 0!==cleverapps&&cleverapps.canvasTop&&(document.getElementById("Cocos2dGameContainer").style["margin-top"]=cleverapps.canvasTop)}cc.director.getRunningScene()&&cc.director.getRunningScene().onChangeSize&&cc.director.getRunningScene().onChangeSize(),cleverapps.onResolutionChanged(),cleverapps.canBlockOrientation=cleverapps.MobileOK.isAppropriate()||cleverapps.MobileMyMailRu.isAppropriate()||cleverapps.SPMobage.isAppropriate(),cleverapps.canBlockOrientation||!cc.sys.isMobile||cc.sys.isNative||(cleverapps.canBlockOrientation=!0),void 0===cleverapps.rightOrientation&&cleverapps.canBlockOrientation&&("horizontal"!==cleverapps.config.orientation&&i<s||"horizontal"===cleverapps.config.orientation&&s<i)&&(cleverapps.rightOrientation=!0,cleverapps.rotatePhoneInfo(!0))}};cc.view._orientationChanging=!1,cc.view.resizeWithBrowserSize(!0),cc.view.setResizeCallback(e),resolutionScale=resolutions[cleverapps.settings.calcResolution()].scale,cleverapps.UI.updateSizes(resolutionScale),
cleverapps.UI.selectSkinResources(cleverapps.settings.calcResolution()),cleverapps.home&&cleverapps.home.setupResolution(),cleverapps.farm&&cleverapps.farm.setupResolution(),e(),cc.sys.isMobile||"undefined"==typeof window||setTimeout(function(){c!==window.innerHeight&&e(),setTimeout(function(){c!==window.innerHeight&&e()},3e3)},1e3)},cleverapps.rotatePhoneInfo=function(e){document.getElementById("RotatePhoneText").innerText=Messages.get("Rotate.device"),document.getElementById("RotatePhoneIcon").src=bundles.rotate_phone.urls.rotate_png,document.getElementById("RotatePhone").style.display=e?"none":"block"},cleverapps.afterResolutionChanged=function(e){cleverapps._afterResolutionChangedCallbacks||(cleverapps._afterResolutionChangedCallbacks=[]),cleverapps._afterResolutionChangedCallbacks.push(e)},cleverapps.onResolutionChanged=function(){cleverapps._resolutionChangeTimeout&&clearInterval(cleverapps._resolutionChangeTimeout),cleverapps._whenResolutionStableTimeouts&&(
cleverapps._whenResolutionStableTimeouts.forEach(function(e){clearInterval(e)}),delete cleverapps._whenResolutionStableTimeouts),cleverapps._afterResolutionChangedCallbacks&&cleverapps._afterResolutionChangedCallbacks.forEach(function(e){e()}),cleverapps._resolutionChangeTimeout=setTimeout(cleverapps.onResolutionStable,500)},cleverapps.onResolutionStable=function(){cleverapps._whenResolutionStableCallbacks&&(cleverapps._whenResolutionStableCallbacks.forEach(function(e){e()}),delete cleverapps._whenResolutionStableCallbacks)},cleverapps.whenResolutionStable=function(e){cleverapps._whenResolutionStableCallbacks||(cleverapps._whenResolutionStableCallbacks=[]),e=cleverapps.once(e),cleverapps._whenResolutionStableCallbacks.push(e),cleverapps._whenResolutionStableTimeouts||(cleverapps._whenResolutionStableTimeouts=[]),cleverapps._whenResolutionStableTimeouts.push(setTimeout(e,500))},window.ENABLE_IMAEG_POOL=!1,cleverapps.EVENTS=cleverapps_events,cleverapps.whenAllInitialized=function(e){
cleverapps.allInitialized&&e(),cleverapps.__whenAllInitializedCallbacks||(cleverapps.__whenAllInitializedCallbacks=[]),cleverapps.__whenAllInitializedCallbacks.push(e)},cleverapps.afterAllLoadingFinish=function(){cleverapps.allInitialized=!0,cleverapps.__whenAllInitializedCallbacks&&cleverapps.__whenAllInitializedCallbacks.forEach(function(e){e()})},cleverapps.customBoardGameInitialization=function(e){levels.gameHints=new levels.GameHints,levels.cookieJar=new cleverapps.CookieJar,levels.tutorial=new cleverapps.Tutorial},cleverapps.customMatch3Initialization=function(e){levels.levelAttempts=new levels.LevelAttempts},cleverapps.afterResourceLoaded=function(e){"undefined"!=typeof document&&(document.title=Messages.get(cleverapps.config.title)),levels.initialize(),"board"===cleverapps.config.type?cleverapps.customBoardGameInitialization(e):"match3"===cleverapps.config.type&&cleverapps.customMatch3Initialization(e),cleverapps.metha.distract({focus:"afterAllLoadingFinish",actions:[function(e
){"undefined"!=typeof FBInstant?FBInstant.startGameAsync().then(e):e()},function(e){if(cleverapps.afterAllLoadingFinish(),cleverapps.dailyLevel.isStartFromPortlet())return cleverapps.eventLogger.logEvent("daily_level_channel_"+cleverapps.dailyLevel.getCurrentEvent()),void cleverapps.dailyLevel.start(e);"mergecraft"===cleverapps.config.name&&cleverapps.config.editorMode&&cleverapps.isLocalhost()&&(e(),cleverapps.config.adminMode=!0,new Episode(0).getLevel(0).edit()),cleverapps.Plot.onStartup(e)}]})},cleverapps.createGlobalObjects=function(){Missions.initialize(),cleverapps.bundleLoader=new BundleLoader,cleverapps.flags=new cleverapps.Flags,cleverapps.social=cleverapps.SocialManager.create(),cleverapps.eventBus=new cleverapps.EventEmitter,cleverapps.DataLoader.init(),cleverapps.synchronizer=new cleverapps.Synchronizer,cleverapps.eventLogger=new cleverapps.EventsLogger,cleverapps.metha=new Metha,cleverapps.playSession=new PlaySession,cleverapps.info=new cleverapps.Information
;var e=levels.initUser();return cleverapps.abTest=new cleverapps.ABTest,cleverapps.history=new History,cleverapps.scenes=new cleverapps.Scenes,cleverapps.environment=new cleverapps.Environment,cleverapps.communityManager=new CommunityManager,cleverapps.skins=new cleverapps.SkinManager,cleverapps.windows=new Windows,cleverapps.settings=new cleverapps.Settings(e),cleverapps.audio=new cleverapps.Audio,cleverapps.versionChecker=new VersionChecker,cleverapps.userresult=new UserResult,cleverapps.info.reportPhone(),cleverapps.info.reportUserAgent(),cleverapps.info.reportAppVersion(),cleverapps.info.reportMaxTextureSize(),cleverapps.info.reportSysLanguage(),cleverapps.firebase=cleverapps.FirebaseManager.run(),cleverapps.firebase.init(),cleverapps.metha.getType()===Metha.FARM?(cleverapps.farm=new Farm,MethaHelper.prepare()):cleverapps.metha.getType()===Metha.HOMEFIX?(cleverapps.home=new Home,MethaHelper.prepare()):cleverapps.metha.getType()===Metha.KNOCKOUT&&(cleverapps.knockout=new Knockout),
cleverapps.metha.getType()===Metha.SIMPLE&&(cleverapps.simple=new Simple),cleverapps.promotion=new cleverapps.Promotion,cleverapps.adjust=new cleverapps.Adjust,cleverapps.facebookEventsLogger=new cleverapps.FacebookEventsLogger,cleverapps.friends=new FriendsCache,cleverapps.invitalbleFriends=new FriendsCache(!0),cleverapps.payments=cleverapps.PaymentsManager.init(),cleverapps.paymentsHistory=new cleverapps.PaymentsHistory,cleverapps.localPushes=new cleverapps.LocalPushes,levels.progress=new Progress,levels.episodes=EpisodesManager.create(),cleverapps.serverFlags=new cleverapps.ServerFlags,cleverapps.periodicBonus=new cleverapps.MiniGame(e),cleverapps.boostersCounter=new cleverapps.BoostersCounter(e),cleverapps.gun=new Gun,cleverapps.isKnockoutGame()&&(cleverapps.knockoutTutorial=new KnockoutTutorial),cleverapps.tempGoods=new cleverapps.TempGoods,cleverapps.config.lives&&(cleverapps.lives=new cleverapps.Lives(e)),cleverapps.dailyTasks=new cleverapps.DailyTasks(e),
cleverapps.forces=new Forces,cleverapps.packManager=new PackManager,cleverapps.piggyBank=new PiggyBank,Subscription.IsModelAvailable()&&(cleverapps.subscription=new Subscription),"undefined"!=typeof Heroes&&(match3.heroes=new Heroes),"match3"===cleverapps.config.type&&(cleverapps.starChest=new cleverapps.StarChest),levels.friendSorter=new FriendSorter,levels.friendRequests=new levels.FriendRequests,cleverapps.eventManager=new EventManager,cleverapps.competitionPlayers=new CompetitionPlayers,cleverapps.competitionStatistics=new CompetitionStatistics,cleverapps.bountyManager=new BountyManager,cleverapps.leadersWindowTable=new cleverapps.Table,cleverapps.dailyCupLeadersWindowTable=new cleverapps.Table,cleverapps.dailyCup=new DailyCup(DailyCup.TYPE_DAILY),-1!==["olympics","differences"].indexOf(cleverapps.config.name)&&(cleverapps.weeklyCup=new DailyCup(DailyCup.TYPE_WEEKLY),cleverapps.weeklyCupTop=new WeeklyCupTop),-1!==["tripeaks","spades"].indexOf(cleverapps.config.name)&&(
cleverapps.cardSkins=new CardSkins),"merge"===cleverapps.config.type&&(cleverapps.unitSyncer=new UnitSyncer,cleverapps.unitSaver=new UnitSaver),cleverapps.dailyLevel=new DailyLevel,cleverapps.user.calcIdfa(),cleverapps.rewardedAdsManager=new RewardedAdsManager,cleverapps.toolbar=new Toolbar,cleverapps.sideBar=new SideBar,cleverapps.menuBar=new MenuBar,cleverapps.missionManager=new MissionManager,void 0!==cleverapps.BonusRoundChest&&(cleverapps.bonusRoundChest=new cleverapps.BonusRoundChest(e),cleverapps.toolbar.addItem(new BonusRoundToolbarItem)),cleverapps.exclamation=new Exclamation,cleverapps.tooltipManager=new TooltipManager,PlayButton.IsAvailable()&&(cleverapps.playButton=new PlayButton),cleverapps.chat=new Chat,cleverapps.keyboardController=new KeyboardController,cleverapps.wideMode=new cleverapps.WideMode,e},cleverapps.onStart=function(){"undefined"!=typeof document&&(document.title=cleverapps.config.title);var e=cleverapps.createGlobalObjects(),t=2;cleverapps.flags.norest||(t++
,cleverapps.synchronizer._onceFirstSyncCompletedListener=cleverapps.waitNoMore(3e3,function(){console.log("first sync"),s()})),cc.sys.os===cc.sys.OS_IOS&&cc.sys.isNative&&cc.sys.isWebView&&cleverapps.LocalPushes.IosWebViewSender.askPermission();var n=function(){cleverapps.afterResourceLoaded(e)},s=cleverapps.wait(t,function(){cc.loaderScene.beforeTransitionAnimations?cc.loaderScene.beforeTransitionAnimations(n):n()});cleverapps.social.initialize(function(){cleverapps.versionChecker.check(),0===levels.user.getProgress()&&(cc.sys.isNative||cleverapps.social.loginPlacement||"sp_mbga"===cleverapps.User.calcSource()||cleverapps.social.checkConnection()),cleverapps.social.isLoggedIn()?cleverapps.SocialManager.onLogin():cleverapps.synchronizer.syncWhenReady(),cleverapps.FBLike.createLikeButtons(),cleverapps.NativeLinks.createLinks(),s()}),function(){cleverapps.setupResolution(),cleverapps.Spine.prepare(),cc.eventManager.addCustomListener(cc.game.EVENT_SHOW,cleverapps.Parallax.refresh)
;var e=cc.LoaderScene;cc.loaderScene=new LoaderScene,cc.loaderScene.init(),cc.eventManager.addCustomListener(cc.Director.EVENT_PROJECTION_CHANGED,function(){cc.loaderScene._updateTransform()}),cc.loaderScene.sceneBundles=ResourceProcessor.calcProbablyNeed();var t=[].concat.apply([],cc.loaderScene.sceneBundles.map(function(e){return new Bundle(e).listUrls()}));e.preload(t,function(){cleverapps.bundleLoader.loadBundles(cc.loaderScene.sceneBundles,{onSuccess:function(){cc.sys.isNative||"undefined"==typeof logTimeStart||(logTimeStartTimeout&&clearTimeout(logTimeStartTimeout),logTimeStart.save()),Messages.preload(cleverapps.settings.language,s)}})})}()},cleverapps.styles={},cleverapps.styles.ALIGN_BOTTOM="b",cleverapps.styles.GetRealCoord=function(e,t){return"number"==typeof e?e:e===cleverapps.styles.ALIGN_BOTTOM?t.height/2:void 0},cleverapps.styles.SCENE_HEIGHT=1334,cleverapps.styles.SCENE_MAX_WIDTH=1500,cleverapps.styles.SCENE_MIN_WIDTH=660,cleverapps.SETUP_RESOLUTION_MIN_FRAME_SIZE=150,
cleverapps.styles.SQUARE_MODE_WIDTH=1300,cleverapps.styles.SIDEBAR_WIDTH=35,cleverapps.styles.MIN_SIDEBAR_X=2,cleverapps.styles.COLORS={BLACK:new cc.Color(0,0,0,255),BLACK_STROKE:new cc.Color(0,0,0,90),COLOR_GRAY:new cc.Color(200,200,200,255),COLOR_DARK_GRAY:new cc.Color(150,150,150,255),COLOR_VERY_DARK_GRAY:new cc.Color(100,100,100,255),WHITE:new cc.Color(255,255,255,255),GREEN:new cc.Color(13,119,0,255),YELLOW:new cc.Color(255,255,0,255),HOVER:new cc.Color(230,230,230,255),COLOR_BROWN:new cc.Color(60,45,25,255),COLOR_RED:new cc.Color(255,0,0,255),MESSAGE_GREEN:new cc.Color(4,160,41,255),LIFE_GREEN:new cc.Color(24,200,61,255),PINK:new cc.Color(255,102,102,255),COLOR_DARK_BROWN:new cc.Color(120,85,85,255),HERO_STATS_UPGRADE:new cc.Color(57,237,7,255),GUN_PRICE_FONT_COLOR:new cc.Color(176,125,82,255),REWARDS_TEXT_STROKE_COLOR:new cc.Color(76,98,109,255),GRAY_SCALE_COLOR:new cc.Color(135,135,135,255),GRAY_SCALE_RESTORE_COLOR:new cc.Color(255,255,255,255),
DAILY_TOURNAMENT_TIMER:new cc.Color(130,70,40,255),BOOSTERS_SALE_TEXT_COLOR:new cc.Color(191,164,119,255),DARK_RED:new cc.Color(200,0,0,255),COLOR_DARK_YELLOW:new cc.Color(255,194,9,255),COLOR_BROWN_2:new cc.Color(173,61,0,255),COLOR_WINDOW_TEXT:new cc.Color(130,70,40,255),COLOR_VERYLIGHTBROWN:new cc.Color(220,191,144,255),TOOLTIP_COLOR:new cc.Color(148,49,19,255),COINS_REWARD_YELLOW:new cc.Color(255,244,55,255),COINS_REWARD_STROKE_COLOR:new cc.Color(149,67,23,255),MINIGAME_REWARD_TEXT:new cc.Color(66,68,80)},cleverapps.styles.DECORATORS={DARK_OLIVE_GREEN_STROKE:{color:new cc.Color(121,94,46,255),size:4},WHITE_TEXT_SHADOW:{color:cleverapps.styles.COLORS.BLACK,direction:cc.size(0,-4),blur:5},BROWN_STROKE:{color:cleverapps.styles.COLORS.COLOR_BROWN_2,size:3},BUTTON_TEXT_SHADOW:{color:cleverapps.styles.COLORS.BLACK,direction:cc.size(0,0),blur:5},BUTTON_TEXT_STROKE:{color:cleverapps.styles.COLORS.BLACK,size:2},WINDOW_WHITE_TEXT_STROKE:{color:cleverapps.styles.COLORS.BLACK,size:1},
REWARDS_TEXT_STROKE:{color:cleverapps.styles.COLORS.REWARDS_TEXT_STROKE_COLOR,size:3},DAILY_TOURNAMENT_TITLE_STROKE:{color:new cc.Color(116,17,168,255),size:4},TILE_SHOP_WINDOW_STROKE:{color:new cc.Color(150,111,72,255),size:2},TILE_SHOP_WINDOW_TITLE_SHADOW:{color:new cc.Color(112,109,109,255),direction:cc.size(0,-4),blur:0},IMAGE_FONT_STROKE:{color:cleverapps.styles.COLORS.BLACK_STROKE,size:1},IMAGE_FONT_SHADOW:{color:cleverapps.styles.COLORS.BLACK,direction:cc.size(0,-1),blur:3},TRANSPARENT_BLACK_2PX:{color:cleverapps.styles.COLORS.BLACK_STROKE,size:2}},cleverapps.styles.FONTS=cleverapps.overrideFonts({},{VICTORY_TEXT:{size:56,color:cleverapps.styles.COLORS.WHITE,shadow:cleverapps.styles.DECORATORS.WHITE_TEXT_SHADOW},GUN_PRICE_TEXT:{size:40,color:cleverapps.styles.COLORS.GUN_PRICE_FONT_COLOR},MISSION_RULES_BUTTON_TEXT:{size:64,color:cleverapps.styles.COLORS.WHITE},FBLOGINORINVITE_TEXT:{size:28,color:cleverapps.styles.COLORS.WHITE,stroke:cleverapps.styles.DECORATORS.IMAGE_FONT_STROKE
},BUTTON_TEXT:{size:40,color:cleverapps.styles.COLORS.WHITE,shadow:cleverapps.styles.DECORATORS.BUTTON_TEXT_SHADOW,stroke:cleverapps.styles.DECORATORS.BUTTON_TEXT_STROKE},SUBSCRIPTION_BUTTON_SMALL_TEXT:{size:30,color:cleverapps.styles.COLORS.WHITE},SUBSCRIPTION_BUTTON_TEXT:{size:60,color:cleverapps.styles.COLORS.WHITE,stroke:cleverapps.styles.DECORATORS.IMAGE_FONT_STROKE},SUBSCRIPTION_OFFERS_MAIN_TEXT:{size:44,color:cleverapps.styles.COLORS.WHITE,shadow:cleverapps.styles.DECORATORS.BUTTON_TEXT_SHADOW,stroke:cleverapps.styles.DECORATORS.BUTTON_TEXT_STROKE},SUBSCRIPTION_OFFERS_TEXT:{size:16,color:cleverapps.styles.COLORS.WHITE,shadow:cleverapps.styles.DECORATORS.BUTTON_TEXT_SHADOW,stroke:cleverapps.styles.DECORATORS.BUTTON_TEXT_STROKE},TOURNAMENTSTORY_OFFERS_MAIN_TEXT:{size:38,color:cleverapps.styles.COLORS.WHITE,shadow:cleverapps.styles.DECORATORS.BUTTON_TEXT_SHADOW,stroke:cleverapps.styles.DECORATORS.BUTTON_TEXT_STROKE},TOURNAMENTSTORY_OFFERS_TEXT:{size:16,
color:cleverapps.styles.COLORS.WHITE,shadow:cleverapps.styles.DECORATORS.BUTTON_TEXT_SHADOW,stroke:cleverapps.styles.DECORATORS.BUTTON_TEXT_STROKE},TOURNAMENTSTORY_ARROW_TEXT:{size:32,color:cleverapps.styles.COLORS.WHITE,shadow:cleverapps.styles.DECORATORS.BUTTON_TEXT_SHADOW,stroke:cleverapps.styles.DECORATORS.BUTTON_TEXT_STROKE},TOURNAMENTSTORY_BUTTON_TEXT:{size:40,color:cleverapps.styles.COLORS.WHITE},BUTTON_SMALL_TEXT:{size:30,color:cleverapps.styles.COLORS.WHITE,shadow:cleverapps.styles.DECORATORS.BUTTON_TEXT_SHADOW,stroke:cleverapps.styles.DECORATORS.BUTTON_TEXT_STROKE},GAME_REWARD_BUTTON_TEXT:{size:30,color:cleverapps.styles.COLORS.WHITE,shadow:cleverapps.styles.DECORATORS.BUTTON_TEXT_SHADOW,stroke:cleverapps.styles.DECORATORS.BUTTON_TEXT_STROKE},TEXT:{size:40,color:cleverapps.styles.COLORS.WHITE,stroke:cleverapps.styles.DECORATORS.IMAGE_FONT_STROKE},VICTORY_CHEST_TEXT:{name:"default",size:50},SMALL_TEXT:{size:30,color:cleverapps.styles.COLORS.WHITE,
stroke:cleverapps.styles.DECORATORS.IMAGE_FONT_STROKE},SMALL_TEXT_BROWN:{size:30,color:cleverapps.styles.COLORS.COLOR_BROWN},WINDOW_TEXT:{size:40,color:cleverapps.styles.COLORS.COLOR_BROWN},MISSIONS_TEXT:{size:30,color:cleverapps.styles.COLORS.WHITE,stroke:cleverapps.styles.DECORATORS.IMAGE_FONT_STROKE},DAILY_TASK_BOOSTER_AMOUNT_TEXT:{size:60,color:cleverapps.styles.COLORS.COLOR_BROWN},WINDOW_SMALL_TEXT:{size:30,color:cleverapps.styles.COLORS.COLOR_BROWN},SUBSCRIBE_TERMS_TEXT:{size:22,color:cleverapps.styles.COLORS.COLOR_GRAY},SUBSCRIBE_CTA_TITLE:{size:36,color:cleverapps.styles.COLORS.COLOR_BROWN},SUBSCRIBE_FEATURE_TEXT:{size:36,color:cleverapps.styles.COLORS.COLOR_VERY_DARK_GRAY},SUBSCRIBE_BUTTON_TEXT:{size:50,color:cleverapps.styles.COLORS.WHITE,stroke:cleverapps.styles.DECORATORS.IMAGE_FONT_STROKE},SUBSCRIBE_CTA_TEXT:{size:36,color:cleverapps.styles.COLORS.COLOR_BROWN},SUBSCRIBE_TITLE_TEXT:{size:70,color:cleverapps.styles.COLORS.COLOR_BROWN},SUBSCRIBE_TERMS_BUTTIONS_TEXT:{size:24,
color:cleverapps.styles.COLORS.COLOR_BROWN},SUBSCRIPTION_MAIN_TEXT:{size:25,color:cleverapps.styles.COLORS.COLOR_BROWN},SUBSCRIPTION_REWARD_READY_TEXT:{size:34,color:cleverapps.styles.COLORS.COLOR_WINDOW_TEXT},SUBSCRIPTION_BUTTON_ADDITIONAL_TEXT:{size:18,color:cleverapps.styles.COLORS.GUN_PRICE_FONT_COLOR},REWARDS_TEXT:{size:30,color:cleverapps.styles.COLORS.WHITE,stroke:cleverapps.styles.DECORATORS.REWARDS_TEXT_STROKE},HERO_STATS_VALUE:{size:30,color:cleverapps.styles.COLORS.COLOR_WINDOW_TEXT},HERO_UPGRADE:{size:34,color:cleverapps.styles.COLORS.WHITE,stroke:cleverapps.styles.DECORATORS.IMAGE_FONT_STROKE},HERO_STATS_UPGRADE_VALUE:{size:30,color:cleverapps.styles.COLORS.HERO_STATS_UPGRADE,stroke:cleverapps.styles.DECORATORS.IMAGE_FONT_STROKE},INFO_EXP_TEXT:{size:37,color:cleverapps.styles.COLORS.WHITE,stroke:cleverapps.styles.DECORATORS.IMAGE_FONT_STROKE},SMALL_TEXT_ERROR:{size:30,color:cleverapps.styles.COLORS.COLOR_RED},EPISODE_TITLE_TEXT:{size:40,
color:cleverapps.styles.COLORS.COLOR_BROWN},SHARE_BUTTON_REWARD_TEXT:{},WHITE_TEXT:{size:40,color:cleverapps.styles.COLORS.WHITE,stroke:cleverapps.styles.DECORATORS.IMAGE_FONT_STROKE},SMALL_WHITE_TEXT:{size:30,color:cleverapps.styles.COLORS.WHITE,stroke:cleverapps.styles.DECORATORS.IMAGE_FONT_STROKE},LIVES_AMOUNT_TEXT:{name:"default",size:40},DAILY_TASKS_LEVEL_TEXT:{size:35,color:cleverapps.styles.COLORS.WHITE,stroke:cleverapps.styles.DECORATORS.IMAGE_FONT_STROKE},DAILY_TASK_BUTTON_TEXT:{size:46,color:cleverapps.styles.COLORS.WHITE,stroke:cleverapps.styles.DECORATORS.IMAGE_FONT_STROKE},PIGGY_BANK_AMOUNT_TEXT:{size:44,color:cleverapps.styles.COLORS.WHITE,stroke:cleverapps.styles.DECORATORS.IMAGE_FONT_STROKE},PACK_WINDOW_TEXT:{size:35,color:cleverapps.styles.COLORS.BLACK},FORCE_MESSAGE_TEXT:{size:40,color:cleverapps.styles.COLORS.COLOR_BROWN},DAILY_TOURNAMENT_TITLE_TEXT:{size:55,color:cleverapps.styles.COLORS.WHITE,stroke:cleverapps.styles.DECORATORS.DAILY_TOURNAMENT_TITLE_STROKE},
DAILY_TOURNAMENT_TEXT:{size:40,color:cleverapps.styles.COLORS.DAILY_TOURNAMENT_TIMER},BIG_BUTTON_TEXT:{size:70,color:cleverapps.styles.COLORS.WHITE,stroke:cleverapps.styles.DECORATORS.IMAGE_FONT_STROKE},BREAKVIEW_AMOUNT_TEXT:{size:30,color:cleverapps.styles.COLORS.WHITE,stroke:cleverapps.styles.DECORATORS.IMAGE_FONT_STROKE},TILE_SHOP_WINDOW_TEXT:{size:35,color:cleverapps.styles.COLORS.WHITE,stroke:cleverapps.styles.DECORATORS.TILE_SHOP_WINDOW_STROKE},TILE_SHOP_WINDOW_TITLE_TEXT:{size:85,color:cleverapps.styles.COLORS.WHITE,shadow:cleverapps.styles.DECORATORS.TILE_SHOP_WINDOW_TITLE_SHADOW},WHITE_TITLE_TEXT:{size:60,color:cleverapps.styles.COLORS.WHITE,stroke:cleverapps.styles.DECORATORS.IMAGE_FONT_STROKE},LEVEL_TUTORIAL_TEXT:{size:30,color:cleverapps.styles.COLORS.WHITE,stroke:cleverapps.styles.DECORATORS.IMAGE_FONT_STROKE},TOOLTIP_TEXT:{size:40,color:cleverapps.styles.COLORS.TOOLTIP_COLOR},TOOLTIP_FONT:{color:cleverapps.styles.COLORS.TOOLTIP_COLOR,size:40},
TREASURE_SEARCH_PROGRESS_BAR_TEXT:{name:"default",size:35,color:cleverapps.styles.COLORS.WHITE,stroke:cleverapps.styles.DECORATORS.IMAGE_FONT_STROKE},DAILY_TASK_PROGRESS_FONT:{name:"default",size:35}}),cleverapps.styles.SpineSkins={},cleverapps.Environment=function(){this.episodeNo=levels.user.episode,this.levelNo=levels.user.level,this.scene=void 0,this.onOpenWindowListener=function(e){},this.paused=!1,this.onShowCallbacks=[],this.onShowCounter=0,cc.eventManager.addCustomListener(cc.game.EVENT_SHOW,this.onShow.bind(this)),cc.eventManager.addCustomListener(cc.game.EVENT_HIDE,this.onHide.bind(this)),this.onShowTime=Date.now()},cleverapps.whenShow=function(n){return function(){var e=this,t=arguments;cleverapps.environment.whenShow(function(){n.apply(e,t)})}},cleverapps.Environment.prototype.whenShow=function(e){this.paused?this.onShowCallbacks.push(e):e()},cleverapps.Environment.prototype.onHide=function(){this.paused=!0,this.onShowTimeout&&(clearTimeout(this.onShowTimeout),
delete this.onShowTimeout)},cleverapps.Environment.prototype.onShow=function(){this.onShowTime=Date.now(),this.onShowCounter++,this.onShowTimeout=setTimeout(function(){delete this.onShowTimeout,this.paused=!1;var e=this.onShowCallbacks;this.onShowCallbacks=[],e.forEach(function(e){this.whenShow(e)}.bind(this))}.bind(this),300)},cleverapps.Environment.prototype.setScene=function(e){this.scene=e,cleverapps.firebase&&cleverapps.firebase.setScreenName(this.getScreen(),this.getScene())},cleverapps.Environment.prototype.isDailyCupScene=function(){return this.scene===cleverapps.Environment.SCENE_DAILY_CUP},cleverapps.Environment.prototype.isMainScene=function(){return this.scene===cleverapps.Environment.SCENE_MAIN||"merge"===cleverapps.config.type&&this.scene===cleverapps.Environment.SCENE_GAME},cleverapps.Environment.prototype.isMethaScene=function(){return this.scene===cleverapps.Environment.SCENE_METHA||this.scene===cleverapps.Environment.SCENE_MAIN&&!cleverapps.metha.withSimpleMain()},
cleverapps.Environment.prototype.isHeroesScene=function(){return this.scene===cleverapps.Environment.SCENE_HEROES},cleverapps.Environment.prototype.isGameScene=function(){return this.scene===cleverapps.Environment.SCENE_GAME},cleverapps.Environment.prototype.isEditorScene=function(){return this.scene===cleverapps.Environment.SCENE_EDITOR},cleverapps.Environment.prototype.isChatScene=function(){return this.scene===cleverapps.Environment.SCENE_CHAT},cleverapps.Environment.prototype.isMiniGameScene=function(){return this.scene===cleverapps.Environment.SCENE_MINE||this.scene===cleverapps.Environment.SCENE_SLOT_MACHINE},cleverapps.Environment.prototype.isAdministratorScene=function(){return this.scene===cleverapps.Environment.SCENE_ADMINISTRATOR},cleverapps.Environment.prototype.isSceneWithPreview=function(){return this.scene===cleverapps.Environment.SCENE_EDITOR||this.scene===cleverapps.Environment.SCENE_ADMINISTRATOR||this.scene===cleverapps.Environment.SCENE_WYSIWYG},
cleverapps.Environment.prototype.isWysiwygScene=function(){return this.scene===cleverapps.Environment.SCENE_WYSIWYG},cleverapps.Environment.prototype.isRaceScene=function(){return this.scene===cleverapps.Environment.SCENE_RACE},cleverapps.Environment.prototype.isBonusWorldScene=function(){return this.scene===cleverapps.Environment.SCENE_BONUS_WORLD},cleverapps.Environment.prototype.isSlotMachineScene=function(){return this.scene===cleverapps.Environment.SCENE_SLOT_MACHINE},cleverapps.Environment.prototype.onOpenWindow=function(e){this.onOpenWindowListener(e),cleverapps.firebase&&cleverapps.firebase.setScreenName(this.getScreen(),this.getScene())},cleverapps.Environment.prototype.onCloseWindow=function(e){cleverapps.firebase&&cleverapps.firebase.setScreenName(this.getScreen(),this.getScene())},cleverapps.Environment.prototype.getActiveWindow=function(){var e=cleverapps.windows&&cleverapps.windows.currentWindow();if(e&&e.name)return e.name},
cleverapps.Environment.prototype.getScreen=function(){return this.getActiveWindow()||this.getScene()},cleverapps.Environment.prototype.getScene=function(){return this.scene},cleverapps.Environment.SCENE_MAIN="main",cleverapps.Environment.SCENE_METHA="metha",cleverapps.Environment.SCENE_GAME="game",cleverapps.Environment.SCENE_EDITOR="editor",cleverapps.Environment.SCENE_ADMINISTRATOR="administrator",cleverapps.Environment.SCENE_COMICS="comics",cleverapps.Environment.SCENE_HEROES="heroes",cleverapps.Environment.SCENE_CARD_SKINS="cardskins",cleverapps.Environment.SCENE_DAILY_CUP="dailycup",cleverapps.Environment.SCENE_RACE="race",cleverapps.Environment.SCENE_TRIPEAKS="tripeaks",cleverapps.Environment.SCENE_CHAT="chat",cleverapps.Environment.SCENE_WYSIWYG="wysiwyg",cleverapps.Environment.SCENE_BONUS_WORLD="bonusworld",cleverapps.Environment.SCENE_SLOT_MACHINE="slotmachine",cleverapps.Environment.SCENE_MINE="mine",resolutionScale=1,cleverapps.UI={stableKeys:["verticalAlignment","texType",
"opacity","scale9","parent","scale","minScale","maxScale","rotation","baseScale","zoomScale","zoom","scaleX","scaleY","anchorX","anchorY","zIndex","zOrder","mobileScaleAdd","coinScale","SIDEBAR_WIDTH","MOBILE_MENU_SCALE","MIN_SIDEBAR_X","duration","delay","idleDelay","visiblePages","type","hideDirection","widthMultiplier","number","zeroPercentage","mobileScale","innerScale","dialogueStages","baseline","skew","anchor","factorX","factorY","smallMargin"],needUpdateSizes:function(e,t,n){return!(n instanceof cc.Color)&&(("direction"!==t||"object"==typeof n)&&!(0<=cleverapps.UI.stableKeys.indexOf(t)))},updateSizes:function(s){var i={},o=[],r=function(e){if(!e.isUpdated)for(var t in e.isUpdated=!0,o.push(e),e){var n=e[t];if("number"==typeof n){if(Array.isArray(e))continue;cleverapps.UI.needUpdateSizes(e,t,n)&&(i[t]=!0,e[t]*=s,e[t]=Math.round(e[t]))}else"object"==typeof n&&cleverapps.UI.needUpdateSizes(e,t,n)&&r(n)}};cleverapps.styles.isUpdated||(r(cleverapps.styles),
cleverapps.config.fonts.forEach(function(e){e.originalSize=e.size+""}),r(cleverapps.config.fonts),cleverapps.values(Forces).forEach(function(e){e.style&&r(e.style),e.Finger&&r(e.Finger)}),o.forEach(function(e){delete e.isUpdated}),cleverapps.styles.isUpdated=!0)},selectSkinResources:function(e){var i=function(e,t,n){for(var s in e)"string"==typeof e[s]&&(e[s]=e[s].replace("/%r/","/"+t+"/")),n&&"object"==typeof e[s]&&i(e[s],t,n)};for(var t in i(res,e),bundles){var n=bundles[t];i(n.urls,e),i(n.frames,e),i(n.jsons,e)}for(var s in cleverapps.styles){var o=cleverapps.styles[s];i(o,e,!0)}if("object"==typeof HeroesLibrary&&i(HeroesLibrary,e,!0),"undefined"!=typeof CardSkins&&i(CardSkins,e,!0),void 0!==unpackedMap)for(var t in unpackedMap)-1!==t.indexOf("/%r/")&&(unpackedMap[t.replace("/%r/","/"+e+"/")]=unpackedMap[t],delete unpackedMap[t])},HORIZONTAL:0,VERTICAL:1,ALIGN_START:1,ALIGN_CENTER:2,ALIGN_END:3,TOP_TO_BOTTOM:2,SCALE_ANIMATION:2,OPACITY_ANIMATION:3,arrangeWithMargins:function(r,a){
var c=a.margin;void 0===c&&(c=0);var l=0;l=a.direction===cleverapps.UI.HORIZONTAL?a.x||0:a.y||0;var p=a.iterator;return p||(p=function(e,t,n){if(a.align===cleverapps.UI.ALIGN_START||a.align===cleverapps.UI.ALIGN_END){var s=a.direction===cleverapps.UI.HORIZONTAL?e.height*e.scaleY/2:e.width*e.scaleX/2;a.align===cleverapps.UI.ALIGN_END&&(s=-s),a.direction===cleverapps.UI.HORIZONTAL?n+=s:t+=s}e.setPositionRound(t,n)}),r.forEach(function(e,t){a.direction===cleverapps.UI.TOP_TO_BOTTOM&&(e=r[r.length-1-t]);var n=e.baseScaleX||e.baseScale||e.scaleX,s=e.baseScaleY||e.baseScale||e.scaleY;if(a.direction===cleverapps.UI.HORIZONTAL){var i=e.y;void 0!==a.y&&(i=a.y-(.5-e.anchorY)*e.height*Math.abs(s)),p(e,l+e.width*Math.abs(n)*e.anchorX,i),l+=e.width*Math.abs(n)}else{var o=e.x;void 0!==a.x&&(o=a.x-(.5-e.anchorX)*e.width*Math.abs(n)),p(e,o,l+e.height*Math.abs(s)*e.anchorY),l+=e.height*Math.abs(s)}l+=c}),l-c},calculateContentSize:function(e){var t=0,n=0;return e.children.forEach(function(e){
t<e.x+e.width*e.scaleX/2&&(t=e.x+e.width*e.scaleX/2),n<e.y+e.height*e.scaleY/2&&(n=e.y+e.height*e.scaleY/2)}),cc.size(Math.round(t),Math.round(n))},fitToBox:function(e,t){var n=Math.min(t.width/e.width,t.height/e.height,t.maxScale||1);e.setScale(n)},LabelTTF:cc.extend(cc.LabelTTF.extend({ctor:function(e,t){this.___enabled=!0,this._strokeOpacity=0,this._super("",t)},onEnter:function(){this.___enabled=!0,this._super()},onExit:function(){this.___enabled=!1,this._super()},fitToHeight:function(e){for(;this.height>e;)this.setFontSize(this.getFontSize()-1)},fitTo:function(e,t){if(this._autoDimensions&&(this.setDimensions(0,0),2048<this.width)){var n=this.getString();cleverapps.ReportStream.debug("Text width > 2048 - "+n+" - "+JSON.stringify((new Error).stack))}cleverapps.UI.ImageFont.prototype.fitTo.apply(this,arguments)},canAttachLastLine:function(){var e=this._renderCmd._strings;return!(!e||e.length<=1)&&(10<=e[e.length-2].length&&e[e.length-1].length<=2)},setDimensions:function(){
var e=cc.configuration.getMaxTextureSize()/cc.view.getDevicePixelRatio();1<arguments.length?arguments[0]>e&&(arguments[0]=e):1===arguments.length&&arguments[0].width&&arguments[0].width>e&&(arguments[0].width=e),this._super.apply(this,arguments),this._autoDimensions=!1},setFontSize:function(e){cleverapps.styles.UI.glyphScale&&-1!==["ja","zh","ko"].indexOf(cleverapps.settings.language)&&(e=Math.round(e*cleverapps.styles.UI.glyphScale.scale)),this._super(e)},setFont:function(e){if(this.___enabled){this.setFontFillColor(e.color||cleverapps.styles.COLORS.WHITE),this.setFontSize(e.size);var t=cleverapps.styles.UI.TTFText,n=t.verticalAlignment;this.safariCheck()&&(n=t.safari.verticalAlignment),void 0!==n&&this.setVerticalAlignment(n),e.shadow?this.enableShadow(e.shadow.color,e.shadow.direction,e.shadow.blur):this.disableShadow(),e.stroke?this.enableStroke(e.stroke.color,e.stroke.size):this.disableStroke(),e.lineHeight&&this.setLineHeight(e.lineHeight);var s=this.getString()
;cc.LabelTTF.prototype.setString.call(this,""),cc.LabelTTF.prototype.setString.call(this,s)}},enableStroke:function(e,t){this._super(e,t);var n=e.a/255;this._strokeOpacity!==n&&(this._strokeOpacity=n,this._renderCmd._setColorsString())},byLetterAnimation:function(e){var s=(e=e||{}).speed||.03,t=e.delay||.1;if(cc.sys.isMobile&&!cc.sys.isNative)return this.setOpacity(0),this.runAction(new cc.Sequence(new cc.DelayTime(t),new cc.FadeIn(.3))),void(e.callback&&e.callback());this._fullString=this.getString();var i=0;this._byLetterAnimationRunning&&this.stopAllActions(),this._byLetterAnimationRunning=!0,this._byLetterAnimationDone=function(){this._byLetterAnimationRunning&&(this.stopAllActions(),this._byLetterAnimationRunning=!1,cc.LabelTTF.prototype.setString.call(this,this._fullString),this._byLetterAnimationDone=void 0,e.callback&&e.callback())}.bind(this),cc.LabelTTF.prototype.setString.call(this,"");var o=void 0,r=function(e){this.runAction(new cc.Sequence(new cc.DelayTime(e),
new cc.CallFunc(function(){var e=0<i?this._fullString[i-1]:void 0;i++;var t=this._fullString[i-1];if(" "===e&&" "!==t){for(var n=i;n<this._fullString.length&&" "!==this._fullString[n];)n++;cc.LabelTTF.prototype.setString.call(this,this._fullString.substr(0,n)),o&&this.height!==o&&(this._fullString=this._fullString.substr(0,i-2)+"\n"+this._fullString.substr(i-1))}cc.LabelTTF.prototype.setString.call(this,this._fullString.substr(0,i)),i<this._fullString.length?(r(s),o=this.height):this._byLetterAnimationDone&&this._byLetterAnimationDone()}.bind(this))))}.bind(this);r(t)},byLetterAnimationFinish:function(){this._byLetterAnimationRunning&&this._byLetterAnimationDone()},countToAnimation:function(e,t){for(var n=e-this.getString(),s=0<n?1:-1,i=t/Math.abs(n),o=[],r=0;r<Math.abs(n);r++)o.push(new cc.Sequence(new cc.CallFunc(function(){this.setString(+this.getString()+s)}.bind(this)),new cc.DelayTime(i)));this.runAction(new cc.Sequence(o))},setString:function(e,t){this.___enabled&&(
e=cleverapps.UI.LabelTTF.GetLocalizedText(e,t),cc.LabelTTF.prototype.setString.call(this,e))},setTextureRect:function(){this._super.apply(this,arguments),this._offsetPosition=cc.p(0,this.getBaseline())},safariCheck:function(){var e=cleverapps.UI.getBrowserName();return"Safari"===e||"Mobile Safari"===e||cc.sys.isWebView&&cc.sys.OS_IOS===cc.sys.os},getBaseline:function(){var e=cleverapps.styles.UI.TTFText,t=e.baseline;return this.safariCheck()&&(t=e.safari.baseline),this.getFontSize()<=40?Math.floor(t*this.getFontSize()/3):t*this.getFontSize()}}),{GetLocalizedText:function(e,t){return"number"==typeof e?e+"":"string"!=typeof e||0!==e.indexOf("messages:")?(e||"")+"":Messages.get(e.substring("messages:".length),t)}}),jumpAnimation:function(e,t,n){var s=(n=n||{}).time||.5,i=n.h||cleverapps.styles.UI.jumpAnimation.h,o=n.parent||cc.director.getRunningScene().scene,r=e.getParent();e.replaceParentSamePlace(o,{keepScale:!0});var a=cc.p(e.x,e.y),c=cc.p(e.x+t.x,e.y+t.y),l=cc.pMidpoint(a,c);l.y+=i
;var p=new cc.BezierTo(s,[a,l,c]).easing(cc.easeIn(1));if(n.spawn||n.sound){var d=[];n.spawn&&d.push(n.spawn),n.sound&&d.push(new cc.Sequence(new cc.DelayTime(void 0===n.soundDelay?.5:n.soundDelay),new cc.CallFunc(cleverapps.audio.playSound.bind(cleverapps.audio,n.sound)))),d.push(p),p=new cc.Spawn(d)}e.runAction(new cc.Sequence(p,new cc.CallFunc(function(){e.replaceParentSamePlace(r),n.callback&&n.callback()})))},collectAnimation:function(e,t,n){n=n||{};var s,i=cc.director.getRunningScene();s=n.parent?n.parent:i,e.replaceParentSamePlace(s,{keepScale:!0});var o,r=e.getPosition(),a=s.convertToNodeSpace(t.parent.convertToWorldSpace(t.getPosition()));if(n.jump)o=cc.p(r.x,a.y);else{var c=cc.pSub(a,r),l=cc.pMult(cc.pNormalize(cc.pPerp(c)),cleverapps.styles.UI.collectAnimation.bezierX),p=cc.pMidpoint(r,a),d=cc.pAdd(p,l),u=cc.pSub(p,l),h=cc.p(i.width/2,i.height/2),g=cc.pDistance(d,h),v=cc.pDistance(u,h);o=cc.pSub(r,cc.pMult(c,.33)),o=g<v?cc.pAdd(o,l):cc.pSub(o,l)}var m=n.time?n.time:.7
;n.speed&&(m=(cc.pDistance(r,o)+cc.pDistance(o,a))/n.speed)<.3&&(m=.3),n.callback&&e.runAction(new cc.Sequence(new cc.DelayTime(m),new cc.CallFunc(n.callback))),e.runAction(new cc.Sequence(new cc.Spawn(new cc.BezierTo(m,[r,o,a]),new cc.ScaleTo(m,n.noScale?e.getScale():1)),new cc.CallFunc(function(){!1!==n.finishRemove&&e.removeFromParent(),n.targetEffect&&(t.stopAllActions(),t.runAction(new cc.Sequence(new cc.ScaleTo(.15,1.1),new cc.ScaleTo(.15,1))))}))),e.setLocalZOrder(10)},jumpCollectAnimation:function(t,n){var e=n.jump,s=n.collect;e.callback=function(){var e=n.delay||.3;s.callback=n.callback,s.jump=!0,t.runAction(new cc.Sequence(new cc.DelayTime(e),new cc.CallFunc(function(){cleverapps.UI.collectAnimation(t,s.target,s)})))},e.time=e.time||.4;var i=t.getScale();t.setScale(.5*i),e.spawn=new cc.ScaleTo(e.time,1.2*i);var o=e.dist||cleverapps.styles.UI.jumpCollectAnimation.dist;cleverapps.UI.jumpAnimation(t,o,e)},animateDelta:function(e,t){if(0!==e){0<e&&(e="+"+e)
;var n=cleverapps.UI.generateImageText(""+e,t.font||cleverapps.styles.FONTS.WHITE_TEXT||cleverapps.styles.FONTS.TEXT);if(t.icon){var s=new cc.Sprite(t.icon);t.iconScale&&s.setScale(t.iconScale),(n=new cleverapps.Layout([n,s],{direction:cleverapps.UI.HORIZONTAL,margin:cleverapps.styles.UI.delta.margin})).setCascadeOpacityEnabled(!0)}t.parent&&t.parent.addChild(n),n.setPositionRound(t),t.zOrder&&n.setLocalZOrder(t.zOrder);var i=cleverapps.styles.UI.delta.y;t.dy&&(i=t.dy),t.delay=t.delay||0;var o=t.duration||2;return n.opacity=0,n.runAction(new cc.Sequence(new cc.DelayTime(t.delay),new cc.CallFunc(function(){n.opacity=255}),new cc.Spawn(new cc.MoveBy(o,cc.p(0,i)),new cc.Sequence(new cc.FadeTo(o,0),new cc.RemoveSelf)))),n}},getFontName:function(e){return void 0===e&&(e=bundles.main.urls.basefont_ttf),cc.sys.isNative&&!cc.sys.isWebView&&cc.sys.os===cc.sys.OS_ANDROID?e.srcs[0]:e.name},generateImageText:function(e,t,n){if(cleverapps.config.debugMode&&!cleverapps.UI.ImageFont.IsApplicable(t,e)
)throw console.log(t),"Not applicable image font: "+e;return e=cleverapps.UI.LabelTTF.GetLocalizedText(e,n),new cleverapps.UI.ImageFont(e,t)},generateOnlyText:function(e,t,n){var s=new cleverapps.UI.LabelTTF("",cleverapps.UI.getFontName(t.font));e=cleverapps.UI.LabelTTF.GetLocalizedText(e,n);var i=cleverapps.UI.getSceneSize();return e.length*t.size*.5>i.width&&(s.setDimensions(i.width,0),s._autoDimensions=!0),s.setString(e),s.setFont(t),s},generateTTFText:function(e,t,n){var s;return cleverapps.UI.ImageFont.IsApplicable(t,e)?s=new cleverapps.UI.ImageFont(e,t):(s=new cleverapps.UI.LabelTTF("",cleverapps.UI.getFontName(t.font)),170<(e=cleverapps.UI.LabelTTF.GetLocalizedText(e,n)).length&&(s.setDimensions(cleverapps.UI.getSceneSize().width,0),s._autoDimensions=!0),s.setString(e),s.setFont(t)),s},CheckBox:cc.Node.extend({ctor:function(e){this._super(),(e=e||{}).styles=e.styles||{},this.options=e,this.onChangeCallback=e.onChange||function(e){};var t=[];this.createCheckBox(),t.push(
this.checkBox),e.label&&(this.createLabel(),t.push(this.label));var n=this.getStyles(),s=new cleverapps.Layout(t,{margin:n.margin,padding:n.padding,direction:void 0!==e.direction?e.direction:cleverapps.UI.HORIZONTAL});this.addChild(s),this.setAnchorPoint2(),this.setContentSize2(s.getContentSize()),s.setPositionRound(this.width/2,this.height/2),cleverapps.UI.applyHover(this)},_onChange:function(e,t){switch(t){case ccui.CheckBox.EVENT_SELECTED:this.onChangeCallback(!0);break;case ccui.CheckBox.EVENT_UNSELECTED:this.onChangeCallback(!1)}cleverapps.audio.playSound(bundles.main.urls.click_effect)},createCheckBox:function(){var e=this.getStyles(),t=this.checkBox=new ccui.CheckBox;t.loadTextureBackGround(this.getSpriteFrameName(e.bgImage),ccui.Widget.PLIST_TEXTURE),t.loadTextureFrontCross(this.getSpriteFrameName(e.checkImage),ccui.Widget.PLIST_TEXTURE),t.addEventListener(this._onChange.bind(this),t),t.setSelected(this.options.isSelected)},createLabel:function(){
this.label=cleverapps.UI.generateTTFText(this.options.label.text,this.options.label.font||cleverapps.styles.FONTS.WINDOW_TEXT),this.options.label.clickable&&cleverapps.UI.onClick(this,function(){this.checkBox.setSelected(!this.checkBox.isSelected()),this._onChange(null,this.checkBox.isSelected()?ccui.CheckBox.EVENT_SELECTED:ccui.CheckBox.EVENT_UNSELECTED)}.bind(this),{noThrottle:!0})},getSpriteFrameName:function(e){return"#"===e[0]?e.substr(1):e},setSelected:function(e){this.checkBox.setSelected(e)},getStyles:function(){return this.styles||(this.styles=cleverapps.overrideStyles(cleverapps.styles.UI.CheckBox,this.options.styles,!0)),this.styles}}),makeHideable:function(e,t){e.hideHandler=new cleverapps.UI.HideHandler(e,t)},wrap:function(e,t){if(0===e.children.length)return e;for(var n,s,i,o,r=0;r<e.children.length;r++){var a=e.children[r],c=a.baseScaleX||a.baseScale||a.scaleX,l=a.baseScaleY||a.baseScale||a.scaleY,p=a.height,d=a.width;t&&(p=a.getBoundingBox().height,d=a.getBoundingBox(
).width,l=c=1);var u=a.y-p*l*a.anchorY,h=u+p*l;(void 0===n||u<n)&&(n=u),(void 0===s||s<h)&&(s=h);var g=a.x-d*c*a.anchorX,v=g+d*c;(void 0===i||g<i)&&(i=g),(void 0===o||o<v)&&(o=v)}return o<0&&(o=0),s<0&&(s=0),0<n&&(n=0),0<i&&(i=0),i=-i,n=-n,e.setContentSize2(i+o,n+s),e.children.forEach(function(e){e.x+=i,e.y+=n}),e.setAnchorPoint2(),e},shake:function(t,e){var n=(e=e||{}).delay||0,s=e.power||1,i=e.vibro;void 0===i&&(i=500);var o=e.strength;o||(o=cleverapps.styles.UI.shake);var r=e.base;r||(r={x:t.x,y:t.y,r:t.rotation});var a=[{x:2,y:1,r:0},{x:-1,y:-2,r:-1},{x:-3,y:0,r:1},{x:0,y:2,r:0},{x:1,y:-1,r:1},{x:0,y:0,r:0}].map(function(e){return new cc.CallFunc(function(){t.setPosition(r.x+e.x*o.dx*s,r.y+e.y*o.dy*s),t.setRotation(r.r+e.r)})}),c=[new cc.DelayTime(n/1e3)];cleverapps.settings.vibro&&i&&c.push(new cc.CallFunc(function(){cc.sys.isNative&&void 0!==cc.Device?cc.Device.vibrate(i/1e3):"undefined"!=typeof navigator&&navigator.vibrate&&navigator.vibrate(i)})),a.forEach(function(e){c.push(e)
,c.push(new cc.DelayTime(.05))}),t.stopAllActions(),t.runAction(new cc.Sequence(c))},wrapWithPadding:function(e,t,n){if(t=t?{left:t.left||t.x||0,right:t.right||t.x||0,top:t.top||t.y||0,bottom:t.bottom||(t.isTop?0:t.y)||0}:{left:0,right:0,top:0,bottom:0},n)return e.children.forEach(function(e){e.x+=t.left,e.y+=t.bottom}),e.width+=t.left+t.right,e.height+=t.top+t.bottom,e;var s=new cc.Node;return s.addChild(e),s.setContentSize2(e.width*e.scaleX+t.left+t.right,e.height*e.scaleY+t.top+t.bottom),s.setAnchorPoint2(),e.setPosition(t.left+e.width*e.scaleX/2,t.bottom+e.height*e.scaleY/2),s},targetContainPoint:function(e,t,n){if(n){if(!cc.rectContainsPoint(cc.rect(0,0,e.width,e.height),t))return!1;if(t.x+=(n.width-e.width)/2,t.x<0||t.x>n.width)return!1;var s=n.width/2,i=n.height/2;t.x>s&&(t.x=n.width-t.x);var o=e.height;return o<n.height&&(o=n.height),t.y>i&&t.y<o-i?!0:(t.y>i&&(t.y=o-t.y),!(t.y<0||t.y>i)&&(s-t.x)*i<t.y*s)}var r=e.clickPosition||{x:0,y:0};return cc.rectContainsPoint(cc.rect(r.x,
r.y,e.width,e.height),t)},onDrag:function(n,s){var i,o=void 0!==(s=s||{}).dragMinDist?s.dragMinDist:cleverapps.styles.UI.DRAG_MIN_DIST,e=cleverapps.UI.DRAG_THROTTLE,r=cleverapps.throttle(e,s.onDragMove?s.onDragMove:function(){}),a=!1,t=!1;return void 0!==s.swallowTouches&&(t=s.swallowTouches),cc.eventManager.addListener({event:cc.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:t,onTouchBegan:function(e){if(!n.isDisplayed())return!1;var t=cleverapps.UI.targetContainPoint(n,n.convertTouchToNodeSpace(e),s.isometricCell);return t&&(i=e.getLocation(),s.onTouchBegan&&s.onTouchBegan()),t},onTouchMoved:function(e){var t=e.getLocation();if(cc.pDistance(t,i)>=o){if(!a){if(s.onDragStart&&!s.onDragStart())return;a=!0}s.followPointer&&n.setPositionRound(n.parent.convertTouchToNodeSpace(e)),r({dx:t.x-i.x,dy:t.y-i.y,touch:e})}},onTouchEnded:function(e){if(a||0===o){a=!1;var t=e.getLocation();s.onDragMove&&s.onDragMove({dx:t.x-i.x,dy:t.y-i.y,touch:e}),s.onDragEnd&&s.onDragEnd({dx:t.x-i.x,dy:t.y-i.y,
touch:e})}}},n)},onTouchBegan:function(n,s,i){i=i||{},s&&!i.noThrottle&&(s=cleverapps.throttle(i.clickThrottle||cleverapps.UI.CLICK_THROTTLE,s));var e=!0;return void 0!==i.swallowTouches&&(e=i.swallowTouches),cc.eventManager.addListener({event:cc.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:e,onTouchBegan:function(e){if(!n.isDisplayed())return!1;var t=n.convertTouchToNodeSpace(e);return!!cleverapps.UI.targetContainPoint(n,t,i.isometricCell)&&(s(t),!0)}},n)},onClick:function(s,n,i){i=i||{},n&&!i.noThrottle&&(n=cleverapps.throttle(i.clickThrottle||cleverapps.UI.CLICK_THROTTLE,n));var o,r,a=i.ignoreOnTouchMoved,c=void 0===i.ignoreOnTouchMovedThreshold?cleverapps.styles.UI.onClick.ignoreOnTouchMovedThreshold:i.ignoreOnTouchMovedThreshold,e=!0;return void 0!==i.swallowTouches&&(e=i.swallowTouches),i.useInteractiveScale&&!s.applyInteractiveScale&&(s.applyInteractiveScale=cleverapps.UI.applyInteractiveScale),cc.eventManager.addListener({event:cc.EventListener.TOUCH_ONE_BY_ONE,
swallowTouches:e,onTouchBegan:function(e){if(!s.isDisplayed())return!1;var t=s.getCropContainer();if(t&&!cc.rectContainsPoint(cc.rect(0,0,t.width,t.height),t.convertTouchToNodeSpace(e)))return!1;var n=cleverapps.UI.targetContainPoint(s,s.convertTouchToNodeSpace(e),i.isometricCell);return n&&(o=e.getLocation(),r=!0,s.onTouchBegan&&s.onTouchBegan(),i.useInteractiveScale&&s.applyInteractiveScale&&(s.isTouchBegan=!0,s.applyInteractiveScale())),n},onTouchMoved:function(e){if(a&&r){var t=o,n=e.getLocation(),s=Math.abs(t.x-n.x)+Math.abs(t.y-n.y);c<s&&(r=!1)}},onTouchEnded:function(e){s.onTouchEnded&&s.onTouchEnded(),i.useInteractiveScale&&s.applyInteractiveScale&&(s.isTouchBegan=!1,s.applyInteractiveScale());var t=s.convertTouchToNodeSpace(e);if(cleverapps.UI.targetContainPoint(s,t,i.isometricCell)&&r)return n(t),!0}},s)},applyHover:function(a,c){a.onMouseOver||(c&&console.log("CREATE ON"),a.onMouseOver=function(){a.applyInteractiveScale(),a.settings&&a.settings.hint&&a.showHint(
a.settings.hint)}),a.onMouseOut||(a.onMouseOut=function(){a.applyInteractiveScale(),a.settings&&a.settings.hint&&a.hideHint()}),a.applyInteractiveScale||(a.applyInteractiveScale=cleverapps.UI.applyInteractiveScale),a.hoverListener=cc.eventManager.addListener({event:cc.EventListener.MOUSE,onMouseMove:function(e){c&&console.log("MOUSE MOVE");var t=e.getLocation(),n=a.getCropContainer(),s=a.convertToNodeSpace(t),i=a.getContentSize(),o=a.hoverPosition||{x:0,y:0},r=cc.rect(o.x,o.y,i.width,i.height);!cc.rectContainsPoint(r,s)||n&&!cc.rectContainsPoint(cc.rect(0,0,n.width,n.height),n.convertToNodeSpace(t))?a.mouseOver&&(a.mouseOver=!1,a.onMouseOut()):a.mouseOver||(a.mouseOver=!0,a.onMouseOver())}},a)},removeHover:function(e){e.hoverListener&&(cc.eventManager.removeListener(e.hoverListener),delete e.hoverListener)},applyInteractiveScale:function(){var e=void 0===this.baseScale?1:this.baseScale;this.selected&&this.selectedScale?this.setScale(e*this.selectedScale
):this.isTouchBegan?this.setScale(.97*e):this.mouseOver?this.setScale(1.03*e):this.setScale(e)},convertToGrayScale:function(e,t){"undefined"!=typeof gl&&(e.spine&&(e=e.spine),t?e.normalShader?e.setShaderProgram(e.normalShader):e.opacity=255:cc.shaderCache&&cleverapps.Shaders&&cc.shaderCache.getProgram(cleverapps.Shaders.GRAYSCALE_SPRITE_KEY)?(e.normalShader||(e.normalShader=e.getShaderProgram()),e.setShaderProgram(cc.shaderCache.getProgram(cleverapps.Shaders.GRAYSCALE_SPRITE_KEY))):e.opacity=150)},_setShaderUpdate:function(e,t,n){if(e._superUpdate)e.update=e._superUpdate.bind(e),delete e._superUpdate,e.normalShader&&e.setShaderProgram(e.normalShader);else if(cc.shaderCache&&cleverapps.Shaders&&cc.shaderCache.getProgram(t)){e.normalShader||(e.normalShader=e.getShaderProgram()),e.setShaderProgram(cc.shaderCache.getProgram(t));var s=e.getShaderProgram();e._superUpdate=e.update,e.scheduleUpdate(),e.update=function(e){n(e,s)}.bind(e)}},toggleFlickering:function(s,e){if(
"undefined"!=typeof gl){var i=(e=e||{}).flickSpeed||2,o=e.flickPause||.2,r=e.color;(!r||!Array.isArray(r)||r.length<3)&&(r=[.35,.35,.35]);var a=0;this._setShaderUpdate(s,cleverapps.Shaders.FLICKER_SHADER_KEY,function(e,t){s._superUpdate(e),t.use(),a+=e;var n=Math.abs(Math.sin(Math.max(a-o,0)*i));n=Math.max(0,Math.min(1,n)),t.setUniformLocationWith1f("sineTime",n),t.setUniformLocationWith3f("flickColor",r[0],r[1],r[2])})}},toggleBlur:function(l,p){if((p=p||{}).animate=p.animate||{},"undefined"!=typeof gl){var n=p.blurLength||.005,d=p.strength||1,u=function(e,t){l.blurShader.use(),l.blurShader.setUniformLocationWith1f("u_blurOffset",n),l.blurShader.setUniformLocationWith1f("u_blurStrength",e),l.blurShader.setUniformLocationWith1f("u_extent",t)},e=function(e,t){t=t||function(){};var n=p.animate.type||cleverapps.UI.BLUR_ANIMATION.FADE,s=p.animate.time||.2,i=p.animate.steps||20,o=e?d:0,r=e?1:0,a=d/i,c=1/i;l.blurAction=l.runAction(new cc.Sequence(new cc.Repeat(new cc.Sequence(
new cc.CallFunc(function(){n===cleverapps.UI.BLUR_ANIMATION.FADE?u(o+=e?-a:a,1):u(d,r+=e?-c:c)}),new cc.DelayTime(s/i)),i),new cc.CallFunc(t))),l.blurAction.whenDone=t};if(l.blurAction&&!l.blurAction.isDone()&&(l.stopAction(l.blurAction),l.blurAction.whenDone(),delete l.blurAction),l.normalShader){var t=function(){l.setShaderProgram(l.normalShader),delete l.normalShader,delete l.blurShader};p.animate?e(!0,function(){t(),p.animate.callback&&p.animate.callback()}):t()}else if(cc.shaderCache&&cleverapps.Shaders){var s=cleverapps.Shaders.BLUR_FADE_KEY;p.animate.type===cleverapps.UI.BLUR_ANIMATION.CURTAIN&&(s=p.animate.reverseCurtain?cleverapps.Shaders.BLUR_CURTAIN_REVERSE_KEY:cleverapps.Shaders.BLUR_CURTAIN_KEY),cc.shaderCache.getProgram(s)&&(l.normalShader=l.getShaderProgram(),l.setShaderProgram(cc.shaderCache.getProgram(s)),l.blurShader=l.getShaderProgram(),p.animate?e(!1,p.animate.callback):u(d,1))}}else p.animate&&p.animate.callback&&p.animate.callback()},getSceneSize:function(){
var e=cc.director.getWinSize();return e.height=cleverapps.styles.SCENE_HEIGHT,e},getSceneOffsetY:function(){var e=cc.director.getRunningScene(),t=1;return e&&e.scene&&(t=e.scene.resizeScale),(cc.director.getWinSize().height-cleverapps.styles.SCENE_HEIGHT*t)/2/t},createPatternSprite:function(e,t){void 0===t&&(t=cc.director.getWinSize());var n=new cc.Sprite(e);if("auto"===t.width&&(t.width=n.width-2),"auto"===t.height&&(t.height=n.height-2),"undefined"!=typeof gl&&n.getTexture()){n.getTexture().setTexParameters({minFilter:gl.NEAREST,magFilter:gl.NEAREST,wrapS:gl.REPEAT,wrapT:gl.REPEAT});var s=n.getTextureRect();s.width=t.width,s.height=t.height,n.setTextureRect(s)}else t.width&&t.height&&n.setScale(t.width/n.width,t.height/n.height);return n.setPositionRound(t.width/2,t.height/2),n},createSprite:function(e){if(!e)return new cc.Sprite;var t=e&&e.image||e;if(t=processVirtualImage(t),void 0!==e.scale9&&!1!==e.scale9){var n,s,i=cleverapps.UI.createScale9Sprite(t,e.scale9);e.sizes?(
n=e.sizes[cleverapps.wideMode.mode].width,s=e.sizes[cleverapps.wideMode.mode].height):(n=e.width,s=e.height);var o=e.rotation;if(e.rotations&&(o=e.rotations[cleverapps.wideMode.mode]),o){var r=s;s=n,n=r,i.setRotation(o)}return i.setContentSize2(n,s),i}var a=t;return(t=new cc.Sprite(t)).scale=e.scale||1,t.spriteFrameName=a,t},getScale9Rect:function(e,t){void 0===t&&(t=cleverapps.UI.Scale9Rect.Default);var n=(e instanceof cc.SpriteFrame?e:cc.spriteFrameCache.getSpriteFrame(e)).getOriginalSize(),s=t===cleverapps.UI.Scale9Rect.TwoPixelXY,i=Math.round(s?n.width/2-1:n.width/3),o=Math.round(s?2:n.width/3),r=t===cleverapps.UI.Scale9Rect.TwoPixelY||t===cleverapps.UI.Scale9Rect.TwoPixelXY,a=Math.round(r?n.height/2-1:n.height/3),c=Math.round(r?2:n.height/3);return cc.rect(i,a,o,c)},createScale9Sprite:function(e,t){if(!(e instanceof cc.SpriteFrame?e:cc.spriteFrameCache.getSpriteFrame(e))){if(cleverapps.config.debugMode)throw"No scale9 sprite: "+e;return new cc.Scale9Sprite}
var n=new cc.Scale9Sprite(e,cleverapps.UI.getScale9Rect(e,t));return n.spriteFrameName=e,n},createAnimation:function(e){e=e.spine;var t=new cleverapps.Spine(e.json);return t.setAnimation(0,e.openAnimation,!1),e.idleAnimation&&t.setCompleteListener(function(){t.setAnimation(0,e.idleAnimation,!0)}),t},getBrowserName:function(){return cleverapps.UI.browserName?cleverapps.UI.browserName:cleverapps.UI.browserName=(new UAParser).getBrowser().name}},cc.LabelTTF.RenderCmd.prototype._setColorsString=function(){var e=this._displayedColor,t=this._node,n=t._shadowColor||this._displayedColor,s=t._strokeColor,i=t._textFillColor,o=e.r/255,r=e.g/255,a=e.b/255;this._shadowColorStr="rgba("+(0|o*n.r)+","+(0|r*n.g)+","+(0|a*n.b)+","+t._shadowOpacity+")",this._fillColorStr="rgba("+(0|o*i.r)+","+(0|r*i.g)+","+(0|a*i.b)+", 1)",this._strokeColorStr="rgba("+(0|o*s.r)+","+(0|r*s.g)+","+(0|a*s.b)+","+t._strokeOpacity+")"},
cc.LabelTTF.WebGLRenderCmd.prototype._setColorsString=cc.LabelTTF.RenderCmd.prototype._setColorsString,cc.LabelTTF.CacheRenderCmd.prototype._setColorsString=cc.LabelTTF.RenderCmd.prototype._setColorsString,cc.LabelTTF.CanvasRenderCmd.prototype._setColorsString=cc.LabelTTF.RenderCmd.prototype._setColorsString,cleverapps.styles.UI={DRAG_MIN_DIST:5,jumpAnimation:{h:200},jumpCollectAnimation:{dist:{x:100,y:-100}},collectAnimation:{bezierX:700},delta:{y:20,icon:{margin:5}},Avatar:{x:8,top:8,bottom:8},onClick:{ignoreOnTouchMovedThreshold:30},shake:{dx:1,dy:1},TTFText:{verticalAlignment:void 0,baseline:0,safari:{verticalAlignment:void 0,baseline:0}},CheckBox:{checkImage:bundles.main.frames.goal_done_sign,bgImage:bundles.main.frames.select_friend_checkbox,margin:10}},cleverapps.UI.Scale9Rect={Default:0,TwoPixelX:1,TwoPixelY:2,TwoPixelXY:3},cleverapps.UI.DRAG_THROTTLE=50,cleverapps.UI.CLICK_THROTTLE=500,cleverapps.UI.SOCIAL_CLICK_THROTTLE=cleverapps.UI.CLICK_THROTTLE,
cleverapps.UI.BLUR_ANIMATION={FADE:1,CURTAIN:2},cc.PlaySound=cc.ActionInstant.extend({sound:void 0,ctor:function(e,t){cc.FiniteTimeAction.prototype.ctor.call(this),this.sound=e,this.options=t},update:function(e){cleverapps.audio.playSound(this.sound,this.options)},reverse:function(){return this},clone:function(){return new cc.PlaySound(this.sound,this.options)}}),cleverapps.UI.ScrollBarContainer=cc.Node.extend({}),cleverapps.UI.ScrollView=ccui.Layout.extend({ctor:function(e,t){switch(this.options=t||{},this.dir=cleverapps.UI.ScrollView.DIR_NONE,this.options.childrenVisibility=void 0===this.options.childrenVisibility?cleverapps.UI.ScrollView.CHILDREN_VISIBILITY_FULLCHECK:this.options.childrenVisibility,this.options.childrenVisibilityPadding=this.options.childrenVisibilityPadding||0,this.options.childrenVisibility){case cleverapps.UI.ScrollView.CHILDREN_VISIBILITY_LINEAR:this.childrenVisibility=new ScrollChildrenLinearVisibility(this);break
;case cleverapps.UI.ScrollView.CHILDREN_VISIBILITY_FULLCHECK:this.childrenVisibility=new ScrollChildrenFullCheckVisibility(this)}this._super(),(void 0===this.options.clipping||this.options.clipping)&&this.setClippingEnabled(!0),this.setAnchorPoint2(),this.centerNode=new cc.Node,this.addChild(this.centerNode),!1!==this.options.scrollBarEnabled&&(this.barContainer=new cleverapps.UI.ScrollBarContainer,this.addChild(this.barContainer,2),this.barContainer.setCascadeOpacityEnabled(!0),this.barContainer.setOpacity(0),this.barContainer.runAction(new cc.Sequence(new cc.DelayTime(.3),new cc.FadeTo(.3,255))),this.barHandler=new ScrollBarHandler(this)),this.zoom=1,this.options.zoom&&(this.zoomHandler=new cleverapps.UI.ZoomHandler(this)),this.scrollHandler=new cleverapps.UI.ScrollHandler(this,{mouseScroll:!this.options.zoom,outOfBoundaryScale:this.options.outOfBoundaryScale,inertialScrollFactor:this.options.inertialScrollFactor}),e&&this.setInnerContent(e),this.scheduleUpdate()},isEmpty:function(){
return!this.innerContent||!this.innerContent.children.length},setContentSize:function(e,t){var n=this.width,s=this.height,i=this.innerContent&&this.innerContent.getPosition();this._super(e,t),n===this.width&&s===this.height||(this.barContainer&&this.barContainer.setContentSize(this.getContentSize()),this.centerNode&&this.centerNode.setPosition(this.width/2,this.height/2),this.innerContent&&(this.calcBorders(),this.scrollToPoint(cc.p(-i.x,-i.y))))},updateVisibility:function(){if(this.innerContent.setVisibleRect&&this.innerContent.setVisibleRect(this.getVisibleRect()),this.childrenVisibility&&this.currentVisibleChildIds&&!this.isEmpty()&&this.width+this.height!==0){var e,t=this.childrenVisibility.visibleIds(),n=this.innerContent.children;for(e=0;e<this.currentVisibleChildIds.length;e++)n[this.currentVisibleChildIds[e]].hideDirty=!0;for(e=0;e<t.length;e++){(s=n[t[e]]).hideDirty&&delete s.hideDirty,s.visible=!0}for(e=0;e<this.currentVisibleChildIds.length;e++){var s;(
s=n[this.currentVisibleChildIds[e]]).hideDirty&&(delete s.hideDirty,s.visible=!1)}this.currentVisibleChildIds=t}},getVisibleRect:function(){return cc.rect(Math.round(this.innerContent.width/2-this.width/this.zoom/2-this.innerContent.x),Math.round(this.innerContent.height/2-this.height/this.zoom/2-this.innerContent.y),Math.round(this.width/this.zoom),Math.round(this.height/this.zoom))},isVisiblePoint:function(e){var t=this.getVisibleRect();return cc.rectContainsPoint(t,e)},calcBorders:function(){if(this.isEmpty())return this.min=cc.p(0,0),void(this.max=cc.p(0,0));this.min=cc.p(-this.innerContent.width/2+this.width/this.zoom/2,-this.innerContent.height/2+this.height/this.zoom/2),0<this.min.x&&(this.min.x=0),0<this.min.y&&(this.min.y=0),this.max=cc.p(this.innerContent.width/2-this.width/this.zoom/2,this.innerContent.height/2-this.height/this.zoom/2),this.max.x<0&&(this.max.x=0),this.max.y<0&&(this.max.y=0),this.setDirection(),this.barHandler&&this.barHandler.reset()},
setInnerContent:function(e){this.innerContent&&this.innerContent.removeFromParent(),this.innerContent=e,this.innerContent.setAnchorPoint2(),this.innerContent.setPositionRound(0,0),this.centerNode.addChild(e),this.width&&this.height?(this.updateInnerContent(),this.scrollToDefault()):this.initChildrenVisibility()},scrollToDefault:function(){this.innerContent&&this.scrollTo(cleverapps.UI.ScrollView.SCROLLS.UPPER_LEFT)},initChildrenVisibility:function(){if(this.childrenVisibility){this.currentVisibleChildIds=[];for(var e=0;e<this.innerContent.children.length;e++)this.currentVisibleChildIds.push(e)}},updateInnerContent:function(){this.calcBorders(),this.initChildrenVisibility(),this.scrollToPoint(this.normalizePoint(this.getContainerPosition()))},borderTouchScrollIteration:function(e,t,n){n*=.01;var s=this.width/this.zoom/2*n,i=this.height/this.zoom/2*n;t/=this.zoom;var o=this.centerNode.convertTouchToNodeSpace(e),r=0,a=0,c=this.getContainerPosition();o.x<-s&&(
r=c.x-t>=this.min.x?-t:this.min.x-c.x),o.x>s&&(r=c.x+t<=this.max.x?t:this.max.x-c.x),o.y<-i&&(a=c.y-t>=this.min.y?-t:this.min.y-c.y),o.y>i&&(a=c.y+t<=this.max.y?t:this.max.y-c.y),(r||a)&&this.scrollToPoint(cc.p(c.x+r,c.y+a))},calcNodeDelta:function(e,t){t=cleverapps.extend({left:1,right:1,top:1,bottom:1},t);var n=e.getBoundingBox(),s=cc.p(n.x,n.y),i=cc.p(n.x+n.width,n.y+n.height);s=this.centerNode.convertToNodeSpace(e.getParent().convertToWorldSpace(s)),i=this.centerNode.convertToNodeSpace(e.getParent().convertToWorldSpace(i));var o=cc.p(-this.width/this.zoom/2*t.left,-this.height/this.zoom/2*t.bottom),r=cc.p(this.width/this.zoom/2*t.right,this.height/this.zoom/2*t.top),a=cc.p(0,0);return s.x<o.x&&(a.x=-(o.x-s.x)),i.x>r.x&&(a.x=i.x-r.x),s.y<o.y&&(a.y=-(o.y-s.y)),i.y>r.y&&(a.y=i.y-r.y),a},isNodeVisible:function(e,t){var n=this.calcNodeDelta(e,t);return 0===n.x&&0===n.y},scrollToMakeNodeVisible:function(e,t,n,s){var i=this.calcNodeDelta(e,n);this.scrollHandler.startAutoScroll(i,t,s)},
scrollTo:function(e,t,n){var s=(n=n||{}).callback;if(void 0!==e){switch(e){case cleverapps.UI.ScrollView.SCROLLS.UPPER_LEFT:e=cc.p(this.min.x,this.max.y);break;case cleverapps.UI.ScrollView.SCROLLS.CENTER:e=cc.p(0,0);break;case cleverapps.UI.ScrollView.SCROLLS.LOWER_RIGHT:e=cc.p(this.max.x,this.min.y);break;default:e instanceof cc.Node&&(e=this.innerContent.convertToNodeSpace(e.getParent().convertToWorldSpace(e.getPosition()))),e.x-=this.innerContent.width/2,e.y-=this.innerContent.height/2}e=this.normalizePoint(e),t?this.scrollHandler.startAutoScroll(cc.pSub(e,this.getContainerPosition()),t,n):(this.scrollToPoint(e),s&&s())}else s&&s()},scrollBy:function(e,t,n){var s=cc.pAdd(e,this.getContainerPosition());s.x+=this.innerContent.width/2,s.y+=this.innerContent.height/2,this.scrollTo(s,t,n)},zoomTo:function(e,t){this.zoomHandler.zoomTo(e,t)},update:function(e){this._super(e),this.scrollHandler.processAutoScroll(e),this.zoomHandler&&this.zoomHandler.processZoom(e)},
getCurScrollPercent:function(){if(!this.innerContent)return{x:0,y:0};var e=this.max.x-this.min.x,t=this.max.y-this.min.y;return{x:0!==e?(this.innerContent.x-this.min.x)/e*100:0,y:0!==t?(this.innerContent.y-this.min.y)/t*100:0}},normalizePoint:function(e){return{x:Math.max(this.min.x,Math.min(this.max.x,e.x)),y:Math.max(this.min.y,Math.min(this.max.y,e.y))}},getContainerPosition:function(){return cc.p(-this.innerContent.x,-this.innerContent.y)},getCurrentPosition:function(){var e=this.innerContent.getPosition();return{x:-e.x+this.innerContent.width/2,y:-e.y+this.innerContent.height/2}},scrollToPoint:function(e){this.innerContent.setPosition(-e.x,-e.y),this.updateVisibility(),this.barHandler&&this.barHandler.updatePos(),this.options.containerMovedListener&&this.options.containerMovedListener()},scrollToPercent:function(e,t){var n;if(e=Math.min(100,Math.max(0,e)),this.dir&cleverapps.UI.ScrollView.DIR_VERTICAL){var s=(this.max.y-this.min.y)*e/100+this.min.y;n=cc.p(this.innerContent.x,s)
}else{var i=(this.max.x-this.min.x)*e/100+this.min.x;n=cc.p(i,this.innerContent.y)}t?this.scrollHandler.startAutoScroll(cc.pSub(n,this.getContainerPosition()),t):this.scrollToPoint(n)},stopAutoScroll:function(){this.scrollHandler.stopAutoScroll()},setDirection:function(){this.options.direction?this.dir=this.options.direction:(this.dir=cleverapps.UI.ScrollView.DIR_BOTH,this.min.y===this.max.y&&(this.dir^=cleverapps.UI.ScrollView.DIR_VERTICAL),this.min.x===this.max.x&&(this.dir^=cleverapps.UI.ScrollView.DIR_HORIZONTAL))},getInnerContainer:function(){return this.innerContent},setBarPadding:function(e){this.barHandler&&this.barHandler.setPadding(e)}}),cleverapps.UI.ScrollView.SCROLLS={UPPER_LEFT:0,CENTER:1,LOWER_RIGHT:2},cleverapps.UI.ScrollView.DIR_NONE=0,cleverapps.UI.ScrollView.DIR_VERTICAL=1,cleverapps.UI.ScrollView.DIR_HORIZONTAL=2,cleverapps.UI.ScrollView.DIR_BOTH=cleverapps.UI.ScrollView.DIR_VERTICAL|cleverapps.UI.ScrollView.DIR_HORIZONTAL,
cleverapps.UI.ScrollView.CHILDREN_VISIBILITY_NONE=0,cleverapps.UI.ScrollView.CHILDREN_VISIBILITY_LINEAR=1,cleverapps.UI.ScrollView.CHILDREN_VISIBILITY_FULLCHECK=2;var ScrollBarHandler=function(e){this.scroll=e};ScrollBarHandler.prototype.reset=function(){!this.barY&&this.scroll.dir&cleverapps.UI.ScrollView.DIR_VERTICAL&&this.scroll.min.y!==this.scroll.max.y&&(this.barY=new ScrollBar(this.scroll,cleverapps.UI.ScrollView.DIR_VERTICAL)),!this.barX&&this.scroll.dir&cleverapps.UI.ScrollView.DIR_HORIZONTAL&&this.scroll.min.x!==this.scroll.max.x&&(this.barX=new ScrollBar(this.scroll,cleverapps.UI.ScrollView.DIR_HORIZONTAL)),this.barX&&this.barX.reset(),this.barY&&this.barY.reset(),this.updatePos()},ScrollBarHandler.prototype.setAutoHide=function(e){this.barX&&(this.barX.autoHideEnabled=e),this.barY&&(this.barY.autoHideEnabled=e)},ScrollBarHandler.prototype.setPadding=function(e){this.barPadding=e,this.barX&&this.barX.setPadding(this.barPadding),this.barY&&this.barY.setPadding(this.barPadding)
},ScrollBarHandler.prototype.updatePos=function(){var e=this.scroll.scrollHandler.getHowMuchOutOfBoundary();this.barY&&this.barY.onScrolled(e),this.barX&&this.barX.onScrolled(e)},ScrollBarHandler.prototype.onTouchBegan=function(){this.barY&&this.barY.onTouchBegan(),this.barX&&this.barX.onTouchBegan()},ScrollBarHandler.prototype.onTouchEnded=function(){this.barY&&this.barY.onTouchEnded(),this.barX&&this.barX.onTouchEnded()};var ScrollBar=ccui.ScrollViewBar.extend({ctor:function(e,t){this.scroll=e,this.dir=t,this._super(e,t),e.barContainer.addChild(this),this.autoHideEnabled=!1,this.setPadding(this.scroll.barHandler.barPadding),this.addControls(),this.setWidth(cleverapps.styles.ScrollBar.barWidth)},setPadding:function(e){e=e||{};var t=cleverapps.styles.ScrollBar,n=void 0!==e.cornerPadding?e.cornerPadding:t.cornerPadding,s=void 0!==e.sidePadding?e.sidePadding:t.sidePadding,i=cc.p(this.dir===cleverapps.UI.ScrollView.DIR_VERTICAL?s:n,this.dir===cleverapps.UI.ScrollView.DIR_VERTICAL?n:s)
;this.setPositionFromCorner(i),this.onScrolled(this.scroll.scrollHandler.getHowMuchOutOfBoundary())},reset:function(){this.scroll.dir&this.dir?this.setVisible(!0):this.setVisible(!1)},onScrolled:function(e){this._autoHideEnabled&&(this._autoHideRemainingTime=this.autoHideTime,cc.ProtectedNode.prototype.setOpacity.call(this,this.opacity));var t=this.scroll.getInnerContainer(),n=0,s=0,i=0,o=0;this._direction===cleverapps.UI.ScrollView.DIR_VERTICAL?(n=t.height,s=this.scroll.height,i=e.y,o=-t.getPositionY()+(this.scroll.max.y-this.scroll.min.y)/2):this._direction===cleverapps.UI.ScrollView.DIR_HORIZONTAL&&(n=t.width,s=this.scroll.width,i=e.x,o=-t.getPositionX()+(this.scroll.max.x-this.scroll.min.x)/2);var r=this._calculateLength(n,s,i),a=this._calculatePosition(n,s,o,i,r);this._updateLength(r),this.setPosition(a)},getActualContentSize:function(){return{width:this._body.getBoundingBox().width,height:this._body.getBoundingBox().height}},addControls:function(){cc.eventManager.addListener({
event:cc.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:!0,onTouchBegan:this.onBarTouchBegan.bind(this),onTouchMoved:this.onBarTouchMoved.bind(this),onTouchEnded:this.onBarTouchEnded.bind(this),onTouchCancelled:this.onTouchEnded.bind(this)},this)},onBarTouchBegan:function(e){if(!this.visible)return!1;var t=this.convertTouchToNodeSpace(e),n=this.getActualContentSize();return cc.rectContainsPoint(cc.rect(-n.width/2,0,n.width,n.height),t)?(this.scroll.scrollHandler.stopAutoScroll(),!0):void 0},onBarTouchMoved:function(e){var t=this.convertToNodeSpace(e.getLocation()),n=this.convertToNodeSpace(e.getPreviousLocation()),s=cc.pSub(t,n),i=this.getPosToPercent(s);this.scroll.scrollToPercent(i)},getPosToPercent:function(e){if(this.dir===cleverapps.UI.ScrollView.DIR_VERTICAL){var t=this.scroll.height-2*this.getPositionFromCorner().y-this.getActualContentSize().height;return(this.y+e.y-this.getPositionFromCorner().y)/t*100}t=this.scroll.width-2*this.getPositionFromCorner(
).x-this.getActualContentSize().height;return(this.x+e.y-this.getPositionFromCorner().x)/t*100},onBarTouchEnded:function(e){}});cleverapps.styles.ScrollBar={barWidth:12,cornerPadding:20,sidePadding:20};var ScrollChildrenLinearVisibility=function(e){this.scroll=e};ScrollChildrenLinearVisibility.prototype.visibleIds=function(){var e,t;if(this.scroll.innerContent.children.length<=1)e=0,t=this.scroll.innerContent.children.length;else{var n,s,i=this.scroll.innerContent.children.length-1,o=this.scroll.innerContent.children[0].getPosition(),r=this.scroll.innerContent.children[i].getPosition();r.x-=o.x,r.x/=i,r.y-=o.y,r.y/=i,0!==r.y?(n=r.y,s=this.scroll.innerContent.children[0].height/2,e=(-this.scroll.innerContent.y-o.y+this.scroll.innerContent.height/2-this.scroll.height/2)/n,t=(this.scroll.height+2*s)/n):(n=r.x,s=this.scroll.innerContent.children[0].width/2,e=(-this.scroll.innerContent.x-o.x+this.scroll.innerContent.width/2-this.scroll.width/2)/n,t=(this.scroll.width+2*s)/n),t<0&&(e-=t=-t),
e=Math.ceil(e-s/Math.abs(n)),t=Math.floor(t+2*s/Math.abs(n))}for(var a=[],c=0;c<t;c++)this.scroll.innerContent.children[e+c]&&a.push(e+c);return a};var ScrollChildrenFullCheckVisibility=function(e){this.scroll=e};ScrollChildrenFullCheckVisibility.prototype.visibleIds=function(){for(var e=[],t=this.scroll.zoom,n=this.scroll.options.childrenVisibilityPadding||0,s=0;s<this.scroll.innerContent.children.length;s++){var i=this.scroll.innerContent.children[s],o=i.x-this.scroll.innerContent.width/2,r=i.y-this.scroll.innerContent.height/2;-this.scroll.innerContent.x-this.scroll.width/t/2-i.width/2-n<=o&&o<=-this.scroll.innerContent.x+this.scroll.width/t/2+i.width/2+n&&-this.scroll.innerContent.y-this.scroll.height/t/2-i.height/2-n<=r&&r<=-this.scroll.innerContent.y+this.scroll.height/t/2+i.height/2+n&&e.push(s)}return e},cleverapps.UI.HideHandler=function(e,t){switch(this.target=e,this.initialized=!1,this.direction=t||cleverapps.UI.HORIZONTAL,this.isShow=!0,this.paused=!1,e.hide||(
e.hide=e.createListener(this.hide.bind(this))),e.show||(e.show=e.createListener(this.show.bind(this))),e.isShown=e.createListener(function(){return this.isShow}.bind(this)),this.direction){case cleverapps.UI.SCALE_ANIMATION:e.hideAnimation||(e.hideAnimation=e.createListener(this.scaleHideAnimation.bind(this))),e.showAnimation||(e.showAnimation=e.createListener(this.scaleShowAnimation.bind(this)));break;case cleverapps.UI.OPACITY_ANIMATION:e.hideAnimation||(e.hideAnimation=e.createListener(this.opacityHideAnimation.bind(this))),e.showAnimation||(e.showAnimation=e.createListener(this.opacityShowAnimation.bind(this)));break;default:e.hideAnimation||(e.hideAnimation=e.createListener(this.hideAnimation.bind(this))),e.showAnimation||(e.showAnimation=e.createListener(this.showAnimation.bind(this)))}e.showForDuration=e.createListener(this.showForDuration.bind(this)),e.toggle=e.createListener(this.toggle.bind(this)),e.pauseHideHandler=e.createListener(this.pauseHideHandler.bind(this)),
e.resumeHideHandler=e.createListener(this.resumeHideHandler.bind(this)),e.parent&&this.initialize()},cleverapps.UI.HideHandler.prototype.pauseHideHandler=function(){this.paused=!0},cleverapps.UI.HideHandler.prototype.resumeHideHandler=function(){this.paused=!1},cleverapps.UI.HideHandler.prototype.toggle=function(e,t){e?this.show(t):this.hide(t)},cleverapps.UI.HideHandler.prototype.showForDuration=function(e,t){t=t||{};this.clearTimeouts(),this.show(),this.callbackTimeout=setTimeout(function(){e&&e()},500),this.hideTimeout=setTimeout(function(){this.hide(),this.clearTimeouts()}.bind(this),2e3)},cleverapps.UI.HideHandler.prototype.postponeHiding=function(e){this.hideTimeout&&(clearTimeout(this.hideTimeout),this.hideTimeout=setTimeout(function(){this.hide(),this.clearTimeouts()}.bind(this),e))},cleverapps.UI.HideHandler.prototype.clearTimeouts=function(){this.callbackTimeout&&(clearTimeout(this.callbackTimeout),delete this.callbackTimeout),this.hideTimeout&&(clearTimeout(this.hideTimeout)
,delete this.hideTimeout)},cleverapps.UI.HideHandler.prototype.showAnimation=function(e,t,n){if(n=n||{},this.target.stopAllActions(),e)return this.target.setPosition(this.originalPosition),void(this.target.visible=!0);var s=new cc.MoveTo(n.duration||.3,this.originalPosition);n.easing&&s.easing(new cc.easeBackOut),this.target.visible=!0,this.target.runAction(new cc.Sequence(new cc.DelayTime(t||0),s))},cleverapps.UI.HideHandler.prototype.hideAnimation=function(e,t,n){if(n=n||{},this.target.stopAllActions(),e)return this.target.setPosition(this.hidePosition),void(this.target.visible=!1);var s=new cc.MoveTo(n.duration||.15,this.hidePosition);n.easing&&s.easing(new cc.easeBackIn),this.target.runAction(new cc.Sequence(new cc.DelayTime(t||0),s,new cc.CallFunc(function(){this.target.visible=!1}.bind(this))))},cleverapps.UI.HideHandler.prototype.opacityShowAnimation=function(e,t){this.target.stopAllActions();var n=this.target.baseOpacity||255;if(e)return this.target.visible=!0,
void this.target.setOpacity(n);this.target.visible=!0,this.target.runAction(new cc.Sequence(new cc.DelayTime(t||0),new cc.FadeTo(.3,n)))},cleverapps.UI.HideHandler.prototype.opacityHideAnimation=function(e,t){if(this.target.stopAllActions(),e)return this.target.setOpacity(0),void(this.target.visible=!1);this.target.runAction(new cc.Sequence(new cc.DelayTime(t||0),new cc.FadeTo(.15,0),new cc.CallFunc(function(){this.target.visible=!1}.bind(this))))},cleverapps.UI.HideHandler.prototype.scaleShowAnimation=function(e,t){this.target.stopAllActions();var n=this.target.baseScale||1;if(e)return this.target.visible=!0,void this.target.setScale(n);this.target.visible=!0,this.target.runAction(new cc.Sequence(new cc.DelayTime(t||0),new cc.ScaleTo(.3,n)))},cleverapps.UI.HideHandler.prototype.scaleHideAnimation=function(e,t){if(this.target.stopAllActions(),e)return this.target.setScale(0),void(this.target.visible=!1);this.target.runAction(new cc.Sequence(new cc.DelayTime(t||0),new cc.ScaleTo(.15,0),
new cc.CallFunc(function(){this.target.visible=!1}.bind(this))))},cleverapps.UI.HideHandler.prototype.show=function(e,t,n){(!0!==this.isShow||e)&&(this.isShow=!0,this.initialized&&!this.paused&&(this.clearTimeouts(),this.target.showAnimation(e,t,n)))},cleverapps.UI.HideHandler.prototype.hide=function(e,t,n){(!1!==this.isShow||e)&&(this.isShow=!1,this.initialized&&!this.paused&&this.target.hideAnimation(e,t,n))},cleverapps.UI.HideHandler.prototype.initialize=function(){if(!this.initialized){if(this.initialized=!0,this.target.originalPosition?this.originalPosition=this.target.originalPosition:this.originalPosition=this.target.getPosition(),this.target.hidePosition)this.hidePosition=this.target.calculatePositionRound(this.target.hidePosition);else{var e,t=this.target.getParent().convertToWorldSpace(this.originalPosition),n=cc.director.getWinSize();this.direction===cleverapps.UI.VERTICAL?(e=t.y>n.height/2?n.height-t.y:-t.y,this.hidePosition=cc.p(this.originalPosition.x,
this.originalPosition.y+2*e)):(e=t.x>n.width/2?n.width-t.x:-t.x,this.hidePosition=cc.p(this.originalPosition.x+2*e,this.originalPosition.y))}this.paused||(!1===this.isShow?this.target.hideAnimation(!0):this.target.showAnimation(!0))}},cleverapps.UI.ScrollHandler=function(e,t){t=t||{},this.target=e,this.bounceEnabled=!0,this.outOfBoundaryScale=t.outOfBoundaryScale||.5,this.inertialScrollFactor=t.inertialScrollFactor||1,this.initAutoScrollParams(),!1!==t.mouseScroll&&this.enableMouseWheelScroll(),this.enableTouchScroll()},cleverapps.UI.ScrollHandler.prototype.enableMouseWheelScroll=function(){"mouse"in cc.sys.capabilities&&cc.eventManager.addListener({event:cc.EventListener.MOUSE,onMouseScroll:function(e){this.target.isDisplayed()&&cc.rectContainsPoint(cc.rect(0,0,this.target.width,this.target.height),this.target.convertToNodeSpace(e.getLocation()))&&(this.handleMouseWheel(e.getScrollY()),e.stopPropagation())}.bind(this)},this.target)},
cleverapps.UI.ScrollHandler.prototype.handleMouseWheel=function(e){if(0!=(this.target.dir&cleverapps.UI.ScrollView.DIR_VERTICAL)){var t=this.getHowMuchOutOfBoundary();!this.fltEqualZero(t)&&(t.y<0&&0<e||0<t.y&&e<0)||this.lastMouseWheelTime&&this.lastMouseWheelTime>Date.now()-100||((!this.mouseWheelSpeed||this.lastMouseWheelTime<Date.now()-500||e*this.mouseWheelSpeed<0)&&(this.mouseWheelSpeed=0),Math.abs(e)<65&&this.lastMouseWheelTime&&this.lastMouseWheelTime>Date.now()-2e3||(this.mouseWheelSpeed+=cleverapps.styles.ScrollHandler.mouseWheelAcceleration*Math.sign(e),Math.abs(this.mouseWheelSpeed)>cleverapps.styles.ScrollHandler.mouseWheelMaxSpeed&&(this.mouseWheelSpeed=Math.sign(this.mouseWheelSpeed)*cleverapps.styles.ScrollHandler.mouseWheelMaxSpeed),Math.abs(this.mouseWheelSpeed)<cleverapps.styles.ScrollHandler.mouseWheelMinSpeed&&(this.mouseWheelSpeed=Math.sign(this.mouseWheelSpeed)*cleverapps.styles.ScrollHandler.mouseWheelMinSpeed),this.startInertialScroll(cc.p(0,this.mouseWheelSpeed
)),this.lastMouseWheelTime=Date.now()))}},cleverapps.UI.ScrollHandler.prototype.enableTouchScroll=function(){var e=cc.eventManager.addListener({event:cc.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:!1,onTouchBegan:this.onTouchBegan.bind(this),onTouchMoved:this.onTouchMoved.bind(this),onTouchEnded:this.onTouchEnded.bind(this),onTouchCancelled:this.onTouchEnded.bind(this)},this.target);this.target.scrollListener=e},cleverapps.UI.ScrollHandler.prototype.onTouchBegan=function(e){if(!this.target.touchScrollDisabled&&this.target.isDisplayed()&&cc.rectContainsPoint(cc.rect(0,0,this.target.width,this.target.height),this.target.convertTouchToNodeSpace(e)))return this.handlePress(),!0},cleverapps.UI.ScrollHandler.prototype.onTouchMoved=function(e){this.handleMove(this.getTouchDelta(e))},cleverapps.UI.ScrollHandler.prototype.onTouchEnded=function(e){this.handleRelease(this.getTouchDelta(e,!0))},cleverapps.UI.ScrollHandler.prototype.getTouchDelta=function(e,t){
var n=this.target.convertToNodeSpace(e.getLocation()),s=this.target.convertToNodeSpace(e.getPreviousLocation());t&&!cc.rectContainsPoint(cc.rect(0,0,this.target.width,this.target.height),n)&&(n=s);var i=cc.pMult(cc.pSub(s,n),1/this.target.zoom);return 0==(this.target.dir&cleverapps.UI.ScrollView.DIR_HORIZONTAL)&&(i.x=0),0==(this.target.dir&cleverapps.UI.ScrollView.DIR_VERTICAL)&&(i.y=0),i},cleverapps.UI.ScrollHandler.prototype.initAutoScrollParams=function(){this._outOfBoundaryAmountDirty=!0,this._outOfBoundaryAmount=cc.p(0,0)},cleverapps.UI.ScrollHandler.prototype.afterContainerScale=function(){this._outOfBoundaryAmountDirty=!0;var e=this.getHowMuchOutOfBoundary();this.fltEqualZero(e)||this.startAutoScroll(e,0)},cleverapps.UI.ScrollHandler.prototype.afterContainerMove=function(){this._outOfBoundaryAmountDirty=!0,this.target.barHandler&&this.target.barHandler.updatePos(),!this.bounceEnabled||this.inTouch||this._autoScrolling||this.startBounceBackIfNeeded()},
cleverapps.UI.ScrollHandler.prototype.startBounceBackIfNeeded=function(){if(!this.bounceEnabled)return!1;var e=this.getHowMuchOutOfBoundary();if(this.fltEqualZero(e))return!1;return this.startAutoScroll(e,1),!0},cleverapps.UI.ScrollHandler.prototype.handlePress=function(){this.inTouch=!0,this.stopAutoScroll(),this._touchMovePreviousTimestamp=(new Date).getTime(),this._touchMoveDisplacements=[],this._touchMoveTimeDeltas=[],this.target.barHandler&&this.target.barHandler.onTouchBegan()},cleverapps.UI.ScrollHandler.prototype.handleMove=function(e){if(this.bounceEnabled){var t=this.getHowMuchOutOfBoundary(e);e.x*=0===t.x?1:this.outOfBoundaryScale,e.y*=0===t.y?1:this.outOfBoundaryScale}else{t=this.getHowMuchOutOfBoundary(e);e.x+=t.x,e.y+=t.y}this.gatherMoveData(e);var n=cc.pAdd(this.target.getContainerPosition(),e);this.moveContainer(n)},cleverapps.UI.ScrollHandler.prototype.gatherMoveData=function(e){for(;5<=this._touchMoveDisplacements.length;)this._touchMoveDisplacements.splice(0,1),
this._touchMoveTimeDeltas.splice(0,1);this._touchMoveDisplacements.push(e);var t=(new Date).getTime();this._touchMoveTimeDeltas.push((t-this._touchMovePreviousTimestamp)/1e3),this._touchMovePreviousTimestamp=t},cleverapps.UI.ScrollHandler.prototype.handleRelease=function(e){if(this.inTouch=!1,this.gatherMoveData(e),!this.startBounceBackIfNeeded()){var t=this.calcTouchVelocity();0===t.x&&0===t.y||this.startInertialScroll(t)}this.target.barHandler&&this.target.barHandler.onTouchEnded()},cleverapps.UI.ScrollHandler.prototype.calcAutoScrollPercentage=function(){var e=Math.min(1,this._autoScrollAccumulatedTime/this._autoScrollTotalTime);return this._autoScrollEasing?e=this._autoScrollEasing.easing(e):this._autoScrollAttenuate&&(e=(e-=1)*e*e*e*e+1),e},cleverapps.UI.ScrollHandler.prototype.processAutoScroll=function(e){if(this._autoScrolling&&!this.inTouch){var t=1,n=this.calcAutoScrollPercentage();0<=n&&n<=1&&this.isNecessaryAutoScrollBrake()&&(t=.05),this._autoScrollAccumulatedTime+=e*(1/t)
,n=this.calcAutoScrollPercentage(),Math.abs(n-1)<=1e-4&&(n=1,this.stopAutoScroll());var s=cc.pAdd(this._autoScrollStartPosition,cc.pMult(this._autoScrollTargetDelta,n));s=cc.pAdd(this._autoScrollBrakingStartPosition,cc.pMult(cc.pSub(s,this._autoScrollBrakingStartPosition),t)),this.moveContainer(s)}},cleverapps.UI.ScrollHandler.prototype.moveContainer=function(e){this.target.scrollToPoint(e),this.afterContainerMove()},cleverapps.UI.ScrollHandler.prototype.isOutOfBoundary=function(){var e=this.getHowMuchOutOfBoundary();return!this.fltEqualZero(e)},cleverapps.UI.ScrollHandler.prototype.calcTouchVelocity=function(){var e=this._touchMoveTimeDeltas.reduce(function(e,t){return e+t},0);if(0===e||.5<=e)return cc.p(0,0);var t=cc.p(0,0);return this._touchMoveDisplacements.forEach(function(e){t.x+=e.x,t.y+=e.y}),cc.pMult(t,1/e)},cleverapps.UI.ScrollHandler.prototype.isNecessaryAutoScrollBrake=function(){if(this._autoScrollBraking)return!0;if(this.isOutOfBoundary()){if(
!this._autoScrollCurrentlyOutOfBoundary)return this._autoScrollCurrentlyOutOfBoundary=!0,this._autoScrollBraking=!0,this._autoScrollBrakingStartPosition=this.target.getContainerPosition(),!0}else this._autoScrollCurrentlyOutOfBoundary=!1;return!1},cleverapps.UI.ScrollHandler.prototype.startInertialScroll=function(e){var t=.7*this.inertialScrollFactor,n=cc.pMult(e,t),s=this.calculateAutoScrollTimeByInitialSpeed(cc.pLength(e));this.startAutoScroll(n,s)},cleverapps.UI.ScrollHandler.prototype.calculateAutoScrollTimeByInitialSpeed=function(e){return Math.sqrt(Math.sqrt(e/5))*this.inertialScrollFactor},cleverapps.UI.ScrollHandler.prototype.fltEqualZero=function(e){return Math.abs(e.x)<=1e-4&&Math.abs(e.y)<=1e-4},cleverapps.UI.ScrollHandler.prototype.startAutoScroll=function(e,t,n){n=n||{},this._autoScrolling=!0,this._autoScrollTargetDelta=e,this._autoScrollAttenuate=!0,this._autoScrollStartPosition=this.target.getContainerPosition(),this._autoScrollTotalTime=t,
this._autoScrollAccumulatedTime=0,this._autoScrollBraking=!1,this._autoScrollBrakingStartPosition=cc.p(0,0),this._autoScrollCallback=n.callback,this._autoScrollEasing=n.easing;var s=this.getHowMuchOutOfBoundary();if(!this.fltEqualZero(s)){this._autoScrollCurrentlyOutOfBoundary=!0;var i=this.getHowMuchOutOfBoundary(e);(0<s.x*i.x||0<s.y*i.y)&&(this._autoScrollBraking=!0,this._autoScrollBrakingStartPosition=this.target.getContainerPosition())}},cleverapps.UI.ScrollHandler.prototype.stopAutoScroll=function(){this._autoScrolling=!1,this._autoScrollCallback&&(this._autoScrollCallback(),delete this._autoScrollCallback)},cleverapps.UI.ScrollHandler.prototype.getHowMuchOutOfBoundary=function(e){if(void 0===e&&(e=cc.p(0,0)),0===e.x&&0===e.y&&!this._outOfBoundaryAmountDirty)return this._outOfBoundaryAmount;var t=cc.p(0,0),n=this.target.getContainerPosition();return n.x+e.x>this.target.max.x?t.x=this.target.max.x-(n.x+e.x):n.x+e.x<this.target.min.x&&(t.x=this.target.min.x-(n.x+e.x)),
n.y+e.y<this.target.min.y?t.y=this.target.min.y-(n.y+e.y):n.y+e.y>this.target.max.y&&(t.y=this.target.max.y-(n.y+e.y)),0===e.x&&0===e.y&&(this._outOfBoundaryAmount=t,this._outOfBoundaryAmountDirty=!1),t},cleverapps.styles.ScrollHandler={mouseWheelAcceleration:200,mouseWheelMinSpeed:500,mouseWheelMaxSpeed:2e3},cleverapps.UI.MapScrollHandler=function(e,t){t=t||{},this.target=e,this.bounceEnabled=!1,this.initAutoScrollParams()},cleverapps.UI.MapScrollHandler.prototype.initAutoScrollParams=function(){this._outOfBoundaryAmountDirty=!0,this._outOfBoundaryAmount=cc.p(0,0)},cleverapps.UI.MapScrollHandler.prototype.afterContainerMove=function(){this._outOfBoundaryAmountDirty=!0},cleverapps.UI.MapScrollHandler.prototype.handlePress=function(){this._autoScrolling=!1,this._touchMovePreviousTimestamp=(new Date).getTime(),this._touchMoveDisplacements=[],this._touchMoveTimeDeltas=[]},cleverapps.UI.MapScrollHandler.prototype.gatherMoveData=function(e){var t=this.getHowMuchOutOfBoundary(e);for(e.x+=t.x
,e.y+=t.y;5<=this._touchMoveDisplacements.length;)this._touchMoveDisplacements.splice(0,1),this._touchMoveTimeDeltas.splice(0,1);this._touchMoveDisplacements.push(e);var n=(new Date).getTime();this._touchMoveTimeDeltas.push((n-this._touchMovePreviousTimestamp)/1e3),this._touchMovePreviousTimestamp=n},cleverapps.UI.MapScrollHandler.prototype.handleRelease=function(e){this.gatherMoveData(e);var t=this.calcTouchVelocity();0===t.x&&0===t.y||this.startInertialScroll(t)},cleverapps.UI.MapScrollHandler.prototype.processAutoScroll=function(e){if(this._autoScrolling){var t=this.isNecessaryAutoScrollBrake()?.05:1;this._autoScrollAccumulatedTime+=e*(1/t);var n=Math.min(1,this._autoScrollAccumulatedTime/this._autoScrollTotalTime);this._autoScrollAttenuate&&(n=(n-=1)*n*n*n*n+1);var s=cc.pAdd(this._autoScrollStartPosition,cc.pMult(this._autoScrollTargetDelta,n)),i=Math.abs(n-1)<=1e-4,o=cc.pSub(s,this.target.getContainerPosition()),r=this.getHowMuchOutOfBoundary(o);this.fltEqualZero(r)||(s.x+=r.x,
s.y+=r.y,i=!0),i&&(this._autoScrolling=!1),this.target.moveContainer(cc.pSub(s,this.target.getContainerPosition()))}},cleverapps.UI.MapScrollHandler.prototype.isOutOfBoundary=function(){var e=this.getHowMuchOutOfBoundary();return!this.fltEqualZero(e)},cleverapps.UI.MapScrollHandler.prototype.calcTouchVelocity=function(){var e=this._touchMoveTimeDeltas.reduce(function(e,t){return e+t},0);if(0===e||e>=this._touchTotalTimeThreshold)return cc.p(0,0);var t=cc.p(0,0);return this._touchMoveDisplacements.forEach(function(e){t.x+=e.x,t.y+=e.y}),cc.pMult(t,1/e)},cleverapps.UI.MapScrollHandler.prototype.isNecessaryAutoScrollBrake=function(){if(this._autoScrollBraking)return!0;if(this.isOutOfBoundary()){if(!this._autoScrollCurrentlyOutOfBoundary)return this._autoScrollCurrentlyOutOfBoundary=!0,this._autoScrollBraking=!0,this._autoScrollBrakingStartPosition=this.getContainerPosition(),!0}else this._autoScrollCurrentlyOutOfBoundary=!1;return!1},
cleverapps.UI.MapScrollHandler.prototype.startInertialScroll=function(e){var t=cc.pMult(e,.7),n=this.calculateAutoScrollTimeByInitialSpeed(cc.pLength(e));this.startAutoScroll(t,n,!0)},cleverapps.UI.MapScrollHandler.prototype.calculateAutoScrollTimeByInitialSpeed=function(e){return Math.sqrt(Math.sqrt(e/5))},cleverapps.UI.MapScrollHandler.prototype.fltEqualZero=function(e){return Math.abs(e.x)<=1e-4&&Math.abs(e.y)<=1e-4},cleverapps.UI.MapScrollHandler.prototype.startAutoScroll=function(e,t){this._autoScrolling=!0,this._autoScrollTargetDelta=e,this._autoScrollAttenuate=!0,this._autoScrollStartPosition=this.target.getContainerPosition(),this._autoScrollTotalTime=t,this._autoScrollAccumulatedTime=0,this._autoScrollBraking=!1,this._autoScrollBrakingStartPosition=cc.p(0,0);var n=this.getHowMuchOutOfBoundary();if(!this.fltEqualZero(n)){this._autoScrollCurrentlyOutOfBoundary=!0;var s=this.getHowMuchOutOfBoundary(e);(0<n.x*s.x||0<n.y*s.y)&&(this._autoScrollBraking=!0)}},
cleverapps.UI.MapScrollHandler.prototype.stopAutoScroll=function(){this._autoScrolling=!1},cleverapps.UI.MapScrollHandler.prototype.getHowMuchOutOfBoundary=function(e){if(void 0===e&&(e=cc.p(0,0)),0===e.x&&0===e.y&&!this._outOfBoundaryAmountDirty)return this._outOfBoundaryAmount;var t=cc.p(0,0),n=this.target.container.getBoundingBox();return 0<n.x+e.x?t.x=-(n.x+e.x):n.width+n.x+e.x<this.target.width&&(t.x=this.target.width-(n.width+n.x+e.x)),n.height+n.y+e.y<this.target.height?t.y=this.target.height-(n.height+n.y+e.y):0<n.y+e.y&&(t.y=-(n.y+e.y)),0===e.x&&0===e.y&&(this._outOfBoundaryAmount=t,this._outOfBoundaryAmountDirty=!1),t},cleverapps.UI.Button=cc.Node.extend({ctor:function(r){this._super(),this.setAnchorPoint2(),(this.settings=r).styles&&(r.width=r.width||r.styles.width,r.height=r.height||r.styles.height,r.padding=r.padding||r.styles.padding),r.button_images&&(this.settings.button_png=this.settings.button_png||r.button_images.button_png,
this.settings.button_on_png=this.settings.button_on_png||r.button_images.button_on_png,this.settings.button_off_png=this.settings.button_off_png||r.button_images.button_off_png);var e=cleverapps.styles.UI.Button;this.bright=!0,this.createBackground(),r.disabled&&this.disable();var a=r.contentOffset&&void 0!==r.contentOffset.x?r.contentOffset.x:e.contentOffset.x,c=r.contentOffset&&void 0!==r.contentOffset.y?r.contentOffset.y:e.contentOffset.y,l=void 0!==r.contentPadding?r.contentPadding:e.contentPadding;if(r.content)["content","contentOff"].forEach(function(e,t){if(r[e]){if(r.padding&&void 0!==r.padding.left&&void 0!==r.padding.bottom){var n=cc.rect(r.padding.left,r.padding.bottom,r.width-r.padding.left-r.padding.right,r.height-r.padding.bottom-r.padding.top);r[e].setAnchorPoint2(),r[e].setPositionRound(n.x+n.width/2,n.y+n.height/2),cleverapps.UI.fitToBox(r[e],{width:n.width,height:n.height})}else{r[e].setPositionRound(this.width/2+a,this.height/2+c),r[e].setAnchorPoint2();var s=r[e],
i=.8*this.width-l;if(!1!==r.fitTo)if(s.fitTo)s.fitTo(i);else{var o=i/s.width;o<1&&s.setScale(o)}}this[e]=r[e],this.addChild(this[e]),0<t&&this[e].setVisible(!1)}},this);else if(r.text){var t=this.text=cleverapps.UI.generateTTFText(r.text,r.font||cleverapps.styles.FONTS.BUTTON_TEXT),n=t.width;r.padding&&r.padding.x&&(n+=2*r.padding.x),n>r.maxWidth&&(n=r.maxWidth),n>this.width&&this.resize(n,this.height);var s=Math.min(n,.8*this.width);r.padding&&r.padding.x&&(s-=2*r.padding.x);var i=this.height;r.padding&&r.padding.y&&(i-=2*r.padding.y),t.fitTo(s,i),t.setPositionRound(this.width/2+a,this.height/2+c),this.addChild(t)}if(r.onMouseOver&&(this.onMouseOver=r.onMouseOver),r.onMouseOut&&(this.onMouseOut=r.onMouseOut),cleverapps.UI.applyHover(this),cleverapps.UI.onClick(this,this.action.bind(this),{clickThrottle:r.clickThrottle,noThrottle:r.noThrottle,swallowTouches:r.swallowTouches,ignoreOnTouchMoved:r.ignoreOnTouchMoved,useInteractiveScale:r.useInteractiveScale}),r.mark){
var o=this.mark=new cc.Sprite(e.mark.icon);o.setAnchorPoint2(),o.setPositionRound(e.mark),this.addChild(o),o.runAction(new cc.RepeatForever(new cc.Sequence(new cc.ScaleTo(.3,1.1),new cc.ScaleTo(.3,1))))}},showAlert:function(){!this.disabled&&this.settings.spine&&this.settings.button_alert_animation&&(this.alert=!0,this.background.setAnimation(0,this.settings.button_alert_animation,!0))},hideAlert:function(){this.settings.spine&&(this.alert=!1,this._innerUpdateBgContent())},setMarkVisible:function(e){this.mark&&this.mark.setVisible(e)},showHint:function(e){setTimeout(function(){!this.disabled&&this.isDisplayed()&&!this.hint&&this.mouseOver&&(this.hint=new cleverapps.UI.Tooltip(this.background,{text:e,size:cleverapps.styles.UI.Button.tooltipSize,position:this.settings.hintPosition||cleverapps.styles.UI.Tooltip.LOCATION.above}),this.addChild(this.hint),this.hint.setPositionRound(this.settings.hintPosition||cleverapps.styles.UI.Tooltip.LOCATION.above),this.hint.replaceParentSamePlace(
cc.director.getRunningScene()))}.bind(this),1e3)},hideHint:function(){this.hint&&(this.hint.removeFromParent(),this.hint=void 0)},createBackground:function(){if(this.settings.noBg)this.setContentSize2(this.settings.width,this.settings.height);else{var e,t;if(this.settings.spine)e=this.settings.width,t=this.settings.height,this.background=new cleverapps.Spine(this.settings.spine),this.settings.skin&&this.background.setSkin(this.settings.skin),this.background.setAnimation(0,this.settings.button_animation,!0);else{var n=function(e){var t=new cc.Sprite(e).getSpriteFrame();return t.spriteFrameName=e,t};this.button_png=n(this.settings.button_png||bundles.buttons.frames.window_button_png),this.button_on_png=n(this.settings.button_on_png||bundles.buttons.frames.window_button_on_png),this.button_off_png=n(this.settings.button_off_png||bundles.buttons.frames.window_button_disabled_png),this.background=cleverapps.UI.createScale9Sprite(this.button_png.spriteFrameName,this.settings.scale9Rect),
e=this.settings.width||this.background.width,t=this.settings.height||this.background.height}this.addChild(this.background),this.resize(e,t)}},setBackgroundImage:function(e){this.button_png=new cc.Sprite(e).getSpriteFrame(),this.button_png.spriteFrameName=e,this._innerUpdateBgContent()},setBackgroundImagePressed:function(e){this.button_on_png=new cc.Sprite(e).getSpriteFrame(),this.button_on_png.spriteFrameName=e,this._innerUpdateBgContent()},resize:function(e,t){var n=cleverapps.styles.UI.Button;if(this.setContentSize2(e,t),!this.settings.spine){if(n.scaleYOnly&&!1!==this.settings.scale){var s=t/this.background.height;s<1&&(s=1),this.background.width=e/s,this.background.setScale(s)}else this.background.setContentSize2(e,t);this.settings.mirrorX&&this.background.setScaleX(-this.background.scaleX)}this.background.setPositionRound(this.width/2,this.height/2)},onTouchBegan:function(){this.disabled||(this.settings.spine?this.settings.button_on_animation&&this.background.setAnimation(0,
this.settings.button_on_animation,!0):this.background&&this.background.setSpriteFrame(this.button_on_png))},onTouchEnded:function(){this.disabled||this._innerUpdateBgContent()},action:function(){this.disabled||this._isAncestorsVisible(this)&&(cleverapps.audio.playSound(this.settings.click_effect||bundles.main.urls.click_effect),this.settings.onClicked())},setBright:function(e){this.bright=e,this._innerUpdateBgContent()},disable:function(){this.disabled||(this.disabled=!0,this._innerUpdateBgContent(),this.tmpOnMouseOver=this.onMouseOver,this.onMouseOver=function(){},this.tmpOnMouseOut=this.onMouseOut,this.onMouseOut=function(){})},enable:function(){this.disabled&&(this.disabled=!1,this._innerUpdateBgContent(),this.tmpOnMouseOver&&(this.onMouseOver=this.tmpOnMouseOver,this.tmpOnMouseOver=void 0),this.tmpOnMouseOut&&(this.onMouseOut=this.tmpOnMouseOut,this.tmpOnMouseOut=void 0))},setLoadingState:function(e){this.settings.loadingImg&&this.parent&&this.loadingState!==e&&(this.loadingState=e
,this.loading&&!this.loadingState?(this.loading.runAction(new cc.RemoveSelf),delete this.loading,this.setVisible(!0)):this.loadingState&&(this.setVisible(!1),this.loading=new cc.Sprite(this.settings.loadingImg),this.parent.addChild(this.loading),this.loading.setAnchorPoint(this.getAnchorPoint()),cleverapps.UI.fitToBox(this.loading,this.getContentSize()),this.loading.runAction(new cc.RepeatForever(new cc.RotateBy(5,360))),this.loading.setPositionRound(this.getPosition())))},_innerUpdateBgContent:function(){var e=this.bright&&!this.disabled;this.settings.spine?this.alert?this.background.setAnimation(0,this.settings.button_alert_animation,!0):this.background.setAnimation(0,this.settings.button_off_animation&&!e?this.settings.button_off_animation:this.settings.button_animation,!0):(this.background&&this.background.setSpriteFrame(e?this.button_png:this.button_off_png),this.content&&this.contentOff&&(e?(this.content.setVisible(!0),this.contentOff.setVisible(!1)):(this.content.setVisible(!1),
this.contentOff.setVisible(!0))))},_isAncestorsVisible:function(e){if(null==e)return!0;var t=e.getParent();return!(t&&!t.isVisible())&&this._isAncestorsVisible(t)}}),cleverapps.styles.UI.Button={contentPadding:15,contentOffset:{x:0,y:0},tooltipSize:{width:180,height:80},mark:{icon:bundles.toolbar.frames.toolbar_attention_icon_png,x:{align:"right",dx:10},y:{align:"center"}}},cleverapps.UI.Button.Images={},cleverapps.UI.StateButton=cc.Node.extend({ctor:function(e){this._super(),this.buttonLabelStyles=[cleverapps.styles.FONTS.SWITCH_BUTTON_OFF,cleverapps.styles.FONTS.SWITCH_BUTTON_ON];var t=new cc.Sprite(bundles.switch_state_button.frames.switch_state_button),n=new cc.Sprite(bundles.switch_state_button.frames.switch_state_2_button||bundles.switch_state_button.frames.switch_state_button);bundles.switch_state_button.frames.switch_state_2_button||(n.setScaleX(-1),this.buttonLabelStyles.reverse()),this.setContentSize2(t.width,t.height),this.setAnchorPoint2(),this.onClick=e.onClick,
this.fitTo=(e.fitTo||.4)*this.width,this.state=0,this.states=[t,n],n.visible=!1,this.states.forEach(function(e){e.setPosition(this.width/2,this.height/2),this.addChild(e)},this);var i=cleverapps.styles.UI.StateButton;this.labels=[e.off,e.on].map(function(e,t){var n=new cleverapps.UI.generateTTFText(e,this.buttonLabelStyles[t]);n.setPositionRound(0===t?i.offText:i.onText),n.fitTo(this.fitTo);var s=new cc.Node;return s.setContentSize2(this.width/2,this.height),s.setAnchorPoint2(),s.setPosition(0===t?this.width/4:this.width/4*3,this.height/2),this.addChild(s),s.addChild(n),n},this),cleverapps.UI.applyHover(this),cleverapps.UI.onClick(this,this.action.bind(this))},setState:function(e){this.state!==e&&(this.states[this.state].visible=!1,this.labels[this.state].setFont(this.buttonLabelStyles[1]),this.labels[this.state].fitTo(this.fitTo),this.state=e,this.states[this.state].visible=!0,this.labels[this.state].setFont(this.buttonLabelStyles[0]),this.labels[this.state].fitTo(this.fitTo))},
action:function(){cleverapps.audio.playSound(bundles.main.urls.click_effect),this.setState(0===this.state?1:0),this.onClick(this.state)}}),cleverapps.overrideColors(cleverapps.styles.COLORS,{COLOR_SWITCH_BUTTON_OFF:new cc.Color(85,93,70,255)}),cleverapps.styles.FONTS=cleverapps.overrideFonts(cleverapps.styles.FONTS,{SWITCH_BUTTON_ON:{size:38,color:cleverapps.styles.COLORS.WHITE},SWITCH_BUTTON_OFF:{size:24,color:cleverapps.styles.COLORS.COLOR_SWITCH_BUTTON_OFF}}),cleverapps.styles.UI.StateButton={onText:{x:{align:"center",dx:-8},y:{align:"center",dy:0}},offText:{x:{align:"center",dx:8},y:{align:"center",dy:0}}},cleverapps.Layout=cc.Node.extend({ctor:function(e,t){this._super(),this.options=t,e.forEach(function(e){e&&this.addChild(t.each?e.applyStyles(t.each):e)},this),this.reshape()},reshape:function(){return cleverapps.UI.arrangeWithMargins(this.children,this.options),cleverapps.UI.wrap(this,this.options),this.options.padding&&cleverapps.UI.wrapWithPadding(this,this.options.padding,!0)
,this}}),cleverapps.Layout.AsyncChild=cc.Node.extend({ctor:function(){this._super(),this.setAnchorPoint2()}}),cleverapps.Layout.AsyncChild.prototype.reshape=function(e){this.setContentSize2(e.width*e.scaleX,e.height*e.scaleY),this.addChild(e),e.setPositionRound(this.width/2,this.height/2),this.alignment&&this.setPositionRound(this.alignment),this.parent&&this.parent.reshape&&this.parent.reshape()},cleverapps.GridLayout=cc.Node.extend({ctor:function(e,t){this._super(),this.options=t||{};for(var n=0;n<e.length;++n){var s=e[n];this.addChild(s)}this.reshape()},reshape:function(){var n=this.options;n.padding=n.padding||{},n.margin=n.margin||{},n.align=n.align||{},n.separator=n.separator||{},n={columns:n.columns||1,direction:n.direction||cleverapps.GridLayout.TOP_TO_BOTTOM,margin:{x:n.margin.x||0,y:n.margin.y||0},padding:{left:n.padding.left||n.padding.x||0,right:n.padding.right||n.padding.x||0,top:n.padding.top||n.padding.y||0,bottom:n.padding.bottom||n.padding.y||0},align:{
x:n.align.x||cleverapps.GridLayout.ALIGN_CENTER,y:n.align.y||cleverapps.GridLayout.ALIGN_CENTER},cell:n.cell&&{width:n.cell.width||0,height:n.cell.height||0},separator:{vertical:n.separator.vertical,horizontal:n.separator.horizontal}};for(var e=this.children.filter(function(e){return!e.separator||(e.removeFromParent(),!1)}),t=[],s=0;s<e.length;s+=n.columns)t.push(e.slice(s,s+n.columns));n.direction&cleverapps.GridLayout.REVERSED&&t.reverse();var i=[],o=[];if(n.cell){for(s=0;s<t.length;++s)o[s]=n.cell.height;for(s=0;s<n.columns;++s)i[s]=n.cell.width}else for(s=0;s<t.length;++s)for(var r=0,a=t[s];r<a.length;++r){var c=a[r];i[r]=Math.max(c.width*c.scaleX,i[r]||0),o[s]=Math.max(c.height*c.scaleY,o[s]||0)}var l,p=n.padding.bottom;for(s=0;s<t.length;++s){for(l=n.padding.left,r=0,a=t[s];r<a.length;++r){c=a[r];var d={},u={};switch(n.align.x){case cleverapps.GridLayout.ALIGN_START:d.x=0,u.x=l;break;case cleverapps.GridLayout.ALIGN_END:d.x=1,u.x=l+i[r];break;default:d.x=.5,u.x=l+i[r]/2}switch(
n.align.y){case cleverapps.GridLayout.ALIGN_START:d.y=0,u.y=p;break;case cleverapps.GridLayout.ALIGN_END:d.y=1,u.y=p+o[s];break;default:d.y=.5,u.y=p+o[s]/2}c.setAnchorPoint2(d.x,d.y),c.setPositionRound(u.x,u.y),n.separator.horizontal&&r!==a.length-1&&this.addSeparator(n.separator.horizontal,l+i[r],p,n.margin.x,o[s]),n.separator.vertical&&s!==t.length-1&&this.addSeparator(n.separator.horizontal,l,p+o[s],i[r],n.margin.y),l+=i[r]+n.margin.x}p+=o[s]+n.margin.y}l=i.reduce(function(e,t){return e+t+n.margin.x},0)+n.padding.left+n.padding.right-n.margin.x,p+=n.padding.top-n.margin.y,this.setContentSize2(l,p)},addSeparator:function(e,t,n,s,i){var o=new cc.Sprite(e.image);o.setAnchorPoint2(),o.setPositionRound(t+(e.x?o.calculateCoordinate(e.x,"x",s):s/2),n+(e.y?o.calculateCoordinate(e.y,"y",i):i/2)),o.separator=!0,this.addChild(o)}}),cleverapps.GridLayout.REVERSED=256,cleverapps.GridLayout.BOTTOM_TO_TOP=1,cleverapps.GridLayout.TOP_TO_BOTTOM=257,cleverapps.GridLayout.ALIGN_CENTER=0,
cleverapps.GridLayout.ALIGN_START=1,cleverapps.GridLayout.ALIGN_END=2,cleverapps.Shaders={GRAYSCALE_SPRITE_KEY:"grayscaleSprite",FLICKER_SHADER_KEY:"flicker",BLUR_FADE_KEY:"blur_fade",BLUR_CURTAIN_KEY:"blur_curtain",BLUR_CURTAIN_REVERSE_KEY:"blur_curtain_reverse",VERTEX_SRC:"  attribute vec4 a_position; \nattribute vec2 a_texCoord; \nattribute vec4 a_color;  \nvarying lowp vec4 v_fragmentColor; \nvarying mediump vec2 v_texCoord; \nvoid main() \n{ \n    gl_Position = CC_PMatrix * a_position;  \n    v_fragmentColor = a_color; \n    v_texCoord = a_texCoord; \n}",GRAYSCALE_SRC:"varying vec2 v_texCoord;\nvarying vec4 v_fragmentColor; \nvoid main(){vec4 col = texture2D(CC_Texture0, v_texCoord);\nfloat gray = dot(col.rgb, vec3(0.25, 0.25, 0.25));\ngl_FragColor = v_fragmentColor * vec4(gray, gray, gray, col.a);\n}\n",
FLICKER_FRAGM:"precision lowp float;\nvarying vec4 v_fragmentColor; \nvarying vec2 v_texCoord; \nuniform float sineTime; \nuniform vec3 flickColor; \nvoid main() \n{ \n    vec4 c = texture2D(CC_Texture0, v_texCoord); \n    vec3 deltacolor = c.rgb * flickColor * sineTime;\n    vec3 color = clamp(c.rgb + deltacolor, 0.0, 1.0);\n    gl_FragColor = v_fragmentColor * vec4(color, c.a); \n}",
BLUR_TEMPLATE:"precision lowp float;\nvarying vec4 v_fragmentColor;\nvarying vec2 v_texCoord;\nuniform float u_blurOffset;\nuniform float u_extent;\nuniform float u_blurStrength;\n#define MAX_BLUR_WIDTH 4\nbool skipPixel(float y)\n{\n   %{skipFunction}}\nvoid main()\n{\n    vec2 u_blurOffset1 = vec2(0.0, float(u_blurOffset));\n    vec2 u_blurOffset2 = vec2(float(u_blurOffset), 0.0);\n    vec2 u_blurOffset3 = vec2(float(u_blurOffset) * sqrt(2.0), float(u_blurOffset) * sqrt(2.0));\n    vec2 u_blurOffset4 = vec2(float(u_blurOffset) * sqrt(2.0), -float(u_blurOffset) * sqrt(2.0));\n    vec4 color = texture2D(CC_Texture0, v_texCoord);\n    if (skipPixel(v_texCoord.y)) {\n       gl_FragColor = color;\n    } else {\n       float blurWidth = u_blurStrength * float(MAX_BLUR_WIDTH);\n       vec4 blurColor  = vec4(color.rgb, 1.0);\n       for (int i = 1; i < MAX_BLUR_WIDTH; ++ i)\n       {\n           if ( float(i) >= blurWidth ) break;           float weight = 1.0 - float(i) / blurWidth;\n           weight = weight * weight * (3.0 - 2.0 * weight); // smoothstep\n           vec4 sampleColor1 = texture2D(CC_Texture0, v_texCoord + u_blurOffset1 * float(i));\n           vec4 sampleColor2 = texture2D(CC_Texture0, v_texCoord - u_blurOffset1 * float(i));\n           vec4 sampleColor3 = texture2D(CC_Texture0, v_texCoord + u_blurOffset2 * float(i));\n           vec4 sampleColor4 = texture2D(CC_Texture0, v_texCoord - u_blurOffset2 * float(i));\n           vec4 sampleColor5 = texture2D(CC_Texture0, v_texCoord + u_blurOffset3 * float(i));\n           vec4 sampleColor6 = texture2D(CC_Texture0, v_texCoord - u_blurOffset3 * float(i));\n           vec4 sampleColor7 = texture2D(CC_Texture0, v_texCoord + u_blurOffset4 * float(i));\n           vec4 sampleColor8 = texture2D(CC_Texture0, v_texCoord - u_blurOffset4 * float(i));\n           blurColor += vec4(sampleColor1.rgb + sampleColor2.rgb + sampleColor3.rgb + sampleColor4.rgb + sampleColor5.rgb + sampleColor6.rgb + sampleColor7.rgb + sampleColor8.rgb, 8.0) * weight; \n       }\n       gl_FragColor = vec4(blurColor.rgb / blurColor.w, color.a);\n    }\n}",
BLUR_FADE_FRAGM:"",BLUR_CURTAIN_FRAGM:"",BLUR_CURTAIN_REVERSE_FRAGM:"",BLUR_FADE_SKIP:"   return false;\n",BLUR_CURTAIN_SKIP:"   return y > u_extent;\n",BLUR_CURTAIN_REVERSE_SKIP:"   return y < (1. - u_extent);\n",initialize:function(){if("undefined"!=typeof gl){var e=function(t,e,n){try{var s=new cc.GLProgram;s.initWithString(e,n),s.addAttribute(cc.ATTRIBUTE_NAME_POSITION,cc.VERTEX_ATTRIB_POSITION),s.addAttribute(cc.ATTRIBUTE_NAME_TEX_COORD,cc.VERTEX_ATTRIB_TEX_COORDS),s.addAttribute(cc.ATTRIBUTE_NAME_COLOR,cc.VERTEX_ATTRIB_COLOR),s.link(),s.updateUniforms(),cc.shaderCache.addProgram(s,t)}catch(e){cleverapps.Shaders[t]=void 0,console.log(e)}};e(cleverapps.Shaders.GRAYSCALE_SPRITE_KEY,cleverapps.Shaders.VERTEX_SRC,cleverapps.Shaders.GRAYSCALE_SRC),e(cleverapps.Shaders.FLICKER_SHADER_KEY,cleverapps.Shaders.VERTEX_SRC,cleverapps.Shaders.FLICKER_FRAGM),cleverapps.Shaders.BLUR_FADE_FRAGM=cleverapps.Shaders.BLUR_TEMPLATE.replace("%{skipFunction}",cleverapps.Shaders.BLUR_FADE_SKIP),
cleverapps.Shaders.BLUR_CURTAIN_FRAGM=cleverapps.Shaders.BLUR_TEMPLATE.replace("%{skipFunction}",cleverapps.Shaders.BLUR_CURTAIN_SKIP),cleverapps.Shaders.BLUR_CURTAIN_REVERSE_FRAGM=cleverapps.Shaders.BLUR_TEMPLATE.replace("%{skipFunction}",cleverapps.Shaders.BLUR_CURTAIN_REVERSE_SKIP),e(cleverapps.Shaders.BLUR_FADE_KEY,cleverapps.Shaders.VERTEX_SRC,cleverapps.Shaders.BLUR_FADE_FRAGM),e(cleverapps.Shaders.BLUR_CURTAIN_KEY,cleverapps.Shaders.VERTEX_SRC,cleverapps.Shaders.BLUR_CURTAIN_FRAGM),e(cleverapps.Shaders.BLUR_CURTAIN_REVERSE_KEY,cleverapps.Shaders.VERTEX_SRC,cleverapps.Shaders.BLUR_CURTAIN_REVERSE_FRAGM)}}},cleverapps.UI.Avatar=cc.Node.extend({ctor:function(e,t){var n=e;e&&(e.avatar||e.id)&&(n=e.avatar,t=e.id),this._super();var s=t===levels.user.id,i=new cc.Sprite(s?bundles.main.frames.user_avatar:bundles.main.frames.default_avatar);this.addChild(i),this.avatar=i;var o=e&&e.frame;o||(o=s?bundles.avatar.frames.avatar_frame2:bundles.avatar.frames.avatar_frame);var r=new cc.Sprite(o)
;r.setLocalZOrder(1),this.addChild(r);var a=cleverapps.styles.UI.Avatar;this.setAnchorPoint(.5,.5),this.setContentSize2(r.getContentSize()),i.setPositionRound(this.width/2,this.height/2+(a.bottom-a.top)/2),r.setPositionRound(this.width/2,this.height/2),this.adjustSize(),(this.image=n)&&"string"==typeof n&&cleverapps.social.isLoggedIn()&&t&&0<=n.indexOf("fbsbx.com")&&(cleverapps.social instanceof cleverapps.MobileFacebook||cleverapps.social instanceof cleverapps.Html5)&&(this.avatarFBUserId=t,this.onImageLoadErrorSafe=this.createListener(this.onImageLoadError.bind(this))),this.onImageLoadSafe=this.createListener(this.onImageLoad.bind(this))},onImageLoadError:function(){cleverapps.social.aboutUser(this.avatarFBUserId,this.createListener(this.onFBUserLoaded.bind(this)))},onFBUserLoaded:function(e){if(e&&e.picture&&e.picture.data&&e.picture.data.url){this.image=e.picture.data.url,this.onImageLoadErrorSafe=void 0,this.setImage(this.image);var t={avatar:this.image}
;cleverapps.RestClient.post("/info/"+this.avatarFBUserId,t,function(e){},function(){console.log("Failed updating user avatar: "+t.avatar)})}},onEnter:function(){if(this._super(),this.image){var t=!0;["stub_128x128.gif","camera_200.png"].forEach(function(e){"string"==typeof this.image&&-1!==this.image.indexOf(e)&&(t=!1)}.bind(this)),t&&this.setImage(this.image)}},adjustSize:function(){this.avatar.setScale((this.width-2*cleverapps.styles.UI.Avatar.x)/this.avatar.width,(this.height-cleverapps.styles.UI.Avatar.top-cleverapps.styles.UI.Avatar.bottom)/this.avatar.height)},onImageLoad:cleverapps.whenShow(function(e,t){if(e)this.onImageLoadErrorSafe&&this.onImageLoadErrorSafe(),console.log("Error loading avatar image!");else try{var n=new cc.Sprite(t);n.setPositionRound(this.width/2,this.height/2),this.avatar.removeFromParent(),this.addChild(n),this.avatar=n,this.adjustSize()}catch(e){console.log("Cross-domain??",e)}}),loadGif:function(i){if(cc.sys.isNative||(i=i.replace("https:","").replace(
"http:","")),i!==this.imageUrl){this.imageUrl=i;try{var o=new SuperGif;o.load_url(i,this.createListener(function(){if(i===this.imageUrl){var e=o.getFrames();if(Array.isArray(e)&&0<e.length){var t=new cc.Sprite(e[0]);t.setPositionRound(this.width/2,this.height/2),this.avatar.removeFromParent(),this.addChild(t),this.avatar=t,this.adjustSize();var n=[];e.forEach(function(e){n.push(new cc.Sprite(e).getSpriteFrame())});var s=new cc.Animation(n,.075);this.avatar.runAction(new cc.RepeatForever(cc.animate(s)))}}}.bind(this)))}catch(e){i===this.imageUrl&&delete this.imageUrl,console.log("Cross-domain??",e),this.onImageLoadErrorSafe&&this.onImageLoadErrorSafe()}}},getImageSpriteFrame:function(e){if(0===e.indexOf("#"))return cc.spriteFrameCache.getSpriteFrame(e)||cc.spriteFrameCache.getSpriteFrame(e.replace(/\//g,"-"))||cc.spriteFrameCache.getSpriteFrame(e.replace(/\//g,"-").replace("#","#main-"))},setImage:cleverapps.whenShow(function(n){if(n instanceof cc.SpriteFrame)this.avatar.setSpriteFrame(
n),this.adjustSize();else if(0===n.indexOf("#")&&this.getImageSpriteFrame(n))this.avatar.setSpriteFrame(this.getImageSpriteFrame(n)),this.adjustSize();else if(-1!==n.indexOf(".gif"))this.loadGif(n);else{var e=cleverapps.UI.Avatar.cache.get(n);if(e)return void this.onImageLoadSafe(0,e);var s=cleverapps.environment.onShowCounter;cc.loader.loadImg(n,cleverapps.whenShow(function(e,t){if(s!==cleverapps.environment.onShowCounter&&cc.sys.isNative)return cc.textureCache.removeTextureForKey(n),void this.setImage(n);this.onImageLoadSafe(e,t)}.bind(this)))}})}),cleverapps.UI.Avatar.cache=new cleverapps.Cache,cleverapps.UI.Avatar.preload=function(n,s){if(s=s||function(){},Array.isArray(n)){var t=cleverapps.wait(n.length,s);n.forEach(function(e){cleverapps.UI.Avatar.preload(e.avatar||e,t)})}else if("string"==typeof n&&0!==n.indexOf("#")&&-1===n.indexOf(".gif")){var e=cleverapps.UI.Avatar.cache.get(n);e?s(e):cc.loader.loadImg(n,function(e,t){e||cleverapps.UI.Avatar.cache.set(n,t),s(!e&&t)})}else s()
},cleverapps.Parallax={apply:function(e){e.scene&&(e=e.scene),e.parallaxContainer=new cc.Node,e.parallaxContainer.setAnchorPoint(.5,.5),e.parallaxContainer.setLocalZOrder(cleverapps.styles.parallax.zOrder),e.addChild(e.parallaxContainer),e._parallaxContainerPosition={x:0,y:0},this.isAvailable()&&(cc.sys.isNative||(cc.sys.BROWSER_TYPE_MOBILE_QQ=cc.sys.browserType),cleverapps.Parallax.onChangeSize(e),cleverapps.Parallax.refresh=cleverapps.Parallax._refresh.bind(e),cleverapps.Parallax.setEnabled=cleverapps.Parallax._changeEnabled.bind(e),e._parallaxEnabled=!0,cc.inputManager.setAccelerometerInterval(1/60),cc.inputManager.setAccelerometerEnabled(!0),cc.eventManager.addListener({event:cc.EventListener.ACCELERATION,callback:cleverapps.Parallax._handleOrientation.bind(e)},e))},isAvailable:function(){return cc.sys.isMobile&&cc.sys.capabilities.hasOwnProperty("accelerometer")&&"board"===!cleverapps.config.type},onChangeSize:function(e){if(e.scene&&(e=e.scene),this.isAvailable(
)&&e.parallaxContainer){var t=(cleverapps.styles.SCENE_HEIGHT+2*cleverapps.styles.parallax.height)/cleverapps.styles.SCENE_HEIGHT;e.width+2*cleverapps.styles.parallax.width>cleverapps.styles.SQUARE_MODE_WIDTH&&(t=Math.max(t,(cleverapps.styles.SQUARE_MODE_WIDTH+2*cleverapps.styles.parallax.width)/cleverapps.styles.SQUARE_MODE_WIDTH)),e.parallaxContainer.setScale(t),e._parallaxContainerPosition={x:(e.width-e.width*t)/2,y:(e.height-e.height*t)/2},e.parallaxContainer.setPosition(e._parallaxContainerPosition)}},setEnabled:function(){},refresh:function(){},_changeEnabled:function(e){e||this.parallaxContainer.stopAllActions(),e!==this._parallaxEnabled&&(this._parallaxEnabled=e,this._parallaxEnabled&&cleverapps.Parallax.refresh())},_refresh:function(){this._parallaxEnabled&&(delete this._parallaxBaseAngle,delete this._parallaxDx,delete this._parallaxDy,this._parallaxEnabled=!1,this.parallaxContainer.stopAllActions(),this.parallaxContainer.runAction(new cc.Sequence(new cc.MoveTo(.3,
this._parallaxContainerPosition),new cc.CallFunc(function(){this._parallaxEnabled=!0}.bind(this)))))},_handleOrientation:function(e){if(this._parallaxEnabled&&!(Math.abs(e.x)<1e-4&&Math.abs(e.y)<1e-4)){var t=90*e.x,n=90*e.y;this._parallaxBaseAngle||(this._parallaxBaseAngle={x:t,y:n},this._parallaxDx=t,this._parallaxDy=n),this._parallaxDx=.1*t+.9*this._parallaxDx,this._parallaxDy=.1*n+.9*this._parallaxDy,t=this._parallaxDx-this._parallaxBaseAngle.x,n=this._parallaxDy-this._parallaxBaseAngle.y,Math.abs(t)<cleverapps.Parallax.PARALLAX_MAX_ANGLE&&(this.parallaxContainer.x=this._parallaxContainerPosition.x+t*cleverapps.styles.parallax.width/cleverapps.Parallax.PARALLAX_MAX_ANGLE),Math.abs(n)<cleverapps.Parallax.PARALLAX_MAX_ANGLE&&(this.parallaxContainer.y=this._parallaxContainerPosition.y+n*cleverapps.styles.parallax.height/cleverapps.Parallax.PARALLAX_MAX_ANGLE)}},PARALLAX_MAX_ANGLE:30},cleverapps.styles.parallax={width:40,height:40,zOrder:0},cleverapps.FixedWidthScene=cc.Scene.extend({
ctor:function(e){cleverapps.wideMode.refresh(),this._super(),cleverapps.environment.setScene(e);var t=cc.director.getWinSize();this.setContentSize(t),this.scene=new cc.Node,this.scene.resizeScale=1,this.scene.sceneName=e,this.scene.setPositionRound(this.width/2,this.height/2),this.scene.setAnchorPoint(.5,.5),this.scene.setContentSize2(cleverapps.UI.getSceneSize());var n=new ShadowView;n.setPosition(0,-cleverapps.UI.getSceneOffsetY()),this.scene.addChild(n,20),this.addChild(this.scene),cleverapps.Parallax.apply(this),this.backgroundStyles=this.getBackgroundStyles(),this.setBackground(),this.ctorCustomize(),this.needDisplayIntro=!0,this.addMenuBar(),cleverapps.windows.reset();var s=this.getAudioStyles();this.runAction(new cc.Sequence(new cc.DelayTime(s.delay||0),new cc.CallFunc(function(){cleverapps.audio.insertDisk(s.res)}))),this.currentOrientation=this.calcOrientation()},calcOrientation:function(){
return cc.sys.isNative||void 0===typeof window?0:window.innerHeight<window.innerWidth?0:1},getAudioStyles:function(){return cleverapps.styles.FixedWidthScene.sound},_playIntro:function(){this.needDisplayIntro=!1,cleverapps.metha.display({focus:"Scene.intro",action:this.displayIntro.bind(this)})},displayIntro:function(e){e()},addMenuBar:function(){if(this.upMenuButtons&&(this.upMenuButtons.removeFromParent(),delete this.upMenuButtons),!MenuControlButton.needToAddInsidePanel()){var e=this.upMenuButtons=new SceneControlButtonsView;e.deltaY=cleverapps.UI.getSceneOffsetY()-cleverapps.styles.MenuBar.minOffest,e.deltaY<0&&(e.deltaY=0),e.alignment=cleverapps.clone(e.alignment,!0),e.alignment.y.dy+=e.deltaY,this.scene.addChild(e)}var t=Boolean(this.upMenuBar);this.upMenuBar&&this.upMenuBar.removeFromParent();var n=this.upMenuButtons?this.upMenuButtons.x-this.upMenuButtons.width/2:this.scene.width;this.upMenuBar=new MenuBarView(n,this.scene),t&&cleverapps.menuBar.getSceneItems().forEach(
function(e){cleverapps.metha.isControlEnabled(e.getControlName())&&cleverapps.metha.showControlsWhileFocused(e.getControlName(),!0)})},getBackgroundStyles:function(){return cleverapps.skins.getSlot("sceneBg")||cleverapps.styles.FixedWidthScene.background},setBackground:function(){var e=this.backgroundStyles;if(e)if(e.pattern){var t=cc.director.getWinSize();t.height+=2,(s=this.background=new cc.Node).setAnchorPoint(.5,.5),s.setPosition(t.width/2,t.height/2-cleverapps.UI.getSceneOffsetY()),s.setContentSize(t);var n=cleverapps.UI.createPatternSprite(e.background||e.pattern,t);s.addChild(n),s.setLocalZOrder(-10),this.updateBackgroundScale(),this.scene.addChild(s)}else{var s=this.background=new cc.Sprite(e.background);if(e.animation){var i=this.background.animation=new cleverapps.Spine(e.animation);i.setAnimation(0,"animation",!0),e.skin&&i.setSkin(e.skin),i.setPositionRound(s.width/2,s.height/2),s.addChild(i)}s.setPosition(this.scene.width/2,this.scene.height/2),this.updateBackgroundScale(
);var o=this.scene.parallaxContainer;!1===e.parallax?(o=this.scene,s.setLocalZOrder(-10)):o.setLocalZOrder(-10),o.addChild(s)}},getRefreshSceneActionOnChangeSize:function(){return!1},onChangeSize:function(e){var t=this.calcOrientation();if(t!==this.currentOrientation||e){if(t===this.currentOrientation&&(cleverapps.MobileOK.isAppropriate()||cleverapps.MobileMyMailRu.isAppropriate()))return;this.currentOrientation=t;var n=this.getRefreshSceneActionOnChangeSize();if(n){var s=function(e){cleverapps.eventLogger.logEvent("refreshscene_changesize"),n(e)};return void(cleverapps.metha.isFocused()?cleverapps.FixedWidthScene.canDistractChangeSize?(cleverapps.FixedWidthScene.canDistractChangeSize=!1,cleverapps.metha.distract({focus:"refreshSceneOnChangeSize"+Date.now(),action:s})):cleverapps.FixedWidthScene.changedOrientation=!0:(cleverapps.FixedWidthScene.canDistractChangeSize=!1,cleverapps.metha.display({focus:"refreshSceneOnChangeSize"+Date.now(),action:s})))}}cleverapps.metha.isFocused(
)&&!cleverapps.FixedWidthScene.canDistractChangeSize&&(cleverapps.FixedWidthScene.changedSize=!0),this.setContentSize(cc.view.getDesignResolutionSize()),this.setContentSize2(this.getContentSize()),this.scene.resizeScale=Math.min(1,this.getContentSize().width/this.scene.width),this.scene.setScale(this.scene.resizeScale),this.scene.setPositionRound(this.width/2,this.height/2),this.updateBackgroundScale();var i,o=cleverapps.UI.getSceneOffsetY(),r=o-cleverapps.styles.MenuBar.minOffest;r<0&&(r=0),this.upMenuBar&&(i=r-this.upMenuBar.deltaY,this.upMenuBar.y+=i,this.upMenuBar.hideHandler&&(this.upMenuBar.hideHandler.originalPosition.y+=i,this.upMenuBar.hideHandler.hidePosition.y+=i),this.upMenuBar.deltaY=r),this.upMenuButtons&&(i=r-this.upMenuButtons.deltaY,this.upMenuButtons.y+=i,this.upMenuButtons.hideHandler&&(this.upMenuButtons.hideHandler.originalPosition.y+=i,this.upMenuButtons.hideHandler.hidePosition.y+=i),this.upMenuButtons.deltaY=r),this.downToolBar&&(i=o-this.downToolBar.deltaY,
this.downToolBar.y-=i,this.downToolBar.hideHandler&&(this.downToolBar.hideHandler.originalPosition.y-=i,this.downToolBar.hideHandler.hidePosition.y-=i),this.downToolBar.deltaY=o),cleverapps.Notification.remove(!0),cleverapps.eventBus.trigger("changeSceneSize")},updateBackgroundScale:function(){if(this.background){var e=this.backgroundStyles;if("number"==typeof e.scale)this.background.setScale(e.scale);else{var t=this.bgScaleMargin||1,n=Math.max(this.width/this.background.width*t/this.scene.scale,this.height/this.background.height*t/this.scene.scale);if(this.background.setScale(n),cleverapps.isInstant()){var s=this.background.height/t*n;s>this.height&&(this.background.y=this.height/2+(s-this.height)/3)}this.background.stopAllActions()}}},onExit:function(){this._super(),cleverapps.bundleLoader.clearUnusedResources()},onEnter:function(){this._super(),cc.sys.garbageCollect()},onTransitionAnimationDidStart:function(){cleverapps.audio.fadeOut()},visit:function(e){this.shadowVisitQueue=[],
this._super.apply(this,arguments),this.afterVisitShadow()},afterVisitShadow:function(){this.afterVisitShadowProcessing=!0;var e=this.shadowVisitQueue||[];this.shadowVisitQueue=[],e.forEach(cleverapps.callFunc),this.afterVisitShadowProcessing=!1},closeAction:function(){cleverapps.metha.display({focus:"closeScene",action:function(e){cleverapps.metha.gotoMainScene(e)}})}}),cleverapps.FixedWidthScene.prototype.createFilmEffect=function(e){(e=e||{}).layerSizeKoef=void 0!==e.layerSizeKoef?e.layerSizeKoef:.1,e.layerTimeout=e.layerTimeout||.3,e.onComplete=e.onComplete||function(){},this.scene.stopAllActions(),this.scene.basePosition=this.scene.getPosition();var t={x:this.scene.basePosition.x,y:this.scene.basePosition.y};if(e.scale=e.scale||1.3,this.upperFilmLayer=new cc.LayerColor(cc.color.BLACK,this.scene.width,this.scene.height*e.layerSizeKoef+(e.layerSizeKoef?3:0)),this.downFilmLayer=new cc.LayerColor(cc.color.BLACK,this.scene.width,this.scene.height*e.layerSizeKoef+(e.layerSizeKoef?3:0)),
e.moveBy&&(e.moveBy.x&&(t.x+=e.moveBy.x),e.moveBy.y)){if(e.moveBy.y<0){var n=this.upperFilmLayer.height+this.scene.height*(e.scale-1)/2;e.moveBy.y<-n&&(e.moveBy.y=-n)}else{n=this.downFilmLayer.height+this.scene.height*(e.scale-1)/2;e.moveBy.y>n&&(e.moveBy.y=n)}t.y+=e.moveBy.y}this.upperFilmLayer.setPositionRound(0,this.height-this.upperFilmLayer.height+2),this.downFilmLayer.setPositionRound(0,-1),this.downFilmLayer.setLocalZOrder(50),this.upperFilmLayer.setLocalZOrder(50),this.addChild(this.upperFilmLayer),this.addChild(this.downFilmLayer),e.silent?(this.scene.setScale(e.scale),this.scene.setPositionRound(t),e.onComplete()):(e.scaleTimeout=e.scaleTimeout||1,this.upperFilmLayer.setOpacity(0),this.downFilmLayer.setOpacity(0),this.scene.runAction(new cc.Sequence(new cc.DelayTime(e.layerTimeout),new cc.Spawn(new cc.MoveTo(e.scaleTimeout,t),new cc.ScaleTo(e.scaleTimeout,e.scale)),new cc.CallFunc(e.onComplete))),this.upperFilmLayer.runAction(new cc.FadeTo(e.layerTimeout,255)),
this.downFilmLayer.runAction(new cc.FadeTo(e.layerTimeout,255))),e.noControls||(cc.eventManager.addListener({event:cc.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:!0,onTouchBegan:function(){return!0},onTouchEnded:function(){return e.onClick&&e.onClick(),!0}},this.upperFilmLayer),cc.eventManager.addListener({event:cc.EventListener.MOUSE,onMouseScroll:function(e){return e&&e.stopPropagation&&e.stopPropagation(),!0},onMouseMove:function(e){return e&&e.stopPropagation&&e.stopPropagation(),!0}},this.upperFilmLayer))},cleverapps.FixedWidthScene.prototype.removeFilmEffect=function(e){var t;(e=e||{}).scaleTimeout=void 0===e.scaleTimeout?1:e.scaleTimeout,e.layerTimeout=e.layerTimeout||.3,this.scene.stopAllActions(),this.stopAllActions(),this.scene.runAction(new cc.Spawn(new cc.MoveTo(e.scaleTimeout,this.scene.basePosition),new cc.ScaleTo(e.scaleTimeout,1))),this.runAction(new cc.Sequence(new cc.DelayTime(e.scaleTimeout),new cc.CallFunc(function(){this.scene.setScale(1),
this.scene.setPositionRound(this.scene.basePosition),e.onComplete&&e.onComplete()}.bind(this)))),e.scaleLayerSameTime&&(e.layerTimeout=e.scaleTimeout,e.scaleTimeout=0),this.upperFilmLayer&&(this.upperFilmLayer.stopAllActions(),t=e.layerSlide?new cc.MoveBy(e.layerTimeout,{x:0,y:this.upperFilmLayer.height}):new cc.FadeTo(e.layerTimeout,0),this.upperFilmLayer.runAction(new cc.Sequence(new cc.DelayTime(e.scaleTimeout),t,new cc.RemoveSelf)),this.upperFilmLayer=void 0),this.downFilmLayer&&(this.downFilmLayer.stopAllActions(),t=e.layerSlide?new cc.MoveBy(e.layerTimeout,{x:0,y:-this.downFilmLayer.height}):new cc.FadeTo(e.layerTimeout,0),this.downFilmLayer.runAction(new cc.Sequence(new cc.DelayTime(e.scaleTimeout),t,new cc.RemoveSelf)),this.downFilmLayer=void 0)};var SceneProxy=function(e,t,arguments){this.superClass=e,this.self=t,this.arguments=arguments,cleverapps.newSceneStack=(new Error).stack,this.instance=void 0,this.callbacks=[]};SceneProxy.prototype.instantiate=function(){
var e=cc.Node.superClassCreateFunction(this.superClass);this.instance=e.apply(this.self,this.arguments),this.instance.sceneBundles=this.sceneBundles,this.instance.isWide=this.isWide,this.onLoad()},SceneProxy.prototype.onLoad=function(){this.callbacks.forEach(function(e){e(this.instance)},this),this.callbacks=[]},SceneProxy.prototype.whenLoaded=function(e){this.instance?e(this.instance):this.callbacks.push(e)},cleverapps.FixedWidthScene.superExtend=cleverapps.FixedWidthScene.extend,cleverapps.FixedWidthScene.extend=function(){var n=cleverapps.FixedWidthScene.superExtend.apply(this,arguments),s=function(){cleverapps.eventManager.setCurrentFeatures(),cleverapps.skins.update(),cleverapps.gameSceneLogs=[],cleverapps.gameSceneLogs.push("arguments in SceneClass arg0: "+!!arguments[0]+" arg1: "+!!arguments[1]+" argsLength: "+arguments.length);var e=new SceneProxy(n,this,arguments);e.sceneBundles=cleverapps.bundleLoader.getClassBundles(s,this,arguments).filter(function(e){return bundles[e]}),
e.isWide=s.IS_WIDE,cleverapps.config.debugMode&&e.sceneBundles.push("dev_resources"),this.onSuccess=cleverapps.accumulate(0,e.instantiate.bind(e)),cleverapps.bundleLoader.loadBundles(e.sceneBundles,{onSuccess:this.onSuccess.bind(this),onFailure:function(){new RestartWindow}});var t=cc.director.getRunningScene();return t&&t.sceneBundles&&(t.performRecursive(function(e){e.stopAllActions()}),cleverapps.bundleLoader.deleteBundles(t.sceneBundles),delete t.sceneBundles),cc.pool.drainAllPools(),e};return s.DebugConstructor=n,s.prototype=n.prototype,s.extend=cleverapps.FixedWidthScene.extend,s},cleverapps.FixedWidthScene.prototype.ctorCustomize=function(){},cleverapps.styles.FixedWidthScene={background:!1,sound:{res:bundles.main.urls.background_music_map,delay:.5}};var Windows=function(){this.list=[],this.bundles=0,this.onHideShadow=function(e){},this.onShowShadow=function(e){},this.onOpenListeners={},this.onCloseListeners={},this.onAllClosed=[],this.onceNoWindowsListener=void 0}
;Windows.prototype.isActive=function(){return 0<this.list.length||0<this.bundles},Windows.prototype.reset=function(){this.list=[],this.onAllClosed=[],this.bundles=0,this.onHideShadow()},Windows.prototype.currentWindow=function(){if(0!==this.list.length)return this.list[this.list.length-1]},Windows.prototype.add=function(e){if(cleverapps.metha.isFocused()||-1!==["promptwindow"].indexOf(e.name)||cleverapps.metha.debugMessage("Trying to show window without user focus!"),e instanceof WaitWindow)e.displaySelf();else{if(0<this.list.length){var t=this.list[this.list.length-1];e.windowForce?(t.originalZOrder=t.getLocalZOrder(),t.setLocalZOrder(19)):(t.setVisible(!1),this.onHideShadow(),t.initializedSuccess&&t.onHide())}if(this.list.push(e),this.showWindow(),1===this.list.length&&!(this.list[0]instanceof Force))for(var n in this.onOpenListeners)this.onOpenListeners[n]()}},Windows.prototype.hideWindow=function(){var e=this.currentWindow();e&&e.hideSelf()},Windows.prototype.showWindow=function(){
var e=this.currentWindow();e&&e.displaySelf()},Windows.prototype.whenAllClosed=function(e){cleverapps.windows.isActive()?cleverapps.windows.onAllClosed.push(e):e()},Windows.prototype.notifyMetha=function(){if(!this.isActive()&&cleverapps.metha.onceNoWindowsListener){var e=cleverapps.metha.onceNoWindowsListener;cleverapps.metha.onceNoWindowsListener=void 0,e(),cleverapps.metha.isFocused()||cleverapps.bundleLoader.clearUnusedResources()}},Windows.prototype.closeCallback=function(e){for(cleverapps.environment&&cleverapps.environment.onCloseWindow(e.name),e.closeAnimationCallbacks&&(e.closeAnimationCallbacks.forEach(function(e){e()}),e.closeAnimationCallbacks=[]),e.shareCheckBox&&e.shareCheckBox.onWindowClose(),e.removeFromParent();!this.isActive()&&0<this.onAllClosed.length;){this.onAllClosed.shift()()}setTimeout(this.notifyMetha.bind(this),0)},Windows.prototype.remove=function(e){if(!e.closed){e.closed=!0;var t=e===this.currentWindow();this.delete(e,t),e.onClose&&e.onClose(),
t?e.closeAnimation(this.closeCallback.bind(this,e)):this.closeCallback(e)}},Windows.prototype.delete=function(e,t){var n=this.list.indexOf(e);if(-1!==n&&this.list.splice(n,1),t)if(0===this.list.length){this.onHideShadow(),cleverapps.Parallax.setEnabled(!0);var s=cc.director.getRunningScene();s&&s.onShow&&s.onShow(),setTimeout(function(){0===this.list.length&&cleverapps.values(this.onCloseListeners).forEach(cleverapps.callFunc)}.bind(this),e.closeDuration())}else if(e.windowForce){var i=this.list[this.list.length-1];i.setLocalZOrder(i.originalZOrder)}else this.showWindow()};var ShadowView=cc.Node.extend({ctor:function(){if(this._super(),this.shadow=new ShadowLayer,this.shadow.setOpacity(0),this.addChild(this.shadow),this.shadow.visible=!1,this.show=!1,!cleverapps.windows)throw new Error("No cleverapps.windows cleverapps.allInitialized - "+cleverapps.allInitialized);cleverapps.windows.onHideShadow=this.createListener(this.deleteShadow.bind(this)),
cleverapps.windows.onShowShadow=this.createListener(this.createShadow.bind(this))}});ShadowView.prototype.createShadow=function(e){if(!this.show){this.show=!0,this.shadow.stopAllActions(),this.shadow.visible=!0,e.color&&this.shadow.setColor(e.color);var t=cleverapps.styles.ShadowView;this.shadow.runAction(new cc.FadeTo(t.duration,e.opacity||t.opacity))}},ShadowView.prototype.deleteShadow=function(){if(this.show){this.show=!1,this.shadow.stopAllActions();var e=cleverapps.styles.ShadowView;this.shadow.runAction(new cc.Sequence(new cc.FadeTo(e.duration,0),new cc.CallFunc(function(){this.shadow.visible=!1}.bind(this))))}},cleverapps.styles.ShadowView={duration:.3,opacity:110};var BaseWindow=cc.Node.extend({listBundles:function(){return[]},ctor:function(e){if(!cleverapps.environment.isEditorScene()||this.editorWindow){this._super(),this.isBundlesLoaded=!1;var t=arguments;e=void 0!==e?e:{};var n=cc.director.getRunningScene();if(e.parentScene||n.windowsContainer||(n=n.scene),
cleverapps.config.wysiwygMode&&(n=cc.director.getRunningScene()).emulatorScene&&(n=n.emulatorScene),n.addChild(this),this.adjustBaseWindow(),this.setLocalZOrder(21),cleverapps.windows.add(this),this.applyTouch(),cleverapps.eventBus.on("changeSceneSize",this.adjustBaseWindow.bind(this),this),this.bundles=this.listBundles.apply(this,arguments)||[],cleverapps.skins.getBundle()&&this.bundles.push(cleverapps.skins.getBundle()),this.bundles.push("windows"),this.bundles=cleverapps.unique(this.bundles),this.bundles=this.bundles.filter(function(e){return bundles[e]}),0!==this.bundles.length){this.showLoading();var s=[this.createListener(function(){this.hideLoading(),this.runWindow(t)}.bind(this)),this.createListener(function(){this.deleteSelf(),new RestartWindow}.bind(this))];Array.prototype.push.apply(s,arguments),this.load.apply(this,s)}else this.runWindow(t)}},load:function(e,t,n){cleverapps.bundleLoader.loadBundles(this.bundles,{onSuccess:e,onFailure:t})},adjustBaseWindow:function(){
var e=cc.director.getRunningScene(),t=e.width,n=e.height;this.setScale(1/this.parent.getScale()),this.setContentSize(t,n),this.setPositionRound((this.parent.width*this.parent.getScale()-t)/2,(this.parent.height*this.parent.getScale()-n)/2),this.loading&&this.loading.setPositionRound(t/2,n/2)},applyTouch:function(){cc.eventManager.addListener({event:cc.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:!0,onTouchBegan:this.onTouchStart.bind(this),onTouchEnded:this.onTouchEnd.bind(this)},this),cc.eventManager.addListener({event:cc.EventListener.MOUSE,onMouseMove:function(e){return!!this.isVisible()&&(e&&e.stopPropagation&&e.stopPropagation(),!0)}.bind(this),onMouseScroll:function(e){return!!this.isVisible()&&(e&&e.stopPropagation&&e.stopPropagation(),!0)}.bind(this)},this)},showLoading:function(){var e=this.loading=WaitWindow.prototype.showLoading.call(this);e.setPositionRound(this.width/2,this.height/2),this.addChild(e),e.visible=!1,e.runAction(new cc.Sequence(new cc.DelayTime(.2),
new cc.CallFunc(function(){e.visible=!0})))},hideLoading:function(){this.loading&&(this.loading.removeFromParent(),delete this.loading)},hasAppeared:function(){return this.isBundlesLoaded},runWindow:function(e){this.isBundlesLoaded=!0,this.onWindowLoaded.apply(this,e),this.initializedSuccess?this.displaySelf():this.deleteSelf()},hideSelf:function(){cleverapps.windows.currentWindow()===this&&(this.setVisible(!1),this.styles.shadow&&cleverapps.windows.onHideShadow(),this.onHide())},displaySelf:function(){this.hasAppeared()&&cleverapps.windows.currentWindow()===this&&(this.setVisible(!0),this.styles.shadow&&cleverapps.windows.onShowShadow(this.styles.shadow),this.popUpAnimation(),this.onShow(),cleverapps.environment&&cleverapps.environment.onOpenWindow(this.name))},deleteSelf:function(){var e=this===cleverapps.windows.currentWindow();cleverapps.windows.delete(this,e),this.removeFromParent()},close:function(){!0===this.closed&&cleverapps.ReportStream.send("doubleclose",
"Closing already closed window: "+this.name+" "+JSON.stringify((new Error).stack)),this.isBundlesLoaded&&!this.closed&&(cleverapps.bundleLoader.deleteBundles(this.bundles),cleverapps.windows.remove(this))}}),Window=BaseWindow.extend({addBottomButtons:function(e){var t=this.buttons=new Buttons(e);this.window.addChild(t);var n=(s=this.styles.BottomButton||cleverapps.styles.Window.BottomButton).bottomPadding;if(t.setPositionRound(this.window.width/2,t.height/2+n),this.shareCheckBox){var s=cleverapps.styles.Window.ShareCheckBox;this.shareCheckBox.setPositionRound(this.window.width/2,t.y+t.height/2+this.shareCheckBox.height/2+s.offsetBottom)}},onWindowLoaded:function(e){this.initializedSuccess=!0,cleverapps.Parallax.setEnabled(!1);var t=this.styles=e.styles||cleverapps.styles.Window;this.name=e&&e.name||e&&e.title||"window",this.onClose=e&&e.onClose||this.onClose,this.extraWidth=e.extraWidth||0,this.extraHeight=e.extraHeight||0,this.contentOffsetX=e.contentOffsetX||0,
this.contentOffsetY=e.contentOffsetY||0;var n=e.content;if(n){this.customizeContent();var s=n.getContentSize(),i=[];if(e.button){var o=this.button=new BottomButton(this,e.button);i.push(o)}e.buttons&&(i=i.concat(e.buttons)),this.withBg=!e.noBackground&&!t.noBackground,!e.shareCheckBox||cleverapps.flags.noviral||cleverapps.flags.noshares||(this.createShareCheckBox(i,e.shareCheckBox),s.height+=this.getShareCheckBoxHeight());var r=this.windowSize=this.calcBackgroundSize(s,e);this.withBg?this.window=this.createBackground(r,t,e):(this.window=new cc.Node,this.window.setContentSize2(r),this.window.setAnchorPoint2(.5,.5),this.addChild(this.window)),e.foreground&&e.adjustToContent&&this.addForeground(n,e.foreground);var a=cleverapps.skins.getSlot("windowDecors",{decors:t.decors,window:this,level:e.level});a&&(this.decors=new Decors(this,a)),this.adjustWindow(),this.withBg&&this.createInnerBackground(),!1!==e.closeButton&&!1!==t.closeButton&&(
this.withBg&&!t.bandButton||t.regularCloseButton||e.regularCloseButton?this.createCloseButton():this.createCloseBandButton()),e.help&&this.createHelpButton(e.help),t.Title&&e.title&&(this.addTitle(e.title),t.Title.bg&&!e.noTitleBg&&this.addTitleBg(t.Title.bg));var c=e.adjustToContent?0:t.contentOffset+this.getShareCheckBoxHeight()/2;n.setPositionRound(this.window.width/2+this.contentOffsetX,this.window.height/2+c+this.contentOffsetY),this.window.addChild(n),this.shareCheckBox&&(this.window.addChild(this.shareCheckBox),this.shareCheckBox.setPositionRound(this.window.width/2,this.shareCheckBox.height/2+t.ShareCheckBox.offsetBottom)),0<i.length&&this.addBottomButtons(i),cleverapps.eventBus.on("changeSceneSize",this.onChangeSceneSizeWindow.bind(this),this)}(!1!==e.closeButton||e.closeByBackButton)&&(this.closeByBackButton=this.close.bind(this));var l=this.onTouchInShadow;this.onTouchInShadow=function(){},this.runAction(new cc.Sequence(new cc.DelayTime(.5),new cc.CallFunc(function(){
l?this.onTouchInShadow=l:e.notCloseByTouchInShadow||(this.onTouchInShadow=this.close.bind(this))}.bind(this)))),this.closeAnimationCallbacks=[],this.customize(),this.checkFit(n)},adjustWindow:function(){var e=cc.size(this.windowSize.width,this.windowSize.height),t=cleverapps.UI.getSceneSize();cleverapps.config.wysiwygMode&&cc.director.getRunningScene().emulatorScene&&(t=cc.director.getRunningScene().emulatorScene.getContentSize()),e.width+2*this.styles.Background.paddingX>t.width&&(e.width=t.width-2*this.styles.Background.paddingX),e.height+2*this.styles.Background.paddingY>t.height&&(e.height=t.height-2*this.styles.Background.paddingY),this.windowScale=Math.min(e.width/this.windowSize.width,e.height/this.windowSize.height),this.styles.noWindowScale&&(this.windowScale=1),this.window.setScale(this.windowScale);var n=this.styles.bgOffset?this.styles.bgOffset.x:0,s=this.styles.bgOffset?this.styles.bgOffset.y:0;this.window.setPositionRound(this.width/2+n,this.height/2+s),
this.window.basePosition=this.window.getPosition()},onChangeSceneSizeWindow:function(){this.adjustWindow(),this.closeButton instanceof BandButton&&this.createCloseBandButton(!0)},addTitleBg:function(e){var t,n=cleverapps.skins.getSlot("windowTitle",{image:e.image});!1===e.scale9?t=new cc.Sprite(n):(t=cleverapps.UI.createScale9Sprite(n,e.scale9),!e.adjustToWindow&&e.adjustToText&&(t.height+=e.adjustToText.height||0)),t.setLocalZOrder(e.zIndex),this.window.addChild(t),t.setPositionRound(e.x,e.y),this.titleBg=t,this.decors&&this.decors.initTitleDecorators(),this.updateTitleBg()},checkFit:function(e){var t=cleverapps.UI.getSceneSize(),n=t.width+cleverapps.styles.Window.checkFitThreshold;if(this.window&&this.window.width*this.window.scale>n){var s="Window width "+this.window.width+" scale "+this.window.scale+" windowScale "+this.windowScale+" is greater than scene width "+t.width;e&&(s+=", content width "+e.width+" scale "+e.scale),cleverapps.throwAsync(s)}},createCloseBandButton:function(e
){this.closeButton&&this.closeButton.removeFromParent();var t=new BandButton({onClicked:this.close.bind(this)});this.addChild(t,1),e||(t.hide(!0),t.show(.2)),this.closeButton=t},createCloseButton:function(){var e,t=this.styles.CloseButton;e=new cleverapps.UI.Button({button_png:bundles.main.frames.window_close_png,button_on_png:bundles.main.frames.window_close_on_png,onClicked:this.close.bind(this)}),this.styles.CloseButton.relativeToScene?(this.addChild(e),e.setPositionRound(this.styles.CloseButton.relativeToScene)):(this.window.addChild(e),e.setPositionRound(this.window.width-e.width/2+t.offsetX,this.window.height-e.height/2+t.offsetY)),e.setLocalZOrder(this.styles.CloseButton.zOrder),this.closeButton=e},createHelpButton:function(e){var t=this.styles.HelpButton,n=new cleverapps.UI.Button({button_png:bundles.buttons_main.frames.help_button_png,button_on_png:bundles.buttons_main.frames.help_button_on_png,onClicked:e});n.setPositionRound(t),n.setLocalZOrder(t.zOrder),this.helpButton=n,
this.window.addChild(n)},createShareCheckBox:function(e,t){var n=!0;cleverapps.social.isLoggedIn()||(n=!1),e&&e.forEach(function(e){e instanceof ShareBonusButton&&e.shareBonus.type===cleverapps.ShareBonus.DIALOG&&(n=!1),e.doubleType===RewardWindow.DOUBLE_SHARE&&(n=!1)}),n&&(this.shareCheckBox=new ShareCheckBox(t,this))},getShareCheckBoxHeight:function(){return this.shareCheckBox?this.shareCheckBox.height+this.styles.ShareCheckBox.offsetBottom+this.styles.ShareCheckBox.offsetTop:0},onChangeBackground:function(e){this.decors&&this.decors.updateAll(),this.titleBg&&this.titleBg.setPositionRound(this.styles.Title.bg)},customizeContent:function(){},customize:function(){},onShow:function(){this.shareCheckBox&&this.shareCheckBox.updateState()},onHide:function(){},createBackground:function(e,t,n){var s;s=n.windowBg?n.windowBg:t.Background.image?t.Background.image:bundles.windows.frames.window_bg_png;var i=cleverapps.skins.getSlot("windowBg",{image:s,level:n.level}),
o=cleverapps.UI.createScale9Sprite(i,t.Background.scale9);return o.setContentSize2(e),t.Background.opacity&&o.setOpacity(t.Background.opacity),this.addChild(o),this.bg=o,t.Background.stitches&&new StitchesComponent(this.bg,t.Background.stitches),o},addForeground:function(e,t){"string"==typeof t&&(t={image:t});var n=cleverapps.UI.createScale9Sprite(t.image,cleverapps.UI.Scale9Rect.TwoPixelXY);return n.setAnchorPoint2(0,0),n.setPositionRound(0,0),n.setContentSize2(e.width,e.height),n.setLocalZOrder(1),e.addChild(n),n},createInnerBackground:function(){if(this.styles.Background.inner){var e=this.innerBg=cleverapps.UI.createScale9Sprite(bundles.main.frames.window_inner_bg_png);e.setContentSize2(this.window.width-2*this.styles.Background.inner.padding.x,this.window.height-2*this.styles.Background.inner.padding.y),this.window.addChild(e),e.setPositionRound(this.styles.Background.inner)}},calcBackgroundSize:function(e,t){var n=!this.withBg&&!(
this.styles.noBackground&&this.styles.noBackground.keepSize||t.noBackground&&t.noBackground.keepSize),s=e.width+(this.withBg&&!t.adjustToContent?2*this.styles.Border.x:0)+this.extraWidth,i=e.height+(n||t.adjustToContent?0:2*this.styles.Border.y)+this.extraHeight,o=void 0!==t.minHeight?t.minHeight:cleverapps.styles.Window.minHeight;i<o&&(i=o);var r=void 0!==t.minWidth?t.minWidth:cleverapps.styles.Window.minWidth;return s<r&&(s=r),cc.size(s,i)},touchInShadow:function(e){if(!this.initializedSuccess)return!1;if(this.window){var t=this.window.convertToNodeSpace(e.getLocation()),n=this.window.getContentSize();if(cc.rectContainsPoint(cc.rect(0,0,n.width,n.height),t))return!1}return!0},onTouchStart:function(e){return!!this.isVisible()&&(this.touchStartInShadow=this.touchInShadow(e),!0)},onTouchEnd:function(e){this.touchStartInShadow&&this.touchInShadow(e)&&this.onTouchInShadow(e)},addTitle:function(e){var t=e;e.text&&(t=e.text);var n=cleverapps.styles.FONTS.WINDOW_TITLE_TEXT;e.font&&(n=e.font)
;var s={};e.toReplace&&(s=e.toReplace);var i=this.styles.Title.offset||cleverapps.styles.Window.Title.offset;this.styles.Title.offsetY&&(i=this.styles.Title.offsetY);var o=this.styles.Title.offsetX?this.styles.Title.offsetX:0,r=cleverapps.UI.generateTTFText(t,n,s);r.setPositionRound(this.window.width/2-o,this.window.height-i),r.setAnchorPoint2(),r.setLocalZOrder(this.styles.Title.zIndex),this.window.titleText=r,this.window.addChild(r),this.setTitle(t,s)},setTitle:function(e,t){this.window.titleText&&(this.window.titleText.setString(e,t),!this.closeButton||this.closeButton instanceof BandButton?this.window.titleText.fitTo(this.window.width*this.styles.maxTitleSize.scale):this.window.titleText.fitTo(this.window.width-2*(this.closeButton.width+this.styles.titleCloseButtonMargin))),this.titleBg&&this.updateTitleBg()},updateTitleBg:function(){var e=this.styles.Title.bg;if(e.adjustToWindow){var t=this.window.width+e.adjustToWindow.width;!1===e.scale9?this.titleBg.setScale(
t/this.titleBg.width):this.titleBg.setContentSize2(t,this.titleBg.getContentSize().height),!this.closeButton||this.closeButton instanceof BandButton||!e.adjustToWindow.closeButtonOffset||this.closeButton.setPositionRound(this.titleBg.x+this.titleBg.width*this.titleBg.scaleX/2-this.closeButton.width/2+e.adjustToWindow.closeButtonOffset.x,this.titleBg.y+e.adjustToWindow.closeButtonOffset.y),this.helpButton&&e.adjustToWindow.helpButtonOffset&&this.helpButton.setPositionRound(this.titleBg.x-this.titleBg.width*this.titleBg.scaleX/2+this.helpButton.width/2+e.adjustToWindow.helpButtonOffset.x,this.titleBg.y+e.adjustToWindow.helpButtonOffset.y)}else if(e.adjustToText){this.titleBg.setContentSize(this.window.titleText.width+e.adjustToText.width,this.titleBg.height);var n=this.window.titleText.getPosition();e.adjustToText.offset&&(n.x+=e.adjustToText.offset.x,n.y+=e.adjustToText.offset.y),this.titleBg.setPositionRound(n),
!this.closeButton||this.closeButton instanceof BandButton||!e.adjustToText.closeButtonOffset||this.closeButton.setPositionRound(this.titleBg.x+this.titleBg.width/2-this.closeButton.width/2+e.adjustToText.closeButtonOffset.x,this.titleBg.y+e.adjustToText.closeButtonOffset.y),this.helpButton&&e.adjustToText.helpButtonOffset&&this.helpButton.setPositionRound(this.titleBg.x-this.titleBg.width/2+this.helpButton.width/2+e.adjustToText.helpButtonOffset.x,this.titleBg.y+e.adjustToText.helpButtonOffset.y)}else{t=this.window.titleText.getContentSize().width;t*=1.2;var s=this.styles.Title.bg.minWidth,i=this.styles.Title.bg.maxWidth;s&&t<s&&(t=s),i&&i<t&&(t=i),this.titleBg.scaleX=t/this.titleBg.width}this.decors&&this.decors.updateAll()}});cleverapps.styles.Window={shadow:!0,checkFitThreshold:10,maxTitleSize:{scale:.77},titleCloseButtonMargin:46,CloseButton:{offsetX:20,offsetY:20,zOrder:1},HelpButton:{zOrder:1,x:{align:"left",dx:70},y:{align:"top",dy:-45}},BottomButton:{width:void 0,height:void 0,
bottomPadding:50,padding:{x:30},marginX:30},minHeight:200,minWidth:240,contentOffset:16,windowShowUpAnimation:{name:"default",force:!1},Background:{image:bundles.windows.frames.window_bg_png,scale9:cleverapps.UI.Scale9Rect.Default,paddingX:15,paddingY:40},Title:{offset:70,zIndex:2},Border:{x:75,y:150},ShareCheckBox:{offsetBottom:15,offsetTop:-20},closeAnimation:{duration:200}},Window.prototype.onPopUpAnimationFinished=function(){},Window.prototype.popUpAnimation=function(){var e=this.chooseAnimation();e?(this.window&&this.window.stopAllActions(),e.open.call(this,this.onPopUpAnimationFinished.bind(this))):this.onPopUpAnimationFinished()},Window.prototype.closeAnimation=function(e){cleverapps.audio.playSound(bundles.main.urls.close_window_effect||bundles.main.urls.window_effect);var t=this.chooseAnimation();!t||0<cleverapps.windows.list.length&&!this.styles.windowShowUpAnimation.force?e():(this.window&&this.window.stopAllActions(),cc.eventManager.removeListeners(this,!0),t.close.call(
this,e))},Window.prototype.chooseAnimation=function(){var e=this.styles;if(e.windowShowUpAnimation&&(this.window||this instanceof Force))return this.bg||e.windowShowUpAnimation.force?WINDOW_ANIMATIONS[e.windowShowUpAnimation.name]:WINDOW_ANIMATIONS.default},Window.prototype.closeDuration=function(){return(this.styles||cleverapps.styles.Window).closeAnimation.duration},cleverapps.overrideFonts(cleverapps.styles.FONTS,{WINDOW_TITLE_TEXT:{size:70,color:cleverapps.styles.COLORS.COLOR_BROWN}});var BottomButton=cleverapps.UI.Button.extend({ctor:function(e,t){var n=cleverapps.styles.Window.BottomButton;t.onClicked=function(){!1!==e.visible?t.onPressed?t.onPressed():e.close():console.log("Blocked onClick as invisible")}.bind(this),t.font=t.font||cleverapps.styles.FONTS.BUTTON_TEXT,t.texType=t.hasOwnProperty("texType")?t.texType:n.texType,t.width=t.width||n.width,t.height=t.height||n.height,t.padding=t.padding||n.padding,this._super(t)}}),reportAboutNoWebGLThrottle=cleverapps.throttle(1e4,
function(e){cleverapps.ReportStream.debug(["checkGLErrorDebug: afterCreateProgramObj ","isUndefined "+(void 0===e._programObj),"is WebGLProgram "+(e._programObj instanceof WebGLProgram)])});cc.checkGLErrorDebug=function(e,t){if(cc._renderType===cc.game.RENDER_TYPE_WEBGL){var n=cc._renderContext.getError();n||"afterCreateProgramObj"!==t||e._programObj instanceof WebGLProgram||(n="notWebGLProgram"),n&&!cc.sys.isNative&&(alert("An error occurred"),window.location.reload())}};var checkBrokenLink=function(e,t){e||0===t.length||null===e||(console.log(t),cleverapps.throwAsync("broken frame: "+e))};if(cc.Scale9Sprite.prototype.ctor=cleverapps.extendFunc(cc.Scale9Sprite.prototype.ctor,function(e){checkBrokenLink(e,arguments);var t=isVirtualLink(e)?e:e&&e.virtualFrameName;this._super.apply(this,arguments),this.virtualFrameName=t}),cc.Sprite.prototype.ctor=cleverapps.extendFunc(cc.Sprite.prototype.ctor,function(e){checkBrokenLink(e,arguments);var t,n=isVirtualLink(e)?e:e&&e.virtualFrameName
;0<arguments.length&&"string"==typeof e&&(e=t=processVirtualImage(e)),this._super.apply(this,arguments),this.virtualFrameName=n,this.spriteFrameName=t}),cc.Sprite.prototype.setSpriteFrame=cleverapps.extendFunc(cc.Sprite.prototype.setSpriteFrame,function(e){return checkBrokenLink(e,arguments),this.virtualFrameName=isVirtualLink(e)?e:e&&e.virtualFrameName,"string"==typeof(e=processVirtualImage(e))&&0===e.indexOf("#")&&(e=e.substr(1,e.length-1)),this.spriteFrameName=e&&e.spriteFrameName||e,this._super.call(this,e)}),cc.Sprite.prototype.getSpriteFrame=cleverapps.extendFunc(cc.Sprite.prototype.getSpriteFrame,function(){var e=this._super.call(this);return e&&(e.spriteFrameName=this.spriteFrameName,e.virtualFrameName=this.virtualFrameName),e}),cc.Sprite.prototype.refreshVirtualSpriteFrame=function(){this.virtualFrameName&&this.setSpriteFrame(this.virtualFrameName)},cc.Scale9Sprite.prototype.setSpriteFrame=cleverapps.extendFunc(cc.Scale9Sprite.prototype.setSpriteFrame,function(e){
return checkBrokenLink(e,arguments),this.virtualFrameName=isVirtualLink(e)?e:e&&e.virtualFrameName,this.spriteFrameName="string"==typeof e?e:e&&e.spriteFrameName,this._super.call(this,e)}),cc.Scale9Sprite.prototype.refreshVirtualSpriteFrame=function(){this.virtualFrameName&&this.setSpriteFrame(cc.spriteFrameCache.getSpriteFrame(this.virtualFrameName))},cc.spriteFrameCache.getSpriteFrame=cleverapps.extendFunc(cc.spriteFrameCache.getSpriteFrame,function(e){var t=isVirtualLink(n)?e:"";"string"==typeof(e=processVirtualImage(e))&&0===e.indexOf("#")&&(e=e.substr(1,e.length-1));var n=this._super.call(this,e);return n&&(n.spriteFrameName=e,n.virtualFrameName=t),n}),cleverapps.styles.FONTS.SYSTEM={type:{name:"Arial"},size:20,color:cleverapps.styles.COLORS.BLACK},cc.Node.prototype.replaceParent=function(e){this.removeFromParent(!1),e.addChild(this)},cc.Node.prototype.adjustScaleTo=function(e){for(var t=1;e;)t/=e.scale,e=e.parent;for(var n=this;n;)t*=n.scale,n=n.parent;return t},
cc.Node.prototype.replaceParentSamePlace=function(e,t){t&&t.keepScale&&this.setScale(this.adjustScaleTo(e));var n=e.convertToNodeSpace(this.parent.convertToWorldSpace(this.getPosition()));this.replaceParent(e),this.setPosition(n)},cc.Node.prototype.debugGetName=function(){var n=this.constructor,s="[unknown]";return[window,cc,ccui,cleverapps,cleverapps.UI,sp,levels].forEach(function(e){for(var t in e)if(e[t]===n){s=t;break}}),s},cc.Node.prototype.debugParents=function(){for(var e=[],t=this;t;)e.push(t.debugGetName()),t=t.parent;console.log("window.debug -> "+e.join("->"))},cc.Node.prototype.debugBorder=function(e){window.debug=this,e=e||{},(selectedNode=this).debugBorderDx=this.debugBorderDx||0,this.debugBorderDy=this.debugBorderDy||0;var i=function(e){return+e.toFixed(2)},t=function(e){var t=this.getBoundingBox();return[i(t.width)+"x"+i(t.height)+" ("+this.width+"x"+this.height+")","scale: "+this.scaleX+" x "+this.scaleY,"pos: "+this.x+" x "+this.y,
"offset: "+this.debugBorderDx+" x "+this.debugBorderDy,"rotation "+this.rotation].join(e)}.bind(this);"object"==typeof selectedNode&&"function"==typeof selectedNode.unselect&&selectedNode!==this&&selectedNode.unselect();var n=function(e,t){var n=0<=e?1:-1,s=i(Math.abs(e)+t);return s<=0?e:s*n},s=function(){console.log(t("\t")),this.labelSavedPtr&&e.showPosition&&this.labelSavedPtr.setString(t("\n"))}.bind(this);if(this.debugBorderKeyboardListener=cc.EventListener.create({event:cc.EventListener.KEYBOARD,onKeyPressed:function(e){if(-1!==[cc.KEY.up,cc.KEY.down,cc.KEY.right,cc.KEY.left].indexOf(e)){if(window.keyboardAnchorsMode){switch(e){case cc.KEY.left:this.anchorX-=.01,this.debugBorderDx-=.01;break;case cc.KEY.right:this.anchorX+=.01,this.debugBorderDx-=.01;break;case cc.KEY.down:this.anchorY-=.01,this.debugBorderDy-=.01;break;case cc.KEY.up:this.anchorY+=.01,this.debugBorderDy-=.01}console.log("anchors: "+Math.floor(100*this.anchorX)/100+" x "+Math.floor(100*this.anchorY
)/100+"\toffsets: "+Math.floor(100*this.debugBorderDx)/100+" x "+Math.floor(100*this.debugBorderDy)/100)}else if(cleverapps.keyboardController.isPressed(cc.KEY.r)){switch(e){case cc.KEY.down:case cc.KEY.left:--this.rotation;break;case cc.KEY.up:case cc.KEY.right:++this.rotation}s()}else if(cleverapps.keyboardController.isPressed(cc.KEY.s)){switch(e){case cc.KEY.up:this.scaleX=n(this.scaleX,.05),this.scaleY=n(this.scaleY,.05);break;case cc.KEY.down:this.scaleX=n(this.scaleX,-.05),this.scaleY=n(this.scaleY,-.05)}s()}else{var t=cleverapps.keyboardController.isPressed(cc.KEY.shift)?10:1;switch(e){case cc.KEY.left:this.x-=t,this.debugBorderDx-=t;break;case cc.KEY.right:this.x+=t,this.debugBorderDx+=t;break;case cc.KEY.down:this.y-=t,this.debugBorderDy-=t;break;case cc.KEY.up:this.y+=t,this.debugBorderDy+=t}s()}this.onArrowPressed&&this.onArrowPressed(e)}}.bind(this)}),cc.eventManager.addListener(this.debugBorderKeyboardListener,this),!this.spriteSavedPtr){
var o=cleverapps.UI.createScale9Sprite(bundles.dev_resources.frames.border,cleverapps.UI.Scale9Rect.TwoPixelY);o.setAnchorPoint2(0,0),o.setContentSize(this.getContentSize()),this.spriteSavedPtr=o;var r=[new cc.Color(255,0,0,255),new cc.Color(255,0,255,0),new cc.Color(255,255,0,0)];o.setColor(cleverapps.Random.choose(r,this.debugGetName().length)),this.addChild(o),o.setLocalZOrder(10)}if(!this.labelSavedPtr){var a;a=e.labelText?e.labelText:e.showZOrder?this.getLocalZOrder():e.showPosition?t("\n"):this.getContentSize().width+" x "+this.getContentSize().height+" "+this.debugGetName();var c=cleverapps.UI.generateTTFText(a,cleverapps.styles.FONTS.SYSTEM);c.setAnchorPoint2(0,0),c.setPosition(0,this.getContentSize().height),(this.labelSavedPtr=c)._super_setString=c.setString,c.setString=function(){c._super_setString.apply(c,arguments),c.setScaleX(Math.abs(c.scaleX)*this.scaleX<0?-1:1),c.setScaleY(Math.abs(c.scaleY)*this.scaleY<0?-1:1)}.bind(this),c.setScaleX(Math.abs(c.scaleX
)*this.scaleX<0?-1:1),c.setScaleY(Math.abs(c.scaleY)*this.scaleY<0?-1:1),this.addChild(c),c.setLocalZOrder(10)}e.noResLinks||this.showUnpackedRes()},cc.Node.prototype.runForAllChildren=function(t,n){var s=0,i=function(e){s++,e.getChildrenCount()&&e.getChildren().forEach(function(e){t(e),(!n.depth||s<n.depth)&&i(e)})};(n=n||{}).selfRun&&t(this),i(this)},cc.Node.prototype.showUnpackedRes=function(){if(void 0!==unpackedMap){var r=0,a=function(e){if(e.getChildrenCount()&&r++<10&&e.getChildren().forEach(function(e){a(e)}),e.constructor===cc.Sprite||e.constructor===cc.Scale9Sprite){var t=processVirtualImage(e.spriteFrameName);if(t)if("#"!==t[0]&&(t="#"+t),i=unpackedMap[t]){var n=i.indexOf("/"),s="https://github.com/rvvslv/"+i.substring(0,n)+"/tree/master"+i.substring(n);console.log(e.spriteFrameName+"\n"+s)}}if(e.constructor===sp.SkeletonAnimation){var i,o=processVirtualJson(e.jsonName);if(o)if(i=unpackedMap[o]){n=i.indexOf("/"),s="https://github.com/rvvslv/"+i.substring(0,n
)+"/tree/master"+i.substring(n,i.lastIndexOf("/"));console.log(e.jsonName.substring(0,e.jsonName.lastIndexOf("-"))+".json\n"+s)}}};a(this)}},cc.Node.prototype.cleanupBorder=function(){this.spriteSavedPtr&&(this.spriteSavedPtr.removeFromParent(),delete this.spriteSavedPtr),this.labelSavedPtr&&(this.labelSavedPtr.removeFromParent(),delete this.labelSavedPtr),cc.eventManager.removeListener(this.debugBorderKeyboardListener),"object"==typeof selectedNode&&selectedNode===this&&(selectedNode=void 0),window.debug===this&&(window.debug=void 0)},cc.Node.prototype.isRunningSafe=function(){return this.runningSafe&&this.isRunning()},cc.Node.listener=function(e){return function(){if(!this.stopListeners)return e.apply(this,arguments)}},cc.Node.prototype.createListener=function(e){var t=this;return this.registerCleanupCallback(function(){e=t=void 0}),function(){if(e&&t&&!t.stopListeners)return e.apply(t,arguments)}},cc.Node.prototype.hasTouch=function(e){if(!this.visible)return!1
;var t=this.convertTouchToNodeSpace(e);return cc.rectContainsPoint(cc.rect(0,0,this.width,this.height),t)},cc.Node.prototype.createListener_onExitTransitionDidStart=cc.Node.prototype.onExitTransitionDidStart,cc.Node.prototype.onExitTransitionDidStart=function(){this.stopListeners=!0,this.runningSafe=!1,this._cropContainerDirty=!0,this.createListener_onExitTransitionDidStart()},cc.Node.RegisterShowAffected=function(e){},cleverapps.config.debugMode&&!cc.sys.isNative){var showDrawCalls=void 0;cc.Node.prototype.showDrawCall=function(e){void 0!==showDrawCalls&&((showDrawCalls[this.__instanceId]=this).numberOfDraw=cc.g_NumberOfDraws,this.drawStack=(new Error).stack,this.drawInfo=JSON.stringify(e))};var analyzeDrawCalls=function(){cleverapps.values(showDrawCalls).sort(function(e,t){return e.numberOfDraw-t.numberOfDraw}).forEach(function(e){e.debugBorder({labelText:e.numberOfDraw,noResLinks:!0});var t=e.numberOfDraw+" "+e.debugGetName();e instanceof cc.LabelTTF&&(t+=" "+e.getString()),
"string"==typeof e.spriteFrameName&&(t+=" "+e.spriteFrameName),"string"==typeof e.jsonName&&(t+=" "+e.jsonName),e.drawInfo&&(t+=" drawInfo - "+e.drawInfo,delete e.drawInfo),"SkeletonAnimation"===e.debugGetName()&&(t+=" stack - "+e.drawStack),console.log(t)}),console.log(Object.keys(showDrawCalls).length+" draw calls"),console.log(cc.g_NumberOfVertexes+" vertexes")};cc.eventManager.addListener(cc.EventListener.create({event:cc.EventListener.KEYBOARD,isTextsVisible:!0,onKeyPressed:function(e){var t=cleverapps.keyboardController.isPressed(cc.KEY.ctrl);t&&e===cc.KEY.q?void 0===showDrawCalls?(showDrawCalls={},setTimeout(analyzeDrawCalls,100)):(cleverapps.values(showDrawCalls).forEach(function(e){e.cleanupBorder()}),showDrawCalls=void 0):t&&e===cc.KEY.y?(this.isTextsVisible?$(cc.LabelTTF).filter(function(e){return cc.rectIntersectsRect(e.getBoundingBoxToWorld(),cc.director.getRunningScene().getBoundingBox())}).hide():$(cc.LabelTTF).show(),this.isTextsVisible=!this.isTextsVisible
):e===cc.KEY.Delete&&(window.debug&&window.debug.onDeletePressed?window.debug.onDeletePressed():window.debug&&window.debug.removeFromParent&&(window.debug.removeFromParent(),window.debug=void 0))}}),2);var matchedDebugNodes=[];cc.eventManager.addListener(cc.EventListener.create({event:cc.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:!0,processTouch:function(t){if(t&&t.visible&&!(void 0!==EditorScene&&t instanceof EditorScene)&&(t.hasTouch(this.touch)&&!this.excluded.some(function(e){return t instanceof e})&&(this.matchedNode=t,this.preferred.some(function(e){return t instanceof e})&&(this.preferredNode=t)),t.children))for(var e=0;e<t.children.length&&!this.preferredNode;e++)this.processTouch(t.children[e])},onTouchBegan:function(e){var t=cleverapps.keyboardController.isPressed(cc.KEY.ctrl),n=cleverapps.keyboardController.isPressed(cc.KEY.shift),s=cleverapps.keyboardController.isPressed(cc.KEY.c),i=cleverapps.keyboardController.isPressed(cc.KEY.a);return this.matchedNode=void 0,
this.preferredNode=void 0,this.touch=e,this.excluded=[SideBarView,cleverapps.UI.ScrollView,cleverapps.UI.ScrollBarContainer],void 0!==CenterHint&&this.excluded.push(CenterHint),"undefined"!=typeof KeypadView&&this.excluded.push(KeypadView),void 0!==FireworksAnimation&&this.excluded.push(FireworksAnimation),void 0!==MergeTutorialView&&this.excluded.push(MergeTutorialView),i||this.excluded.push(cleverapps.Spine,sp.SkeletonAnimation),this.preferred=[],void 0!==UnitView&&this.preferred.push(UnitView),s?(this.processTouch(cc.director.getRunningScene()),!!(this.matchedNode&&void 0!==UnitView&&this.matchedNode instanceof UnitView)&&(Game.currentGame.addUnits(new Unit(this.matchedNode.unit)),!0)):(t||n)&&(t&&(matchedDebugNodes.forEach(function(e){e.cleanupBorder()}),matchedDebugNodes=[]),this.processTouch(cc.director.getRunningScene()),this.matchedNode)?(this.matchedNode.debugParents(),this.matchedNode.debugBorder({showPosition:!0}),matchedDebugNodes.push(this.matchedNode),!0):(
matchedDebugNodes.length&&(matchedDebugNodes.forEach(function(e){e.cleanupBorder()}),matchedDebugNodes=[]),!1)}}),-100)}cc.Node.prototype.createListener_onEnterTransitionDidFinish=cc.Node.prototype.onEnterTransitionDidFinish,cc.Node.prototype.onEnterTransitionDidFinish=function(){this.stopListeners=!1,this.runningSafe=!0,cc.Node.prototype.createListener_onEnterTransitionDidFinish.apply(this,arguments),"function"!=typeof this.listNodeBundles||this.nodeBundles||(this.nodeBundles=this.listNodeBundles()||[],cleverapps.bundleLoader.loadBundles(this.nodeBundles)),cc.Node.RegisterShowAffected(this)},cc.Node.prototype.createListener_cleanup=cc.Node.prototype.cleanup,cc.Node.prototype.cleanup=function(){this.stopListeners=!0,this.runningSafe=!1,this.runCleanupCallbacks(),this.createListener_cleanup(),this.nodeBundles&&(cleverapps.bundleLoader.deleteBundles(this.nodeBundles),delete this.nodeBundles)},cc.Node.prototype.registerTarget=function(e,t){(e[t=t||"target"]=this).registerCleanupCallback(
function(){this===e[t]&&delete e[t]}.bind(this))},cc.Node.prototype.registerCleanupCallback=function(e){this.cleanupCallbacks||(this.cleanupCallbacks=[]),this.cleanupCallbacks.push(e)},cc.Node.prototype.runCleanupCallbacks=function(){(this.cleanupCallbacks||[]).forEach(function(e){e()}),this.cleanupCallbacks=[]};var oldAddChild=cc.Node.prototype.addChild;if(cc.Node.prototype.addChild=function(e){oldAddChild.apply(this,arguments),e.alignment&&e.setPositionRound(e.alignment),e.hideHandler&&e.hideHandler.initialize()},cc.Node.prototype.calculatePositionRound=function(e,t){if(Array.isArray(e)&&(e=e[cleverapps.wideMode.mode]),void 0===t&&(t=e.y,e=e.x),"object"==typeof e||"object"==typeof t){if(!this.parent)return cc.p(e,t);var n=this.parent.getContentSize();"object"==typeof e&&(e=this.calculateCoordinate(e,"x",n.width)),"object"==typeof t&&(t=this.calculateCoordinate(t,"y",n.height))}return cc.p(Math.floor(e),Math.floor(t))},cc.Node.prototype.setPositionRound=function(e,t){
var n=this.calculatePositionRound(e,t);"object"!=typeof n.x&&"object"!=typeof n.y||this.parent?this.setPosition(n.x,n.y):this.alignment=n},cc.Node.prototype.calculateCoordinate=function(t,e,n){if(t.random){var s=void 0!==t.random.start?t.random.start:0,i=void 0!==t.random.end?t.random.end:n;return Math.round(Math.random()*(i-s)+s)}var o="x"===e?this.getAnchorPoint().x:this.getAnchorPoint().y,r="x"===e?"dx":"dy",a=0;Object.keys(t).forEach(function(e){0===e.indexOf(r)&&(a+=t[e])});var c="x"===e?this.width*Math.abs(this.scaleX):this.height*Math.abs(this.scaleY);switch(t.align||"center"){case"left":case"bottom":a+=Math.abs(o)<.1?0:Math.abs(o-1)<.1?c:c/2,"center"===t.anchor&&(a-=c/2);break;case"center":a+=n/2+(Math.abs(o)<.1?-c/2:Math.abs(o-1)<.1?c/2:0);break;case"right":case"top":a+=n+(Math.abs(o)<.1?-c:Math.abs(o-1)<.1?0:-c/2),"center"===t.anchor&&(a+=c/2)}return a},cc.Node.prototype.getRelativeCoordinates=function(e){
var t=e.hideHandler&&e.hideHandler.originalPosition||e.originalPosition||e.getPosition();return this.getParent().convertToNodeSpace(e.getParent().convertToWorldSpace(t))},cc.Node.prototype.setAnchorPoint2=function(e,t){void 0===e&&(e=.5),void 0===t&&(t=.5),0<this.width&&(e=Math.round(this.width*e)/this.width),0<this.height&&(t=Math.round(this.height*t)/this.height),this.setAnchorPoint(e,t)},cc.Node.prototype.setContentSize2=function(e,t){Array.isArray(e)&&(e=e[cleverapps.wideMode.mode]),void 0===t&&(t=e.height,e=e.width),this.setContentSize(2*Math.round(e/2),2*Math.round(t/2))},cc.Node.prototype.setScale2=function(e){Array.isArray(e)&&(e=e[cleverapps.wideMode.mode]),this.setScale(e)},cc.Node.prototype.isDisplayed=function(){for(var e=this;e;){if(!e.isVisible())return!1;e=e.getParent()}return!0},cc.Node.prototype.setVisibleAsync=function(e,t){"function"!=typeof(t=t||this).setVisible&&(t=this),this.runAction(new cc.CallFunc(function(){t.setVisible(e)}))},
cc.Node.prototype.runAsync=function(e){this.runAction(new cc.CallFunc(e))},cc.Sprite.prototype.setSpriteFrameAsync=function(e){this.runAction(new cc.CallFunc(function(){this.setSpriteFrame(e)}.bind(this)))},cc.pRound=function(e,t){return void 0===t&&(t=e.y,e=e.x),"number"==typeof e&&(e=Math.floor(e)),"number"==typeof t&&(t=Math.floor(t)),cc.p(e,t)},cc.sizeRound=function(e,t){return void 0===t&&(t=e.height,e=e.width),cc.size(e,t)},cc.size2=function(e,t){return void 0===t&&(t=e.height,e=e.width),cc.size(2*Math.round(e/2),2*Math.round(t/2))},cc.Node.prototype.applyStyles=function(e){var t=new cc.Node;return e.size&&t.setContentSize2(e.size),this.setPositionRound(t.width/2,t.height/2),t.addChild(this),t},cc.Node.superClassCreateFunction=function(t){function e(e){return cleverapps.gameSceneLogs.push("arguments in superClassCreateFunction arg0: "+!!e[0]+" arg1: "+!!e[1]+" argsLength: "+e.length),t.apply(this,e)}return e.prototype=t.prototype,function(){return new e(arguments)}},
cc.Node.prototype.getBoundingBox=function(){var e=this.scaleX,t=this.scaleY,n=this.baseScaleX||this.baseScale||e,s=this.baseScaleY||this.baseScale||t,i=e!==n||t!==s;i&&this.setScale(n,s);var o=cc.rect(0,0,this._contentSize.width,this._contentSize.height),r=cc._rectApplyAffineTransformIn(o,this.getNodeToParentTransform());return i&&this.setScale(e,t),r},cc.Node.prototype.getGlobalBoundingBox=function(e,t){e||(e=this.getBoundingBox(),this.originalPosition&&(e.x+=this.originalPosition.x-this.x,e.y+=this.originalPosition.y-this.y)),t=t||this.getParent();var n=cc.director.getRunningScene().scene.convertToNodeSpace(t.convertToWorldSpace(cc.p(e.x,e.y)));return e.x=n.x,e.y=n.y,e},cc.Node.prototype.setOverShadow=function(e){this.overShadow!==e&&(this.overShadow=e,this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty),cc.renderer.childrenOrderDirty=!0,this.overShadow?this.visit=cc.Node.prototype.visitAfterShadow:this.visit=cc.Node.prototype.visit,this.setListenersOverShadow(e))},
cc.Node.prototype.setListenersOverShadow=function(e){this.listenersOverShadow!==e&&(this.listenersOverShadow=e,cc.eventManager._setDirty(cc.EventListener.TOUCH_ONE_BY_ONE,cc.eventManager.DIRTY_SCENE_GRAPH_PRIORITY),cc.eventManager._setDirty(cc.EventListener.MOUSE,cc.eventManager.DIRTY_SCENE_GRAPH_PRIORITY),cc.eventManager._setDirty(cc.EventListener.TOUCH_ALL_AT_ONCE,cc.eventManager.DIRTY_SCENE_GRAPH_PRIORITY))},cc.Node.prototype.visitAfterShadow=function(e){var t=cc.director.getRunningScene(),n=this,s=arguments,i=function(){cc.Node.prototype.visit.apply(n,s)};if(t.afterVisitShadowProcessing||!e)i();else{var o=e._renderCmd,r=o._dirtyFlag;t.shadowVisitQueue.push(function(){var e=o._dirtyFlag;o._dirtyFlag=r,i(),o._dirtyFlag=e})}},cc.Node.prototype.getCropContainer=function(){if(!1===this._cropContainerDirty)return this.cropContainer;for(var e=this;e&&!(e instanceof cleverapps.UI.ScrollView);)e=e.parent;return this._cropContainerDirty=!1,this.cropContainer=e,this.cropContainer},
cc.Node.prototype.setCascadeOpacityEnabledRecursively=function(t){this.performRecursive(function(e){e.setCascadeOpacityEnabled(t)})},cc.Node.prototype.setRecCascadeColorEnabled=function(){this.performRecursive(function(e){e.setCascadeColorEnabled(!0)})},cc.Node.prototype.performRecursive=function(e){for(var t=[this];0<t.length;){var n=t.pop();e(n),t=t.concat(n.children)}},cc.sys.isNative&&config.debugMode&&!cc.sys.isWebView&&(Function.prototype.debugBindSuper=Function.prototype.bind,Function.prototype.bind=function(e){if("object"!=typeof this.prototype)throw console.log("Function.this.prototype - is not an object",JSON.stringify((new Error).stack)),new TypeError("Function.this.prototype - is not an object");return Function.prototype.debugBindSuper.apply(this,arguments)}),config.debugMode)var previewRes=function(n){var e=(n=processVirtualImage(n)||processVirtualJson(n)).split(".").slice(-1)[0],s=function(e){var t=cc.director.getRunningScene();t.addChild(e),e.setPositionRound(t.width/2,
t.height/2)};if("json"===e){var t=function(){var e=new cleverapps.Spine(n),t=Object.keys(e.data.animations);e.setAnimation(0,t[0],!0),e.setSkin(cleverapps.Spine.getSkins(n)[0]||"default"),e.debugBorder(),s(e),console.log(t)};cleverapps.Spine.isAnimationLoaded(n)?t():cleverapps.bundleLoader.loadBundle(cleverapps.Spine.listBundles(n),{onSuccess:t})}else"png"!==e&&"jpg"!==e||s(cleverapps.UI.createScale9Sprite(n))},checkFonts=function(e){for(var t=[],n=15;n<90;n+=5){var s={name:e||"default",size:n||40,fnt:!0},i=cleverapps.UI.generateOnlyText("Some",s),o=cleverapps.UI.generateTTFText("1235",s),r=new cleverapps.Layout([i,o],{direction:cleverapps.UI.HORIZONTAL,margin:5});t.unshift(r)}var a=new cleverapps.Layout(t,{direction:cleverapps.UI.VERTICAL,margin:5});cc.director.getRunningScene().addChild(a),a.setPositionRound(cleverapps.UI.getSceneSize().width/2,cleverapps.UI.getSceneSize().height/2)};cc.CallFunc.prototype.initWithFunctionSuper=cc.CallFunc.prototype.initWithFunction,
cc.CallFunc.prototype.initWithFunction=function(e,t,n){var s=this.initWithFunctionSuper.apply(this,arguments);return this._function&&!this._function.call&&cleverapps.throwAsync("no call method on CallFunc function"),s},cc.ACTION_TAG_SHOW=10,cc.ACTION_TAG_HIDE=11,cc.ACTION_TAG_PLAYERS_WARNING=13,cleverapps.Particles=cc.ParticleSystem.extend({ctor:function(e,t){var n=cc.loader.getRes(processVirtualJson(e));n.textureFileName=t,this._super(n)},stop:function(e){e=e||function(){},delete this.target,this.setAutoRemoveOnFinish(!0),this.stopSystem(),this.runAction(new cc.Sequence(new cc.DelayTime(3),new cc.CallFunc(e),new cc.RemoveSelf))},followTarget:function(e){this.setPositionType(cc.ParticleSystem.TYPE_RELATIVE),this.target=e,this.updateRelativePosition(),e.registerCleanupCallback(function(){this.target===e&&this.stop()}.bind(this))},updateRelativePosition:function(){if(this.target&&this.getParent()&&this.target.getParent()){var e=this.getRelativeCoordinates(this.target)
;this.setPositionRound(e)}},update:function(e){this.updateRelativePosition(),this._super(e)}}),cleverapps.Spine=cc.Node.extend({ctor:function(e,t){this._super(),this.setAnchorPoint2(),e=cleverapps.skins.getSlot("spine",{json:e}),e=processVirtualJson(e);var n=cleverapps.Spine.jsonToBundle[e];if(!cleverapps.bundleLoader.isLoaded(n)&&"loading_scene"!==n){var s="Json "+e+" bundle "+n+" not loaded";console.log(s),e&&n&&cleverapps.ReportStream.debug(s)}if(void 0===n)throw console.log("json bundles cache",cleverapps.Spine.jsonToBundle),"Can't find bundle for json - "+e+" in bundles cache "+JSON.stringify(Object.keys(cleverapps.Spine.jsonToBundle)).substr(0,100);this.setCascadeOpacityEnabled(!0),this.setCascadeColorEnabled(!0),cc.loader.getRes(bundles[n].jsons.atlas)||cleverapps.ReportStream.debug("Atlas "+e+" bundle "+n+" not loaded");var i=e,o=bundles[n].jsons.atlas;t=t||1,cleverapps.Spine.cache[e]&&cleverapps.Spine.cache[e][t]&&(i=cleverapps.Spine.cache[e][t].data,
o=cleverapps.Spine.cache[e][t].atlas);var r=this.spine=sp.SkeletonAnimation.createWithJsonFile(i,o,t);for(var a in cleverapps.styles.SpineSkins)if(cleverapps.styles.SpineSkins[a].json===e){r.setSkin(cleverapps.styles.SpineSkins[a].skin);break}r.jsonName=e,cleverapps.Spine.cache[e]||(cleverapps.Spine.cache[e]={}),cleverapps.Spine.cache[e][t]||(cleverapps.Spine.cache[e][t]={data:r._skeletonData,atlas:!0}),this.data=cc.loader.getRes(e);var c=this.data.skeleton;this.setContentSize2(c.width*resolutionScale,c.height*resolutionScale),r.setPositionRound(this.width/2,this.height/2),this.addChild(r),this.runningAnimation=void 0,this.setVisible(!1),this.startVisibleListener=function(){},cleverapps.Spine.debugSlots&&this.setDebugSlots(!0),cleverapps.Spine.debugBones&&this.setDebugBones(!0)},setStartVisibleListener:function(e){this.startVisibleListener=e},setIdle:function(e){this.idle=e,void 0===this.runningAnimation&&this.setAnimation(0,this.idle,!0)},setIdleSet:function(n){var s=0
;cleverapps.values(n).forEach(function(e){s+=e});var e=function(){var e=Math.random()*s;for(var t in n)if((e-=n[t])<=0)return t};this.setAnimation(0,e(),!1),this.setCompleteListener(function(){this.setAnimation(0,e(),!1)}.bind(this))},setAnimation:function(e,t,n){this.spine.setAnimation(e,t,n);var s=this.spine.jsonName;if(!this.data.animations[t]){var i=(new Error).stack;setTimeout(function(){throw"Not found animation "+t+" in json "+s+" .. "+i},0)}this.visible||(this.visible=!0,this.startVisibleListener())},addAnimation:function(e,t,n,s){this.spine.addAnimation(e,t,n,s)},findAnimation:function(e){return this.spine.findAnimation(e)},setTimeScale:function(e){this.spine.setTimeScale(e)},getTimeScale:function(){return this.spine.getTimeScale()},clearTrack:function(e){this.spine.clearTrack(e)},setSkin:function(e){this.spine.setSkin(e)},setStartListener:function(e){this.spine.setStartListener(e)},setCompleteListener:function(e){this.spine.setCompleteListener(e)},
setCompleteListenerRemove:function(e){this.setCompleteListener(function(){e&&e(),this.runAction(new cc.RemoveSelf)}.bind(this))},setCompleteListenerOnce:function(e){this.setCompleteListener(function(){e(),this.setCompleteListener(function(){})}.bind(this))},setAnimationAndIdleAfter:function(e,t){this.setAnimation(0,e,!1),this.addAnimation(0,t,!0)},setDebugSlots:function(e){this.spine.setDebugSolots(e)},setDebugBones:function(e){this.spine.setDebugBones(e)},rotateMesh:function(t){this.setRotation(-t),this.runForAllChildren(function(e){e===this.spine?this.spine._skeleton.getRootBone().rotation=-t:e.setRotation(t)}.bind(this),{depth:1})}}),cleverapps.Spine.updateSkin=function(e,t,n){t=processVirtualJson(t),cleverapps.styles.SpineSkins[e]={json:t,skin:n}},cleverapps.Spine.hasAnimation=function(e,t){var n=cleverapps.Spine.getSkeletonData(t);return n&&n.animations&&void 0!==n.animations[e]},cleverapps.Spine.getSkins=function(e){var t=cleverapps.Spine.getSkeletonData(e);return Object.keys(
t.skins).filter(function(e){return"default"!==e})},cleverapps.Spine.getSkeletonData=function(e){return cc.loader.getRes(processVirtualJson(e))},cleverapps.Spine.isAnimationLoaded=function(e){return e=processVirtualJson(e),e=cleverapps.skins.getSlot("spine",{json:e}),cleverapps.bundleLoader.isLoaded(cleverapps.Spine.jsonToBundle[e])},cleverapps.Spine.prepare=function(){var e={};for(var t in bundles){var n=bundles[t];if(!n.injectTo&&(0!==t.indexOf("episode_")||1!==Object.keys(n.jsons).length||!n.jsons.levels))for(var s in n.jsons){var i=n.jsons[s],o=t;if(0===s.indexOf("island_")&&0===t.indexOf("episode_")&&(o="episodes_resources"),e[i]&&e[i]!==o)throw"Already exist json: "+i;e[i]=o}}cleverapps.Spine.jsonToBundle=e},cleverapps.Spine.listBundles=function(t){Array.isArray(t)||(t=[t]);var n=[];return t.forEach(function(e){t&&cleverapps.Spine.jsonToBundle[e]&&n.push(cleverapps.Spine.jsonToBundle[e])}),cleverapps.unique(n)},cleverapps.Spine.removeSlot=function(e,t){e=processVirtualJson(e),
e=cleverapps.skins.getSlot("spine",{json:e}),(e=cc.loader.getRes(e)).slots=e.slots.filter(function(e){return e.name!==t}),cleverapps.values(e.skins).forEach(function(e){delete e[t]}),cleverapps.values(e.animations).forEach(function(e){delete e.slots[t]})},cleverapps.Spine.cache={};var ShadowLayer=cc.LayerColor.extend({ctor:function(){var e=this.baseSize=cc.director.getWinSize();this._super(cleverapps.styles.COLORS.BLACK,1.05*e.width+5,1.05*e.height+5),this.setAnchorPoint2(0,0),this.setPosition(.025*-e.width-2,.025*-e.height-2),cleverapps.eventBus.on("changeSceneSize",this.onChangeSize.bind(this),this)},onChangeSize:function(){var e=cc.director.getWinSize(),t=Math.max(e.width/this.baseSize.width,this.baseSize.width/e.width),n=Math.max(e.height/this.baseSize.height,this.baseSize.height/e.height);this.setScale(t*n)},visit:function(e){if(this._super.apply(this,arguments),this.isVisible()){var t=cc.director.getRunningScene();t&&t.afterVisitShadow&&t.afterVisitShadow()}}})
;cc.eventManager._sortEventListenersOfSceneGraphPriorityDes=function(e,t){var n=cc.eventManager._nodePriorityMap,s=e._getSceneGraphPriority(),i=t._getSceneGraphPriority();if(!(t&&i&&n[i.__instanceId]))return-1;if(!e||!s||!n[s.__instanceId])return 1;var o=n[t._getSceneGraphPriority().__instanceId]-n[e._getSceneGraphPriority().__instanceId];return 0===o?e.__instanceId-t.__instanceId:o},cc.eventManager._visitTarget_processRoot=function(){var e=this._globalZOrderNodeMap,t=[];for(var n in e)t.push(n);t.sort(this._sortNumberAsc);var s,o,r=t.length,a=this._nodePriorityMap;for(i=0;i<r;i++)for(s=e[t[i]],o=0;o<s.length;o++)a[s[o]]=++this._nodePriorityIndex;this._globalZOrderNodeMap={}},cc.eventManager._visitTargetSuper=cc.eventManager._visitTarget,cc.eventManager._visitTarget=function(t,e){e&&(this.shadowVisitQueue=[]);var n=function(){this.visitQueueProcessing=!0;var e=this.shadowVisitQueue;this.shadowVisitQueue=[],e.forEach(cleverapps.callFunc),this.visitQueueProcessing=!1}.bind(this);if(
!t.overShadow||this.visitQueueProcessing){if(t.listenersOverShadow&&!this.visitQueueProcessing){var s=this._globalZOrderNodeMap;this.shadowVisitQueue.push(function(){var e=s[t.getGlobalZOrder()].indexOf(t.__instanceId);-1!==e&&s[t.getGlobalZOrder()].splice(e,1),s[t.getGlobalZOrder()].push(t.__instanceId)})}cc.eventManager._visitTargetSuper.apply(this,arguments),t instanceof ShadowLayer&&t.visible&&n(),e&&0<this.shadowVisitQueue.length&&(n(),this._visitTarget_processRoot())}else{var i=this,o=arguments;this.shadowVisitQueue.push(function(){cc.eventManager._visitTargetSuper.apply(i,o)})}},cc.game.pause=cleverapps.extendFunc(cc.game.pause,function(){this.isPaused()||(this._super.apply(this,arguments),cleverapps.eventBus.trigger("gamePause"))}),cc.game.resume=cleverapps.extendFunc(cc.game.resume,function(){this.isPaused()&&(this._super.apply(this,arguments),cleverapps.eventBus.trigger("gameResume"))}),cc.game.resumeNative=function(){this.config?this.isPaused()&&this.resume():setTimeout(
this.resumeNative.bind(this),1e3)},function(){var e=function(){cleverapps.newSceneStack=cleverapps.newSceneStack||(new Error).stack,this._super.apply(this,arguments)};cc.Director.prototype.runScene=cleverapps.extendFunc(cc.Director.prototype.runScene,e),cc.Director.prototype.popToSceneStackLevel=cleverapps.extendFunc(cc.Director.prototype.popToSceneStackLevel,e),cc.Director.prototype.pushScene=cleverapps.extendFunc(cc.Director.prototype.pushScene,e),cc.Director.prototype.popScene=cleverapps.extendFunc(cc.Director.prototype.popScene,e)}(),cc.getCenter=function(e){if(e&&0!==e.length){var t=0,n=0;return e.forEach(function(e){t+=e.x,n+=e.y}),cc.p(t/e.length,n/e.length)}},cc.getCenterPoint=function(e){if(e&&0!==e.length){var t=0,n=0;e.forEach(function(e){t+=e.x,n+=e.y});var s=cc.p(t/e.length,n/e.length),i=e[0],o=cc.pDistance(i,s);return e.forEach(function(e){var t=cc.pDistance(e,s);t<o&&(i=e,o=t)}),i}},cc.getDistanceChebyshev=function(e,t){return Math.max(Math.abs(e.x-t.x),Math.abs(e.y-t.y)
)},cc.rectScale=function(e,t){return cc.rect(e.x+e.width/2*(1-t),e.y+e.height/2*(1-t),e.width*t,e.height*t)};var UIScrollBarFix=function(){var e=function(e,t){var n=new Image;n.src=e,setTimeout(function(){cc.textureCache.cacheImage(t,n)},0)};e(ccui.ScrollViewBar.HALF_CIRCLE_IMAGE,ccui.ScrollViewBar.HALF_CIRCLE_IMAGE_KEY),e(ccui.ScrollViewBar.BODY_IMAGE_1_PIXEL_HEIGHT,ccui.ScrollViewBar.BODY_IMAGE_1_PIXEL_HEIGHT_KEY)};cc.KEYBOARD_RETURNTYPE_DEFAULT=0,cc.KEYBOARD_RETURNTYPE_DONE=1,cc.KEYBOARD_RETURNTYPE_SEND=2,cc.KEYBOARD_RETURNTYPE_SEARCH=3,cc.KEYBOARD_RETURNTYPE_GO=4,cc.EDITBOX_INPUT_MODE_ANY=0,cc.EDITBOX_INPUT_MODE_EMAILADDR=1,cc.EDITBOX_INPUT_MODE_NUMERIC=2,cc.EDITBOX_INPUT_MODE_PHONENUMBER=3,cc.EDITBOX_INPUT_MODE_URL=4,cc.EDITBOX_INPUT_MODE_DECIMAL=5,cc.EDITBOX_INPUT_MODE_SINGLELINE=6,cc.EDITBOX_INPUT_FLAG_PASSWORD=0,cc.EDITBOX_INPUT_FLAG_SENSITIVE=1,cc.EDITBOX_INPUT_FLAG_INITIAL_CAPS_WORD=2,cc.EDITBOX_INPUT_FLAG_INITIAL_CAPS_SENTENCE=3,
cc.EDITBOX_INPUT_FLAG_INITIAL_CAPS_ALL_CHARACTERS=4,cc.EditBoxDelegate=cc.Class.extend({editBoxEditingDidBegin:function(e){},editBoxEditingDidEnd:function(e){},editBoxTextChanged:function(e,t){},editBoxReturn:function(e){}}),cc.EditBox=cc.Node.extend({_backgroundSprite:null,_delegate:null,_editBoxInputMode:cc.EDITBOX_INPUT_MODE_ANY,_editBoxInputFlag:cc.EDITBOX_INPUT_FLAG_SENSITIVE,_keyboardReturnType:cc.KEYBOARD_RETURNTYPE_DEFAULT,_maxLength:50,_text:"",_textColor:null,_placeholderText:"",_placeholderFontName:"",_placeholderFontSize:14,_placeholderColor:null,_className:"EditBox",_touchListener:null,_touchEnabled:!0,ctor:function(e,t){cc.Node.prototype.ctor.call(this),this._anchorPoint=cc.p(.5,.5),this._textColor=cc.color.WHITE,this._placeholderColor=cc.color.GRAY,this._renderCmd._createLabels(),this.createDomElementIfNeeded(),this.initWithSizeAndBackgroundSprite(e,t),this._touchListener=cc.EventListener.create({event:cc.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:!0,
onTouchBegan:this._onTouchBegan.bind(this),onTouchEnded:this._onTouchEnded.bind(this)}),cc.eventManager.addListener(this._touchListener,this),this.setInputFlag(this._editBoxInputFlag)},setTouchEnabled:function(e){this._touchEnabled!==e&&(this._touchEnabled=e,this._touchEnabled?cc.eventManager.addListener(this._touchListener,this):cc.eventManager.removeListener(this._touchListener))},_createRenderCmd:function(){return cc._renderType===cc.game.RENDER_TYPE_CANVAS?new cc.EditBox.CanvasRenderCmd(this):new cc.EditBox.WebGLRenderCmd(this)},setContentSize:function(e,t){void 0!==e.width&&void 0!==e.height&&(t=e.height,e=e.width),cc.Node.prototype.setContentSize.call(this,e,t),this._updateEditBoxSize(e,t)},setVisible:function(e){cc.Node.prototype.setVisible.call(this,e),this._renderCmd.updateVisibility()},createDomElementIfNeeded:function(){this._renderCmd._edTxt||this._renderCmd._createDomTextArea()},setTabIndex:function(e){this._renderCmd._edTxt&&(this._renderCmd._edTxt.tabIndex=e)},
getTabIndex:function(){return this._renderCmd._edTxt?this._renderCmd._edTxt.tabIndex:(cc.warn("The dom control is not created!"),-1)},setFocus:function(){this._renderCmd._edTxt&&this._renderCmd._edTxt.focus()},isFocused:function(){return this._renderCmd._edTxt?document.activeElement===this._renderCmd._edTxt:(cc.warn("The dom control is not created!"),!1)},stayOnTop:function(e){this._alwaysOnTop!==e&&(this._alwaysOnTop=e,this._renderCmd.stayOnTop(this._alwaysOnTop))},cleanup:function(){this._super(),this._renderCmd._removeDomFromGameContainer()},_isAncestorsVisible:function(e){if(null==e)return!0;var t=e.getParent();return!(t&&!t.isVisible())&&this._isAncestorsVisible(t)},_onTouchBegan:function(e){if(this.isVisible()&&this._isAncestorsVisible(this)){var t=e.getLocation(),n=cc.rect(0,0,this._contentSize.width,this._contentSize.height);return!!cc.rectContainsPoint(n,this.convertToNodeSpace(t))||(this._renderCmd._endEditing(),!1)}},_onTouchEnded:function(){this.isVisible(
)&&this._isAncestorsVisible(this)&&this._renderCmd._beginEditing()},_updateBackgroundSpriteSize:function(e,t){this._backgroundSprite&&this._backgroundSprite.setContentSize(e,t)},_updateEditBoxSize:function(e,t){var n="number"==typeof e.width?e.width:e,s="number"==typeof e.height?e.height:t;this._updateBackgroundSpriteSize(n,s),this._renderCmd.updateSize(n,s)},setLineHeight:function(e){this._renderCmd.setLineHeight(e)},setFont:function(e,t){this._renderCmd.setFont(e,t)},_setFont:function(e){this._renderCmd._setFont(e)},getBackgroundSprite:function(){return this._backgroundSprite},setFontName:function(e){this._renderCmd.setFontName(e)},setFontSize:function(e){this._renderCmd.setFontSize(e)},setString:function(e){e.length>=this._maxLength&&(e=e.slice(0,this._maxLength)),this._text=e,this._renderCmd.setString(e)},setFontColor:function(e){this._textColor=e,this._renderCmd.setFontColor(e)},setMaxLength:function(e){isNaN(e)||(e<0&&(e=65535),this._maxLength=e,this._renderCmd.setMaxLength(e))},
getMaxLength:function(){return this._maxLength},setPlaceHolder:function(e){null!==e&&(this._renderCmd.setPlaceHolder(e),this._placeholderText=e)},setPlaceholderFont:function(e,t){this._placeholderFontName=e,this._placeholderFontSize=t,this._renderCmd._updateDOMPlaceholderFontStyle()},_setPlaceholderFont:function(e){var t=cc.LabelTTF._fontStyleRE.exec(e);t&&(this._placeholderFontName=t[2],this._placeholderFontSize=parseInt(t[1]),this._renderCmd._updateDOMPlaceholderFontStyle())},setPlaceholderFontName:function(e){this._placeholderFontName=e,this._renderCmd._updateDOMPlaceholderFontStyle()},setPlaceholderFontSize:function(e){this._placeholderFontSize=e,this._renderCmd._updateDOMPlaceholderFontStyle()},setPlaceholderFontColor:function(e){this._placeholderColor=e,this._renderCmd.setPlaceholderFontColor(e)},setInputFlag:function(e){this._editBoxInputFlag=e,this._renderCmd.setInputFlag(e)},getString:function(){return this._text},initWithSizeAndBackgroundSprite:function(e,t){
return this._backgroundSprite&&this._backgroundSprite.removeFromParent(),this._backgroundSprite=t,this.setContentSize(e),this._backgroundSprite&&!this._backgroundSprite.parent&&(this._backgroundSprite.setAnchorPoint(cc.p(0,0)),this.addChild(this._backgroundSprite),this._updateBackgroundSpriteSize(e.width,e.height)),this.x=0,!(this.y=0)},setDelegate:function(e){this._delegate=e},getPlaceHolder:function(){return this._placeholderText},setInputMode:function(e){if(this._editBoxInputMode!==e){var t=this.getString();this._editBoxInputMode=e,this._renderCmd.setInputMode(e),this._renderCmd.transform(),this.setString(t),this._renderCmd._updateLabelPosition(this.getContentSize())}},setReturnType:function(e){this._keyboardReturnType=e,this._renderCmd._updateDomInputType()},initWithBackgroundColor:function(e,t){this._edWidth=e.width,this.dom.style.width=this._edWidth.toString()+"px",this._edHeight=e.height,this.dom.style.height=this._edHeight.toString()+"px",
this.dom.style.backgroundColor=cc.colorToHex(t)}});var _p=cc.EditBox.prototype;_p.font,cc.defineGetterSetter(_p,"font",null,_p._setFont),_p.fontName,cc.defineGetterSetter(_p,"fontName",null,_p.setFontName),_p.fontSize,cc.defineGetterSetter(_p,"fontSize",null,_p.setFontSize),_p.fontColor,cc.defineGetterSetter(_p,"fontColor",null,_p.setFontColor),_p.string,cc.defineGetterSetter(_p,"string",_p.getString,_p.setString),_p.maxLength,cc.defineGetterSetter(_p,"maxLength",_p.getMaxLength,_p.setMaxLength),_p.placeHolder,cc.defineGetterSetter(_p,"placeholder",_p.getPlaceHolder,_p.setPlaceHolder),_p.placeHolderFont,cc.defineGetterSetter(_p,"placeholderFont",null,_p._setPlaceholderFont),_p.placeHolderFontName,cc.defineGetterSetter(_p,"placeholderFontName",null,_p.setPlaceholderFontName),_p.placeHolderFontSize,cc.defineGetterSetter(_p,"placeholderFontSize",null,_p.setPlaceholderFontSize),_p.placeHolderFontColor,cc.defineGetterSetter(_p,"placeholderFontColor",null,_p.setPlaceholderFontColor),
_p.inputFlag,cc.defineGetterSetter(_p,"inputFlag",null,_p.setInputFlag),_p.delegate,cc.defineGetterSetter(_p,"delegate",null,_p.setDelegate),_p.inputMode,cc.defineGetterSetter(_p,"inputMode",null,_p.setInputMode),_p.returnType,cc.defineGetterSetter(_p,"returnType",null,_p.setReturnType),_p=null,cc.EditBox.create=function(e,t,n,s){return new cc.EditBox(e,t,n,s)},function(e){e._polyfill={zoomInvalid:!1},cc.sys.OS_ANDROID!==cc.sys.os||cc.sys.browserType!==cc.sys.BROWSER_TYPE_SOUGOU&&cc.sys.browserType!==cc.sys.BROWSER_TYPE_360||(e._polyfill.zoomInvalid=!0)}(cc.EditBox),function(v){function n(e){var t=e.convertToWorldSpace(cc.p(0,0)),n=cc.visibleRect.height,s=cc.visibleRect.width,i=.5;n<s&&(i=.7),setTimeout(function(){if(window.scrollY<40&&t.y<n*i){var e=n*i-t.y-window.scrollY;e<35&&(e=35),320<e&&(e=320),window.scrollTo(e,e)}},400)}var e=function(){}.prototype=Object.create(Object.prototype);e.updateMatrix=function(){if(this._edTxt){var e=this._node,t=cc.view._scaleX,n=cc.view._scaleY,
s=cc.view._devicePixelRatio,i=this._worldTransform;t/=s,n/=s;var o=cc.game.container,r=i.a*t,a=i.b,c=i.c,l=i.d*n,p=o&&o.style.paddingLeft&&parseInt(o.style.paddingLeft),d=o&&o.style.paddingBottom&&parseInt(o.style.paddingBottom),u=i.tx*t+p,h=i.ty*n+d;v.zoomInvalid&&(this.updateSize(e._contentSize.width*r,e._contentSize.height*l),l=r=1);var g="matrix("+r+","+-a+","+-c+","+l+","+u+","+-h+")";this._edTxt.style.transform=g,this._edTxt.style["-webkit-transform"]=g,this._edTxt.style["transform-origin"]="0px 100% 0px",this._edTxt.style["-webkit-transform-origin"]="0px 100% 0px"}},e.updateVisibility=function(){this._edTxt&&(this._node.visible?this._edTxt.style.visibility="visible":this._edTxt.style.visibility="hidden")},e.stayOnTop=function(e){e?(this._removeLabels(),this._edTxt.style.display=""):(this._createLabels(),this._edTxt.style.display="none",this._showLabels())},e._beginEditingOnMobile=function(e){this.__orientationChanged=function(){n(e)},window.addEventListener("orientationchange",
this.__orientationChanged),cc.view.isAutoFullScreenEnabled()?(this.__fullscreen=!0,cc.view.enableAutoFullScreen(!1),cc.screen.exitFullScreen()):this.__fullscreen=!1,this.__autoResize=cc.view.__resizeWithBrowserSize,cc.view.resizeWithBrowserSize(!1)},e._endEditingOnMobile=function(){if(this.__rotateScreen){var e=cc.game.container.style;e["-webkit-transform"]="rotate(90deg)",e.transform="rotate(90deg)";var t=cc.view,n=t._originalDesignResolutionSize.width,s=t._originalDesignResolutionSize.height;0<n&&t.setDesignResolutionSize(n,s,t._resolutionPolicy),this.__rotateScreen=!1}window.removeEventListener("orientationchange",this.__orientationChanged),window.scrollTo(0,0),this.__fullscreen&&cc.view.enableAutoFullScreen(!0),this.__autoResize&&cc.view.resizeWithBrowserSize(!0)},e._onFocusOnMobile=function(e){if(cc.view._isRotated){var t=cc.game.container.style;t["-webkit-transform"]="rotate(0deg)",t.transform="rotate(0deg)",t.margin="0px",window.scrollTo(35,35),this.__rotateScreen=!0
}else this.__rotateScreen=!1;n(e)},e._createDomInput=function(){this._removeDomFromGameContainer();var n=this,e=this._edTxt=document.createElement("input");return e.type="text",e.style.fontFamily=this._edFontName,e.style.fontSize=this._edFontSize+"px",e.style.color="#000000",e.style.border=0,e.style.background="transparent",e.style.width="100%",e.style.height="100%",e.style.active=0,e.style.outline="medium",e.style.padding="0",e.style.textTransform="uppercase",e.style.display="none",e.style.position="absolute",e.style.bottom="0px",e.style.left="2px",e.style.className="cocosEditBox",this.setMaxLength(n._editBox._maxLength),e.addEventListener("input",function(){var e=n._editBox;this.value.length>this.maxLength&&(this.value=this.value.slice(0,this.maxLength)),e._delegate&&e._delegate.editBoxTextChanged&&e._text!==this.value&&(e._text=this.value,n._updateDomTextCases(),e._delegate.editBoxTextChanged(e,e._text))}),e.addEventListener("keypress",function(e){var t=n._editBox
;e.keyCode===cc.KEY.enter&&(e.stopPropagation(),e.preventDefault(),""===this.value&&(this.style.fontSize=t._placeholderFontSize+"px",this.style.color=cc.colorToHex(t._placeholderColor)),t._text=this.value,n._updateDomTextCases(),n._endEditing(),t._delegate&&t._delegate.editBoxReturn&&t._delegate.editBoxReturn(t),cc._canvas.focus())}),e.addEventListener("focus",function(){var e=n._editBox;this.style.fontSize=n._edFontSize+"px",this.style.color=cc.colorToHex(e._textColor),n._hiddenLabels(),cc.sys.isMobile&&n._onFocusOnMobile(e),e._delegate&&e._delegate.editBoxEditingDidBegin&&e._delegate.editBoxEditingDidBegin(e)}),e.addEventListener("blur",function(){var e=n._editBox;e._text=this.value,n._updateDomTextCases(),e._delegate&&e._delegate.editBoxEditingDidEnd&&e._delegate.editBoxEditingDidEnd(e),""===this.value&&(this.style.fontSize=e._placeholderFontSize+"px",this.style.color=cc.colorToHex(e._placeholderColor)),n._endEditing()}),this._addDomToGameContainer(),e},
e._createDomTextArea=function(){this._removeDomFromGameContainer();var n=this,e=this._edTxt=document.createElement("textarea");return e.type="text",e.style.fontFamily=this._edFontName,e.style.fontSize=this._edFontSize+"px",e.style.color="#000000",e.style.border=0,e.style.background="transparent",e.style.width="100%",e.style.height="100%",e.style.active=0,e.style.outline="medium",e.style.padding="0",e.style.resize="none",e.style.textTransform="uppercase",e.style.overflow_y="scroll",e.style.display="none",e.style.position="absolute",e.style.bottom="0px",e.style.left="2px",e.style.className="cocosEditBox",this.setMaxLength(n._editBox._maxLength),e.addEventListener("input",function(){this.value.length>this.maxLength&&(this.value=this.value.slice(0,this.maxLength));var e=n._editBox;e._delegate&&e._delegate.editBoxTextChanged&&e._text.toLowerCase()!==this.value.toLowerCase()&&(e._text=this.value,n._updateDomTextCases(),e._delegate.editBoxTextChanged(e,e._text))}),e.addEventListener("focus",
function(){var e=n._editBox;n._hiddenLabels(),this.style.fontSize=n._edFontSize+"px",this.style.color=cc.colorToHex(e._textColor),cc.sys.isMobile&&n._onFocusOnMobile(e),e._delegate&&e._delegate.editBoxEditingDidBegin&&e._delegate.editBoxEditingDidBegin(e)}),e.addEventListener("keypress",function(e){var t=n._editBox;e.keyCode===cc.KEY.enter&&(e.stopPropagation(),t._delegate&&t._delegate.editBoxReturn&&t._delegate.editBoxReturn(t))}),e.addEventListener("blur",function(){var e=n._editBox;e._text=this.value,n._updateDomTextCases(),e._delegate&&e._delegate.editBoxEditingDidEnd&&e._delegate.editBoxEditingDidEnd(e),""===this.value&&(this.style.fontSize=e._placeholderFontSize+"px",this.style.color=cc.colorToHex(e._placeholderColor)),n._endEditing()}),this._addDomToGameContainer(),e},e._createLabels=function(){var e=this._editBox.getContentSize();this._textLabel||(this._textLabel=new cc.LabelTTF,this._textLabel.setAnchorPoint(cc.p(0,1)),this._editBox.addChild(this._textLabel,100)),
this._placeholderLabel||(this._placeholderLabel=new cc.LabelTTF,this._placeholderLabel.setAnchorPoint(cc.p(0,1)),this._placeholderLabel.setColor(cc.color.GRAY),this._editBox.addChild(this._placeholderLabel,100)),this._updateLabelPosition(e)},e._removeLabels=function(){this._textLabel&&(this._editBox.removeChild(this._textLabel),this._textLabel=null)},e._updateLabelPosition=function(e){if(this._textLabel&&this._placeholderLabel){var t=cc.size(e.width-2,e.height);this._textLabel.setContentSize(t),this._textLabel.setDimensions(t),this._placeholderLabel.setLineHeight(e.height);var n=this._placeholderLabel.getContentSize();this._editBox._editBoxInputMode===cc.EDITBOX_INPUT_MODE_ANY?(this._textLabel.setPosition(2,e.height),this._placeholderLabel.setPosition(2,e.height),this._placeholderLabel.setVerticalAlignment(cc.VERTICAL_TEXT_ALIGNMENT_TOP),this._textLabel.setVerticalAlignment(cc.VERTICAL_TEXT_ALIGNMENT_TOP)):(this._textLabel.setPosition(2,e.height),this._placeholderLabel.setPosition(2,(
e.height+n.height)/2),this._placeholderLabel.setVerticalAlignment(cc.VERTICAL_TEXT_ALIGNMENT_CENTER),this._textLabel.setVerticalAlignment(cc.VERTICAL_TEXT_ALIGNMENT_CENTER))}},e.setLineHeight=function(e){this._textLabel&&this._textLabel.setLineHeight(e)},e._hiddenLabels=function(){this._textLabel&&this._textLabel.setVisible(!1),this._placeholderLabel&&this._placeholderLabel.setVisible(!1)},e._updateDomTextCases=function(){var e,t=this._editBox._editBoxInputFlag;t===cc.EDITBOX_INPUT_FLAG_INITIAL_CAPS_ALL_CHARACTERS?this._editBox._text=this._editBox._text.toUpperCase():t===cc.EDITBOX_INPUT_FLAG_INITIAL_CAPS_WORD?this._editBox._text=this._editBox._text.replace(/(?:^|\s)\S/g,function(e){return e.toUpperCase()}):t===cc.EDITBOX_INPUT_FLAG_INITIAL_CAPS_SENTENCE&&(this._editBox._text=(e=this._editBox._text).charAt(0).toUpperCase()+e.slice(1))},e._updateLabelStringStyle=function(){if("password"===this._edTxt.type){for(var e="",t=this._editBox._text.length,n=0;n<t;++n)e+=""
;this._textLabel&&this._textLabel.setString(e)}else this._updateDomTextCases(),this._textLabel&&this._textLabel.setString(this._editBox._text)},e._showLabels=function(){this._hiddenLabels(),""===this._edTxt.value?this._placeholderLabel&&(this._placeholderLabel.setVisible(!0),this._placeholderLabel.setString(this._editBox._placeholderText)):this._textLabel&&(this._textLabel.setVisible(!0),this._textLabel.setString(this._editBox._text)),this._updateLabelStringStyle()},e._beginEditing=function(){this._editBox._alwaysOnTop||"none"===this._edTxt.style.display&&(this._edTxt.style.display="",this._edTxt.focus()),cc.sys.isMobile&&!this._editingMode&&this._beginEditingOnMobile(this._editBox),this._editingMode=!0},e._endEditing=function(){if(this._editBox._alwaysOnTop||(this._edTxt.style.display="none"),this._showLabels(),cc.sys.isMobile&&this._editingMode){var e=this;setTimeout(function(){e._endEditingOnMobile()},400)}this._editingMode=!1},e._setFont=function(e){
var t=cc.LabelTTF._fontStyleRE.exec(e),n=t[2],s=parseInt(t[1]);t&&this.setFont(n,s)},e.setFont=function(e,t){this._edFontName=e||this._edFontName,this._edFontSize=t||this._edFontSize,this._updateDOMFontStyle()},e.setFontName=function(e){this._edFontName=e||this._edFontName,this._updateDOMFontStyle()},e.setFontSize=function(e){this._edFontSize=e||this._edFontSize,this._updateDOMFontStyle()},e.setFontColor=function(e){this._edTxt&&(this._edTxt.value!==this._editBox._placeholderText&&(this._edTxt.style.color=cc.colorToHex(e)),this._textLabel&&this._textLabel.setColor(e))},e.setPlaceHolder=function(e){this._placeholderLabel.setString(e)},e.setMaxLength=function(e){this._edTxt&&(this._edTxt.maxLength=e)},e._updateDOMPlaceholderFontStyle=function(){this._placeholderLabel.setFontName(this._editBox._placeholderFontName),this._placeholderLabel.setFontSize(this._editBox._placeholderFontSize)},e.setPlaceholderFontColor=function(e){this._placeholderLabel.setColor(e)},
e._updateDomInputType=function(){var e=this._editBox._editBoxInputMode;e===cc.EDITBOX_INPUT_MODE_EMAILADDR?this._edTxt.type="email":e===cc.EDITBOX_INPUT_MODE_DECIMAL||e===cc.EDITBOX_INPUT_MODE_NUMERIC?this._edTxt.type="number":e===cc.EDITBOX_INPUT_MODE_PHONENUMBER?(this._edTxt.type="number",this._edTxt.pattern="[0-9]*"):e===cc.EDITBOX_INPUT_MODE_URL?this._edTxt.type="url":(this._edTxt.type="text",this._editBox._keyboardReturnType===cc.KEYBOARD_RETURNTYPE_SEARCH&&(this._edTxt.type="search")),this._editBox._editBoxInputFlag===cc.EDITBOX_INPUT_FLAG_PASSWORD&&(this._edTxt.type="password")},e.setInputFlag=function(e){this._edTxt&&(this._updateDomInputType(),this._edTxt.style.textTransform="none",e===cc.EDITBOX_INPUT_FLAG_INITIAL_CAPS_ALL_CHARACTERS?this._edTxt.style.textTransform="uppercase":e===cc.EDITBOX_INPUT_FLAG_INITIAL_CAPS_WORD&&(this._edTxt.style.textTransform="capitalize"),this._updateLabelStringStyle())},e.setInputMode=function(e){
e===cc.EDITBOX_INPUT_MODE_ANY?this._createDomTextArea():this._createDomInput(),this._updateDomInputType();var t=this._node.getContentSize();this.updateSize(t.width,t.height)},e.setString=function(e){this._edTxt&&null!==e&&(""===(this._edTxt.value=e)?(this._placeholderLabel&&(this._placeholderLabel.setString(this._editBox._placeholderText),this._placeholderLabel.setColor(this._editBox._placeholderColor)),this._editingMode||(this._placeholderLabel&&this._placeholderLabel.setVisible(!0),this._textLabel&&this._textLabel.setVisible(!1))):(this._edTxt.style.color=cc.colorToHex(this._editBox._textColor),this._textLabel&&this._textLabel.setColor(this._editBox._textColor),this._editingMode||(this._placeholderLabel&&this._placeholderLabel.setVisible(!1),this._textLabel&&this._textLabel.setVisible(!0)),this._updateLabelStringStyle()))},e._updateDOMFontStyle=function(){this._edTxt&&(""!==this._edTxt.value&&(this._edTxt.style.fontFamily=this._edFontName,
this._edTxt.style.fontSize=this._edFontSize+"px"),this._textLabel&&(this._textLabel.setFontSize(this._edFontSize),this._textLabel.setFontName(this._edFontName)))},e.updateSize=function(e,t){var n=this._edTxt;n&&(n.style.width=e+"px",n.style.height=t+"px",this._updateLabelPosition(cc.size(e,t)))},e._addDomToGameContainer=function(){cc.game.container.appendChild(this._edTxt)},e._removeDomFromGameContainer=function(){var e=this._edTxt;if(e){("contains"in cc.game.container?cc.game.container.contains(e):cc.game.container.compareDocumentPosition(e)%16)&&cc.game.container.removeChild(e)}this._edTxt=null},e.initializeRenderCmd=function(e){this._editBox=e,this._edFontSize=14,this._edFontName="Arial",this._textLabel=null,this._placeholderLabel=null,this._editingMode=!1,this.__fullscreen=!1,this.__autoResize=!1,this.__rotateScreen=!1,this.__orientationChanged=null},cc.EditBox.CanvasRenderCmd=function(e){this._rootCtor(e),this.initializeRenderCmd(e)}
;var t=cc.EditBox.CanvasRenderCmd.prototype=Object.create(cc.Node.CanvasRenderCmd.prototype);cc.inject(e,t),t.constructor=cc.EditBox.CanvasRenderCmd,t.transform=function(e,t){this.originTransform(e,t),this.updateMatrix()},cc.EditBox.WebGLRenderCmd=function(e){this._rootCtor(e),this.initializeRenderCmd(e)};var s=cc.EditBox.WebGLRenderCmd.prototype=Object.create(cc.Node.WebGLRenderCmd.prototype);cc.inject(e,s),s.constructor=cc.EditBox.WebGLRenderCmd,s.transform=function(e,t){this.originTransform(e,t),this.updateMatrix()}}(cc.EditBox._polyfill),cleverapps.Plot={decideNext:function(e){if(e.isRegular()&&!e.isCurrentLevel()&&cleverapps.metha.getType()===Metha.HOSE&&"board"!==cleverapps.config.type&&cleverapps.config.results)return Boatswain.REPLAY_INTENT;var t=e.isRegular();if((cleverapps.metha.getType()===Metha.KNOCKOUT||cleverapps.forces.checkMainForces())&&(t=!1),t)switch(cleverapps.metha.getType()){case Metha.FARM:cleverapps.farm.isCompleted()||cleverapps.metha.withSimpleMain()||(
cleverapps.farm.getBuilding().getQuest().isCompleted()&&(t=!1),cleverapps.farm.justCollectedDialogue&&(t=!1));break;case Metha.HOMEFIX:if(!cleverapps.home.isCompleted()&&!cleverapps.metha.withSimpleMain()){var n=cleverapps.home.getFurnitureToUpgrade();if(n){var s=n.getInfo().cost;cleverapps.home.stars>=s&&cleverapps.home.stars-cleverapps.home.amountLevelStars(e)<s&&(t=!1)}}break;case Metha.SIMPLE:t=0===cleverapps.user.episode&&cleverapps.user.level<3;break;case Metha.HOSE:if(e.isCurrentLevel()&&!e.isLastLevelOnEpisode()||(t=!1),t){var i=cleverapps.Plot.getDialogueAfterLevel(e),o=e.episode.levels[e.levelNo+1];(i||o.isHard())&&(t=!1)}}return t&&cleverapps.missionManager.skipNext()&&(t=!1),t?Boatswain.NEXT_INTENT:Boatswain.EXIT_INTENT},GameLeave:function(e,t){var n=t.level,s=this.isEpisodeFinished(n)&&cleverapps.metha.getType()===Metha.HOSE&&!cleverapps.Plot.isPassedAllEpisodes,i=[];if(this.isEpisodeFinished(n)&&!cleverapps.Plot.isPassedAllEpisodes){var o=levels.user.episode-1,
r=cleverapps.styles.comicses["finishEpisode"+o]||cleverapps.styles.comicses.finishEpisode;r&&i.push(function(e){ComicsScene.showComics(e,r)})}var a,c=function(e){var t=cleverapps.missionManager.getMissionWithIntent();!s&&t&&t.logic.willUseIntent(n)?t.useMissionIntent(e):(cleverapps.rewardedAdsManager&&!cleverapps.isLocalhost()&&cleverapps.rewardedAdsManager.showInterstitial(),cleverapps.metha.gotoMainScene(e))};cleverapps.isKnockoutGame()&&n.isRegular()?((a=cleverapps.metha.getMainObject().knockoutGame.rumble).moveNextRound(),a.outcome===Rumble.OUTCOME_UNKNOWN?i.push(function(e){cleverapps.metha.getMainObject().wantsToPlay(e)}):(a.outcome===Rumble.OUTCOME_WIN&&(i.push(function(e){cleverapps.metha.getMainObject().knockoutGame.openWindow(e)}),i.push(function(e){new KnockoutVictoryWindow,cleverapps.metha.onceNoWindowsListener=e})),i.push(c))):i.push(c);cleverapps.metha.getType()===Metha.KNOCKOUT&&n.isRegular()&&((a=cleverapps.knockout.knockoutGame.rumble
)&&a.outcome===Rumble.OUTCOME_WIN&&(cleverapps.knockout.gotoNextCupAnimation=!0,i.push(function(e){cleverapps.knockout.gotoNextCup(e)}),i.push(function(e){cleverapps.knockout.gotoNextCupAnimation=!1,e()})));if(s){levels.episodes.changeEpisodeAnimation=!0;var l=levels.user.episode-1,p=l+1;i.push(function(e){cleverapps.metha.compound(e,[function(e){cleverapps.Plot.onFinishEpisode(e,{episode:levels.episodes.episodes[l]})},function(e){levels.episodes.changeEpisodeAnimation=!1,levels.episodes.gotoNextEpisode(e,!0,p)},function(e){cleverapps.Plot.onStartEpisode(e,{episode:levels.episodes.episodes[p]})}])})}n.isRegular()&&n.isPassed&&n.isCurrentLevel()&&cleverapps.Plot.getDialogueAfterLevel(n)&&i.push(function(e){cleverapps.Plot.finishLevelDialogue(e,n)}),cleverapps.metha.compound(e,i)},onFinishEpisode:function(e,t){cleverapps.metha.showControlsWhileFocused("mainTableView"),cleverapps.metha.compound(e,[function(e){new FinishEpisodeWindow(t),cleverapps.metha.onceNoWindowsListener=e},function(e
){t.episode.animatePass(e)}])},onStartup:function(e,t){return 0===levels.user.episode&&0===levels.user.level?this.onFirstInit(e,t):t?cleverapps.metha.getMainScene():void cleverapps.metha.gotoMainScene(e)},onFirstInit:function(e,t){var n=[];if(cleverapps.styles.comicses&&cleverapps.styles.comicses.begin){if(t)return{scene:ComicsScene,options:[cleverapps.styles.comicses.begin]};n.push(function(e){ComicsScene.showComics(e,cleverapps.styles.comicses.begin)})}else if(this.hasStartEpisodeWindow())return t?cleverapps.metha.getMainScene():(n.push(function(e){cleverapps.metha.gotoMainScene(e)}),n.push(function(e){this.onStartEpisode(e,{episode:levels.episodes.getCurrentEpisode()})}.bind(this)),void cleverapps.metha.compound(e,n));if(cleverapps.metha.getType()===Metha.HOSE||cleverapps.metha.getType()===Metha.SIMPLE||cleverapps.metha.withSimpleMain()){if(t)return GameScene;n.push(function(e){cleverapps.metha.wantsToPlay(e)})}else{if(t)return cleverapps.metha.getMainScene();n.push(function(e){
cleverapps.metha.gotoMainScene(e)})}cleverapps.metha.compound(e,n)},hasStartEpisodeWindow:function(){return cleverapps.metha.getType()===Metha.HOSE&&"riddles"===cleverapps.config.name},onStartEpisode:function(e,t){if(t.episode.isComingSoon())new FinisherWindow,cleverapps.metha.onceNoWindowsListener=e;else{var n=[];n.push(function(e){t.episode.animateOpen(e)}),this.hasStartEpisodeWindow()&&n.push(function(e){new StartEpisodeWindow(t.episode),cleverapps.metha.onceNoWindowsListener=e}),cleverapps.metha.compound(e,n)}},onFirstHeroesOpen:function(e,t){var n=[function(e){new HeroWindow({color:t.color},{type:"unlocked"}),cleverapps.metha.onceNoWindowsListener=e}];if(cleverapps.styles.comicses){var s=ColorCell.CODE_COLORS[t.color];cleverapps.styles.comicses[s]&&n.push(function(e){ComicsScene.showComics(e,cleverapps.styles.comicses[s])})}cleverapps.metha.compound(e,n)},isEpisodeFinished:function(e){return e.isRegular()&&e.isPassed&&e.isLastLevelOnEpisode()&&e.isCurrentLevel()},
getDialogueAfterLevel:function(e){if(!cleverapps.styles.dialogues||!e.isRegular())return!1;var t=cleverapps.user.getHumanReadableNumber()-1;return cleverapps.styles.dialogues["finishLevel"+t]},finishLevelDialogue:function(e,t){var n=this.getDialogueAfterLevel(t);if(n){var s=cc.director.getRunningScene();cleverapps.metha.compound(e,[function(e){n.bundles?cleverapps.bundleLoader.loadBundles(n.bundles,{onSuccess:function(){e()},blocked:!0}):e()},function(e){var t=s.scene.height*(1.2-1);s.createFilmEffect({scale:1.2,layerTimeout:0,scaleTimeout:1,moveBy:{y:t},onComplete:e})},function(e){var t=new Dialogue(n.dialogue,{autoClose:!0,autoScroll:3,parentScene:!0,showUp:!0});t.on("afterClose",e),new DialogueView(t,{overlay:!0}).setLocalZOrder(51),t.run()},function(e){s.removeFilmEffect({scaleTimeout:.4,scaleLayerSameTime:!0,layerSlide:!0,onComplete:e})}])}}},cleverapps.styles.comicses={};var Dialogue=function(e,t){cleverapps.EventEmitter.call(this),this.options=t||{},
this.parentScene=t.parentScene,this.autoScroll=3,void 0!==this.options.autoScroll&&(this.autoScroll=this.options.autoScroll),this.data=Array.isArray(e)?e:[e],this.stage=-1,this.stageData=this.data[0],this.personSlots=[void 0,void 0],this.bundlesToLoad=["dialogues"].concat(cleverapps.unique(this.options.bundles||[]).filter(function(e){return bundles[e]})),this.onceFinishTyping=function(){}};Dialogue.prototype=Object.create(cleverapps.EventEmitter.prototype),(Dialogue.prototype.constructor=Dialogue).prototype.onBundlesLoaded=function(){this.waitingForBundles&&(delete this.waitingForBundles,this.next())},Dialogue.prototype.run=function(){cleverapps.metha.isFocused()||(console.log("Dialogue:",this.data),cleverapps.metha.debugMessage("Trying to show dialogue without user focus!")),cleverapps.bundleLoader.isLoaded(this.bundlesToLoad)?this.next():this.waitingForBundles=!0},Dialogue.prototype.finishClose=function(){this.closeCallback&&(this.closeCallback(),delete this.closeCallback),
this.trigger("afterClose")},Dialogue.prototype.close=function(e){this.closing||(this.closing=!0,this.closeCallback=e,this.trigger("beforeClose"))},Dialogue.prototype.next=function(e){if(this.typing)return this.onceFinishTyping=function(){},void this.finishTyping();e=e||0,this.stage<this.data.length-1?this.incStage(e):this.options.autoClose&&this.createTimeout(this.close.bind(this),1e3*e)},Dialogue.prototype.incStage=function(e){clearTimeout(this.incTimeout),this.onceFinishTyping=function(){},this.incTimeout=this.createTimeout(function(){this.stage++,this.stageData=this.data[this.stage],this.onChangeStage(),this.options.showUp&&0===this.stage&&this.trigger("showUp"),this.onceFinishTyping=this.finishTyping.bind(this)}.bind(this),1e3*e)},Dialogue.prototype.createTimeout=function(e,t){return new cleverapps.CountDown(t,{onFinish:function(){this.closing||e()}.bind(this),pauseOnGameHide:!0})},Dialogue.prototype.onChangeStage=function(){this.typing=!0;var e=this.extractPersons();(
e[0]&&"right"===e[0].position||e[1]&&"left"===e[1].position)&&(e=e.reverse());var s=void 0;e.forEach(function(e,t){e&&e.active&&(s=e);var n=this.personSlots[t];this.areSamePersons(e,n)?this.trigger("updatePerson",e):(n&&this.trigger("hidePerson",n.position),e&&this.trigger("showPerson",e))},this),this.trigger("updateButton",!this.stageData.noButton,this.stage===this.data.length-1),this.trigger("changeText",this.stageData.text,s,function(){this.onceFinishTyping()}.bind(this)),this.trigger("updatePersonTitle",s),this.trigger("changedStage"),this.personSlots=e},Dialogue.prototype.extractPersons=function(){var e=this.stageData.person;void 0===e&&(e={position:"left"}),e&&(e.active=!0);var t=this.stageData.person2;return t&&(t.active=!1),[e,t]},Dialogue.prototype.areSamePersons=function(e,t){return e&&t&&e.position===t.position&&(!e.styles&&!t.styles||e.styles.json===t.styles.json)},Dialogue.prototype.finishTyping=function(){this.typing=!1,this.trigger("finishTyping"),
this.autoScroll&&this.next(this.autoScroll)},Dialogue.prototype.screenClicked=function(){this.trigger("screenClicked"),this.next()},Dialogue.prototype.buttonClicked=function(){this.typing&&this.next(),this.next(),this.trigger("buttonClicked")},Dialogue.POSITIONS={TOP:"top",TOP_LOWER:"top_lower",BOTTOM:"bottom",CENTER:"center"};var Force=Window.extend({ctor:function(e,t,n){this.windowForce="function"===t.window?t.window():t.window,this.forceConfig=t,this.options=n||{},this._super(e,t)},moveNodeAndKeepScale:function(e){e.realParent=e.getParent();for(var t=1,n=e.realParent;n;)t*=n.scale,n=n.getParent();var s=this;1!==t&&((s=new cc.Node).setScale(t),this.addChild(s)),e.replaceParentSamePlace(s)},returnNode:function(e){e.replaceParentSamePlace(e.realParent)},onWindowLoaded:function(e,t){this.id=t.id,this._super({name:"forcewindow"+this.id,notCloseByTouchInShadow:!0,closeButton:!1,styles:cleverapps.overrideStyles(cleverapps.styles.Window,cleverapps.styles.Force,!0)}),
cleverapps.toolbar.freezeUpdates(),this.element=e,this.element.realParent=void 0;var n=this.options.rects||[];if(e!==Force.NO_ELEMENT&&n.push(this.element.getGlobalBoundingBox()),this.options.highlights&&this.options.highlights.forEach(function(e){this.moveNodeAndKeepScale(e)},this),e!==Force.NO_ELEMENT&&(this.moveNodeAndKeepScale(e),!1!==t.Finger)){var s=1/e.parent.scale,i=1/e.parent.scale;this.options.scaleX&&(s*=this.options.scaleX),this.finger=new FingerView({scaleX:s,scaleY:i}),this.finger.setVisible(!0),e.parent.addChild(this.finger),this.finger.setPositionRound(this.element.getPosition()),this.finger.delay(1);var o,r=cc.p(0,0);if(this.finger.setLocalZOrder(1e6),t.Finger){var a=t.Finger;"function"==typeof t.Finger&&(a=t.Finger()),a.mobile&&cleverapps.wideMode.mode===cleverapps.WideMode.VERTICAL&&(a=a.mobile),r=cc.p(a.x||0,a.y||0),a.startY&&(o=cc.p(0,a.startY)),a.rotation&&this.finger.setRotation(a.rotation)}this.finger.fadeIn(r,o),this.finger.press(),this.finger.delay(.3),
this.finger.unPress(),this.finger.fadeOut(),this.finger.delay(1.3),this.finger.run({looped:!0})}var c=new MinimalDialogue({text:"function"==typeof t.text?t.text(t):t.text,person:t.person,rects:n,parent:this,forcePosition:"function"==typeof t.position?t.position():t.position});c.setLocalZOrder(1e6),this.addChild(c),(e===Force.NO_ELEMENT||this.forceConfig.closeByTouchInShadow)&&this.addCloseByTouchInShadow(),t.event&&cleverapps.eventLogger.logEvent(t.event),e!==Force.NO_ELEMENT&&(this.watchElementInterval=setInterval(function(){this.element.parent&&this.element.visible||cleverapps.forces.closeRunningForce()}.bind(this),5e3))},onClose:function(){this.watchElementInterval&&clearInterval(this.watchElementInterval),this.element.parent&&(this.finger&&this.finger.removeFromParent(!0),this.element&&this.element!==Force.NO_ELEMENT&&this.returnNode(this.element)),this.options.highlights&&this.options.highlights.forEach(function(e){e.getParent()&&this.returnNode(e)},this),
cleverapps.toolbar.unfreezeUpdates()},addCloseByTouchInShadow:function(){this.clickArea=new cc.Node,this.clickArea.setContentSize(this.getContentSize()),this.addChild(this.clickArea),cc.eventManager.addListener({event:cc.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:!0,onTouchBegan:function(e){cleverapps.forces.isRunningForce()&&cleverapps.forces.closeRunningForce()}.bind(this.clickArea)},this.clickArea)},listBundles:function(){return["dialogues_minimal"]}});cleverapps.styles.Force={windowShowUpAnimation:{name:"instant",force:!0}},Force.NO_ELEMENT="emptyForceElement";var Forces=function(){this.shownForces=[],this.load(),this.runningForceWindow=void 0,this.onceForceClosed=void 0};Forces.prototype.isRunningForce=function(e){return void 0!==this.runningForceWindow&&(void 0===e||this.runningForceWindow.id===e.id)},Forces.prototype.whenForceClosed=function(e){this._whenForceClosedCallbacks||(this._whenForceClosedCallbacks=[]),this._whenForceClosedCallbacks.push(e)},
Forces.prototype._runForceClosedCallbacks=function(){this._whenForceClosedCallbacks&&(this._whenForceClosedCallbacks.forEach(function(e){e()}),delete this._whenForceClosedCallbacks)},Forces.prototype.closeRunningForce=function(){if(this.runningForceWindow.close(),this._runForceClosedCallbacks(this.runningForceWindow.id),void 0!==this.runningForceWindow.id&&this.saveForce(this.runningForceWindow.id),this.runningForceWindow=void 0,this.onceForceClosed){var e=this.onceForceClosed;this.onceForceClosed=void 0,e()}},Forces.prototype.reset=function(){this.shownForces=[],this.save()},Forces.prototype.load=function(){this.shownForces=cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.FORCES)||[]},Forces.prototype.save=function(e){cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.FORCES,this.shownForces),e||cleverapps.synchronizer.addUpdateTask("forces")},Forces.prototype.getInfo=function(){var t=0;return this.shownForces.forEach(function(e){t+=Math.pow(2,e)}),{forces:t}},
Forces.prototype.updateInfo=function(e,t){this.shownForces=[];for(var n=e.forces,s=Forces.SYNCED_FORCES-1;0<=s;s--){var i=Math.pow(2,s);i<n&&(n-=i,this.shownForces.push(s))}this.shownForces=this.shownForces.reverse(),this.save(t)},Forces.prototype.isAvailable=function(e,t){return!(!e||e&&e!==Force.NO_ELEMENT&&!e.isRunningSafe())&&(void 0===t.id||-1===this.shownForces.indexOf(t.id))},Forces.prototype.isShown=function(e){return void 0!==e&&(this.shownForces&&0<=this.shownForces.indexOf(e))},Forces.prototype.saveForce=function(e){e&&!this.isShown(e)&&(this.shownForces.push(e),this.save())},Forces.prototype.clearForce=function(e){var t=this.shownForces.indexOf(e);-1!==t&&(this.shownForces.splice(t,1),this.save())},Forces.prototype.create=function(e,t,n){if(this.isAvailable(e,t))return this.runningForceWindow=new Force(e,t,n)},Forces.prototype.checkMainForces=function(){return this.checkDailyTasksForce()||this.checkPeriodicBonusForce()||this.checkBonusRoundForce()||this.checkHeroesForce()},
Forces.prototype.checkDailyTasksForce=function(){return cleverapps.dailyTasks&&levels.user.checkAvailable(cleverapps.Availables.DAILY_TASKS)&&!this.isShown(Forces.DAILY_TASKS_FORCE.id)},Forces.prototype.checkPeriodicBonusForce=function(){return cleverapps.periodicBonus&&cleverapps.periodicBonus.isAvailable()&&!this.isShown(Forces.PERIODIC_BONUS_FORCE.id)},Forces.prototype.checkBonusRoundForce=function(){return cleverapps.bonusRoundChest&&cleverapps.bonusRoundChest.isActive()&&!this.isShown(Forces.BONUS_ROUND_FORCE.id)},Forces.prototype.checkHeroesForce=function(){return"undefined"!=typeof match3&&match3.heroes.available()&&!this.isShown(Forces.HEROES_AVAILABLE.id)},Forces.SYNCED_FORCES=52,Forces.FREE_WILDCARD_FORCE={id:1,event:cleverapps.EVENTS.FREE_WILDCARD_FORCE,text:"messages:WildCardTutorialMessage"},Forces.FREE_UNDO_FORCE={id:2,event:cleverapps.EVENTS.FREE_UNDO_FORCE,text:"messages:UndoTutorialMessage"},Forces.FREE_HINT_FORCE={id:3,event:cleverapps.EVENTS.FREE_HINT_FORCE,
text:"messages:hintTutorialMessage"},Forces.FIRST_BOOSTERS_BEFORE={id:4,window:!0,event:cleverapps.EVENTS.FIRST_BOOSTERS_BEFORE,text:"messages:FirstBoostersBefore.force",position:Dialogue.POSITIONS.BOTTOM},Forces.SECOND_BOOSTERS_BEFORE={id:5,window:!0,event:cleverapps.EVENTS.SECOND_BOOSTERS_BEFORE,text:"messages:SecondBoostersBefore.force",position:Dialogue.POSITIONS.BOTTOM},Forces.THIRD_BOOSTERS_BEFORE={id:6,window:!0,event:cleverapps.EVENTS.THIRD_BOOSTERS_BEFORE,text:"messages:ThirdBoostersBefore.force",position:Dialogue.POSITIONS.BOTTOM},Forces.FREE_ADD_MOVES_FORCE={id:7,event:cleverapps.EVENTS.FREE_ADD_MOVES_FORCE,text:"messages:AddMovesTutorialMessage",Finger:{y:50}},Forces.FREE_PAINT_FORCE={id:8,event:cleverapps.EVENTS.FREE_PAINT_FORCE,text:"messages:Paint.force"},Forces.DAILY_TASKS_FORCE={id:10,event:cleverapps.EVENTS.DAILY_TASKS_FORCE,text:"messages:Forces.DailyTasks",Finger:{startY:100}},Forces.COOLDOWN_FORCE={id:11,text:"messages:CoolDownNode.force",button:{
text:"messages:SkipButton"},Finger:!1},Forces.PERIODIC_BONUS_FORCE={id:12,event:cleverapps.EVENTS.PERIODIC_BONUS_FORCE,text:"messages:Forces.PeriodicBonus",Finger:{startY:100}},Forces.GUN={id:15,event:cleverapps.EVENTS.GUN_FORCE,person:"board"!==cleverapps.config.type&&-1===["differences","tripeaks"].indexOf(cleverapps.config.name)&&void 0,text:"messages:Forces.Gun",Finger:{startY:100,x:100,y:130}},Forces.HEROES_AVAILABLE={id:17,event:cleverapps.EVENTS.HEROES_AVAILABLE_FORCE,text:"messages:Forces.HeroesAvailable"},Forces.DAILY_CUP={id:18,text:"messages:DailyCup.force"},Forces.LANTERN={id:20,event:cleverapps.EVENTS.LANTERN_FORCE,text:"messages:LanternWindow.force"},Forces.BONUS_ROUND_FORCE={id:21,event:cleverapps.EVENTS.BONUS_ROUND_FORCE,text:"messages:Forces.BonusRound",Finger:{startY:100}},Forces.UNLOCK_HEROES={text:"messages:Forces.UnlockHero",Finger:{y:-70}},Forces.UPGRADE_HEROES={text:"messages:Forces.UpgradeFirstHero",Finger:{y:-70}},Forces.RACE={id:22,text:"messages:Race.force"},
Forces.METHA_PLAY_BUTTON={id:23,text:function(){return cleverapps.metha.getType()===Metha.SIMPLE?"messages:SimpleMethaPlayButton.force":"messages:MethaPlayButton.force"},position:Dialogue.POSITIONS.TOP_LOWER},Forces.KNOCKOUT_PLAYERS={id:24,text:"messages:KnockoutPlayers.force",button:{text:"messages:SkipButton"},Finger:!1},Forces.KEYPAD={id:25,text:"messages:Keypad.force",button:{text:"messages:SkipButton"},Finger:!1,position:function(){if("differences"===cleverapps.config.type)return Dialogue.POSITIONS.BOTTOM}},Forces.COMBO={id:26,text:"messages:Combo.force"},Forces.COOKIEJAR={id:27,text:"messages:Cookiejar.force",button:{text:"messages:OK"},closeByTouchInShadow:!0},Forces.CRYPTEX={id:28,text:"messages:Cryptex.force"},Forces.FREE_SHUFFLE_FORCE={id:29,event:cleverapps.EVENTS.FREE_SHUFFLE_FORCE,text:"messages:ShuffleBooster.force"},Forces.PHOTO_CLOVER={id:30,text:"messages:PhotoClover.force"},Forces.TRICKY_LEVEL={id:31,text:"messages:TrickyLevelForce",Finger:!1},Forces.SIMPLE={id:32,
text:"messages:Simple.Force",Finger:function(){return cleverapps.styles.ProgressView.force.finger}},Forces.BONUS_WORLD={id:33},Forces.SLOT_MACHINE_ICON={id:34,text:"messages:SlotMachine.IconForce"},Forces.SLOT_MACHINE={id:35,text:"messages:SlotMachine.Force"};var Actor=cc.Node.extend({ctor:function(e){this._super(),this.setContentSize(e.size),this.setAnchorPoint2();var t=e;t.boostersAmountPosition&&(t=t.boostersAmountPosition[Game.currentGame.boosters.amountAvailable()]),t=t.wideModePositions?t.wideModePositions[cleverapps.wideMode.mode]:t.position,this.setPositionRound(t),this.baseScaleX=this.baseScaleY=1,e.scales&&(this.baseScaleX=this.baseScaleY=e.scales[cleverapps.wideMode.mode]),e.scaleX&&(this.baseScaleX*=e.scaleX),e.scaleY&&(this.baseScaleY*=e.scaleY),this.setScale(this.baseScaleX,this.baseScaleY),this.spine=new cleverapps.Spine(e.spine),this.currSpine=e.spine,this.currSpineId=e.spineId,this.currSfx=e.sfx,e.spinePosition?this.spine.setPositionRound(this.width/2+e.spinePosition.x
,this.height/2+e.spinePosition.y):this.spine.setPositionRound(this.width/2,0),this.addChild(this.spine),e.skin&&(this.spine.setSkin(e.skin),this.currSkin=e.skin),this.spine.setAnimation(0,Actor.ANIMATIONS.IDLE,!0),this.alive=!0},shake:function(){this.stopAllActions(),this.setScale(this.baseScaleX,this.baseScaleY),this.runAction(new cc.Sequence(new cc.ScaleTo(.1,1.07*this.baseScaleX,.93*this.baseScaleY),new cc.ScaleTo(.05,this.baseScaleX,this.baseScaleY)))},animate:function(t,n){if(n=n||{},!this.alive){if(t!==Actor.ANIMATIONS.REVIVE)return;this.alive=!0}var e;(-1!==[Actor.ANIMATIONS.DIE,Actor.ANIMATIONS.DIE_IDLE].indexOf(t)&&(this.alive=!1),-1!==[Actor.ANIMATIONS.HURT,Actor.ANIMATIONS.HURT2].indexOf(t)&&(-1!==[Actor.ANIMATIONS.ATTACK1,Actor.ANIMATIONS.ATTACK2,Actor.ANIMATIONS.ATTACK3,Actor.ANIMATIONS.ATTACK4].indexOf(this.animationRunning)&&(this.animationRunning=!1),-1!==[Actor.ANIMATIONS.HURT,Actor.ANIMATIONS.HURT2].indexOf(this.animationRunning)&&this.animationStarted<Date.now(
)-300&&(this.animationRunning=!1)),-1!==[Actor.ANIMATIONS.GUN,Actor.ANIMATIONS.DIE,Actor.ANIMATIONS.DIE_IDLE,Actor.ANIMATIONS.REVIVE,Actor.ANIMATIONS.HEAL,Actor.ANIMATIONS.ENEMY_ATTACK].indexOf(t)&&(this.animationRunning=!1),this.animationRunning)||(this.currSfx&&!n.noSFX&&(e=this.currSfx[t]),e&&this.runAction(new cc.Sequence(new cc.DelayTime(n.sfxDelay||cleverapps.styles.Actor.sfx.delay),new cc.CallFunc(function(){cleverapps.audio.playSound(e)}))),this.animationRunning=t,this.animationStarted=Date.now(),this.spine.setAnimation(0,t,!1),this.spine.setCompleteListener(function(){var e;this.animationRunning=!1,this.spine.setCompleteListener(function(){}),e=n.idleAnimation?n.idleAnimation:-1!==[Actor.ANIMATIONS.DIE,Actor.ANIMATIONS.DIE_IDLE].indexOf(t)?Actor.ANIMATIONS.DIE_IDLE:Actor.ANIMATIONS.IDLE,this.spine.setAnimation(0,e,!0),n.callback&&n.callback()}.bind(this)))}});Actor.ANIMATIONS={},Actor.ANIMATIONS.ENEMY_ATTACK="attack",Actor.ANIMATIONS.ATTACK1="attack1",
Actor.ANIMATIONS.ATTACK2="attack2",Actor.ANIMATIONS.ATTACK3="attack3",Actor.ANIMATIONS.ATTACK4="attack4",Actor.ANIMATIONS.IDLE="idle",Actor.ANIMATIONS.HURT="hurt",Actor.ANIMATIONS.HURT2="hurt2",Actor.ANIMATIONS.DIE="die",Actor.ANIMATIONS.DIE_IDLE="die_idle",Actor.ANIMATIONS.HEAL="heal",Actor.ANIMATIONS.REVIVE="revive",Actor.ANIMATIONS.GUN="punish",cleverapps.styles.Actor={sfx:{delay:.7}},cleverapps.WideMode=function(){this.refresh()},cleverapps.WideMode.prototype.refresh=function(){this.mode=cleverapps.WideMode.VERTICAL;var e=cc.director.getWinSize();e.width>cleverapps.styles.SQUARE_MODE_WIDTH&&(this.mode=cleverapps.WideMode.SQUARE),void 0!==cleverapps.styles.HORIZONTAL_MODE_WIDTH?e.width>cleverapps.styles.HORIZONTAL_MODE_WIDTH&&(this.mode=cleverapps.WideMode.HORIZONTAL):void 0!==cleverapps.styles.SCENE_HORIZONTAL_WIDTH&&e.width===cleverapps.styles.SCENE_HORIZONTAL_WIDTH&&(this.mode=cleverapps.WideMode.HORIZONTAL)},cleverapps.WideMode.VERTICAL=0,cleverapps.WideMode.SQUARE=1,
cleverapps.WideMode.HORIZONTAL=2;var Competition=function(e){this.type=e.type;var t=void 0;(this.options=e).store&&((t=cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.COMPETITION+"_"+this.type))||-1===[Mission.TYPE_COMBO,Mission.TYPE_COLLECT_MARK,Mission.TYPE_BURN_NEARBY,Mission.TYPE_LETTER].indexOf(this.type)||(t=cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.COMPETITION)),cleverapps.DataLoader.remove(cleverapps.DataLoaderTypes.COMPETITION));t?(this.results=t.results,e.algo.lastProcessed=t.algorithm):e.players?this.results=e.players:this.results=this.listFakePlayers(e.amount),this.player=this.getPlayerById(cleverapps.user.id),this.player||(this.player={player:!0,id:cleverapps.user.id,name:cleverapps.friends.getPlayer().name,avatar:cleverapps.friends.getPlayer().avatar,amount:0},this.results.push(this.player)),void 0!==e.playerResult&&(this.player.amount=e.playerResult),this.running=!0,this.onChangeResultsListeners={},this.onLoseListener=function(){},
this.algorithm=new CompetitionAlgorithm(this,this.options.algo),0<this.countFakePlayers()&&this.onPlayersAvailable()};Competition.prototype.start=function(){this.algorithm.start()},Competition.optionsForTournament=function(e){var t="tournament",n=cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.COMPETITION+"_"+t)||{};if(e.emptySave||n.level===e.level.getHumanReadableNumber()){var s=n.results||[];if(e.emptySave){Competition.CLEAN_SAVED(t);var i=[.5,.8,1.1].sort(function(){return Math.random()<.5?-1:1});(s=cleverapps.competitionPlayers.listPlayers(3)||[]).forEach(function(e,t){e.amount=0,e.force=i[t]})}if(!(s.length<3)){cleverapps.UI.Avatar.preload(s);var o=cleverapps.competitionStatistics.getBoardGameWordOpenByKeypadLengthTime(e.keypad.amountKeys());return{type:t,amount:3,level:e.level,store:!0,lose:!1,players:s,algo:{noPlayerEpisodeCoef:!0,averageProcessTimeout:cleverapps.parseInterval(o+" seconds"),botAheadPlayerCoef:.25,botAheadPlayerBigDifferenceCoef:.3,bigDistanceLength:1,
offlineProcess:!0,useRealForce:!0,duration:cleverapps.parseInterval("3 hour"),maxResult:e.totalItemsToSolve()}}}}},Competition.optionsForKnockoutGame=function(e){var t=10;"board"===cleverapps.config.type?t=cleverapps.competitionStatistics.getBoardGameWordOpenByKeypadLengthTime(e.keypad.amountKeys()):"differences"===cleverapps.config.type&&(t=cleverapps.competitionStatistics.getOneDifferenceFindTime());var n=cleverapps.metha.getMainObject().knockoutGame.rumble,s=n.getCurrentRound().getOpponent(cleverapps.user.id);s.force=[.6,.8,1][n.rounds.length-1],s.amount=0;var i=.3,o=1.5,r=.5;switch(cleverapps.metha.getMainObject().knockoutGame.calcTournamentType()){case KnockoutGame.BOT_CANNOT_WIN_TOURNAMENT:r=0,o=2,t=Math.floor(.8*t);break;case KnockoutGame.VERY_EASY_TOURNAMENT:i=.3,o=2,t=Math.floor(2.5*t);break;case KnockoutGame.EASY_TOURNAMENT:i=.4,o=1,r=.3,t=Math.floor(1.3*t);break;case KnockoutGame.NORMAL_TOURNAMENT:i=.5,o=1.2,r=.3,t=Math.floor(1.1*t);break
;case KnockoutGame.DIFFICULT_TOURNAMENT:i=.6,o=1.5,t=Math.floor(.8*t);break;case KnockoutGame.VERY_DIFFICULT_TOURNAMENT:i=.8,o=1.5,t=Math.floor(.5*t)}return{type:"knockout",amount:1,players:[s],algo:{noPlayerEpisodeCoef:!0,averageProcessTimeout:cleverapps.parseInterval(t+" seconds"),botAheadPlayerCoef:i,botAheadPlayerBigDifferenceCoef:.5,playerAheadBotCoef:o,playerAheadBotBigDifferenceCoef:2,bigDistanceLength:1,offlineProcess:!1,useRealForce:!0,duration:cleverapps.parseInterval("3 hour"),maxResult:e.totalItemsToSolve(),botFinishCoef:r}}},Competition.optionsByMission=function(e){var t={store:!0,type:e.type,playerResult:e.result,amount:Array.isArray(e.competition.amount)?cleverapps.Random.random(e.competition.amount[0],e.competition.amount[1],!1):e.competition.amount};return t.algo={start:e.started,finish:e.finishTime()},cleverapps.extend(t.algo,e.competition),t},Competition.prototype.calcPlace=function(){return this.results.sort(function(e,t){
return t.amount!==e.amount?t.amount-e.amount:e.event&&t.event&&e.event!==t.event?e.event-t.event:e===this.player?-1:t===this.player?1:0}.bind(this)),this.results.indexOf(this.player)},Competition.prototype.updatePlayerResult=function(e,t){this.options.algo.maxResult&&t>this.options.algo.maxResult&&(t=this.options.algo.maxResult);for(var n=0;n<this.results.length;n++)if(this.results[n].id===e){this.results[n].amount=t,this.results[n].event=Date.now(),this.runChangeResultsListeners(e);break}this.getFinishedOpponents().length===this.options.amount&&!1!==this.options.lose&&this.onLoseListener()},Competition.prototype.getFinishedOpponents=function(){return this.results.filter(function(e){return e.id!==cleverapps.user.id&&e.amount===this.options.algo.maxResult}.bind(this))},Competition.prototype.runChangeResultsListeners=function(t){cleverapps.values(this.onChangeResultsListeners).forEach(function(e){e(t)})},Competition.prototype.stop=function(){this.running=!1,
delete cleverapps.competitionPlayers.onAvailableListeners[this.type],this.algorithm.stop()},Competition.prototype.onPlayersAvailable=function(){if(delete cleverapps.competitionPlayers.onAvailableListeners[this.type],this.running){var e=cleverapps.competitionPlayers.listPlayers(Math.min(this.countFakePlayers(),cleverapps.competitionPlayers.getAmount()));this.replaceFakePlayers(e),0<this.countFakePlayers()&&(cleverapps.competitionPlayers.onAvailableListeners[this.type]=this.onPlayersAvailable.bind(this))}},Competition.CLEAN_SAVED=function(e){cleverapps.DataLoader.remove(cleverapps.DataLoaderTypes.COMPETITION+"_"+e)},Competition.prototype.listFakePlayers=function(e){for(var t=[],n=0;n<e;n++)t.push({id:Math.round(1e6*Math.random()),name:"player"+n,fake:!0});return t},Competition.prototype.countFakePlayers=function(e){var t=0;return this.results.forEach(function(e){e.fake&&t++}),t},Competition.prototype.replaceFakePlayers=function(e){for(var t=0,n=0;n<this.results.length&&t<e.length;n++){
var s=this.results[n];s.fake&&(s.id=e[t].id,s.name=e[t].name,s.avatar=e[t].avatar,delete s.fake,t++)}this.save()},Competition.prototype.getPlayerById=function(t){return this.results.filter(function(e){return e.id===t})[0]},Competition.prototype.getResults=function(){return this.results.slice()},Competition.prototype.save=function(){this.options.store&&cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.COMPETITION+"_"+this.type,{results:this.results,algorithm:this.algorithm.getData(),level:this.options.level?this.options.level.getHumanReadableNumber():void 0})},Competition.prototype.onUserInfoChanged=function(){this.player.name=cleverapps.friends.getPlayer().name,this.player.avatar=cleverapps.friends.getPlayer().avatar,this.player.id=cleverapps.friends.getPlayer().id,this.save()};var CompetitionPlayers=function(){this.onAvailableListeners={},this.load(),this.reload(),setInterval(this.reload.bind(this),cleverapps.parseInterval(CompetitionPlayers.RELOAD_INTERVAL))}
;CompetitionPlayers.prototype.reload=function(){if(!this.reloading){this.reloading=!0;var e=function(e){this.reloading=!1,this.players=[];for(var t=0;t<e.length;t++)e[t].id!==levels.user.id&&e[t].name&&0<e[t].name.length&&this.players.push({id:e[t].id,name:e[t].name,avatar:e[t].avatar});if(this.save(),0<this.players.length)for(var n in this.onAvailableListeners)this.onAvailableListeners[n]()}.bind(this),t=function(){this.reloading=!1}.bind(this),n="/competitionplayers/?locale="+cleverapps.settings.language;cleverapps.config.debugMode&&(n="https://riddles.labsystech.ru/riddles-rest"+n),cleverapps.RestClient.get(n,{},e,t)}},CompetitionPlayers.prototype.getAmount=function(){return this.players.length},CompetitionPlayers.prototype.listPlayers=function(e){var t=this.players.splice(0,e);return this.save(),this.reload(),t},CompetitionPlayers.prototype.load=function(){this.players=cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.COMPETITION_PLAYERS)||[]},
CompetitionPlayers.prototype.save=function(){cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.COMPETITION_PLAYERS,this.players)},CompetitionPlayers.RELOAD_INTERVAL="30 minutes";var CompetitionStatistics=function(){this.load()};CompetitionStatistics.prototype.onGameStarted=function(t){"board"===cleverapps.config.type&&(t.onChangeOutcomeListeners.competitionStatistics=function(){var e=Math.floor(t.timer.getTime()/t.board.countTotalWords()/1e3);this.saveBoardGameWordOpenByKeypadLengthTime(t.keypad.amountKeys(),e)}.bind(this))},CompetitionStatistics.prototype._newData=function(e,t){this.data[e]&&this._isAppropriateValue(e,t)&&(this.data[e]=Math.round(.9*this.data[e]+.1*t),this.save())},CompetitionStatistics.prototype._isAppropriateValue=function(e,t){return t>CompetitionStatistics.DEFAULTS[e]/5&&t<5*CompetitionStatistics.DEFAULTS[e]},CompetitionStatistics.prototype.saveBoardGameWordOpenByKeypadLengthTime=function(e,t){this._newData("brd_l"+e,t)},
CompetitionStatistics.prototype.getBoardGameWordOpenByKeypadLengthTime=function(e){return e=Math.min(Math.max(e,4),9),this.data["brd_l"+e]},CompetitionStatistics.prototype.saveOneDifferenceFindTime=function(e){console.log("save diff time",e),this._newData("diff_time",e)},CompetitionStatistics.prototype.getOneDifferenceFindTime=function(){return this.data.diff_time},CompetitionStatistics.prototype.load=function(){this.updateInfo(cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.COMPETITION_STATISTICS)||{})},CompetitionStatistics.prototype.updateInfo=function(e,t){for(var n in this.data={},CompetitionStatistics.DEFAULTS)this.data[n]=e[n]&&this._isAppropriateValue(n,e[n])?e[n]:CompetitionStatistics.DEFAULTS[n];t&&this.save(!0)},CompetitionStatistics.prototype.getInfo=function(){var e={};for(var t in CompetitionStatistics.DEFAULTS)CompetitionStatistics.DEFAULTS[t]!==this.data[t]&&(e[t]=this.data[t]);return e},CompetitionStatistics.prototype.save=function(e){cleverapps.DataLoader.save(
cleverapps.DataLoaderTypes.COMPETITION_STATISTICS,this.getInfo()),e||cleverapps.synchronizer.addUpdateTask("competitionstatistics")},CompetitionStatistics.DEFAULTS={brd_l4:8,brd_l5:15,brd_l6:20,brd_l7:30,brd_l8:40,brd_l9:50,diff_time:30};var CompetitionAlgorithm=function(e,t){this.competition=e,void 0===(this.options=t).start&&(t.start=Date.now(),t.finish=t.start+t.duration),this.lastProcessed=t.lastProcessed||t.start};CompetitionAlgorithm.prototype.start=function(){this.isPrepared()||this.prepareFromScratch(),this.competition.running&&(this.intervalProcess(),this.runInterval=setInterval(function(){this.competition.running?this.intervalProcess():this.stop()}.bind(this),this.intervalTimeout()))},CompetitionAlgorithm.prototype.stop=function(){this.runInterval&&(clearInterval(this.runInterval),this.runInterval=void 0)},CompetitionAlgorithm.prototype.getData=function(){return this.lastProcessed},CompetitionAlgorithm.prototype.process=function(e){for(var t=[],
n=0;n<this.competition.results.length;n++){var s=this.competition.results[n];if(!s.player&&Math.random()<this.botProcessProb(s,e)){if(this.options.maxResult&&s.amount===this.options.maxResult)continue;var i=s.amount+this.processAmount();this.options.maxResult&&i>this.options.maxResult&&(i=this.options.maxResult),s.amount!==i&&t.push({id:s.id,amount:i})}}if(0<t.length){for(n=0;n<t.length;n++)this.competition.updatePlayerResult(t[n].id,t[n].amount);this.competition.save()}},CompetitionAlgorithm.prototype.isPrepared=function(){for(var e=0;e<this.competition.results.length;e++)if(!this.competition.results[e].player)return void 0!==this.competition.results[e].force;return!0},CompetitionAlgorithm.prototype.prepareFromScratch=function(){var e=this.competition.results;e.forEach(function(e){e.player||(e.amount=0,e.force=Math.floor(Math.random()*CompetitionAlgorithm.BOT_MAX_FORCE),this.options.minBotForce&&(e.force=Math.max(e.force,this.options.minBotForce)),e.sleep=this.generateSleepPeriod())},
this);var t=this.options.superBotsForce;if(void 0===t){var n=Math.random();t=n<.2?0:n<.4?CompetitionAlgorithm.BOT_SUPER_FORCE:CompetitionAlgorithm.BOT_MAX_FORCE}if(0<e.length){var s=0,i=5;this.options.superBots&&(s=this.options.superBots[0],i=this.options.superBots[1]);var o=Math.floor(Math.random()*i)+1;o=Math.max(s,o);for(var r=0;r<o;r++)e[Math.floor(Math.random()*e.length)].force=t}this.competition.save()},CompetitionAlgorithm.prototype.generateSleepPeriod=function(){var e=this.options.finish-this.options.start;if(!(e<cleverapps.parseInterval("1 hour"))){var t=Math.floor(e/4+Math.random()*e/4),n=this.options.start+Math.floor(Math.random()*(e-t));return{s:n,f:n+t}}},CompetitionAlgorithm.prototype.offlineCoef=function(){return.3},CompetitionAlgorithm.prototype.playerAheadBotCoef=function(e){
return void 0!==this.options.playerAheadBotCoef?this.options.playerAheadBotCoef:e.force===CompetitionAlgorithm.BOT_SUPER_FORCE?10:e.force===CompetitionAlgorithm.BOT_MAX_FORCE?2:e.force===CompetitionAlgorithm.BOT_MAX_FORCE-1?1.5:e.force===CompetitionAlgorithm.BOT_MAX_FORCE-2?1.2:1},CompetitionAlgorithm.prototype.playerAheadBot5AmountCoef=function(e){return void 0!==this.options.playerAheadBotBigDifferenceCoef?this.options.playerAheadBotBigDifferenceCoef:e.force===CompetitionAlgorithm.BOT_SUPER_FORCE?100:2},CompetitionAlgorithm.prototype.botAheadPlayerCoef=function(e){return void 0!==this.options.botAheadPlayerCoef?this.options.botAheadPlayerCoef:.3},CompetitionAlgorithm.prototype.botAheadPlayer5AmountCoef=function(e){return void 0!==this.options.botAheadPlayerBigDifferenceCoef?this.options.botAheadPlayerBigDifferenceCoef:.1},CompetitionAlgorithm.prototype.mediumAmount=function(){var e=this.options.step;return e&&0<e.length?e.reduce(function(e,t){return e+t},0)/e.length:1},
CompetitionAlgorithm.prototype.processAmount=function(){var e=this.options.step;return e?2<e.length?cleverapps.Random.choose(e,!1):cleverapps.Random.random(e[0],e[1],!1):1},CompetitionAlgorithm.prototype.getBotForceCoef=function(e){if(this.options.useRealForce)return e;if(e===CompetitionAlgorithm.BOT_SUPER_FORCE)return 7;return[0,.03,.08,.15,.25,.35,.5,.7,1,1.5,2][e]},CompetitionAlgorithm.prototype.sleepNow=function(e){return!!e.sleep&&(e.sleep.s<=this.lastProcessed&&this.lastProcessed<=e.sleep.f)},CompetitionAlgorithm.prototype.bigDistanceLength=function(){return this.options.bigDistanceLength?this.options.bigDistanceLength:5},CompetitionAlgorithm.prototype.calcFromBotAmountCoef=function(e){if(!this.options.maxResult||this.options.maxResult<2)return 1;var t=(this.options.maxResult-1)/2;return 1.25-.75*(e.amount-t)/t},CompetitionAlgorithm.prototype.botProcessProb=function(e,t){if(this.sleepNow(e))return 0;var n=this.competition.player.amount,s=this.perIntervalProb(t)
;return e.amount>=n?(s*=this.botAheadPlayerCoef(e),e.amount>n+this.bigDistanceLength()*this.mediumAmount()&&(s*=this.botAheadPlayer5AmountCoef(e))):(s*=this.playerAheadBotCoef(e),n>e.amount+this.bigDistanceLength()*this.mediumAmount()&&(s*=this.playerAheadBot5AmountCoef(e))),this.options.botFinishCoef&&this.options.maxResult&&e.amount+this.mediumAmount()>=this.options.maxResult&&(s*=this.options.botFinishCoef),(s*=this.calcFromBotAmountCoef(e))*this.playerEpisodeCoef()*this.getBotForceCoef(e.force)},CompetitionAlgorithm.prototype.perIntervalProb=function(e){return e?(this.offlinePerIntervalProb||(this.offlinePerIntervalProb=this.offlineCoef()*this.intervalTimeout(e)/this.maxForceBotAverageProcessTimeout()),this.offlinePerIntervalProb):(this.onlinePerIntervalProb||(this.onlinePerIntervalProb=this.intervalTimeout(e)/this.maxForceBotAverageProcessTimeout()),this.onlinePerIntervalProb)},CompetitionAlgorithm.prototype.intervalTimeout=function(e){return cleverapps.parseInterval(
e?"10 minutes":"5 seconds")},CompetitionAlgorithm.prototype.freeze=function(e){var t=Date.now();this.lastProcessed>t?this.lastProcessed+=e:this.lastProcessed=t+e},CompetitionAlgorithm.prototype.intervalProcess=function(){var e=Math.min(Date.now(),this.options.finish);if(!(this.lastProcessed>e)){var t=this.intervalTimeout(!0),n=this.intervalTimeout();if(!1!==this.options.offlineProcess)for(;this.lastProcessed<e-2*t;)this.lastProcessed+=t,this.process(!0);for(;this.lastProcessed<e-n/2;)this.lastProcessed+=n,this.process();this.lastProcessed=e,this.competition.save()}},CompetitionAlgorithm.prototype.maxForceBotAverageProcessTimeout=function(){return this.options.averageProcessTimeout?this.options.averageProcessTimeout:cleverapps.parseInterval("3 minutes")},CompetitionAlgorithm.prototype.playerEpisodelevel=function(){return 10<=levels.user.episode?2:5<=levels.user.episode?1:0},CompetitionAlgorithm.prototype.playerEpisodeCoef=function(){return this.options.noPlayerEpisodeCoef?1:[.1,.13,.15
][this.playerEpisodelevel()]},CompetitionAlgorithm.BOT_MAX_FORCE=10,CompetitionAlgorithm.BOT_SUPER_FORCE=100,cleverapps.Notification=cc.Scale9Sprite.extend({ctor:function(){this._super(bundles.main.frames.notification_bg_png),this.setLocalZOrder(cleverapps.styles.Notification.zOrder),this.baseHeight=new cc.Sprite(bundles.main.frames.notification_bg_png).height},setMessage:function(e,t){this.text&&(this.text.removeFromParent(!0),this.text=void 0),this.image&&(this.image.removeFromParent(!0),this.image=void 0);var n,s,i=cleverapps.styles.Notification,o=cleverapps.UI.generateTTFText(e,cleverapps.styles.FONTS.NOTIFICATION_TEXT?cleverapps.styles.FONTS.NOTIFICATION_TEXT:cleverapps.styles.FONTS.TEXT,t.toReplace),r=.85*cleverapps.UI.getSceneSize().width,a=!1;t.image&&(n=t.image.width*t.image.scale,s=t.image.height*t.image.scale,r-=n+i.image.margin),o.width>r&&(a=!0,o.setDimensions(r,0),o.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER)),this.text=o,this.addChild(o);var c=Math.max(i.width,
o.width+i.paddingX+(t.image?n+i.image.margin:0)),l=Math.max(i.height,this.baseHeight);a&&(l=Math.max(l,o.height-2*i.text.y+i.paddingY)),t.image&&(l=Math.max(l,s+2*i.image.margin-2*i.text.y+i.paddingY)),this.setContentSize(c,l),o.setPositionRound(t.image?this.width/2+n/2+i.image.margin/2:this.width/2,this.height/2+i.text.y),t.image&&(this.image=t.image,this.addChild(t.image),t.image.setPositionRound(n/2+2*i.image.margin,this.height/2+i.text.y+i.image.y)),this.customize(),this.setPosition(this.base),cleverapps.audio.playSound(bundles.main.urls.notification_effect),this.runAction(new cc.Sequence(new cc.MoveTo(.2,this.target),new cc.DelayTime(3),new cc.MoveTo(.5,this.base),new cc.RemoveSelf))},customize:function(){var e=cc.director.getWinSize();this.base=cc.p(e.width/2,e.height+this.height/2),this.target=cc.p(e.width/2,e.height-this.height/2-cleverapps.UI.getSceneOffsetY()+cleverapps.styles.Notification.targetY)}}),cleverapps.Notification.create=function(e,t){t=t||{}
;var n=cc.director.getRunningScene();if(n&&Messages.isInitialized()&&e&&cleverapps.allInitialized&&!cleverapps.scenes.isLoaderScene()){var s=n.getChildByTag(cleverapps.Notification.TAG);s?s.stopAllActions():((s=new cleverapps.Notification).setTag(cleverapps.Notification.TAG),n.addChild(s)),this.leaveOnResize=t.leaveOnResize,s.setMessage(e,t)}},cleverapps.Notification.remove=function(e){var t=cc.director.getRunningScene();if(t&&!cleverapps.scenes.isLoaderScene()&&(!e||!this.leaveOnResize)){var n=t.getChildByTag(cleverapps.Notification.TAG);n&&n.removeFromParent()}},cleverapps.Notification.TAG=101,cleverapps.styles.Notification={zOrder:22,targetY:90,image:{margin:15,y:-10},text:{y:-30},height:200,width:150,paddingX:80,paddingY:30};var PagingScrollView=cc.Node.extend({ctor:function(e){this._super(),e=e||{},this.currentPage=e.beginPage?e.beginPage:0,this.amountPages=e.amountPages?e.amountPages:0;var t=this.styles=e.styles
;this.direction=void 0!==t.direction?t.direction:PagingScrollView.DIRECTIONS.Horizontal,this.autoScroll=!t.noAutoScroll,this.visiblePages=t.visiblePages,this.prevPageShowed=t.prevEpisodeShowed,this.firstOffset=0,this.pageHeight=e.pageHeight,this.pageWidth=e.pageWidth,this.middlePage=!1,cc.eventManager.addListener({event:cc.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:e.swallowTouches,onTouchBegan:this.onTouchBegan.bind(this),onTouchMoved:this.onTouchMoved.bind(this),onTouchEnded:this.onTouchEnded.bind(this),onTouchCancelled:this.onTouchEnded.bind(this)},this),e.noWheelScroll||cc.eventManager.addListener({event:cc.EventListener.MOUSE,onMouseScroll:function(e){if(!this.isMoving&&!cleverapps.windows.list.length){var t=e._scrollY;if(0!=t)if(this.autoScroll)0<t?this.onNextPageListener():this.onPrevPageListener();else{t=0<t?cleverapps.styles.PagingScrollView.wheelScrollSpeed:-cleverapps.styles.PagingScrollView.wheelScrollSpeed,this.basePosition=this.container.getPosition()
;var n=this.getScrollLength();this.direction===PagingScrollView.DIRECTIONS.Horizontal?(t=Math.max(this.basePosition.x-this.firstOffset,Math.min(n.x+this.basePosition.x,t)),this.deltaMove([-t,0])):(t=Math.max(this.basePosition.y-this.firstOffset,Math.min(n.y+this.basePosition.y,t)),this.deltaMove([0,-t]))}}}.bind(this)},this),this.onNextPageListener=function(){},this.onPrevPageListener=function(){},this.onScrolledToCurrentPage=function(){},this.container=new cc.Node,this.addChild(this.container),this.scheduleUpdate()},update:function(e){this._super(e),1<this.visiblePages&&this.calcCurrentPage(!0)},calcFirstOffset:function(){this.styles.firstOffset?this.firstOffset=this.styles.firstOffset:1<this.visiblePages&&(this.isHorizontal()?this.firstOffset=this.pageWidth/2:this.firstOffset=this.pageHeight/2)},getScrollLength:function(){var e={x:0,y:0};return this.direction===PagingScrollView.DIRECTIONS.Horizontal?e.x=(this.amountPages-this.visiblePages)*this.pageWidth:(e.y=(
this.amountPages-this.visiblePages)*this.pageHeight+cleverapps.styles.PagingScrollView.comingSoonExtraLength[cleverapps.wideMode.mode],e.y-=2*cleverapps.UI.getSceneOffsetY()),e},onTouchBegan:function(e){if(cleverapps.metha.isFocused())return!1;if(this.touchBeganId=e.getID(),this.isMoving){if(this.autoScroll)return!1;this.container.stopAllActions(),this.calcCurrentPage()}var t=this.convertTouchToNodeSpace(e);return this.horizontalLookDirection=void 0,this.basePoint=t,this.prevPoint=t,this.prevPointTime=0,this.prevPointCalcTimes=0,this.deltaPoint=0,this.basePosition=this.container.getPosition(),this.isMoving=!1,cc.rectContainsPoint(cc.rect(0,0,this.width,this.height),t)},deltaMove:function(e,t){var n=this.getScrollLength();if(this.isHorizontal()){if(this.basePosition.x+e[0]>this.firstOffset+1e-6||this.basePosition.x+e[0]+1e-6<-n.x)return void(this.isMoving=!1)}else if(this.basePosition.y+e[1]>this.firstOffset+1e-6||this.basePosition.y+e[1]+1e-6<-n.y)return void(this.isMoving=!1)
;var s=t?PagingScrollView.MOVE_TRESHOLD:0;(Math.abs(e[0])>s*this.pageWidth||Math.abs(e[1])>s*this.pageHeight)&&(this.isMoving=!0,this.showPages(e)),this.isMoving&&(cleverapps.audio.playSound(bundles.main.urls.pagingscroll),t?(this.container.setPosition(this.basePosition.x+e[0],this.basePosition.y+e[1]),this.autoScroll||this.calcCurrentPage()):(this.showPages(e),this.container.runAction(new cc.Sequence(new cc.MoveTo(.3,{x:this.basePosition.x+e[0],y:this.basePosition.y+e[1]}),new cc.CallFunc(function(){this.isMoving=!1,this.calcCurrentPage()}.bind(this))))))},onTouchMoved:function(e){if(this.touchBeganId!==e.getID())return!1;var t=this.convertTouchToNodeSpace(e),n=[t.x-this.basePoint.x,t.y-this.basePoint.y];if(!this.autoScroll&&this.isVertical()&&this.width<cleverapps.styles.SCENE_MAX_WIDTH&&!cleverapps.styles.horizontalScrollDisabled&&(void 0===this.horizontalLookDirection&&(Math.abs(n[0])>PagingScrollView.MOVE_TRESHOLD*this.pageWidth||Math.abs(n[1]
)>PagingScrollView.MOVE_TRESHOLD*this.pageHeight)&&(Math.abs(n[0])>2*Math.abs(n[1])?this.horizontalLookDirection=!0:this.horizontalLookDirection=!1),this.horizontalLookDirection)){var s=n[0];return s=Math.min(s,(cleverapps.styles.SCENE_MAX_WIDTH-this.width)/2-this.basePosition.x),s=Math.max(s,-(cleverapps.styles.SCENE_MAX_WIDTH-this.width)/2-this.basePosition.x),void this.container.setPosition(this.basePosition.x+s,this.basePosition.y)}this.isHorizontal()?n[1]=0:n[0]=0,this.autoScroll||this.calcDeltaPoint(t),this.deltaMove(n,!0)},onEnter:function(){this._super(),this.showCurrentPageOnly()},onExitTransitionDidStart:function(){this._super(),this.showCurrentPageOnly()},showPages:function(e){for(var t={},n=0;n<this.visiblePages;n++)t[this.currentPage+n]=!0;this.prevPageShowed&&(t[this.currentPage-1]=!0);var s=this.currentPage+(e[0]<0||e[1]<0?this.visiblePages:-1);if(t[s]=!0,"number"==typeof this.middlePage)t[this.middlePage]&&(t[this.middlePage+1]=!0),t[this.middlePage]=!0;else{
var i=this.currentPage+(e[0]<0||e[1]<0?-1:this.visiblePages);t[i]=!0}this.getPages().forEach(function(e){e.setVisible(t[e.pageNo])}.bind(this))},getPages:function(){return this.container.getChildren().filter(function(e){return void 0!==e.pageNo})},getVisiblePages:function(){return this.container.getChildren().filter(function(e){return void 0!==e.pageNo&&e.visible})},showCurrentPageOnly:function(){this.getPages().forEach(function(e){e.setVisible(this.currentPage+(this.prevPageShowed?-1:0)<=e.pageNo&&e.pageNo<this.currentPage+this.visiblePages||this.middlePage===e.pageNo)}.bind(this))},isHorizontal:function(){return this.direction===PagingScrollView.DIRECTIONS.Horizontal},isVertical:function(){return!this.isHorizontal()},getCurrentPagePosition:function(e){void 0===e&&(e=this.currentPage);var t=new cc.p(this.isHorizontal()?-e*this.pageWidth:0,this.isVertical()?-e*this.pageHeight:0);if(1<this.visiblePages){t=cc.p(t.x+(this.isHorizontal()?this.firstOffset:0),t.y+(this.isVertical(
)?this.firstOffset:0));var n=this.getScrollLength();this.isHorizontal()?t.x=Math.min(this.firstOffset,Math.max(t.x,-n.x)):t.y=Math.min(this.firstOffset,Math.max(t.y,-n.y))}return t},calcCurrentPage:function(e){var t=this.container.getPosition(),n=this.pageWidth;this.isHorizontal()?t=t.x:(t=t.y,n=this.pageHeight),0<t&&(t=0);var s=this.currentPage;this.currentPage=cleverapps.config.rpg?Math.floor(-t/n)+1:Math.round(-t/n),e&&s===this.currentPage||(this.middlePage=this.currentPage+this.visiblePages,this.showCurrentPageOnly(),s<this.currentPage?this.onNextPageListener():s>this.currentPage&&this.onPrevPageListener())},scrollToPositionInPage:function(e,t){var n,s=this.getCurrentPagePosition();this.direction===PagingScrollView.DIRECTIONS.Horizontal?((n=this.width/2+e.x)<0&&0===this.currentPage&&(n=0),s.x=Math.max(this.container.x-n,-(this.amountPages-1)*this.width)):((n=this.height/2+e.y-.3*this.height)<0&&0===this.currentPage&&(n=0),s.y=Math.max(this.container.y-n,-(this.amountPages-1
)*this.height),s.y<0&&(s.y+=cleverapps.UI.getSceneOffsetY())),this.scrollToPosition(s,t)},scrollToPosition:function(e,t,n){t?(this.container.setPosition(e),this.calcCurrentPage()):(this.container.stopAllActions(),n=n||1,this.showPages([e.x-this.container.x,e.y-this.container.y]),this.isMoving=!0,this.container.runAction(new cc.Sequence(new cc.DelayTime(1),new cc.MoveTo(n,e),new cc.CallFunc(function(){this.calcCurrentPage(),this.isMoving=!1}.bind(this)))))},scrollToCurrentPage:function(e,t,n,s){var i=this.getCurrentPagePosition(s);if(e)this.container.setPosition(i),this.autoScroll?this.showCurrentPageOnly():this.calcCurrentPage(),this.onScrolledToCurrentPage();else{t&&(cleverapps.audio.playSound(bundles.main.urls.window_effect),"riddles"===cleverapps.config.name&&(i=cc.p(i.x+(this.isHorizontal()?.167*this.pageWidth:0),i.y+(this.isVertical()?.167*this.pageHeight:0)))),this.container.stopAllActions();var o=.25;n&&(o=cleverapps.styles.PagingScrollView.slowScroll.timeout),this.showPages([
this.container.x-i.x,i.y-this.container.y]),this.isMoving=!0,this.container.runAction(new cc.Sequence(new cc.MoveTo(o,i),new cc.CallFunc(function(){this.autoScroll?this.showCurrentPageOnly():this.calcCurrentPage(),this.onScrolledToCurrentPage(),this.isMoving=!1}.bind(this))))}},calcDeltaPoint:function(e){var t=Date.now();if(0===this.prevPointTime)return this.prevPointTime=t,void(this.prevPoint=e);this.prevPointTime<t-PagingScrollView.SCROLL_SPEED_PERIODS[this.prevPointCalcTimes]&&(this.prevPointTime<t-200&&(this.prevPoint=e),this.deltaPoint=this.isHorizontal()?e.x-this.prevPoint.x:e.y-this.prevPoint.y,this.deltaPoint=this.deltaPoint/(t-this.prevPointTime)*cleverapps.styles.PagingScrollView.touchScrollSpeedLevel,this.prevPointTime=t,this.prevPointCalcTimes<PagingScrollView.SCROLL_SPEED_PERIODS.length-1&&this.prevPointCalcTimes++,this.prevPoint=e)},onTouchEnded:function(e){if(this.touchBeganId!==e.getID())return!1;if(this.isMoving=!1,this.autoScroll){var t=this.getCurrentPagePosition(),
n=this.container.getPosition();Math.abs(t.x-n.x)>PagingScrollView.SWIPE_TRESHOLD*this.pageWidth||Math.abs(t.y-n.y)>PagingScrollView.SWIPE_TRESHOLD*this.pageHeight?n.x<t.x||n.y<t.y?this.onNextPageListener():this.onPrevPageListener():this.scrollToCurrentPage(!1)}else{if(this.horizontalLookDirection)return this.isMoving=!0,void this.container.runAction(new cc.Sequence(new cc.MoveTo(.5,{x:0,y:this.basePosition.y}).easing(cc.easeOut(3)),new cc.CallFunc(function(){this.isMoving=!1}.bind(this))));this.calcCurrentPage(),this.calcDeltaPoint(this.convertTouchToNodeSpace(e)),this.deltaPoint=Math.max(Math.min(Math.round(this.deltaPoint),5),-5),this.showPages([this.deltaPoint,this.deltaPoint]),this.isMoving=!0;var s=this.container.getPosition(),i=Math.max(.5,Math.sqrt(Math.abs(this.deltaPoint))/2),o=this.getScrollLength();this.direction===PagingScrollView.DIRECTIONS.Horizontal?(s.x=Math.min(this.firstOffset,Math.max(s.x+this.deltaPoint*cleverapps.styles.PagingScrollView.scrollInertia,-o.x)),s.y=0
):(s.x=0,s.y=Math.min(this.firstOffset,Math.max(s.y+this.deltaPoint*cleverapps.styles.PagingScrollView.scrollInertia,-o.y))),this.container.runAction(new cc.Sequence(new cc.MoveTo(i,s).easing(cc.easeOut(2)),new cc.CallFunc(function(){this.calcCurrentPage(),this.isMoving=!1}.bind(this))))}},addPage:function(e){this.container.addChild(e),e.onShow&&e.onShow(),this.isMoving||this.showCurrentPageOnly()}});cleverapps.styles.PagingScrollView={touchScrollSpeedLevel:2,wheelScrollSpeed:700,scrollInertia:200,comingSoonExtraLength:[0,0,0],slowScroll:{timeout:.8}},PagingScrollView.DIRECTIONS={Horizontal:0,Vertical:1},PagingScrollView.MOVE_TRESHOLD=.01,PagingScrollView.SWIPE_TRESHOLD=.05,PagingScrollView.SCROLL_SPEED_PERIODS=[25,50,75,100];var MapScrollView=cc.Node.extend({ctor:function(){this._super(),this.container=new cc.Node,this.addChild(this.container),this.scheduleUpdate(),this.scrollHandler=new cleverapps.UI.MapScrollHandler(this),this.zoom=1,this.updateChildren=cleverapps.throttle(25,
this.checkChildrenVisibility.bind(this))},zoomTo:function(t){var n=this.zoom,s=Date.now(),i=(t.zoom-n)/t.timeout;this._zoomInterval=setInterval(this.createListener(function(){var e=Date.now()-s;if(e>=t.timeout)return this.setZoom(t.zoom),clearInterval(this._zoomInterval),void(t.onComplete&&t.onComplete());this.setZoom(n+i*e,t.centerPoint)}),13)},setZoom:function(e,t){this.scrollHandler.stopAutoScroll();var n=cc.director.getWinSize(),s=this.getContainerSize();e=Math.max(e,cleverapps.styles.WorldMap.zoom.minScale,n.width/s.width,n.height/s.height),e=Math.min(e,1.1);var i=this.zoom;this.zoom=e,this.setScale(this.zoom);var o=this.getContainerPosition();this.setContentSize2(Math.ceil(n.width/this.zoom),Math.ceil(n.height/this.zoom));var r=0,a=0;if(i&&(r=Math.ceil(n.width/this.zoom)-Math.ceil(n.width/i),a=Math.ceil(n.height/this.zoom)-Math.ceil(n.height/i)),t){var c=Math.abs(t.x)+n.width/2-s.width/2;0<c&&(0<t.x?r-=c:r+=c);var l=Math.abs(t.y)+n.height/2-s.height/2;0<l&&(0<t.y?a-=l:a+=l)}
this.setContainerPosition(this.availableScrollPosition({x:o.x+r/2,y:o.y+a/2}),this.zoom<i)},setContainerSize:function(e){this.innerWidth=e.width,this.innerHeight=e.height,this.container.setContentSize2(e)},getContainerSize:function(){return this.container.getContentSize()},getContainerPosition:function(){return this.container.getPosition()},setContainerPosition:function(e,t){(e.x!==this.container.getPositionX()||e.y!==this.container.getPositionY()||t)&&(this.container.setPosition(e),this.updateChildren(),this.scrollHandler.afterContainerMove())},update:function(e){this._super(e),this.scrollHandler.processAutoScroll(e)},onEnter:function(){this._super(),this.addControls()},checkChildrenVisibility:function(){this.container.getChildren().forEach(function(e){!e.visible&&this.isInContainer(e)?e.visible=!0:e.visible&&!this.isInContainer(e)&&(e.visible=!1)},this)},isInContainer:function(e){var t=cleverapps.styles.MapScrollView.visiblePadding,n=this.getContainerPosition(),s=this.getContentSize(
),i=cc.rect(-n.x,-n.y,s.width,s.height),o=e.getBoundingBox();o.x-=t.width/2,o.y-=t.height/2,o.width+=t.width/2,o.height+=t.height/2;var r=cc.rectIntersection(i,o);return 0<r.width&&0<r.height},addControls:function(){cc.eventManager.addListener({event:cc.EventListener.MOUSE,onMouseScroll:function(e){if(cleverapps.metha.isControlEnabled()){var t=e._scrollY;0!==t&&(t=0<t?.05:-.05,this.setZoom(this.zoom+t))}}.bind(this)},this),cc.eventManager.addListener({event:cc.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:!1,onTouchBegan:this.onTouchBegan.bind(this),onTouchMoved:this.onTouchMoved.bind(this),onTouchEnded:this.onTouchEnded.bind(this),onTouchCancelled:this.onTouchEnded.bind(this)},this),cc.sys.isMobile&&cc.sys.capabilities.touches&&this.addPinchZoom()},addPinchZoom:function(){var i={},o=0,r=function(){var e=Object.keys(i).slice(0,2).map(function(e){return i[e]},this),t=e[0],n=e[1];return Math.abs(t.x-n.x)+Math.abs(t.y-n.y)},e=function(e){for(var t=0;t<e.length&&t<2;t++)i[e[t].getID(
)]=e[t].getLocationInView();1<Object.keys(i).length&&(this.pinchZooming=!0,o=r())}.bind(this),t=function(e){for(var t=0;t<e.length&&t<2;t++)i[e[t].getID()]=e[t].getLocationInView();if(cleverapps.metha.isControlEnabled()&&1<Object.keys(i).length){var n=r(),s=o-n;3<Math.abs(s)&&(o=n,this.setZoom(this.zoom-85e-5*s))}}.bind(this),n=function(e){for(var t=0;t<e.length;t++)delete i[e[t].getID()];Object.keys(i).length<2&&(this.pinchZooming=!1)}.bind(this);cc.eventManager.addListener({event:cc.EventListener.TOUCH_ALL_AT_ONCE,onTouchesBegan:e,onTouchesMoved:t,onTouchesCancelled:n,onTouchesEnded:n},this)},onTouchBegan:function(e){return!!cleverapps.metha.isControlEnabled()&&(this.container.stopAllActions(),this.scrollHandler.handlePress(),cc.rectContainsPoint(cc.rect(0,0,this.width,this.height),this.convertTouchToNodeSpace(e)))},onTouchMoved:function(e){if(!cleverapps.metha.isControlEnabled())return!1;var t=this.convertToNodeSpace(e.getLocation()),n=this.convertToNodeSpace(e.getPreviousLocation()
),s=cc.pSub(t,n);this.pinchZooming||(this.scrollHandler.gatherMoveData(s),this.moveContainer(s))},onTouchEnded:function(e){if(!cleverapps.metha.isControlEnabled())return!1;if(!this.pinchZooming){var t=this.convertToNodeSpace(e.getLocation()),n=this.convertToNodeSpace(e.getPreviousLocation()),s=cc.pSub(t,n);this.scrollHandler.handleRelease(s)}},moveContainer:function(e){var t=cc.pAdd(this.getContainerPosition(),e);this.setContainerPosition(t)}});cleverapps.styles.MapScrollView={visiblePadding:{width:40,height:40}};var PagesViewParallax=function(e,t,n){if(this.parallaxBackgrounds=[],this.direction=n,e&&e.layers){for(var s=cleverapps.UI.getSceneSize(),i="scene"===e.width?s.width:e.width,o="scene"===e.height?s.height:e.height,r=0;r<e.layers[cleverapps.wideMode.mode];r++){var a,c=bundles.main.urls["episodes_bg_jpg_"+r],l=bundles[e.bundle];if(l&&(a=l.jsons["side_animation_"+r]),c||a){var p=new ParallaxBackground(e.speed[r],this.direction,function(e){var t=new cc.Node;if(t.setContentSize2(i,o
),t.setAnchorPoint2(),c){var n=new cc.Sprite(c);n.setPositionRound(t.width/2,t.height/2),this.parallaxBackgrounds.push(n),t.addChild(n)}if(a){var s=new cleverapps.Spine(a);s.setAnimation(0,"animation",!0),t.addChild(s),s.setPositionRound(t.width/2,t.height/2)}return t}.bind(this));p.setLocalZOrder(e.zIndex[r]),t.addChild(p)}}this.updateScale()}};PagesViewParallax.prototype.updateScale=function(){var n=cc.director.getWinSize();this.parallaxBackgrounds.forEach(function(e){var t=Math.max(n.width/e.width,n.height/e.height);e.setScale(t)})};var ParallaxBackground=cc.Node.extend({ctor:function(e,t,n){this._super(),this.ratio=e,this.direction=t;var s=this.frame1=new ParallaxFrame(n(0),cc.p(0,0),t);this.addChild(s);var i=this.frame2=new ParallaxFrame(n(1),cc.p(s.width-2,s.height-2),t);this.addChild(i),this.scheduleUpdate()},onEnterTransitionDidFinish:function(){this._super(),this.updatePosition()},update:function(e){this._super(e),this.updatePosition()},updatePosition:function(){
this.y=-this.parent.y*(1-this.ratio),this.x=-this.parent.x*(1-this.ratio),this.frame1.updatePosition(),this.frame2.updatePosition()}}),ParallaxFrame=cc.Node.extend({ctor:function(e,t,n){this._super(),this.direction=n,this.offset=t,this.frame=e,this.addChild(e),this.setContentSize2(e.getContentSize()),this.setAnchorPoint2(),this.setPositionRound(this.width/2,this.height/2)},updatePosition:function(){var e=cleverapps.UI.getSceneSize(),t=this.frame,n=t.width,s=t.height;if(this.direction===PagingScrollView.DIRECTIONS.Horizontal){var i=-(this.parent.parent.x+this.parent.x);t.x=Math.floor(i/n)*n+n/2+this.offset.x,t.y=s/2,t.visible=0<=-i+t.x+n/2&&-i+t.x-n/2<e.width}else{var o=-(this.parent.parent.y+this.parent.y);t.x=n/2,t.y=Math.floor(o/s)*s+s/2+this.offset.y,t.visible=0<=-o+t.y+s/2&&-o+t.y-s/2<e.height}}}),Fireworks=cc.Node.extend({ctor:function(e,t){this._super(),this.loop=void 0===e||e,cleverapps.bundleLoader.loadBundle("fireworks",{onSuccess:function(){
this.sound=t||bundles.fireworks.urls.fireworks_effect,this.runOnePass()}.bind(this)}),this.setLocalZOrder(100)},runOnePass:function(){var e=cleverapps.styles.Fireworks.delays,t=cleverapps.styles.SCENE_HEIGHT*cleverapps.styles.SCENE_MAX_WIDTH,n=cleverapps.UI.getSceneSize(),s=n.height*n.width,i=Math.round(s/t*e.length);e=(e=e.sort(function(e,t){return Math.random()-.5})).slice(0,i);var o=cleverapps.wait(e.length,this.runOnePass.bind(this));e.forEach(function(e){this.runAction(new cc.Sequence(new cc.DelayTime(e/1e3),new cc.CallFunc(function(){this.createFirework(),this.loop&&o()}.bind(this))))}.bind(this))},createFirework:function(e){if(!cleverapps.flags.fireworkDisabled){var t=FireworksAnimation.Create();t.setScale(.3*Math.random()+.7),t.setAnimation(0,"animation"+(Math.floor(Math.random()*Fireworks.AMOUNT_ANIMATIONS)+1),!1),t.setCompleteListener(function(){t.removeFromParent(),cc.pool.putInPool(t)});var n=cleverapps.UI.getSceneSize();t.setPositionRound({random:{start:0,end:n.width}},{
random:{start:Math.round(n.height/3),end:n.height}}),this.addChild(t),this.runAction(new cc.Sequence(new cc.DelayTime(.5),new cc.CallFunc(function(){cleverapps.audio.playSound(this.sound)}.bind(this))))}}}),FireworksAnimation=cleverapps.Spine.extend({ctor:function(){this._super(bundles.fireworks.jsons.fireworks_json)}});FireworksAnimation.Create=function(){return cc.pool.hasObject(FireworksAnimation)?cc.pool.getFromPool(FireworksAnimation):new FireworksAnimation},Fireworks.AMOUNT_ANIMATIONS=5,cleverapps.styles.Fireworks={delays:[0,100,200,300,400,500,3e3,3050,3130,3330,3400,4600,6e3,6030,6130,6200,6400,6420,6450]};var FingerView=cc.Node.extend({ctor:function(t){t=t||{},this._super(),this.setAnchorPoint2(),this.setScale(t.scaleX||1,t.scaleY||1),this.finger=new cc.Sprite(t.image?t.image:bundles.finger.frames.tutorial_hand_png),this.finger.setAnchorPoint(FingerView.ANCHOR_POINT),this.moveSpeed=500,this.actions=[],t.pathColor&&(this.pathNode=new cleverapps.Path(cc.color(t.pathColor.r,
t.pathColor.g,t.pathColor.b,FingerView.PATH_BASE_ALPHA)),this.pathNode.lineWidth=FingerView.PATH_LINE_WIDTH,this.addChild(this.pathNode,-2),this.pathNode.runAction(new cc.RepeatForever(new cc.Sequence(new cc.DelayTime(.02),new cc.CallFunc(this.drawPath.bind(this)))))),this.addChild(this.finger),this.finger.setOpacity(0),t.control&&cleverapps.metha.registerControl(t.control,this.createListener(function(e){this.stopAllActions(),e&&t.showDelay?this.runAction(new cc.Sequence(new cc.DelayTime(t.showDelay),new cc.Show)):this.setVisible(e)}.bind(this)))},standardLoop:function(e){e=e||{},this.fadeIn({x:0,y:0}),this.addPressLoops(e.loops||2),this.fadeOut(),this.delay(e.delay||1),this.run({looped:!0})},addPressLoops:function(e){for(var t=0;t<(e||1);t++)this.delay(.1),this.press(),this.delay(.1),this.unPress()},clearActions:function(){this.actions=[]},drawPath:function(){this.pathNode.draw(this.finger.getPosition())},addAction:function(e){this.actions.push(e)},run:function(e){this.currentAction=0
,this.runOptions=e||{},this.startCurrentAction()},runOnce:function(e){this.run({looped:!1,onFinish:function(){this.clearActions(),e&&e()}.bind(this)})},startCurrentAction:function(){if(0!==this.actions.length){if(this.currentAction===this.actions.length){if(!this.runOptions.looped)return void(this.runOptions.onFinish&&this.runOptions.onFinish());this.currentAction=0,this.runOptions.onIterationFinish&&this.runOptions.onIterationFinish()}this.actions[this.currentAction](this.nextAction.bind(this))}},nextAction:function(){this.currentAction++,this.startCurrentAction()},fadeIn:function(t,n){n=n||cc.p(t.x,t.y+cleverapps.styles.FingerView.dy),this.addAction(function(e){this.finger.setOpacity(0),this.finger.setScale(1),this.finger.setRotation(FingerView.FINGER_UNPRESSED_ANGLE),this.pressed=!1,this.finger.setPosition(n),this.finger.runAction(new cc.Sequence(new cc.MoveTo(.3,cc.p(t.x+cleverapps.styles.FingerView.deltaXforCircle,t.y)),new cc.CallFunc(e))),this.finger.runAction(new cc.FadeIn(.3))
}.bind(this))},fadeOut:function(){this.addAction(function(e){this.finger.runAction(new cc.MoveTo(.3,cc.p(this.finger.x,this.finger.y-cleverapps.styles.FingerView.dy))),this.finger.runAction(new cc.Sequence(new cc.FadeOut(.3),new cc.CallFunc(e)))}.bind(this))},delay:function(t){this.addAction(function(e){this.finger.runAction(new cc.Sequence(new cc.DelayTime(t),new cc.CallFunc(e)))}.bind(this))},moveTo:function(n){this.addAction(function(e){var t=Math.sqrt((n.x-this.finger.x)*(n.x-this.finger.x)+(n.y-this.finger.y)*(n.y-this.finger.y))/this.moveSpeed;this.finger.runAction(new cc.Sequence(new cc.MoveTo(t,n),new cc.CallFunc(function(){this.pressed&&this.pathNode&&this.pathNode.push(n),e()}.bind(this))))}.bind(this))},unPress:function(){this.addAction(function(e){this.pressed=!1,this.finger.runAction(new cc.RotateTo(.2,FingerView.FINGER_UNPRESSED_ANGLE)),this.pathNode&&this.pathNode.animateFadeOut(400),this.finger.runAction(new cc.Sequence(new cc.ScaleTo(.2,1),new cc.CallFunc(e)))}.bind(
this))},press:function(s){s=s||{},this.addAction(function(n){this.pressed=!0,this.pathNode&&(this.pathNode.reset(),this.pathNode.push(this.finger.getPosition())),this.finger.runAction(new cc.RotateTo(.2,FingerView.FINGER_PRESSED_ANGLE)),this.finger.runAction(new cc.Sequence(new cc.ScaleTo(.2,.7),new cc.CallFunc(function(){if(s.noCircle)n();else{var e=new cc.Sprite(bundles.finger.frames.tutorial_click_png),t=this.finger.getPosition();e.setPosition(cc.p(t.x-cleverapps.styles.FingerView.deltaXforCircle,t.y)),e.setScale(0),this.addChild(e,-1),e.runAction(new cc.Sequence(new cc.DelayTime(.2),new cc.FadeTo(.3,0),new cc.RemoveSelf)),e.runAction(new cc.ScaleTo(.5,1)),n()}}.bind(this))))}.bind(this))},getFingerPosition:function(){return this.finger.getPosition()},blinkTo:function(t){this.addAction(function(e){this.finger.setPosition(t),e()}.bind(this))}});FingerView.showFingerOnce=function(e){var t=new FingerView;t.setLocalZOrder(100),t.setCascadeOpacityEnabled(!0),e.addChild(t),t.delay(.2),
t.fadeIn(cc.p(e.width/2,e.height/2)),t.press(),t.delay(.3),t.unPress(),t.fadeOut(),t.delay(.8),t.runOnce(t.removeFromParent.bind(t))},FingerView.BUNDLES=["finger"],FingerView.ANCHOR_POINT=cc.p(.1,.9),FingerView.PATH_BASE_ALPHA=255,FingerView.PATH_SEGMENTS=100,FingerView.PATH_LINE_WIDTH=15,FingerView.FINGER_PRESSED_ANGLE=0,FingerView.FINGER_UNPRESSED_ANGLE=-7,cleverapps.styles.FingerView={dy:50,deltaXforCircle:0},cleverapps.CountDownView=cc.Node.extend({ctor:function(e,t){var n;this.style=t||{},n=this.style.background_content?this.style.background_content:cleverapps.UI.createSprite(this.style.background_image),this._super(),this.setAnchorPoint(.5,.5),n&&(this.setContentSize2(n.getContentSize()),n.setPositionRound(this.width/2,this.height/2),this.addChild(n)),n.setCascadeOpacityEnabled(!0),n.setCascadeColorEnabled(!0),this.countDown=e;var s=new cc.Node;s.setPositionRound(this.width/2,this.height/2),s.setCascadeOpacityEnabled(!0),s.setCascadeColorEnabled(!0),this.addChild(s),
this.leftTimeText=s,this.refresh(),this.width||(this.setContentSize2(this.text.width*this.text.scaleX,this.text.height*this.text.scaleY),this.updatePosition()),this.countDown.onSecond=this.createListener(this.refresh.bind(this))},fitTo:function(e,t){this.text&&this.text.fitTo(e,t)},recreateText:function(e){this.text&&this.text.removeFromParent(!0),cleverapps.UI.ImageFont.IsApplicable(this.style.font,e)?this.text=new cleverapps.UI.ImageFont(e,this.style.font):this.text=cleverapps.UI.generateOnlyText(e,this.style.font),this.leftTimeText.addChild(this.text)},setString:function(e){this.text?cleverapps.UI.ImageFont.intertypeSetString({textObj:this.text,string:e,font:this.style.font,recreateFunc:this.recreateText.bind(this)}):this.recreateText(e)},updatePosition:function(){var e=this.style.timerPosition;this.text instanceof cleverapps.UI.LabelTTF&&(e=this.style.regularFontTimerPosition||this.style.timerPosition),e=e||cleverapps.styles.CountDownView.timerPosition,
this.leftTimeText.setPositionRound(this.width/2+e.x,this.height/2+e.y)},refresh:function(){var e=cleverapps.intervalToString(this.countDown.getTimeLeft(),this.style.showHours);this.setString(e),this.updatePosition()},whatToDoOnStop:function(){this.countDown.permanent?this.countDown.onSecond=function(){}:this.countDown.remove()},cleanup:function(){this._super(),this.whatToDoOnStop()}}),cleverapps.CountDown=function(e,t){this.onSecond=function(){},t=t||{},this.onFinish=t.onFinish||function(){},this.onTick=t.onTick||function(){},this.permanent=t.permanent,this.pauseOnGameHide=t.pauseOnGameHide,e<=0?this.onFinish():this.resetTimeLeft(e),cleverapps.CountDownManager.isPaused&&this.pause()},cleverapps.CountDown.prototype.remove=function(){void 0!==this.interval&&cleverapps.CountDownManager.removeListener(this.interval),this.interval=void 0,this.onFinish=function(){},this.onSecond=function(){}},cleverapps.CountDown.prototype.stop=function(){this.remove(),this.timeStop=Date.now()},
cleverapps.CountDown.prototype.pause=function(){this.pauseOnGameHide&&!this.isPaused()&&this.isRunning()&&(this.timeFinish-Date.now()<=0||(this.timePause=Date.now(),cleverapps.CountDownManager.pause(this.interval)))},cleverapps.CountDown.prototype.resume=function(){this.isPaused()&&(this.timeFinish=Date.now()+(this.timeFinish-this.timePause),delete this.timePause,cleverapps.CountDownManager.resume(this.interval))},cleverapps.CountDown.prototype.isPaused=function(){return void 0!==this.timePause},cleverapps.CountDown.prototype.isRunning=function(){return void 0!==this.interval},cleverapps.CountDown.prototype.getTimeLeft=function(){return this.timeFinish?this.timeStop?this.timeFinish-this.timeStop:Math.max(this.timeFinish-Date.now(),0):0},cleverapps.CountDown.prototype.resetTimeLeft=function(e){this.resume(),this.timeStart=Date.now(),this.timeFinish=this.timeStart+e,void 0===this.interval&&(this.interval=cleverapps.CountDownManager.addListener(this))},
cleverapps.CountDown.prototype.nextSecond=function(e){var t=this.timeFinish-e;t<0&&(t=0),this.onTick(t),this.onSecond(t),0===t&&(cleverapps.CountDownManager.removeListener(this.interval),this.interval=void 0,this.onFinish())},cleverapps.LongTimeout=function(e,t,n){t<=cleverapps.LongTimeout.THRESHOLD?this.timeout=setTimeout(e,t):((n=n||{}).onFinish=e,cleverapps.CountDown.call(this,t,n))},cleverapps.LongTimeout.prototype=Object.create(cleverapps.CountDown.prototype),cleverapps.LongTimeout.prototype.constructor=cleverapps.CountDown,cleverapps.LongTimeout.prototype.remove=function(){void 0!==this.timeout?clearTimeout(this.timeout):cleverapps.CountDown.prototype.remove.apply(this,arguments)},cleverapps.CountDownManager={listeners:{},pausedListeners:{},uid:0,interval:!1,isPaused:!1,onTick:function(){var e=Date.now();for(var t in this.listeners)this.listeners[t]&&this.listeners[t].nextSecond(e)},initHideListeners:function(){cc.eventManager.addCustomListener(cc.game.EVENT_SHOW,function(){for(
var e in this.isPaused=!1,this.pausedListeners)this.pausedListeners[e].resume()}.bind(this)),cc.eventManager.addCustomListener(cc.game.EVENT_HIDE,function(){for(var e in this.isPaused=!0,this.listeners)this.listeners[e].pause()}.bind(this))},addListener:function(e){var t=this.uid;return this.listeners[t]=e,this.uid++,!1===this.interval&&(this.interval=setInterval(this.onTick.bind(this),cleverapps.CountDown.INTERVAL),this.initHideListeners()),t},removeListener:function(e){delete this.listeners[e]},pause:function(e){this.listeners[e]&&(this.pausedListeners[e]=this.listeners[e],this.removeListener(e))},resume:function(e){this.pausedListeners[e]&&(this.listeners[e]=this.pausedListeners[e],delete this.pausedListeners[e])}},cleverapps.CountDown.INTERVAL=1e3,cleverapps.LongTimeout.THRESHOLD=cleverapps.CountDown.INTERVAL,cleverapps.styles.CountDownView={timerPosition:{x:0,y:0}};var clearTimeoutSuper=clearTimeout,clearIntervalSuper=clearInterval;clearTimeout=function(e){
e instanceof cleverapps.CountDown?e.remove():clearTimeoutSuper(e)},clearInterval=function(e){e instanceof cleverapps.CountDown?e.remove():clearIntervalSuper(e)};var ExitControlButton={onClicked:function(){cc.director.getRunningScene().closeAction()},isAvailableAtScene:function(){return cleverapps.environment.isMainScene()?!!cleverapps.administrator:!!cleverapps.environment.isEditorScene()||(!cleverapps.environment.isGameScene()||-1===["riddles","heroes"].indexOf(config.projectName))&&(!cleverapps.environment.isChatScene()&&(!!cleverapps.environment.isAdministratorScene()||levels&&levels.user&&levels.user.checkAvailable({level:1})))}},FullscreenControlButton={onClicked:function(){FullscreenControlButton.fullscreenElement()?FullscreenControlButton.exitFullscreen():FullscreenControlButton.requestFullscreen()},isAvailableAtScene:function(){if(cleverapps.config.wysiwygMode)return!1;if(cleverapps.config.editorMode&&"merge"!==cleverapps.config.type)return!1;if(
cleverapps.environment.isChatScene()||cleverapps.environment.isMiniGameScene())return!1;if(cc.sys.isNative||cc.sys.isMobile||cleverapps.wideMode.mode===cleverapps.WideMode.VERTICAL||cleverapps.isInstant()||cleverapps.Mobage.isAppropriate()||cleverapps.MobileOK.isAppropriate())return!1;var e=document.documentElement;return e.requestFullscreen||e.webkitRequestFullscreen||e.msRequestFullscreen||e.mozRequestFullscreen},fullscreenElement:function(){return document.fullscreenElement||document.webkitFullscreenElement||document.msFullscreenElement||document.mozFullscreenElement},requestFullscreen:function(){var e=document.documentElement;e.requestFullscreen?e.requestFullscreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.msRequestFullscreen?e.msRequestFullscreen():e.mozRequestFullscreen&&e.mozRequestFullscreen()},exitFullscreen:function(e){FullscreenControlButton.isAvailableAtScene()&&FullscreenControlButton.fullscreenElement()?(document.exitFullscreen?document.exitFullscreen(
):document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozExitFullscreen&&document.mozExitFullscreen(),e&&setTimeout(e,100)):e&&e()}},MenuControlButton={onClicked:function(){cleverapps.metha.display({focus:"SettingsWindowFromMenu",action:function(e){new SettingsWindow,cleverapps.metha.onceNoWindowsListener=e}})},isAvailableAtScene:function(){return!(cleverapps.environment.isEditorScene()||cleverapps.environment.isChatScene()||cleverapps.environment.isMiniGameScene())},needToAddInsidePanel:function(){return cleverapps.environment.isGameScene()&&"undefined"!=typeof ControlsPanel&&ControlsPanel.IS_DOWN()&&-1!==["riddles","heroes"].indexOf(cleverapps.config.name)}},SceneControlButton=cleverapps.UI.Button.extend({ctor:function(e){e=e||{},this.options=e;var t=cleverapps.styles.SceneControlButton;if(this._super({button_png:e.button_png?e.button_png:bundles.controlbuttons.frames.button_png,
button_on_png:e.button_on_png?e.button_on_png:bundles.controlbuttons.frames.button_on_png,onClicked:e.logic.onClicked,content:new cc.Sprite(e.icon),contentPadding:t.contentPadding,mark:e.mark}),e.mark){this.setMarkVisible(!1);var n=function(){this.setMarkVisible(cleverapps.chat.hasUnread&&("merge"===cleverapps.config.type||!Game.currentGame))}.bind(this);cleverapps.chat.load(n,n)}SceneDecors.add(this,cleverapps.skins.getSlot("sceneControlButton",{target:this})),this.baseScale=t.scale[cleverapps.wideMode.mode],this.setScale(this.baseScale)}});cleverapps.styles.SceneControlButton={scale:[1,1,1],contentPadding:0};var SceneControlButtonsView=cc.Node.extend({ctor:function(){this._super();var e=SceneControlButtonsView.controlButtons.filter(function(e){return e.logic.isAvailableAtScene()}).map(function(e){return new SceneControlButton(e)}),t=cleverapps.styles.SceneControlButtonsView,n=new cleverapps.Layout(e,{direction:cleverapps.UI.HORIZONTAL,margin:t.margin});n.setAnchorPoint2(0,0),
this.addChild(n),this.setContentSize(n.getContentSize()),this.setAnchorPoint2(),this.setLocalZOrder(2),this.setPositionRound(t.position),cleverapps.environment.isWysiwygScene()&&"merge"===cleverapps.config.type&&(this.setScale(.5),this.setPositionRound({x:{align:"right",dx:-20},y:{align:"top",dy:-10}})),cleverapps.UI.makeHideable(this,cleverapps.UI.VERTICAL),cleverapps.metha.registerControl("SceneControlButtonsView",this)}});cleverapps.styles.SceneControlButtonsView={margin:16,position:{x:{align:"right",dx:-20},y:{align:"top",dy:-10}}},SceneControlButtonsView.menuButtonData={logic:MenuControlButton,icon:bundles.controlbuttons.frames.menu_icon_png,mark:!0},SceneControlButtonsView.controlButtons=[{logic:ExitControlButton,icon:bundles.controlbuttons.frames.back_icon_png,button_png:bundles.controlbuttons.frames.back_button_png,button_on_png:bundles.controlbuttons.frames.back_button_on_png},{logic:FullscreenControlButton,icon:bundles.controlbuttons.frames.fullscreen_icon_png},
SceneControlButtonsView.menuButtonData];var MenuBar=function(){this.items=cleverapps.MenuBarItems().map(function(e){return e.modelClass?new e.modelClass(e):new MenuBarItem(e)})};MenuBar.prototype.getSceneItems=function(){var t=[];return this.items.forEach(function(e){this.isAvailableOnScene(e.config)?(e.init(),t.push(e)):e.stop()}.bind(this)),t},MenuBar.prototype.stopItems=function(){this.items.forEach(function(e){e.stop()}.bind(this))},MenuBar.prototype.isAvailableOnScene=function(e){if(e.availableOnScenes)return 0<=e.availableOnScenes.indexOf(cleverapps.environment.scene);if("GoldItem"===e.name){var t=[cleverapps.Environment.SCENE_MAIN,cleverapps.Environment.SCENE_HEROES,cleverapps.Environment.SCENE_DAILY_CUP,cleverapps.Environment.SCENE_RACE,cleverapps.Environment.SCENE_METHA,cleverapps.Environment.SCENE_CARD_SKINS,cleverapps.Environment.SCENE_BONUS_WORLD,cleverapps.Environment.SCENE_SLOT_MACHINE];return"match3"!==cleverapps.config.type&&t.push(cleverapps.Environment.SCENE_GAME),
0<=t.indexOf(cleverapps.environment.scene)}if("LivesItem"===e.name){var n=[cleverapps.Environment.SCENE_MAIN,cleverapps.Environment.SCENE_METHA,cleverapps.Environment.SCENE_BONUS_WORLD];return cleverapps.dailyCup.cupWithLives()&&n.push(cleverapps.Environment.SCENE_DAILY_CUP),"merge"===cleverapps.config.type&&n.push(cleverapps.Environment.SCENE_GAME),cleverapps.lives&&0<=n.indexOf(cleverapps.environment.scene)}return"CryptexItem"===e.name?cleverapps.environment.isGameScene()&&Game.currentGame.cryptex:"BonusRoundTimerItem"===e.name&&(cleverapps.environment.isGameScene()&&Game.currentGame.bonusRoundCountDown)},cleverapps.MenuBarItems=function(){var e=[];return"merge"===cleverapps.config.type&&e.push({name:"GameLevelItem",target:!0,viewClass:MenuBarGameLevelView,modelClass:GameLevelMenuBarItem,availableOnScenes:[cleverapps.Environment.SCENE_GAME]}),e.push({name:"GoldItem",lottery:!0,needPayments:!RewardedAdsManager.IsEnabled(),target:!0,plusButton:!0,value:function(){
return cleverapps.user.gold},updater:function(e){cleverapps.user.onChangeGold=e},icon:bundles.menubar.frames.coin_png,onClickWindow:HardCurrencyShopWindow,deltaSound:bundles.main.urls.coins_effect},{name:"LivesItem",lottery:!0,target:!0,plusButton:!0,viewClass:MenuBarWithTimeoutView,modelClass:LivesMenuBarItem,value:function(){return cleverapps.lives.amount},icon:bundles.menubar.frames.life_png,onClickWindow:LivesShopWindow}),"merge"===cleverapps.config.type&&e.push({name:"CoinsItem",target:!0,plusButton:!0,value:function(){return Game.currentGame.coins},updater:function(e){Game.currentGame.onChangeCoinsListener=e},onClickWindow:SoftCurrencyShopWindow,keepOpenWithWindow:"MenuBarGoldItem",icon:bundles.menubar.frames.merge_coin_png,deltaSound:bundles.collectible.urls.coins_fly_finish_effect,availableOnScenes:[cleverapps.Environment.SCENE_GAME]},{name:"WandsItem",target:!0,value:function(){return Game.currentGame.wands},updater:function(e){Game.currentGame.onChangeWandsListener=e},
icon:bundles.menubar.frames.merge_wand_png,deltaSound:bundles.collectible.urls.wand_fly_finish_effect,availableOnScenes:[cleverapps.Environment.SCENE_GAME]},{name:"WorkersItem",plusButton:!0,target:!0,timerTTF:!0,viewClass:MenuBarWithTimeoutView,modelClass:WorkersMenuBarItem,value:function(){return Game.currentGame.workers.countRegularFree()},onClickWindow:BonusWorkerWindow,keepOpenWithWindow:"MenuBarGoldItem",icon:bundles.menubar.frames.merge_worker_png,availableOnScenes:[cleverapps.Environment.SCENE_GAME]}),cleverapps.config.metha===Metha.HOMEFIX&&e.push({name:"MethaStarsItem",plusButton:!0,value:function(){return cleverapps.home.stars},updater:function(e){cleverapps.home.onChangeStars=e},onClickWindow:HomefixRulesWindow,icon:bundles.menubar.frames.menubar_metha_stars,availableOnScenes:[cleverapps.Environment.SCENE_METHA,cleverapps.Environment.SCENE_MAIN]}),void 0!==typeof match3&&e.push({name:"ExpItem",plusButton:!0,lottery:!0,needPayments:!0,value:function(){
return cleverapps.user.exp},updater:function(e){cleverapps.user.onChangeExpListeners.expview=e},onClickWindow:ExpInfoWindow,icon:bundles.menubar.frames.exp_png,availableOnScenes:[cleverapps.Environment.SCENE_HEROES]}),0<=["board","differences"].indexOf(cleverapps.config.type)&&e.push({name:"CryptexItem",centerAlign:!0,helpButton:!0,force:Forces.CRYPTEX,icon:bundles.menubar.frames.cryptex_png,onClickWindow:CryptexWindow,modelClass:CryptexMenuBarItem}),e.push({name:"BonusRoundTimerItem",centerAlign:!0,tooltip:"BonusRoundCountdownTooltip",icon:bundles.menubar.frames.time_left_icon_png,animation:bundles.menubar.jsons.bound_round_timer_json,modelClass:BonusRoundMenuBarItem}),e};var MenuBarItem=function(e){this.config=e,this.timerShowHours=!1,this.onRemove=function(){},this.onChangeText=function(){}};MenuBarItem.prototype.init=function(){cleverapps.extend(this,this.config),this.changeText=cleverapps.accumulate(100,function(){var e=0;void 0!==this.currentValue&&(e=this.getCurrentValue(
)-this.currentValue),this.currentValue=this.getCurrentValue(),this.onChangeText(e)}.bind(this)),this.currentValue=this.getCurrentValue(),this.config.onClickWindow&&(this.action=function(){this.config.force&&cleverapps.forces.isRunningForce()&&cleverapps.forces.closeRunningForce(),cleverapps.metha.display({focus:"MenuBarItemWindow",control:this.keepOpenWithWindow?[this.getControlName(),this.keepOpenWithWindow]:this.getControlName(),action:function(e){new this.config.onClickWindow,cleverapps.metha.onceNoWindowsListener=e}.bind(this)})}.bind(this),this.onClickWindow=void 0),this.config.updater&&(this.config.updater.call(this,this.changeText.bind(this)),this.updater=void 0),this.customInit()},MenuBarItem.prototype.customInit=function(){},MenuBarItem.prototype.getName=function(){return this.config.name},MenuBarItem.prototype.getControlName=function(){return"MenuBar"+this.getName()},MenuBarItem.prototype.getCurrentValue=function(){return this.config.value?this.config.value():void 0},
MenuBarItem.prototype.getViewClass=function(){return this.config.viewClass||MenuBarItemView},MenuBarItem.prototype.getText=function(){if(this.timer)return cleverapps.intervalToString(this.timer.getTimeLeft(),this.timerShowHours);var e=this.getCurrentValue();return void 0!==e?e+"":""},MenuBarItem.prototype.updateAll=function(){this.timerRefresh()},MenuBarItem.prototype.timerRefresh=function(){this.onChangeText(),this.onRefreshTimer&&this.onRefreshTimer()},MenuBarItem.prototype.updateTimer=function(){var e=this.timer;this.stop(),this.onChangeTimer&&this.onChangeTimer(!!this.timer==!!e),this.onRefreshTimer&&this.onRefreshTimer()},MenuBarItem.prototype.stop=function(){this.timer&&(this.timer.stop(),this.timer=!1)},MenuBarItem.prototype.setTimer=function(e){this.timer=e,this.timer.onSecond=this.timerRefresh.bind(this)};var LivesMenuBarItem=function(e){MenuBarItem.call(this,e),this.onAttentionOnListener=function(){},this.onAttentionOffListener=function(){},this.onUpdatePlusButton=function(
){},this.onUpdateTotalIcon=function(){},this.onUpdateLotteryIcon=function(){}};LivesMenuBarItem.prototype=Object.create(MenuBarItem.prototype),(LivesMenuBarItem.prototype.constructor=LivesMenuBarItem).prototype.customInit=function(){this.attention=!1,this.keepOpenWithWindow="merge"===cleverapps.config.type?"MenuBarCoinsItem":"MenuBarGoldItem",cleverapps.lives.onChangeAmountListeners.livesview=this.updateAll.bind(this),cleverapps.lives.onStartRegenerateListener=this.updateAll.bind(this),cleverapps.lives.onBuyUnlimitedLivesListener=this.updateAll.bind(this),this.updateAll(),Game.currentGame&&Game.currentGame.energyLottery&&(Game.currentGame.energyLottery.onLotteryStatusChanged=this.updateAttention.bind(this))},LivesMenuBarItem.prototype.getTotal=function(){return cleverapps.Lives.MAX_REGEN_AMOUNT},LivesMenuBarItem.prototype.updateAttention=function(){var e=!1;Game.currentGame&&Game.currentGame.energyLottery&&(e=Game.currentGame.energyLottery.isAvailable(
)&&Game.currentGame.energyLottery.isReady()),this.attention!==e&&((this.attention=e)?this.onAttentionOnListener():this.onAttentionOffListener())},LivesMenuBarItem.prototype.updateAll=function(){this.changeText(),cleverapps.tempGoods.checkGoodBuyed(cleverapps.TempGoods.UNLIMITED_LIVES)?(this.plusButton=!1,this.totalIcon=bundles.menubar.frames.unlim_png):(this.plusButton=!0,this.totalIcon=!1),this.onUpdatePlusButton(),this.onUpdateTotalIcon(),this.updateTimer(),this.updateAttention()},LivesMenuBarItem.prototype.updateTimer=function(){var e=this.timer;this.timer&&(this.timer.stop(),this.timer=!1),this.lottery=!0,cleverapps.tempGoods.checkGoodBuyed(cleverapps.TempGoods.UNLIMITED_LIVES)?(this.timerTTF=!0,this.lottery=!1,this.setTimer(new cleverapps.CountDown(cleverapps.tempGoods.goodLeftTime(cleverapps.TempGoods.UNLIMITED_LIVES),{onFinish:function(){cleverapps.metha.isFocused()||!cleverapps.environment.isMainScene()&&!cleverapps.environment.isDailyCupScene(
)||cleverapps.tempGoods.displayPromotionOnFinish(),this.updateAll()}.bind(this)}),!1)):(this.timerTTF=!1,cleverapps.lives.amount<cleverapps.Lives.MAX_REGEN_AMOUNT&&0<cleverapps.lives.calcTimeLeft()&&(this.lottery=!1,this.setTimer(new cleverapps.CountDown(cleverapps.lives.calcTimeLeft(),{onFinish:this.updateAll.bind(this)}),!1))),this.onUpdateLotteryIcon(),this.onChangeTimer&&this.onChangeTimer(!!this.timer==!!e),this.onRefreshTimer&&this.timer&&this.onRefreshTimer()};var WorkersMenuBarItem=function(e){MenuBarItem.call(this,e),this.timerShowHours=!0};WorkersMenuBarItem.prototype=Object.create(MenuBarItem.prototype),(WorkersMenuBarItem.prototype.constructor=WorkersMenuBarItem).prototype.customInit=function(){Game.currentGame.workers.onChangeStatusListener=this.changeText.bind(this),Game.currentGame.workers.onChangeTotalAmount=function(){this.changeText(),this.updateTimer()}.bind(this),this.updateTimer()},WorkersMenuBarItem.prototype.getTotal=function(){
return Game.currentGame.workers.countRegularTotal()},WorkersMenuBarItem.prototype.highlightTotal=function(){return Game.currentGame&&Game.currentGame.workers.isBonusWorkerBuyed()||!1},WorkersMenuBarItem.prototype.updateTimer=function(){var e=this.timer;this.stop(),Game.currentGame&&Game.currentGame.workers.isBonusWorkerBuyed()&&this.setTimer(new cleverapps.CountDown(Game.currentGame.workers.bonusWorkerLeftTime(),{onFinish:this.updateTimer.bind(this)}),!0),this.onChangeTimer&&this.onChangeTimer(!!this.timer==!!e),this.onRefreshTimer&&this.timer&&this.onRefreshTimer()};var CryptexMenuBarItem=function(e){MenuBarItem.call(this,e),this.onShowForce=function(){}};CryptexMenuBarItem.prototype=Object.create(MenuBarItem.prototype),(CryptexMenuBarItem.prototype.constructor=CryptexMenuBarItem).prototype.customInit=function(){this.setTimer(Game.currentGame.cryptex.countdown),Game.currentGame.cryptex.onShowForceListener=function(){this.onShowForce(this.config.force)}.bind(this),
Game.currentGame.cryptex.onStop=function(){this.onRemove()}.bind(this)};var BonusRoundMenuBarItem=function(e){MenuBarItem.call(this,e)};BonusRoundMenuBarItem.prototype=Object.create(MenuBarItem.prototype),(BonusRoundMenuBarItem.prototype.constructor=BonusRoundMenuBarItem).prototype.customInit=function(){this.setTimer(Game.currentGame.bonusRoundCountDown),Game.currentGame.onChangeOutcomeListeners.menuBarBonusRoundTimer=function(e){e===GameBase.OUTCOME_LOST&&(setTimeout(function(){cleverapps.metha.hideControlsWhileFocused(this.getControlName())}.bind(this),800),this.onSetAnimationListener("timeout"))}.bind(this)};var MenuBarItemView=cc.Node.extend({ctor:function(e){this._super(),this.setAnchorPoint2(),this.styles=cleverapps.styles.MenuBarItem,this.item=e,this.centerAlign=this.item.centerAlign,this.reset(!0),this.item.onRemove=this.createListener(this.remove.bind(this)),this.item.onChangeText=this.createListener(this.onChangeText.bind(this)),this.item.onChanged=this.createListener(
this.reset.bind(this)),this.item.onShowForce=this.createListener(this.showForce.bind(this)),this.item.onAttentionOnListener=this.createListener(this.turnOnAttention.bind(this)),this.item.onAttentionOffListener=this.createListener(this.turnOffAttention.bind(this)),this.item.onSetAnimationListener=this.createListener(this.setAnimation.bind(this)),this.item.onUpdatePlusButton=this.createListener(this.updatePlusButton.bind(this)),this.item.onUpdateLotteryIcon=this.createListener(this.updateLotteryIcon.bind(this)),this.item.target&&(cleverapps.styles.MenuBar[this.item.getName()]||(cleverapps.styles.MenuBar[this.item.getName()]={}),this.registerTarget(cleverapps.styles.MenuBar[this.item.getName()])),e.tooltip&&cleverapps.tooltipManager.create(this,{text:Messages.get(e.tooltip),position:cleverapps.styles.UI.Tooltip.LOCATION.below,control:this.item.getControlName()+"Tooltip"})},updatePlusButton:function(){!!this.item.plusButton!=!!this.plusButton&&(this.item.plusButton?this.addPlusButton():(
this.plusButton.removeFromParent(),delete this.plusButton))},updateLotteryIcon:function(){!!this.item.lottery!=!!this.lotteryIcon&&(this.item.lottery?-1!==["board","differences"].indexOf(cleverapps.config.type)&&cleverapps.wideMode.mode===cleverapps.WideMode.VERTICAL&&cleverapps.environment.isGameScene()||Lottery.addIcon(this,cleverapps.styles.MenuBarItem.lotteryIconPosition):(this.lotteryIcon.removeFromParent(),delete this.lotteryIcon))},setAnimation:function(e){this.icon instanceof cleverapps.Spine&&this.icon.setAnimation(0,e,!1)},makeHideable:function(){cleverapps.UI.makeHideable(this,cleverapps.UI.VERTICAL),cleverapps.metha.registerControl(this.item.getControlName(),this)},reset:function(){this.turnOffAttention(),this.removeAllChildren(),this.addBg(),this.addIcon(),this.bg.setPositionRound(this.bg.width/2+this.iconRealWidth/2,this.styles.bg.height/2),this.setContentSize2(this.bg.width+this.iconRealWidth/2,this.bg.height),this.addPlusButton(),this.addHelpButton(),this.addText(),
this.addAction(),SceneDecors.add(this,cleverapps.skins.getSlot("menuBarItem",{target:this})),this.updateLotteryIcon(),this.item.attention&&this.turnOnAttention()},updateToSmallSize:function(e){this.useSmallSize=!0,this.needDelta=e,this.reset(!0)},remove:function(){this.pauseHideHandler(),this.runAction(new cc.Sequence(new cc.ScaleTo(.3,0),new cc.RemoveSelf))},showForce:function(e){this.show(!0),cleverapps.forces.create(this,e)},updateText:function(){this.text.setString(this.item.getText())},onChangeText:function(e){if(this.animateChange(e)){this.text.stopAllActions(),this.text.setScale(this.text.baseScale);var t=this.item.deltaSound;!t||cleverapps.config.wysiwygMode&&cleverapps.flags.wysiwyg.customCollectAnimation||cleverapps.audio.playSound(t),this.text.runAction(new cc.Sequence(new cc.ScaleTo(.2,1.4*this.text.baseScale),new cc.CallFunc(function(){cleverapps.UI.animateDelta(e,{x:this.bg.width/2+this.iconRealWidth/2,y:this.styles.deltaAnimation.dy,parent:this,
font:cleverapps.styles.FONTS.MENUBAR_TEXT_DELTA||cleverapps.styles.FONTS.MENUBAR_TEXT}),this.updateText(),this.text.setPositionRound(this.getTextPosition())}.bind(this)),new cc.ScaleTo(.2,this.text.baseScale),new cc.CallFunc(function(){this.textFitTo()}.bind(this)))),this.icon&&(this.icon.stopAllActions(),this.icon.setScale(this.icon.baseScale),this.icon.runAction(new cc.Sequence(new cc.ScaleTo(.15,1.2*this.icon.baseScale).easing(cc.easeIn(1)),new cc.ScaleTo(.15,this.icon.baseScale).easing(cc.easeOut(1)))))}else this.updateText(),this.textFitTo(),this.text.setPositionRound(this.getTextPosition())},animateChange:function(e){return e&&!this.item.timer},addIcon:function(){this.item.animation?(this.icon=new cleverapps.Spine(this.item.animation),this.icon.setAnimation(0,"idle",!0)):this.icon=new cc.Sprite(this.item.icon),this.icon.setScale(cleverapps.styles.MenuBarItem.icon.scale),this.icon.baseScale=this.icon.getScale(),
this.iconRealWidth=this.styles.icon.fullInsideBg?0:this.icon.getBoundingBox().width,this.addChild(this.icon),this.icon.setPositionRound({x:this.iconRealWidth/2+this.styles.icon.x,y:this.styles.bg.height/2+this.styles.icon.y})},addBg:function(){this.bg=cleverapps.UI.createScale9Sprite(bundles.menubar.frames.menubar_bg_png,cleverapps.UI.Scale9Rect.TwoPixelXY);var e=this.styles.bg.width;this.useSmallSize&&(e=this.needDelta>this.styles.bg.width-this.styles.bg.minWidth?this.styles.bg.minWidth:this.styles.bg.width-this.needDelta),this.bg.setContentSize2(e,this.styles.bg.height),this.addChild(this.bg)},textFitTo:function(){var e=this.width-this.styles.iconBlockWidth;(this.helpButton||this.plusButtonOnBg)&&(e-=this.styles.plusBlockWidth),this.text.fitTo(e),this.text.baseScale=this.text.scale},getTextPosition:function(){var e=0;this.helpButton||this.plusButtonOnBg||(e=cleverapps.styles.MenuBarItem.noPlusDx);var t=cleverapps.styles.MenuBarItem.textOffset.y
;return this.separateText?this.separateText instanceof cleverapps.UI.ImageFont&&(t=cleverapps.styles.MenuBarItem.textOffset.imageFont||0):this.text instanceof cleverapps.UI.ImageFont&&(t=cleverapps.styles.MenuBarItem.textOffset.imageFont||0),cc.p(this.width/2+this.iconRealWidth/4+cleverapps.styles.MenuBarItem.textOffset.x+e,this.height/2+t)},addText:function(){var e=this.item.getText();if(cleverapps.UI.ImageFont.IsApplicable(cleverapps.styles.FONTS.MENUBAR_TEXT,e))var t=cleverapps.UI.generateImageText(e,cleverapps.styles.FONTS.MENUBAR_TEXT);else t=cleverapps.UI.generateOnlyText(e,cleverapps.styles.FONTS.MENUBAR_TEXT);this.addChild(t),(this.text=t).baseScale=t.scale,t.setPositionRound(this.getTextPosition()),this.textFitTo()},addAction:function(){this.item.action&&(this.item.needPayments&&cleverapps.flags.nopayments||(cleverapps.UI.onClick(this,function(){this.item.action()}.bind(this),{useInteractiveScale:!0}),cleverapps.UI.applyHover(this)))},addPlusButton:function(){if(
this.item.plusButton){if(!this.item.needPayments||!cleverapps.flags.nopayments){var e=this.plusButton=new cleverapps.UI.Button({button_png:bundles.menubar.frames.plus_button_png,button_on_png:bundles.menubar.frames.plus_button_on_png,onClicked:this.item.action});this.addChild(e);var t=cc.p(this.icon.x+this.iconRealWidth/2,0);this.styles.plusButton&&this.styles.plusButton.position&&(this.plusButtonOnBg=!0,t=this.styles.plusButton.position),e.setPositionRound(t)}}else this.plusButtonOnBg=!1},addHelpButton:function(){if(this.item.helpButton){var e=this.helpButton=new cleverapps.UI.Button({button_png:bundles.menubar.frames.menubar_help_button_png,button_on_png:bundles.menubar.frames.menubar_help_button_on_png,onClicked:this.item.action});this.addChild(e),e.setPositionRound(this.styles.helpButton.position)}},turnOnAttention:function(){if(!this.attention){var e=cleverapps.styles.MenuBarItem.attention,t=this.attention=new cc.Sprite(bundles.menubar.frames.menubar_attention_png)
;t.setLocalZOrder(2),t.setPositionRound(this.icon.x+e.x,this.icon.y+e.y),t.setScale(e.scale),this.addChild(t),t.runAction(new cc.RepeatForever(new cc.Sequence(new cc.ScaleTo(.3,1.1*t.scale),new cc.ScaleTo(.3,t.scale))))}},turnOffAttention:function(){this.attention&&(this.attention.removeFromParent(),delete this.attention)}});cleverapps.overrideFonts(cleverapps.styles.FONTS,{MENUBAR_TEXT:{name:"default",size:40}}),cleverapps.styles.MenuBarItem={textOffset:{x:0,y:0},noPlusDx:14,bg:{width:200,minWidth:170,height:50},iconBlockWidth:50,plusBlockWidth:50,deltaAnimation:{dy:-5},icon:{fullInsideBg:!1,scale:1,x:-10,y:0},iconText:{position:{x:{align:"center",dx:0},y:{align:"center",dy:0}}},plusButton:{position:{x:{align:"right",dx:-5},y:{align:"center",dy:0}}},helpButton:{position:{x:{align:"right",dx:-5},y:{align:"center",dy:0}}},totalIcon:{x:{align:"center"},y:{align:"center"}},attention:{x:25,y:-42,scale:.9}};var MenuBarWithTimeoutView=MenuBarItemView.extend({ctor:function(e){this._super(e),
this.item.onChangeTimer=this.createListener(this.onChangeTimer.bind(this)),this.item.onRefreshTimer=this.createListener(this.onRefreshTimer.bind(this)),this.item.onUpdateTotalIcon=this.createListener(this.updateTotalIcon.bind(this))},onChangeTimer:function(e){this.timer&&!!this.timer instanceof cleverapps.UI.ImageFont^!!this.item.timerTTF&&this.removeTimer(e),this.item.timer?this.createTimer(e):this.removeTimer(e)},updateToSmallSize:function(){},reset:function(e){this._super(e),this.updateTotalIcon(),this.timerBlock=void 0,this.onChangeTimer(!0)},animateChange:function(e){return e},createTimer:function(e){if(!this.timerBlock){this.timerBlock=cleverapps.UI.createScale9Sprite(bundles.menubar.frames.bar_timer_png),this.timerBlock.setCascadeOpacityEnabled(!0);var t=this.bg.width-2*this.styles.timer.padding.x;if(this.timerBlock.setContentSize2(t,this.styles.timer.height),this.timerBlock.setPositionRound(this.styles.timer.position),this.addChild(this.timerBlock,-1),
bundles.menubar.frames.small_timer_icon_png){var n=new cc.Sprite(bundles.menubar.frames.small_timer_icon_png);n.setPositionRound(this.styles.timer.icon),this.timerBlock.addChild(n)}this.item.timerTTF?this.timer=cleverapps.UI.generateOnlyText("",cleverapps.styles.FONTS.MENUBAR_TIMER_TEXT):this.timer=cleverapps.UI.generateImageText("",cleverapps.styles.FONTS.MENUBAR_TIMER_TEXT),this.timerBlock.addChild(this.timer),e?this.onRefreshTimer():(this.timerBlock.setOpacity(0),this.timerBlock.runAction(new cc.Sequence(new cc.FadeIn(.3),new cc.CallFunc(this.onRefreshTimer.bind(this)))))}},removeTimer:function(e){this.timerBlock&&(e?this.timerBlock.removeFromParent():this.timerBlock.runAction(new cc.Sequence(new cc.FadeOut(.3),new cc.RemoveSelf)),this.timerBlock=void 0)},onRefreshTimer:function(){this.timerBlock&&(this.timer.setString(this.item.getText()),this.timer.setFont(cleverapps.styles.FONTS.MENUBAR_TIMER_TEXT),this.timer.fitTo(cleverapps.styles.MenuBarItem.timer.text.width),
this.item.timerTTF?this.timer.setPositionRound(this.styles.timer.ttfText):this.timer.setPositionRound(this.styles.timer.text))},updateTotalIcon:function(){this.totalIcon&&this.totalIcon.removeFromParent(),this.item.totalIcon&&(this.totalIcon=new cc.Sprite(this.item.totalIcon),this.addChild(this.totalIcon),this.totalIcon.setPositionRound(this.styles.totalIcon))},updateText:function(){if(this.text.removeAllChildren(),!this.item.totalIcon){var e=this.item.getCurrentValue(),t=this.item.getTotal(),n=cleverapps.UI.generateImageText(e,cleverapps.styles.FONTS.MENUBAR_TEXT);this.styles.noColoredText||(t<=e?n.setColor(cleverapps.styles.COLORS.GREEN):e<.1*t&&n.setColor(cleverapps.styles.COLORS.COLOR_RED));var s=this.separateText=cleverapps.UI.generateImageText("/",cleverapps.styles.FONTS.MENUBAR_TEXT),i=cleverapps.UI.generateImageText(t,cleverapps.styles.FONTS.MENUBAR_TEXT);this.item.highlightTotal&&this.item.highlightTotal()&&i.setColor(cleverapps.styles.COLORS.COLOR_BONUS)
;var o=new cleverapps.Layout([n,s,i],{direction:cleverapps.UI.HORIZONTAL});this.text.setContentSize(o.getContentSize()),o.setPositionRound(this.text.width/2,this.text.height/2),this.text.addChild(o)}},textFitTo:function(){var e=this.width-this.styles.iconBlockWidth;(this.helpButton||this.plusButtonOnBg)&&(e-=this.styles.plusBlockWidth),this.text.width>e?(this.text.baseScale=e/this.text.width,this.text.setScale(this.text.baseScale)):this.text.baseScale=1},addText:function(){var e=new cc.Node;e.setAnchorPoint2(),this.addChild(e),this.text=e,this.updateText(),e.setPositionRound(this.getTextPosition()),this.textFitTo()}});cleverapps.overrideFonts(cleverapps.styles.FONTS,{MENUBAR_TIMER_TEXT:{name:"default",size:32,color:cleverapps.styles.COLORS.WHITE,stroke:cleverapps.styles.DECORATORS.IMAGE_FONT_STROKE}}),cleverapps.styles.MenuBarItem=cleverapps.overrideStyles(cleverapps.styles.MenuBarItem,{timer:{icon:{x:{align:"left",dx:31},y:{align:"center",dy:1}},text:{x:{align:"left",dx:73},y:{
align:"center",dy:4},width:125},ttfText:{x:{align:"left",dx:68},y:{align:"center",dy:0}},position:{x:{align:"center",dx:16},y:{align:"bottom",dy:-49}},padding:{x:40},height:59}});var MenuBarView=cc.Node.extend({ctor:function(e,t){this._super();var n=cleverapps.menuBar.getSceneItems().map(function(e){return new(e.getViewClass())(e)}),s=new cleverapps.Layout(n,{direction:cleverapps.UI.HORIZONTAL,margin:cleverapps.styles.MenuBar.margin,padding:cleverapps.styles.MenuBar.padding});if(s.width<e&&2===n.length&&n[1].centerAlign){var i=cleverapps.UI.getSceneSize();n[1].x<i.width/2&&i.width/2+n[1].width/2+cleverapps.styles.MenuBar.padding.x<=e&&(n[1].x=i.width/2,s.width=n[1].x+n[1].width/2+cleverapps.styles.MenuBar.padding.x)}if(s.width>e){var o=(s.width-e-(n.length-1)*(cleverapps.styles.MenuBar.margin-cleverapps.styles.MenuBar.smallMargin))/n.length;n.forEach(function(e){e.updateToSmallSize(o)}),s.options={direction:cleverapps.UI.HORIZONTAL,margin:cleverapps.styles.MenuBar.smallMargin,
padding:cleverapps.styles.MenuBar.padding},s.reshape()}s.width>e&&s.setScale(e/s.width),this.setLocalZOrder(2),this.addChild(s),this.setContentSize(s.width*s.scale,s.height*s.scale),s.setPositionRound(this.width/2,this.height/2),this.setPositionRound(cleverapps.styles.MenuBar.position),this.deltaY=cleverapps.UI.getSceneOffsetY()-cleverapps.styles.MenuBar.minOffest,this.deltaY<0&&(this.deltaY=0),this.alignment=cleverapps.clone(this.alignment,!0),this.alignment.y.dy+=this.deltaY,t.addChild(this,22),n.forEach(function(e){e.makeHideable()})}});cleverapps.styles.MenuBar={minOffest:50,margin:16,smallMargin:12,padding:{x:20,y:0},position:{x:{align:"left",dx:0},y:{align:"top",dy:-15}}},cleverapps.UI.ImageFont=cc.Node.extend({ctor:function(e,t){this._super(),this.setFont(t),this.setAnchorPoint(.5,.5),this.setCascadeOpacityEnabled(!0),this.setString(e),this.setCascadeColorEnabled(!0)},setHorizontalAlignment:function(){},setVerticalAlignment:function(){},setDimensions:function(){},fitTo:function(
e,t){for(var n=0;n<10;){var s=this.width*this.scale,i=this.height*this.scale,o=this.canAttachLastLine();if(!(e&&e<s||t&&t<i||o))break;n++;var r=.9;if(e&&e<s&&r<e/s&&(r=e/s),t&&t<i&&r<t/i&&(r=t/i),1<=r&&o&&(r=.9),this.setFontSize(Math.floor(this.getFontSize()*r)),this.getFontSize()<cleverapps.UI.ImageFont.getFontSizeThreshold())return void this.setFontSize(cleverapps.UI.ImageFont.getFontSizeThreshold())}},canAttachLastLine:function(){return!1},setFont:function(e){for(var t,n=e.name?e.name:"default",s=0;s<cleverapps.config.fonts.length&&!(cleverapps.config.fonts[s].name===n&&(t=cleverapps.config.fonts[s]).size*cleverapps.UI.ImageFont.MAX_MAGNITUDE>=e.size);s++);if(void 0===t)throw console.log(e),"No image font";this.font=e,this.baseFont=t,this.bundle=t.bundle,this.prefix=t.name+t.originalSize+"pt_",this.setScale(e.size/t.size),this.setColor(e.color||cleverapps.styles.COLORS.WHITE)},setString:function(e){if(!this.stopListeners){e=""+e,this.string=e,this.removeAllChildren(!0);var t=e?(""+e
).split(""):[],o=0,r=0;t.forEach(function(e){cleverapps.UI.ImageFont.LETTERS_MAP[e]&&(e=cleverapps.UI.ImageFont.LETTERS_MAP[e]);var t=bundles[this.bundle].frames[this.prefix+e];t||(console.log(this),console.log("No image for letter: ",e));var n=new cc.Sprite(t),s=2*Math.round(n.width/2),i=2*Math.round(n.height/2);r<i&&(r=i),n.setPositionRound(o+s/2,i/2),n.setAnchorPoint2(),o+=s,this.addChild(n)},this),this.setContentSize2(o,r),this.setAnchorPoint2(this.anchorX,this.anchorY)}},setAnchorPoint2:function(e,t){this.anchorX=e,this.anchorY=t,this._super(e,t)},getString:function(){return this.string},getFontSize:function(){return Math.floor(this.baseFont.size*this.scale)},setFontSize:function(e){this.setScale(e/this.baseFont.size)}}),cleverapps.UI.ImageFont.MAX_MAGNITUDE=1.25,cleverapps.UI.ImageFont.LETTERS_MAP={"/":"slash","+":"plus","-":"minus",":":"colon","#":"sharp",".":"point"," ":"space","[":"left_square_bracket","]":"right_square_bracket"},
cleverapps.UI.ImageFont.getFontSizeThreshold=function(){var e=8;return cc.sys.isMobile||(e=5),e*resolutionScale},cleverapps.UI.ImageFont.IsApplicable=function(e,t){if(!t)return!0;for(var n,s,i=e.name?e.name:"default",o=0;o<cleverapps.config.fonts.length;o++){var r=cleverapps.config.fonts[o];r.name===i&&(n=r.bundle,s=r.name+r.originalSize+"pt_")}var a=bundles[n].injectTo||[n];if(0===cleverapps.bundleLoader.countLoaded(a))return!1;for(o=0;o<t.length;o++){var c=cleverapps.UI.ImageFont.LETTERS_MAP[t[o]]||t[o];if(!bundles[n].frames[s+c])return!1}return!0},cleverapps.UI.ImageFont.intertypeSetString=function(e){e.textObj instanceof cleverapps.UI.ImageFont===cleverapps.UI.ImageFont.IsApplicable(e.font,e.string)?e.textObj.setString(e.string):e.recreateFunc(e.string)};var ScaledProgressBar=cc.Node.extend({ctor:function(e){this._super(),("string"==typeof e||e instanceof cc.SpriteFrame)&&(e={progress:e}),e.cascadeColor&&this.setCascadeColorEnabled(!0),this.minProgressWidth=e.minProgressWidth||0,
this.minProgressHeight=e.minProgressHeight||0;var t=e.padding||{};this.padding={left:t.left||t.x||0,right:t.right||t.x||0,top:t.top||t.y||0,bottom:t.bottom||t.y||0},this.layout=e.layout||ScaledProgressBar.HORIZONTAL,this.sizeDirty=!0,e.background&&(this.background=cleverapps.UI.createScale9Sprite(e.background),this.background.setAnchorPoint(0,0),this.addChild(this.background)),this.progress=cleverapps.UI.createScale9Sprite(e.progress),this.progress.setAnchorPoint(0,0),this.addChild(this.progress),this.layout===ScaledProgressBar.HORIZONTAL?this.progress.setCapInsets(cc.rect(this.progress.width/2-1,0,2,this.progress.height)):this.progress.setCapInsets(cc.rect(0,this.progress.height/2-1,this.progress.width,2)),e.foreground&&(this.foreground=cleverapps.UI.createScale9Sprite(e.foreground),this.foreground.setAnchorPoint(0,0),this.addChild(this.foreground));var n=e.background?cc.size(this.background.width,this.background.height):cc.size(this.progress.width,this.progress.height)
;this.percentage=0,this.setContentSize2(n.width,n.height),this.onChange()},onChange:function(){this.background&&this.sizeDirty&&this.background.setContentSize2(this.width,this.height),this.foreground&&this.sizeDirty&&this.foreground.setContentSize2(this.width,this.height);var e=this.padding,t=cc.size(this.width-e.left-e.right,this.height-e.top-e.bottom);this.layout===ScaledProgressBar.HORIZONTAL?t.width=0===this.percentage?0:Math.min(Math.max(this.minProgressWidth,t.width*this.percentage/100),t.width):t.height=0===this.percentage?0:Math.min(Math.max(this.minProgressHeight,t.height*this.percentage/100),t.height);var n=this.progress;n.setPositionRound(e.left,e.bottom),n.setContentSize2(t.width,t.height),this.sizeDirty=!1},animatedChange:function(e,t){if(0!==e){this.stopAnimatedChangeData();var n=[];n.push(new ScaledProgressBar.ProgressTo(.8,this.percentage+e).easing(cc.easeCubicActionOut())),t&&n.push(new cc.CallFunc(t)),this.animatedChangeAction=this.runAction(new cc.Sequence(n))}},
setDimension:function(e,t){void 0===t&&(t=e.height,e=e.width),this.setContentSize2(e,t),this.sizeDirty=!0,this.onChange()},setLayout:function(e){this.layout=e,this.onChange()},setMinProgressWidth:function(e){this.minProgressWidth=e,this.onChange()},setMinProgressHeight:function(e){this.minProgressHeight=e,this.onChange()},stopAnimatedChangeData:function(){this.animatedChangeAction&&!this.animatedChangeAction.isDone()&&(this.stopAction(this.animatedChangeAction),delete this.animatedChangeAction)},setPercentage:function(e){this.stopAnimatedChangeData(),e=Math.max(Math.min(e,100),0),this.percentage!==e&&(this.percentage=e,this.onChange())},getPercentage:function(){return this.percentage}});ScaledProgressBar.ProgressTo=cc.ProgressTo.extend({update:function(e){this.target instanceof ScaledProgressBar&&(e=this._computeEaseTime(e),this.target.percentage=Math.max(Math.min(this._from+(this._to-this._from)*e,100),0),this.target.onChange())}}),ScaledProgressBar.HORIZONTAL=0,
ScaledProgressBar.VERTICAL=1,cleverapps.Chest=function(e){this.locked=!1,this.onceUnlocked=function(){},this.changeLockedListener=function(){},this.storage=e.storage,this.serverTaskName=e.serverTaskName,e.isNewUser?(this.initializeForNewUser(),this.save()):this.load()},cleverapps.Chest.prototype._receiveReward=function(e,t){cleverapps.audio.playSound(bundles.main.urls.shop_buy_effect);var n=0;if(e.gold&&(cleverapps.user.setGold(cleverapps.user.gold+e.gold),t||(n=e.gold)),e.exp&&levels.user.expAvailable()&&cleverapps.user.setExp(cleverapps.user.exp+e.exp),e.boosters)for(var s in e.boosters)0<e.boosters[s]&&(cleverapps.boostersCounter.add(s,e.boosters[s]),t||(n+=cleverapps.config.prices.boosters[s][1]*(e.boosters[s]||1)));if(e.unlimitedLives&&(cleverapps.tempGoods.buyGood(cleverapps.TempGoods.UNLIMITED_LIVES,cleverapps.parseInterval(e.unlimitedLives.interval)),cleverapps.lives.onBuyUnlimitedLivesListener()),e.stars&&cleverapps.starChest.addStars(e.stars),e.gun&&cleverapps.gun.addAmount(
e.gun),cleverapps.lives&&(e.lives||e.energy)&&cleverapps.lives.setAmount(cleverapps.lives.amount+(e.lives||e.energy)),e.herolevels&&Array.isArray(e.herolevels)&&0<e.herolevels.length)for(var i=0;i<e.herolevels.length;i++)match3.heroes.setLevel(e.herolevels[i][0],Math.max(0,Math.min(Heroes.HEROES_MAX_LEVEL,e.herolevels[i][1])));if(e.wardrobe){var o=cleverapps.missionManager.getRunningMission(Missions.SEMAPHORE_WARDROBE);if(o){var r=o.logic.getProgressForStage(e.wardrobe);o.result<r&&(o.update(r-o.result),o.logic.stageToShow=e.wardrobe)}}if(e.coins||e.wands||e.worker||e.unit){var a=Game.currentGame,c=!1;if(a||(a=new Merge,c=!0),e.coins&&a.setCoins(a.coins+e.coins),e.wands&&a.setWands(a.wands+e.wands),e.worker&&a.workers.addBonusWorkerPeriod(e.worker.interval),e.unit){var l=cleverapps.toArray(e.unit).reduce(function(e,t){for(var n=0,s=t.amount||1;n<s;++n)e.push(new Unit(t));return e},[]);a.addUnits(l,{delay:1}),a.map.onCenterTo(l[0].x,l[0].y,{delay:1})}c&&(a.stop(),Game.currentGame=void 0
)}t||cleverapps.eventLogger.logEvent(cleverapps.EVENTS.REWARD_RECEIVED,{amount:n})},cleverapps.Chest.prototype.fromJSON=function(e){this.locked=e},cleverapps.Chest.prototype.toJSON=function(){return this.locked},cleverapps.Chest.prototype.load=function(){var e=cleverapps.DataLoader.load(this.storage);void 0===e?(this.initializeForNewUser(),this.save()):this.fromJSON(e)},cleverapps.Chest.prototype.save=function(e){cleverapps.DataLoader.save(this.storage,this.toJSON()),this.serverTaskName&&!1!==e&&cleverapps.synchronizer.addUpdateTask(this.serverTaskName)},cleverapps.Chest.prototype.initializeForNewUser=function(){this.locked=!1},cleverapps.Chest.prototype.unlock=function(){this.locked=!1,this.onceUnlocked(),this.changeLockedListener()},cleverapps.Chest.prototype.open=function(){this.locked=!0,this.changeLockedListener()},cleverapps.DailyChest=function(e){cleverapps.config.debugMode&&(cleverapps.DailyChest.TIMEOUT="10 minutes"),e=cleverapps.extend({
storage:cleverapps.DataLoaderTypes.DAILY_CHEST,interval:cleverapps.parseInterval(cleverapps.DailyChest.TIMEOUT)},e),this.onUnlockingStarted=function(){},this.interval=e.interval,cleverapps.Chest.call(this,e)},cleverapps.DailyChest.prototype=Object.create(cleverapps.Chest.prototype),cleverapps.DailyChest.prototype.constructor=cleverapps.DailyChest,cleverapps.DailyChest.prototype.initializeForNewUser=function(){this.locked=!0,this.startUnlockFromScratch()},cleverapps.DailyChest.prototype.fromJSON=function(e){this.locked=!0,this.setWhenUnlock(e.nextTime)},cleverapps.DailyChest.prototype.toJSON=function(){return{nextTime:this.when}},cleverapps.DailyChest.prototype.startUnlockFromScratch=function(){this.setWhenUnlock(Date.now()+this.interval)},cleverapps.DailyChest.prototype.open=function(){this.locked=!0,this.startUnlockFromScratch(),this.changeLockedListener()},cleverapps.DailyChest.prototype.resetUnlockCountdown=function(){void 0!==this.countdown?this.countdown.resetTimeLeft(
this.when-Date.now()):this.countdown=new cleverapps.CountDown(this.when-Date.now(),{onFinish:this.unlock.bind(this),permanent:!0}),this.onUnlockingStarted()},cleverapps.DailyChest.prototype.setWhenUnlock=function(e){e||(e=Date.now()),this.when=Math.min(e,Date.now()+this.interval),this.save(),this.resetUnlockCountdown()},cleverapps.DailyChest.TIMEOUT="3 hours";var StoryTeller=cc.Node.extend({ctor:function(){this._super();var e=cleverapps.styles.StoryTeller;this.setContentSize2(e.width,e.height),this.setAnchorPoint2();var t=new cleverapps.Spine(e.json);t.setAnimation(0,e.animation,!0),t.setScale(e.scale),this.addChild(t),t.setPositionRound(this.width/2,this.height/2+e.offsetY)}});StoryTeller.listBundles=function(){return cleverapps.Spine.listBundles(cleverapps.styles.StoryTeller.json)},cleverapps.styles.StoryTeller={width:310,height:310,offsetY:0,json:bundles.dialogues?bundles.dialogues.jsons.default_json:void 0,animation:"animation",scale:1};var SideBar=function(){var e=[MethaIcon,
DailyLevelIcon,PackIcon,PiggyBankIcon,SubscriptionIcon,DailyCupIcon];"undefined"!=typeof match3&&match3.heroes&&e.push(HeroesIcon),cleverapps.cardSkins&&e.push(CardSkinsIcon),cleverapps.starChest&&e.push(StarChestIcon),"merge"===cleverapps.config.type&&((e=[]).push(QuestsSideBarIcon),e.push(OrdersIcon),e.push(UnitsLibraryIcon),e.push(UnitsShopIcon),e.push(PackIcon),cleverapps.config.debugMode&&e.push(RegionsSideBarIcon)),e=e.concat(this.getLockedIcons()),this.defaultIcons=e.map(function(e){return new e}),this.icons=[],this.onAddIcon=function(){},this.onMoveIcon=function(){},this.onRemoveIcon=function(e){},this.onForceIcon=function(e){}};SideBar.prototype.getLockedIcons=function(){var e=[BonusWorldLockedIcon];return void 0!==EnergyFeastMissionWindow&&e.push(EnergyFeastLockedIcon),e},SideBar.prototype.reset=function(){this.icons=[]},SideBar.prototype.getDefaultIconByClassName=function(e){for(var t=0;t<this.defaultIcons.length;t++)if(this.defaultIcons[t]instanceof e
)return this.defaultIcons[t]},SideBar.prototype.getIconsByClassName=function(e){for(var t=[],n=0;n<this.icons.length;n++)this.icons[n]instanceof e&&t.push(this.icons[n]);return t},SideBar.prototype.resetByClassName=function(e){this.getIconsByClassName(e).forEach(function(e){e.resetState()})},SideBar.prototype.refreshAllIcons=function(){this.defaultIcons.forEach(function(e){e.resetState(),e.available?-1===this.icons.indexOf(e)&&this.addIcon(e):-1!==this.icons.indexOf(e)&&this.removeIcon(e)},this),this.icons.forEach(function(e){-1===this.defaultIcons.indexOf(e)&&e.resetState()},this)},SideBar.prototype.anyIconWithForceIndex=function(){for(var e=0;e<this.icons.length;e++){var t=this.icons[e];if(!t.locked){var n=t.getForce();if(n&&!cleverapps.forces.isShown(n.id))return e}}},SideBar.prototype.showAnyForce=function(){var t=this.anyIconWithForceIndex();void 0!==t&&cleverapps.metha.display({focus:"sidebarIconForce",control:"sidebar",actions:[function(e){setTimeout(e,1100)},function(e){
this.onForceIcon(t),cleverapps.forces.onceForceClosed=e}.bind(this)]})},SideBar.prototype.addIcon=function(e){if(this.icons.length===SideBar.SLOTS.length){var t=this.icons.map(function(e){return e.mission&&e.mission.name||""});cleverapps.ReportStream.debug("No vacant slot exists! icons - "+t.join(", "))}else this.icons.push(e),this.onAddIcon(this.icons.length-1)},SideBar.prototype.findMissionIcon=function(e){for(var t=0;t<this.icons.length;t++){var n=this.icons[t];if(n instanceof MissionIcon&&n.mission.type===e)return n}},SideBar.prototype.removeIcon=function(e){var t=this.icons.indexOf(e);if(-1!==t){for(this.onRemoveIcon(t);t<this.icons.length-1;t++)this.icons[t]=this.icons[t+1],this.onMoveIcon(t,t+1);this.icons.pop()}},SideBar.LEFT_COLUMN=0,SideBar.RIGHT_COLUMN=1,SideBar.SLOTS=[{row:0,col:SideBar.LEFT_COLUMN},{row:1,col:SideBar.LEFT_COLUMN},{row:2,col:SideBar.LEFT_COLUMN},{row:0,col:SideBar.RIGHT_COLUMN},{row:1,col:SideBar.RIGHT_COLUMN},{row:2,col:SideBar.RIGHT_COLUMN},{row:3,
col:SideBar.LEFT_COLUMN},{row:3,col:SideBar.RIGHT_COLUMN},{row:4,col:SideBar.LEFT_COLUMN},{row:4,col:SideBar.RIGHT_COLUMN}],SideBar.ICONS=[];var SideBarIcon=function(e){this.available=!1,this.animation=void 0,this.locked=!1,this.lottery=!1,this.attention=!1,this.title=void 0,this.leftTime=void 0,cleverapps.extend(this,e),this.onShowIconListener=function(){},this.onUnlockListener=function(){},this.onAddLotteryListener=function(){},this.onRemoveLotteryListener=function(){},this.onAttentionOnListener=function(){},this.onAttentionOffListener=function(){},this.onChangeTitleListener=function(){},this.onStartTimerListener=function(){},this.onRemoveTimerListener=function(){}};SideBarIcon.prototype.setAnimation=function(e){this.animation!==e&&(this.animation=e,this.onShowIconListener())},SideBarIcon.prototype.setIcon=function(e){this.icon!==e&&(this.icon=e,this.onShowIconListener())},SideBarIcon.prototype.setLocked=function(e){e=!!e,this.locked!==e&&(this.locked=e,
this.locked||this.onUnlockListener())},SideBarIcon.prototype.setLottery=function(e){e=!!e,this.lottery!==e&&((this.lottery=e)?this.onAddLotteryListener():this.onRemoveLotteryListener())},SideBarIcon.prototype.setAttention=function(e){e=!!e,this.attention!==e&&((this.attention=e)?this.onAttentionOnListener():this.onAttentionOffListener())},SideBarIcon.prototype.setTitle=function(e){this.title!==e&&(this.title=e,this.onChangeTitleListener())},SideBarIcon.prototype.setLeftTime=function(e){this.leftTime!==e&&(this.leftTime=e),0<this.leftTime?this.onStartTimerListener():this.onRemoveTimerListener()},SideBarIcon.prototype.resetState=function(){},SideBarIcon.prototype.getLockedTip=function(){return Messages.get("IconLocked.TipDefault",{level:this.getTipData()})},SideBarIcon.prototype.getTipData=function(){},SideBarIcon.prototype.onPressed=function(){},SideBarIcon.prototype.getForce=function(){},SideBarIcon.prototype.removeFromSideBar=function(){cleverapps.sideBar.removeIcon(this)},
SideBarIcon.prototype.getTitle=function(){return this.locked?this.locked.lockedEvent?Messages.get("Soon"):Messages.get("IconLocked.TextDefault",{levelNo:cleverapps.humanReadableNumber(this.locked.episode,this.locked.level)}):this.title};var SideBarIconView=cc.Node.extend({ctor:function(e){this.model=e,this._super(),this.setAnchorPoint2(),this.show(),this.model.target&&this.registerTarget(cleverapps.styles.SideBarIconView,this.model.target),e.onShowIconListener=this.createListener(this.showIcon.bind(this)),e.onUnlockListener=this.createListener(this.unlock.bind(this)),e.onAttentionOnListener=this.createListener(this.turnOnAttention.bind(this)),e.onAttentionOffListener=this.createListener(this.turnOffAttention.bind(this)),e.onChangeTitleListener=this.createListener(this.addTitle.bind(this)),e.onAddLotteryListener=this.createListener(this.addLotteryIcon.bind(this)),e.onRemoveLotteryListener=this.createListener(this.removeLotteryIcon.bind(this)),e.onStartTimerListener=this.createListener(
this.runTimer.bind(this)),e.onRemoveTimerListener=this.createListener(this.hideTimer.bind(this)),(this.model.animation||this.model.icon)&&this.showIcon(),this.model.locked&&this.setLocked(),this.model.lottery&&this.addLotteryIcon(),this.model.attention&&this.turnOnAttention(),this.model.title&&this.addTitle(),0<this.model.leftTime&&this.runTimer(),this.assignPressAction(),cleverapps.UI.applyHover(this)},addLotteryIcon:function(){this.removeLotteryIcon(),Lottery.addIcon(this,"icon")},removeLotteryIcon:function(){this.lotteryIcon&&this.lotteryIcon.removeFromParent()},assignPressAction:function(){this.touchListener&&(cc.eventManager.removeListener(this.touchListener),delete this.touchListener),this.model.locked?cleverapps.tooltipManager.create(this,{position:cleverapps.styles.UI.Tooltip.LOCATION.below,text:this.model.getLockedTip()}):(this.touchListener=cleverapps.UI.onClick(this,this.onPressed.bind(this),{useInteractiveScale:!0}),cleverapps.tooltipManager.remove(this))},
onPressed:function(){cleverapps.forces.isRunningForce()&&cleverapps.forces.closeRunningForce(),cleverapps.audio.playSound(bundles.main.urls.click_effect),this.model.onPressed()},showForce:function(){cleverapps.forces.create(this,this.model.getForce())},setSize:function(e){this.setContentSize2(e),this.setContentSize2(e),this.setPositionRound(this.width/2,this.height/2)},showIcon:function(){if(this.icon&&this.icon.removeFromParent(),this.model.icon){var e=this.model.icon,t=this.icon=e();cleverapps.UI.fitToBox(t,{width:.7*this.width,height:.7*this.height,maxScale:1.2}),t.setPositionRound(this.iconNode.width/2,this.iconNode.height/2),this.iconNode.addChild(t)}else if(this.model.animation){var n=this.icon=new cleverapps.Spine(this.model.animation);n.setPositionRound(this.iconNode.width/2,this.iconNode.height/2),this.iconNode.addChild(n);n.setAnimation(0,"animation",!1),this.model.locked||n.setCompleteListener(function(){n.runAction(new cc.Sequence(new cc.DelayTime(
cleverapps.Random.mathChoose(SideBarIconView.RANDOM_ANIMATION_INTERVALS)),new cc.CallFunc(function(){n.setAnimation(0,"animation",!1)})))})}},show:function(){var e=this.bg=cleverapps.UI.createScale9Sprite(cleverapps.skins.getSlot("iconBg",{image:bundles.sidebar.frames.icon_bg})),t=cleverapps.styles.SideBarIconView;t.bg&&t.bg.width&&e.setContentSize(t.bg),this.addChild(e),e.setPositionRound(e.width/2,e.height/2),this.setSize(e.getContentSize());var n=this.iconNode=new cc.Node;n.setAnchorPoint2(),n.setContentSize2(this.getContentSize());var s=cleverapps.styles.SideBarIconView.icon;n.setPositionRound(this.width/2+s.x,this.height/2+s.y),this.addChild(n)},setLocked:function(){var e=cleverapps.styles.SideBarIconView;this.bg.setColor(e.lock.color),this.icon&&this.icon.spine&&this.icon.spine.setColor(e.lock.color);var t=this.lock=new cc.Sprite(bundles.sidebar.frames.lock);this.addChild(t,1),t.setPositionRound(e.lock)},unlock:function(){this.lock.removeFromParent(),this.bg.setColor(
cleverapps.styles.COLORS.WHITE),this.icon&&this.icon.spine&&this.icon.spine.setColor(cleverapps.styles.COLORS.WHITE),this.assignPressAction()},addTitle:function(){if(this.text&&(this.text.removeFromParent(),delete this.text),this.textBg&&(this.textBg.removeFromParent(),delete this.textBg),void 0!==this.model.title){var e=cleverapps.styles.SideBarIconView.text;this.text=cleverapps.UI.generateTTFText(this.model.title,cleverapps.styles.FONTS.SIDEBAR_ICON_TEXT);var t=this.textBg=this.getTextBg();t?(t.setPositionRound(e),this.addChild(t),t.addChild(this.text),this.text.setPositionRound(t.width/2,t.height/2)):(this.addChild(this.text),this.text.setPositionRound(e)),this.text.y+=this.text instanceof cleverapps.UI.LabelTTF?e.regularFont.offsetY:e.offsetY,e.textWidth&&this.text.fitTo(e.textWidth),this.text.baseScale=this.text.scale}},runTimer:function(){this.hideTimer();var e=this.timer=new cleverapps.CountDown(this.model.leftTime,{onFinish:function(){this.model.resetState()}.bind(this)}),
t=cleverapps.styles.SideBarIconView.text,n={font:cleverapps.styles.FONTS.SIDEBAR_ICON_TEXT,timerPosition:{x:0,y:t.offsetY},regularFontTimerPosition:{x:0,y:t.regularFont.offsetY}},s=this.getTextBg();s&&(n.background_content=s);var i=this.timerView=new cleverapps.CountDownView(e,n);this.addChild(i),t.textWidth&&i.text.fitTo(t.textWidth),i.setPositionRound(t),i.baseScale=i.scale},getTextBg:function(){var e=cleverapps.styles.SideBarIconView.text.bg;if(e){var t=new cc.Sprite(bundles.sidebar.frames.icon_text_bg);if(e.scale9&&((t=cleverapps.UI.createScale9Sprite(bundles.sidebar.frames.icon_text_bg,cleverapps.UI.Scale9Rect.TwoPixelXY)).setContentSize2(e.width,e.height),e.arrow)){var n=new cc.Sprite(bundles.sidebar.frames.icon_text_arrow_bg);t.addChild(n),n.setPositionRound(e.arrow)}return t}},hideTimer:function(){this.timer&&(this.timer.remove(),delete this.timer),this.timerView&&(this.timerView.removeFromParent(),delete this.timerView)},turnOnAttention:function(){
var e=this.mark=new cc.Sprite(bundles.sidebar.frames.attention_png);e.setLocalZOrder(2),this.addChild(e),e.setPositionRound(cleverapps.styles.SideBarIconView.mark),e.runAction(new cc.RepeatForever(new cc.Sequence(new cc.ScaleTo(.3,1.1),new cc.ScaleTo(.3,1))))},turnOffAttention:function(){this.mark.stopAllActions(),this.mark.removeFromParent(!0),delete this.mark}});cleverapps.overrideFonts(cleverapps.styles.FONTS,{SIDEBAR_ICON_TEXT:{name:"default",size:40}}),cleverapps.styles.SideBarIconView={icon:{x:0,y:0},lock:{color:new cc.Color(130,130,130,255),x:{align:"right",dx:0},y:{align:"bottom",dy:0}},text:{offsetY:0,regularFont:{offsetY:0},x:{align:"center",dx:0},y:{align:"bottom",dy:0}},mark:{x:{align:"right",dx:-5},y:{align:"top",dy:-5}}},SideBarIconView.RANDOM_ANIMATION_INTERVALS=[5,7,9,11,12];var SideBarView=cc.Node.extend({ctor:function(e){this._super();var t=(e=e||{}).size||cleverapps.UI.getSceneSize();this.setAnchorPoint2(),this.setContentSize2(t.width,t.height),
this.slots=SideBar.SLOTS.map(function(e){var t=new SideBarSlotView(e,this);return this.addChild(t),t},this),cleverapps.sideBar.onAddIcon=this.createListener(this.insert.bind(this)),cleverapps.sideBar.onMoveIcon=this.createListener(this.move.bind(this)),cleverapps.sideBar.onRemoveIcon=this.createListener(this.eject.bind(this)),cleverapps.sideBar.onToggle=this.createListener(this.toggle.bind(this)),cleverapps.sideBar.onForceIcon=this.createListener(this.onForce.bind(this)),cleverapps.metha.registerControl("sidebar",this);for(var n=0;n<cleverapps.sideBar.icons.length;n++)this.insert(n,e)}});SideBarView.prototype.onForce=function(e){this.slots[e].showForce()},SideBarView.prototype.insert=function(e,t){var n=cleverapps.sideBar.icons[e],s=new SideBarIconView(n);this.slots[e].insert(s,cleverapps.extend({},t,{visible:cleverapps.metha.lastControlsVisible.sidebar}))},SideBarView.prototype.eject=function(e,t){return this.slots[e]&&this.slots[e].eject(t)},SideBarView.prototype.move=function(e,t){
var n=this.eject(t,!0);this.slots[e].insert(n)},SideBarView.prototype.toggle=function(t){this.slots.forEach(function(e){t?e.show():e.hide()})};var SideBarSlotView=cc.Node.extend({ctor:function(e,t){this._super();var n=cleverapps.styles.SideBarSlot;this.setAnchorPoint2(),this.setContentSize2(n.width,n.height),cleverapps.wideMode.mode===cleverapps.WideMode.VERTICAL&&n.mobileScale&&this.setScale(n.mobileScale),n.wideModeScales&&this.setScale(n.wideModeScales[cleverapps.wideMode.mode]),this.row=e.row,this.col=e.col;var s=this.width/2*this.scale,i=(this.width+n.padding.horizontal)*this.scale,o=t.height-n.padding.top-this.row*(n.margin+this.height*this.scale);this.col===SideBar.LEFT_COLUMN?(this.hidePosition={x:-s,y:o},this.showPosition={x:this.hidePosition.x+i,y:o}):(this.hidePosition={x:t.width+s,y:o},this.showPosition={x:this.hidePosition.x-i,y:o}),this.visible=!1,this.setPositionRound(this.hidePosition)},insert:function(e,t){t=t||{},this.iconView=e,this.addChild(e),e.setPositionRound(
this.width/2,this.height/2),void 0!==t.visible&&(this.hide(!0),t.visible&&this.show(t.silent))},eject:function(e){var t=this.iconView;return t.removeFromParent(!e),this.iconView=void 0,t},showForce:function(){this.show(!0),this.iconView.showForce()},show:function(e){this.iconView&&(this.stopAllActions(),e?(this.visible=!0,this.setPositionRound(this.showPosition)):this.runAction(new cc.Sequence(new cc.DelayTime(.3+.1*this.row),new cc.Show,new cc.MoveTo(.5,this.showPosition).easing(cc.easeBackOut()))))},hide:function(e){this.iconView&&(this.stopAllActions(),e?(this.visible=!1,this.setPositionRound(this.hidePosition)):this.runAction(new cc.Sequence(new cc.MoveTo(.15,this.hidePosition),new cc.Hide)))}});cleverapps.styles.SideBarSlot={width:200,height:200,margin:20,padding:{top:220,horizontal:15}};var MethaIcon=function(){SideBarIcon.call(this,{animation:bundles.sidebar.jsons.metha_icon_json})};MethaIcon.prototype=Object.create(SideBarIcon.prototype),(
MethaIcon.prototype.constructor=MethaIcon).prototype.resetState=function(){this.available=cleverapps.metha.withSimpleMain();var e=!1;switch(cleverapps.metha.getType()){case Metha.FARM:!cleverapps.farm.isCompleted()&&cleverapps.farm.getBuilding().getQuest().isCompleted()&&(e=!0);break;case Metha.HOMEFIX:!cleverapps.home.isCompleted()&&cleverapps.home.getFurnitureToUpgrade()&&(e=!0)}this.setAttention(e)},MethaIcon.prototype.onPressed=function(){cleverapps.metha.display({focus:"gotoMetha",action:function(e){cleverapps.scenes.replaceScene(new NoMainMethaScene,e)}})};var DailyLevelIcon=function(){SideBarIcon.call(this,{animation:bundles.sidebar.jsons.daily_level_json})};DailyLevelIcon.prototype=Object.create(SideBarIcon.prototype),(DailyLevelIcon.prototype.constructor=DailyLevelIcon).prototype.resetState=function(){this.available=cleverapps.dailyLevel.isActive(),this.setAttention(!0)},DailyLevelIcon.prototype.onPressed=function(){cleverapps.metha.display({focus:"DailyLevel",action:function(
e){cleverapps.dailyLevel.start(e)}})};var PackIcon=function(){SideBarIcon.call(this,{lottery:!0})};PackIcon.prototype=Object.create(SideBarIcon.prototype),(PackIcon.prototype.constructor=PackIcon).prototype.resetState=function(){if(this.available=cleverapps.packManager.isAvailable(),this.available){var e=cleverapps.packManager.get(),t={0:bundles.sidebar.jsons.pack_icon_json,1:bundles.sidebar.jsons.pack1_icon_json,2:bundles.sidebar.jsons.pack2_icon_json};this.setAnimation(t[e.stage])}},PackIcon.prototype.onPressed=function(){cleverapps.metha.display({focus:"PackWindow",control:["MenuBarGoldItem","MenuBarLivesItem","MenuBarCoinsItem","MenuBarWandsItem","MenuBarWorkersItem"],action:function(e){new PackWindow,cleverapps.metha.onceNoWindowsListener=e}})};var PiggyBankIcon=function(){SideBarIcon.call(this,{animation:bundles.sidebar.jsons.piggybank_icon_json})};PiggyBankIcon.prototype=Object.create(SideBarIcon.prototype),(PiggyBankIcon.prototype.constructor=PiggyBankIcon
).prototype.resetState=function(){this.available=cleverapps.piggyBank.isActive(),this.setAttention(cleverapps.piggyBank.isFull()),this.setLeftTime(cleverapps.piggyBank.getLeftTime())},PiggyBankIcon.prototype.onPressed=function(){cleverapps.metha.display({focus:"PiggyBankWindow",control:"MenuBarGoldItem",action:function(e){new PiggyBankWindow,cleverapps.metha.onceNoWindowsListener=e}})};var SubscriptionIcon=function(){var e=cleverapps.subscription&&!cleverapps.subscription.isActive();SideBarIcon.call(this,{lottery:e,animation:bundles.sidebar.jsons.premium_icon_json})};SubscriptionIcon.prototype=Object.create(SideBarIcon.prototype),(SubscriptionIcon.prototype.constructor=SubscriptionIcon).prototype.resetState=function(){this.available=Subscription.IsAvailable();var e=!1,t=!1,n=void 0;cleverapps.subscription&&cleverapps.subscription.isActive()&&(e=!(0<(n=cleverapps.subscription.getLeftTime()))&&(t=!0)),this.setLottery(e),this.setAttention(t),this.setLeftTime(n)},
SubscriptionIcon.prototype.onPressed=function(){cleverapps.metha.display({focus:"SubscriptionWindow",action:function(e){cleverapps.subscription.reload(),new SubscriptionWindow,cleverapps.metha.onceNoWindowsListener=e}})};var DailyCupIcon=function(){SideBarIcon.call(this,{animation:bundles.sidebar.jsons.dailycup_icon_json})};DailyCupIcon.prototype=Object.create(SideBarIcon.prototype),(DailyCupIcon.prototype.constructor=DailyCupIcon).prototype.getForce=function(){return Forces.DAILY_CUP},DailyCupIcon.prototype.resetState=function(){this.available=cleverapps.dailyCup&&DailyCup.IsAvailable(DailyCup.TYPE_DAILY,{future:!0});var e=this.available&&!DailyCup.IsAvailable(DailyCup.TYPE_DAILY);if(this.available&&!e&&(this.available=cleverapps.dailyCup.isActive()),e)this.setLocked(!0),this.setAttention(!1),this.setTitle(Messages.get("IconLocked.TextDefault",{levelNo:this.getTipData()}));else{this.setLocked(!1),this.setAttention(!this.locked&&cleverapps.dailyCup.isFinished())
;var t=cleverapps.dailyCup.getTimeLeft();0<t?(this.setLeftTime(t),this.setTitle(void 0)):(this.setLeftTime(0),this.setTitle("messages:Finished"))}},DailyCupIcon.prototype.onPressed=function(){cleverapps.metha.display({focus:"DailyCupSceneFromIcon",control:["toolbar","sidebar"],action:function(e){cleverapps.scenes.replaceScene(new DailyCupScene,e)}})},DailyCupIcon.prototype.getTipData=function(){var e=DailyCupsConfig[DailyCup.TYPE_DAILY].available;return cleverapps.humanReadableNumber(e.episode,e.level)};var HeroesIcon=function(){SideBarIcon.call(this,{animation:bundles.sidebar.jsons.heroes_icon_json})};HeroesIcon.prototype=Object.create(SideBarIcon.prototype),(HeroesIcon.prototype.constructor=HeroesIcon).prototype.resetState=function(){this.available="undefined"!=typeof match3&&match3.heroes&&match3.heroes.available({future:!0}),this.available&&!match3.heroes.available()?(this.setLocked(!0),this.setAttention(!1),this.setTitle(Messages.get("IconLocked.TextDefault",{
levelNo:this.getTipData()}))):(this.setLocked(!1),this.setAttention(match3.heroes.canUpgradeSomebody()),this.setTitle(void 0))},HeroesIcon.prototype.onPressed=function(){cleverapps.metha.display({focus:"HeroesSceneFromIcon",control:["toolbar","sidebar"],action:function(e){cleverapps.scenes.replaceScene(new HeroesScene,e)}})},HeroesIcon.prototype.getForce=function(){return Forces.HEROES_AVAILABLE},HeroesIcon.prototype.getTipData=function(){return cleverapps.humanReadableNumber(Heroes.AVAILABLE.episode,Heroes.AVAILABLE.level)};var CardSkinsIcon=function(){SideBarIcon.call(this,{animation:bundles.sidebar.jsons.card_skin_icon_json})};CardSkinsIcon.prototype=Object.create(SideBarIcon.prototype),(CardSkinsIcon.prototype.constructor=CardSkinsIcon).prototype.onPressed=function(){cleverapps.metha.display({focus:"CardSkinsSceneFromIcon",control:["toolbar","sidebar"],action:function(e){cleverapps.scenes.replaceScene(new CardSkinsScene,e)}})},CardSkinsIcon.prototype.resetState=function(){
this.available=cleverapps.cardSkins&&cleverapps.cardSkins.available()};var QuestsSideBarIcon=function(){SideBarIcon.call(this,{}),this.quest=void 0};QuestsSideBarIcon.prototype=Object.create(SideBarIcon.prototype),(QuestsSideBarIcon.prototype.constructor=QuestsSideBarIcon).prototype.setQuest=function(e){return this.quest!==e&&(this.quest=e,!0)},QuestsSideBarIcon.prototype.onPressed=function(){cleverapps.metha.display({focus:"QuestsIconClicked",action:function(e){new QuestsWindow,cleverapps.metha.onceNoWindowsListener=e}.bind(this)})},QuestsSideBarIcon.GenerateIcon=function(e){if(e)return QuestIcon.getIconImage(e)},QuestsSideBarIcon.prototype.resetState=function(){if(this.available=Game.currentGame&&Game.currentGame.quests&&Game.currentGame.quests.getSelectedQuest()&&!cleverapps.config.editorMode,this.available){var e=Game.currentGame.quests.getSelectedQuest();this.setQuest(e)&&this.setIcon(function(){return QuestsSideBarIcon.GenerateIcon(this.quest)}.bind(this)),this.setTitle(
e.progress+"/"+e.goal)}};var OrdersIcon=function(){SideBarIcon.call(this,{animation:bundles.sidebar.jsons.orders_json,target:"orders"})};OrdersIcon.prototype=Object.create(SideBarIcon.prototype),(OrdersIcon.prototype.constructor=OrdersIcon).prototype.onPressed=function(){cleverapps.metha.display({focus:"OrdersIconClicked",action:function(e){new OrdersWindow,cleverapps.metha.onceNoWindowsListener=e}.bind(this)})},OrdersIcon.prototype.resetState=function(){this.available=Game.currentGame&&2<=Game.currentGame.gameLevel.getLevel()&&!cleverapps.config.editorMode,this.available&&this.setAttention(Game.currentGame.orders.findCanCook()||Game.currentGame.orders.findReady())};var UnitsShopIcon=function(){SideBarIcon.call(this,{animation:bundles.sidebar.jsons.units_shop_json})};UnitsShopIcon.prototype=Object.create(SideBarIcon.prototype),(UnitsShopIcon.prototype.constructor=UnitsShopIcon).prototype.onPressed=function(){cleverapps.metha.display({focus:"UnitsShopIconClicked",control:[
"MenuBarGoldItem","MenuBarCoinsItem"],action:function(e){new UnitsShopWindow,cleverapps.metha.onceNoWindowsListener=e}.bind(this)})},UnitsShopIcon.prototype.resetState=function(){this.available=Game.currentGame&&5<=Game.currentGame.gameLevel.getLevel()&&Game.currentGame.unitsShop&&!cleverapps.config.editorMode,this.available&&this.setAttention(Game.currentGame.unitsShop.canTakeFreeChest())};var UnitsLibraryIcon=function(){SideBarIcon.call(this,{animation:bundles.sidebar.jsons.units_library_json})};UnitsLibraryIcon.prototype=Object.create(SideBarIcon.prototype),(UnitsLibraryIcon.prototype.constructor=UnitsLibraryIcon).prototype.onPressed=function(){cleverapps.metha.display({control:["MenuBarCoinsItem"],focus:"UnitsLibraryIconClicked",action:function(e){new UnitsLibraryWindow,cleverapps.metha.onceNoWindowsListener=e}.bind(this)})},UnitsLibraryIcon.prototype.resetState=function(){this.available=Game.currentGame&&3<=Game.currentGame.gameLevel.getLevel()&&!cleverapps.config.editorMode,
this.available&&this.setAttention(Game.currentGame.unitsLibrary.hasAnyFresh())};var RegionsSideBarIcon=function(){SideBarIcon.call(this,{animation:bundles.sidebar.jsons.units_library_json})};RegionsSideBarIcon.prototype=Object.create(SideBarIcon.prototype),(RegionsSideBarIcon.prototype.constructor=RegionsSideBarIcon).prototype.onPressed=function(){cleverapps.metha.display({focus:"RegionsIconClicked",action:function(e){new RegionsWindow,cleverapps.metha.onceNoWindowsListener=e}.bind(this)})},RegionsSideBarIcon.prototype.resetState=function(){this.available=Game.currentGame&&cleverapps.environment.isEditorScene()};var StarChestIcon=function(){SideBarIcon.call(this,{animation:bundles.sidebar.jsons.star_chest_icon_json})};StarChestIcon.prototype=Object.create(SideBarIcon.prototype),(StarChestIcon.prototype.constructor=StarChestIcon).prototype.resetState=function(){this.available=void 0!==cleverapps.starChest;var e=cleverapps.starChest.stars+"/"+cleverapps.StarChest.GOAL_AMOUNT
;this.setTitle(e),this.setAttention(cleverapps.starChest.stars>=cleverapps.StarChest.GOAL_AMOUNT)},StarChestIcon.prototype.onPressed=function(){cleverapps.metha.display({focus:"StarChestWindow",action:function(e){cleverapps.starChest.locked?new StarChestLockedWindow:new StarChestWindow,cleverapps.metha.onceNoWindowsListener=e}})};var AutoScrollText=cc.Node.extend({ctor:function(e,t){this._super(),this.options=t||{},this.styles=cleverapps.overrideStyles(cleverapps.styles.AutoScrollText,t.styles||{},!0),this.setAnchorPoint2(),this.styles.bg?this.bg=new cc.Scale9Sprite(this.styles.bg.image):this.bg=new cc.Node,this.addChild(this.bg),this.bg.setAnchorPoint2(),this.createTexts(e),this.createArrow(),this.currentTextIndex=0,this.texts[this.currentTextIndex].setVisible(!0)},createTexts:function(e){this.texts=[];var n=0;e.forEach(function(e){var t=cleverapps.UI.generateTTFText(e,this.styles.font);t.setDimensions(this.styles.width,0),t.setHorizontalAlignment(this.styles.horizontalAlignment),
t.fitTo(void 0,this.styles.height),t.setVisible(!1),this.texts.push(t),this.bg.addChild(t),n=Math.max(n,t.height)}.bind(this)),this.bg.setContentSize2(this.styles.width+2*this.styles.padding.x,n+2*this.styles.padding.y),this.setContentSize2(this.bg.getContentSize()),this.bg.setPositionRound(this.width/2,this.height/2),this.texts.forEach(function(e){e.setPositionRound(this.bg.width/2,this.bg.height/2)}.bind(this))},createArrow:function(){var e=cleverapps.UI.generateTTFText("",this.styles.font),t=new cc.Node;t.setContentSize2(3*e.width,3*e.height),t.setAnchorPoint2(),this.bg.addChild(t),t.setPositionRound(this.styles.arrow),t.addChild(e),e.setPositionRound(t.width/2,t.height/2),cleverapps.UI.onClick(t,function(){this.next(),this.reinitTimer()}.bind(this))},next:function(){this.texts[this.currentTextIndex].setVisible(!1),this.currentTextIndex=(this.currentTextIndex+1)%this.texts.length,this.texts[this.currentTextIndex].setVisible(!0)},reinitTimer:function(){this.stopAllActions(),
this.runAction(new cc.Sequence(new cc.DelayTime(5),new cc.CallFunc(this.next.bind(this))).repeatForever())},setTextByIndex:function(e){this.texts[this.currentTextIndex]&&this.texts[this.currentTextIndex].setVisible(!1),this.currentTextIndex=e,this.texts[this.currentTextIndex].setVisible(!0)}});cleverapps.styles.AutoScrollText={font:cleverapps.styles.FONTS.WINDOW_TEXT,horizontalAlignment:cc.TEXT_ALIGNMENT_CENTER,padding:{x:30,y:60},arrow:{x:{align:"right",dx:0},y:{align:"bottom",dy:-30}}};var FbButton=cleverapps.UI.Button.extend({ctor:function(e){this.options=e||{},this.login=e.login||!cleverapps.social.isLoggedIn()&&!cleverapps.social.nativeInviteFriends,this.options.hasOwnProperty("showIcon")||(this.options.showIcon=!0),this.options.hasOwnProperty("showText")||(this.options.showText=!0),this.options.onSuccess=this.options.onSuccess||function(){},this.options.onFailure=this.options.onFailure||function(){},this.source=this.options.source||cleverapps.User.calcSource()
;var t=this.generateContent(),n=cleverapps.styles.FbButton,s={button_png:this.options.button_png||n.button_png,button_on_png:this.options.button_on_png||n.button_on_png,width:this.options.width||t.width,height:this.options.height||n.height,onClicked:this.onClicked.bind(this),content:t,contentOffset:n.iconOffset,scale:!1,fitTo:!1};this.options.multiSocials&&(s.button_png=n.multiSocials[this.source+"_button_png"]||n.multiSocials.button_png,s.button_on_png=n.multiSocials[this.source+"_button_on_png"]||n.multiSocials.button_on_png,s.width=1.1*s.height),this._super(s),this.onSuccess=e.onSuccess||function(){},cleverapps.social.isInitialized()||(this.connecting=!0,this.onMouseOver=function(){},this.onMouseOut=function(){})},generateContent:function(){var e=cleverapps.styles.FbButton;this.text=this.login?"messages:SignIn":"messages:FBLoginOrInvite.Button.Invite",this.connecting&&(this.text="messages:FBLoginOrInvite.Button.Connecting");var t,n=[],s=e.icon;if(
this.login||this.options.showIcon&&!cleverapps.social.nativeInviteFriends?(t=e.icon.image[this.source]||bundles.main.frames.fb_icon_png,this.options.multiSocials&&e.multiSocials.icons[this.source]&&(t=e.multiSocials.icons[this.source])):this.options.showIcon&&cleverapps.social.nativeInviteFriends&&(t=bundles.main.frames.native_invite_icon_png,s=e.inviteIcon||s),t){var i=new cc.Sprite(t);i.setScale(this.options.iconScale||s.scale),i.setPositionY(s.offsetY),n.push(i)}if(this.options.showText){var o=cleverapps.UI.generateTTFText(this.text,this.options.font||e.font);n.push(o)}var r=new cleverapps.Layout(n,{direction:cleverapps.UI.HORIZONTAL,margin:e.margin,padding:{x:e.padding,y:0}});return r.setCascadeOpacityEnabled(!0),r},onClicked:function(){if(cleverapps.social.isInitialized())if(this.login){var e=function(){var e=function(){cleverapps.eventLogger.logEvent(cleverapps.EVENTS.LOGIN,{method:this.options.source}),this.options.onSuccess()}.bind(this);cleverapps.social.login(e,
this.options.onFailure,{source:this.options.source})}.bind(this);this.options.multiSocials&&cc.sys.isNative?(this.stopAllActions(),this.setScale(.95),this.runAction(new cc.Sequence(new cc.DelayTime(.05),new cc.CallFunc(e),new cc.ScaleTo(.15,1).easing(cc.easeBackInOut())))):e()}else{cleverapps.history.add("invt",1);var t={message:Messages.get("SettingsWindow.InviteFriends.message"),title:Messages.get("SettingsWindow.InviteFriends.title"),element:this};e=function(e){e===cleverapps.Social.CODE_SUCCEED?(cleverapps.dailyTasks.addProgress(cleverapps.DailyTask.INVITE_FRIENDS),this.options.onSuccess()):this.options.onFailure()}.bind(this);cleverapps.social.inviteFriends(t,e)}else cleverapps.Notification.create("messages:SocialManager.Initialization")}});cleverapps.styles.FbButton={height:110,padding:70,margin:15,font:cleverapps.styles.FONTS.BUTTON_TEXT,multiSocials:{button_png:bundles.main.frames.white_outline_button_png,button_on_png:bundles.main.frames.white_outline_button_on_png,
androidsocial_button_png:bundles.main.frames.white_shadow_button_png,androidsocial_button_on_png:bundles.main.frames.white_shadow_button_on_png,facebook_button_png:bundles.main.frames.blue_outline_button_png,facebook_button_on_png:bundles.main.frames.blue_outline_button_on_png,icons:{}},icon:{image:{mobile_ok:bundles.main.frames.ok_icon_png,web_ok:bundles.main.frames.ok_icon_png,facebook:bundles.main.frames.fb_icon_png,mobile_vk:bundles.main.frames.vk_icon_png,web_vk:bundles.main.frames.vk_icon_png,mbga:bundles.main.frames.mobage_icon_png,sp_mbga:bundles.main.frames.mobage_icon_png,nk:bundles.main.frames.nk_icon_png,draugiem:bundles.main.frames.draugiem_icon_png,web_mm:bundles.main.frames.mm_icon_png,mobile_mm:bundles.main.frames.mm_icon_png,fotostrana:bundles.main.frames.fs_icon_png,androidsocial:bundles.main.frames.google_icon_png,applesocial:bundles.main.frames.apple_icon_png},scale:.9,offsetY:0},inviteIcon:{scale:1,offsetY:-3}};var BandButton=cc.Node.extend({ctor:function(e){
this._super();var t=cleverapps.styles.BandButton;this.setAnchorPoint2(),this.setContentSize2(t);var n=cleverapps.clone(t.position,!0);this.setPositionRound(n);var s=cleverapps.UI.createScale9Sprite(bundles.buttons_main.frames.scene_exit_button,cleverapps.UI.Scale9Rect.TwoPixelXY);s.setContentSize2(t),this.addChild(s),s.setPositionRound(this.width/2,this.height/2);var i=new cc.Sprite(bundles.buttons_main.frames.exit_button_icon);this.addChild(i),i.setPositionRound(t.icon),cleverapps.UI.makeHideable(this,cleverapps.UI.VERTICAL),cleverapps.UI.applyHover(this),cleverapps.UI.onClick(this,function(){cleverapps.audio.playSound(bundles.main.urls.click_effect),e.onClicked()}.bind(this),{useInteractiveScale:!0})},hide:function(e){if(e)return this.setPositionRound(this.hideHandler.hidePosition),void this.setVisible(!1);this._animate("close",function(){this.setVisible(!1)}.bind(this))},show:function(){this.setVisible(!0),this._animate("open")},_animate:function(e,t){this.stopAllActions()
;var n="open"===e?cc.easeBackOut(10):cc.easeBackIn(10),s="open"===e?this.hideHandler.originalPosition:this.hideHandler.hidePosition;this.runAction(new cc.Sequence(new cc.MoveTo(.3,s).easing(n),new cc.CallFunc(function(){t&&t()})))}});cleverapps.styles.BandButton={width:85,height:190,position:{x:{align:"right",dx:-40},y:{align:"top",dy:10}},icon:{x:{align:"center"},y:{align:"bottom",dy:25}}},cleverapps.Path=cc.Node.extend({ctor:function(e,t){this._super(),this.baseColor=e,this.pathColor=cc.color(this.baseColor),this.lineWidth=t||cleverapps.styles.Path.lineWidth,this.segments=[];for(var n=0;n<cleverapps.Path.MAX_SEGMENTS;++n)this.segments.push(cleverapps.UI.createScale9Sprite(cleverapps.styles.Path.image)),this.segments[n].setAnchorPoint2(0,.5),this.segments[n].visible=!1,this.addChild(this.segments[n]);this.path=[],this.animatingInterval=void 0,this.drawTrailing=!0,this.setCascadeOpacityEnabled(!0),this.setLocalZOrder(-1)},clear:function(){this.segments.forEach(function(e){e.visible=!1}
)},reset:function(){this.animatingInterval&&(clearInterval(this.animatingInterval),this.animatingInterval=void 0),this.clearFadeInInterval(),this.path=[],this.pathColor=cc.color(this.baseColor),this.opacity=255,this.draw()},clearFadeInInterval:function(){void 0!==this.animateFadeInInterval&&(clearInterval(this.animateFadeInInterval),this.animateFadeInInterval=void 0)},push:function(e){this.path.push(e),this.draw()},pop:function(){this.path.pop(),this.draw()},setPath:function(e){this.path=e.map(function(e){return e})},listPath:function(){return this.path},onExitTransitionDidStart:function(){this.reset(),this._super()},drawSegment:function(e,t,n){var s=15*resolutionScale/2*.9,i=Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))+2*s,o=this.segments[n];o.setColor(this.pathColor),o.setContentSize2(i,this.lineWidth);var r=Math.round(100*Math.atan2(t.y-e.y,t.x-e.x))/100;o.setPositionRound(e.x-s*Math.cos(r),e.y-s*Math.sin(r)),o.rotation=180*-r/Math.PI,o.visible=!0},draw:function(e){if(
this.clear(),0<this.path.length)for(var t=this.drawTrailing&&e?this.path.concat(e):this.path,n=0;n<t.length-1;n++)this.drawSegment(t[n],t[n+1],n)},stopAnimation:function(){this.animatingInterval&&this.reset()},animateFadeIn:function(e){e=e||300;var t=0,n=this.createListener(function(){this.opacity=Math.min(255,Math.floor(255*(1-(e-t)/e))),this.draw(),e<=(t+=16)&&this.clearFadeInInterval()});this.animateFadeInInterval=setInterval(n,16),n()},animateFadeOut:function(e){e=e||300;var t=0,n=this.createListener(function(){e<=t?this.reset():(this.opacity=Math.floor(Math.min(155,this.baseColor.a)*(e-t)/e),this.draw(),t+=16)});this.stopAnimation(),this.animatingInterval=setInterval(n,16),n()}}),cleverapps.Path.MAX_SEGMENTS=10,cleverapps.styles.Path={lineWidth:17,image:bundles.game.frames.line_png};var Product=function(e){if(cleverapps.extend(this,e),this.title=Messages.getLocalized(this.title),this.description=Messages.getLocalized(this.description),this.onChangeDescription=function(){},this.id
){var t="res/fbproducts/"+(cleverapps.settings.language+"/"+(0===cleverapps.config.debugMode?"production/":""))+this.id.facebook;this.id.facebook=cleverapps.config.deployment+"/"+t}};Product.SearchProductId=function(e){if(-1!==e.indexOf(".html"))for(var t in cleverapps.config.products){var n=cleverapps.config.products[t];if(n.id&&n.id.facebook===e)return t}return e},Product.FormatUnlimitedLives=function(e,t){if("object"==typeof e)return e;var n=Math.round(cleverapps.parseInterval(e)/1e3/60),s={15:"15 minutes",10:"10 minutes",30:"30 minutes",45:"45 minutes",60:"OneHour",120:"TwoHours",180:"ThreeHours",360:"6 hours",720:"12 hours"};return{title:(t?"messages:UnlimitedLivesShort.":"messages:UnlimitedLives.")+({1:"1 day",2:"2 day",3:"3 day",5:"5 day",9:"9 day",10:"10 day"}[Math.floor(n/60/24)]||s[n]),interval:e}},Product.AddUpRewards=function(e,t){for(var n in t=t||{},e){var s=e[n];if("unlimitedLives"===n)t[n]=t[n]?t[n]+cleverapps.parseInterval(s):cleverapps.parseInterval(s);else if(
"boosters"===n)for(var i in t.boosters||(t.boosters={}),s)t.boosters[i]=t.boosters[i]?t.boosters[i]+parseInt(s[i]):parseInt(s[i]);else t[n]=t[n]?t[n]+parseInt(s):parseInt(s)}return t},Product.UnlimitedToHours=function(e){if(e.unlimitedLives){var t=Math.round(e.unlimitedLives/1e3/60/60);e.unlimitedLives={title:Messages.get("AMOUNT_HOURS",{amount:t}),interval:t+" hours"}}return e},Product.prototype.getCurrentPrice=function(){return this.loadedPrice?this.loadedPrice:Product.CURRENCY+" "+this.price},Product.prototype.validate=function(t,e){var n={itemId:this.itemId,price:this.price,textPrice:this.getCurrentPrice()};n.price=Math.round(n.price*cleverapps.User.calcPriceCoef()*100)/100;var s=function(){if("subscription"===this.type?cleverapps.eventLogger.logEvent(cleverapps.EVENTS.SUBSCRIPTION_BOUGHT,n):(cleverapps.eventLogger.logEvent(cleverapps.EVENTS.PRODUCT_BOUGHT,n),cleverapps.eventLogger.logEvent(cleverapps.EVENTS.PRODUCT_BOUGHT_LANGUAGE,{amount:n.price}),
t&&cleverapps.payments.logPurchase(t),cleverapps.paymentsHistory.addPayment(this),this.favoriteId=Favorite.CalcFavorite(),this.favoriteId===n.itemId&&cleverapps.eventLogger.logEvent(cleverapps.EVENTS.FAVORITE_REGULAR,{amount:n.price}),cleverapps.history.add("paid",n.price),cleverapps.history.add("pmnt",1)),this.favorite)cleverapps.eventLogger.logEvent(cleverapps.EVENTS.FAVORITE_PRODUCT_BOUGHT,{amount:n.price});else if("gunShot"===this.itemId)cleverapps.eventLogger.logEvent(cleverapps.EVENTS.GUN_SHOT);else if("battlepass"===this.itemId)cleverapps.eventLogger.logEvent(cleverapps.EVENTS.BATTLE_PASS_BOUGHT);else if(-1!==["starterPack0","starterPack","starterPack2"].indexOf(this.itemId)){var e=["starterPack0","starterPack","starterPack2"].indexOf(this.itemId);cleverapps.eventLogger.logEvent(cleverapps.EVENTS.PACK_BOUGHT_WITH_PAYMENT),cleverapps.eventLogger.logEvent(cleverapps.EVENTS.PACK_BOUGHT+"_starterPack"+(0===e?"":"_"+e))}else-1!==["piggybank500","piggybank1800","piggybank6000",
"piggybank25000"].indexOf(this.itemId)?(cleverapps.eventLogger.logEvent(cleverapps.EVENTS.PIGGY_BANK),cleverapps.eventLogger.logEvent(cleverapps.EVENTS.PIGGY_BANK_LEVEL+this.piggyBankLevel)):-1!==["addMoves1","addMoves2","addMoves3","addMoves5"].indexOf(this.itemId)&&cleverapps.eventLogger.logEvent(cleverapps.EVENTS.BUY_MOVES+this.itemId);"string"==typeof cleverapps.environment.episodeNo&&0===cleverapps.environment.episodeNo.indexOf("bonus_world_")&&cleverapps.eventLogger.logEvent(cleverapps.EVENTS.PRODUCT_BOUGHT_BONUS_WORLD)}.bind(this);e?cleverapps.payments.compensateValidate?cleverapps.payments.compensateValidate(s):s():cleverapps.payments.validate(t,s)},Product.prototype.showBoughtMessage=function(e){var n=this.boughtMessage||"messages:Product.YouBought",s=this.boughtMessageParams||{};s.moves=this.moves,e&&(e.gold||e.coins)&&(s.coins=e.gold||e.coins);var i=cleverapps.isLocalhost()||cleverapps.isInstant()?this.image.substr(1):cleverapps.config.deployment+this.image;cc.loader.load(i,
function(e){var t=void 0;e||(t=new cc.Sprite(i)).setScale(.6*resolutionScale);cleverapps.Notification.create(n,{toReplace:s,image:t,leaveOnResize:!0})}.bind(this))},Product.prototype.compensate=function(){var t=this.compensateReward||this.reward;t&&(this.validate(void 0,!0),this.showBoughtMessage(t),cleverapps.metha.display({focus:"purchaseRewardWindow",action:function(e){new PurchaseRewardWindow({reward:t,callback:function(){var e=cleverapps.packManager.get();e&&e.product===this.key&&cleverapps.packManager.onBuyPack(),cleverapps.piggyBank.getProduct().itemId===this.key&&cleverapps.piggyBank.onBuy()}.bind(this)}),cleverapps.metha.onceNoWindowsListener=e}.bind(this)}),cleverapps.audio.playSound(bundles.main.urls.shop_buy_effect))},Product.prototype.onBuyed=function(e,t,n){var s=e;e=function(){cleverapps.payments.onPaymentFinished&&cleverapps.payments.onPaymentFinished(),s&&s()},this.showBoughtMessage(this.reward),cleverapps.user.incProgressCompare(500);var i=this.reward;if(n&&(
i=this.videoReward),i){var o={reward:i,callback:e};cleverapps.metha.isFocused()?new PurchaseRewardWindow(o):cleverapps.metha.display({focus:"purchaseRewardWindow",control:t,action:function(e){new PurchaseRewardWindow(o),cleverapps.metha.onceNoWindowsListener=e}.bind(this)})}else e();cleverapps.audio.playSound(bundles.main.urls.shop_buy_effect)},Product.prototype.buy=function(s,i){var o=function(e,t,n){if(e){cleverapps.Notification.create("messages:Product.PurchaseCancelled"),cleverapps.payments.onPaymentFinished&&cleverapps.payments.onPaymentFinished(),n&&(cleverapps.metha.display({focus:"ErrorWindow",action:function(e){new ErrorWindow(n),cleverapps.metha.onceNoWindowsListener=e}}),cleverapps.ReportStream.send("product","product buy error "+n))}else this.validate(t),this.onBuyed(s,i)}.bind(this),r=cleverapps.metha.focus,e=function(){var s=this.waitWindow();cleverapps.payments.open(this,function(e,t,n){s&&s(),r!==cleverapps.metha.focus&&cleverapps.metha.isFocused(
)?cleverapps.metha.whenFreeFocus(function(){o(e,t,n)}):o(e,t,n)}.bind(this))}.bind(this);cc.sys.isNative?e():cleverapps.social.checkConnection(e)},Product.prototype.waitWindow=function(){var t;return cleverapps.metha.isFocused()?t=new WaitWindow:cleverapps.metha.display({focus:"WaitWindow",action:function(e){t=new WaitWindow,e()}}),cleverapps.waitNoMore(4e3,function(){t.close()})},Product.Create=function(e){e=Product.SearchProductId(e);var t=cleverapps.clone(cleverapps.config.products[e]||VirtualProducts[e],!0);return t.itemId=e,new Product(t)},Product.CURRENCY="$",Product.CURRENCY_CODE="USD";var CoinsProductTile=cc.Node.extend({ctor:function(e,t){this._super(),this.options=t||{},this.tileModel=e,this.small=!0,"bestSeller"!==e.badge&&"merge"!==cleverapps.config.type||(this.small=!1),e.refreshButton=this.refreshButton.bind(this);var n=this.createTile();this.addChild(n),this.setAnchorPoint2(),this.setContentSize2(n.width*n.scaleX,n.height*n.scaleY),n.setPositionRound(this.width/2,
this.height/2),this.options.onClicked&&cleverapps.UI.onClick(this,function(){this.options.onClicked(this.tileModel)}.bind(this),{swallowTouches:!1,ignoreOnTouchMoved:!0,useInteractiveScale:!0})},refreshButton:function(e){if(this.button){var t=this.button.getPosition();if(this.button.removeFromParent(),this.button=new TileButton(this.tileModel,this.small,{onClicked:this.options.onClicked}),this.button.setPosition(t),this.content.addChild(this.button),e){var n=this.content.scale;this.button.button.content.text.runAction(new cc.Sequence(new cc.ScaleTo(.2,1.5*n),new cc.ScaleTo(.2,n)))}}},createTile:function(){var e=this.options.styles?this.options.styles:this.small?cleverapps.styles.CoinsProductSmallTile:cleverapps.styles.CoinsProductLargeTile,t=[];this.options.noButton||(this.button=new TileButton(this.tileModel,this.small,{onClicked:this.options.onClicked}),t.push(this.button));var n=new TileRewardsBlock(this.tileModel,this.small,{noBg:this.options.rewardsBlockNoBg}),s=new TileIcon(
this.tileModel,this.small);e.order===CoinsProductTile.ORDER.REWARD_CENTER?t.push(n,s):t.push(s,n);var i=this.content=new cleverapps.Layout(t,{direction:cleverapps.UI.VERTICAL,margin:e.margin}),o=cleverapps.UI.createScale9Sprite(this.small?bundles.tile_shop.frames.shop_tile_bg_png:bundles.tile_shop.frames.feature_tile_bg_png,e.adjustBackgroundCapInsets?cleverapps.UI.Scale9Rect.TwoPixelXY:cleverapps.UI.Scale9Rect.Default);if(o.setContentSize2(e),e.stitches&&new StitchesComponent(o,e.stitches),e.innerBg){var r=new cc.Scale9Sprite(e.innerBg.image);r.setContentSize2(o.width-2*e.innerBg.padding.x,o.height-2*e.innerBg.padding.y),o.addChild(r),r.setPositionRound(e.innerBg)}return o.addChild(i),i.setPositionRound(o.width/2,o.height/2+e.offset.y),this.tileModel.badge&&(this.tileBadge=new TileBadge(this.tileModel.badge,this.small),o.addChild(this.tileBadge)),o.setScale(e.scale[cleverapps.wideMode.mode]),o},isSmall:function(){return this.small}});CoinsProductTile.ORDER={REWARD_CENTER:0,
REWARD_TOP:1},cleverapps.styles.CoinsProductSmallTile={width:240,height:350,margin:15,order:CoinsProductTile.ORDER.REWARD_CENTER,offset:{y:0},scale:[1,1,1],ok_lottery:{icon:{x:{align:"right",dx:50},y:{align:"top",dy:50}}}},cleverapps.styles.CoinsProductLargeTile={width:444,height:747,order:CoinsProductTile.ORDER.REWARD_CENTER,offset:{y:0},scale:[1,1,1],ok_lottery:{icon:{x:{align:"right",dx:50},y:{align:"top",dy:50}}}};var PackProductTile=cc.Node.extend({ctor:function(e,t){this._super(),this.options=t||{},this.tileModel=e,this.small=!1;var n=this.createTile();this.addChild(n),this.setAnchorPoint2(),this.setContentSize2(n.width*n.scaleX,n.height*n.scaleY),n.setPositionRound(this.width/2,this.height/2),this.options.onClicked&&cleverapps.UI.onClick(this,function(){this.options.onClicked(this.tileModel)}.bind(this),{swallowTouches:!1,ignoreOnTouchMoved:!0,useInteractiveScale:!0})},createTile:function(){var e=cleverapps.styles.PackProductTile,t=[];this.options.noButton||t.push(
new TileButton(this.tileModel,this.small,{onClicked:this.options.onClicked})),t.push(new TileRewardsBlock(this.tileModel,this.small)),e.title&&!this.options.noTitle&&t.push(this.createTitle()),t.push(new TileIcon(this.tileModel,this.small));var n=new cleverapps.Layout(t,{direction:cleverapps.UI.VERTICAL,margin:e.margin}),s=new cc.Scale9Sprite(e.tileBg||bundles.tile_shop.frames.shop_tile_bg_png);if(s.setContentSize2(this.options.size||e),e.stitches&&new StitchesComponent(s,e.stitches),e.innerBg){var i=new cc.Scale9Sprite(e.innerBg.image);i.setContentSize2(s.width-2*e.innerBg.padding.x,s.height-2*e.innerBg.padding.y),s.addChild(i),i.setPositionRound(e.innerBg)}return s.addChild(n),n.setPositionRound(s.width/2,s.height/2+e.offset.y),this.tileModel.badge&&(this.tileBadge=new TileBadge(this.tileModel.badge,this.small),s.addChild(this.tileBadge)),s.setScale(e.scale[cleverapps.wideMode.mode]),s},createTitle:function(){var e=cleverapps.styles.PackProductTile.title,
t=cleverapps.UI.generateOnlyText(this.tileModel.getTitle(),cleverapps.styles.FONTS.TILE_SHOP_WINDOW_PACK_TITLE||cleverapps.styles.FONTS.SMALL_WHITE_TEXT),n=new cc.Scale9Sprite(this.tileModel.product.titleBg||bundles.tile_shop.frames.red_stripe_png);return e.size&&n.setContentSize2(e.size),n.addChild(t),t.setPositionRound(n.width/2+e.x,n.height/2+e.y),t.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER),t.setVerticalAlignment(cc.VERTICAL_TEXT_ALIGNMENT_CENTER),n.setLocalZOrder(1),t.fitTo(n.width-(e.paddingX||0)),n},isSmall:function(){return!1}});cleverapps.styles.PackProductTile={offset:{y:-20},scale:[1,1.2,1.2],width:340,height:600,margin:10,title:{x:0,y:0}};var LivesProductTile=cc.Node.extend({ctor:function(e,t){this._super();var n=cleverapps.styles.LivesProductTile;this.options=t||{},this.tileModel=e,void 0!==n.isSmall?this.small=n.isSmall:this.small=!0;var s=this.createTile();this.addChild(s),this.setAnchorPoint2(),this.setContentSize2(s.width*s.scaleX,s.height*s.scaleY),
s.setPositionRound(this.width/2,this.height/2),this.options.onClicked&&cleverapps.UI.onClick(this,function(){this.options.onClicked(this.tileModel)}.bind(this),{swallowTouches:!1,ignoreOnTouchMoved:!0,useInteractiveScale:!0}),this.updateTileState()},isSmall:function(){return this.small},updateAttention:function(){this.tileModel.isAttention()&&this.tileModel.isAvailable()?this.attention||(this.attention=new cc.Sprite(bundles.windows.frames.tab_attention),this.attention.setPositionRound(cleverapps.styles.LivesProductTile.attention),this.addChild(this.attention),this.attention.runAction(new cc.RepeatForever(new cc.Sequence(new cc.ScaleTo(.3,1.1),new cc.ScaleTo(.3,1))))):this.attention&&this.attention.removeFromParent()},createTile:function(){var e=cleverapps.styles.LivesProductTile,t={onClicked:this.options.onClicked};"merge"===cleverapps.config.type&&(t.button_png=bundles.tile_shop.frames.small_shop_button,t.button_on_png=bundles.tile_shop.frames.small_shop_button_on);var n=[]
;this.button=new TileButton(this.tileModel,this.small,t),n.push(this.button),this.tileModel.getProductDescription()&&(n.push(this.createDescriptionContainer()),this.tileModel.onChangeDescription=this.createListener(this.updateTileState.bind(this))),n.push(this.createTitle());var s=this.tileModel.product.animation?{json:bundles.tile_shop.jsons.shop_lives_animations_json,delay:0}:{};this.icon=new TileIcon(this.tileModel,this.small,s,!0),n.push(this.icon);var i=new cleverapps.Layout(n,{direction:cleverapps.UI.VERTICAL,margin:e.margin}),o=cleverapps.UI.createScale9Sprite(e.tileBg||bundles.tile_shop.frames.shop_tile_bg_png,e.adjustBackgroundCapInsets?cleverapps.UI.Scale9Rect.TwoPixelXY:cleverapps.UI.Scale9Rect.Default);if(o.setContentSize2(e),e.innerBg){var r=new cc.Scale9Sprite(e.innerBg.image);r.setContentSize2(o.width-2*e.innerBg.padding.x,o.height-2*e.innerBg.padding.y),o.addChild(r),r.setPositionRound(e.innerBg)}return o.addChild(i),i.setPositionRound(o.width/2,o.height/2+e.offset.y),
o.setScale(e.scale[cleverapps.wideMode.mode]),this.tileModel.product.discount&&(this.tileBadge=new TileBadge({image:bundles.tile_shop.frames.shop_discount_png,imageOff:bundles.tile_shop.frames.shop_discount_png_off,text:"messages:Badge.discount",amount:this.tileModel.product.discount,x:e.discount.x,y:e.discount.y,margin:e.discount.margin,padding:e.discount.padding}),o.addChild(this.tileBadge)),o},createTitle:function(){var e,t=cleverapps.styles.LivesProductTile.title,n=this.title=new cc.Scale9Sprite(t.bg||bundles.tile_shop.frames.red_stripe_png);if(n.setAnchorPoint2(),n.setLocalZOrder(t.zOrder||1),t.size&&n.setContentSize2(t.size),this.tileModel.getRewardsIcon()){var s=cleverapps.UI.generateImageText(this.tileModel.getTitle(),cleverapps.styles.FONTS.SHOP_LIVES_PRODUCT_TILE_TITLE||cleverapps.styles.FONTS.SMALL_WHITE_TEXT);s.setAnchorPoint2();var i=new cc.Sprite(this.tileModel.getRewardsIcon());i.setAnchorPoint2(),e=new cleverapps.Layout([i,s],{direction:cleverapps.UI.HORIZONTAL,
margin:t.margin}),cleverapps.UI.fitToBox(e,{width:n.width-(t.paddingX||0),height:e.height}),i.y+=t.iconOffsetY}else(e=cleverapps.UI.generateOnlyText(this.tileModel.getTitle(),cleverapps.styles.FONTS.SHOP_LIVES_PRODUCT_TILE_TITLE||cleverapps.styles.FONTS.SMALL_WHITE_TEXT)).setPositionRound(n.width/2+t.x,n.height/2+t.y),e.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER),e.setVerticalAlignment(cc.VERTICAL_TEXT_ALIGNMENT_CENTER),e.fitTo(n.width-(t.paddingX||0));return e.setPositionRound(n.width/2+t.x,n.height/2+t.y),n.addChild(e),n.enable=function(){this.setSpriteFrame(cc.spriteFrameCache.getSpriteFrame(t.bg||bundles.tile_shop.frames.red_stripe_png))},n.disable=function(){this.setSpriteFrame(cc.spriteFrameCache.getSpriteFrame(t.bg_off||t.bg||bundles.tile_shop.frames.red_stripe_png))},n},getDescriptionInnerContent:function(){var e=cleverapps.styles.LivesProductTile.description,t=this.tileModel.getProductDescription();if(t){"string"==typeof t&&(t={title:t});var n=[];if(t.title){
var s=cleverapps.UI.generateOnlyText(t.title,cleverapps.styles.FONTS.SHOP_LIVES_PRODUCT_TILE_DESCRIPTION_TEXT||cleverapps.styles.FONTS.SMALL_WHITE_TEXT);n.push(s)}if(t.countdown&&t.countdown>Date.now()){var i=new cleverapps.CountDown(t.countdown-Date.now(),{onFinish:function(){this.tileModel.onChangeDescription()}.bind(this)}),o=new cleverapps.CountDownView(i,{font:cleverapps.styles.FONTS.SHOP_LIVES_PRODUCT_TILE_DESCRIPTION_TEXT||cleverapps.styles.FONTS.SMALL_WHITE_TEXT});if(bundles.tile_shop.frames.shop_timer_icon_png){var r=new cc.Sprite(bundles.tile_shop.frames.shop_timer_icon_png);o=new cleverapps.Layout([r,o],{direction:cleverapps.UI.HORIZONTAL,margin:cleverapps.styles.LivesProductTile.description.timer.margin})}n.push(o)}var a=new cleverapps.Layout(n,{direction:cleverapps.UI.TOP_TO_BOTTOM});return a.setPositionRound({align:"center"},{align:"center"}),cleverapps.UI.fitToBox(a,e),a}},createDescriptionContainer:function(){var e=cleverapps.styles.LivesProductTile.description,
t=this.descriptionContainer=new cc.Node;return t.setAnchorPoint2(),t.setContentSize2(e.width,e.height),t},updateTileState:function(){this.descriptionContainer&&(this.descriptionContainer.removeAllChildren(),this.descriptionContainer.addChild(this.getDescriptionInnerContent())),this.tileModel.isAvailable()?(this.icon.enable(),this.button.enable(),this.tileBadge&&this.tileBadge.enable(),this.title.enable()):(this.icon.disable(),this.button.disable(),this.tileBadge&&this.tileBadge.disable(),this.title.disable()),this.updateAttention()}});cleverapps.styles.LivesProductTile={width:340,height:400,margin:10,colMargin:30,scale:[1,1,1],button:{width:225,height:75},offset:{y:0},icon:{wrap:{height:150,dy:-15}},attention:{x:{align:"center",dx:115},y:{align:"bottom",dy:95}},title:{x:0,y:5,margin:5,iconOffsetY:-4},description:{width:340,height:70,timer:{margin:6}},discount:{x:{align:"right",dx:-5},y:{align:"top",dy:-58},margin:-13,padding:{left:40,right:20,top:10,bottom:25}}};var TileModel=function(
e){this.product=e,this.isVideoProduct=this.constructor===TileModel&&cleverapps.flags.nopayments,this.refreshButton=function(){}};TileModel.prototype.videoPrice=function(){return this.product.videoPrice?this.product.videoPrice:Math.ceil(10*this.product.price)},TileModel.prototype.currentVideoProgress=function(){return cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.PRODUCT_VIDEO_PROGRESS+this.product.itemId)||0},TileModel.prototype.getCurrentPrice=function(){return this.isVideoProduct?this.currentVideoProgress()+"/"+this.videoPrice():this.product.getCurrentPrice()},TileModel.prototype.getDisabledPrice=function(){return"messages:Claimed"},TileModel.prototype.isAttention=function(){return!1},TileModel.prototype.getTitle=function(){return this.product.title},TileModel.prototype.getDescription=function(){return this.product.description},TileModel.prototype.getPrice=function(){return this.product.price},TileModel.prototype.getItemId=function(){return this.product.itemId},
TileModel.prototype.getIcon=function(){return this.product.icon},TileModel.prototype.getViewClassName=function(){return this.product.ViewClassName||CoinsProductTile},TileModel.prototype.getPriceIcon=function(){return this.isVideoProduct?bundles.shared.frames.adicon_png:this.product.priceIcon},TileModel.prototype.getProductDescription=function(){},TileModel.prototype.getRewardsIcon=function(){return this.product.rewardsIcon},TileModel.prototype.getReward=function(){return this.isVideoProduct&&this.product.videoReward?this.product.videoReward:this.product.reward},TileModel.prototype.isEnabled=function(){return"unlimitedLives"!==this.product.key||!cleverapps.flags.nopayments},TileModel.prototype.checkDisabledProducts=function(){if(this.product.disableProductIds)for(var e in this.product.disableProductIds){var t=TileModel.Create(Product.Create(this.product.disableProductIds[e]));if(t.isEnabled()&&t.isAvailable())return!1}return!0},TileModel.prototype.buy=function(t,n){if(
!this.isVideoProduct)return this.product.buy(t,n);cleverapps.rewardedAdsManager.play(RewardedAdsManager.REWARDED,function(){var e=this.currentVideoProgress();e++,cleverapps.eventLogger.logEvent("video_product_watchad"),e>=this.videoPrice()&&(e=0,cleverapps.eventLogger.logEvent("video_product_buy"),this.product.onBuyed(t,n,!0)),cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.PRODUCT_VIDEO_PROGRESS+this.product.itemId,e),this.refreshButton(0<e)}.bind(this),!0)},TileModel.prototype.isAvailable=function(){return!0},TileModel.Create=function(e){var t=TileModel;return e.TileModelClass&&(t=e.TileModelClass),new t(e)};var AskLivesTileModel=function(e){TileModel.call(this,e)};AskLivesTileModel.prototype=Object.create(TileModel.prototype),(AskLivesTileModel.prototype.constructor=AskLivesTileModel).prototype.getCurrentPrice=function(){return"messages:FREE"},AskLivesTileModel.prototype.isEnabled=function(){return-1===["huzcom","plinga","pliega"].indexOf(cleverapps.User.calcSource())},
AskLivesTileModel.prototype.buy=function(n){cleverapps.social.checkConnection(function(){new SelectFriendWindow("askLives",function(e,t){cleverapps.social.sendRequest(e,"askLiveRequest",function(){e.forEach(function(e){cleverapps.friends.inApp(e)&&levels.friendRequests.sendServerRequest(e,levels.FriendRequest.TYPE_ASK_LIVE)}),t(),n()})})}.bind(this))};var RefillLivesTileModel=function(e){TileModel.call(this,e)};RefillLivesTileModel.prototype=Object.create(TileModel.prototype),(RefillLivesTileModel.prototype.constructor=RefillLivesTileModel).prototype.getReward=function(){return cleverapps.Lives.MAX_REGEN_AMOUNT},RefillLivesTileModel.prototype.getCurrentPrice=function(){return RefillLivesTileModel.PRICE},RefillLivesTileModel.prototype.buy=function(e){return!!levels.user.takeGold(RefillLivesTileModel.PRICE)&&(cleverapps.history.add("refill",1),cleverapps.eventLogger.logEvent(cleverapps.EVENTS.LIVES_BOUGHT),cleverapps.lives.give(this.getReward()),cleverapps.audio.playSound(
bundles.main.urls.shop_buy_effect),e(),!0)},RefillLivesTileModel.PRICE=100;var SoftCurrencyTileModel=function(e){cleverapps.flags.softCurrencyRealProduct&&(e=Product.Create(e.realProductId),this.realProduct=!0),TileModel.call(this,e)};SoftCurrencyTileModel.prototype=Object.create(TileModel.prototype),(SoftCurrencyTileModel.prototype.constructor=SoftCurrencyTileModel).prototype.getTitle=function(){return this.realProduct?this.product.title:Messages.getLocalized(this.product.title,{amount:this.getReward()})},SoftCurrencyTileModel.prototype.getCurrentPrice=function(){return this.realProduct?this.product.getCurrentPrice():this.getPrice()},SoftCurrencyTileModel.prototype.buy=function(e,t){if(this.realProduct)return this.product.buy(e,t);if(levels.user.takeGold(this.getPrice())){cleverapps.eventLogger.logEvent(cleverapps.EVENTS.SOFT_CURRENCY_BUY,{amount:this.getReward()}),cleverapps.eventLogger.logEvent(cleverapps.EVENTS.SOFT_CURRENCY_COST,{amount:this.getPrice()});var n=Game.currentGame
;return n.setCoins(n.coins+this.getReward()),e(),!0}return!1};var BuyEnergyTileModel=function(e){TileModel.call(this,e),this.timeout=this.product.timeout||0,cleverapps.config.debugMode&&this.timeout&&(this.timeout=cleverapps.parseInterval("5 minutes"))};BuyEnergyTileModel.prototype=Object.create(TileModel.prototype),(BuyEnergyTileModel.prototype.constructor=BuyEnergyTileModel).prototype.getTitle=function(){return Messages.getLocalized(this.product.title,{restoreAmount:this.getRestoreAmount()})},BuyEnergyTileModel.prototype.isEnabled=function(){return!this.isAvailable()||this.checkDisabledProducts()},BuyEnergyTileModel.prototype.getRestoreAmount=function(){return this.product.reward},BuyEnergyTileModel.prototype.getCurrentPrice=function(){return this.product.price},BuyEnergyTileModel.prototype.isAvailable=function(){return Date.now()>=this.getNextBuyTime()},BuyEnergyTileModel.prototype.getProductDescription=function(){return this.isAvailable()?"messages:BuyEnergyProduct.description":{
title:"messages:BuyEnergyProduct.waiting",countdown:this.getNextBuyTime()}},BuyEnergyTileModel.prototype.getNextBuyTime=function(){return this.timeout+Game.currentGame.energyProducts.getBuyTime(this.product.key)},BuyEnergyTileModel.prototype.buy=function(e){return!!this.isAvailable()&&(!!Game.currentGame.takeCoins(this.getCurrentPrice())&&(Game.currentGame.energyProducts.buyProduct(this.product.key),cleverapps.eventLogger.logEvent(cleverapps.EVENTS.LIVES_BOUGHT),cleverapps.lives.give(this.getRestoreAmount()),e(),!0))};var EnergyForVideoTileModel=function(e){TileModel.call(this,e),this.timeout=this.product.timeout||cleverapps.parseInterval("5 seconds"),this.onChangeDescription=function(){}};EnergyForVideoTileModel.prototype=Object.create(TileModel.prototype),(EnergyForVideoTileModel.prototype.constructor=EnergyForVideoTileModel).prototype.getTitle=function(){return Messages.getLocalized(this.product.title,{restoreAmount:this.getRestoreAmount()})},
EnergyForVideoTileModel.prototype.getRestoreAmount=function(){return this.product.reward},EnergyForVideoTileModel.prototype.isEnabled=function(){return!!RewardedAdsManager.IsEnabled()&&this.checkDisabledProducts()},EnergyForVideoTileModel.prototype.getPriceIcon=function(){return bundles.shared.frames.adicon_png},EnergyForVideoTileModel.prototype.getCurrentPrice=function(){return"messages:Watch"},EnergyForVideoTileModel.prototype.isAvailable=function(){return Date.now()>=this.getNextBuyTime()},EnergyForVideoTileModel.prototype.getProductDescription=function(){return this.isAvailable()?"messages:EnergyForVideoProduct.description":{title:"messages:EnergyForVideoProduct.waiting",countdown:this.getNextBuyTime()}},EnergyForVideoTileModel.prototype.getNextBuyTime=function(){return Game.currentGame.energyProducts.getBuyTime(this.product.key)+this.timeout},EnergyForVideoTileModel.prototype.buy=function(e){cleverapps.rewardedAdsManager.play(RewardedAdsManager.REWARDED,function(){
Game.currentGame.energyProducts.buyProduct(this.product.key),cleverapps.eventLogger.logEvent(cleverapps.EVENTS.LIVES_FOR_VIDEO_SHOP),cleverapps.lives.give(this.getRestoreAmount()),cleverapps.audio.playSound(bundles.main.urls.shop_buy_effect),this.product.timeout?(new LivesShopWindow,e()):this.onChangeDescription()}.bind(this),!0)};var EnergyLotteryTileModel=function(e){TileModel.call(this,e),this.lottery=Game.currentGame.energyLottery,this.onChangeDescription=function(){}};EnergyLotteryTileModel.prototype=Object.create(TileModel.prototype),(EnergyLotteryTileModel.prototype.constructor=EnergyLotteryTileModel).prototype.getTitle=function(){return Messages.getLocalized(this.product.title,{restoreAmount:EnergyLottery.maxValue()})},EnergyLotteryTileModel.prototype.isAttention=function(){return this.isAvailable()},EnergyLotteryTileModel.prototype.getCurrentPrice=function(){return"messages:Claim"},EnergyLotteryTileModel.prototype.getDisabledPrice=function(){return this.lottery.isAvailable(
)?"messages:Claimed":Messages.get("EnergyLotteryProduct.level",{level:cleverapps.humanReadableNumber(EnergyLottery.AVAILABLE.episode,EnergyLottery.AVAILABLE.level)})},EnergyLotteryTileModel.prototype.isAvailable=function(){return this.lottery.isAvailable()&&this.lottery.isReady()},EnergyLotteryTileModel.prototype.getProductDescription=function(){return this.lottery.isAvailable()&&!this.lottery.isReady()?{title:"messages:EnergyLotteryProduct.waiting",countdown:Date.now()+this.lottery.getTimeLeft()}:"messages:EnergyLotteryProduct.description"},EnergyLotteryTileModel.prototype.buy=function(){return!!this.isAvailable()&&(new EnergyLotteryWindow(this.onChangeDescription.bind(this)),!0)};var VirtualProducts={askLives:{icon:"askLives_png",title:"messages:LivesShopWindow.products.askLives",TileModelClass:AskLivesTileModel,ViewClassName:LivesProductTile},refillLives:{icon:"refillLives_5_png",title:"messages:LivesShopWindow.products.refillLives",
priceIcon:bundles.reward_icons.frames.gold_small_png,TileModelClass:RefillLivesTileModel,ViewClassName:LivesProductTile},buyEnergy350:{icon:"energy_for_coins_png",title:"messages:LivesShopWindow.products.buyEnergy",priceIcon:bundles.reward_icons.frames.shop_coin_png,rewardsIcon:bundles.reward_icons.frames.shop_energy_png,price:350,reward:90,discount:"66%",timeout:cleverapps.parseInterval("24 hour"),TileModelClass:BuyEnergyTileModel,ViewClassName:LivesProductTile},buyEnergy700:{icon:"energy_for_coins_png",title:"messages:LivesShopWindow.products.buyEnergy",priceIcon:bundles.reward_icons.frames.shop_coin_png,rewardsIcon:bundles.reward_icons.frames.shop_energy_png,price:700,reward:90,discount:"33%",disableProductIds:["buyEnergy350"],timeout:cleverapps.parseInterval("24 hour"),TileModelClass:BuyEnergyTileModel,ViewClassName:LivesProductTile},buyEnergy:{icon:"energy_for_coins_png",title:"messages:LivesShopWindow.products.buyEnergy",priceIcon:bundles.reward_icons.frames.shop_coin_png,
rewardsIcon:bundles.reward_icons.frames.shop_energy_png,price:1050,reward:90,disableProductIds:["buyEnergy350","buyEnergy700"],TileModelClass:BuyEnergyTileModel,ViewClassName:LivesProductTile},energyForVideo:{icon:"energy_for_video_png",title:"messages:LivesShopWindow.products.energyForVideo",rewardsIcon:bundles.reward_icons.frames.shop_energy_png,reward:30,timeout:cleverapps.parseInterval(cleverapps.config.debugMode?"1 minute":"1 hour"),TileModelClass:EnergyForVideoTileModel,ViewClassName:LivesProductTile},energyForVideoShort:{icon:"energy_for_video_png",title:"messages:LivesShopWindow.products.energyForVideoShort",reward:5,rewardsIcon:bundles.reward_icons.frames.shop_energy_png,disableProductIds:["energyForVideo"],TileModelClass:EnergyForVideoTileModel,ViewClassName:LivesProductTile},energyLottery:{icon:"energy_lottery_png",title:"messages:LivesShopWindow.products.energyLottery",TileModelClass:EnergyLotteryTileModel,ViewClassName:LivesProductTile},softCurrencySmall:{
icon:"soft_currency_small_png",title:"messages:LivesShopWindow.products.softCurrencySmall",priceIcon:bundles.reward_icons.frames.gold_small_png,rewardsIcon:bundles.reward_icons.frames.shop_coin_png,realProductId:"coins150",price:35,reward:150,TileModelClass:SoftCurrencyTileModel,ViewClassName:LivesProductTile},softCurrencyMedium:{icon:"soft_currency_medium_png",title:"messages:LivesShopWindow.products.softCurrencyMedium",priceIcon:bundles.reward_icons.frames.gold_small_png,rewardsIcon:bundles.reward_icons.frames.shop_coin_png,realProductId:"coins1000",price:225,reward:1e3,TileModelClass:SoftCurrencyTileModel,ViewClassName:LivesProductTile},softCurrencyLarge:{icon:"soft_currency_large_png",title:"messages:LivesShopWindow.products.softCurrencyLarge",priceIcon:bundles.reward_icons.frames.gold_small_png,rewardsIcon:bundles.reward_icons.frames.shop_coin_png,realProductId:"coins2500",price:545,reward:2500,TileModelClass:SoftCurrencyTileModel,ViewClassName:LivesProductTile}};!function(){for(
var e in VirtualProducts)VirtualProducts[e].key=e}();var Terms=cc.Node.extend({ctor:function(){this._super();var e=new cc.Node;e.addChild(cleverapps.UI.generateTTFText("messages:Terms.TermsOfService",cleverapps.styles.FONTS.TERMS_LINK_TEXT)),cleverapps.UI.wrap(e),this.addChild(e);var t=cleverapps.UI.generateTTFText(" "+Messages.get("Terms.and")+" ",cleverapps.styles.FONTS.TERMS_TEXT);this.addChild(t);var n=new cc.Node;n.addChild(cleverapps.UI.generateTTFText("messages:Terms.PrivacyPolicy",cleverapps.styles.FONTS.TERMS_LINK_TEXT)),cleverapps.UI.wrap(n),this.addChild(n),cleverapps.UI.arrangeWithMargins(this.children,{direction:cleverapps.UI.HORIZONTAL,margin:cleverapps.styles.Terms.margin}),cleverapps.UI.wrap(this),cleverapps.UI.applyHover(e),cleverapps.UI.applyHover(n),cleverapps.UI.onClick(e,function(){cc.sys.openURL(projects.default.terms)}),cleverapps.UI.onClick(n,function(){cc.sys.openURL(projects.default.privacy)})}});cleverapps.overrideColors(cleverapps.styles.COLORS,{
TERMS_LINK_COLOR:new cc.Color(97,167,221,255),TERMS_TEXT_COLOR:new cc.Color(55,80,58,255)}),cleverapps.overrideFonts(cleverapps.styles.FONTS,{TERMS_TEXT:{size:25,color:cleverapps.styles.COLORS.TERMS_TEXT_COLOR},TERMS_LINK_TEXT:{size:25,color:cleverapps.styles.COLORS.TERMS_LINK_COLOR}}),cleverapps.styles.Terms={margin:6};var Restore=cc.Node.extend({ctor:function(){this._super();var e=cleverapps.UI.generateTTFText("messages:RestorePurchases",cleverapps.styles.FONTS.TERMS_LINK_TEXT);this.addChild(e),cleverapps.UI.wrap(this),cleverapps.UI.applyHover(this),cleverapps.UI.onClick(this,function(){cleverapps.payments.restore();var e=new WaitWindow;this.stopWait=cleverapps.waitNoMore(5e3,cleverapps.once(function(){e.close(),this.recreateWindow(),delete this.stopWait}.bind(this))),cleverapps.subscription.onChangeStateListeners.restore=this.createListener(this.onChangeSubscription.bind(this))}.bind(this))},recreateWindow:function(){var e=cleverapps.windows.currentWindow();new SubscriptionWindow,
e instanceof SubscriptionWindow&&e.close()},onChangeSubscription:function(){cleverapps.subscription.isActive()&&(this.stopWait?this.stopWait():this.recreateWindow())}}),BonusButton=cleverapps.UI.Button.extend({ctor:function(e){var t=cleverapps.styles.BonusButton;this.onClick=e.onClick;var n,s=new cc.Node;s.setContentSize(t.width,t.height),s.setAnchorPoint(.5,.5),this.withBonus=e.reward||e.price,e.text?(n=cleverapps.UI.generateOnlyText(e.text,cleverapps.styles.FONTS.BONUS_BUTTON_TEXT||cleverapps.styles.FONTS.BUTTON_TEXT)).fitTo(.8*s.width):n=e.content;var i=[n];if(this.withBonus){var o,r=[cleverapps.UI.generateOnlyText(e.reward?"+"+e.reward:e.price,cleverapps.styles.FONTS.SHARE_BUTTON_REWARD_TEXT)];!1!==e.rewardIcon&&((o=new cc.Sprite(e.rewardIcon?e.rewardIcon:bundles.menubar.frames.coin_png)).setScale(t.RewardCoins.scale),this.coin=o,r.push(o)),i.push(new cleverapps.Layout(r,{direction:cleverapps.UI.HORIZONTAL,margin:t.RewardCoins.margin})),o&&(o.y+=t.RewardCoins.offsetY)}
var a=new cleverapps.Layout(i.reverse(),{direction:cleverapps.UI.VERTICAL,margin:t.margin});a.setPositionRound(s.width/2+t.content.offset.x,s.height/2+t.content.offset.y),s.addChild(a),this._super({content:s,width:s.width,height:s.height,fitTo:!1,onClicked:this.doAction.bind(this)})},doAction:function(){this.onClick()},animateCollectCoin:function(e){if(this.withBonus){cleverapps.audio.playSound(bundles.main.urls.shop_buy_effect);var t=function(){e&&e()};cleverapps.styles.MenuBar.GoldItem.target&&this.coin?WindowHelper.animateCollect(this.coin,{scale:1,target:cleverapps.styles.MenuBar.GoldItem.target},t):t()}else e&&e()}});cleverapps.styles.BonusButton={width:300,height:110,RewardCoins:{scale:.5,margin:10,offsetY:0},margin:-10,content:{offset:{x:0,y:0}}};var CoinsPriceView=cc.Node.extend({ctor:function(e,t){this._super(),this.options=t||{},this.styles=this.options.styles||cleverapps.styles.CoinsPriceView,this.price=e,this.setAnchorPoint2(),this.createContent(),this.createBg(),
this.setCascadeOpacityEnabled(!0)},createContent:function(){this.content&&(this.content.removeFromParent(!0),delete this.content);var e=this.styles.icon&&this.styles.icon.image,t=new cc.Sprite(e||bundles.menubar.frames.coin_png);t.setScale(this.styles.icon.scale),e&&this.styles.icon.offsetY&&(t.y+=this.styles.icon.offsetY);var n=this.options.font||cleverapps.styles.FONTS.COINS_PRICE_TEXT||cleverapps.styles.FONTS.TEXT,s=this.label=cleverapps.UI.generateImageText(this.price,n),i=this.styles.isLabelFirst?[s,t]:[t,s];this.content=new cleverapps.Layout(i,{margin:this.styles.margin,direction:cleverapps.UI.HORIZONTAL}),this.label.y+=this.styles.label.offsetY,this.addChild(this.content),this.setContentSize2(this.content.getContentSize()),this.content.setPositionRound(this.width/2,this.height/2),this.content.setCascadeOpacityEnabled(!0)},createBg:function(){this.styles.bg&&(this.bg&&(this.bg.removeFromParent(),delete this.bg),this.bg=new cc.Scale9Sprite(this.options.bg||this.styles.bg.image),
this.addChild(this.bg),this.bg.setLocalZOrder(-1),this.bg.setContentSize2(this.width+2*this.styles.bg.padding.x,this.height+2*this.styles.bg.padding.y),this.bg.setPositionRound(this.width/2+this.styles.bg.dx,this.height/2+this.styles.bg.dy))},setPrice:function(e){this.price!==e&&(this.label.setString(e),this.price=e,this.createContent(),this.createBg())}});cleverapps.styles.CoinsPriceView={icon:{scale:.7},label:{offsetY:0},bg:{image:bundles.game.frames.ruby_substrate_png,padding:{x:2,y:-3},dx:4,dy:0},margin:0};var CoinsRewardView=cc.Node.extend({ctor:function(e){this._super(),this.setAnchorPoint2(),this.options=cleverapps.extend({},cleverapps.styles.CoinsRewardView,e)},collectCoins:function(e){var t=[];if((this.options.coins||cleverapps.styles.CoinsRewardView.coins).forEach(function(e){t=t.concat(this.drawCoinsInCircle(e))}.bind(this)),e){var n=cleverapps.UI.generateTTFText("+"+e,cleverapps.styles.FONTS.COINS_REWARD_TEXT);n.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER),
n.setPositionRound(this.width/2,this.height/2),n.setScale(this.options.text.scale/2),n.setLocalZOrder(1000001),this.addChild(n),n.replaceParentSamePlace(cc.director.getRunningScene().scene),n.opacity=0,n.runAction(new cc.Sequence(new cc.FadeIn(.2),new cc.ScaleTo(this.options.showTextTime||CoinsRewardView.SHOW_TEXT_TIME,this.options.text.scale),new cc.FadeOut(.2),new cc.RemoveSelf))}var s=cc.director.getRunningScene().scene,i=this.options.target||cleverapps.styles.UI.RewardElementView.rewardGoldViewTarget||cleverapps.styles.MenuBar.GoldItem.target,o=s.convertToNodeSpace(i.getParent().convertToWorldSpace(i.getPosition()));if(t.sort(function(e,t){return e.getPositionX()-t.getPositionX()}).forEach(function(e,t){e.replaceParentSamePlace(s),e.runAction(new cc.Sequence(new cc.DelayTime(CoinsRewardView.APPEAR_TIME+.01*t),new cc.Spawn(new cc.MoveTo(CoinsRewardView.COLLECT_COIN_TIME,o),new cc.RotateBy(CoinsRewardView.COLLECT_COIN_TIME,180)),new cc.RemoveSelf))}.bind(this)),
this.options.sparkAnimation){var r=new cleverapps.Spine(bundles.game.jsons.coins_reward_json);r.setAnimation(0,"animation",!1),r.setPositionRound(this.width/2,this.height/2),this.addChild(r)}this.runAction(new cc.Sequence(new cc.DelayTime(2),new cc.RemoveSelf))},drawCoinsInCircle:function(e){for(var t=[],n=0;n<e.count;n++){var s=new cc.Sprite(bundles.menubar.frames.coin_png);s.setRotation(120*(Math.random()-.5)),s.setScale(0),s.setLocalZOrder(1e6);var i=2*Math.PI*n/e.count,o=(e.baseAngle||0)*Math.PI/180,r=e.radiusX*Math.cos(i+o),a=e.radiusY*Math.sin(i+o);this.options.randomOffset&&(r+=.5*(Math.random()-.5)*r,a+=.5*(Math.random()-.5)*a),s.setPosition(this.width/2+r,this.height/2+a),s.runAction(new cc.Spawn(new cc.MoveBy(CoinsRewardView.APPEAR_TIME,new cc.p(.2*r,.2*a)),new cc.ScaleTo(CoinsRewardView.APPEAR_TIME,e.scale))),this.addChild(s),t.push(s)}return t}});cleverapps.overrideStyles(cleverapps.styles.DECORATORS,{COINS_TEXT_STROKE:{size:3,
color:cleverapps.styles.COLORS.COINS_REWARD_STROKE_COLOR}}),cleverapps.overrideFonts(cleverapps.styles.FONTS,{COINS_REWARD_TEXT:{size:120,color:cleverapps.styles.COLORS.COINS_REWARD_YELLOW,stroke:cleverapps.styles.DECORATORS.COINS_TEXT_STROKE}}),CoinsRewardView.APPEAR_TIME=.4,CoinsRewardView.SHOW_TEXT_TIME=1.2,CoinsRewardView.COLLECT_COIN_TIME=.5,cleverapps.styles.CoinsRewardView={sparkAnimation:!0,randomOffset:!0,text:{scale:1},coins:[{radiusX:80,radiusY:80,count:6,scale:1}]};var ReloadWindow=Window.extend({onWindowLoaded:function(e){var t=cleverapps.styles.ReloadWindow,n=new cc.Node,s=function(e){e.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER),e.setDimensions(cc.sizeRound(t.width,0)),n.addChild(e)};s(cleverapps.UI.generateTTFText("messages:ReloadWindow.YouHaveSavedGame",cleverapps.styles.FONTS.WINDOW_TEXT)),s(cleverapps.UI.generateTTFText("messages:ReloadWindow.WeStoreGames",cleverapps.styles.FONTS.WINDOW_TEXT,{gameTitle:Messages.get(cleverapps.config.title)})),
cleverapps.UI.arrangeWithMargins(n.children,{direction:cleverapps.UI.VERTICAL,margin:t.margin,y:t.paddingY}),cleverapps.UI.wrap(n),n.setAnchorPoint2(),n=cleverapps.UI.wrapWithPadding(n,t.padding),this.content=n,this._super({content:n,title:"messages:ReloadWindow.Title",name:"reloadwindow",button:{width:t.Button.width,height:t.Button.height,text:Messages.get("ReloadWindow.UpdateNow")},onClose:e,closeButton:!1,notCloseByTouchInShadow:!0}),cleverapps.audio.playSound(bundles.main.urls.window_effect),cleverapps.windows.list=[this]}});cleverapps.styles.ReloadWindow={width:600,margin:20,paddingY:10,padding:{x:0,y:10},Button:{}},"horizontal"===cleverapps.config.orientation&&cleverapps.increaseStylesByKoef(cleverapps.styles.ReloadWindow,1.5);var LocalStorageDisabledWindow=Window.extend({onWindowLoaded:function(){var t=cleverapps.styles.LocalStorageDisabledWindow,n=new cc.Node,e=function(e){e.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER),e.setDimensions(cc.sizeRound(t.width,0)),n.addChild(e)}
;e(cleverapps.UI.generateTTFText("messages:LocalStorageDisabledWindow.text2",cleverapps.styles.FONTS.WINDOW_TEXT)),e(cleverapps.UI.generateTTFText("messages:LocalStorageDisabledWindow.text1",cleverapps.styles.FONTS.WINDOW_TEXT)),cleverapps.UI.arrangeWithMargins(n.children,{direction:cleverapps.UI.VERTICAL,margin:t.margin,y:t.paddingY}),cleverapps.UI.wrap(n),n.setAnchorPoint2(),n=cleverapps.UI.wrapWithPadding(n,t.padding),this.content=n,this._super({content:n,title:"messages:LocalStorageDisabledWindow.title",name:"localstoragedisabledwindow",button:{text:Messages.get("OK"),width:t.button.width},closeButton:!1}),cleverapps.audio.playSound(bundles.main.urls.window_effect)}});cleverapps.styles.LocalStorageDisabledWindow={width:600,margin:20,paddingY:20,padding:{x:0,y:35},button:{width:200}};var ErrorWindow=Window.extend({onWindowLoaded:function(e){var t=cleverapps.UI.generateTTFText(e,cleverapps.styles.FONTS.WINDOW_TEXT);t.setDimensions(cleverapps.styles.ErrorWindow.dimensions),
t.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER),this._super({content:t,title:{text:Messages.get("RestartWindow.Title"),localized:!0},name:"errorwindow",button:{text:Messages.get("OK")}}),cleverapps.audio.playSound(bundles.main.urls.window_effect)}});cleverapps.styles.ErrorWindow={dimensions:{width:500,height:0}};var RestartWindow=Window.extend({ctor:function(e){if(!RestartWindow.showed&&!cleverapps.environment.isSceneWithPreview()&&cc.director.getRunningScene()){RestartWindow.showed=!0,this.options=e=e||{},cleverapps.versionChecker.isNewClientVersionAvailable()&&(e.title=e.title||"RestartWindow.NewVersionTitle",e.contentMessage=e.contentMessage||"RestartWindow.NewVersionAvailable");var t=e&&e.contentMessage?Messages.get(e.contentMessage):Messages.get("RestartWindow.AnErrorOccured")||"An error occurred";this.text=cleverapps.UI.generateTTFText(t,cleverapps.styles.FONTS.WINDOW_TEXT,!1),this.text.setDimensions(cleverapps.styles.RestartWindow.width,cleverapps.styles.RestartWindow.height)
,this.text.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER),this.text.setVerticalAlignment(cc.VERTICAL_TEXT_ALIGNMENT_CENTER),this._super({parentScene:!0}),this.setLocalZOrder(1001)}},onWindowLoaded:function(){var e=this.options&&this.options.title?Messages.get(this.options.title):Messages.get("RestartWindow.Title")||"Try again";this._super({content:this.text,notCloseByTouchInShadow:!0,name:"RestartWindow",title:e,button:{text:Messages.get("RestartWindow.ButtonMessage")||"Reload",width:cleverapps.styles.RestartWindow.button.width,height:cleverapps.styles.RestartWindow.button.height,onPressed:function(){window.location.reload()}},closeButton:!1}),this.window&&0===this.window.height&&(this.text.removeFromParent(),this.window.titleText.removeFromParent()),cleverapps.settings&&cleverapps.audio.playSound(bundles.main.urls.window_effect)}});cleverapps.styles.RestartWindow={width:570,height:460,button:{}},"horizontal"===cleverapps.config.orientation&&cleverapps.increaseStylesByKoef(
cleverapps.styles.RestartWindow,1.4),
cc._loadingImage="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAu4AAAU2CAMAAAD9CcM0AAADAFBMVEUCAgEDAwIEBAMFBQQGBgUHBwYICAcJCQgKCgkLCwoMDAsNDQwODg0PDw4QEA8RERASEhETExIUFBMVFRQWFhUXFxYYGBcZGRgaGhkbGxocHBsdHRweHh0fHx4gIB8hISAiIiEjIyIkJCMlJSQmJiUnJyYoKCcpKSgqKikrKyosLCstLSwuLi0vLy4wMC8xMTAyMjEzMzI0NDM1NTQ2NjU3NzY4ODc5OTg6Ojk7Ozo8PDs9PTw+Pj0/Pz5AQD9BQUBBQUFCQkJDQ0NERERFRUVGRkZHR0dISEhJSUlKSkpLS0tMTExNTU1OTk5PT09QUFBRUVFSUlJTU1NUVFRVVVVWVlZXV1dYWFhZWVlaWlpbW1tcXFxdXV1eXl5fX19gYGBhYWFiYmJjY2NkZGRlZWVmZmZnZ2doaGhpaWlqampra2tsbGxtbW1ubm5vb29wcHBxcXFycnJzc3N0dHR1dXV2dnZ3d3d4eHh5eXl6enp7e3t8fHx9fX1+fn5/f3+AgICBgYCCgoGDg4KEhIOFhYSGhoWHh4aIiIeJiYiKiomLi4qMjIuNjYyOjo2Pj46QkI+RkZCSkpGTk5KUlJOVlZSWlpWXl5aYmJeZmZiampmbm5qcnJudnZyenp2fn56goJ+hoaCioqGjo6KkpKOlpaSmpqWnp6aoqKepqaiqqqmrq6qsrKutrayurq2vr66wsK+xsbCysrGzs7K0tLO1tbS2trW3t7a4uLe5ubi6urm7u7q8vLu9vby+vr2/v77AwL/AwMDBwcHCwsLDw8PExMTFxcXGxsbHx8fIyMjJycnKysrLy8vMzMzNzc3Ozs7Pz8/Q0NDR0dHS0tLT09PU1NTV1dXW1tbX19fY2NjZ2dna2trb29vc3Nzd3d3e3t7f39/g4ODh4eHi4uLj4+Pk5OTl5eXm5ubn5+fo6Ojp6enq6urr6+vs7Ozt7e3u7u7v7+/w8PDx8fHy8vLz8/P09PT19fX29vb39/f4+Pj5+fn6+vr7+/v8/Pz9/f3+/v7///+xGNHLAABQFUlEQVR4AezSP2vVBxQA0JumCaUpdGpLW1oaCk3JkCUdSraEfoGGDoV2bad2URwE0clVlIc4OIkuDlE3CWRwcVHQVU0IakRDJGAkSv7EdzW+32/U3fvO+QwnEvpGJOgOuoPuoDvoDrqD7qA76A66g+7oDrqD7qA76A66g+6gO+gOuoPu6A66g+6gO+gOuoPuoDvoDrqD7ugOuoPuoDvoDrqD7qA76A66g+7oDrqD7qA76A66g+6gO+gOuoPuoDu6g+6gO+gOuoPuoDvoDrqD7qA7uoPuoDvoDrqD7qA76A66g+6gO7qD7qA76A66g+6gO+gOuoPuoDu6g+6gO+gOuoPuoDvoDrqD7qA7uoPuoDvoDrqD7qA76A66g+6gO+iO7qA76A66g+6gO+gOuoPuoDvoju6gO+gOuoPuoDvoDrqD7qA76I7uoDvoDrqD7qA76A66g+6gO+iO7qA76A66g+6gO+gOuoPuoDvo/g7oDrqD7qA76A66g+6gO+gOuoPu6A66g+6gO+gOuoPuoDvoDrqD7ugOuoPuoDvoDrqD7qA76A66g+7oDrqD7qA76A66g+6gO+gOuoPu6A66g+6gO+gOuoPuoDvoDrqD7qA7uoPuoDvoDrqD7qA76A66g+6gO7qD7qA76A66g+6gO+gOuoPuoDu6g+6gO+gOuoPuoDvoDrqD7qA7uoPuoDvoDrqD7qA76A66g+6gO7qD7qA76A66g+6gO+gOuoPuoDvoju6gO+gOuoPuoDvoDrqD7qA76I7uoDvoDrqD7qA76A66g+6gO+iO7qA76A66g+6gO+gOuoPuoDvoju6gO+gOuoPuoDvoDrqD7qA76A66ozvoDrqD7qA76A66g+6gO+gOuqM76A66g+6gO+gOuoPuoDvoDrqjO+gOuoPuoDvoDrqD7qA76A66ozvoDrqD7qA76A66g+6gO+gOuqM76A66g+6gO+gOuoPuoDvoDrqD7ugOuoPuoDvoDrqD7qA76A66g+7oDrqD7qA76M7La2cvLmU/0J2l2c8ixs7sZnm683Qm9n1yLsvTnU70TK5mcbqzNRs9g/NZnO7cH4/GqSxOd258EY0DWZzuzH8ajT93szbdufxxNKY3sjbdmRuMxsRa1qY7V4ai8cNK1qY78yPR+Ope1qY717+Mxuc3szbduTMWjaG5rE131qaidTxr052d36P1dzdr053/ozW1nrXpzolofXsra9OdqyPR+Oh81qY7y6PROpi16c7Wb9GaeZ616c6xaH29mLXpzsJQNAYXsjbdefZrtDpZnO50ovVvN2vTnccT0Zh5kcXpzumB6BlfzeJ0Z/2X6Bl9kNXpzqXheOv75axOd7pHBnrdH2Z5urP5X+z7cTXr053Nw8MR8fN69gHd2bvwU8TkRvYF3Vk89N0/29kndOfJo1dZn+6gO+gOuoPu7HSzP+jO7aN//HVyJevTne3ON/HG9N1E9/fY28sP32v27sM9qmp9+/i9p6QHEgLSe0ERsABKQbEoFrEAHjlKEdCDRbGIooiooFgURfmJBVCxewRROYigIiAIIohKAQHphBJIQnrJZO73nZk9mT2TMnt6Qp7PlT/he032XnutZ+U9YoDdWAsrIST34ytnPvnU7LUnWbNZphjh0PckheResZ9ubRdrMMS1/c9K1mjz46G6PJdCcq9Iydx2UDX/v2LWXHvPgcrwIiskJPdvWqJM9JQi1lgT4XTpMVZESO67r4RG9IusqTY1hKrDH6yQkNzn1oNWnW9YQz0JVZ15rJCQ3IvvNsBNx02skbLPg2psKYXkXqGM6+BhYD5rok2N4ND1IIXkXrHjV8GDYTprouWJsDN+QiG5VyJvGDylrGEN9Etd2I3Mp5DcKzM1Cp7O2sGa58TZsLlmN4XkXqlV7VDOJYdZ88xpAESPPEghuVcu/3EjyhmWyxrHsvThh/+XSyG5V2XfNShHebyEQnI/Ff3TH+UYX6OQ3E9J+283wVPihwyTkiILheQePvmftIOn0xYwlApTN//24+fTn5n85INjbh1117inZ3yydMPujPyiUgrJPcR2jUmAh+Y/MiSKj/+xYPrd1/VtFacYDdBSohud0feG2x/7vwUbj5QwRAQoCub1gIcz1jPo9i+bMaxPi2gFVTI16T1m5o97Chkikrs48mg83J2zkcGUs2X2bd3rKNAp7szb399ZzNCQ3MXS8+GuxyYGy4mfJl91mhE+ajr0g51WhoLkLo6OVeCmzzYGQ/HqFy9vAL8Yu47/IYehILmLD1rAzUV7GLADn9zYGAFIHvJRBkNAchcbLoKbKw8yILkr7j3dgAAZL5qVThH83MXR+4zQunof/Zf5xY3JCAbjBW+doAh67qJkdlNoXbybfkr76MoYBIv5oo9OUgQ9d/FzX2j13UJ/ZH92SVWxR6c0PuPSm0ffef+kl2dMe/bR+0YOuujsVilxRlQqcfDKUopg5y5S7zRD45y19FnevCuiKy29Yc8xz7y7+p+0zHyWsRYXZB3c/PPX70wec1mbeFSo/oQDFMHOXRTOag6Ndsvom+LlN8WiQjGtB0784s+jxayCZd+iyTd0qYMKdPmwmCLYuYu1l0Cj1Y/0xbax9VGR2PPv/3BHHvUo2j//rjOjUE7s7X9SBDt3cWxcLFzO2UHdMmedgQok9Zq08hB9kTZ/cFOU0/GdXIog5y5KPmoPl+et1GnZNRX9KPd4cuUJ+qx43aNd4Cl+2HaKYOcudvxbgdNN2dRl5yN1UU6z2z87Sj/9/dw58HTuVxTBzl3kT2sA1agc6nDy7a4op8vjv5cwAP9M6wwPSc/lUQQ7d7HkfNhFzbHSu403xcCDqceMfQzUjgeT4M74n0MUwc5dHJ+YAsBwxzF6lftme3gw9HrnKINh9b/NcHfFVoqg5y5WPzx4xHsn6NXOW2PhofurBxkkJ2d0grtzv6cIfu6i0ELvFp4DD82n7GMQbR1hhptWX1BEIneR+lgy3CXdtoHBVfhma7g57Z1ihp3kLn68EO6UixYXMejW9oGbxOmlDC/JXeS/0gTuOrySzlA4dKcZWgmvh7d3yV3sGW2Gm8Q7tjBEil9Nhlbi6xaGj+QuVveFuz7/LWbIWD9oBa06cxgukrso/bg13CSHek/6D2dCq8GnDA/JXWQ/kwQ33b4uZYj9fDa0Wv7IcJDcxb7hcBNz2y6G3m/dodV9C4XkHnrr+sBNu9n5DIdN3aB11WEKyT3U5rWCm+v/ZJis7wqt/+RQSO4hVfB8ErTqTT3JsPm5HTQM06wUknsIZT4UDa1u34Y1uW8bQaPREgrJPXRO3K5A6+a/GV6zE6Fx4SEKyT1UDtwErTqTTzLMip8yQeOxYgrJPTQ2XwmtFh+WMuwyboZG8jcUkntI/NoDWt1XMBJ2dofGhWkUknsILOsErRu2MzIWpcDFMKWUQnIPum/bQCPq4QxGiHUyNJpvoJDcg21+M2ikzLQwYjKvhMbwHArJPbg+agiNlvMYSUtPg0v8JxSSe1B91AAanb9nZE2ExkVpFJJ7EH1yGjR6rmeE7e8GF+MbVgrJPWg+awKNy7Yz4mYb4dIjlUJyD5a59aHxrwOMvPSL4WJ8m0JyD5J3k6Ex/Birg89i4XLRcQrJPSjm1IXGmAxWCycHwCX6YwrJPRg+S4GL8f4sVhPz4uEyMJ9Ccg/c/MZwMT2Uw+oi60q4NFhJIbkHbElLbe1PFLL6mBsDl3ElFJJ7gH7tBJfoCQWsRo5dAJdOf1NI7oHZ0hMuhnF5rFamG1DGNINCcg/I333hYhyXw+plZyu4XJVJIbkHYM+lcDE+nMtqpnAUXFJ+ppDc/XfsWmg8UMhq53MjXJ6hkNz9ljECGqOzWP3s7gqXq3IoJHc/5d0PjZtOsBoqHQOX5usoJHc/vRQFl8GprJa+iEMZwwwKyd0/81Pg0v8Aq6ddXeEyMJtCcvfH8pZw6b2V1VTJCLh03EIhufthVze4nPs7q63XDSgTP5++k9xF9o1wab+G1dfqRLhMttJXkrsoegguDZewGkvtDpfrcukryV28EYsyiXNZnRXcCpf2/9BHkrtY2QxlTC9YWa09A5fk7+gbyV3sPB9llAeKWb19k4wyynT6RHIXhXfAZcARVnPb2sLlwRL6QnIXHyWizLl/sbo73g8u12bSB5K72NIBZZotY7VXPBIuZxygkNz1KxiKMjEzWQOMh0vjPygkd/1mm1Hm3kLWANMVlKm7lEJy1217e5S5+DhrgvnxKGOaSyG561U8FmWar2GNsCIZLtMoam/uWWu+/Pyr5ZuPFFCfhQlwiprOmuH3JnB5uJRVKDyeeqxIcj9VLb+mHqDUaXbuZTcOGz3mnvvGPfrEKx+t2ptVwoplXIMyg7JZM2w7Ey7DClmJg/974Y4repzV/cq7pq/KldxPQUtboTxDfINW3YdM/XZHAct5LxZOLdawhjjY2/t51YwVd7Uywyn+wjfTJPdTTUZ/VKHJNZMXH6WbtPPhZJ7GmiLrMrj0O8ryNj7bHe6ilkjup5oN9VG12LPHL8+hy/+Z4XRxOmuKoqvg0n0vPVjX3NoQngYeltxPNavqwquLd7FMahc4xS1kjVFyPVxO30U3Jd/fEINyrjn1apfc93aCN5ctL2GZN41wuq+YNUbhELi0cs9966gElDcolZL7Kcc6FVVr/WI6XU5cDKcWm1lz5A2DS7Nt1FjQGuVFP5xJyf0UlP1EfVQq+YrXD1Dry7pQKZNKWXPk3gqXJr/TZW4dlNf1Cysl91OS5YdHLm+ZoMCTqf4lz67IoZviUXDqtJU1SOFouDRayTK/1Ec5zZ7cQ0rup6zCI5u//b9xQ6+7vF+f3j179ep1Qf+hT3y0/lAhPW3rBJUygTVJ6Ri4NPiOTiVD4anNhF2k5C7I2VFQtV3PGuUOuCQtotOe9nATffEru2knuYuRcBpezBrldrjELabTlmbQaPvQz9l0kNzF3s5QJSxgzTIcLjHf0ymtD5zqXDvnOAWoEgtjoep+gjVK6WC4xC2jk3WmEXbN711upZDcNabA6QHWLLnXwiVhGctkP9vcqCRdPOsg3UjuonQ4VIlfsmZJvwIuSUvpUrj+g/fX5NKD5C7SL4HqzF2sWY5cDJf6Sygkd282tYfqhmLWLPt6wqXh9xSSuzf/S4bqIdYwO7rCpclyCsndm5lmqKazhvmrLeDLISzJXUyESvkva5i1DeHSbhOF5K77y2T8SoZE4a51f6QzFJYmwuWMPRSSuxeFA6Fqso0Byd/09SdLd+TQ3YmvR56e0nDAKobA5zFwOS+NQnL3Iv1yqE7fxwBkfXpDq4To+Bb9J6/KYpld0/pGwabt9wy+t81wuTSDQnL3IrUPVN2P0H8bB8dClXLhhE9/3JqRl73j67HtAaBhlwZA28V0Z2XAXlDgcn02heTuxT/nQHVJBv2V9mJTIO6ysY/de20LADAktuh8zlktogGYuj+zNXtpW6DFrAw6pc2fOGb4yCdXMyCWR6ExooBCcvdi65lQDcihn5ZdAuCCeVkkCze+dk19lEm84aNDJPlVU8B8+VsbDxaQ2X+92jceNvXv3ccAFP4HGmMtFJK7FxvbQXVzMf1yYsppQKOpR6jK2/zp2CvPP/uss7pd9uSqHDp8dwYAQ8Nzrx16y0VNUKbT11b6LWcgNJ6gkNy92dACqv/QL8v6A8Yb11DLWlxYUFBQWEKXP0YlwaXeoAcGRQNA7CMZ9Fd6P7gor1BI7t5sOC2gPQRHJyYDbWbm0av8pQ92STQBQFSbB1bks3h2fdgM3kc/7e8MF9MHFJK7N5tSoJpEn2V/2BtIvH0L9Tmxad7LT0+a9u0h2n3TADbnr6d/1jeGS8J3FJK7N9vqQfUCfXVylBHGy78ppp8+T4FNp5/ol2/j4dJoDYXk7s3mZKim0lfrEoBJGfTfG2bYNPuG/nhbgUvHzRSSuzcb60P1qJU++i0JeJkBsEyAXdN5VvpuAjR67qOQ3L35oy1UtxXSRxtPAy7MZABy74Ddad/SZ6W3QOPqNArJ3Zt9PaC6voA+2nMWYP6CgcgYDruWvvee0Rcao/MoJHdvci+Aqn8ufZQzCMDAwsB6HwK7tpvoo7/bQmOChUJy96o/VH2O0Ff3A2iwmgFJvQ52Vx2nb36qC403KCR3726Gqs02+uptE4DHShmQg1fA7nn6Zq4CF/PXFJK7D+sb8b/QV7/UBdD5EAOz9TzYdD1In0yFRoPfKCR372ZCZfoffXWgIwDDFwzQr45dwwvoi6I7odHpAIXk7t38aDgYnqOv8gcCwFALA/RhPAC8WHSghLplXguNS3MoJHfv1reCagR99igAtN3OAFmeB4DJX/W5der3+dRnX3dojLBSSO7eHQvkONOn8QCMsxiovFsBvDwAwEV7qc+GptCYSB0kd1E4CKomf9JXG5sDwJASBiq1H+pNSwEwNIv6zIuGi+FN6iG5iyegMiykr470A4B22xiw39oPeQoAnqROk6CR+D/qIbmLj01QPUpfWcYCgHEOA7d26aUAzHOpT9710GjxB/WQ3MX6RlD1L6KvZpgA4LYCBm7daQAaLKM+f58OjfMOUw/JXaT3DOC76up6ANB2DwM33QzgrB3U55s4aNxSQD0kd1E6Dio/djemtgeA6C8ZsLzBAHBjOvV5HlrPUh/JXXyiQPUYfZX/L9jcz4DtbAMAEwupS84t0Ij5kvpI7mJLB6j6ZdFXk2HTJ42B+i4GgHmOlbps7wKNlhupj+Quiq4uy2YDffVZPAAk/8xAvQgAsd9Rn2/qQOPio9RJchdToFLm0Feb2wGA4QUGqOBaADhtsz+r7riniDpJ7uLHOKhuyaePMi+FzcBAg9vWGAA6H6UumVdA6y3qJbmLfV2garKTPrKOh027rQzMwigA6F9AXX5tBo3ktdRLchfWW+E0i776wASbLxmYVxRf5lTOMECj1wnqJrmLuWaobi6gjzY2gc1DVgaiYLQvk8wKhkNrjIW6Se5iRxuoWu+gj052g02vkwzE/u4AEPcFddnSBRrmt6mf5C5KxkBleos+stwBm8a/MhAr6gJAqw3U5b0YyHhIyd1v/42D6vo8+uhN2CizGYh3YNPzCPUouR1afY/QB5K7ONEVqobr6aOlSbC5zcIAjIfNoCLqsaMLtMaV0BeSu3gATlPpo4M9YHPuMfovfzBs7qYuH0ZDwziPQnL3ycJYqLodp28sQwBdO9W9/15PoR5FI6HVejeF5O6To92giplPH70Ku1fov68TAMA4m3ps6QStmy0UkrtvJrnyKaJvfkiAza0F9NtLsEn4hnq8HwUN05sUkruPfk2CKmUdfbO3C2zapNJvd8LmtLXUoWg0tBr/TiG5+yj/RjhNoG8Kr4dNwgr6q2AAbNrupA7bukKrfwb9J7nL0nvX/X4d8VBeor+Od4dN7zTq8HEMNJSnrRSSu6/SesHp/3wsaLEjwOFF9NPWprAZUeT7N6Y631NI7r57Ef7e47GtHWy67A5sYcbwPHXY2Qla5xyikNx9t6MdVHW+pU8KBsEm+Xv6aYoCAAlfUod3jdC6x0IhufvOOgZONxbSJ+PtuRqepX/yh8Cm2W/0Lv8maJnmUUju/vjeDFXdNfTJguiAhhsdOV//w9DaRtDquJdCcvdHzpVwustKX2xvCJtOe+iXra1hc1EavbI+Cze3Wigkd7+8FQ1V4zX0RfqlsDGvoF9W1oPNjbn06tDF0Ip7n0Jy909qNz/fAK13we41+mWeGTZ3ltCrbxKh1XE7heTupzdMUDX/g754Kwo2N1sDuQ3tSXpluRtu7iygkNz9tK8rnO4vpQ/WNIRNj4P0x0TYvenrmGuY51FI7n57Hk6NfqcPDnaHTd2f6If8EbCJ+opevQ03XQ9RSO5+S+0Epwet1K/4P7AxzKAf9veDTf1V9Obk1XDzOIXkHoApcGqxlT6YZoDNsBL67te2sGm/jd78lACtuj9TSO4B2NIKTg9Yqd/KurC5II2+m58Imz6H6UXRQ3BzeRaF5B6A0glwavoX9UttAZvGv9F36gS8wV7j3dQRWoYXrRSSeyB2tILTQ9Qv71rYzaPvHobduGJ6Md0ErUbrKCT3wDyuQNVkA3WzToTd0/RZ6c2wMb9FL473g5sbMykk98BsaQune4qp22wzbK610FdZjooTv6MX8+Lg5h0rheQeoKkKVI1/oW7rWsDmrAP01f7OsGm6iVUrugZu2uygkNwDtbcznO62UK9jPWCTuJS++qs1bLoeZNW+i4ObsRYKyT1gz8Ip+RfqVTgKdu/QV8sbwuaiE6xS3hC4SVpGIbkHbl87OA0tpl7TYHdHMX20oA5sBueySssbw8312QwCyV28oECV/BP1WpTg57UGs6Jgc1sRq1L6oAFa5ncoJPcgP70PKaBOe5rDpuUmP5+dHrOyKn93hptuuxkUkrt4UYEq/gvqlH0BbKLmU+Xj0ZBprNJLJrh5msEhuYvU7nDqd4L6WB6G3cv0TcYA2H3Aqhw+D25a/s4gkdzFXBNUxlnU6W0f325VW8+CTdRSVuU1A9zcaWGQSO4i8xI4nX+Y+nyfApvzTtAnPzWBTf3fWYX9Z8FN0ncMGsldfBULp+eoT2oX2LT4jT75NBY27f5hFabC3TVZDBrJXRQMgVOrTdSl8ArYGD+mT6YrsOlxlJXb0hFuYucyiCR3saYOnMZRF+t42L1InzwGuyuyWamSyXDX8wiDSHIXltFwaryJusyG3ZBC+sA6EnbDilipPzvATfQMBpXkLtY0htNIfQEvTYZNl3T6IP8q2D1sZWVKxxngpncqg0pyF9YJcKq7iHrsPhM2Tf+gD9K7wUZ5mZVa3xoh3j8guYsDXeHU/yR1yLoUNlGf0ge7W8Am/jNWpuQuuOubxmCT3MX/maCKmksdisf5ce/2umTYNFvJyvzUCG6M7zPoJHeReQGczkmlDu/A7t951G9xPGzO2sZKpN8IdxemMfgkd7EgFk4TS+ndD/Vg0y2V+n0cBZv+h1mJ9+LhJuY9hoDkLoqHwanRWnqXeiZsWq7zfcjMiCxW7J/ecHfZEYaC5C5+S4HTkBJ6VXwRbMwf+n45/fgiVsjyBNzFzGVISO6i5CE4xX1Jr6wPwO556ma9G3YvlbJCy5vCXf9jFD4DhW+XmPZMpVdvwe526lZ0E2wM77JCJ6+Fu/gPGCqSu3g3Gk6T6NXXMbDplUe9stVbnf7HCr1mhrvrMhkqkrvI/xecmq6lN5vPgE373dTrcHfY1FnLivzZEu7qLmToSO7il4ZwuimXXmT21r3pQLXtDNg0384K5AyEhzFFDCHJXTwGlY5T10VDYTeTeq1pUcUIselmuOuwmaEkuYv9Z8Pp/KP04gXYPWqhTl/Xh80FJ1jeymZwF/UqQ0tyF5+Y4PQEvfjUCJv+WdTpnTjY3JDDcv65GB4GpDG0JHdRPAROTTayamsawaZDKnV6xgib0cX0lHMHPDRdylCT3MW6RnC6pYBVSu0Imwa/Up/ie2H3YCk9vRQDd8rkEoac5C6eUKCK+y+rlNMfNqaPqc/JQbB7hp4W1oeHaw4z9CR3kdoXTudV3ZxlPOxeYpWyDh7at/LD9//kob6we5se/uoED81WMhwkd7E4EU7jrazKW/B8Fi/KzSu2FmWlpaYe3vrz0qUL35pw13+uP6tRSnKsocuGPZ1hY/qK7vZcCA+G1xgWkruwPgyn5GWsykL1jtRM8thfi2c888zjdw4ddP3g6/tf0K1z5w6NYuDmtjVtYVN3Od0cGQhPg/IYHpK7OHIunK5IZxW2t4NNl9STb/RvkohyTFFxdVv3GjBw1KT3Pr0UTR9vDpumG6l14jZ46riV4SK5i//GQmWczipk94BNs2nXGwC0P+e8vr3O633pNTcOGTx45CMvvz7j/cUbN28+YKHN/2KUNvVgc/pOamTdbYSHOh8zbCR3UTgcTm13sXKWobCJTknomNBi8rb9abnZaalH0ovIooISusu5DgYjbM5LpUvuo1HwoIwvZPhI7mJbWzjdWcrKTYFDhw5XbaQXq5rC4bIMlimaGAVP16YxnCR3MSsWqjqLWbl3DbCLu0NHom8lwm5ALp1yJ8TAU5eNDCvJXeQPh1OfE16vjYyaVEDvcvrB7tyjtLPmrB1ohKd63zDMJHex8ww4TShlZf45EwCazKcemRfDLvq/JHP3LJx0SQLKiXuTYSe5i89joUpZxsqc6Aeg3SrqsqcLHK7+e/Fz/zo93oDyYp4uZNhJ7sJ6D5wuTGdlHgLabqA+21vDxqCYmsQZUCHD+AIKyT0CNNffPZmenlXKCuSMREt9tecf3T6nHrww35tFIblHxI9JUNUddMOND763Zv/JwlJqlK4bYWi5hlUpyfzn168/enPSkJ5tG0ShagbTvZkUknuETDNAK6FJh3P7XD5w5LhJz736+pxPFyxd0AVdluSWWOmp5PjahfPeffbeof1PPy0xxqhAl4Qp2RSSe6Tkj0IlFIPRFB2fFJ9y3nW3j5/62pvvzJ4z543pr097/M6hA3q1a1I/McpoUKCfYlQMxhtyKCT3yDncF05RqIICKAiEIdZojrkqj0Jyj6DNvZPNgKHxxfc8fE40QkeJNZujOh+mkNwjaeedBuC0+XuyCw/OvLyhWUGIGE1mU9NdFJJ7JB24RgHaHqNNxs8zx3RPMikIIkVx9h5lTPmDQnKPpI3tAHRMp5V2RYd+nHFn3yYxioLAKYbo+t2uNMNOMRsT11JI7pH0UwqA07OoUXh0/fwXhp6dYoICfynG+Kbn3vTUvA3HVjUoyz12GYXkHknfxwNok0N31uLsPasXTBvVq2mcCT5RDOaE5j2HTHx36e97M4tJbu0MB5MxagmF5B5J38YCaJLDClgt+ambVn418+F/9WzXqG5clNloUP4/lKPAYDBFxyU3Pf2S4U+8PX/5X4fySum0qz8cjEbzNxSSeyQtiQGQdIBelKT+tmThgi8+nfv+7JkvTbrr31dd1LfPBf36XzP436Pvf/rltz/4/MtFS39ev+N4ET3tGQEHg9E8n0Jyj6QVdQDEzGPI7L/XlfunFJJ7JG1pBUC5toChcnAcHBSjeRaF5B5J6QMAIHZBKUPk0IPO3A1Rr1FI7pFU8pYJAJp8V8zQ2H+XUpb7ixSSe0Qd6AKbuuP+tjAUDgyHyhA9tZRCco8k60exsFHO3hmS3vcPcuU+2UIhuUdU7v1m2BhHZzIE9vWHyhD1RAmF5B5ZJ4YpsGm+myGw5wLXr/vjxRSSe2RZPjbDpv4uhsDubnBQjFETiigk98jKGAa7NkcYAjs7luUePaGQQnKPrPVNYHdVPkNgW0tn7qaox4soJPeIKpljgo3hCYbClnrO3KOinyqhkNwjKn0M7MyfMBT+iivLPeq5UgrJPaL+OQ928csZAqW/msrWIaPfpJDcI2t9Y9glr2cIFH1rKMs95nMKyT2yfk6AXb0NDIHcWYoz9+g6iykk98haFgO7xBUMgcznnbkr0U3XUUjukbU8Fnamjy0MvpNlucNw7n4KyT2y1iTB4ZZ0Bl/+XDOczk6nkNwja1s72CmJ/yti0JVsbAenultKKST3iDo2RFF777nDwmCzZk00QWV4oYhCco+ogvejnDnen1Ya/N53XQSnnpkUkntEWf85H6ro6ekMuqJvjFAlbqaQ3CMr/9NYqOrOzbEyyKy7k6EyfGClkNwjynp8GJza/FnEYDvRBU73llBI7pFV+ldrON2XxmDLuR5O/bIpJPcIy3svHqpmvzPYiu+CU+sMCsk90o5NMsMh+isGm+URBaqkNArJPdJK918KB+O7DLaSsXCKTqWQ3CMu8244KHMYbEVD4GTcSSG5R9yhy+Bg+ozBlt8XToYNFJJ7xG1rBYfohQy2zLZwUlZRSO4R93sCHOJXMNh2JsJJWW6lkNwjba0ZDnXWMdgWGuFkWC25S+6R94sBDskbGWSWUShj2sjqQ3KX3Ov/wSDb1xRlYndRSO4Rt9KZe72g5z7XhDKNj7P6kNwl98TfGFwnL4dL71wKyT3i1hjhELXUyqD6PgZllHuLKCT3iPs9ylnklAIGU87VcDF+YqWQ3CNuRz2oOmy3MIg+i4NLgx0UknvkHekNlWHksRIGTWpfaAzKo5DcIy/vSQNUxtt2FzNISt4ww8U0x0ohuUeeZU1dOCkXbMwNUpc720Gj5d+sDiR3kXkzXFKeOVDMIMgfBQ3lgWJWB5K7sKypDxel++LsUgbs43ho1NvE6kFyF1kvmqGR8srxQHsv2XQWNJRheaweJHdhOXqzARrRD52wBJD64e+mDGoErZQfWF1I7qJk1wAFGlET00vpl4Lfp1/b0KzAjXJ7LqsNyV0U7RtugkbcB9n0mfX46indEw0KPDXbxGpEchclaS/UUeDSYYuFPsnb8f6/20QrqIDp1VJWJ5K7KMlc1FUTqzL2uJU6Fadvmj3yzAQFlei/n9WL5C6sBTvGJqCMecSSQ0Xeiy9K/WHqdW1jFVSu+U8WVjeSu7BkftUILtFnP7p4d26lqRZmHFwxbUiXeiZFQVUS3ypm9SO5C2v+uubQUKJaDXlj+fb9R45n5+YVFBWVlJK05GUdP7Dukwcva1fXqMCrmCmFrJYkd1G8qgXcKab45udePXLsoxMefeS+0Tdd1a9bh0Z1o9XQvYurvrVL7qL4l7NREUWx/fks5XULqy3JXRRtGmxEkJh6L7OyGpPchTX19aTgxH7G9GMUknv1Zs2dEYWAGS76aG++lUJyr+5SbzHAL67ne/MjBawJJHdRevQ2I3xniG3fUs3d8K8jrCEkd3H430b4QjHEnTFs5pKbFDicvZU1huQuDgwy6n5+iWp84dgPt+RZD440wqHpj6w5JHdh3XJlrAIbY4Mks1Jx54opofUV4+ZuOF5CkpmTTXBImFXCGkRyF4U/3xALO0OvN+dOGtK7Q5OUhNgos8lsjoqJS2rcrvdNT3++Zm+OhaqiL+vCIWpyPmsWyV3sfFTtXen4xcn8nIy048ePHTty9MiRtKPHMzJPFtJN0dq2cDAOzWBNI7mLI3cZ1d6TJ6eyatadVyuwU/rvZI0juYvS7QMMcEgYf8DCqmQ8YYRD502sgSR3Ufh7VzgosQ/uL2XlihclwqHFt6yRJHdRvKIRVDH3Hayi952d4JD0WQlrJsldZL4aC1XM2EOshPXg1XBImFFja5fchXX/KCNUxm4/ZlhYkROjFdhFP5fLGktyF5Yt3RSolJT+t97/xMtvfzR/4eJlK9es+6eAJI9+fU9LOEQ9WaNrl9xF8U8pcKdAMZqi4+vWa9CoYePGDRNNUJkfreG1S+4i61kzdDE+mMeaTXIXpfv+ZYAO5kdqfu2Suyje1EOBV8nvFrHmk9xF0S8t4WA0m4yKggp0+KGYQnI/FeQubIAqGfqsKqSQ3E8J1qyZdVCFmJG7Sikk91PF8VmnKaiQYojv9dERCsn91GHN+vb600wK3NhOM7W7esKioxYKyf2UUnxk9dyX7rn63A7NG9avl5zUoHGHnv966PVvDxVRSO6nsNKM339YsnTt4WIKyV0IyV0IyV0IyV0IyV3YSO5CSO5CSO5CSO5CSO5CSO5CSO5CSO5CSO5CSO5CSO5CgDWUWP9Iz/qIanbZMzsoJPdT28a+cFIGbKWobrkfX/Ts7QMuu2LUq7+WMjDC+pIJGtGvUFSn3DPfusQIp0bjDzAAwno3PNxtpaguuWc+mgg3sU8W02/iMZTzGEU1yX1RE5Rz/lH6ScyD6swBCpzmUlSH3AvvQEU6ptEvIrUe7JQnrXwKTnF/U0Q+92N9UbHeFvpBWPvD4X6SBY3g1MtCEencD7WHS5dnFy15Kh6qqfSD+AQOZxaR5DiUeZMiwrkf6YgyyR9bSfKXKDjEpdJnIq85HBbR5ieUSTlJEdHc87qjTNOtdHgIqrHUJ3XGTT3atOly998UZU/r59CuMBZlJlJENPehKJO4iarDMXBIyKYOhQ9FwSH6c9Z6aQlweJcOl6FM3UyKCOY+Cy7vssxwnxbPrkeZGPl9fwwOyfl0eB4uL1NELvc9iShzCV0WQXUDvdsMjRGs5XKS4HAXVT/CpVUpRcRyvwRlDH/QJd8MhzoWevU3NOpYWLvNgGoVVRnQWEIRqdy/gMsganWDajO9i4PGdtZq1tPh0MxKp9ZwuYUiQrnnt4DL79S6E6qP6R20vmetthKq+1hmEFwSCigik/urcOlNN29A9RS9yoHWl6zVRkO1lGWegcZCiojknt8ILp/SzWKobqNXxyX3MoWJcEgoZJl50BhFEZHcZ8AlpZBu/vZhaWY/tBaxNvsGqmvosgkaDUopIpB7aTu43Et3J6C6kl5tgdbPrM1GQDWNLgUGaPxBEYHcv4PGGrqzGuHQl15tgNavrMWKkqDaSI2W0HiJIgK5D4RLEys91IXDFfRqFbQ2sRZbClVyKTUuh8ZVFOHPPTMaLmPoqQEcBtKrRdDaw1rsgYqbvgcaCRaKsOc+q+r3y7pwGE2v5kNrP2uxTlBNptZL0PqLIuy594NLbH6luU+iVx9L7qr9cFpGrc+gNYci3LkfMMBlAD0V+3AA503JXTUHKkM2tVZD63aKcOf+MqrclnrEhz0Br0DrAGuvYVCdTjcHoNWNIty5XwCNdfS0FqpUejUVWidZe7WCajjdlBihEVtKEd7cT5rhklhCT3PhUE//eQbJ/RCcXqO75tDaRRHe3BdA4wqWc58Pi8T3Se4O/4XTSro7H1rfUIQ39zHQmMJyzoXDq/TuP5K7w/1wSqe7gdB6jiK8ubeAxmJ6Ombw4XTHLZK7x/tQU3oYI0szkcx9O7SO0dNsOLSjDjdAq4C1VWlipfvqnoJWP4qw5j4bGi0qL3gqdbgGWqy1dsDpEXqYCa3mFGHN/VZoDKSn7DjYJR73eU0T8qYKfEgPX0JLKaQIZ+5tq35TfR8Ok6lHL8nd7rHKt7SvhpsdFGHM/bCX43aXwK5zIfXoAg2FtdZ1UBkL6WEX3PxAEcbc50FrOz1YO8Om4S7q0gEadVlrtYOqIz2dQOQ2iUnuj0AjuoSeMiacriSOOOzLoqbknm+A6jp6shqg9SRFGHO/EBpdWJFC6pYCjaasrTbC6RGW0wBaoynCl7slARr/ZoDqQKMFa6tP4fQOy+kIrSsowpf7n9CayABBqz1rq8lwWuFt9aorRfhyfxda7zEwOdDqwtpqKJwOsZzroNWAIny5j4XWCgbmqJxdsDsPqgSWNxJuiijClnufoB4/+gdafVlbJUF1ttdN0jhMEa7cSxOgEV3KwPwlb2HuS+tDWN4kuPmDIly574BWBwZoFbQGsJbaUOW7/8vyWTVSuc+D1sVBGb4n4/q/gNMsljcLbj6jCFfuT0NrGAM0H1ojWUu9WOWFDp/DzUyKcOV+I7TGM0AfQOsu1lJ3welvr/8CMZUiXLl3gtZrDNAb0HqEtdSAKnez/wI34ynClHuRCVrzGaDnoPU0a6mzoWrECmyCmzEUYcp9K9ysCcqpBrkntz5UPVmB3XBzE0WYcv8KwZ3xcxe03mTtVFB1yofhpj9FmHJ/AW6yGKBh0PqEtdM/VT+Xn4Sb8yjClPtt0IphoK6D1lesnVbD6Q1WwAo3HSjClPsF0GrJQF0stwi7zRpYwIrEQKsZRZhybwatHgxUN2j9wtrpLTj9xookQ444RiL3IgO0rmKgOshNZG6fqg95P9ALI0V4ct8BNyMYqEY+30RWcHh3aiHDK3P37kyG0J1QGUtYkZZwU0gRltyXwM0DDFQ8tI6xajkf3twSAAxtRnxdzPD4Y2KvOgBQ58Ipexkig6Bqwgp1gQyOjUTu78DNMwyQBW5yWZXMCXXh0uoLhsGynnAx3HqMIdEHqh66cj9KEZbcJ8HN2wxQBtywKosaw93IYoZY5jC4a/gLQ6E9VDfomSyI/RRhyX0U3MxjgPZDqw6rMFWBpxssDKl/ToenuF8ZAnW8bAntK1MiI5J7f7j5kQHaBK3GrNwEVOBphtKuZiiv4XEGXSGcJrNCl0PfAlbWn8t+SWfA9q39YUsxKbl3gpsNDNBqaLVjpabDydj5dANU5i0MnbR2cKrfLQlOwxh0R+A0S88QfGxkhf64wghAOf9TKwNgmdkCABJH7pDck4O8Q2wxtM5iZX40QnXJXvKvhlBdx5CxXApV3LulLLoXKmUjg20bnL7WlfsqVmR5NFTDA+l9OFQJS2t77oVwl8YAfaxv7saRsr7PzyPJGVApOxmI1PceGHrbi3+xIk9CZVxCksVNymJisP0Cp3W6cv+ZFSg5HWW+pN++R5mmJbU89wNwVxTcw0xXshLXQhV/gDbpBqgeZwAWxVR+Gm6dEar7PcZJRecwyBbCaZ+u3Bd56RQ302+D4PIzg8O6d+2i+Ss2F9W03NfDTRwD9Sy0BnudfvCY5ztEJ1asdPuCWZ/t1blhp46FnkrOgirhhOdtMvMYZB94+146WEfuD8Pl3ABvRFPNZuBK1zzRPwl25i5DZ26vSbl/BzeNGahxevYknGwClekQHW6o+nkq+6EkAFCuOsAqWKKgSq9iNMDd5UZS38sgew2qJF23ceJzVuBquLSmv/ZB4/+xd+7xNpdZ/F97n8s5jsPJhUI4CCNOY6RM0qU0/Qq5dElF1CiXDBGhlEwTSiZTNEYNokEuaU4kF5LQxeUkXdwvJ4xcOIdzHOey916/1w/7u/azv+tZz7MP83v5zsz7/zGyP9/nWc9an7XWWLxQjo2sBSp1B232jNzfA4VfXUT7vJB1HgBhHsDz9OLWuhJ3w3mqrpd/Wl2XysEUCPOja5plCxQ4vvuXIApkz35jxOxczSbJBlIwR8w0VV6vQI5TXy2e+8mXe82pMjktum/lR/NWZJ1CM3nDywLD9TMD3pD7eFD4LcaOdEsPRY49ieotrt7cfxZbP+EywXX2mb6a+wd361Au/ZmoIzCqGgCktBihEUP2iHT4f5T7Cz8DsiXy3G2xrqa2XK9b/0xDH5ylSttpeWKqTPg9zky/Lw3O4m/c50uUWVsHNDSY7wm5j4CLPNKxNei2+BG/hzAVitwd3QMNVchWIdRAw7nKup7kSernpModclDDA85BEOBaTnvEQ5hVGEE3OE8HtKqq/tVoEnYlKVtCJKnDdIfzIum2LRhVGSLJWIgCUxNAT7tfPCD3/he7Jb4ZEJqTOjuRGTJGcn+UXw5ATEMdQ52QhzfkqrmSXHO5YZWY1Ph7eXBorNRm25v20LQA83SfWnqv3YG2EM2VqyW582+pD6tBNA+cRB1TfBCBv1nHdo0ggivWXfpyfxQUnsQLpS5EMsmQcZjNyL2DyZZ/+Wn5LGbKW0fLAGV+GLlvMTuK3nLF9OH42wcAKWp+/RbTWKkMUHhFkDvzgP+gArhJmGCW+/1KIN4VGH6lq72ujgMivv/ZId17+8WDQ/KiS17u7UBhIF4oFY1PsNNUvvfTkTgEwrRFjlv1dwbRVNeUNQoc+sci91r6ToDvwruXay7dteCLHFT4tWnOTn1Q6GuUezY6BAYDzx+Ncm+LxK4mwFKV93Hk1gAizQndvr4SHFI2XOpybwkKL+CF4odIMtHNDNZj0Ic9gYi5QFQrQh5nUn0PVAjVAaZV+ohR7keBuBcVFqeGLyMu7k83rf6pbTF542pe7kUPgUPFOx5oWQYcxqCbzzVy30xtZ75GHdo3BIcqO/hAkYhfiQ6HIiR0TfASl3sjUBiDF0gOKCyXz+leXNjQBTlKrjBPrzkAYV7ShuBwiN4QRr/5eiBuVL++xPNKGR4SV3cssAtmfJw1L4OVe3EH+istCSDiCXp/+T6S5u0rct/s/BWTn9l79phuDGEa5aKLokpA9FNyO/eAw6eXuNyrXeTJy3uNI/gO+cFhCjp0AirxszzDS48/yP6mfaimo8MmcDgudDZy5s7MBDiLfxKyOI+6lchzO6hU/8Ig95/CF5Wz4ixxYii6qAVpe2S53+xYoZ3Nrk3CZYjc5lLG4lP9YvWSrhQpXuJyTwaFaRfcB2r0cU8A4jsuVTHW4k/eaWhEXKImzy9nYxL6BZOEJB6X+V6ZJCQQlVfBBnQoOLhtw/IF0yeOGdqna4eqEIWv7ScBSe5bop/0KUvQ4UEavyfLvZXLCn1jLlWbygmOtJHCbujgk3Ceey5tuRfARV4jsQoUmILfLeCQUIwO9SDMLOS5xpTJwEGaz2EF/zqZBmEa2uSsg5QmCnfYjjZWd7cjhnbMGdG1Zc0UMFFrlSx3ZTmxPxOJg2WZOE+Qe+A252zPRWIMXTb5SFAlQVeEDvWlw+RSlvtRkK1KMfORyU982M8uXQ0mGfdyjQCisZxmilM7d54CYhbnZmtvI/cTTgYyfDT2Nq9jyxx9Z3kQ0cvoBrfcf0rl276o47husXQr3hjVSFZeORfOUJZltOR6uB2jCQ2iCYGXsNz3wUXu3ZsKCqdFk87DnBE5rsBmx9kuZGhIAbrCVUBs5l7Hw2W5q4/FUPiral6EGlZDqaghVF7Xnn0vOgnOlgFdXWGyrpuSDphVfk3w+jqlfHI5x7JgMXo9AQCaFV/act8CcldNzLxhGkTwEBAjlFemyaVWlALEm+im2Klxt1YtOkD4C9DhZggzB3k+gQi2RVkry++S7e6xcyMvd/plhjvZlG3aetjVIZPcTzlp0jaokpOsrao9DERNZNg55O6eOZd43v1LUNl84R4cefZhqCoQ/0CHdyHM46jjdoO55wfNNoxJQNRlp2P+LF8oSvScFf6oZsg+09hJXM7KncLMLc73/KLwZlolyL2W4kdNduVxHtR+NQOA8OehzKUq92UgZlJkCrcfN3hwqnOSJL7m/jWnoI4hQJQplCpRY7W71tpxE3FqoyR3dbZpYfgBeQfqCIxNhdhJ7fKjZCObhRhq5RyvriAxWJ31HJHcyfqZFacvKi6Iip6INyGCzz0q949AZR/aM7sKQN2RzAOeqO92VWlmZ1HtaYfdAtjPpTGkC7VTK5/iDsSuVnJfo1xfSTtQdu7ERtvMfLnBbyLiFClf3B3ClCvUD/7xl2DwesctcAqjyU3QlT9WQAQjPCr3f0Cpp1ll+riJ1u0Ngwh6AJEYYgYi1LMsYb2ELh7kpxTthAhGc1b/9+zlviOJwgl5cYdCfMM7Hn321Tcnz/14+fqNGzdu270YVP5k8jO9iCcqORWvEnQxCxyWCt3I/8K/QZjX+Gn//A+RFwdEY4/K/a+gsh9tyS7Lji+/2TCI4Nd8Q9oeq7pceSB+hy4cy1NCiXZl7wzmPPQfRg3fAEQVyO/Un4z0ealc0XXqpjN8jxExwNTg1wMHiz7T/eAwTNiLszHvciewyUU3z4NDthBarfem3F8D8yRa8cZOK3ZLTpgWnx8HxE3c2bQc9fwWiAohfWLman337GdMevJmu8TVosjWoPHSP6ofHNKHfyffG4JRqAtEcEd2svP9FCBDTc0hcxIi+XAk91UQi7TGpHHq7n9Pyv2l0so9y0epLP0ukPsFz5WSdu/rxJMB23mW2/QbMzvp59NRmHNYNdgIcqefvyRsUqx5BgVWOUXOd0JimET8zrTDsE53KXJWetuT1CMIIhnkGAXiDiDDIa0p+Zd4IPybPSn3YSDMp5bopllvnioPIpiu2ajdlHsgyXfR+/qX7HMYSQ2+7rXAUcdxO7lPi3hov2W50iFLfhXIgzWeUqJ/vyO1vcgxUpdf8ynJTnocmzyDraROoLs9KfcBoIKWZMfzjr8SkAcRDOM7+3LiyDQmMAdUE6rKcP4aPqmZSDxQOwuH2AYRjMczNcNhb56l8e4AatgMKjWEs0i6CIh5ujAkDVRka3JrbdFke5wa2nlQ7n0s5C7138XliR6cYeIWymnuPXW3osRXYkdEO/502wh8lamJhXEiW80FvQ3nGWy7Q/iMbTk7yTgi2WSh+16XJ7wMOKoUI8FfKYekjblXnvKg3H8v/KML5IYjwKaosgPkQQRN+FanPjRAVOIgRJBcons2JBRrr4RrKUj1hTtwQpYOuv4lYdemf5/l/N9yUpikwqhnDHCUyTOaW7sJW8+o8MzzZ3D4ClWyU9Sb23tyfwQU0mLNX/aTnqIUrvAnzTpXkqRBECWCiRDBj6hwTDGGEK/xgcD7cmcUk8Tr9gFQQVVkK1dmk715sNO4z9zksa0KfKqpNnAsRZ75ght8NETgW+M9ud9fOrk31wWAy+TVN6chkq2ue3g6ytQWBs2thDCd9Q++zq7xT42kLywEEdzzG3oly3xBni/hAlD5WjhUFGYZfxRooLPNE5WKUe5X5JKthUpDecMznpN7W5PcZTu3/xh3NhAzxa2Wh6PToY0CKKM4wIfrbuFXtP+JlFzLTxHMkEQcEClOiJKPMvOEk5hCD5WPtauIVeJz0TiYrLKuLYboalG6ftEwUfQ5z8n9zlLJvT+FDVFMAYVMFIwXUBzdcr8wpsuovS5Plqn/tV+MtpPdEEKJNAupCP2JvVFLIhjH5s0EFSU9KLlmfHw5VDqIuAv4KTa5TyR86zW5tyqN3AsraZOB4+VukffYpOBG61zuANAPxc3QVL+rqslE9cyPM/xilwPDXGsX9EjUUhVURgo2GGZWhNy7nsfbYAj/cdRRRhrntq+s8vAv+W+Q+xw6R4XZdtzb/hVWro/BWcrtRRNjIQLfKeVUiuev8hI/EI4ZbJffrnO+PhD2yw+eYN8u8p/cSyjoy8uzmEROrhCwUhaXJ110Cqjn2ViPyb2FUe6SUy/hFHPCSPb53lxSMDtRkaLETP1Uj7WaZvx/AUHhUk84S+MCq/UIKm3QREeLvOp1oNJe6qUi0gI2dr9c9udSC9o6MkS5BxTFlNnpLblnlELuh+P13qonZPv8vUows1FJhj4U85yDSXzX4HNC+bJ78Jy9Jv7cr/UdGrgN3ExAE9fTYiYtHUCluWQ0INpYmblzhWSz6ZXUSpB7uKPK4baQl+V+ZUybKWAUbzknjorDhCpmRXhXmp1GMzv0FgXqgZ3vHrVE9AghYtE5PfqoeVAWpcoPaKKORftALzDuTVknhO7y1VfCFkMJ/wnUcrNhPu4LEMk7XpZ7LbSgmeB6vksuFTYDhcprEVeknPvQ9se+J7AVP21gt9qFAiqPFeLpjoJ0pOYs2qMhU8ZisdtIUPEXC5VXYrVVZ5poFDG0Z9xlqJsWKovH0w7+h8uduk2rBk1PX34aNpH4SKe4c2rfjjJcpiSNralWYAewEk1615U2i/A7P2Rnugo1wVZBPX+DKPbId5m5Kfp9TUw6EFx0Rz038o4nYo3y+O/wHy73oXRQmv68JGGEs0K6eiLLUTGRzU1zbC2UJqXuP/nmJiba7xDOQD2Z5nP7IDN83SrIrG/6b3gT9dDh/Qby9IVI5ntI7o1jlnuQGjg+4rNYwsu3ErC0PVY608MiLgP6vJXcU6bHurrKvm9tuY23ZjNE4X5I5AoVLvEmus3kNFsnLy801BfylFOrZp535F4rZrmvEPPPlWUTdxowVHs7hLY8o3u3tdFV4/8MHHftQCveh2iSi+yXqnZDPacgitF6xw7xKuq5SROrvA0uTqKWH7U2HmIhRDLkP1nu3Zj8NpGkxihmufubv1WA9rwJfMdksKJuLOU4cFHpsW/QkmV8gUZmjJUQqoBKb6nASd+yltNJmjhtGqjICbiJ7FwUKaGcsM0zcq8dq9zzU6V++GJQyBA32WSsXTBvXe6FzMXJYN7PV4m2wgmL5y7cGkJrNkE0T8bwvh2PYp85u/RQjv12oZYF4DCPL4ILBxXX2Ss8tPcrPZqdvPpUrR/D7R5/BF0cB4Wm4mXS2Pzme7Z9z5lK8JAFDkofxzsU3Ypyn4cGgjO63P/yD9w4C1bCclF1jn2rAX2n0ss+KSD9vzrsNXgR+qGWA36rdtRREMlar8i9KXMci9wptkxmG9x7dZQ3jrGeleB6d53UmBS6aS320yGSKShz6Hp19dAZiGZZDN0Aq2JJ+iQGdINziIaoZW+87h/2C4jmL6hluPSYIM6kK8unQ560iJnlftAvLnreIstd/bqSQijyKte1VJW3saZrh7pmxuJpOpgevaylHIiDp+TiwPZYBrhBtuxoUgMeKTv4hBSQyVaek5eBwyYUmKsmIz0i91tFuUv9ZImchTQLFO6WNxIdRIk5Pq7N7EZ2Bz3dKuUDovGkH0oUtHB9p41ApQwaKfYL/aeCCj83O3Z6oY5didohAVtBgY4EuRu8dggFQjcpgVixB7uZzHIP1ZeraWtAoa1sqVmHAjvKsc+zx9jTbob+C/sJImmHEr3dBbQ7QaVRDCsiyqFEng9UJsu/juyfbwcO1UuECJPayDh2JFuX4Tb4IYK3vCH3TrHJ/TNw+ETO2/ETXAZKHTUKRc1J0vo0+uWugQpjxFqNrNZ/Ok76DeqoBukLFpxdDVGkJmvKFb2Mb9tERmNN1Sp/AHkCN4NDmSMo011JbRZ5Qu7dBLmL2YTaQe2EQeIRuUg53GKQDcRvFdr/4BApR3djlGdyOSwHKjHZnZdAXm8thbWtUeR3oNJeslPLiaWt5QC0k06LgZAzjMPVyeAyexQn8HQvThFrjiL/SmQHNBOzDHKfL/++xBIfVV+kuU2fRnV8pxYb0hs/oo6g87BI+lmZR68wOoZ9PY+iSD9j2qU/RLEIQ8v/2PWWjhMKkKC1kZpfJgFc1ZXjf3+m/S09V0ddET5wKJsd21HZ0hNy/5Nwuku5s/gDyDHDIPctlkWtI1c40tuPKjUY9b0t5Yo7iWMriDHsCb4UVKagkUGSo1Ao7ieUGKfmfREOBzOOIHHsWiDqFxr7y5vg8erngraRSiyXKPvq5bf2Di/I/Z1Y5F5AjpiHrMbF/x6jKIqHSE4gT6idPni4DyJ5MOpJN9aU334GNax3fuzk/fyUSHqyyHS2fL+thCi2GceIrXHuqtso/t7dGAjfcnO1KgO/YCYnvRsPRJMiNNNQcfN4Qe4LQaGO5XHky7Lau9eHdZcSS4xdl2UPaYe60czH/DLSTtZZYHPp5lE8MNg9NJ7YEEMt40MUOWAcUvqWW+5Pu1oUMysJUznZZGoGFoZj/XLh4C6/J0SQ+iPaWcGJW7wg929j8MwU1TSWO8aY5N5FPzGV+ClFGGX+NSgcUYw0l4eQYEc5JeSb8gwVTkha2YtG6siOQqK8sLCGfTjAknBlw+k83NkZIukYkPrL6YxwxH3V2ago9IHSeJOQiTzF+p8i6QwSHtmaXRkFJgOYquPPm+Q+EZTiM3IUNpW81EWqTTBT2XLQ1Ww9XIwcs5UUspCqPY5GEml9pcz1oNLZOGhmUUQ+J+659WsntYlTH/9FojOYDrVtzv+u3txNi4fXg0gS5yFD3ht3V4O6g/ehQ1B5FHzjAblHFcnjUE9huvkZPoSRu9DUEM/6rp+WBxjdAZEMRCy8TM7kdzC7s/fQD9c0IE6dLkEThyO23Mk8CoaX0yKm+r85AXT4hgaEWiJxBbk2OWqskZr64nvl8D/FZC/I/TqQH4/EOPPhjn1Mcg9ebjRvZPpko+qr0bv9MulrZc/eCcbXeBGds751YrIpBY1kkaoMjDGlZlZxo+7+opWp7hn9ILjHq5xuBho6HDG0o1Tfz3byPusFuXeTkwPEiYpyZZGrQQ7WDdgS2n120EGbtM3Ca7IPHzbMT/zZZ9qU3Af0O7vXxzqIZ7FUxJDbVbegygYgaPLUq35gSH0uz/SrKL6fIy2Ao/GnyFPMvDGUL6+zF+Q+FhRWWBSk4r63XaA7zDQZK60Ao8hvbKq6hqqr/vPjyfw4eeJaw19qKjhUch1tZxJjHMQzRa6iSQtYZ0ivbJrotKalu2V7bI5YS2QisqLRlSGKxHuWhlAHFTwSN3F9Urd7Qe6rQWESatgUpz8AiTuNci+uKv7AgfbgcE2RzTCMa+iI8WXr+9EEp9/KRHCYY/hYasVQueuNBoIpAGJR4JCun/XLXvTNJ2U8PnmbeUIrE7Kefvf/JFKW4rZhH+ciIYVEDfOdBiqimRfkrh5eMBB5AhTqlT8oN6TJcsdnhc5PJaxI3Gz3hVYB0/KA3LJSbmZLGojVs6dilHs/3aYec4awtbj9QR2Ns++TKeMnTp6zemcAGeR2XcquFG6aM3ns5CkLvzmGJmYD0Z0plGV4Qe7YEmyKBaPsvJ6NzHLPVjMLn2l7wv6KGkL1gOct2djLT7bcWQMcGuQafma4Go3cJ/kN5NRMJYwiXva7x1o6F4pxZorSXV6K5d6T+8s2YyXWxFGuXDpNapjljj3U4z3ERx3ShNTXgSXuEGrITtIe74evAoeUb41rZVqgkZZyzVhcvnRAaGUnz0SsfABRrEIZcwNT4lJamEiniAfk/q1FK+YRknGZ7SiQZiH3n5N1Wyve8EXo6jRqySkHHLfbzr5rQH/2rgi1+z409/M+jkbqKnkWkUVgcOSkCytV7VksuhXs6QhE0sLoo7KLB+Tumqvfg7vGWinLxQSSZblzKw/KhlVx6nEgav+CKlLx1my5PlZJHYsavlI+rmo0Aapn2LwY5qEeRRN7gKCtUsJapeuwNKyFKKZiqTheD4iEkbk5DZQUmTfkrnqAL3MXOgP3KSGGBNjIvejXao3v7L2YP6k6ENV2osSJSuCmQoH9ff7I2XpUVke7Msm4sIJ9jwTRxOkYdtSGyhp6pVqBSj20R5gkPA5jhV71hD9O7STwgNypZyPM6y61dwWHjHyUKJTkTmwtDwrX9nn0JsUJU/V7u72uCoNQogcolLu39z3qi7d/CLXkfvrqgJ49h767C83sld2l8gqPiobyf0W0RG5WHY6l5Js00HGrBxyRTEdklROocLoDOFTZhyK5otyJzDiQqL0VDQRugGgSZUNW0e0g8gJeJDbEEnh0hyh2o8LDoOILYSnIAeICF15nVQce31dekfv3fvVCVVIvu68Fh7SNKHPC9hSZnwh6Wh5EI9tcx8wTKHPyVtCT9M5FrNvJJmnZ0P4RypsIjmEpCPnsEzwmDrYElkHoFbnjY6DQlt5YBeNSwSFlFRooApXXUceyVNDg61eEFvzTBwqph9BAQXvQUecimlfXq34gme8Mw+Ofl1bJ21PBPsFjpGQEd1TdG/CO3A9XBoWKQ1flI+Kp1YOrAFF2FRqpZt3YuTUDWNJXoB0vMQP6ZYIvxwOHr8+pi99BYHfeBWvLq5del4bL21NXXnsWI9+77kn/4AB6R+44D1yUvTIFFCp/FXssukF61o66DFykvVKAloTeSwGiUwgt2MgF8LduwItKE6fRzoKx8un+rrudqTQ0c7czXRBL1IaRZusRvSR3HAAm6m+30lOcYjAJypH+i3VAodbLMYWmuzqHT+vEfrZfybJ26lWc0GElXmRmy0O4VM6ozbsp2dKgEmqljpHWoFIBL5RNf7gifEJ1+TyEHpN74H6QaZODVkzwxVST2fCn+xuc1V/cVe1HZ4UwRg5N7dv2jnuHzj2G9uTM6HtT5XM/VIsn5+bixWdiOYCGH6Idu+sBkboQVVZIsb0990EUQbxgQpunvDj0tanf0R/lHblj0UMgkDzeWolLr3as4bYnUeHR3UcD+P+XnJ9/zsN/F6ezdqM1eS9UDB/t3fe4bktQkV2W5qIDFXy9AuC/heDzPtBx11a0J7h8yF3X3dBm8IJCtOJ/FK947emeQ8YtyWfOfiBEg7bMYIhix3+r3Ill6cByy1L0KN7nOETxGJaGVyCKb/4ndzwz3i34Sn3Xo2fxPiGfMDZVRPZcfPpfLHciuPLp3ySQd+uul9aWoJfxPpVBpdWFONWJmf+T+3mKt30+b+7c+St/+L/s3c+Lr2MYx/HLbzqnbJ2zkTjEUqNkyAZLk5rJjvxomB02o1lMGguGklIskKSMjcxSU2NnNQtkhQ2hsaCZiYn0nW4baq57eXvKVV6vv+G9eXquPvdB4z93U2S3tBG70XlN7gVxZ2TnprkA3pA7BT0Q2RVtxH50npJ7QTweneM24M/oPCz3gliLzg+TnETeL/eCeCU6X7QRFyKbl3tBvDvNZsbtkd0s94L4eJrNjIXIrpF7QexF56024tHILpd7QexH5+U2Yj06v8m9HmaXRrbWRrwRne/lXhDnI1tuI7aj85ncC+K2yJam+QT4RO4FsRDZPW3Ej9H5UO4FsRLZrW3E7JLI3pR7QTwf2XXTfAK8JPeCeDuyq9uQucielXtB7ERnNskh8bLcC+Kr6Pw8yW7WktwL4o+LJhlFfTWye+VeEecj25vkP9Oc3Cvirsh224gvI7tR7lT0WGTbbcTvF0dyTu5U9GJk77Uh10ZyVu5U9FFkr7ch90Umdyr6Zprcnwm5U9/JmUg225B3IjuSOxXd0b/eNOTzyA7lTkVPR/JcGzI7E8lPcqeiD6Y57ro7ku/kTkW/nu1f1Jxg4/2yY7lT0kaccuGgjTm+Pk5Zb3KnpJP1q+JvV64ctlHfzsc/bthqcqeqo53NJx9cfGh165f2b3z9/uoji0tPvPDprMkd5A5yB7mD3EHuIHeQO3IHuYPcQe4gd5A7yB3kDnIHuYPckTvIHeQOcge5g9xB7iB3kDvIHeSO3EHuIHeQO8gd5A5yB7mD3EHuIHeIBnIHuYPcQe4gd5A7yB3kDnIHuYPckTvIHeQOcge5g9xB7iB3kDvIHeSO3EHuIHeQO8gd5A5yB7mD3EHuIHfkDnIHuYPcQe4gd5A7yB3kDnIHuSN3kDvIHeQOcge5g9xB7iB3kDvIHeSO3EHuIHeQO8gd5A5yB7mD3EHuIHfkDnIHuYPcQe4gd5A7yB3kDnIHuSN3kDvIHeQOcge5g9xB7iB3kDvIHbmD3EHuIHeQO8gd5A5yB7mD3EHuyP3/7q926VgAAAAAYJC/9Sx2FUPoDrqD7qA76A66g+6gO+gOuoPu6A66g+6gO+gOuoPuoDvoDrqD7ugOuoPuoDvoDrqD7qA76A66g+7oDrqD7qA76A66g+6gO+gOuoPu6A66g+6gO+gOuoPuoDvoDrqD7qA7uoPuoDvoDrqD7qA76A66g+6gO7qD7qA76A66g+6gO+gOuoPuoDu6g+6gO+gOuoPuoDus3UF30B10B91Bd9AddAfdQXfQHd1Bd9AddAfdQXfQHXQH3UF30B3dQXfQHXQH3UF30B10B91Bd9Ad3UF30B10B91Bd9AddAfdQXfQHd1Bd9AddAfdQXfQHXQH3UF30B10R3fQHXQH3UF30B10B91Bd9AddEd30B10B91Bd9AddAfdQXfQHXRHd9AddAfdQXfQHXQH3UF30B10R3fQHXQH3UF30B10B91Bd9AddEd30B10B91Bd9AddAfdQXfQHXQH3dEddAfdQXfQHXQH3UF30B10B93RHXQH3UF30B10B91Bd9AddAfd0R10B91Bd9AddAfdQXfQHXQH3dEddAfdQXfQHXQH3UF30B10B90hcCKiPodek2oAAAAASUVORK5CYII="
;var LoaderScene=cc.LoaderScene.extend({ctor:function(){this._super(),this.bgContainer=new cc.Node,this.bgContainer.setAnchorPoint2(),this.bgContainer.setContentSize(this.getContentSize()),this.bgContainer.setPositionRound(this.width/2,this.height/2),this.addChild(this.bgContainer,10),this.contentContainer=new cc.Node,this.contentContainer.setAnchorPoint2(),this.contentContainer.setContentSize(this.getContentSize()),this.contentContainer.setPositionRound(this.width/2,this.height/2),this.addChild(this.contentContainer,11),this.sceneName="loaderScene";var e=LoaderScene.getLoadingText();this.message=cleverapps.UI.generateOnlyText(e,cleverapps.styles.FONTS.LOADING_TEXT||cleverapps.styles.FONTS.TEXT),cleverapps.styles.LoadingScene.showMessageOnRewrite||(this.message.setPosition(cc.visibleRect.center.x+cleverapps.styles.LoadingScene.bar.x+cleverapps.styles.LoadingScene.message.x,cleverapps.styles.LoadingScene.barBg.y+cleverapps.styles.LoadingScene.message.y),this.bgContainer.addChild(
this.message)),this.hints=[e]},rewrite:function(){var e=this.message.getString();this.message.removeFromParent(),this.message=cleverapps.UI.generateOnlyText(e,cleverapps.styles.FONTS.LOADING_TEXT||cleverapps.styles.FONTS.TEXT),this.message.setPosition(cc.visibleRect.center.x+cleverapps.styles.LoadingScene.bar.x+cleverapps.styles.LoadingScene.message.x,cleverapps.styles.LoadingScene.barBg.y+cleverapps.styles.LoadingScene.message.y),this.bgContainer.addChild(this.message),this.onChangeSize()},onLoadError:function(e,t){this.message.setString("Error loading! Retry number: "+t)},createAnimations:function(){this.animations=cleverapps.styles.LoadingScene.animations.map(this.createAnimation.bind(this)),this.updateAnimations()},createAnimation:function(e){var t=new cleverapps.Spine(e.json);e.onBg?this._logo.addChild(t):this.contentContainer.addChild(t);var n=e.name&&e.name.idle&&(e.name.idle[cleverapps.settings.language]||e.name.idle.en)||"idle",s=e.name&&e.name.start&&(
e.name.start[cleverapps.settings.language]||e.name.start.en)||"start";return s&&n&&t.setAnimationAndIdleAfter(s,n),s?t.setAnimation(0,s,!1):t.setAnimation(0,n,!0),t.setLocalZOrder(e.zOrder),t.setScale(resolutionScale),t.style=e,t},beforeTransitionAnimations:function(e){cleverapps.isInstant()?e():(this.bgContainer.runAction(new cc.ScaleTo(1,1/1.1)),this.contentContainer.runAction(new cc.ScaleTo(1.3,.7)),setTimeout(e,500))},finishAnimations:function(){this.animations.forEach(function(e){if(e.style.name&&e.style.name.finish){e.setCompleteListener(function(){});var t=e.style.name.finish[cleverapps.settings.language]||e.style.name.finish.en;e.setAnimation(0,t,!1)}})},onTransitionAnimationDidStart:function(){this.finishAnimations()},init:function(){var e=bundles.loading_scene_backgrounds.urls,t=e["background_"+cleverapps.settings.language]||e.background_en||e.background;cc.sys.isMobile&&(t=e["background_mobile_"+cleverapps.settings.language]||e.background_mobile_en||t),cc._loaderImage=t
;var s=function(){};this.animations=[],bundles.loading_scene&&cleverapps.bundleLoader.loadBundle("loading_scene",{onSuccess:function(){this._logo?this.createAnimations():s=this.createAnimations.bind(this)}.bind(this)});var i=function(n){cc.loader.loadImg(cc._loaderImage,function(e,t){n<=1||!e?(this._initStage(t,cc.visibleRect.center),s()):i(n-1)}.bind(this))}.bind(this);i(3);var o=null,r=null,n=cleverapps.once(function(){if(this.drawPercent=0,this.needPercent=0,this.percentInterval=setInterval(function(){if(this.drawPercent!==this.needPercent){var e=(this.needPercent-this.drawPercent)/20;.01<e?this.drawPercent+=e:this.drawPercent=this.needPercent,this._bar&&this._bar.setPercentage(this.drawPercent),"undefined"!=typeof FBInstant&&FBInstant.setLoadingProgress(this.drawPercent)}}.bind(this),.2),!cleverapps.isInstant()){var e=cleverapps.styles.LoadingScene,t=new cc.Sprite(o);if(e.barBg.scale9)(t=new cc.Scale9Sprite(t.getSpriteFrame())).setContentSize(Math.min(
this.width-2*e.barBg.scale9.padding,e.barBg.scale9.width),e.barBg.scale9.height);this._background=t,resolutionScale&&t.setScale(resolutionScale);var n=this._bar=new ScaledProgressBar(new cc.Sprite(r).getSpriteFrame());n.setDimension(Math.min(this.width-2*e.bar.scale9.padding,e.bar.scale9.width),e.bar.scale9.height),n.setMinProgressWidth(e.bar.scale9.minWidth),n.x=e.bar.x/resolutionScale,e.bar.initialX&&(n.x=e.bar.initialX/resolutionScale,setTimeout(function(){n.x=e.bar.x/resolutionScale},400)),n.y=e.bar.y/resolutionScale,t.addChild(n),t.x=cc.visibleRect.center.x,t.y=e.barBg.y,this.bgContainer.addChild(t),this.progressBar=t}}.bind(this)),a=function(){o&&r&&n()};return cc.loader.loadImg(document.getElementById("loadingA").src,function(e,t){o=t,a()}),cc.loader.loadImg(document.getElementById("loadingB").src,function(e,t){r=t,a()}),!0},_updateLogoPosAndScale:function(e){if(this._logo){this._logo.x=e.x,this._logo.y=e.y;var t=cc.director.getWinSize(),n=Math.max(1,t.height/this._logo.height,
t.width/this._logo.width);this._logo.setScale(cc.contentScaleFactor()*n*1.1)}},updateAnimations:function(){var n=cc.visibleRect.center;this.animations.forEach(function(e){e.setPositionRound(e.style.pos||cc.p(n.x,n.y));var t=1;e.style.width&&(t=Math.min(this.width/e.style.width*.9,1)),e.setScale(t)}.bind(this))},_initStage:function(e,t){cleverapps.styles.LoadingScene.pattern?this._logo=cleverapps.UI.createPatternSprite(e||null,cc.director.getWinSize()):this._logo=new cc.Sprite(e||null),this._updateLogoPosAndScale(t),this.bgContainer.addChild(this._logo,-1),LoaderScene.showCanvas()},onChangeSize:function(){var e=cc.visibleRect.center;this.setContentSize(cc.director.getWinSize()),this.contentContainer.setContentSize(this.getContentSize()),this.contentContainer.setPositionRound(this.width/2,this.height/2),this.bgContainer.setContentSize(this.getContentSize()),this.bgContainer.setPositionRound(this.width/2,this.height/2),this._updateLogoPosAndScale(e),this.updateAnimations(),
this.progressBar&&(this.progressBar.x=e.x),this.message&&(this.message.x=e.x+cleverapps.styles.LoadingScene.bar.x+cleverapps.styles.LoadingScene.message.x)},onExit:function(){clearInterval(this.percentInterval),cc.Node.prototype.onExit.call(this),cc.eventManager.removeCustomListeners(cc.Director.EVENT_PROJECTION_CHANGED),cleverapps.bundleLoader.deleteBundle("loading_scene")},_startLoading:function(){this.unschedule(this._startLoading);var e=this.resources,n=function(t){cc.loader.load(e,function(e,t,n){var s=n/t*100|0;s=Math.min(Math.round(s),100),this.needPercent=s,this.rewrite()}.bind(this),function(e){e?(t++,this.onLoadError&&this.onLoadError(e,t),t<10&&n(t)):(this.needPercent=100,this.cb&&this.cb.call(this.target))}.bind(this))}.bind(this);n(0)},_updateTransform:function(){this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty),this._logo&&this._logo._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty),this._bar&&this._bar._renderCmd.setDirtyFlag(
cc.Node._dirtyFlags.transformDirty),this._background&&this._background._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.transformDirty)},closeAction:function(){}});LoaderScene.showCanvas=function(){document.getElementById("gameCanvas").style.left="0",document.getElementById("gameCanvas").style.top="0",void 0!==cleverapps&&cleverapps.canvasTop&&(document.getElementById("Cocos2dGameContainer").style["margin-top"]=cleverapps.canvasTop),document.getElementById("cocosLoading")&&document.body.removeChild(document.getElementById("cocosLoading"))},LoaderScene.getLoadingText=function(){if(cleverapps.isInstant())return"";var e={en:"Loading",ru:"",ja:"",zh:"",es:"cargando",de:"Wird geladen",pt:"Carregando",it:"Caricamento in corso",ar:" ",ko:" ",tr:"Ykleniyor",nl:"bezig met laden",fr:"chargement"};return(e[cleverapps.settings.language]||e.en)+"..."},cleverapps.styles.LoadingScene={barBg:{y:80,scale9:{width:400,height:19,padding:0}},bar:{x:0,y:0,scale9:{width:400,
height:19,minWidth:30,padding:0}},message:{x:0,y:30},animations:[]};var VictoryWindowBase=Window.extend({createAddbutton:function(e,t,n){var s=[];switch(e){case GameBase.REWARD_CLOVER:s=["x2@100","x2@200","x2@300","x3@300","+10[=]"];break;case GameBase.REWARD_PIGGY_BANK:break;case GameBase.REWARD_EXP:s=["x2@100","x2@200","x2@300","+1[=]"];break;case GameBase.REWARD_GOLD:s=["+50[=]"],cleverapps.flags.reduceAds&&(s=["+10[=]"]);break;case GameBase.REWARD_BOOSTER:s="match3"===cleverapps.config.type?["x3@200","x2@100"]:["x3@300","x3@400","x2@100","x2@150"]}var i=cleverapps.Random.choose(s.filter(function(e){return!(-1!==e.indexOf("[=]")&&!cleverapps.rewardedAdsManager.isAvailable(RewardedAdsManager.REWARDED))&&(-1===e.indexOf("x2")&&-1===e.indexOf("x3")||0!==t)}));if(i){var o=new RewardBuyButton({window:this,game:this.game,type:e,config:i,onRemove:n});return o&&(o.setPositionRound(cleverapps.styles.VictoryWindowBase.rewards.button),this.rewardBuyButtons.push(o)),o}},listChanges:function(){
return[new VictoryChestChange({level:this.level,stars:this.starChestChange,oldChestStars:this.oldChestStars}),new LanternChange({level:this.level,lantern:Lantern.Get()}),new TournamentBookChange({game:this.game}),new RaffleChange({level:this.level})].filter(function(e){return e.isActive()})},runChanges:function(e){this.runAction(new cc.Sequence(new cc.DelayTime(cleverapps.styles.VictoryWindowBase.changes.delay),new cc.CallFunc(function(){e.forEach(function(e){e.createView(this).animateChange(e.calculateDelta())},this)}.bind(this))))},createRewardsBlock:function(){var c=cleverapps.styles.VictoryWindowBase.rewards;this.rewardViews={},this.rewardBuyButtons=[],this.game.collectedBoosterCell&&cleverapps.eventLogger.logEvent(cleverapps.EVENTS.BOOSTER_CELL_RECEIVED),void 0!==this.game.rewards[GameBase.REWARD_CLOVER]&&(!this.game.gameMission||this.game.gameMission&&!this.game.gameMission.isRunning())&&delete this.game.rewards[GameBase.REWARD_CLOVER];var l=function(e,t){t&&t.showUp&&(
e.visible=!1,e.runAction(new cc.Sequence(new cc.DelayTime(t.showUp.delay),new cc.CallFunc(function(){e.scale=0,e.visible=!0}),new cc.ScaleTo(t.showUp.duration,e.baseScale||e.baseScaleX,e.baseScale||e.baseScaleY).easing(t.easing||cc.easeBackOut()))))},e=Object.keys(this.game.rewards).filter(function(e){return e!==GameBase.REWARD_BACKGROUND_CLOVER});3<e.length&&(e=e.filter(function(e){return e!==GameBase.REWARD_PIGGY_BANK}));var t=e.map(function(e){var t,n,s=this.game.rewards[e],i=this.rewardViews[e]=this.getRewardBackground(e),o=i.button=this.createAddbutton(e,s,function(){c.twoLinePrize.icon&&t.setPositionRound(c.twoLinePrize.icon),c.twoLinePrize.amount&&n.setPositionRound(c.twoLinePrize.amount)});t=i.icon=this.getRewardIcon(e),i.addChild(t),t.setPositionRound(c.icon),e===GameBase.REWARD_EXP&&c.Exp&&c.Exp.position&&t.setPositionRound(c.Exp.position.x,c.Exp.position.y),!o&&c.twoLinePrize.icon&&t.setPositionRound(c.twoLinePrize.icon),
e===GameBase.REWARD_PIGGY_BANK&&c.Piggy&&t.setPositionRound(c.Piggy),t.show&&"function"==typeof t.show&&t.show(),i.baseScale=i.scale,l(i,c.bg),t.baseScaleX=t.scaleX,t.baseScaleY=t.scaleY,l(t,c.icon);var r,a=s;return e===GameBase.REWARD_PIGGY_BANK&&cleverapps.piggyBank.isFull()&&(a="messages:VictoryWindowBase.piggyBankFull"),n=i.amount=cleverapps.UI.generateTTFText(a,cleverapps.styles.FONTS.REWARDS_TEXT),i.addChild(n),n.setPositionRound(c.amount),!o&&c.twoLinePrize.amount&&n.setPositionRound(c.twoLinePrize.amount),n.baseScale=n.scale,l(n,c.amount),o&&(i.addChild(o),cleverapps.UI.onClick(i,o.createListener(function(){o.action()})),o.baseScale=o.scale,l(o,c.button)),c.container?((r=new cc.Node).setAnchorPoint2(),r.setContentSize2(c.container),i.setPositionRound(c.container),r.addChild(i)):r=i,r}.bind(this));if(0!==t.length){this.existRewards=!0;var n=new cleverapps.Layout(t,{direction:cleverapps.UI.HORIZONTAL,margin:c.prizesMargin,padding:c.prizesPadding});if(n.setLocalZOrder(2),
!1===c.title)return n;var s=[cleverapps.UI.generateTTFText("messages:VictoryWindowBase.rewards",cleverapps.styles.FONTS.VICTORY_REWARDS_TITLE_TEXT||cleverapps.styles.FONTS.WINDOW_SMALL_TEXT)];bundles.victorywindow.frames.level_victory_reward_line&&(s.unshift(new cc.Sprite(bundles.victorywindow.frames.level_victory_reward_line)),s.push(new cc.Sprite(bundles.victorywindow.frames.level_victory_reward_line)));var i=new cleverapps.Layout(s,{direction:cleverapps.UI.HORIZONTAL,margin:c.margin});return new cleverapps.Layout([n,i],{direction:cleverapps.UI.VERTICAL,margin:c.margin,padding:c.padding})}if(c.noRewards){var o=cleverapps.UI.generateTTFText("messages:VictoryWindow.rewardsAhead",cleverapps.styles.FONTS.VICTORY_NO_REWARDS_TEXT||cleverapps.styles.FONTS.WINDOW_SMALL_TEXT);return o.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER),o.setDimensions(c.noRewards.width,0),o}},getRewardBackground:function(e){var t,n=cleverapps.styles.VictoryWindowBase.rewards;if(
bundles.victorywindow.jsons.level_victory_reward_bg_json)return(t=new cleverapps.Spine(bundles.victorywindow.jsons.level_victory_reward_bg_json)).setAnchorPoint2(),t.setContentSize2(cleverapps.styles.VictoryWindowBase.rewards.bg),t.setVisible(!1),n.bg&&n.bg.animation&&t.setAnimation(0,n.bg.animation,!0),t;if(bundles.victorywindow.frames.level_victory_reward_bg)return n.bg.scale9?((t=new cc.Scale9Sprite(bundles.victorywindow.frames.level_victory_reward_bg)).setContentSize2(n.bg),t):new cc.Sprite(bundles.victorywindow.frames.level_victory_reward_bg);switch(e){case GameBase.REWARD_CLOVER:return new cc.Sprite(bundles.victorywindow.frames.level_victory_reward_bg1);case GameBase.REWARD_PIGGY_BANK:return new cc.Sprite(bundles.victorywindow.frames.level_victory_reward_bg2);case GameBase.REWARD_EXP:return new cc.Sprite(bundles.victorywindow.frames.level_victory_reward_bg3);case GameBase.REWARD_GOLD:return new cc.Sprite(bundles.victorywindow.frames.level_victory_reward_bg1)
;case GameBase.REWARD_BOOSTER:return new cc.Sprite(bundles.victorywindow.frames.level_victory_reward_bg2)}},getCloverVictoryAnimation:function(){var e=this.mission.getIcon(),t=new cc.Sprite(e);return t.setScale(cleverapps.styles.VictoryWindowBase.rewards.Clover.scale),t},getGoldVictoryAnimation:function(){var e=new cc.Sprite(bundles.menubar.frames.coin_png);return e.setScale(cleverapps.styles.VictoryWindowBase.rewards.Coin.scale),e},getRewardIcon:function(e){var t=cleverapps.styles.VictoryWindowBase.rewards;switch(e){case GameBase.REWARD_CLOVER:return this.getCloverVictoryAnimation();case GameBase.REWARD_PIGGY_BANK:return new PiggyBankVictoryAnimation;case GameBase.REWARD_EXP:var n=new cc.Sprite(bundles.menubar.frames.exp_png);return n.setScale(t.Exp.scale),n;case GameBase.REWARD_GOLD:return this.getGoldVictoryAnimation();case GameBase.REWARD_BOOSTER:var s=new cc.Node;s.setAnchorPoint2(),s.setContentSize2(t.Booster);var i=BoosterCellView.prototype.getImage(
this.game.collectedBoosterCell);return s.addChild(i),i.setPosition(s.width/2,s.height/2),void 0!==t.Booster.scaleX?s.setScale(t.Booster.scaleX,t.Booster.scaleY):s.setScale(t.Booster.scale),t.Booster.animationName&&cleverapps.settings.fpsMode!==cleverapps.Settings.FPS_MODE_LOW&&i.setAnimation(0,t.Booster.animationName,!0),s}},addButtons:function(){var e=[],t=new VictoryWindowButton({level:this.level,oldStars:this.oldStars,oldStoryStage:this.oldStoryStage,boatswain:this.boatswain,onPressed:this.close.bind(this)});if(e.push(t),this.level.isRegular()||this.level.episode.isDailyCup()){var n=this.getShareBonus(),s={window:this,shareBonus:n,toReplace:{}};this.game.level.episode.isDailyCup()?s.toReplace.stars=this.game.getDailyCupStars():(s.score=void 0!==this.score?this.score:cleverapps.userresult.getScoresForLevel(this.level.episode.episodeNo,this.level.levelNo),s.level=this.level);var i=ShareBonusButton.create(s);i&&e.push(i)}return e},getShareBonus:function(){
return this.game.level.episode.isDailyCup()?cleverapps.ShareBonus.SHARES.dailyCup:cleverapps.ShareBonus.SHARES.victory},getShareOptions:function(){var e=this.getShareBonus(),t={levelNo:this.level.episodeNo*Episode.LEVELS_PER_EPISODE+this.level.levelNo+1};if(void 0!==this.score?t.score=this.score:t.score=cleverapps.userresult.getScoresForLevel(this.level.episode.episodeNo,this.level.levelNo),this.game.level.episode.isDailyCup()){var n=this.game.getDailyCupStars(),s=n;"match3"===cleverapps.config.type&&(s=Messages.get("Share.DailyCup.stars"+n)),t={stars:s}}return{shareId:e.id,toReplace:t}},animateReward:function(e,t){var n=this.rewardViews[e];if(n){var s=n.icon;n.amount.setString(this.game.rewards[e]);var i=n.amount.scale;n.amount.runAction(new cc.Sequence(new cc.ScaleTo(.2,1.2*i),new cc.Sequence(new cc.ScaleTo(.2,i)))),cleverapps.UI.animateDelta(t,{x:n.amount.x,y:n.amount.y+cleverapps.styles.VictoryWindowBase.rewards.button.animation.dy,parent:n,
font:cleverapps.styles.FONTS.VICTORY_WINDOW_REWARD_DELTA});var o=this.convertToNodeSpace(s.getParent().convertToWorldSpace(s.getPosition()));e===GameBase.REWARD_CLOVER&&MissionAnimationView.show(this.game.getMissionType(),this,{amount:Math.min(t,15),beginPos:o,victory:!0})}},listBundles:function(e){var t=["victorywindow","starchest_window"],n=cleverapps.missionManager.getRunningMission(Missions.SEMAPHORE_RAFFLE);return n&&n.isRunning()&&n.raffle.needVictoryShow(e.level)&&t.push("raffle_victory"),Lantern.IsActive(e.level)&&t.push("lantern"),e.game.rewards[GameBase.REWARD_PIGGY_BANK]&&t.push("piggybank_window"),t}});cleverapps.styles.VictoryWindowBase={rewards:{margin:30,prizesMargin:0,prizesPadding:{x:0,y:0},padding:{x:0,y:0},icon:{x:{align:"center"},y:{align:"center",dy:54}},amount:{x:{align:"center"},y:{align:"center",dy:-6}},button:{x:{align:"center"},y:{align:"bottom",dy:4},animation:{dy:-30}},Exp:{scale:1},twoLinePrize:{},Coin:{scale:1},Booster:{width:100,height:100,scale:1},
Clover:{scale:.9},bg:{scale9:!1}},changes:{delay:0},share:{margin:{x:20}}};var VictoryFriendView=cc.Node.extend({ctor:function(e,t){this._super(),this.setAnchorPoint(.5,.5),this.place=t;var n=new cleverapps.UI.Avatar(e);this.addChild(n),this.avatar=n,this.setContentSize(n.width*n.scale,n.height*n.scale),n.setPositionRound(this.width/2,n.height/2)},showAnimation:function(){var e=1*(.5+this.place/4);this.scale=0,this.stopAllActions(),this.runAction(new cc.Sequence(new cc.DelayTime(e+.25),new cc.ScaleTo(.25,1)))}}),VictoryWindow=VictoryWindowBase.extend({onWindowLoaded:function(e){this.game=e.game,this.boatswain=e.boatswain,this.rewarded=this.game.rewards[GameBase.REWARD_GOLD],this.game.gameMission&&(this.mission=this.game.gameMission),this.level=e.level;var t=cleverapps.styles.VictoryWindow;this.createContent(),this.addRewardBlock(),cleverapps.isRumble()&&!cleverapps.config.adminMode&&(this.addRoundResults(),this.addRoundCountDown()),this.level.episode.isBonusRound(
)&&t.bonusRound&&this.addBonusRoundAnimation(),this.level.episode.isDailyCup()&&t.dailyCup&&this.addDailyCupAnimation(),t.confetti&&this.addConfettiAnimation(),cleverapps.isRumble()&&!cleverapps.config.adminMode&&this.addHero();var n={};this.game.rewards[GameBase.REWARD_BACKGROUND_CLOVER]&&(-1!==["solitaire","differences"].indexOf(cleverapps.config.type)||0<=["scramble","wordsoup","crocword","magicwords"].indexOf(cleverapps.config.name))&&(n.shovels=this.game.rewards[GameBase.REWARD_BACKGROUND_CLOVER]),cleverapps.metha.getType()===Metha.SIMPLE&&this.level.isRegular()&&"magicwords"!==cleverapps.config.name&&(n.stars=cleverapps.simple.amountLevelStars(this.level)),0<Object.keys(n).length&&this.addChild(new MedallionComponent(n)),this.game.rewards[GameBase.REWARD_BACKGROUND_CLOVER]&&TreasureSearchRewardComponent.IsAvailable()&&new TreasureSearchRewardComponent(this.content);var s,i,o=cleverapps.overrideStyles(cleverapps.styles.Window,cleverapps.styles.VictoryWindow.window,!0)
;cleverapps.isRumble()||(s=this.addButtons(),i=this.getShareOptions()),this._super({name:"victorywindow",content:this.content,noBackground:t.noBackground,buttons:s,shareCheckBox:i,title:this.getTextTitle(),styles:o,windowBg:e.windowBg,closeButton:!this.game.round,notCloseByTouchInShadow:this.game.round,onClose:function(){VictoryWindowHero.hero&&(VictoryWindowHero.hero.hide(),delete VictoryWindowHero.hero)}}),cleverapps.metha.getType()===Metha.FARM?this.addProvidedKey():cleverapps.isKnockoutGame()&&!this.level.episode.isDailyLevel()||this.addAnimatedTitle();var r=cleverapps.styles.VictoryWindow.rewardBlock.padding||0;this.rewardBlock&&this.rewardBlock.width*this.rewardBlock.scale+r>this.window.width&&this.rewardBlock.setScale(this.window.width/(this.rewardBlock.width+r)),this.addInviteBlock(),this.runChanges(this.listChanges()),cleverapps.metha.getType()!==Metha.HOMEFIX&&"magicwords"!==cleverapps.config.name||!this.level.isRegular()||this.window.addChild(this.flyStarAnimation()),
this.game.round?cleverapps.audio.playSound(bundles.game.urls.round_win_effect):(setTimeout(function(){cleverapps.audio.playSound(bundles.game.urls.win_effect),cleverapps.audio.playSound(bundles.game.urls.win_effect_2)},t.soundDelay?t.soundDelay:0),bundles.game.urls.victory_looped_effect&&this.runAction(new cc.Sequence(new cc.DelayTime(2),new cc.CallFunc(function(){this.runAction(new cc.RepeatForever(new cc.Sequence(new cc.CallFunc(function(){cleverapps.audio.playSound(bundles.game.urls.victory_looped_effect)}),new cc.DelayTime(4))))}.bind(this)))))},getTextTitle:function(){if("tripeaks"===cleverapps.config.name)return"messages:VICTORY"},createContent:function(){var e=cleverapps.styles.VictoryWindow,t=cc.size(e.width,e.height);this.level.episode.isDailyCup()&&e.dailyCup&&(t=e.dailyCup),this.content=new cc.Node,this.content.setAnchorPoint2(),this.content.setContentSize(t)},flyStarAnimation:function(){var e=cleverapps.styles.VictoryWindow.flyStar,t=new cc.Node;t.setAnchorPoint2(),
t.setPositionRound(e.position),t.setContentSize2(e);var n=this.level.isHard()&&e.animation_hard?e.animation_hard:"animation",s=this.level.isHard()&&e.idle_hard?e.idle_hard:"idle",i=new cleverapps.Spine(bundles.victorywindow.jsons.victory_star);if(i.setAnimation(0,n,!1),i.addAnimation(0,s,!0),i.setPosition(t.width/2,t.height/2),t.addChild(i),t.setLocalZOrder(10),this.level.isHard()&&e.text){var o=cleverapps.UI.generateTTFText("x3",cleverapps.styles.FONTS.VICTORY_STAR_AMOUNT_TEXT||cleverapps.styles.FONTS.WINDOW_TEXT);t.addChild(o),o.setPositionRound(e.text),o.setScale(0),o.runAction(new cc.Sequence(new cc.DelayTime(2.4),new cc.ScaleTo(.4,1).easing(new cc.easeBackOut)))}return t},addRoundResults:function(){var e=new RoundResultsComponent(this.game);e.setPositionRound(cleverapps.styles.VictoryWindow.roundResultsComponent),this.content.addChild(e)},addRoundCountDown:function(){this.roundCountdown=new RoundCountdownComponent(function(){this.hero.hide(),this.runAction(new cc.Sequence(
new cc.DelayTime(.5),new cc.CallFunc(this.close.bind(this))))}.bind(this)),this.roundCountdown.setPositionRound(cleverapps.styles.VictoryWindow.roundCountdownComponent),this.content.addChild(this.roundCountdown)},addHero:function(){this.hero=new VictoryWindowHero,this.addChild(this.hero),this.hero.show()},addBonusRoundAnimation:function(){var e=cleverapps.styles.VictoryWindow,t=new cc.Node;t.setAnchorPoint2(),t.setContentSize2(e.bonusRound),this.content.addChild(t),t.setPositionRound(e.bonusRound);var n=new cleverapps.Spine(bundles.hero.jsons.hero_json);t.addChild(n),n.setAnimation(0,"bonus",!0),n.setPositionRound(t.width/2,t.height/2)},addDailyCupAnimation:function(){var e=cleverapps.styles.VictoryWindow,t=new cc.Sprite(bundles.sidebar.frames.daily_cup_icon);this.content.addChild(t),t.setPositionRound(e.dailyCup)},addProvidedKey:function(){if(cleverapps.farm&&cleverapps.farm.providedKey){var e=ProvidesComponent({key:cleverapps.farm.providedKey,victory:!0,
noLabel:cleverapps.styles.VictoryWindow.providesComponent.noLabel});e.setPositionRound(cleverapps.styles.VictoryWindow.providesComponent),this.content.addChild(e)}},addAnimatedTitle:function(){if(bundles.victorywindow.jsons.victory_json){var e=cleverapps.styles.VictoryWindow.title,t=new cleverapps.Spine(bundles.victorywindow.jsons.victory_json),n=t.data.animations["open_"+cleverapps.settings.language]&&"open_"+cleverapps.settings.language||"open",s=t.data.animations["idle_"+cleverapps.settings.language]&&"idle_"+cleverapps.settings.language||"idle";if(t.setAnimationAndIdleAfter(n,s),t.setPositionRound(this.content.width/2,e.y),this.content.addChild(t),e.text){var i=this.titleText=cleverapps.UI.generateTTFText(e.text.message,e.text.font);i.setPositionRound(0,e.text.y),t.addChild(i)}return t}},addRewardBlock:function(){var e=cleverapps.styles.VictoryWindow;this.rewardBlock=this.createRewardsBlock(),this.rewardBlock&&(this.content.addChild(this.rewardBlock),
e.rewardBlock.scale&&this.rewardBlock.setScale(e.rewardBlock.scale),this.rewardBlock.setPositionRound(this.content.width/2,e.rewardBlock.y))},addConfettiAnimation:function(){var e=cleverapps.styles.VictoryWindow.confetti;if(e){var t=new cleverapps.Spine(e.spine_json);t.setAnimation(0,e.animation,!1),t.setPositionRound(e.position),this.content.addChild(t)}},onShow:function(){this.buttons&&this.buttons.onShow(),this.placeText&&(this.placeText.scale=0,this.placeText.stopAllActions(),this.placeText.runAction(new cc.Sequence(new cc.DelayTime(.3),new cc.ScaleTo(.3,1).easing(cc.easeBackOut()))),this.rewardBlock&&(this.rewardBlock.opacity=0,this.rewardBlock.stopAllActions(),this.rewardBlock.runAction(new cc.Sequence(new cc.DelayTime(.7),new cc.FadeIn(.2))))),this.roundCountdown&&this.roundCountdown.resumeCountdown()},addReward:function(e){if(this.rewardViews[GameBase.REWARD_GOLD]){var t=this.rewardViews[GameBase.REWARD_GOLD].amount,n=parseInt(t.getString())+e,
s=cleverapps.styles.VictoryWindow.rewardBlock.text.format.replace("%{amount}",n);t.setString(s);var i=this.rewardViews[GameBase.REWARD_GOLD].scale;return this.rewardViews[GameBase.REWARD_GOLD].runAction(new cc.Sequence(new cc.ScaleTo(.2,1.2*i),new cc.Sequence(new cc.ScaleTo(.2,i)))),!0}},addInviteBlock:function(){InviteComponent({parent:this})}});cleverapps.styles.VictoryWindow={width:400,height:200,noBackground:!1,providesComponent:{noLabel:!1,x:{align:"center"},y:{align:"top",dy:0}},title:{y:520},rewardBlock:{y:400,x:0,margin:0,text:{y:8,format:"+%{amount}"},coin:{scale:1}},share:{margin:10},window:{decors:{}}};var LoseWindow=Window.extend({onWindowLoaded:function(e,t){this.replayCallback=e||function(){},this.level=t.level;var n=cleverapps.styles.LoseWindow,s=this.createContent(),i=n.button.tryAgain,o=cleverapps.overrideStyles(cleverapps.clone(cleverapps.styles.Window,!0),cleverapps.styles.LoseWindow),r=cleverapps.once(function(){this.replayCallback(),this.close()}.bind(this))
;this._super({name:"losewindow",content:s,title:n.title,noBackground:n.noBackground,styles:o,button:{text:i?Messages.get("TryAgain"):Messages.get("OK"),width:n.button.width,height:n.button.height,onPressed:function(){if(i&&cleverapps.lives.isEmpty()){var e=new LivesShopWindow;cleverapps.lives.onChangeAmountListeners["losewindow.TryAgain"]=e.createListener(r)}else r()}.bind(this)}}),cleverapps.lives.onChangeAmountListeners.losewindow=this.createListener(this.updateWindow.bind(this)),cleverapps.audio.playSound(bundles.main.urls.window_effect);new HardLevelDecorationComponent({parent:this});this.runAction(new cc.Sequence(new cc.DelayTime(.45),new cc.CallFunc(function(){cleverapps.audio.playSound(bundles.game.urls.lose_window_effect)})))},createAnimationNode:function(){var e=cleverapps.styles.LoseWindow,t=new cc.Node;t.setAnchorPoint2();var n=this.animation=cleverapps.UI.createAnimation(this.getAnimationStyles());return t.setContentSize2(e.animation.width,e.animation.height),
n.setPositionRound(t.width/2+e.animation.x,t.height/2+e.animation.y),t.addChild(n),t},getAnimationStyles:function(){return cleverapps.styles.LoseWindow.animation},createLivesLeftBlock:function(){var e,t=cleverapps.styles.LoseWindow,n=[],s=cleverapps.styles.FONTS.LOSE_WINDOW_TEXT||cleverapps.styles.FONTS.WINDOW_TEXT;if(cleverapps.tempGoods.checkGoodBuyed(cleverapps.TempGoods.UNLIMITED_LIVES))e=cleverapps.UI.generateTTFText("messages:LoseWindow.livesLeftUnlimited",s);else{e=cleverapps.UI.generateTTFText("messages:LoseWindow.livesLeft",s);for(var i=[],o=0;o<cleverapps.Lives.MAX_REGEN_AMOUNT;o++)if(o===cleverapps.lives.amount){var r=new cc.Sprite(t.lives.icon).getContentSize(),a=new cc.Node;a.setAnchorPoint2(),a.setContentSize2(r);var c=cleverapps.UI.createAnimation(t.lives.animation);a.addChild(c),c.setPositionRound(a.width/2,a.height/2),i.push(a)}else{var l=o<cleverapps.lives.amount?t.lives.icon:t.lives.icon_empty,p=new cc.Sprite(l);i.push(p)}var d=this.heartsNode=new cleverapps.Layout(i
,{direction:cleverapps.UI.HORIZONTAL,margin:t.heartsMargin});n.push(d)}return e.setAnchorPoint2(),n.push(e),new cleverapps.Layout(n,{direction:cleverapps.UI.VERTICAL,margin:t.lifesLeftMargin})},createContent:function(){var e=cleverapps.styles.LoseWindow,t=[],n=this.createAnimationNode();return t.push(n),this.livesLeftBlock=this.createLivesLeftBlock(),this.livesLeftBlock&&t.push(this.livesLeftBlock),new cleverapps.Layout(t.reverse(),{direction:cleverapps.UI.VERTICAL,margin:e.content.margin,y:e.content.y,padding:{x:e.content.padding.x,y:e.content.padding.y}})},updateWindow:function(){if(this.heartsNode){for(var e=[],t=cleverapps.styles.LoseWindow,n=0;n<cleverapps.Lives.MAX_REGEN_AMOUNT;n++){var s=n<cleverapps.lives.amount?t.lives.icon:t.lives.icon_empty,i=new cc.Sprite(s);e.push(i)}var o=new cleverapps.Layout(e,{direction:cleverapps.UI.HORIZONTAL,margin:t.heartsMargin});this.livesLeftBlock.addChild(o),o.setPositionRound(this.heartsNode.getPosition()),this.heartsNode.removeFromParent(),
this.heartsNode=o}}});LoseWindow.prototype.listBundles=function(){return["lose_window"]},cleverapps.styles.LoseWindow={width:650,height:550,title:"messages:LoseWindow.title",heartsMargin:5,lifesLeftMargin:15,content:{margin:40,y:25,padding:{x:0,y:10}},animation:{width:650,height:320,x:0,y:0,spine:{json:bundles.lose_window.jsons.lose_json,openAnimation:"open",idleAnimation:"idle"}},lives:{animation:{spine:{json:bundles.main.jsons.level_failed_small_hearts_json,openAnimation:"animation"}},icon:bundles.main.frames.level_failed_heart_png,icon_empty:bundles.main.frames.level_failed_heart_empty_png},button:{width:300,height:100,offset:{x:170},tryAgain:!0},adsButton:{width:350,icon:{scale:.8,x:30,y:40},text:{x:185,y:40}},decors:{}};var LevelStartWindow=Window.extend({onWindowLoaded:function(e){this.level=e.level,this.stars=this.level.stars,BoostersBefore.isAvailable()&&(this.boostersBefore=new BoostersBefore(e),cleverapps.metha.showControlsWhileFocused("MenuBarGoldItem")),
this.isHardLevel=this.level.isHard()&&!this.level.episode.isDailyLevel();var t=cleverapps.overrideStyles(cleverapps.styles.Window,cleverapps.styles.LevelStartWindow,!0);e.styles&&(t=cleverapps.overrideStyles(t,e.styles)),this.isHardLevel&&(t=cleverapps.overrideStyles(t,cleverapps.styles.HardLevelStartWindow)),this.level.isTricky()&&(t=cleverapps.overrideStyles(t,cleverapps.styles.TrickyLevelStartWindow));var n=new cleverapps.Layout(this.listContent(),{direction:cleverapps.UI.VERTICAL,margin:t.margin}),s=cleverapps.UI.wrapWithPadding(n,{x:0,y:t.padding});e.replay&&(this.onClose=function(){cleverapps.metha.distract({focus:"LevelReplayFromLevelStartWindow",action:function(e){this.level.play(e,{boostersBefore:this.boostersBefore})}.bind(this)})}.bind(this)),this._super({title:this.getTitle(),name:"levelstartwindow",content:s,button:this.getButton(),styles:t,level:this.level}),"board"!==cleverapps.config.type&&"tripeaks"!==cleverapps.config.name&&HighScoresComponent({parent:this,
level:this.level}),new HardLevelDecorationComponent({parent:this}),cleverapps.audio.playSound(bundles.main.urls.window_effect),this.boostersBefore&&this.boostersBefore.showTutorialStep()},showBetForce:function(){if(!cleverapps.forces.isShown(Forces.METHA_PLAY_BUTTON.id)){var e=cleverapps.forces.create(this.button,Forces.METHA_PLAY_BUTTON);this.registerCleanupCallback(function(){cleverapps.forces.isRunningForce(e)&&cleverapps.forces.closeRunningForce()})}},getTitle:function(){var e=cleverapps.styles.FONTS.LEVEL_WINDOW_TITLE;!this.level.episode.isDailyCup()&&this.isHardLevel&&cleverapps.styles.FONTS.HARD_LEVEL_TITLE&&(e=cleverapps.styles.FONTS.HARD_LEVEL_TITLE),this.isHardLevel&&cleverapps.styles.FONTS.BOOSTER_BEFORE_HARD_LEVEL_TITLE&&(e=cleverapps.styles.FONTS.BOOSTER_BEFORE_HARD_LEVEL_TITLE);var t="";return this.level.isRegular()&&(t=cleverapps.metha.getType()!==Metha.HOSE||this.level.isCurrentLevel()?cleverapps.user.getVirtualDisplayLevel():this.level.getHumanReadableNumber()),{
text:this.getTitleText(),font:e,toReplace:{levelNo:t}}},getTitleText:function(){return this.level.episode.isDailyCup()?"messages:DailyCup.title":this.isHardLevel?"messages:message.hardLevel":this.level.isTricky()?"messages:message.trickyLevel":this.level.episode.isDailyLevel()?"messages:DailyLevelWindow.title":cleverapps.user.isPassedAll()&&cleverapps.metha.getType()===Metha.HOSE&&this.level.isCurrentLevel()?"messages:LevelStartWindow.ComingSoonTitle":"messages:LevelStartWindow.title"},getButton:function(){var e=bundles.buttons_main.frames.play_button_png,t=bundles.buttons_main.frames.play_button_on_png;this.isHardLevel&&(e=bundles.buttons_main.frames.play_button_hard_png,t=bundles.buttons_main.frames.play_button_hard_on_png),this.level.isTricky()&&(e=bundles.buttons_main.frames.play_button_tricky_png,t=bundles.buttons_main.frames.play_button_tricky_on_png);var n=cleverapps.once(function(){cleverapps.metha.distract({focus:"LevelStartFromLevelStartWindow",action:function(e){
this.onClose=function(){},this.close(),this.level.play(e,{boostersBefore:this.boostersBefore})}.bind(this)})}.bind(this)),s={width:cleverapps.styles.LevelStartWindow.Button.width,height:cleverapps.styles.LevelStartWindow.Button.height,button_png:e,button_on_png:t,padding:cleverapps.styles.LevelStartWindow.Button.padding,onPressed:function(){cleverapps.lives&&cleverapps.lives.isEmpty()?new LivesShopWindow:n()}.bind(this)};return s.text=Messages.get("Play").toUpperCase(),s.font=cleverapps.styles.FONTS.LEVEL_START_PLAY_BUTTON_TEXT,s},listContent:function(){var e=[];if(this.boostersBefore){var t=new BoostersBeforeComponent(this.boostersBefore,this.level);e.push(t)}if(cleverapps.styles.ScoreComponent.enabled&&this.level.isRegular()){var n=ScoreComponent({level:this.level,victory:!1});n&&e.push(n)}if(this.showStarsComponent()){var s=StarsComponent({level:this.level,stars:this.stars,victory:!1});e.push(s)}return e},showStarsComponent:function(){
return cleverapps.config.results&&this.level.isRegular()}});LevelStartWindow.isAvailable=function(e,t){return("board"!==cleverapps.config.type||"stacks"===cleverapps.config.subtype)&&"differences"!==cleverapps.config.name&&((0!==e||0!==t)&&("stacks"===cleverapps.config.subtype?!cleverapps.GameSaver.load(GameBase.getStoreKey(e,t))&&BoostersBefore.isAvailable():"solitaire"!==cleverapps.config.type||BoostersBefore.isAvailable()))},LevelStartWindow.prototype.listBundles=function(e){var t=[];return BoostersBefore.isAvailable()&&0<Lantern.GetStreak(e.level)&&t.push("lantern"),t},cleverapps.styles.LevelStartWindow={padding:50,Button:{width:300,height:100},margin:0,betPrice:{text:{font:cleverapps.styles.FONTS.BIG_BUTTON_TEXT},label:{offsetY:3},icon:{scale:1,image:bundles.menubar.frames.coin_png,offsetY:13}}},cleverapps.styles.HardLevelStartWindow={},cleverapps.styles.TrickyLevelStartWindow={};var ProductPriceView=cc.Node.extend({ctor:function(e,t){this._super(),this.options=t||{},
this.setCascadeOpacityEnabled(!0),this.setAnchorPoint2(),this.createContent(e)},createContent:function(e){var t,n=cleverapps.styles.ProductPriceView,s=this.options,i=s.text||e.getCurrentPrice(),o=this.options.icon,r=!1;if("string"==typeof i){var a=i.indexOf(" OK");-1!==a&&(i=i.substr(0,a),o=bundles.main.frames.ok_icon_png,r=!0)}if(t=cleverapps.UI.ImageFont.IsApplicable(this.options.font,i)?this.createImageText(i):this.createRegularText(i),this.content=this.text=t,o){var c=new cc.Sprite(o);c.setScale(s.iconScale||n.icon.scale);var l=[c,t];r&&l.reverse(),this.content=new cleverapps.Layout(l,{direction:cleverapps.UI.HORIZONTAL,margin:n.icon.margin}),this.content.setCascadeOpacityEnabled(!0)}if(this.setContentSize2(this.content.width,this.content.height),o&&cleverapps.UI.fitToBox(this,{width:s.fitTo&&s.fitTo.width||this.width,height:s.fitTo&&s.fitTo.height||this.height}),this.content.setAnchorPoint2(),this.content.setPositionRound(this.width/2,this.height/2),this.addChild(this.content),
s.bg){var p=new cc.Scale9Sprite(s.bg.image);p.setLocalZOrder(-1),p.setContentSize2(this.width+2*s.bg.padding.x,this.height+2*s.bg.padding.y),p.setPositionRound(s.bg),this.content.addChild(p)}},createRegularText:function(e){var t=cleverapps.styles.ProductPriceView,n=cleverapps.UI.generateOnlyText(e,this.options.font);this.options.fitTo&&n.fitTo(this.options.fitTo.width,this.options.fitTo.height);var s=new cc.Node;return s.setContentSize2(n.getContentSize()),s.setAnchorPoint2(),s.addChild(n),s.setCascadeOpacityEnabled(!0),n.setPositionRound(s.width/2,s.height/2+t.regularFontOffsetY),s},createImageText:function(e){return cleverapps.UI.generateImageText(e,this.options.font)},setString:function(e){this.content&&(this.content.removeFromParent(!0),delete this.content),this.createContent(e)}});cleverapps.styles.ProductPriceView={regularFontOffsetY:0,icon:{margin:14,scale:.8}};var ShopUserGoldView=cc.Node.extend({ctor:function(e){this._super(),this.settings=e||{},this.setLocalZOrder(22),
this.setAnchorPoint2(),cc.director.getRunningScene().scene.addChild(this)},updateContent:function(){this.content&&this.content.removeFromParent(),this.createContent();var e=cleverapps.UI.getSceneSize(),t=cleverapps.styles.ShopUserGoldView.position[cleverapps.wideMode.mode].y;for(this.setPosition(e.width/2,this.height/2+t);this.width*this.scale>=e.width;)this.setScale(.95*this.getScale())},createContent:function(){var e=cleverapps.styles.ShopUserGoldView,t=[this.createGoldBlock()];"match3"===cleverapps.config.type?t.unshift(this.createBoostersBlock()):BoostersBefore.isAvailable({ignoreProgress:!0})&&t.unshift(this.createBoostersBeforeBlock()),e.direction===cleverapps.UI.HORIZONTAL&&t.reverse();var n=this.textNode=new cleverapps.Layout(t.filter(function(e){return void 0!==e}),{direction:e.direction,margin:e.textNode.margin});n.setCascadeOpacityEnabled(!0);var s=[this.createPerson(),n];this.settings.mirrorPerson&&s.reverse(),this.content=new cleverapps.Layout(s.filter(function(e){
return void 0!==e}),{direction:cleverapps.UI.HORIZONTAL,margin:e.margin}),this.createBg(),this.setContentSize(this.content.getContentSize()),this.addChild(this.content),this.content.setPosition(this.width/2,this.height/2)},createGoldBlock:function(){var e=cleverapps.styles.ShopUserGoldView,t=cleverapps.UI.generateOnlyText("messages:YouHaveAmount",cleverapps.styles.FONTS.SHOP_USER_GOLD_TEXT),n=this.createItem(levels.user.gold,e.items.gold.res,e.items.gold),s=new cleverapps.Layout([t,n],{direction:cleverapps.UI.HORIZONTAL,margin:e.textNode.goldItemsMargin});return n.y+=e.items.gold.blockDy,s.setCascadeOpacityEnabled(!0),s},createBoostersBlock:function(){var n=cleverapps.styles.ShopUserGoldView,s=[];[0,1,2].forEach(function(e){if(levels.user.checkAvailable(BaseBooster.AVAILABLE[e])){var t=this.createItem(cleverapps.boostersCounter.data[e],n.items.boosters.res[e],n.items.boosters);s.push(t)}}.bind(this));var e=new cleverapps.Layout(s,{direction:cleverapps.UI.HORIZONTAL,
margin:n.textNode.boostersItemsMargin});return e.setCascadeOpacityEnabled(!0),e},createItem:function(e,t,n){var s=cleverapps.styles.ShopUserGoldView,i=cleverapps.UI.generateImageText(cleverapps.formatAmount(e),cleverapps.styles.FONTS.SHOP_USER_GOLD_TEXT),o=new cc.Sprite(t);o.setScale(n.scale),o.y+=n.dy||0;var r=new cleverapps.Layout([i,o],{direction:cleverapps.UI.HORIZONTAL,margin:s.items.margin});return r.setCascadeOpacityEnabled(!0),r},createBoostersBeforeBlock:function(){var t=cleverapps.styles.ShopUserGoldView.items.boostersBefore,e=BoostersBefore.GetAppropriateTypes().map(function(e){return this.createItem(cleverapps.boostersCounter.data[e]||0,BoostersBeforeConfig[e].icon,t)},this),n=new cleverapps.Layout(e,{direction:cleverapps.UI.HORIZONTAL,margin:t.itemsMargin});return n.setCascadeOpacityEnabled(!0),n},createPerson:function(){var e=cleverapps.styles.ShopUserGoldView.person;if(e&&(!e.visibility||!1!==e.visibility[cleverapps.wideMode.mode])){var t=this.person=new cc.Node
;t.setAnchorPoint2(),t.setContentSize(e);var n=new cleverapps.Spine(e.json);return n.setAnimation(0,"animation",!0),n.setPosition(t.width/2,t.height/2),t.addChild(n),t.setScale(e.scale||1),t.y+=e.dy,t.setScaleX(this.settings.mirrorPerson?-t.scaleX:t.scaleX),t}},createBg:function(){var e=cleverapps.styles.ShopUserGoldView.bg;if(e)if(this.bg)this.bg.setContentSize(this.textNode.width+e.padding.x,this.textNode.height+e.padding.y),this.bg.setPositionRound(this.textNode.x+e.dx,this.textNode.y);else{var t=this.bg=cleverapps.UI.createScale9Sprite(e.image);t.setContentSize(this.textNode.width+e.padding.x,e.fixedHeight||this.textNode.height+e.padding.y),this.addChild(t,-1),t.setPositionRound(this.textNode.x+e.dx,this.textNode.y)}},showUp:function(){this.updateContent(),this.setVisible(!0),this.runShowUpAnimation()},runShowUpAnimation:function(){if(this.bg&&this.bg.setOpacity(0),this.textNode.setOpacity(0),this.runAction(new cc.Sequence(new cc.DelayTime(.5),new cc.CallFunc(function(){
this.bg&&this.bg.runAction(new cc.FadeIn(.6)),this.textNode.runAction(new cc.FadeIn(.6))},this))),this.person){var e=this.person.getPosition();this.person.y=1.2*-this.person.height,this.person.runAction(new cc.Sequence(new cc.DelayTime(.5),new cc.MoveTo(.5,e).easing(cc.easeBackOut())))}},onHide:function(){this.setVisible(!1)},close:function(){this.person&&this.person.runAction(new cc.ScaleTo(.2,0).easing(cc.easeBackIn())),this.bg&&this.bg.runAction(new cc.FadeOut(.4)),this.textNode.runAction(new cc.FadeOut(.4)),this.runAction(new cc.Sequence(new cc.DelayTime(.4),new cc.RemoveSelf))},listNodeBundles:function(){return["tile_shop","shop_user_gold_view"]}});ShopUserGoldView.IsAvailable=function(){return BoostersBefore.isAvailable({ignoreProgress:!0})},cleverapps.overrideFonts(cleverapps.styles.FONTS,{SHOP_USER_GOLD_TEXT:{color:cleverapps.styles.COLORS.WHITE,size:30}}),cleverapps.styles.ShopUserGoldView={margin:60,position:[{y:-20},{y:40},{y:40}],direction:cleverapps.UI.VERTICAL,textNode:{
margin:10,goldItemsMargin:10,boostersItemsMargin:15},bg:{image:bundles.shop_user_gold_view.frames.shopusergold_bg_png,dx:-20,padding:{x:60,y:25}},person:{json:bundles.shop_user_gold_view.jsons.yellow_money_spine_json,scale:.85,width:250,height:250,dy:-10},items:{margin:5,gold:{res:bundles.reward_icons.frames.gold_small_png,scale:.75,blockDy:0,dy:5},boosters:{res:[bundles.reward_icons.frames.cellbooster_small,bundles.reward_icons.frames.linebooster_small,bundles.reward_icons.frames.colorbooster_small],scale:1,dy:5},boostersBefore:{itemsMargin:15,scale:.45}}};var ShopWindow=Window.extend({ctor:function(e){if(this.options=e=e||{},this.tab=e.tab,this.tab===ShopWindow.TABS.HARD_CURRENCY&&cleverapps.flags.nopayments&&!RewardedAdsManager.IsEnabled())return!1;cleverapps.eventLogger.logEvent(cleverapps.EVENTS.TILE_SHOP_OPEN+this.tab),this._super.apply(this,arguments)},customize:function(){if(this._super(),!ShopUserGoldView.IsAvailable()||this.showAll&&this.isVertical()||(
this.goldInfo=new ShopUserGoldView(cleverapps.styles.ShopWindow.ShopUserGoldView)),bundles.tile_shop.frames.shop_bg_png){var e=new cc.Scale9Sprite(bundles.tile_shop.frames.shop_bg_png);e.setContentSize2(this.getContentSize()),this.addChild(e),e.setLocalZOrder(-1),e.setOpacity(180),e.setPositionRound(this.width/2,this.height/2)}Lottery.addText(this)},onWindowLoaded:function(e){this.showAll=this.options.showAll;var t=cleverapps.styles.ShopWindow;if(this._super({notCloseByTouchInShadow:!0,name:"shopwindow_tab"+this.tab,content:this.createContent(this.tab),title:this.getTitle(),noBackground:t.noBackground,styles:t}),this.tab===ShopWindow.TABS.LIVES&&t.Title.livesOffsetY&&(this.window.titleText.y+=t.Title.livesOffsetY,this.titleBg&&(this.titleBg.y+=t.Title.livesOffsetY)),t.repeatablePattern){var n=new RepeatablePattern(this.width,t.repeatablePattern.image);this.addChild(n),n.setLocalZOrder(-1)}cleverapps.eventBus.on("changeSceneSize",this.onChangeSceneSizeShopWindow.bind(this),this),
cleverapps.audio.playSound(bundles.main.urls.window_effect)},getTitle:function(){if(!this.showAll||!this.isVertical())return{text:"messages:ShopWindow.title",font:cleverapps.styles.FONTS.TILE_SHOP_WINDOW_TITLE_TEXT}},onHide:function(){this.goldInfo&&this.goldInfo.onHide(),this.hidden=!0},buyProduct:function(e){this.closingNow||this.hidden||e.buy(this.close.bind(this,!0))},expandShop:function(){this.closingNow||(new ShopWindow({showAll:!0,tab:ShopWindow.TABS.HARD_CURRENCY}),this.close())},isVertical:function(){return cleverapps.wideMode.mode===cleverapps.WideMode.VERTICAL},adjustShopWindow:function(){this.content.scale=this.content.baseScale;var e=cleverapps.styles.ShopWindow;!this.isVertical()&&this.showAll||this.content.setScale(Math.min(this.content.scale,cc.director.getWinSize().width/(this.content.width+2*e.wrap.paddingX))),this.isVertical()&&this.showAll||this.content.setScale(Math.min(this.content.scale,cc.director.getWinSize().height/(this.content.height+2*e.wrap.paddingY)))
;var t=0;this.isVertical()||(t=e.wrap.offsetX),this.contentWrap.setContentSize2(this.content.width*this.content.scale+t,this.content.height*this.content.scale),this.content.setPositionRound(this.contentWrap.width/2,this.contentWrap.height/2),cleverapps.styles.ShopWindow.contentOffset<0&&(this.contentWrap.height-=cleverapps.styles.ShopWindow.contentOffset,this.content.y-=cleverapps.styles.ShopWindow.contentOffset)},onChangeSceneSizeShopWindow:function(){this.adjustShopWindow(),this.scroll.setContentSize2(cc.director.getWinSize()),this.scroll.setPositionRound(this.contentWrap.width/2,this.contentWrap.height/2),this.scrollWrap.setContentSize2(this.contentWrap.getContentSize())},createContent:function(e){var t=this.isVertical()?TileLayout.Layouts.vertical:TileLayout.Layouts.horizontal,n=(this.showAll?t.expanded:t.compact).map(function(e){return new TileLayout(e)}),s=ShopProductSource.listTileModels(e),i=s.tileModels,o=s.optional,r=this.buyProduct.bind(this),a=this.expandShop.bind(this),
c=LayoutAdjuster.createTiles(i,r,a);this.shopLayout=LayoutAdjuster.ChooseLayout(c,n,o);var l=this.content=this.shopLayout.positionTiles();l.baseScale=l.scale;var p=this.contentWrap=new cc.Node;p.setAnchorPoint2(),p.addChild(l),this.adjustShopWindow();var d=this.scroll=new cleverapps.UI.ScrollView(p,{direction:this.isVertical()?cleverapps.UI.ScrollView.DIR_VERTICAL:cleverapps.UI.ScrollView.DIR_HORIZONTAL,clipping:!1});d.setContentSize2(cc.director.getWinSize()),this.shopLayout.scrollToBadge(this.scroll);var u=this.scrollWrap=new cc.Node;return u.setAnchorPoint2(),u.setContentSize2(Math.min(d.width,p.width),p.height),u.addChild(d),d.setPositionRound({align:"center"},{align:"center"}),u},onShow:function(e){this.goldInfo&&this.goldInfo.showUp(),this.hidden=void 0,this.shopLayout.onShow(e)},onClose:function(){cleverapps.windows.isActive()||(this.tab===ShopWindow.TABS.LIVES&&cleverapps.lives&&cleverapps.lives.isEmpty()?HelpFromFriendsWindow.showIfCan(HelpFromFriendsWindow.TYPES.addlivesvideo
,function(e,t){cleverapps.lives.give(t.amount)}.bind(this)):this.tab===ShopWindow.TABS.HARD_CURRENCY&&levels.user.gold<100&&HelpFromFriendsWindow.showIfCan(HelpFromFriendsWindow.TYPES.addcoinsvideo,function(e,t){levels.user.setGold(levels.user.gold+t.amount)}.bind(this))),this.tab===ShopWindow.TABS.LIVES&&cleverapps.lives&&(cleverapps.lives.needShowSpecialOffer=!0)},close:function(e){if(!this.closingNow){this.goldInfo&&this.goldInfo.close(),this.closingNow=!0;var t=this._super;if(!0===e)t.call(this);else{var n=cleverapps.styles.ShopWindow;if(this.closeButton instanceof BandButton&&this.closeButton.hide(),this.scrollBarBG&&this.scrollBarBG.runAction(new cc.FadeOut(.3)),this.window.titleText&&n.noBackground){var s=cc.p(this.window.titleText.x,cc.director.getWinSize().height+this.window.titleText.height/2),i=cc.p(this.window.titleText.x,this.window.titleText.y-n.title.hideAnimation.moveDownY);this.window.titleText.runAction(new cc.Sequence(new cc.MoveTo(.15,i),new cc.MoveTo(.3,s).easing(
cc.easeIn(1)))),this.titleBg&&this.titleBg.runAction(new cc.Sequence(new cc.MoveTo(.15,i),new cc.MoveTo(.3,s).easing(cc.easeIn(1))))}this.shopLayout.onClose(t.bind(this))}}}}),LivesShopWindow=ShopWindow.extend({ctor:function(){this._super({tab:ShopWindow.TABS.LIVES})}}),SoftCurrencyShopWindow=ShopWindow.extend({ctor:function(){this._super({tab:ShopWindow.TABS.SOFT_CURRENCY})}}),HardCurrencyShopWindow=ShopWindow.extend({ctor:function(){this._super({tab:ShopWindow.TABS.HARD_CURRENCY})}});ShopWindow.prototype.listBundles=function(){return["tile_shop","shop_user_gold_view"]},ShopWindow.TABS={HARD_CURRENCY:0,LIVES:1,SOFT_CURRENCY:2},cleverapps.styles.ShopWindow=cleverapps.overrideStyles(cleverapps.styles.Window,{noWindowScale:!0,noBackground:!0,contentOffset:-30,contentPadding:30,scroll:{delay:0,offset:{y:-50}},scrollBarBG:{height:24,paddingX:20,y:20},wrap:{paddingX:30,paddingY:110,offsetX:100},title:{hideAnimation:{moveDownY:30}},Title:{offsetY:-20},rowMargin:30,tileMargin:30,rowsPadding:{
x:0,y:50},mouseScrollSpeed:400},!0),cleverapps.overrideStyles(cleverapps.styles.DECORATORS,{TILE_SHOP_BADGE_STROKE:{color:new cc.Color(100,34,22,255),size:2},TILE_BUTTON_SHADOW:{color:new cc.Color(8,82,40,180),direction:cc.size(0,-5),blur:1},TILE_SHOP_SHADOW:{color:new cc.Color(100,34,22,200),direction:cc.size(0,-3),blur:1},TILE_SHOP_STROKE:{color:new cc.Color(100,34,22,255),size:3}}),cleverapps.overrideFonts(cleverapps.styles.FONTS,{TILE_SHOP_BADGE_TEXT:{size:45,color:cleverapps.styles.COLORS.WHITE,shadow:cleverapps.styles.DECORATORS.TILE_SHOP_SHADOW,stroke:cleverapps.styles.DECORATORS.TILE_SHOP_BADGE_STROKE},SHOP_SMALL_TILE_BUTTON_TEXT:{size:55,color:cleverapps.styles.COLORS.WHITE,shadow:cleverapps.styles.DECORATORS.TILE_BUTTON_SHADOW},SHOP_LARGE_TILE_BUTTON_TEXT:{size:45,color:cleverapps.styles.COLORS.WHITE,shadow:cleverapps.styles.DECORATORS.TILE_BUTTON_SHADOW},TILE_SHOP_WINDOW_TEXT:{size:50,color:cleverapps.styles.COLORS.WHITE,shadow:cleverapps.styles.DECORATORS.TILE_SHOP_SHADOW,
stroke:cleverapps.styles.DECORATORS.TILE_SHOP_STROKE},TILE_SHOP_WINDOW_TITLE_TEXT:{size:80,color:cleverapps.styles.COLORS.WHITE,stroke:{color:new cc.color(85,1,91),size:3},shadow:{color:new cc.color(85,1,91),direction:cc.size(0,-5),blur:1}}});var TileBadge=cc.Sprite.extend({ctor:function(e,t){var n=t?cleverapps.styles.SmallTileBadge:cleverapps.styles.LargeTileBadge,s={bestSeller:{image:bundles.tile_shop.frames.shop_badge_bestseller_png,text:"messages:Badge.bestSeller"},save:{image:bundles.tile_shop.frames.shop_badge_save_png||bundles.tile_shop.frames.shop_badge_bestseller_png,text:"messages:Badge.save"}};if(e=this.options="string"==typeof e?s[e]:e,this._super(e.image),this.setPositionRound(e.x||n.x,e.y||n.y),this.setLocalZOrder(2),t&&n.scale&&this.setScale(n.scale),this.baseScale=this.getScale(),e.text&&e.amount){var i=new cleverapps.Layout([cleverapps.UI.generateOnlyText(e.text,cleverapps.styles.FONTS.TILE_SHOP_BADGE_TEXT),cleverapps.UI.generateOnlyText(e.amount,
cleverapps.styles.FONTS.TILE_SHOP_BADGE_AMOUNT_TEXT)],{direction:cleverapps.UI.VERTICAL,margin:e.margin,padding:e.padding});cleverapps.UI.fitToBox(i,{width:this.width,height:this.height}),i.setAnchorPoint2(),i.setPositionRound(this.width/2,this.height/2),this.addChild(i)}else e.text&&((i=cleverapps.UI.generateOnlyText(e.text,cleverapps.styles.FONTS.TILE_SHOP_BADGE_TEXT)).setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER),i.fitTo(n.text.width),i.setRotation(n.text.rotation),this.addChild(i),i.setPositionRound(this.width/2+n.text.x,this.height/2+n.text.y))},enable:function(){this.setSpriteFrame(this.options.image)},disable:function(){this.setSpriteFrame(this.options.imageOff||this.options.image)}});cleverapps.overrideFonts(cleverapps.styles.FONTS,{TILE_SHOP_BADGE_TEXT:{size:25,color:cleverapps.styles.COLORS.WHITE,stroke:cleverapps.styles.DECORATORS.TILE_SHOP_BADGE_STROKE},TILE_SHOP_BADGE_AMOUNT_TEXT:{size:34,color:cleverapps.styles.COLORS.WHITE,
stroke:cleverapps.styles.DECORATORS.TILE_SHOP_BADGE_STROKE}}),cleverapps.styles.SmallTileBadge={x:{align:"right",dx:30},y:{align:"top",dy:-10},text:{rotation:30,width:125,x:5,y:10}},cleverapps.styles.LargeTileBadge={x:{align:"left",dx:-30},y:{align:"top",dy:30},text:{rotation:-30,width:125,x:0,y:5}};var TileButton=cc.Node.extend({ctor:function(e,t,n){this._super(),this.small=t;var s=this.small?cleverapps.styles.SmallTileButton:cleverapps.styles.LargeTileButton;this.buttonWidth=n.width||s.width;var i=this.button=new cleverapps.UI.Button({content:this.getButtonContent(e,n),contentOff:this.getButtonContent(e,n,!0),contentPadding:s.contentPadding,contentOffset:s.contentOffset,scale9Rect:n.scale9Rect,width:this.buttonWidth,height:n.height||s.height,button_png:n.button_png||(t?bundles.tile_shop.frames.small_shop_button:bundles.tile_shop.frames.feature_button_png),button_on_png:n.button_on_png||(t?bundles.tile_shop.frames.small_shop_button_on:bundles.tile_shop.frames.feature_button_on_png),
button_off_png:n.button_off_png||(t?bundles.tile_shop.frames.small_shop_button_off:bundles.tile_shop.frames.feature_button_off_png),onClicked:n.onClicked.bind(n,e)});e.constructor===TileModel&&Lottery.addIcon(i,void 0,"gold25000"===e.product.itemId),this.setAnchorPoint2(),this.setContentSize2(i.getContentSize()),this.addChild(i),i.setPositionRound(s)},getButtonContent:function(e,t,n){var s=this.small?cleverapps.styles.SmallTileButton:cleverapps.styles.LargeTileButton,i=this.buttonWidth+s.text.padding;return new ProductPriceView(e,{font:t.font||(this.small?cleverapps.styles.FONTS.SHOP_SMALL_TILE_BUTTON_TEXT||cleverapps.styles.FONTS.BUTTON_TEXT:cleverapps.styles.FONTS.SHOP_LARGE_TILE_BUTTON_TEXT),fitTo:{width:i},text:n&&e.getDisabledPrice(),icon:!n&&e.getPriceIcon(),iconScale:!n&&e.getPriceIcon()&&(t.scale||s.icon.scale)})},enable:function(){this.button.enable()},disable:function(){this.button.disable()}});cleverapps.styles.SmallTileButton={x:{align:"center"},y:{align:"center"},
margin:10,width:205,height:70,text:{padding:-25,dy:-6},icon:{scale:.8,dy:0}},cleverapps.styles.LargeTileButton={x:{align:"center"},y:{align:"center",dy:-5},margin:10,width:320,height:110,text:{padding:-25,dy:-6},icon:{scale:.8,dy:0}};var TileIcon=cc.Node.extend({ctor:function(e,t,n,s){this._super();var i=t?cleverapps.styles.SmallTileIcon:cleverapps.styles.LargeTileIcon;this.tileModel=e;var o=this.icon=new cc.Sprite(bundles.tile_shop.frames[e.getIcon()]);if(!s)if(i.scale)o.setScale(i.scale);else if(i.height){var r=i.height/o.height;r<1&&o.setScale(r)}var a=t?{json:bundles.tile_shop.jsons.shop_sparkles_small_json}:{json:bundles.tile_shop.jsons.shop_sparkles_large_json};if(n&&(a=n),a.json){var c=new cleverapps.Spine(a.json);c.setPosition(o.width/2,o.height/2),o.addChild(c),c.visible=!1;var l=void 0!==a.delay?a.delay:Math.random();o.runAction(new cc.Sequence(new cc.DelayTime(l),new cc.CallFunc(function(){c.visible=!0,c.setAnimation(0,"animation",!0)})))}
var p=i[e.product.itemId]?i[e.product.itemId].wrap.dx||0:i.wrap.dx,d=i[e.product.itemId]?i[e.product.itemId].wrap.dy||0:i.wrap.dy;this.setContentSize2(o.width,i.wrap.height),this.setAnchorPoint2(),o.setAnchorPoint2(.5,0),o.setPositionRound(this.width/2+p,d),this.addChild(o)},enable:function(){this.icon.setSpriteFrame(bundles.tile_shop.frames[this.tileModel.getIcon()])},disable:function(){this.icon.setSpriteFrame(bundles.tile_shop.frames[this.tileModel.getIcon()+"_off"]||bundles.tile_shop.frames[this.tileModel.getIcon()])}});cleverapps.styles.SmallTileIcon={height:120,wrap:{height:110,dx:0,dy:0}},cleverapps.styles.LargeTileIcon={scale:1,wrap:{height:270,dx:0,dy:-24}};var TileRewardsBlock=function(e,t,n){n=n||{};var s=t?cleverapps.styles.SmallTileRewardsBlock:cleverapps.styles.LargeTileRewardsBlock,i=[],o=[],r="tripeaks"===cleverapps.config.name||"scramble"===cleverapps.config.name,a=t?cleverapps.styles.FONTS.TILE_SHOP_OFFER_TEXT_SMALL:cleverapps.styles.FONTS.TILE_SHOP_OFFER_TEXT_LARGE,
c=e.getReward();for(var l in c)if("boosters"===l)for(var p in c.boosters){if(0!==(g=c.boosters[p])){var d=cleverapps.UI.generateImageText("x"+g,a),u=new cleverapps.Layout([new cc.Sprite(s.boosterIcons[p]),d],{direction:cleverapps.UI.HORIZONTAL,margin:s.amountMargin});u.amount=d,o.push(u),i.push(u)}}else{var h=new cc.Sprite(s[l].icon);h.setScale(s[l].scale);var g=cleverapps.UI.generateImageText(c[l],r&&!t?cleverapps.styles.FONTS.TILE_SHOP_HIGHLIGHTED_IMAGE_TEXT:a),v=new cleverapps.Layout(s.reverse?[g,h]:[h,g],{direction:cleverapps.UI.HORIZONTAL,margin:s.amountMargin});v.amount=g,s[l].offsetY&&v.setPositionY(s[l].offsetY),s.iconOffsetY&&(h.y+=s.iconOffsetY),i.push(v)}for(var m=[];0<i.length;){var f=2;(0===m.length&&o.length<=2&&i.length-o.length<2||r)&&(r=!(f=1));var _=i.splice(0,f),y=new cleverapps.Layout(_,{direction:cleverapps.UI.HORIZONTAL,margin:s.colMargin});m.unshift(y)}var w=new cleverapps.Layout(m,{direction:cleverapps.UI.VERTICAL,margin:s.rowMargin,y:s.offsetY}),b=new cc.Node
;b.setAnchorPoint2(),s.noBg||n.noBg||(b=new cc.Scale9Sprite(t?bundles.tile_shop.frames.tile_stripe_png:bundles.tile_shop.frames.tile_best_stripe_png)),b.setContentSize2(s),b.setLocalZOrder(s.zOrder),b.addChild(w),w.setPositionRound(b.width/2,b.height/2);var T=s.height/w.height;return T<1&&2<m.length&&w.setScale(.85*T),b};cleverapps.overrideFonts(cleverapps.styles.FONTS,{TILE_SHOP_OFFER_TEXT_LARGE:{name:"default",size:33,color:cleverapps.styles.COLORS.COLOR_WINDOW_TEXT},TILE_SHOP_OFFER_TEXT_SMALL:{name:"default",size:37,color:cleverapps.styles.COLORS.COLOR_WINDOW_TEXT}}),cleverapps.styles.SmallTileRewardsBlock={rowMargin:10,colMargin:10,width:210,height:80,amountMargin:5,offsetY:0,zOrder:0,gold:{icon:bundles.reward_icons.frames.gold_small_png,scale:1},unlimitedLives:{scale:.5},stars:{scale:.4}},cleverapps.styles.LargeTileRewardsBlock={width:486,height:162,rowMargin:10,colMargin:10,amountMargin:5,offsetY:35,zOrder:0,gold:{icon:bundles.reward_icons.frames.gold_small_png,scale:1},coins:{
icon:bundles.reward_icons.frames.shop_coin_png,scale:1},unlimitedLives:{scale:.5},stars:{scale:.4}};var MoreTile=cc.Node.extend({ctor:function(e){if(this._super(),this.setAnchorPoint2(),bundles.tile_shop.frames.more_button_png){var t=this.createTile(e);this.addChild(t),this.setContentSize2(t.width,t.height),t.setPositionRound(this.width/2,this.height/2)}},createTile:function(e){var t=cleverapps.styles.MoreTile,n=cleverapps.UI.generateOnlyText("messages:ShopWindow.showMore",cleverapps.styles.FONTS.TILE_SHOP_WINDOW_TEXT);n.setDimensions(t.text.width,0),n.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER),n.fitTo(void 0,t.text.height);var s=new cc.Sprite(bundles.tile_shop.frames.more_button_png);cleverapps.UI.applyHover(s);var i=new cleverapps.Layout([s,n],{direction:cleverapps.UI.VERTICAL,margin:t.margin}),o=new cc.Scale9Sprite(bundles.tile_shop.frames.shop_tile_bg_png);return o.setContentSize2(t),o.addChild(i),i.setPositionRound(o.width/2,o.height/2+t.offset.y),o.setScale(
t.scale[cleverapps.wideMode.mode]),t.stitches&&new StitchesComponent(o,t.stitches),cleverapps.UI.onClick(o,e.onClicked,{swallowTouches:!1,ignoreOnTouchMoved:!0,useInteractiveScale:!0}),o}});cleverapps.styles.MoreTile={offset:{y:0},text:{width:150,height:200},scale:[1,1,1],width:240,height:350,margin:20};var LotteryIcon=cc.Sprite.extend({ctor:function(e,t,n){this._super();var s,i=this.styles=cleverapps.styles.LotteryIcon,o=cleverapps.eventManager.getFeatureEvent("lottery"),r=-1!==["mobile_ok","web_ok"].indexOf(cleverapps.User.calcSource())&&!1!==o.options.okLottery,a=r&&o.options.lottery10k&&n,c=-1!==["mobile_vk","web_vk"].indexOf(cleverapps.User.calcSource())&&o.options.vkSaleDay;r?i=cleverapps.overrideStyles(i,cleverapps.styles.OkLotteryIcon,!0):c&&(i=this.styles=cleverapps.overrideStyles(i,cleverapps.styles.VkLotteryIcon,!0)),c?(s=bundles.lottery.frames.vk_lottery,i=cleverapps.overrideStyles(i,cleverapps.styles.VkLotteryIcon,!0)):r?(
s=a?bundles.lottery.frames.ok_lottery_10k:bundles.lottery.frames.ok_lottery,i=cleverapps.overrideStyles(i,cleverapps.styles.OkLotteryIcon,!0)):s=bundles.lottery.frames["lottery_"+cleverapps.settings.language]||bundles.lottery.frames.lottery_en,this._super(s),e.addChild(this),t=t||"bottom",this.setScale(i.positions[t].scale||i.scale||1),this.baseScale=this.scale,this.setPositionRound(i.positions[t]),i.positions[t].preserveX&&(this.preservedX=this.x)}});cleverapps.styles.VkLotteryIcon={positions:{icon:{x:{align:"center",dx:-65},y:{align:"bottom",dy:-40},preserveX:!0},subscription:{x:{align:"left",dx:-10},y:{align:"bottom",dy:-40}}}},cleverapps.styles.OkLotteryIcon={},cleverapps.styles.LotteryIcon={positions:{bottom:{x:{align:"center",dx:0},y:{align:"bottom",dy:-70}},top:{x:{align:"center",dx:0},y:{align:"top",dy:55}},icon:{x:{align:"center",dx:0},y:{align:"bottom",dy:-20}},icon_top:{x:{align:"center",dx:0},y:{align:"top",dy:0}},subscription:{x:{align:"right",dx:45},y:{align:"top",dy:40}
},bottom_right:{x:{align:"right",dx:30},y:{align:"bottom",dy:-70}}}};var Lottery={isActive:function(){return cleverapps.eventManager.isActive("lottery")&&!cleverapps.flags.nopayments},addIcon:function(e,t,n){this.isActive()&&(e.lotteryIcon=new LotteryIcon(e,t,n)).runAction(new cc.RepeatForever(new cc.Sequence(new cc.DelayTime(3),new cc.RotateTo(.2,10),new cc.RotateTo(.2,-10),new cc.RotateTo(.2,10),new cc.RotateTo(.2,-10),new cc.RotateTo(.2,0))))},addText:function(e){if(this.isActive()){var t=cleverapps.styles.Lottery,n="messages:Lottery.info",s=cleverapps.eventManager.getFeatureEvent("lottery");-1!==["mobile_vk","web_vk"].indexOf(cleverapps.User.calcSource())&&s.options.vkSaleDay&&(n="messages:Lottery.infoSaleDay");var i=cleverapps.UI.generateTTFText(n,t.text.font);e.addChild(i),i.setPositionRound(t.text),i.fitTo(e.width)}}};cleverapps.styles.Lottery={text:{font:cleverapps.styles.FONTS.SMALL_WHITE_TEXT,x:{align:"center"},y:{align:"bottom",dy:5}}};var ShopProductSource={
listTileModels:function(t){var e,n=ShopProductSource.ITEMS[t],s=cleverapps.paymentsHistory.classify();t===ShopWindow.TABS.HARD_CURRENCY&&s>cleverapps.PaymentsHistory.PAYER_WEAK&&(n=ShopProductSource.ITEMS.CoinsPayer);var i=(n=n.filter(function(e){return t!==ShopWindow.TABS.HARD_CURRENCY||cleverapps.config.products[e]})).map(function(e){return TileModel.Create(Product.Create(e))}).filter(function(e){return e.isEnabled()});if(t===ShopWindow.TABS.HARD_CURRENCY){var o=0;for(i.forEach(function(e){e.getPrice&&e.getPrice()>o&&(o=e.getPrice())}),e=0;e<i.length;e++)if(i[e].getPrice()===o){i[e].badge="save";break}}var r=ShopProductSource.ITEMS.bestSellersByPayerClass[s];for(e=0;e<i.length;e++)if(-1!==r.indexOf(i[e].getItemId())){i[e].badge="bestSeller";break}var a=[];return t===ShopWindow.TABS.HARD_CURRENCY&&(a=ShopProductSource.ITEMS.optionalByPayerClass[s]),{tileModels:i,optional:a}},ITEMS:{CoinsPayer:["jamPack","tastyPack","honeyPack","epicPack","gold500","gold1800","gold3800","gold6000",
"gold25000"],optionalByPayerClass:[["gold25000","honeyPack","gold6000","tastyPack","gold3800"],["gold25000","honeyPack","gold6000","sweetPack","gold500"],["gold500","epicPack","gold25000","jamPack","gold1800"],["gold500","jamPack","tastyPack","gold1800","gold3800"],["gold500","jamPack","tastyPack","gold1800","gold3800"]],bestSellersByPayerClass:[["sweetPack","gold500"],["jamPack","gold1800"],["tastyPack","gold3800"],["honeyPack","gold6000"],["honeyPack","gold25000"]]}};ShopProductSource.ITEMS[ShopWindow.TABS.HARD_CURRENCY]=["sweetPack","jamPack","tastyPack","honeyPack","gold500","gold1800","gold3800","gold6000","gold25000"],ShopProductSource.ITEMS[ShopWindow.TABS.LIVES]=["refillLives","unlimitedLives","askLives"],ShopProductSource.ITEMS[ShopWindow.TABS.SOFT_CURRENCY]=["softCurrencySmall","softCurrencyMedium","softCurrencyLarge"],"merge"===cleverapps.config.type&&(ShopProductSource.ITEMS[ShopWindow.TABS.LIVES]=["energyLottery","buyEnergy350","buyEnergy700","buyEnergy","energyForVideo",
"energyForVideoShort"]);var LayoutAdjuster={ChooseLayout:function(t,e,n){for(var s=[],i=!1;!(0<(s=e.filter(function(e){return e.isEnough(t)})).length);)if(i=!0,!this.trimOptional(t.large,t.large.length-1,n)&&cleverapps.config.debugMode)throw"select layout error - large tiles";if(cleverapps.config.debugMode&&0===s.length)throw"select layout error";if(i&&t.small.push(t.more),this.trimOptional(t.small,s[0].countOfSmallTiles,n),t.small.length>s[0].countOfSmallTiles&&cleverapps.config.debugMode)throw console.log(s[0].map),console.log("small",t.small),"select layout error - small tiles";return s[0].setTiles(t),s[0]},createTiles:function(e,n,t){var s=e.map(function(e){var t=new(e.getViewClassName())(e,{onClicked:n});return"horizontal"===cleverapps.config.orientation&&cc.sys.isMobile&&(t.setScale(1.4),t.baseScale=1.4),t});return{small:s.filter(function(e){return e.isSmall()}),large:s.filter(function(e){return!e.isSmall()}),more:new MoreTile({onClicked:t})}},trimOptional:function(e,t,n){for(
var s=!1,i=0;i<n.length&&e.length>t;i++)for(var o=0;o<e.length;o++)if(e[o].tileModel&&e[o].tileModel.product.itemId===n[i]){e.splice(o,1),s=!0;break}return s}},TileLayout=function(e){this.largeTiles=0,this.amountInRowForLarge=0,this.amountInRightColumn=0,this.amountOfRightColumns=0,this.amountInBottomRow=0,this.amountOfBottomRows=0,this.countOfSmallTiles=0,(this.map=e).forEach(function(e){for(var t=0,n=0;n<e.length;n++){var s=e[n];if("x"===s)t++;else{var i=s.charCodeAt()-"A".charCodeAt();i+1>this.largeTiles&&(this.largeTiles=i+1)}}"x"===e[0]?(this.amountOfBottomRows++,this.amountInBottomRow=e.length):(this.amountInRowForLarge=e.length-t,0<t&&this.amountInRightColumn++,this.amountOfRightColumns=t),this.countOfSmallTiles+=t},this)};TileLayout.prototype.isEnough=function(e){return this.largeTiles===e.large.length},TileLayout.prototype.setTiles=function(e){this.tiles=e.large.concat(e.small),this.tileSet=e},TileLayout.prototype.onShow=function(e){for(var t=(e=e||0)+.075*Math.ceil(.5*(
this.tiles.length-1))+.5,n=this.tiles.length-1;0<=n;n--){var s=e+.075*Math.ceil(.5*n),i=this.tiles[n].scale;this.tiles[n].setScale(0);var o=this.tiles[n].tileBadge;o&&(o.setScale(0),o.runAction(new cc.Sequence(new cc.DelayTime(t),new cc.PlaySound(bundles.tile_shop.urls.badge_appear_effect),new cc.ScaleTo(.4,o.baseScale).easing(cc.easeBackOut())))),this.tiles[n].runAction(new cc.Sequence(new cc.DelayTime(s),new cc.ScaleTo(.4,i).easing(cc.easeBackOut())))}},TileLayout.prototype.onClose=function(e){for(var t=cleverapps.wait(this.tiles.length,e),n=this.tiles.length-1;0<=n;n--)this.tiles[n].runAction(new cc.Sequence(new cc.DelayTime(.075*Math.ceil(.5*n)),new cc.ScaleTo(.3,0).easing(cc.easeBackIn()),new cc.CallFunc(t.bind(this,n))))},TileLayout.prototype.scrollToBadge=function(e){var t=this.tiles.filter(function(e){return!(e instanceof MoreTile)&&e.tileModel.badge})[0];t&&e.scrollTo(t)},TileLayout.prototype.positionTiles=function(){for(var e=cleverapps.styles.ShopWindow,t=[],n=Math.ceil(
this.tileSet.small.length/this.amountInRightColumn),s=Math.min(n,this.amountOfRightColumns),i=this.tileSet.small.splice(0,s*this.amountInRightColumn),o=0;o<s;o++){for(var r=[],a=0;a<this.amountInRightColumn;a++)r.push(i[o+a*s]);t.push(new cleverapps.Layout(r,{direction:cleverapps.UI.TOP_TO_BOTTOM,margin:e.tileMargin}))}var c=[],l=this.tileSet.large.length/this.amountInRowForLarge;for(o=0;o<l;o++){var p=this.tileSet.large.splice(0,this.amountInRowForLarge);0===o&&0<t.length&&(p=p.concat(t)),c.push(new cleverapps.Layout(p,{direction:cleverapps.UI.HORIZONTAL,margin:e.tileMargin}))}var d=[];for(o=0;o<this.amountOfBottomRows;o++){r=this.tileSet.small.splice(0,this.amountInBottomRow);d.push(new cleverapps.Layout(r,{direction:cleverapps.UI.HORIZONTAL,margin:e.tileMargin}))}var u=c.concat(d);return new cleverapps.Layout(u,{direction:cleverapps.UI.TOP_TO_BOTTOM,margin:e.rowMargin,padding:e.rowsPadding})},TileLayout.Layouts={vertical:{compact:[["xx","xx"],["Ax","Ax","xx"],["AB","AB","xxx"]],
expanded:[["AB","AB","CD","CD","xx","xx"]]},horizontal:{compact:[["xx","xx"],["Axx","Axx"],["ABxx","ABxx"]],expanded:[["ABCDxx","ABCDxx"]]}},"merge"===cleverapps.config.type&&TileLayout.Layouts.horizontal.compact.push(["ABCx","ABCx"],["ABCD","ABCD"],["ABCDE","ABCDE"],["ABCDEF","ABCDEF"]);var Tabs=cleverapps.Layout.extend({ctor:function(n,s){this.buttons={};var e=cleverapps.styles.Tabs,t=Object.keys(n).map(function(e,t){return this.createButton(e,n[e],-(t+1),s)},this);this._super(t,{direction:void 0===s.direction?e.direction:s.direction,margin:void 0===s.margin?e.margin:s.margin,attention:s.attention})},createButton:function(e,t,n,s){var i,o=cleverapps.styles.Tabs.buttons,r=s.width||o.width,a=s.height||o.height;t.text&&(s.direction===cleverapps.UI.HORIZONTAL?i=cleverapps.UI.generateOnlyText(t.text,t.font||cleverapps.styles.FONTS.TABS_TEXT):(i=cleverapps.UI.generateOnlyText(Messages.get(t.text).split("").join("\n"),t.font||cleverapps.styles.FONTS.TABS_TEXT)).fitTo(.9*r,.9*a)),t.icon&&(
i=new cc.Sprite(t.icon)).setScale(t.scale||1);var c=this.buttons[e]=new cleverapps.UI.Button({button_png:bundles.main.frames.shop_tab_off,button_on_png:bundles.main.frames.shop_tab_off,button_off_png:bundles.main.frames.shop_tab_on,scale9Rect:s.scale9Rect,width:r,height:a,content:i,click_effect:bundles.main.urls.tab_click_effect,mirrorX:t.mirrorX,onClicked:this.activateTab.bind(this,e),useInteractiveScale:!0});return c.selectedScale=1.03,c.baseZOrder=n,c.info=t,c.setLocalZOrder(n),i.setPositionRound(o),c},getActive:function(){return this.selectedId},activateTab:function(t,n){t=t.toString(),this.selectedId!==t&&Object.keys(this.buttons).forEach(function(e){e===t?this.onSelectTab(e,n):this.onUnSelectTab(e)},this)},onSelectTab:function(e,t){var n=this.buttons[e],s=n.info;n.disable(),n.setLocalZOrder(1),n.selected=!0,n.applyInteractiveScale(),s.updateTitle&&s.updateTitle(),s.text&&n.content.setColor(cleverapps.styles.COLORS.TAB_TEXT_COLOR),s.icon&&n.content.setOpacity(255),
void 0===s.content&&(s.content=s.generator()),s.content.setVisible(!0),s.content.onSelectTab&&s.content.onSelectTab(t),this.selectedId=e},onUnSelectTab:function(e){var t=this.buttons[e],n=t.info;t.enable(),t.setLocalZOrder(t.baseZOrder),t.selected=!1,t.applyInteractiveScale(),n.text&&t.content.setColor(cleverapps.styles.COLORS.DISABLED_TAB_TEXT_COLOR),n.icon&&t.content.setOpacity(127),void 0!==n.content&&(n.content.setVisible(!1),n.content.stopAllActions(),n.content.onUnSelectTab&&n.content.onUnSelectTab())},setAttention:function(e,t){var n=cleverapps.styles.Tabs.attention,s=this.buttons[e];s.attention&&(s.attention.removeFromParent(),delete s.attention),t&&(s.attention=new cc.Sprite(bundles.windows.frames.tab_attention),s.attention.setAnchorPoint2(),s.attention.setPositionRound(this.options.attention||n),s.addChild(s.attention),s.attention.runAction(new cc.RepeatForever(new cc.Sequence(new cc.ScaleTo(.3,1.1),new cc.ScaleTo(.3,1)))))}});cleverapps.overrideColors(
cleverapps.styles.COLORS,{TAB_TEXT_COLOR:new cc.Color(255,255,255,255),DISABLED_TAB_TEXT_COLOR:new cc.Color(200,200,200,255)}),cleverapps.overrideFonts(cleverapps.styles.FONTS,{TABS_TEXT:{size:40}}),cleverapps.styles.Tabs={margin:0,direction:cleverapps.UI.HORIZONTAL,buttons:{x:{align:"center",dx:0},y:{align:"center",dy:0}},attention:{x:0,y:0}};var Buttons=cc.Node.extend({ctor:function(e){this._super(),0!==(e=Buttons.filter(e)).length&&(this.buttons={},e.forEach(function(e){this.buttons[e.__instanceId]=e,this.addChild(e)},this),this.arrange())},onEnterTransitionDidFinish:function(){this._super(),this.arrange()},arrange:function(){var e=cleverapps.styles.Buttons,t=e.margin.x,n=0;if(1<this.children.length&&this.parent){var s=this.parent.width-2*e.padding.x,i=0;this.children.forEach(function(e){i+=e.width,n=Math.max(n,e.height/2)});var o=Math.round((s-i)/(this.children.length-1));t=Math.max(t,o)}this.margin=t,cleverapps.UI.arrangeWithMargins(this.children,{
direction:cleverapps.UI.HORIZONTAL,margin:t,y:n}),cleverapps.UI.wrap(this),this.setAnchorPoint2()},add:function(e){0!==Buttons.filter([e]).length&&(this.buttons[e.__instanceId]=e,this.addChild(e),this.arrange())},remove:function(t){cleverapps.styles.Buttons;(t=this.buttons[t.__instanceId])&&(t.stopAllActions(),t.runAction(new cc.Sequence(new cc.ScaleTo(.3,0),new cc.RemoveSelf)),this.children.forEach(function(e){e.x>t.x&&(e.stopAllActions(),e.runAction(new cc.Sequence(new cc.DelayTime(.3),new cc.MoveBy(.3,-t.width-this.margin,0))))}),this.stopAllActions(),this.runAction(new cc.Sequence(new cc.DelayTime(.3),new cc.MoveBy(.3,(t.width+this.margin)/2,0))))},onShow:function(){this.children.forEach(function(e){e.stopAllActions();var t=e.scale;e.setScale(0),e.runAction(new cc.ScaleTo(.7,t).easing(new cc.easeBackOut))})}});Buttons.filter=function(e){return e.filter(function(e){return e&&e.onMouseOver})},Buttons.choose=function(e){if(0!==(e=Buttons.filter(e)).length)return e[Math.floor(
Math.random()*e.length)]},Buttons.remove=function(e){if(e.parent instanceof Buttons&&e.parent.buttons[e.__instanceId]){var t=e.parent;1<t.children.length&&t.remove(e)}else e.removeFromParent()},cleverapps.styles.Buttons={margin:{x:20},padding:{x:70}};var RewardBuyButton=cleverapps.UI.Button.extend({ctor:function(e){var t=e.type,n=e.game,s=e.config,i=e.window,o=parseInt(s);-1!==s.indexOf("x2")?o="x2":-1!==s.indexOf("x3")&&(o="x3");var r=this.type=-1!==s.indexOf(RewardBuyButton.VIDEO)?RewardBuyButton.VIDEO:RewardBuyButton.COINS,a=RewardBuyButton.VIDEO===r,c="";r===RewardBuyButton.COINS&&(c=this.price=parseInt(s.substr(s.indexOf(RewardBuyButton.COINS)+RewardBuyButton.COINS.length)));var l=o;"x2"===o&&(l=n.rewards[t]),"x3"===o&&(l=2*n.rewards[t]);var p=cleverapps.styles.RewardBuyButton,d=o;"number"==typeof o&&(d="+"+o);var u=[];if(d){var h=this.text=cleverapps.UI.generateImageText(d,cleverapps.styles.FONTS.GAME_REWARD_BUTTON_TEXT);u.push(h)}var g=new cc.Sprite(
a?bundles.shared.frames.adicon_png:bundles.menubar.frames.coin_png);if(g.setScale(p.icon.scale),u.push(g),c){var v=cleverapps.UI.generateImageText(c,cleverapps.styles.FONTS.GAME_REWARD_BUTTON_TEXT);u.push(v)}var m=new cleverapps.Layout(u,{direction:p.direction,margin:p.margin});g.y+=p.icon.offsetY;var f=this.createListener(function(){n.rewards[t]+=l,cleverapps.eventLogger.logEvent(cleverapps.EVENTS.REWARD_BUY+"_"+t+"_"+(a?"video":"buy")),e.window&&e.window.animateReward&&e.window.animateReward(t,l),Buttons.remove(this),e.onRemove&&e.onRemove(),cleverapps.isRumble()&&i.roundCountdown.resumeCountdown()}.bind(this));this._super({width:p.width,height:p.height,button_png:p.button_png,button_on_png:p.button_on_png,content:m,contentOffset:p.contentOffset,contentPadding:0,onClicked:this.createListener(function(){a?(cleverapps.isRumble()&&i.roundCountdown.pauseCountdown(),cleverapps.rewardedAdsManager.play(RewardedAdsManager.REWARDED,f)):n.canPayReward(t)&&(levels.user.takeGold(c)?(
cleverapps.audio.playSound(bundles.main.urls.shop_buy_effect),f()):cleverapps.isRumble()&&i.roundCountdown.pauseCountdown())}.bind(this))})}});RewardBuyButton.VIDEO="[=]",RewardBuyButton.COINS="@",cleverapps.styles.RewardBuyButton={width:144,height:54,margin:4,direction:cleverapps.UI.HORIZONTAL,button_png:bundles.buttons_main.frames.small_green_button,button_on_png:bundles.buttons_main.frames.small_green_button_on,icon:{scale:.5,offsetY:0}};var VictoryWindowButton=cleverapps.UI.Button.extend({ctor:function(e){var t=e.level,n=e.boatswain,s="OK",i=void 0;if(t.episode.isDailyLevel()&&!cleverapps.dailyLevel.isStartFromPortlet())i=n.DAILY_LEVEL_BACK_TO_MAIN;else{var o=cleverapps.Plot.decideNext(t);o===Boatswain.NEXT_INTENT?(s="Next",i=n.PLAY_NEXT):o===Boatswain.REPLAY_INTENT&&(s="Replay",i=n.REPLAY)}var r=cleverapps.styles.VictoryWindowButton;this._super({width:r.width,height:r.height,text:Messages.get(s).toUpperCase(),font:cleverapps.styles.FONTS.BUTTON_TEXT,onClicked:this.createListener(
function(){i&&(n.intent=i),e.onPressed()})});var a=this.width*this.getScaleX(),c=cleverapps.styles.VictoryWindowButton.titleOffset;a<c+this.text.width&&this.text.setScale(a/(c+this.text.width))}});cleverapps.styles.VictoryWindowButton={width:220,height:110,titleOffset:40};var SettingsWindow=Window.extend({onWindowLoaded:function(){var e=[];e.push({label:void 0,view:this.addSoundIcons()});var t=cleverapps.User.calcSource();"undefined"!=typeof match3&&cc.sys.os!==cc.sys.OS_IOS&&e.push({label:"messages:SettingsWindow.Effects",view:this.addEffectButton()});var n="tripeaks"===cleverapps.config.name;if(1<cleverapps.Settings.getAvailableLanguages().length&&("merge"===cleverapps.config.type||!cleverapps.environment.isGameScene())&&e.push({label:n?"messages:Language":void 0,view:this.addLanguages()}),!cleverapps.social.isLoggedIn()&&-1===["mobile_vk","web_vk","plinga","huzcom","pliega"].indexOf(t)){var s=cleverapps.social.isInitialized(
)?"messages:SignIn":"messages:FBLoginOrInvite.Button.Connecting";e.push({label:n?s:void 0,view:this.createLoginButtons()})}(cleverapps.social.nativeInviteFriends||cleverapps.social.isLoggedIn()&&!cleverapps.flags.noviral)&&e.push({label:n?"messages:FBLoginOrInvite.Button.Invite":void 0,view:this.createInviteButton()}),-1===["mbga","sp_mbga","plinga","huzcom","instant","amazon","pliega"].indexOf(t)&&e.push({label:n?"messages:Help":void 0,view:this.addHelpButton()}),"merge"!==cleverapps.config.type&&Game.currentGame||!Chat.IsAvailable()||e.push({label:n?"messages:SupportButton":void 0,view:this.addSupportButton()}),Game.currentGame&&void 0===Game.currentGame.outcome&&cleverapps.environment.isGameScene()&&"match3"===cleverapps.config.type&&e.push({label:void 0,view:this.addGiveUpButton()}),e.reverse();var i=cleverapps.styles.SettingsWindow,o=e.map(function(e){var t=e.view;if(e.label){if(i.Substrate)return this.singleLineWithSubstrate(t,e.label);var n=new cleverapps.UI.generateTTFText(
e.label,cleverapps.styles.FONTS.WINDOW_SMALL_TEXT);return new cleverapps.Layout([t,n],{direction:cleverapps.UI.VERTICAL,margin:i.Button.topPadding})}return t},this),r=new cleverapps.Layout(o,{direction:cleverapps.UI.VERTICAL,margin:i.Button.topPadding}),a=new cleverapps.Layout([this.createUserId(),r],{margin:i.Button.topPadding,direction:cleverapps.UI.VERTICAL}),c=i.Title.empty?void 0:"messages:SettingsWindow.title";this._super({title:c,name:"settingswindow",content:a,styles:cleverapps.overrideStyles(cleverapps.styles.Window,i.window,!0)}),cleverapps.audio.playSound(bundles.main.urls.window_effect)},createContent:function(e,t,s){if(void 0!==e&&"object"==typeof e){var n=cleverapps.User.calcSource();e=s.icon.image[n]}s=s||{};var i=cleverapps.styles.SettingsWindow,o=s.font||cleverapps.styles.FONTS.BUTTON_TEXT,r=function(e){if(e){var t=new cc.Sprite(e),n=s.Icon||{};return t.setScale(n.scale||1),t}};if(t){var a=cleverapps.UI.generateTTFText(t,o),c=new cleverapps.Layout([r(e),a].filter(
function(e){return void 0!==e}),{direction:cleverapps.UI.HORIZONTAL,margin:i.Button.margin});return c.text=a,c}return r(e)},singleLineWithSubstrate:function(e,t){var n=cleverapps.styles.SettingsWindow.Substrate,s=cleverapps.UI.generateTTFText(t,cleverapps.styles.FONTS.BUTTON_TEXT);s.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER),s.setVerticalAlignment(cc.TEXT_ALIGNMENT_CENTER),s.setDimensions(n.width-e.width,0),s.fitTo(0,e.height);var i=new cleverapps.Layout([s,e],{direction:cleverapps.UI.HORIZONTAL}),o=cleverapps.UI.createScale9Sprite(n.image);return o.setLocalZOrder(-1),o.setContentSize2(n.width,n.height),o.setPosition(i.width/2-n.marginX,i.height/2-n.marginY),i.addChild(o),i},addGiveUpButton:function(){var e=cleverapps.styles.SettingsWindow,t=this.createContent(e.GiveUpButton.icon,"messages:GiveUp",e.GiveUpButton);return new cleverapps.UI.Button({button_png:bundles.buttons_main.frames.red_button,button_on_png:bundles.buttons_main.frames.red_button_on,content:t,onClicked:function(
){this.close(),cleverapps.metha.whenFreeFocus(function(){cc.director.getRunningScene().closeAction()})}.bind(this),width:e.Button.width,height:e.Button.height})},addHelpButton:function(){var e=cleverapps.styles.SettingsWindow;return new cleverapps.UI.Button({content:this.createContent(e.HelpButton.icon,!0===e.Button.noCaption?"":"messages:Help",{font:e.Button.font}),onClicked:function(){cc.sys.openURL(cleverapps.bySource(cleverapps.config.helpURL))},width:e.Button.width,height:e.Button.height,button_png:e.HelpButton.button_png||bundles.buttons_main.frames.blue_button_png,button_on_png:e.HelpButton.button_on_png||bundles.buttons_main.frames.blue_button_on_png,contentOffset:e.HelpButton.iconOffset})},addSupportButton:function(){var e=cleverapps.styles.SettingsWindow;return new cleverapps.UI.Button({content:this.createContent(e.SupportButton.icon,!0===e.Button.noCaption?"":"messages:SupportButton",{font:e.Button.font}),onClicked:function(){cleverapps.metha.distract({focus:"ChatScene",
action:function(e){Game.currentGame&&(Game.currentGame.stop(),Game.currentGame=void 0),cleverapps.scenes.replaceScene(new ChatScene(cleverapps.chat),e)}})}.bind(this),width:e.Button.width,height:e.Button.height,button_png:e.SupportButton.button_png||bundles.buttons_main.frames.blue_button_png,button_on_png:e.SupportButton.button_on_png||bundles.buttons_main.frames.blue_button_on_png,contentOffset:e.SupportButton.iconOffset,mark:cleverapps.chat.hasUnread})},addEffectButton:function(){var e=new cleverapps.UI.StateButton({on:"messages:on",off:"messages:off",onClick:function(e){0===e?cleverapps.settings.setFpsMode(cleverapps.Settings.FPS_MODE_LOW):cleverapps.settings.setFpsMode(cleverapps.Settings.FPS_MODE_HIGH)}});return cleverapps.settings.fpsMode!==cleverapps.Settings.FPS_MODE_HIGH&&cleverapps.settings.fpsMode!==cleverapps.Settings.FPS_MODE_AUTO||e.setState(1),e},addLanguages:function(){var e=cleverapps.styles.SettingsWindow;return new cleverapps.UI.Button({content:this.createContent(
e.LanguageButton.icon,!0===e.Button.noCaption?"":"messages:Language",e.LanguageButton),onClicked:function(){new LanguagesWindow,this.close()}.bind(this),width:e.Button.width,height:e.Button.height,contentOffset:e.LanguageButton.iconOffset,button_png:e.LanguageButton.button_png,button_on_png:e.LanguageButton.button_on_png,button_off_png:e.LanguageButton.button_off_png})},addSoundIcons:function(){var e=[{on:bundles.buttons_main.frames.sound_on_png,off:bundles.buttons_main.frames.sound_off_png,toggle:cleverapps.settings.toggleSound.bind(cleverapps.settings),settings:"sound",listener:"onChangeSoundListener"},{on:bundles.buttons_main.frames.music_on_png,off:bundles.buttons_main.frames.music_off_png,toggle:cleverapps.settings.toggleMusic.bind(cleverapps.settings),settings:"music",listener:"onChangeMusicListener"}];"undefined"!=typeof match3&&(cc.sys.isNative||cc.sys.isMobile||"ios"===cleverapps.User.calcSource())&&e.push({on:bundles.buttons_main.frames.vibro_on_png,
off:bundles.buttons_main.frames.vibro_off_png,toggle:cleverapps.settings.toggleVibro.bind(cleverapps.settings),settings:"vibro",listener:"onChangeVibroListener"});var s=cleverapps.styles.SettingsWindow.IconButton;return this.arrangeButtons(e,cleverapps.styles.SettingsWindow.Button,function(e,t){var n=new cleverapps.UI.Button({content:new cc.Sprite(e.on),contentOff:new cc.Sprite(e.off),width:t.width,height:s.height||t.height,contentOffset:s.contentOffset,onClicked:e.toggle});return n.setBright(cleverapps.settings[e.settings]),cleverapps.settings[e.listener]=function(){n.setBright(cleverapps.settings[e.settings])},n})},arrangeButtons:function(e,t,n){var s=3===e.length?t.width3:2===e.length?t.width2:t.width,i=t.height2||t.height,o=e.map(function(e){return n(e,{width:s,height:i})},this);return new cleverapps.Layout(o,{direction:cleverapps.UI.HORIZONTAL,margin:t.margin,padding:{x:t.padding||0,y:0}})},createLoginButtons:function(){var s=cleverapps.social.getCodes(),n=function(e,t){
var n=cleverapps.styles.SettingsWindow;return new FbButton({multiSocials:1<s.length,width:1===s.length?t.width:void 0,height:t.height,button_png:bundles.main.frames.facebook_small_png,button_on_png:bundles.main.frames.facebook_small_connected_png,login:!0,showText:!(!0===n.Button.noCaption)&&1===s.length,source:e,onSuccess:this.close.bind(this)})}.bind(this),e=cleverapps.overrideStyles(cleverapps.clone(cleverapps.styles.SettingsWindow.Button,!0),cleverapps.styles.SettingsWindow.LoginButton);1<s.length&&(e=cleverapps.overrideStyles(cleverapps.clone(e,!0),e.multiSocials));var t=this.arrangeButtons(s,e,function(e,t){return n(e,t)});if(!cleverapps.styles.SettingsWindow.Substrate&&1<s.length){var i=new cleverapps.UI.generateTTFText("messages:SignIn",cleverapps.styles.FONTS.SETTINGS_WINDOW_ID_TEXT||cleverapps.styles.FONTS.WINDOW_SMALL_TEXT);return new cleverapps.Layout([t,i],{direction:cleverapps.UI.VERTICAL,margin:cleverapps.styles.SettingsWindow.Button.topPadding})}return t},
createInviteButton:function(){var e=cleverapps.styles.SettingsWindow.Button;return new FbButton({width:e.width,height:e.height,button_png:bundles.main.frames.facebook_small_png,button_on_png:bundles.main.frames.facebook_small_connected_png,showText:!(!0===cleverapps.styles.SettingsWindow.Button.noCaption),onSuccess:this.close.bind(this)})},createUserId:function(){if("merge"!==cleverapps.config.type){var e=cleverapps.user.id;e=e.replace("android_","").replace("apple_","");var t=cleverapps.UI.generateTTFText("messages:SettingsWindow.UserID.text",cleverapps.styles.FONTS.SETTINGS_WINDOW_ID_TEXT||cleverapps.styles.FONTS.WINDOW_SMALL_TEXT,{id:e});if(30<e.length&&t.setString("ID: "+e),t.fitTo(cleverapps.styles.SettingsWindow.UserId.maxWidth),!cc.sys.isNative){cleverapps.UI.onClick(t,function(){var e=document.createElement("textArea");e.value=cleverapps.user.id,e.style.hidden=!0,document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e),
cleverapps.Notification.create("messages:SettingsWindow.UserID.copied")})}return t}},createResolutionId:function(){return new cleverapps.UI.generateTTFText("messages:SettingsWindow.ResolutionId",cleverapps.styles.FONTS.WINDOW_SMALL_TEXT,{resolution:100*resolutionScale})}});cleverapps.styles.SettingsWindow={HelpButton:{},SupportButton:{},IconButton:{},LoginButton:{margin:40,padding:0},Button:{width:450,height:110,topPadding:20,leftPadding:0,margin:15,width2:215,width3:140},LanguageButton:{icon:bundles.buttons_main.frames.language_icon_png},GiveUpButton:{enabled:!1},ModesSlider:{margin:0},UserId:{maxWidth:500},window:{contentOffset:-50,Border:{y:100}},Title:{empty:!1},topPadding:40,width:400,height:430},"horizontal"===cleverapps.config.orientation&&cleverapps.increaseStylesByKoef(cleverapps.styles.SettingsWindow,1.25);var LanguageButton=cc.Node.extend({ctor:function(e,t){this._super(),this.callback=t,this.language=e,this.setContentSize2(cleverapps.styles.LanguagesWindow.Button),
this.setAnchorPoint2(),this.addContent(),cleverapps.UI.onClick(this,this.onClicked.bind(this)),cleverapps.UI.applyHover(this)},onClicked:function(){this.isCurrentLanguage()||this.callback(this.language)},isCurrentLanguage:function(){return cleverapps.settings.language===this.language},onTouchBegan:function(){this.isCurrentLanguage()||(this.isPressed=!0,this.updateContent())},onTouchEnded:function(){this.isCurrentLanguage()||(this.isPressed=!1,this.updateContent())},addContent:function(){this.content=this.createButtonContent(),this.addChild(this.content),this.content.setPositionRound(this.width/2,this.height/2)},onMouseOver:function(){this.isCurrentLanguage()||this.setScale(1.05)},updateContent:function(){this.content.removeFromParent(!0),this.addContent()},createButtonContent:function(){var e=cleverapps.styles.LanguagesWindow.Button,t=new cc.Node;t.setAnchorPoint2(),t.setContentSize2(e);var n=this.bg=cleverapps.UI.createScale9Sprite(this.isPressed||this.isCurrentLanguage(
)?bundles.languageswindow.frames.buttonbg_on_png:bundles.languageswindow.frames.buttonbg_png);n.setContentSize2(t.getContentSize()),n.setPosition(t.width/2,t.height/2),t.addChild(n);var s=cleverapps.styles.FONTS.LANGUAGE_TEXT;this.isCurrentLanguage()&&cleverapps.styles.FONTS.LANGUAGE_SELECTED_TEXT&&(s=cleverapps.styles.FONTS.LANGUAGE_SELECTED_TEXT);var i=cleverapps.UI.generateTTFText("messages:"+this.language,s);if(i.fitTo(t.width-2*e.padding.x),t.addChild(i),i.setPositionRound(t.width/2+e.text.offset.x,t.height/2+e.text.offset.y),this.isCurrentLanguage()){var o=new cc.Sprite(bundles.languageswindow.frames.buttoncheck_png);for(o.setPositionRound(e.check),t.addChild(o);cc.rectIntersectsRect(o.getBoundingBox(),i.getBoundingBox());)i.fitTo(.95*i.width)}return t}}),LanguagesWindow=Window.extend({onWindowLoaded:function(){var e=cleverapps.styles.LanguagesWindow,t=cleverapps.overrideStyles(cleverapps.styles.Window,e.window,!0);this._super({title:"messages:Language",name:"languageswindow",
minHeight:e.minHeight,content:this.createContent(),styles:t}),cleverapps.audio.playSound(bundles.main.urls.window_effect)},createContent:function(){var e=cleverapps.styles.LanguagesWindow,t=cleverapps.clone(cleverapps.Settings.getAvailableLanguages()),n=e.amountInRow[cleverapps.wideMode.mode];this.buttonsPerLanguage={};for(var s=[];0<t.length;){var i=t.splice(0,n),o=[];i.forEach(function(e){var t=new LanguageButton(e,this.buttonClicked.bind(this));o.push(t),this.buttonsPerLanguage[e]=t}.bind(this));var r=new cleverapps.Layout(o,{direction:cleverapps.UI.HORIZONTAL,margin:e.columnMargin});s.unshift(r)}var a=new cleverapps.Layout(s,{direction:cleverapps.UI.VERTICAL,margin:e.rowMargin,padding:e.padding});if(e.bg){var c=new cc.Scale9Sprite(bundles.languageswindow.frames.bg_png);return c.setContentSize2(a.width+2*e.bg.padding.x,a.height+2*e.bg.padding.y),c.addChild(a),a.setPositionRound(c.width/2,c.height/2),c}return a},buttonClicked:function(t){var n=cleverapps.settings.language
;t!==n&&cleverapps.metha.distract({focus:"LanguageChanged",action:function(e){cleverapps.settings.setLanguage(t),t===cc.sys.LANGUAGE_RUSSIAN&&(cleverapps.dailyLevel.currentEvent||cleverapps.dailyLevel.load()),"board"===cleverapps.config.type&&levels.episodes.reset(),this.buttonsPerLanguage[n].updateContent(),this.buttonsPerLanguage[t].updateContent(),Messages.preload(t,function(){this.setTitle("messages:Language"),cleverapps.environment.isGameScene()&&"merge"!==cleverapps.config.type?cleverapps.lives?(e(),this.close()):cleverapps.metha.wantsToPlay(e):(this.close(),Game.currentGame&&Game.currentGame.stop(),cleverapps.metha.gotoMainScene(e))}.bind(this))}.bind(this)})},listBundles:function(){return["languageswindow"]}});cleverapps.overrideFonts(cleverapps.styles.FONTS,{LANGUAGE_TEXT:{size:35,color:cleverapps.styles.COLORS.WHITE}}),cleverapps.styles.LanguagesWindow={Button:{width:260,height:100,padding:{x:10},text:{offset:{x:0,y:0}},check:{margin:3,x:{align:"left",dx:6},y:{align:"center",
dy:0}}},window:{contentOffset:-40},columnMargin:20,rowMargin:20,padding:{x:0,y:10},amountInRow:[2,3,3]};var TutorialFinishWindow=Window.extend({onWindowLoaded:function(){var e=cleverapps.styles.TutorialFinishWindow,t=new cc.Node;t.setAnchorPoint(.5,.5);var n=e.paddingBottom;t.setContentSize(e.width,e.height?e.height:e.paddingBottom);var s=cleverapps.UI.generateTTFText("messages:TutorialFinishWindow.text",cleverapps.styles.FONTS.WINDOW_TEXT,{gameTitle:Messages.get(cleverapps.config.title)});s.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER);var i=t.width+50;if(s.setDimensions(cc.size(i,0)),s.setPosition(t.width/2+e.text.x,t.height+s.height/2+e.text.y),t.addChild(s),n+=s.height+e.paddingTop,e.character){var o=new cc.Sprite(e.character.image);o.setPosition(t.width/2+e.character.x,e.character.y),t.addChild(o),n+=o.height}e.height&&(n=e.height),t.setContentSize(t.width,n),this._super({content:t,title:"messages:TutorialFinishWindow.title",name:"tutorialfinishwindow",button:{
text:Messages.get("OK")},closeButton:!1}),cleverapps.audio.playSound(bundles.main.urls.window_effect)}});cleverapps.styles.TutorialFinishWindow={width:550,paddingBottom:50,paddingTop:20,text:{x:0,y:0}};var RateWindow=Window.extend({onWindowLoaded:function(){cleverapps.eventLogger.logEvent(cleverapps.EVENTS.RATE_WINDOW);for(var n=cleverapps.styles.RateWindow,s=[],e=[],t=0;t<5;t++)e.push(t);var i=-1,o=function(e){if(e!==i){i=e;for(var t=0;t<5;t++)t<=e?s[t].turnOn():s[t].turnOff()}},r=function(e){if(4===e){cleverapps.eventLogger.logEvent(cleverapps.EVENTS.RATE_SEND);var t=cleverapps.bySource(cleverapps.config.rate.urls);void 0===t&&(t=cleverapps.config[cleverapps.User.calcSource()]&&cleverapps.config[cleverapps.User.calcSource()].url);var n=function(){t&&cc.sys.openURL(t)};NativeReview.isAvailable()?NativeReview.requestReview(function(e){cleverapps.eventLogger.logEvent("native_review_"+e),"ok"!==e&&n()}):n()}if(cleverapps.eventLogger.logEvent(cleverapps.EVENTS["RATE_"+(e+1)]),e+1<=3){
var s=cleverapps.bySource(cleverapps.config.dontLikeGameUrl);s&&cc.sys.openURL(s)}this.close()}.bind(this),a=function(e){var t=this.convertToNodeSpace(e.getLocation()),n=cc.rect(0,0,this.width,this.height);cc.rectContainsPoint(n,t)?o(this.order):function(e){if(e===i){i=-1;for(var t=0;t<5;t++)s[t].turnOff()}}(this.order)};s=this.stars=e.map(function(e){var t=new cc.Sprite(n.starImage);return t.turnOn=function(){cleverapps.UI.convertToGrayScale(t,!0)},t.turnOff=function(){cleverapps.UI.convertToGrayScale(t)},t.turnOff(),t.order=e,cc.eventManager.addListener({event:cc.EventListener.TOUCH_ONE_BY_ONE,onTouchBegan:function(e){var t=this.convertTouchToNodeSpace(e);return!!cc.rectContainsPoint(cc.rect(0,0,this.width,this.height),t)}.bind(t),onTouchEnded:function(e){var t=this.convertTouchToNodeSpace(e);return!!cc.rectContainsPoint(cc.rect(0,0,this.width,this.height),t)&&(o(this.order),r(this.order),!0)}.bind(t)},t),cc.eventManager.addListener({event:cc.EventListener.MOUSE,onMouseMove:a.bind(t)
},t),t});var c=cleverapps.UI.generateTTFText("messages:RateWindow.text",cleverapps.styles.FONTS.WINDOW_TEXT,{gameTitle:Messages.get(cleverapps.config.title)});c.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER),c.setDimensions(n.width,0);var l=new cleverapps.Layout(s,{direction:cleverapps.UI.HORIZONTAL}),p=new cleverapps.Layout([l,c],{direction:cleverapps.UI.VERTICAL,margin:n.margin,padding:n.padding});this._super({content:p,title:"messages:RateWindow.title",name:"ratewindow",button:{width:n.button.width,height:n.button.height,text:Messages.get("Later").toUpperCase(),onPressed:function(){this.close()}.bind(this)}}),cleverapps.audio.playSound(bundles.main.urls.window_effect),this.addFingerTip(s[s.length-1])},addFingerTip:function(e){this.fingerTip=new FingerView,this.fingerTip.setLocalZOrder(20);var t=e.getPosition();e.parent.addChild(this.fingerTip),this.fingerTip.delay(2),this.fingerTip.fadeIn(t),this.fingerTip.press(),this.fingerTip.delay(.3),this.fingerTip.unPress(),
this.fingerTip.delay(.1),this.fingerTip.press(),this.fingerTip.delay(.3),this.fingerTip.unPress(),this.fingerTip.fadeOut();var n,s=function(){this.runAction(new cc.Sequence(new cc.DelayTime(2.2),new cc.CallFunc(function(){this.stars.forEach(function(e,t){e.runAction(new cc.Sequence(new cc.DelayTime(.25*t),new cc.CallFunc(function(){e.turnOn()})))})}.bind(this))))}.bind(this);cc.sys.isNative&&(s(),n=function(){this.stars.forEach(function(e){e.turnOff()}),s()}.bind(this)),this.fingerTip.run({looped:!0,onIterationFinish:n})},onClose:function(){cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.RATED,!0,{raw:!0}),this.fingerTip&&this.fingerTip.removeFromParent(!0)}});RateWindow.hadRated=function(){return cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.RATED,{raw:!0})},cleverapps.styles.RateWindow={width:650,margin:40,padding:{x:15,y:70},text:{height:180},button:{width:300,height:100},starImage:bundles.game.frames.ratewindow_on},RateWindow.prototype.listBundles=function(){return[
"game"]},RateWindow.AVAILABLE={level:3,episode:1},"merge"===cleverapps.config.type&&(RateWindow.AVAILABLE={level:6,episode:0});var WindowHelper={animateCollect:function(n,t,e){if(e=cleverapps.once(e||function(){}),n&&n.parent&&t.target&&t.target.parent){n.replaceParentSamePlace(cc.director.getRunningScene());var s=function(){var e=t.target.parent.convertToWorldSpace(t.target);return t.targetDelta&&(e.x+=t.targetDelta.x,e.y+=t.targetDelta.y),e},i=s(),o=t.height||cleverapps.styles.WindowHelper.second.y,r=cc.p((n.x+2*i.x)/3,(n.y+2*i.y)/3+o),a=cc.p((n.x+r.x)/2,(n.y+r.y)/2);n.runAction(new cc.Sequence(new cc.Spawn(new cc.BezierTo(.7,[a,r,i]).easing(cc.easeInOut(1)),new cc.ScaleTo(.7,t.scale)),new cc.CallFunc(function(){e(),t.noSound||cleverapps.audio.playSound(bundles.main.urls.collect_coins_effect),!1!==t.remove&&n.parent&&n.removeFromParent(!0)}))),[.175,.35,.7*.75].forEach(function(t){n.runAction(new cc.Sequence(new cc.DelayTime(t),new cc.CallFunc(function(){var e=s();n.runAction(
new cc.MoveBy(.7-t,e.x-i.x,e.y-i.y)),i=e})))})}else e()}};cleverapps.styles.WindowHelper={second:{y:400}};var ConfirmExitWindow=Window.extend({onWindowLoaded:function(e){this.returnOnClose=e.onClose||function(){},this.onAction=e.onAction||function(){};var t=cleverapps.styles.ConfirmExitWindow,n=new cc.Node;n.setAnchorPoint(.5,.5),n.setContentSize2(t.width,t.height);var s=cleverapps.styles.FONTS.CONFIRM_AND_EXIT_TEXT||cleverapps.styles.FONTS.WINDOW_TEXT,i=e.text||"messages:AreYouSure";cleverapps.environment.isGameScene()&&"merge"!==cleverapps.config.type&&(cleverapps.lives&&(i="messages:ConfirmExitWindow.message"),e.game.level.episode.isBonusRound()&&(i="messages:ConfirmExitWindow.BonusRound.message"));var o=cleverapps.UI.generateOnlyText(i,s);if(o.setAnchorPoint2(),o.setDimensions(t.text.width,0),o.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER),t.text.height&&o.fitTo(0,t.text.height),e.reward){var r=new RewardsListComponent(e.reward,{font:s,margin:t.reward.margin});r.setAnchorPoint2(
)}var a,c=new cleverapps.Layout([r,o],{direction:cleverapps.UI.VERTICAL,margin:t.margin});c.setPositionRound(n.width/2+t.text.x,t.text.y),n.addChild(c),!1===t.breakView.upAnimation&&"undefined"!=typeof BreakView&&Game.currentGame&&cleverapps.environment.isGameScene()&&BreakView.AddBreakViews(n,[o],t.breakView.y),this._super({closeByBackButton:!0,title:"messages:ConfirmExitWindow.title",name:"confirmexitwindow",content:n,buttons:this.getButtons(),closeButton:!1});var l=bundles.confirmexit_window.jsons.confirmexit_window_json;"tripeaks"===cleverapps.config.name&&(l=bundles.hero.jsons.hero_json),l&&((a=new cleverapps.Spine(l,t.animation.scale)).setAnimation(0,t.animation.onScene?"lose":"sad",!0),t.animation.onScene?(a.setPositionRound(t.animation.x,cleverapps.wideMode.mode===cleverapps.WideMode.VERTICAL?t.animation.y-t.animation.verticalOffset:t.animation.y),this.addChild(a)):(a.setPositionRound(n.width/2+t.animation.x,n.height/2+t.animation.y),n.addChild(a))),
!0===t.breakView.upAnimation&&"undefined"!=typeof BreakView&&Game.currentGame&&cleverapps.environment.isGameScene()&&BreakView.AddBreakViews(n,[a],t.breakView.y),cleverapps.audio.playSound(bundles.main.urls.window_effect)},getButtons:function(){var e=cleverapps.styles.ConfirmExitWindow,t=new cleverapps.UI.Button({button_png:e.playButton.image,button_on_png:e.playButton.imageOn,text:Messages.get("PlayOn"),onClicked:function(){this.close()}.bind(this),width:e.button.width,height:e.button.height}),n=new cleverapps.UI.Button({button_png:e.exitButton.image?e.exitButton.image:bundles.buttons_main.frames.red_button,button_on_png:e.exitButton.image?e.exitButton.imageOn:bundles.buttons_main.frames.red_button_on,text:Messages.get("Exit"),font:e.exitButton.font||cleverapps.styles.FONTS.BUTTON_TEXT,onClicked:function(){this.closeAnimationCallbacks.push(this.onAction),this.close()}.bind(this),width:e.button.width,height:e.button.height});return e.exitButton.scale&&(n.setScale(e.exitButton.scale),
n.baseScale=n.scale),[n,t]},onClose:function(){this.returnOnClose&&this.returnOnClose()},listBundles:function(){return["confirmexit_window"]}});cleverapps.styles.ConfirmExitWindow={width:650,height:550,margin:20,animation:{x:0,y:-10,scale:1},text:{x:0,y:60,width:500},exitButton:{scale:.9},playButton:{},button:{width:300,height:100},breakView:{upAnimation:!0,y:0},reward:{margin:100}};var NewLeagueWindow=Window.extend({onWindowLoaded:function(e){this.level=e,cleverapps.eventLogger.logEvent(cleverapps.EVENTS.NEW_LEAGUE);var t=cleverapps.styles.NewLeagueWindow;if(this.content=new cc.Node,this.content.setAnchorPoint(.5,.5),this.content.setContentSize(t.width,t.height),this.addLeague(),this._super({title:"messages:NewLeagueWindow.Title",name:"newleaguewindow",content:this.content,closeButton:!1,buttons:this.getButtons(),shareCheckBox:this.getShareOptions()}),this.addChild(new Fireworks),cleverapps.audio.playSound(bundles.main.urls.window_effect),t.hero){var n=new HeroView(t.hero)
;this.addChild(n)}},addLeague:function(){var e=cleverapps.styles.NewLeagueWindow,t=levels.user.league,n=cleverapps.UI.generateTTFText("messages:NewLeagueWindow.text",cleverapps.styles.FONTS.WINDOW_TEXT,{league:Messages.get("League"+t)});n.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER),n.setPositionRound(this.content.width/2,e.text.y),n.setDimensions(this.content.width,0),this.content.addChild(n)},getButtons:function(){var e=cleverapps.styles.NewLeagueWindow.button,t=[],n=new cleverapps.UI.Button({width:e.width,height:e.height,text:Messages.get("OK"),font:cleverapps.styles.FONTS.BUTTON_TEXT,onClicked:this.close.bind(this)});if(t.push(n),this.level.isRegular())var s=ShareBonusButton.create({window:this,shareBonus:cleverapps.ShareBonus.SHARES.newLeague,toReplace:{leagueId:levels.user.league,leagueName:Messages.get("League"+levels.user.league)}});return s&&t.push(s),t},getShareOptions:function(){return{shareId:cleverapps.ShareBonus.SHARES.newLeague.id,toReplace:{
leagueId:levels.user.league,leagueName:Messages.get("League"+levels.user.league)}}}});cleverapps.styles.NewLeagueWindow={width:550,height:500,button:{width:280,height:110,y:-50},text:{y:170},buttonsMargin:25,share:{width:280,height:110,Text:{offsetX:0,offsetY:25},RewardText:{offsetX:-15,offsetY:-15},RewardCoins:{scale:.5,offsetX:40,offsetY:-18}}};var LeadersLoading=cc.Node.extend({ctor:function(){this._super();var e=cleverapps.styles.WaitWindow,t=this.loading=new cleverapps.Spine(bundles.main.jsons.wait_json,1.5);if(t.setAnimation(0,"idle",!0),this.addChild(t),e.text){var n=this.loadingText=cleverapps.UI.generateTTFText(Messages.get("Loading")||"Loading",cleverapps.styles.FONTS.WINDOW_TEXT);n.setPosition(0,e.text.y),this.addChild(n)}},remove:function(){this.loading.runAction(new cc.RemoveSelf),this.loadingText&&this.loadingText.removeFromParent()}}),LeadersWindow=Window.extend({onWindowLoaded:function(){cleverapps.eventLogger.logEvent(cleverapps.EVENTS.LEADERS_WINDOW_OPEN),
this.content=new cc.Node,this.content.setAnchorPoint2(),this.content.setContentSize(cleverapps.styles.LeadersWindow.width,cleverapps.styles.LeadersWindow.height);var e=cleverapps.overrideStyles(cleverapps.clone(cleverapps.styles.Window,!0),cleverapps.styles.LeadersWindow.window);this._super.call(this,{name:"leaderswindow",content:this.content,title:{text:"messages:LeadersWindowTitle"},styles:e}),this.addButtons(),this.tabs.activateTab(LeadersWindow.TABS.GLOBAL),cleverapps.audio.playSound(bundles.main.urls.window_effect)},addButtons:function(){var e=cleverapps.styles.LeadersWindow.tabs,t={};t[LeadersWindow.TABS.GLOBAL]={icon:bundles.main.frames.global_icon,generator:this.generateWorldContent.bind(this),scale:e.scale},cleverapps.flags.nologin||(t[LeadersWindow.TABS.FRIENDS]={icon:bundles.main.frames.friends_icon,generator:this.generateFriendsContent.bind(this),scale:e.scale,mirrorX:e.mirrorX}),this.tabs=new Tabs(t,e),this.tabs.setPositionRound(e),this.tabs.setLocalZOrder(e.zOrder),
this.window.addChild(this.tabs)},addTableHead:function(e){var t=cleverapps.styles.LeadersWindow.table,n=new cc.Node;n.setContentSize2(cleverapps.styles.LeadersWindow.player.width,t.head.height),n.setAnchorPoint2(),n.setPositionRound(e.width/2,t.head.y),e.addChild(n);var s=cleverapps.UI.generateTTFText("messages:LeadersWindow.rank",cleverapps.styles.FONTS.WINDOW_SMALL_TEXT);s.setPositionRound(t.rank.x,n.height/2),n.addChild(s);var i=cleverapps.UI.generateTTFText("messages:LeadersWindow.player",cleverapps.styles.FONTS.WINDOW_SMALL_TEXT);i.setPositionRound(t.player.x,n.height/2),n.addChild(i);var o=cleverapps.UI.generateTTFText("messages:LeadersWindow.rating",cleverapps.styles.FONTS.WINDOW_SMALL_TEXT);o.setPositionRound(t.rating.x,n.height/2),n.addChild(o)},generateWorldContent:function(){var e=cleverapps.styles.LeadersWindow.worldContent;this.worldContent=new cc.Node,this.worldContent.setAnchorPoint2(),this.worldContent.setContentSize(e.width,e.height),this.worldContent.setPosition(
this.content.width/2+e.left,this.content.height/2+e.top),this.content.addChild(this.worldContent),this.addTableHead(this.worldContent);var s=new LeadersLoading;s.setPosition(this.worldContent.width/2,this.worldContent.height/2),this.worldContent.addChild(s),s.setVisible(!1),s.runAction(new cc.Sequence(new cc.DelayTime(.3),new cc.CallFunc(function(){s.setVisible(!0)}))),1<this.getAmountLeagues()&&(this.decLeagueButton=new cleverapps.UI.Button({button_png:e.arrow.image,button_on_png:e.arrow.image,onClicked:this.decLeague.bind(this),clickThrottle:1,onMouseOver:function(){this.decLeagueButton.setScale(-1.05,1.05)}.bind(this),onMouseOut:function(){this.decLeagueButton.setScale(-1,1)}.bind(this)}),this.decLeagueButton.setPosition(this.worldContent.width/2-e.arrow.x,this.worldContent.height+e.arrow.y),this.decLeagueButton.setScaleX(-1),this.decLeagueButton.setLocalZOrder(1),this.worldContent.addChild(this.decLeagueButton),this.incLeagueButton=new cleverapps.UI.Button({
button_png:e.arrow.image,button_on_png:e.arrow.image,onClicked:this.incLeague.bind(this),clickThrottle:1}),this.incLeagueButton.setPosition(this.worldContent.width/2+e.arrow.x,this.worldContent.height+e.arrow.y),this.incLeagueButton.setLocalZOrder(1),this.worldContent.addChild(this.incLeagueButton)),this.currentLeague=levels.user.league,this.generateWorldHead(levels.user.league);var t=this.createListener(cleverapps.timeredThrottle(300,function(t){s.remove(),this.leaguesLeaders={};for(var n=0;n<t.length;n++)this.leaguesLeaders[t[n].leagueId]=JSON.parse(t[n].data),this.leaguesLeaders[t[n].leagueId].forEach(function(e){e.league=t[n].leagueId});for(n=0;n<this.getAmountLeagues();n++)this.leaguesLeaders[n]||(this.leaguesLeaders[n]=[]);this.generateWorldHead(levels.user.league),this.generateWorldLeague(levels.user.league)}.bind(this),Date.now())),n="/leaders/"+cleverapps.settings.language+"/";return cleverapps.config.debugMode&&(n="https://wordsoup.labsystech.ru/wordsoup-rest"+n),
cleverapps.RestClient.get(n,{},t,function(){cleverapps.Notification.create("messages:LeadersLoadFailed")}),this.worldContent.onSelectTab=function(){this.updateTitle()}.bind(this),this.worldContent},decLeague:function(){0<this.currentLeague&&(this.currentLeague--,this.generateWorldHead(),this.generateWorldLeague(),this.updateTitle())},incLeague:function(){this.currentLeague<this.getAmountLeagues()-1&&(this.currentLeague++,this.generateWorldHead(),this.generateWorldLeague(),this.updateTitle())},getAmountLeagues:function(){var e=1;return cleverapps.config.leagues&&(e=cleverapps.config.leagues.length),e},generateWorldHead:function(){this.decLeagueButton&&(this.decLeagueButton.visible=this.leaguesLeaders&&0<this.currentLeague),this.incLeagueButton&&(this.incLeagueButton.visible=this.leaguesLeaders&&this.currentLeague<this.getAmountLeagues()-1)},updateTitle:function(){this.window&&this.setTitle("messages:League"+this.currentLeague)},generateWorldLeague:function(){var e=this.currentLeague,
t=this.leaguesLeaders[e];for(this.removePlayerFromTop(t),levels.user.league===e&&this.addPlayerToTop(t);t.length>LeadersWindow.TOP_LIMIT&&t[t.length-1].id!==levels.user.id;)t.pop();var n=function(){this.leagueTop&&(this.leagueTop.removeFromParent(),delete this.leagueTop)}.bind(this);n(),this.runAction(new cc.Sequence(new cc.DelayTime(.01),new cc.CallFunc(function(){e===this.currentLeague&&(n(),this.leagueTop=this.generateTop(t,this.worldContent),this.worldContent.addChild(this.leagueTop))}.bind(this))))},removePlayerFromTop:function(e){for(var t=0;t<e.length;t++)if(e[t].id===levels.user.id){e.splice(t,1);break}},addPlayerToTop:function(e){e.push({id:levels.user.id,rating:levels.user.getVirtualLevel(),name:cleverapps.friends.getPlayer().name,avatar:cleverapps.friends.getPlayer().avatar,you:!0,league:levels.user.league}),e.sort(function(e,t){return e.rating===t.rating?e.id===levels.user.id?-1:t.id===levels.user.id?1:0:t.rating-e.rating})},generateTop:function(e,t){for(var n=[],
s=0;s<e.length;s++){var i={text:e[s].name,place:s+1,id:e[s].id,avatar:{id:e[s].id,avatar:e[s].avatar},player:e[s].id===levels.user.id,amount:e[s].rating};n.push(i)}cleverapps.leadersWindowTable.resetResults("leadersWindow");var o=cleverapps.leadersWindowTable.createTableView({id:"leadersWindow",data:n,rowConstructor:cleverapps.LeadersRow,options:{styles:{width:cleverapps.styles.LeadersRow.size.width}}}),r=cleverapps.styles.LeadersWindow;return o.setPositionRound(r.table.x,r.table.y,t),o},generateFriendsContent:function(){var e=cleverapps.styles.LeadersWindow.friendsContent;this.friendsContent=new cc.Node,this.friendsContent.setAnchorPoint2(),this.friendsContent.setContentSize(e.width,e.height),this.friendsContent.setPosition(this.content.width/2+e.left,this.content.height/2+e.top);var t=levels.progress.getLeaders();if(0<t.length){this.addPlayerToTop(t),this.addTableHead(this.friendsContent);var n=this.generateTop(t,this.friendsContent);this.friendsContent.addChild(n)}else{e=e.noFriends
;var s=cleverapps.UI.generateTTFText("messages:noFriendsInLeadersText",cleverapps.styles.FONTS.WINDOW_TEXT);s.setPositionRound(this.friendsContent.width/2,this.friendsContent.height/2+e.Text.y),s.setDimensions(e.Text.width,e.Text.height),s.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER),this.friendsContent.addChild(s);var i=new cleverapps.UI.Button({text:Messages.get("SettingsWindow.InviteFriends"),width:e.Button.width,height:e.Button.height,font:cleverapps.styles.FONTS.BUTTON_TEXT,padding:e.Button.padding,onClicked:function(){cleverapps.social.inviteFriendsWindow(function(){}.bind(this))}.bind(this)});i.setPositionRound(this.friendsContent.width/2,this.friendsContent.height/2+e.Button.y),this.friendsContent.addChild(i)}return this.content.addChild(this.friendsContent),this.friendsContent.onSelectTab=function(){this.setTitle("messages:FriendsTopName")}.bind(this),this.friendsContent}});LeadersWindow.TABS={},LeadersWindow.TABS.GLOBAL=0,LeadersWindow.TABS.FRIENDS=1,
LeadersWindow.prototype.listBundles=function(){return"match3"===cleverapps.config.type?["game"]:[]},cleverapps.styles.LeadersWindow={width:524,height:770,player:{height:78,width:660,margin:20,name:{width:200,height:70},avatar:{scale:.8},place:{dy:0},rating:{dy:0}},head:{y:924},table:{x:{align:"center"},y:{align:"center"},head:{y:805,height:40},rank:{x:80},player:{x:300},rating:{x:550}},friendsContent:{width:600,height:782,left:0,top:-100,noFriends:{Text:{y:100,width:400,height:200},Button:{width:300,height:100,padding:{x:0},y:0}}},worldContent:{width:600,height:782,left:0,top:-100,arrow:{image:bundles.main.frames.league_arrow_png,x:286,y:0}},window:{decors:{}},tabs:{x:{align:"right",dx:0},y:{align:"bottom",dy:0},scale:.8,zOrder:0}},LeadersWindow.TOP_LIMIT=100,cleverapps.Promotion=function(){cleverapps.config.debugMode&&(cleverapps.Promotion.SINCE_START="10 seconds");var e=this.load();this.createdTime=Date.now(),e?this.processed=e.processed:this.reset()},
cleverapps.Promotion.prototype.reset=function(){this.processed=[],this.save()},cleverapps.Promotion.prototype.getFirstAvailable=function(){var n=cleverapps.User.calcSource(),s=void 0;return this.getPromotions().forEach(function(e,t){!s&&-1===this.processed.indexOf(e.id)&&e.sources[n]&&(s=e)},this),void 0!==s?s:0<this.processed.length?(this.processed=[],this.save(),this.getFirstAvailable()):void 0},cleverapps.Promotion.prototype.listAvailablePromotions=function(){return["mergecraft","magicwords","scramble","tripeaks","olympics","crocword","wordsoup","riddles","heroes","adventure","differences","runes"].filter(function(e){return e!==cleverapps.config.name&&cleverapps.projectLinks[e]})},cleverapps.Promotion.prototype.getPromotions=function(){var o={gameName:cleverapps.config.name};return this.listAvailablePromotions().map(function(e){var t="promotion_"+e+"_"+cleverapps.settings.language,n="promotion_"+e+"_"+cc.sys.LANGUAGE_ENGLISH,s={id:e,title:"messages:"+e+"PromoTitle",
description:"messages:"+e+"Promo",bundleName:bundles[t]?t:n,sources:{}};for(var i in cleverapps.projectLinks[e])s.sources[i]=cleverapps.projectLinks[e][i],"facebook"===i&&(s.sources[i]+=Messages.replace("?channel=%{gameName}",o)),"android"===i&&(s.sources[i]+=Messages.replace("&utm_source=%{gameName}",o));return s})},cleverapps.Promotion.prototype.isReady=function(){return!!cleverapps.user.checkAvailable(cleverapps.Promotion.AVAILABLE)&&(!(this.createdTime+cleverapps.parseInterval(cleverapps.Promotion.SINCE_START)>=Date.now())&&void 0!==this.getFirstAvailable())},cleverapps.Promotion.prototype.setProcessed=function(e){this.processed.push(e.id),this.save()},cleverapps.Promotion.prototype.load=function(){return cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.PROMOTION)},cleverapps.Promotion.prototype.save=function(){cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.PROMOTION,{processed:this.processed})},cleverapps.Promotion.ShowFirstAvailable=function(){
var e=cleverapps.promotion.getFirstAvailable();new PromotionWindow(e)},cleverapps.Promotion.BONUS=10,cleverapps.Promotion.SINCE_START="10 seconds",cleverapps.Promotion.AVAILABLE={episode:1,level:10};var PromotionWindow=Window.extend({onWindowLoaded:function(e){this.promotion=e,cleverapps.eventLogger.logEvent("promo_show_"+this.promotion.id),cleverapps.promotion.setProcessed(this.promotion);var t=cleverapps.styles.PromotionWindow,n=new cc.Node;n.setAnchorPoint(.5,.5);var s=cleverapps.UI.generateOnlyText(e.description,cleverapps.styles.FONTS.WINDOW_SMALL_TEXT);s.setDimensions(t.text.width,0),s.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER),n.addChild(s);var i=new cc.Sprite(bundles[e.bundleName].urls.image);n.addChild(i),cleverapps.UI.onClick(i,this.onPressed.bind(this)),cleverapps.UI.arrangeWithMargins(n.children,{margin:t.text.margin}),cleverapps.UI.wrap(n);var o=cleverapps.UI.wrapWithPadding(n,{x:0,y:t.margin});this._super({title:e.title,name:"promotionwindow",content:o,
styles:cleverapps.overrideStyles(cleverapps.styles.Window,cleverapps.styles.PromotionWindow,!0),button:{width:t.Button.width,height:t.Button.height,content:this.getButtonContent(),contentOffset:t.Button.contentOffset,onPressed:this.onPressed.bind(this)}}),cleverapps.audio.playSound(bundles.main.urls.window_effect)},isRewardAvailable:function(){return!cleverapps.MobileVk.isAppropriate()},onPressed:function(){var e=cleverapps.User.calcSource(),t=this.promotion.sources[e];"instant"!==e?cc.sys.openURL(t):FBInstant.switchGameAsync(t,{channel:cleverapps.config.name}).catch(function(e){console.log("FBInstant.switchGameAsync error",e);var t="USER_INPUT"===e.code?"cancel":"error";cleverapps.eventLogger.logEvent("promo_"+t+"_"+this.promotion.id),"error"===t&&cleverapps.eventLogger.logEvent("promo_error_"+cleverapps.config.platform)}.bind(this)),cleverapps.eventLogger.logEvent("promo_"+this.promotion.id),this.isRewardAvailable()&&(levels.user.setGold(levels.user.gold+cleverapps.Promotion.BONUS),
cleverapps.eventLogger.logEvent(cleverapps.EVENTS.REWARD_RECEIVED,{amount:cleverapps.Promotion.BONUS})),this.close()},getButtonContent:function(){var e=cleverapps.styles.PromotionWindow.Button,t=new cc.Sprite(bundles.menubar.frames.coin_png);t.setScale(e.scale),e.coinsOffsetY&&t.setPositionY(e.coinsOffsetY);var n=[];if(this.isRewardAvailable()){var s=cleverapps.UI.generateImageText("+"+cleverapps.Promotion.BONUS,cleverapps.styles.FONTS.PROMOTION_BUTTON_TEXT),i=new cleverapps.Layout([s,t],{direction:cleverapps.UI.HORIZONTAL,margin:e.bottom.margin});n.push(i)}var o=cleverapps.UI.generateOnlyText("messages:Play",cleverapps.styles.FONTS.PROMOTION_BUTTON_TEXT);n.push(o);var r=new cleverapps.Layout(n,{direction:cleverapps.UI.VERTICAL,margin:e.margin});return r.coin=t,r},listBundles:function(e){return[e.bundleName]}});cleverapps.overrideFonts(cleverapps.styles.FONTS,{PROMOTION_BUTTON_TEXT:{name:"default",size:55,color:cleverapps.styles.COLORS.WHITE,
stroke:cleverapps.styles.DECORATORS.IMAGE_FONT_STROKE}}),cleverapps.styles.PromotionWindow={margin:100,text:{width:620,margin:20},Button:{width:300,height:160,scale:.9,margin:0,contentOffset:{y:0},bottom:{margin:10}}};var Decors=function(n,s){if(s=s||{},this.styles=s,this.decors={},this.parent=n,cleverapps.styles.Decorators){var e=Object.keys(s).filter(function(e){if(!0!==s[e])return!1;var t=cleverapps.styles.Decorators[e];if(!t)return!1;if(t.lovesBackground&&!n.withBg)return!1;if(t.fearHigh&&n.window&&.8<n.window.height*n.window.scale/cleverapps.styles.SCENE_HEIGHT)return!1;return!t.titleDecorator});this.init(e)}};Decors.prototype.add=function(e){var t=cleverapps.styles.Decorators[e];if(t){var n;switch(t.type){case Decors.TYPE_IMAGE:n=this.addImage(t);break;case Decors.TYPE_ANIMATION:n=this.addAnimation(t);break;case Decors.TYPE_SCALE9:n=this.addScale9(t)}if(n){var s=this.getPos(t);return this.getParent(t).addChild(n),n.setPositionRound(s.x,s.y),this.decors[e]=n}}},
Decors.prototype.init=function(e){e.forEach(this.add,this)},Decors.prototype.initTitleDecorators=function(){var e=Object.keys(this.styles).filter(function(e){return!0===this.styles[e]&&cleverapps.styles.Decorators[e]&&cleverapps.styles.Decorators[e].titleDecorator}.bind(this));this.init(e)},Decors.prototype.getDecorById=function(e){if(this.decors[e])return this.decors[e]},Decors.prototype.setVisible=function(e,t){var n=this.getDecorById(e);return!!n&&(t||n.stopAllActions(),n.setVisible(t),!0)},Decors.prototype.getParent=function(e){return e.titleDecorator?this.parent.titleBg:this.parent.window},Decors.prototype.addScale9=function(e){var t=cleverapps.UI.createScale9Sprite(bundles.main.frames[e.image]||e.image);return t.setContentSize2(e.width,e.height),Array.isArray(e.scale)?t.setScale(e.scale[cleverapps.wideMode.mode]):t.setScale(e.scale),t.baseScale=t.scale,t.setLocalZOrder(e.zOrder),void 0!==e.rotation&&t.setRotation(e.rotation),t},Decors.prototype.addImage=function(e){
var t=new cc.Sprite(bundles.main.frames[e.image]||e.image),n=e.scale;return Array.isArray(n)&&(n=n[cleverapps.wideMode.mode]),"number"==typeof n?t.scale=n:(t.scaleX=n.x,t.scaleY=n.y),t.baseScale=Math.abs(t.scaleX),t.baseScaleX=t.scaleX,t.baseScaleY=t.scaleY,t.setLocalZOrder(e.zOrder),void 0!==e.rotation&&t.setRotation(e.rotation),t},Decors.prototype.addAnimation=function(e){var t=bundles.main.jsons[e.json]||e.json,n=new cleverapps.Spine(t);e.scale&&(e.scale.x?n.setScale(e.scale.x,e.scale.y):n.setScale(e.scale));var s=void 0===e.looped||e.looped;return n.setLocalZOrder(e.zOrder),n.setVisible(!0),void 0!==e.delay?n.runAction(new cc.Sequence(new cc.DelayTime(e.delay),new cc.CallFunc(function(){n.setAnimation(0,e.animation,s)}))):n.setAnimation(0,e.animation,s),n},Decors.prototype.getPos=function(e){return e.position&&Array.isArray(e.position)?e.position[cleverapps.wideMode.mode]:cc.p(e.x,e.y)},Decors.prototype.updateAll=function(){for(var e in this.decors){var t=this.decors[e],
n=cleverapps.styles.Decorators[e],s=this.getPos(n);t.setPositionRound(s.x,s.y)}},Decors.TYPE_IMAGE=0,Decors.TYPE_ANIMATION=1,Decors.TYPE_SCALE9=2;var RulesWindow=Window.extend({onWindowLoaded:function(e){var t=cleverapps.overrideStyles(cleverapps.styles.RulesWindow,e.styles,!0),n=new cc.Node;n.setAnchorPoint2(),n.setContentSize2(t.animation.width,t.animation.height);var s=new cleverapps.Spine(t.animation.json);s.setAnimation(0,t.animation.name,!0),s.setScale(t.animation.scale),s.setPositionRound(n.width/2+t.animation.x,n.height/2+t.animation.y),n.addChild(s);var i=t.font||cleverapps.styles.FONTS.WINDOW_SMALL_TEXT,o=cleverapps.UI.generateTTFText(t.prefix+"text3",i);o.setDimensions(t.subText.width,0),o.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER),n.addChild(o),o.setPositionRound(t.subText.left.x,t.subText.left.y);var r=cleverapps.UI.generateTTFText(t.prefix+"text4",i);r.setDimensions(t.subText.width,0),r.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER),n.addChild(r),
r.setPositionRound(t.subText.right.x,t.subText.right.y);var a=cleverapps.UI.generateTTFText(t.prefix+"text1",i);a.setDimensions(t.text.width,0),a.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER),n.addChild(a),a.setPositionRound(t.subText.bottom.x,t.subText.bottom.y);var c=cleverapps.UI.generateTTFText(t.prefix+"text2",cleverapps.styles.FONTS.RULES_WINDOW_TEXT||t.text.font);c.setDimensions(t.text.width,0),c.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER),c.fitTo(void 0,t.text.height),c.setAnchorPoint2();var l=this.content=new cc.Node;l.addChild(c),l.addChild(n),cleverapps.UI.arrangeWithMargins(l.children,{margin:t.margin,y:t.paddingY}),cleverapps.UI.wrap(l),l.setAnchorPoint2(),this._super({title:t.prefix+"Title",name:e.name,content:l,button:{width:t.button.width,height:t.button.height,text:e.buttonText||Messages.get("OK"),onPressed:this.onPressed.bind(this)}})},onPressed:function(){this.close()},listBundles:function(e){return e&&e.bundles||[]}});cleverapps.styles.RulesWindow={
width:600,height:800,margin:30,textMargin:30,paddingY:40,animation:{scale:.95,width:600,height:670,y:-85,x:0,name:"animation"},subText:{width:190,left:{x:{align:"left",dx:20},y:{align:"right",dy:-180}},right:{x:{align:"right",dx:55},y:{align:"right",dy:-220}},bottom:{x:{align:"center",dx:0},y:{align:"left",dy:0}}},text:{width:640,height:300,font:cleverapps.styles.FONTS.WINDOW_TEXT},button:{width:250,height:100}};var BoostersSaleWindow=Window.extend({onWindowLoaded:function(e){this.mission=e,this.mission.logic.onRewardListener=this.createListener(this.giveReward.bind(this)),this._super({content:this.getContent(),title:{text:"messages:BoostersSaleWindow.title",font:cleverapps.styles.FONTS.BOOSTERS_SALE_WINDOW_TITLE_TEXT},name:"boosterssalewindow",windowBg:bundles.boosters_sale.frames.window_bg_png,styles:cleverapps.overrideStyles(cleverapps.styles.Window,this.getStyles().window,!0)}),this.addBadge(),this.addBalloons(),this.addRibbonTitle(),this.addProgressBar(),this.addRepeatablePattern(
),this.addDescriptionText(),this.addHeroAnimation(),this.text.width>this.window.width&&this.text.setScale(this.window.width/this.text.width),cleverapps.audio.playSound(bundles.main.urls.sale_window_effect)},getStyles:function(){return cleverapps.styles.BoostersSaleWindow},createWinStreakBar:function(){var e=cleverapps.styles.BoostersSaleWindow.progressBar,t=cleverapps.UI.createScale9Sprite(bundles.boosters_sale.frames.boosterssale_streak_bar_bg);t.setLocalZOrder(1),e.width&&t.setContentSize2(e.width,t.height);var n=this.winStreakBar=new ScaledProgressBar(bundles.boosters_sale.frames.boosterssale_streak_bar);if(n.setDimension(e.bar.width||t.width,e.bar.height||t.height),n.setPosition(e.bar.x,e.bar.y),t.addChild(n),n.setLocalZOrder(e.bar.zOrder),e.bar.lines){var s=new cc.Sprite(bundles.boosters_sale.frames.boosterssale_streak_bar_line);s.setAnchorPoint2(),s.setPosition(t.width/2,t.height/2),t.addChild(s)}return t},updateBoughtAmountText:function(){
this.boughtAmountText&&this.boughtAmountText.setString(this.mission.result+"/5")},addProgressBar:function(){var e=this.getStyles();this.progressBarText=cleverapps.UI.generateTTFText("messages:BoostersSaleWindow.progressBarText",cleverapps.styles.FONTS.BOOSTERS_SALE_PROGRESS_BAR_TEXT||cleverapps.styles.FONTS.WHITE_TEXT),this.progressBarText.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER),this.progressBarText.setDimensions(e.progressBar.text.width,0),this.progressBarText.fitTo(0,e.progressBar.text.height);var t=this.createWinStreakBar();this.winStreakBar.setPercentage(20*this.mission.result);var n=this.prizeNode=new cc.Node;n.setAnchorPoint2(),n.setContentSize2(e.progressBar.prize),n.setScale(e.progressBar.prize.scale);var s=this.prizeAnimation=new cleverapps.Spine(e.progressBar.prize.animation.json);s.setAnimation(0,"green_idle_closed",!0),n.addChild(s),s.setPositionRound(e.progressBar.prize),cleverapps.tooltipManager.create(n,{rewards:this.mission.prize,text:Messages.get(
"TreasureSearch.prizeTooltip"),size:e.tooltip.size,position:e.tooltip});var i=new cleverapps.Layout([t,this.progressBarText],{direction:cleverapps.UI.VERTICAL,margin:e.progressBar.textMargin});if(e.progressBar.amount){var o=this.boughtAmountText=cleverapps.UI.generateTTFText(this.mission.result+"/5",cleverapps.styles.FONTS.BOOSTERS_SALE_PROGRESS_BAR_AMOUNT_TEXT||cleverapps.styles.FONTS.WHITE_TEXT);t.addChild(o),o.setPositionRound(e.progressBar.amount)}var r=new cleverapps.Layout([i,n],{direction:cleverapps.UI.HORIZONTAL,margin:e.progressBar.prizeMargin});this.progressBarLayout=r,this.window.addChild(r);var a=e.progressBar.insideWindow?1:-1;r.setPositionRound({x:{align:"center",dx:e.progressBar.dx},y:{align:"bottom",dy:a*(r.height/2+e.progressBar.marginY)}}),e.progressBar.scale&&r.setScale(e.progressBar.scale[cleverapps.wideMode.mode])},addRibbonTitle:function(){var e=this.getStyles().title;if(e.ribbonTitle){var t=cleverapps.UI.createScale9Sprite(bundles.main.frames.ribbon,
cleverapps.UI.Scale9Rect.TwoPixelXY);this.window.addChild(t),t.setAnchorPoint2();var n=e.ribbonTitle.width;this.window.titleText.width+2*e.ribbonTitle.offsetX>n&&(n=this.window.titleText.width+2*e.ribbonTitle.offsetX),t.setContentSize2(n,e.ribbonTitle.height),t.setPositionRound(this.window.titleText.x,this.window.titleText.y+e.ribbonTitle.y),t.setLocalZOrder(this.window.titleText.getLocalZOrder()-1)}},addBadge:function(){var e=this.getStyles().badge;if(e){var t=new cc.Sprite(bundles.boosters_sale.frames.badge_png),n=cleverapps.UI.generateTTFText("messages:BoostersSaleWindow.badge.text",cleverapps.styles.FONTS.TILE_SHOP_BADGE_TEXT),s=cleverapps.UI.generateTTFText("90%",cleverapps.styles.FONTS.TILE_SHOP_BADGE_TEXT);t.setScale(e.scale),s.setScale(1.2);var i=new cleverapps.Layout([s,n],{direction:cleverapps.UI.VERTICAL,margin:e.margin});i.setRotation(e.rotation),t.addChild(i),i.setPositionRound(t.width/2,t.height/2),this.window.addChild(t),t.setPositionRound(e),t.setLocalZOrder(10)}},
addBalloons:function(){this.getStyles().balloons.forEach(function(e){var t=new cleverapps.Spine(bundles.boosters_sale.jsons.balloon_json);t.setScaleX(e.scale),t.setAnimation(0,"animation",!0),this.window.addChild(t),t.setPositionRound(this.window.width/2+e.x,this.window.height+e.y),t.setLocalZOrder(-1)}.bind(this))},addRepeatablePattern:function(){},addDescriptionText:function(){var e=cleverapps.styles.BoostersSaleWindow,t=cleverapps.UI.generateTTFText("messages:BoostersSaleWindow.descriptionText",cleverapps.styles.FONTS.BOOSTERS_SALE_DESCRIPTION_TEXT||cleverapps.styles.FONTS.WHITE_TEXT,{purchasesCount:BoostersSaleWindow.PURCHASES_TO_PRIZE});t.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER),t.setDimensions(e.progressBar.descriptionText.width[cleverapps.wideMode.mode]*resolutionScale,0),t.fitTo(void 0,e.progressBar.descriptionText.height),e.progressBar.insideWindow?this.window.addChild(t):this.progressBarLayout.addChild(t),t.setPositionRound({x:{align:"center"},y:{align:"bottom",
dy:-t.height/2-e.progressBar.descriptionText.marginY}})},addHeroAnimation:function(){var e=cleverapps.styles.BoostersSaleWindow;if(e.heroAnimation){var t="idle";"tripeaks"===cleverapps.config.name&&(t="starterpack_800");var n=new cleverapps.Spine(bundles.hero.jsons.hero_json);n.setAnimation(0,t,!0),n.setPositionRound(e.heroAnimation.position[cleverapps.wideMode.mode]),n.setScale(e.heroAnimation.scale[cleverapps.wideMode.mode]),this.addChild(n)}},calcOldPrice:function(e){return cleverapps.payments.calcLoadedPrice?cleverapps.payments.calcLoadedPrice(e):Product.CURRENCY+" "+e},createIconsLayout:function(e){for(var t=bundles.boosters_sale.frames[e.icon]||bundles.reward_icons.frames[e.icon]||bundles.tile_shop.frames[e.icon]||bundles.main.frames[e.icon],n=this.getStyles(),s=[],i=0;i<5;i++){var o=new cc.Node;o.setAnchorPoint2(),o.setContentSize2(n.icons);var r=new cc.Sprite(t);o.addChild(r),r.setRotation(n.icons.rotation),r.setScale(n.icons.scale||Math.min(o.width/r.width,o.height/r.height)),
r.setLocalZOrder(-i),r.setPositionRound(o.width/2,o.height/2),s.push(o)}return new cleverapps.Layout(s,{direction:cleverapps.UI.HORIZONTAL,margin:n.icons.margins[cleverapps.wideMode.mode].margin})},getContent:function(){var w=this.getStyles(),b=[];this.mission.logic.listProducts(this.mission).forEach(function(e){var t,n=Product.Create(e),s=this.createIconsLayout(n);if(-1!==["cellPack2","linePack3","colorPack4"].indexOf(e)){var i;(i=new cc.Node).setAnchorPoint2();var o=s.width/10,r=s.height/3;i.setContentSize2(s.width+o,s.height+r/3);var a=this.createIconsLayout(n);s.setPositionRound(i.width/2+o/2,i.height/2+r/2),a.setPositionRound(i.width/2-o/2,i.height/2-r/2),i.addChild(s),i.addChild(a)}else i=s;w.icons.bg?(t=new cc.Scale9Sprite(w.icons.bg),w.icons.bgColor&&t.setColor(w.icons.bgColor)):(t=new cc.Node).setAnchorPoint2(),t.setContentSize2(i.width+2*w.icons.padding.x,i.height+2*w.icons.padding.y),t.addChild(i);var c=w.icons.offset;w.icons.offsetByType[this.mission.type]&&(
c=w.icons.offsetByType[this.mission.type]),i.setPositionRound(t.width/2+c.x,t.height/2+c.y);var l=cleverapps.UI.generateOnlyText(n.label,cleverapps.styles.FONTS.BOOSTERS_SALE_AMOUNT_TEXT);if(w.labelBg){var p=new cc.Scale9Sprite(bundles.boosters_sale.frames.label_bg_png);p.setContentSize2(l.width+2*w.labelBg.padding.x,l.height+2*w.labelBg.padding.y),p.addChild(l),t.addChild(p),l.setPositionRound(p.width/2,p.height/2+w.labelBg.text.dy),p.setPositionRound(w.label)}else t.addChild(l),l.setPositionRound(w.label);var d=cleverapps.UI.generateTTFText(Messages.get("BoostersSaleWindow.oldPrice"),cleverapps.styles.FONTS.BOOSTERS_SALE_PRICE_TEXT);d.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER),d.fitTo(w.oldPriceText.width);var u=cleverapps.UI.generateTTFText(this.calcOldPrice(n.oldPrice),cleverapps.styles.FONTS.BOOSTERS_SALE_TEXT);u.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER),u.fitTo(w.oldPriceText.price.width);var h=new cleverapps.Layout([d,u],{direction:cleverapps.UI.HORIZONTAL,
margin:w.oldPriceText.margin});d.setPositionRound({y:{align:"bottom"},x:d.x});var g=new cc.Node;g.setAnchorPoint2(),g.setContentSize2(w.oldPriceText.width+w.oldPriceText.price.width,w.oldPriceText.height),g.addChild(h),h.setPositionRound(g.width/2,g.height/2);var v=new cleverapps.UI.Button({content:new ProductPriceView(n,{font:cleverapps.styles.FONTS.BOOSTERS_SALE_WINDOW_BUTTON_TEXT||cleverapps.styles.FONTS.BUTTON_TEXT}),onClicked:function(){this.mission.completed||n.buy(function(){this.mission.update(1),this.winStreakBar.setPercentage(20*this.mission.result),this.updateBoughtAmountText()}.bind(this))}.bind(this),width:w.button.width,height:w.button.height,button_on_png:bundles.buttons_main.frames.small_green_button_on,button_png:bundles.buttons_main.frames.small_green_button});Lottery.addIcon(v);var m=new cleverapps.Layout([v,g],{direction:cleverapps.UI.VERTICAL,margin:w.button.margin,y:w.button.y}),f=new cleverapps.Layout([t,m],{direction:cleverapps.UI.HORIZONTAL,margin:w.colMargin,
padding:w.row.padding[cleverapps.wideMode.mode]}),_=new cc.Scale9Sprite(bundles.boosters_sale.frames.row_bg_png||w.row.bg);if(_.setContentSize2(f.getContentSize()),w.row.innerBg){var y=new cc.Scale9Sprite(w.row.innerBg.image);y.setContentSize2(_.width-2*w.row.innerBg.padding.x,_.height-2*w.row.innerBg.padding.y),_.addChild(y),y.setPositionRound(_.width/2,_.height/2)}_.addChild(f),f.setPositionRound(_.width/2,_.height/2),b.push(_)}.bind(this));var t=0;b.forEach(function(e){t=Math.max(t,e.getContentSize().width)}),b.forEach(function(e){e.setContentSize2(t,e.getContentSize().height)});var e=this.createText(),n=new cleverapps.Layout(b,{direction:cleverapps.UI.VERTICAL,margin:w.rowMargin});return new cleverapps.Layout([n,e],{direction:cleverapps.UI.VERTICAL,margin:w.margin})},openRewardWindow:function(){new RewardWindow({reward:this.mission.logic.reward})},giveReward:function(){this.winStreakBar.animatedChange(20),this.updateBoughtAmountText(),this.prizeAnimation.setCompleteListener(
this.close.bind(this)),this.prizeAnimation.setAnimation(0,"green_open",!1),this.prizeNode.setLocalZOrder(20),this.prizeNode.replaceParentSamePlace(this);var e=this.prizeNode.getPosition(),t=cc.p(this.width/2,this.height/2),n=cc.p((e.x+t.x)/2,2*(t.y-e.y));this.prizeNode.runAction(new cc.BezierTo(.5,[e,n,t]))},onClose:function(){this.mission.logic.reward&&this.openRewardWindow()},createText:function(){var e=this.getStyles(),t=cleverapps.UI.generateTTFText("messages:BoostersSaleWindow.textTop",cleverapps.styles.FONTS.BOOSTERS_SALE_TOP_TEXT);t.setDimensions(e.textTop.width,0),t.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER);var n=[];if(Messages.has("messages:BoostersSaleWindow.textLeft."+this.mission.type)){var s=cleverapps.UI.generateTTFText("messages:BoostersSaleWindow.textLeft."+this.mission.type,cleverapps.styles.FONTS.BOOSTERS_SALE_TOP_TEXT);n.push(s)}var i=cleverapps.UI.generateTTFText("messages:BoostersSaleWindow.textMiddle."+this.mission.type,
cleverapps.styles.FONTS.BOOSTERS_SALE_TOP_RED_TEXT);n.push(i);var o=cleverapps.UI.generateTTFText("messages:BoostersSaleWindow.textRight."+this.mission.type,cleverapps.styles.FONTS.BOOSTERS_SALE_TOP_TEXT);n.push(o);var r=new cleverapps.Layout(n,{direction:cleverapps.UI.HORIZONTAL,margin:e.text.bottomMargin});return this.text=new cleverapps.Layout([r,t],{direction:cleverapps.UI.VERTICAL,margin:e.text.margin})}});BoostersSaleWindow.prototype.listBundles=function(){return["boosters_sale","reward_icons","tile_shop"]},BoostersSaleWindow.PURCHASES_TO_PRIZE=5,cleverapps.overrideFonts(cleverapps.styles.FONTS,{BOOSTERS_SALE_TEXT:{size:45,color:cleverapps.styles.COLORS.BOOSTERS_SALE_TEXT_COLOR},BOOSTERS_SALE_TOP_TEXT:{size:50,color:cleverapps.styles.COLORS.WHITE},BOOSTERS_SALE_TOP_RED_TEXT:{size:50,color:cleverapps.styles.COLORS.COLOR_RED},BOOSTERS_SALE_PRICE_TEXT:{size:45,color:cleverapps.styles.COLORS.BOOSTERS_SALE_TEXT_COLOR},BOOSTERS_SALE_AMOUNT_TEXT:{size:40,
color:cleverapps.styles.COLORS.WHITE}}),cleverapps.styles.BoostersSaleWindow={progressBar:{bar:{x:0,y:0,zOrder:0,interval:67,lines:!0},dx:0,marginY:-21,prizeMargin:-40,textMargin:30,text:{width:400,height:50},prize:{width:100,height:100,x:50,y:30,scale:1.5,animation:{json:bundles.boosters_sale.jsons.prize_json}},descriptionText:{width:[390,600,600],height:90,marginY:50}},tooltip:{rewards:{x:{align:"center",dx:-20},y:{align:"top",dy:60}},size:{width:220,height:100}},button:{width:240,height:90,margin:10,y:0},title:{ribbonTitle:{width:620,height:120,y:-10,offsetX:40,scaleY:1.3}},icons:{x:-15,width:120,height:120,rotation:0,bg:bundles.boosters_sale.frames.product_bg_png,bgColor:cleverapps.styles.COLORS.COLOR_VERYLIGHTBROWN,margins:[{margin:-80},{margin:-50},{margin:-50}],offset:{x:0,y:0},offsetByType:{12:{x:0,y:20}},padding:{x:5,y:25}},label:{x:{align:"right",dx:-5},y:{align:"bottom",dy:5}},amount:{margin:-30},text:{margin:10,bottomMargin:8},textTop:{width:700},oldPriceText:{width:200,
height:70,margin:8,price:{width:135}},badge:{x:{align:"left",dx:5},y:{align:"top",dy:100},rotation:-20,margin:-10,scale:1},row:{bg:bundles.boosters_sale.frames.row_bg_png,padding:[{x:20,y:30},{x:30,y:30},{x:30,y:30}]},rowMargin:20,colMargin:20,margin:10,balloons:[{y:-165,x:-250,scale:-1},{y:-165,x:250,scale:1}],window:{contentOffset:-30,noBackground:{keepSize:!0},bgOffset:{y:20,x:0}}};var FavoriteSaleWindow=Window.extend({onWindowLoaded:function(e){this.mission=e;var t=this.getStyles();this._super({content:this.getContent(),title:this.getTitle(),name:"favoritesalewindow",button:{width:t.button.width,height:t.button.height,button_png:t.button.button_png,button_on_png:t.button.button_on_png,content:new ProductPriceView(this.mission.logic.product,{font:cleverapps.styles.FONTS.FAVORITE_SALE_WINDOW_BUTTON_TEXT||cleverapps.styles.FONTS.BUTTON_TEXT}),onPressed:this.buyProduct.bind(this)},styles:cleverapps.overrideStyles(cleverapps.styles.Window,this.getStyles().window,!0)}),
this.addBottomAnimation();var n=this.window.scaleX*this.window.width/(this.content.scaleX*this.content.width+t.content.paddingX);n<1&&(this.content.setScaleX(this.content.getScaleX()*n),this.content.setScaleY(this.content.getScaleY()*n)),this.addRibbonTitle(),this.addHeroAnimation(),Lottery.addIcon(this.button),cleverapps.audio.playSound(bundles.main.urls.sale_window_effect)},addHeroAnimation:function(){var e=cleverapps.styles.FavoriteSaleWindow;if(e.heroAnimation){var t=new cleverapps.Spine(bundles.hero.jsons.hero_json);t.setAnimation(0,"idle",!0),t.setPositionRound(e.heroAnimation.position[cleverapps.wideMode.mode]),t.setScale(e.heroAnimation.scale[cleverapps.wideMode.mode]),this.addChild(t)}},addRibbonTitle:function(){var e=this.getStyles();if(e.title.ribbonTitle){var t=cleverapps.UI.createScale9Sprite(bundles.main.frames.ribbon,cleverapps.UI.Scale9Rect.TwoPixelXY);this.window.addChild(t),t.setAnchorPoint2(),t.setContentSize2(e.title.ribbonTitle),t.setPositionRound(
this.window.titleText.x,this.window.titleText.y+e.title.ribbonTitle.y),t.setLocalZOrder(this.window.titleText.getLocalZOrder()-1)}},getStyles:function(){return cleverapps.styles.FavoriteSaleWindow},getTitle:function(){return{text:"messages:FavoriteSaleWindow.title",font:cleverapps.styles.FONTS.FAVORITE_SALE_WINDOW_TITLE_TEXT}},buyProduct:function(){this.mission.logic.product.buy(function(){new RewardWindow({reward:this.mission.logic.getReward()}),this.close()}.bind(this))},createRewardsList:function(){var o=this.getStyles(),r=[],e=this.mission.logic.getReward(),t=function(e,t){var n=cleverapps.UI.generateTTFText(t,cleverapps.styles.FONTS.FAVORITE_SALE_WINDOW_REWARDS_TEXT),s=new cc.Sprite(o.rewards.icons[e]);s.setScale(o.rewards.iconHeight/s.height);var i=[n,s];o.rewards.reverse&&i.reverse(),r.unshift(new cleverapps.Layout(i,{margin:o.rewards.textMargin,direction:o.rewards.direction}))};for(var n in e)if("unlimitedLives"===n)t(n,Product.FormatUnlimitedLives(e[n]).title);else if(
"boosters"===n)for(var s in e[n])t(s,"x"+e[n][s]);else t(n,e[n]);return new cleverapps.Layout(r,{margin:o.rewards.margin,direction:cleverapps.UI.VERTICAL})},addBottomAnimation:function(){var e=this.getStyles();if(e.bottom){var t=new cleverapps.Spine(e.bottom.json);t.setAnimation(0,e.bottom.animation,!0);var n=new cc.Node;n.setAnchorPoint2(),n.setContentSize2(e.bottom),n.addChild(t),t.setPositionRound(n.width/2+e.bottom.x,n.height/2+e.bottom.y),n.setScale(e.bottom.scale);var s=this.createInfoText(),i=new cc.Scale9Sprite(e.bottom.image);i.setContentSize(s.width+2*e.bottom.text.padding.x,s.height+2*e.bottom.text.padding.y),i.addChild(s),s.setPositionRound(i.width/2+e.bubble.offset.x,i.height/2+e.bubble.offset.y);var o=new cleverapps.Layout([n,i],{direction:cleverapps.UI.HORIZONTAL,margin:e.bottom.margin});this.window.addChild(o),o.setPositionRound(this.window.width/2+e.bottom.offset.x,-o.height/2+e.bottom.offset.y)}},createInfoText:function(){var e=this.getStyles(),
t=cleverapps.UI.generateTTFText("messages:FavoriteSaleWindow.text",cleverapps.styles.FONTS.FAVORITE_SALE_WINDOW_BOTTOM_TEXT);return t.setDimensions(e.bottom.text.width,0),t.fitTo(void 0,e.bottom.text.height),t},addBadge:function(){var e=this.getStyles().badge;if(e){var t=new cc.Sprite(bundles.tile_shop.frames.shop_badge_bestseller_png),n=Messages.get("messages:FavoriteSaleWindow.badge1")+"\n"+Messages.get("messages:FavoriteSaleWindow.badge2");this.content.addChild(t),t.setPositionRound(e),t.setScale(e.scale[cleverapps.wideMode.mode]),t.setRotation(e.rotation),cc.sys.isMobile&&e.mobile&&(t.setRotation(e.mobile.rotation),t.setPositionRound(t.getPositionX()+e.mobile.dx,t.getPositionY()+e.mobile.dy));var s=cleverapps.UI.generateTTFText(n,cleverapps.styles.FONTS.TILE_SHOP_BADGE_TEXT);t.addChild(s),s.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER),s.setPositionRound(e.text),s.fitTo(e.text.width),e.text.rotation&&s.setRotation(e.text.rotation),cc.sys.isMobile&&e.mobile&&e.mobile.text&&(
s.setRotation(e.mobile.text.rotation),s.setScale(e.mobile.text.scale))}},getContent:function(){var e,t=this.getStyles();this.mission.logic.isPackProduct()?(e=new PackProductTile(TileModel.Create(this.mission.logic.product),{noButton:!0,noTitle:!0,size:t.packTile.size})).setScale(t.packTile.scale):e=new CoinsProductTile(TileModel.Create(this.mission.logic.product),{noButton:!0,rewardsBlockNoBg:t.rewardsBlockNoBg,styles:cleverapps.overrideStyles(cleverapps.styles.CoinsProductSmallTile,{offset:{y:void 0===t.tile.offsetY?cleverapps.styles.CoinsProductSmallTile.offset.y:t.tile.offsetY}},!0)}),this.tile=e;var n=this.rewardsList=this.createRewardsList(),s=new cc.Sprite(bundles.favorite_sale.frames.plus_png);s.setScale(t.plus.scale);var i,o=this.content=new cleverapps.Layout([e,s,n],{margin:t.tilesMargin,direction:cleverapps.UI.HORIZONTAL});t.icon.light&&(t.icon.light.image?(i=new cc.Sprite(t.icon.light.image)).setScale(t.icon.light.scale):(i=new cleverapps.Spine(t.icon.light.json,
t.icon.light.scale)).setAnimation(0,t.icon.light.animationName,"true"),this.content.addChild(i),i.setPositionRound(n.x+t.icon.light.offset.x,n.y+t.icon.light.offset.y),i.setLocalZOrder(-1));return this.timerLayout=this.createTimer(),o=new cleverapps.Layout([o,this.timerLayout],{direction:cleverapps.UI.VERTICAL,margin:t.margin}),this.addBadge(),o},createTimer:function(){var e=this.mission.finishTime()-Date.now();this.finished&&(e=0);var t=this.getStyles().timer,n={background_content:!1,font:cleverapps.styles.FONTS.FAVORITE_SALE_TIMER_TEXT||cleverapps.styles.FONTS.WHITE_TEXT},s=new cleverapps.CountDownView(new cleverapps.CountDown(e,{onFinish:function(){this.finished||(this.finished=!0,cleverapps.missionManager.remove(this.mission),this.runAsync(this.addLastChance.bind(this)))}.bind(this)}),n),i=[cleverapps.UI.generateTTFText(this.finished?"messages:FavoriteSaleWindow.lastChance":"messages:FavoriteSaleWindow.Expires",
cleverapps.styles.FONTS.FAVORITE_SALE_TIMER_TEXT||cleverapps.styles.FONTS.WHITE_TEXT),s],o=new cleverapps.Layout(i,{margin:t.margin,direction:cleverapps.UI.HORIZONTAL}),r=this.timerBg=new cc.Scale9Sprite(bundles.favorite_sale.frames.timer_bg_png||bundles.main.frames.timer_bg_png);return r.setContentSize2(o.width+2*t.padding.x,o.height+2*t.padding.y),o.addChild(r),r.setLocalZOrder(-1),r.setPositionRound(o.width/2,o.height/2),o},addLastChance:function(){var e=this.timerLayout.getPosition(),t=this.timerLayout.getParent();this.timerLayout.removeFromParent(!0),this.timerLayout=this.createTimer(),t.addChild(this.timerLayout),this.timerLayout.setPositionRound(e)},listBundles:function(){return["reward_icons","tile_shop","favorite_sale","dialogues","shop_user_gold_view"]}});cleverapps.overrideFonts(cleverapps.styles.FONTS,{FAVORITE_SALE_WINDOW_BOTTOM_TEXT:{size:40,color:new cc.Color(130,70,40,255)},FAVORITE_SALE_WINDOW_REWARDS_TEXT:{size:40,color:new cc.Color(130,70,40,255)}}),
cleverapps.overrideFonts(cleverapps.styles.FONTS,{FAVORITE_SALE_WINDOW_TITLE_TEXT:cleverapps.styles.FONTS.WINDOW_TITLE_TEXT}),cleverapps.styles.FavoriteSaleWindow={plus:{scale:1},tilesMargin:3,margin:20,button:{width:280,height:100},timer:{margin:15,scaleWithRewards:!0,padding:{x:10,y:5}},packTile:{scale:.9},icon:{scale:1.3,light:{json:bundles.favorite_sale.jsons.story_light_animation_json,animationName:"animation",scale:3.2,offset:{x:0,y:-20}}},bottom:{image:bundles.main.frames.tutorial_text_bg_png,margin:20,width:300,height:260,offset:{x:-50,y:0},x:0,y:0,scale:1,json:bundles.dialogues.jsons.default_json,animation:"animation",text:{padding:{x:30,y:15},width:350,height:250}},bubble:{offset:{x:20,y:0}},rewards:{margin:40,textMargin:2,iconHeight:90,icons:{unlimitedLives:bundles.reward_icons.frames.life_unlim,exp:bundles.reward_icons.frames.reward_exp_png,stars:bundles.reward_icons.frames.stars_png,gold:bundles.tile_shop.frames.shop_gold4_png,0:bundles.reward_icons.frames.cellbooster,
1:bundles.reward_icons.frames.linebooster,2:bundles.reward_icons.frames.colorbooster,3:bundles.reward_icons.frames.coin_png,4:bundles.reward_icons.frames.joker_png,5:bundles.reward_icons.frames.coin_png,6:bundles.reward_icons.frames.coin_png,7:bundles.reward_icons.frames.coin_png,8:bundles.reward_icons.frames.hat,9:bundles.reward_icons.frames.pot,10:bundles.reward_icons.frames.magnet_small_png,11:bundles.reward_icons.frames.dice_small_png,12:bundles.reward_icons.frames.joker_small_png,13:bundles.reward_icons.frames.highlight,14:bundles.reward_icons.frames.eye,15:bundles.reward_icons.frames.hint},direction:cleverapps.UI.HORIZONTAL},badge:{text:{width:120,height:120,x:{align:"center",dx:0},y:{align:"center",dy:0}},x:{align:"right",dx:60},y:{align:"center",dy:-220},scale:[.9,1.2,1.2],rotation:15},content:{paddingX:80},title:{},window:{bgOffset:{y:90,x:0},Border:{y:170},contentOffset:0},tile:{offsetY:void 0}},cleverapps.FBLike={prepareCode:function(e){var t=cleverapps.config.facebook.url,
n=cleverapps.config.helpURL.default,s=cleverapps.config.title,i='<div id=\'social\'>  <div class="fb-page" data-href="%{GROUP_LINK}" data-width="%{WIDTH}" data-small-header="false" data-adapt-container-width="true" data-hide-cover="false" data-show-facepile="true"><blockquote cite="%{GROUP_LINK}" class="fb-xfbml-parse-ignore"><a href="%{GROUP_LINK}">%{TITLE} Community</a></blockquote></div>  <br/>\n  <div class="fb-like" \n    data-href="%{LINK}" \n    data-layout="standard" \n    data-action="like" \n    data-show-faces="true">\n  </div></div>'.replace("%{LINK}",t);return i=(i=(i=(i=(i=i.replace("%{TITLE}",s)).replace("%{GROUP_LINK}",n)).replace("%{GROUP_LINK}",n)).replace("%{GROUP_LINK}",n)).replace("%{WIDTH}",e)},prepareCodeOK:function(){return'<div id=\'social\'>  <div class="fb-page" id="groupWidget"></div>  <br/>\n  <div id="likeWidget"></div></div>'},processCode:function(){"undefined"!=typeof FB&&FB.XFBML.parse(document.getElementById("social"))},onResize:function(){
var e=document.getElementById("RightBg"),t="block";parseInt(e.style.width)<260&&(t="none"),document.getElementById("social").style.display=t},processCodeOK:function(n){cleverapps.loadSdk("//connect.ok.ru/connect.js",{onSuccess:function(){var e=cleverapps.config.web_ok.url,t=cleverapps.config.helpURL.web_ok.match(/group\/(.*)/)[1];OK.CONNECT.insertGroupWidget("groupWidget",t,"{width:"+n+", height:335}"),OK.CONNECT.insertShareWidget("likeWidget",e,"{width:"+n+",height:100,st:'oval',sz:30,ck:1}")},onFailure:function(){console.log("Can't load ok sdk for widget!")}})},isAppropriate:function(){return-1!==["facebook","web_ok"].indexOf(cleverapps.User.calcSource())},createLikeButtons:function(){if(cleverapps.FBLike.isAppropriate()&&"undefined"!=typeof document){var e=document.getElementById("RightBg");if(!e)return;var t=parseInt(e.style.width),n=t<260;t=260,(cleverapps.isLocalhost()||"web_ok"===cleverapps.User.calcSource()
)&&cleverapps.config.web_ok&&cleverapps.config.web_ok.url&&cleverapps.config.helpURL&&cleverapps.config.helpURL.web_ok&&(cleverapps.FBLike.prepareCode=cleverapps.FBLike.prepareCodeOK,cleverapps.FBLike.processCode=cleverapps.FBLike.processCodeOK),e.insertAdjacentHTML("afterbegin",cleverapps.FBLike.prepareCode(t)),cleverapps.FBLike.processCode(t),n&&(document.getElementById("social").style.display="none"),cleverapps.afterResolutionChanged(cleverapps.FBLike.onResize)}}},cleverapps.NativeLinks={onResize:function(){var e=document.getElementById("LeftBg"),t="block";parseInt(e.style.width)<250&&(t="none"),document.getElementsByClassName("store-links")[0].style.display=t},createLinks:function(){if(cleverapps.NativeLinks.isAppropriate()){var s=bundles.store_links,e=["amazon","android","ios"].map(function(e){var t={android:s.urls.android_png,ios:s.urls.ios_png,amazon:s.urls.amazon_png}[e],n=cleverapps.config[e]&&cleverapps.config[e].url;if(n&&t)return{link:n,image:t}}).filter(function(e){
return void 0!==e}),t=document.getElementById("LeftBg"),n=0;t&&t.style&&t.style.width&&(n=parseInt(t.style.width)),0<document.getElementsByClassName("store-links").length||(t.insertAdjacentHTML("afterbegin",'<div class="store-links" />'),p=document.getElementsByClassName("store-links")[0],e.forEach(function(e){var t='<a target="_blank" href="%{LINK}">   <img src="%{IMAGE}"/ width=\'246px\' height=\'72px\'></a>'.replace("%{LINK}",e.link);t=t.replace("%{IMAGE}",e.image),p.insertAdjacentHTML("afterbegin",t)}),n<250&&(document.getElementsByClassName("store-links")[0].style.display="none"),cleverapps.afterResolutionChanged(cleverapps.NativeLinks.onResize))}},isAppropriate:function(){return!cc.sys.isMobile&&!cleverapps.screenshotsMode&&-1===["web_mm","mobile_mm","web_ok","mobile_ok","web_vk","mobile_vk","huzcom","plinga","pliega"].indexOf(cleverapps.User.calcSource())}};var FriendView=cc.Node.extend({ctor:function(e,t){this._super(),this.setAnchorPoint(.5,.5),"invite"===e.type&&(
e.avatar=bundles.main.frames.avatar_invite_friend);var n=cleverapps.styles.FriendView;this.setContentSize2(n.width,n.height);var s,i=new cleverapps.UI.Avatar(e);i.setPositionRound(this.width/2,this.height-i.height/2-n.avatar.y),i.setScale(n.avatar.scale),i.baseScale=i.scale,i.setAnchorPoint2(),this.addChild(i),"invite"===e.type?((s=this.score=new cleverapps.UI.Button({button_png:bundles.buttons_main.frames.small_blue_button,button_on_png:bundles.buttons_main.frames.small_blue_button_on,text:Messages.get("LevelStartWindow.Button.Invite"),font:cleverapps.styles.FONTS.HIGHSCORE_INVITE_TEXT,width:n.invite.button.width,height:n.invite.button.height,onClicked:this.inviteFriend.bind(this)})).setCascadeOpacityEnabled(!0),cleverapps.UI.applyHover(i),cleverapps.UI.onClick(i,this.inviteFriend.bind(this))):(s=this.score=cleverapps.UI.generateTTFText(e.score,cleverapps.styles.FONTS.HIGH_SCORE_FONT)).setAnchorPoint2(.5,.5),s.setPositionRound(this.width/2,n.score.y),this.addChild(s),
t<3&&"invite"!==e.type&&(this.cup=new cc.Sprite(bundles.main.frames["levelstart_cup_"+(t+1)]),this.cup.setLocalZOrder(1),i.addChild(this.cup),this.cup.setPositionRound(n.cup.x,n.cup.y)),setTimeout(function(){this.showAnimation(t)}.bind(this),0)},inviteFriend:function(){cleverapps.history.add("invt",1),cleverapps.social.inviteFriends({message:Messages.get("SettingsWindow.InviteFriends.message"),title:Messages.get("SettingsWindow.InviteFriends.title"),element:this},function(e){e===cleverapps.Social.CODE_SUCCEED&&cleverapps.eventLogger.logEvent(cleverapps.EVENTS.HIGHSCORE_INVITE)}.bind(this))},showAnimation:function(e){var t=.5-.1*e,n=function(e){e.baseScale=e.scale,e.scale=0,e.opacity=0,e.runAction(new cc.Sequence(new cc.DelayTime(t+6*.1),new cc.Spawn(new cc.ScaleTo(.2,e.baseScale).easing(cc.easeBackOut()),new cc.FadeIn(.2))))};this.cup&&n(this.cup),n(this.score),this.scale=0,this.runAction(new cc.Sequence(new cc.DelayTime(t+.2),new cc.ScaleTo(.2,1)))}});cleverapps.styles.FriendView={
avatar:{margin:{x:10},scale:.8,y:4},score:{margin:{x:120},y:150},cup:{x:{align:"right",dx:34},y:{align:"bottom",dy:-6}},invite:{button:{width:100,height:46}},width:100,height:290};var HeroView=cleverapps.Spine.extend({ctor:function(e){var t=(e=e&&0<Object.keys(e).length?cleverapps.overrideStyles(cleverapps.clone(cleverapps.styles.HeroView,!0),e):cleverapps.styles.HeroView).vertical||{},n=e.scale||1;cleverapps.wideMode.mode===cleverapps.WideMode.VERTICAL&&(n=t.scale||n),this._super(e.json,n);var s=e;cleverapps.wideMode.mode===cleverapps.WideMode.VERTICAL&&void 0!==t.x&&void 0!==t.y&&(s=t),this.setPositionRound(s);var i=e.start||e.name||e.animation,o=e.idle;i&&o?this.setAnimationAndIdleAfter(i,o):i?this.setAnimation(0,i,!1):o&&this.setAnimation(0,o,!0)},onEnter:function(){this._super(),this.visible=!1,this.runAction(new cc.Sequence(new cc.DelayTime(.1),new cc.CallFunc(function(){var e=this.getPosition();this.y=.5*-this.height,this.visible=!0,this.runAction(new cc.MoveTo(.5,e).easing(
cc.easeBackOut()))}.bind(this))))}});cleverapps.styles.HeroView={json:bundles.hero.jsons.hero_json,idle:"starterpack_800",x:600,y:410,scale:.7,vertical:{scale:.55,x:420,y:310}};var HighScoresComponent=function(e){var t=e.level,n=e.parent,s=cleverapps.styles.HighScoresComponent;if(s&&s.active&&t.isRegular()){var i=t.episode.friendsResults&&t.episode.friendsResults.listFriendResults(t.levelNo);if(!i||0===i.length)return InviteComponent({level:t,parent:n});var o=new cc.Node;if(s.useRibbonTitle){var r=1.2*s.width,a=s.height/2.2,c=cleverapps.UI.createScale9Sprite(bundles.main.frames.ribbon,cleverapps.UI.Scale9Rect.TwoPixelXY);c.setContentSize2(r,a),c.setPositionRound(s.width/2,s.height-.45*a);var l=cleverapps.UI.createScale9Sprite(bundles.main.frames.window_bg_light_png);l.setContentSize2(s.width,s.height),l.setAnchorPoint(0,0),l.setLocalZOrder(-1),o.addChild(l),o.addChild(c)}if(o.setAnchorPoint(.5,.5),o.setContentSize2(s.width,s.height),o.setPositionRound(n.width/2,
o.height/2+cleverapps.UI.getSceneOffsetY()),n.window.y+=(o.height/2+o.y)/2+s.windowY,n.addChild(o),s.Title){var p=cleverapps.UI.generateTTFText("messages:LevelStartWindow.HighScoresTitle",cleverapps.styles.FONTS.HIGHSCORE_TITLE_TEXT);p.setPositionRound(o.width/2,o.height-p.height/2+s.Title.y),p.setAnchorPoint2(),o.addChild(p)}o.visible=!1;var d=o.getPosition();o.setPositionRound(o.x,-2*o.height),o.runAction(new cc.Sequence(new cc.DelayTime(.2),new cc.ToggleVisibility,new cc.MoveTo(.2,d)));for(var u=t.episode.friendsResults.listTop4(t.levelNo,!0);u.length<5;)u.push({type:"invite"});var h=u.map(function(e,t){var n=new FriendView(e,t);return n.setLocalZOrder(5-t),o.addChild(n),n});cleverapps.UI.arrangeWithMargins(h,{direction:cleverapps.UI.HORIZONTAL,x:s.Friend.x,y:s.Friend.y,margin:s.Friend.margin})}};cleverapps.overrideFonts(cleverapps.styles.FONTS,{HIGHSCORE_TITLE_TEXT:{size:55,color:cleverapps.styles.COLORS.WHITE}}),cleverapps.styles.HighScoresComponent={active:!0,useRibbonTitle:!0,
position:{x:{align:"center"},y:{align:"bottom"}},windowY:-30,width:670,height:270,Friend:{x:48,y:40,margin:20},Title:{y:-12}};var HardLevelDecorationComponent=function(e){var t=e.parent,n=t.decors,s=cleverapps.styles.HardLevelDecorationComponent;if(s.active&&n&&t.level.isHard()){Object.keys(s.off).forEach(function(e){n.setVisible(e,!1)}),Object.keys(s.on).forEach(function(e){n.add(e)});var i=n.getDecorById("hard_level_title_bg");if(i){var o=cleverapps.styles.Decorators.hard_level_title_bg;i.setContentSize2(t.window.width-o.offsetWidth,o.height)}var r=n.getDecorById("hardLevelSign");r&&(t instanceof VictoryWindow?n.setVisible("hardLevelSign",!1):(n.setVisible("hardLevelSignVictoryWindow",!1),this.runHardLevelAnimation(r)))}};HardLevelDecorationComponent.prototype.runHardLevelAnimation=function(e){var t=e.baseScale;e.setScale(.1*t),e.setVisible(!1),e.runAction(new cc.Sequence(new cc.DelayTime(.4),new cc.CallFunc(function(){e.setVisible(!0)}),new cc.ScaleTo(.5,1.1*t).easing(
cc.easeBackOut()),new cc.CallFunc(function(){e.runAction(new cc.RepeatForever(new cc.Sequence(new cc.ScaleTo(.5,.9*t).easing(cc.easeIn(1)),new cc.ScaleTo(.5,1.1*t))))})))},cleverapps.styles.HardLevelDecorationComponent={active:!0,on:{},off:{}};var ScoreComponent=function(e){var t=e.level,n=e.score;if(void 0!==n||!t.isRegular()||(n=cleverapps.userresult.getScoresForLevel(t.episode.episodeNo,t.levelNo))){var s=[],i=cleverapps.UI.generateTTFText(n,cleverapps.styles.FONTS.VERY_BIG_TEXT);if(s.push(i),!e.victory){var o=cleverapps.UI.generateTTFText("messages:LevelStartWindow.YourScore",cleverapps.styles.FONTS.WINDOW_BIG_TEXT);s.push(o)}var r=new cleverapps.Spine(bundles.windows.jsons.score_animation_json||bundles.main.jsons.score_animation_json);r.setLocalZOrder(-1),r.setScale(.3),r.runAction(new cc.Sequence(new cc.DelayTime(cleverapps.styles.ScoreComponent.bg.delay),new cc.ScaleTo(.3,1).easing(new cc.easeBackOut),new cc.CallFunc(function(){r.setAnimation(0,"animation",!0)})))
;var a=new cleverapps.Layout(s,{direction:cleverapps.UI.VERTICAL,padding:cleverapps.styles.ScoreComponent.padding});if(a.addChild(r),r.setPosition(i.x,i.y),e.victory){var c=0;i.updateTweenAction=function(e,t){++c%3==0&&i.setString(Math.round(e))},i.setScale(0),i.runAction(new cc.Sequence(new cc.DelayTime(1.4),new cc.Spawn(new cc.ScaleTo(.5,1).easing(cc.easeBackOut()),new cc.CallFunc(function(){cleverapps.audio.playSound(bundles.game.urls.show_score_effect)}),new cc.CallFunc(function(){cc.sys.isNative||i.runAction(new cc.Sequence(new cc.ActionTween(1.7,"score",0,n).easing(cc.easeCubicActionOut()),new cc.CallFunc(function(){i.setString(n),i.setAnchorPoint2()})))}))))}return a}};cleverapps.styles.ScoreComponent={enabled:!0,padding:{x:0,y:0},bg:{delay:0}};var StarsComponent=function(e){var t=cleverapps.styles.StarsComponent,n=new cc.Node;n.setAnchorPoint2(),n.setContentSize2(t);var s=new cleverapps.Spine(t.animation.json),i=e.stars;if(s.setAnimation(0,""+i,!1),s.setPositionRound({x:{
align:"center"},y:{align:"center"}}),n.addChild(s),!e.victory)for(var o=function(e){n.runAction(new cc.Sequence(new cc.DelayTime(t.sound.duration*e),new cc.CallFunc(function(){cleverapps.audio.playSound(bundles.main.urls["star_"+e+"_effect"])})))},r=1;r<=e.stars;r++)o(r);return n};cleverapps.styles.StarsComponent={sound:{duration:.7},animation:{json:bundles.main.jsons.levelstart_stars_json},width:560,height:220};var VictoryAnimationComponent=cc.Node.extend({ctor:function(e){var t=e.victory?cleverapps.styles.VictoryAnimationComponent.victory:cleverapps.styles.VictoryAnimationComponent.levelstart;this._super(),this.setLocalZOrder(t.zOrder||0),this.setContentSize2(t.width,t.height),this.setAnchorPoint2();var n=this.animation=new cleverapps.Spine(t.json);if(n.setPositionRound(this.width/2,this.height/2+(t.y||0)),this.addChild(n),t.idle?(cleverapps.audio.playSound(t.sound),n.setAnimation(0,t.animation,!1),n.setCompleteListener(function(){n.setAnimation(0,t.idle,!0)})):n.setAnimation(0,
t.animation,!0),e.victory&&cleverapps.styles.VictoryWindow.victoryText){var s=cleverapps.UI.generateTTFText("messages:VICTORY",cleverapps.styles.FONTS.VICTORY_TEXT);s.setPositionRound(this.width/2,this.height/2+cleverapps.styles.VictoryWindow.victoryText.y),s.setScale(.3),s.runAction(new cc.ScaleTo(.2,1)),this.addChild(s)}}});VictoryAnimationComponent.prototype.onClose=function(e){this.animation.setCompleteListener(e),this.animation.setAnimation(0,"finish",!1)},cleverapps.styles.VictoryAnimationComponent={levelstart:{animation:"animation",json:bundles.main.jsons.victory_animation_json,width:456,height:370},victory:{json:bundles.game.jsons.victory2_spine_json,animation:"victory_start",idle:"idle",sound:bundles.game.urls.rocket_effect,zOrder:1,width:400,height:240}};var RewardsListComponent=cc.Node.extend({ctor:function(e,t){this._super(),this.reward=e,this.options=t||{},this.targets={},this.createContent()},createContent:function(){var e=cleverapps.styles.RewardsListComponent,
t=this.list=this.createList();t.forEach(function(e){cleverapps.UI.wrap(e)});var n=[];if(this.options.title){var s=cleverapps.UI.generateOnlyText(this.options.title.text||this.options.title,this.options.font);this.options.title.direction===cleverapps.UI.HORIZONTAL?t.unshift(s):n.push(s)}for(var i=0,o=this.options.amountInRow||3;i<t.length;){var r=new cleverapps.Layout(t.slice(i,i+o),{direction:this.options.direction||cleverapps.UI.HORIZONTAL,align:this.options.align||cleverapps.UI.ALIGN_CENTER,margin:this.options.margin||e.margin});n.unshift(r),i+=o}this.content=new cleverapps.Layout(n,{direction:cleverapps.UI.VERTICAL,margin:e.margin}),this.addChild(this.content),this.setContentSize2(this.content),this.setAnchorPoint2(),this.content.setPositionRound(this.width/2,this.height/2)},createOneReward:function(e,t,n,s,i){if(void 0===s)return n.icon=n,this.targets[e]=n;var o=cleverapps.styles.RewardsListComponent,
r=this.options.font||cleverapps.styles.FONTS.REWARDS_LIST_TEXT||cleverapps.styles.FONTS.WINDOW_TEXT;s=this.options.onlyText?cleverapps.UI.generateOnlyText(s,r,i):cleverapps.UI.generateTTFText(s,r,i),this.options.iconScale&&n.setScale(this.options.iconScale);var a=[s,n],c=cleverapps.UI.VERTICAL;this.options.reward&&this.options.reward.direction===cleverapps.UI.HORIZONTAL&&(c=cleverapps.UI.HORIZONTAL,a=a.reverse());var l=this.targets[e]=new cleverapps.Layout(a,{direction:c,margin:o.box.margin});return l.icon=n,l.text=s,l.reward=t,l},createList:function(){var e=cleverapps.styles.RewardsListComponent,t=this.reward,n=[],s="x";if(this.options.reward&&void 0!==this.options.reward.amountPrefix&&(s=this.options.reward.amountPrefix),void 0!==t.boosters)for(var i in t.boosters)t.boosters[i]&&n.push(this.createOneReward("boosters_"+i,t.boosters[i],new cc.Sprite(e.boosters.icons[i]),s+t.boosters[i]));if(void 0!==t.gold&&n.push(this.createOneReward("gold",t.gold,new cc.Sprite(
bundles.reward_icons.frames.reward_gold_png),s+t.gold)),void 0!==t.exp&&levels.user.expAvailable()&&n.push(this.createOneReward("exp",t.exp,new cc.Sprite(bundles.reward_icons.frames.reward_exp_png),s+t.exp)),void 0!==t.unlimitedLives&&(t.unlimitedLives=Product.FormatUnlimitedLives(t.unlimitedLives),n.push(this.createOneReward("unlimitedLives",t.unlimitedLives,new cc.Sprite(bundles.reward_icons.frames.life_unlim),t.unlimitedLives.title,{amount:t.unlimitedLives.amount}))),void 0!==t.battlePass){var o=new cleverapps.Spine(bundles.battle_pass.jsons.ticket_json);o.setAnimation(0,"animation",!0),n.push(this.createOneReward("battlePass",t.battlePass,o,"messages:BattlePassProduct.Title"))}if(void 0!==t.coins&&n.push(this.createOneReward("coins",t.coins,new cc.Sprite(bundles.reward_icons.frames.reward_coin_png),s+t.coins)),void 0!==t.rubies&&n.push(this.createOneReward("rubies",t.rubies,new cc.Sprite(bundles.reward_icons.frames.reward_gold_png),s+t.rubies)),void 0!==t.energy&&n.push(
this.createOneReward("energy",t.energy,new cc.Sprite(bundles.reward_icons.frames.reward_energy_png),s+t.energy)),void 0!==t.wands&&n.push(this.createOneReward("wands",t.wands,new cc.Sprite(bundles.reward_icons.frames.reward_wand_png),s+t.wands)),void 0!==t.worker&&(t.worker=Product.FormatUnlimitedLives(t.worker),n.push(this.createOneReward("worker",t.worker,new cc.Sprite(bundles.reward_icons.frames.reward_worker_png),t.worker.title,{amount:t.worker.amount}))),void 0!==t.unit)for(var r=0,a=cleverapps.toArray(t.unit);r<a.length;++r){var c=a[r],l=UnitView.getUnitImage(c);l&&n.push(this.createOneReward("unit_"+Unit.GetKey(c),c,l,s+c.amount))}if(void 0!==t.raceKey){if((p=new cc.Node).setAnchorPoint2(),p.setContentSize2(e.race.icon),cleverapps.Spine.isAnimationLoaded(bundles.race.jsons.product_icon))(g=new cleverapps.Spine(bundles.race.jsons.product_icon)).setAnimation(0,"animation",!0),g.setPositionRound(p.width/2,p.height/2),p.addChild(g);n.push(this.createOneReward("raceKey",t.raceKey,p,
"messages:Race.product.title"))}if(void 0!==t.lives&&n.push(this.createOneReward("lives",t.lives,new cc.Sprite(bundles.main.frames.life_reward_png||bundles.main.frames.level_failed_heart_png||bundles.reward_icons.frames.reward_energy_png),s+t.lives)),void 0!==t.stars&&n.push(this.createOneReward("stars",t.stars,new cc.Sprite(bundles.reward_icons.frames.stars_png),s+t.stars)),void 0!==t.gun){if((d=new cc.Node).setAnchorPoint2(),d.setContentSize2(e.gun.width,e.gun.height),e.gun.animation){(g=new cleverapps.Spine(e.gun.animation.json,e.gun.scale)).setContentSize2(d.getContentSize()),g.spine.setPositionRound(g.width/2+e.gun.x,g.height/2+e.gun.y),g.setAnimation(0,e.gun.animation.name,!0),d.addChild(g)}else{var p=new cc.Sprite(bundles.game.frames.gun_icon);d.addChild(p),p.setPositionRound(d.width/2,d.height/2)}n.push(this.createOneReward("gun",t.gun,d))}if(t.wardrobe&&cleverapps.missionManager.getRunningMission(Missions.SEMAPHORE_WARDROBE)){var d,u=cleverapps.styles.WardrobeWindow.person;(
d=new cc.Node).setAnchorPoint2(),d.setContentSize2(e.wardrobe.width,e.wardrobe.height);var h=new cleverapps.Spine(u.json,u.scale);h.setAnimation(0,"idle",!0),d.addChild(h),n.push(this.createOneReward("wardrobe",t.wardrobe,d))}if(void 0!==t.herolevels&&Array.isArray(t.herolevels)&&0<t.herolevels.length)for(r=0;r<t.herolevels.length;r++){var g,v=t.herolevels[r][0].toUpperCase(),m=new cc.Node;m.setAnchorPoint2(),m.setContentSize2(e.herolevel.heroBuilding.width,e.herolevel.heroBuilding.height),(g=new cleverapps.Spine(bundles.heroes.jsons[v+"_hero_spine_json"],e.herolevel.heroBuilding.scale)).setSkin(match3.heroes.getCurrentSkin()),g.setAnimation(0,"idle",!0),m.addChild(g);var f=new cleverapps.Layout([m],{direction:cleverapps.UI.VERTICAL}),_=new cc.Node;_.setContentSize2(e.herolevel.animation.width,e.herolevel.animation.height),g.setPositionRound(m.width/2,m.height/2+e.herolevel.animation.offsetY),_.addChild(f),f.setPositionRound(_.width/2,_.height/2),_.setPositionRound({x:{align:"center"},
y:{align:"center"}});var y=cleverapps.UI.createScale9Sprite(e.herolevel.levelBlock.bg);y.setContentSize2(e.herolevel.levelBlock.width,e.herolevel.levelBlock.height),y.setPositionRound(e.herolevel.levelBlock.x,e.herolevel.levelBlock.y),m.addChild(y);var w=cleverapps.UI.generateImageText(Math.max(0,Math.min(Heroes.HEROES_MAX_LEVEL,t.herolevels[r][1])),cleverapps.styles.FONTS.WINDOW_WHITE_TEXT);w.setPositionRound(y.width/2,y.height/2),y.addChild(w),n.push(_)}return n},iterateRewards:function(e){for(var t in this.targets){var n=this.targets[t];n&&(0===t.indexOf("boosters")?e(n,t,this.reward.boosters[t.split("_")[1]]):e(n,t,n.reward))}}});cleverapps.styles.RewardsListComponent={margin:30,box:{margin:10},boosters:{icons:{0:bundles.reward_icons.frames.cellbooster,1:bundles.reward_icons.frames.linebooster,2:bundles.reward_icons.frames.colorbooster,3:bundles.reward_icons.frames.hint_icon_png}},gun:{width:100,height:100,y:0,x:0,animation:{json:bundles.game.jsons.gun_animation_json,name:"idle"}},
wardrobe:{width:150,height:150},race:{icon:{width:170,height:170}},herolevel:{levelBlock:{bg:bundles.heroes&&bundles.heroes.frames.heroes_level_bg||bundles.main.frames.heroes_level_bg,width:70,height:50,x:120,y:-40},animation:{width:200,height:250,offsetY:-40},heroBuilding:{width:120,height:120,scale:1.5},additionalText:{x:0,y:0}}};var MinigameRewardsComponent=cleverapps.Layout.extend({ctor:function(e){var t=RewardsHelper.getDisplayData(e,{itemsPrefix:"x",short:!0});if(1===cleverapps.values(t).length){var n=new RewardsListComponent(e,{direction:cleverapps.UI.VERTICAL,font:cleverapps.styles.FONTS.MINIGAME_REWARD});n.setScale(cleverapps.styles.MinigameRewardsComponent.itemSize.width/n.width),this.items=[n]}else this.items=cleverapps.values(t).map(function(e,t){return this.createReward(e.img,e.txt,0==t)}.bind(this));this._super(this.items,{direction:cleverapps.UI.VERTICAL}),e.unlimitedLives&&(e.unlimitedLives=Product.FormatUnlimitedLives(e.unlimitedLives))},createReward:function(e,t,n){
var s=cleverapps.styles.MinigameRewardsComponent,i=new cc.Node;if(i.setAnchorPoint2(),i.setContentSize2(s.itemSize),!n&&s.separator){var o=new cc.Sprite(s.separator.image);o.setAnchorPoint2(),o.setPositionRound({align:"center"},{align:"bottom"}),i.addChild(o),i.setContentSize2(s.itemSize.width,s.itemSize.height+o.height)}var r=new cc.Sprite(e);r.setAnchorPoint2(),r.setPositionRound({align:"left"},{align:"center",dy:o?o.height/2:0}),r.setScale(.8*s.iconHeight/r.height),i.addChild(r);var a=cleverapps.UI.generateTTFText(t,cleverapps.styles.FONTS.MINIGAME_REWARD),c=s.itemSize.width-r.width*r.scaleX-s.iconTextSpacing;return a.width>c&&a.fitTo(c),a.setAnchorPoint2(),a.setPositionRound({align:"right"},{align:"center",dy:(o?o.height/2:0)+s.textOffsetY}),i.addChild(a),i}});cleverapps.overrideFonts(cleverapps.styles.FONTS,{MINIGAME_REWARD:{name:"nostroke",size:40,color:cleverapps.styles.COLORS.MINIGAME_REWARD_TEXT}}),cleverapps.styles.MinigameRewardsComponent={separator:{
image:bundles.windows.frames.lottery_items_dots_png},itemSize:{width:160,height:60},iconHeight:60,iconTextSpacing:20,textOffsetY:0};var InviteComponent=function(e){var t=cleverapps.FBLoginOrInvite();if(t){var n=cleverapps.styles.InviteComponent;e.parent.addChild(t),e.parent.window.y+=(t.height/2+t.y)/2+n.y}};cleverapps.styles.InviteComponent={y:-10};var RoundResultsComponent=cc.Node.extend({ctor:function(e){this._super(),this.setAnchorPoint2();var a=cleverapps.styles.RoundResultsComponent,t=e.competition.getResults().sort(function(e,t){return e.player?-1:1}),c=!1;this.perWordTime=.05,this.maxWords=Math.max(t[0].amount,t[1].amount),this.views=t.map(function(e){var t,n=new cleverapps.UI.Avatar(e),s=e.amount,i=0;0<s&&(i=this.perWordTime*(this.maxWords/s)),.2<i&&(i=.2);var o=new AnimatedCounterComponent({from:0,to:s,font:cleverapps.styles.FONTS.ROUND_WORDS_TEXT,time:i,onFinish:function(){cleverapps.metha.getMainObject().knockoutGame.rumble.getCurrentRound().isWinner(e.id
)?this.runWinAnimation(t):this.runLoseAnimation(t)}.bind(this)});cleverapps.metha.getMainObject().knockoutGame.rumble.getCurrentRound().isWinner(e.id)||(n.setCascadeColorEnabled(!0),n.runAction(new cc.TintTo(this.perWordTime*this.maxWords,120,120,120)));var r=(t=new cleverapps.Layout([o,n],{direction:cleverapps.UI.VERTICAL,margin:a.margin})).name=cleverapps.UI.generateTTFText(GridPlayerNameView.FormatName(e.name),cleverapps.styles.FONTS.ROUND_NAME_TEXT);return r.width>a.name.width&&(c=!0),t.addChild(r),r.setPositionRound(t.width/2,t.height+a.margin+r.height/2),t.avatar=n,t.words=o,t.name=r,t.player=e,t},this),this.user=this.views[0],this.opponent=this.views[1],c&&this.views.forEach(function(e){e.name.setFont(cleverapps.styles.FONTS.ROUND_NAME_SMALL_TEXT),e.name.setPositionRound(e.width/2,e.height+a.margin+e.name.height/2)}),this.content=new cleverapps.Layout(this.views,{direction:cleverapps.UI.HORIZONTAL,margin:a.playersMargin}),this.setContentSize2(this.content.getContentSize()),
this.addChild(this.content),this.content.setPositionRound(this.width/2,this.height/2),this.runAnimation()},runAnimation:function(){this.views.forEach(function(e){e.words.runAnimation()},this)},runWinAnimation:function(e){var t=cleverapps.styles.RoundResultsComponent.animation.user;e.runAction(new cc.Sequence(new cc.DelayTime(.5),new cc.Spawn(new cc.ScaleTo(.4,1.3).easing(cc.easeOut(2)),new cc.MoveTo(.6,cc.p(this.content.width/2,e.y+t.dy)))))},runLoseAnimation:function(e){var t=cc.director.getRunningScene().scene,n=0;0===e.player.amount&&(n=this.perWordTime*this.maxWords),e.runAction(new cc.Sequence(new cc.DelayTime(n),new cc.CallFunc(function(){e.name.setVisible(!1),e.words.setVisible(!1),e.avatar.replaceParentSamePlace(t),e.avatar.setLocalZOrder(100),e.avatar.runAction(new cc.RepeatForever(new cc.RotateBy(1,180))),e.avatar.runAction(new cc.Sequence(new cc.MoveTo(1.2,cc.p(e.avatar.x,-e.avatar.height/2)).easing(cc.easeIn(2)),new cc.RemoveSelf)),cleverapps.audio.playSound(
bundles.game.urls.tournament_player_lose_effect)}.bind(this))))}});cleverapps.overrideFonts(cleverapps.styles.FONTS,{ROUND_WORDS_TEXT:{name:"nostroke",size:60,color:cleverapps.styles.COLORS.COLOR_BROWN},ROUND_NAME_TEXT:{size:30,color:cleverapps.styles.COLORS.COLOR_BROWN},ROUND_NAME_SMALL_TEXT:{size:25,color:cleverapps.styles.COLORS.COLOR_BROWN}}),cleverapps.styles.RoundResultsComponent={animation:{user:{dy:-30},opponent:{}},name:{width:180},margin:10,playersMargin:90};var VictoryWindowHero=cc.Node.extend({ctor:function(){this._super();var e=cleverapps.styles.VictoryWindowHero;this.setContentSize2(e.size),this.setAnchorPoint2();var t=e;cleverapps.wideMode.mode===cleverapps.WideMode.VERTICAL&&(t=e.mobile),this.setPositionRound(t),this.setLocalZOrder(1),this.hero=new cleverapps.Spine(bundles.hero.jsons.hero_json,e.animation.scale),this.addChild(this.hero),this.hero.setPositionRound(this.width/2,this.height/2),this.hero.setAnimation(0,e.animation.idle,!0)},hide:function(){
var e=cleverapps.styles.VictoryWindowHero;this.runAction(new cc.Sequence(new cc.MoveTo(.15,cc.p(this.x,this.y+e.moveUp.dy)).easing(cc.easeOut(2)),new cc.MoveTo(.3,cc.p(this.x,-this.height/2)).easing(cc.easeIn(3))))},show:function(){var e=cleverapps.styles.VictoryWindowHero,t=this.getPosition();this.setPositionRound(this.x,-this.height/2),this.runAction(new cc.Sequence(new cc.MoveTo(.5,t),new cc.CallFunc(function(){e.animation.name&&this.hero.setAnimationAndIdleAfter(e.animation.name,e.animation.idle),"tripeaks"===cleverapps.config.name&&this.runAction(new cc.Sequence(new cc.DelayTime(3),new cc.CallFunc(function(){this.hero.setAnimationAndIdleAfter("victory_window",e.animation.idle)}.bind(this))))}.bind(this))))}});cleverapps.styles.VictoryWindowHero={x:300,y:200,mobile:{x:140,y:200},size:{width:200,height:500},animation:{scale:1,name:"victory_open",idle:"victory_idle"},moveUp:{dy:40}};var AnimatedCounterComponent=cc.Node.extend({ctor:function(e){this._super(),this.setAnchorPoint2(),
this.options=e,this.options.scale=this.options.scale||1.3,this.options.onFinish=this.options.onFinish||function(){},this.options.time=this.options.time||.3;var t=this.options.to-this.options.from;this.increment=0<t?1:0===t?0:-1,this.text=cleverapps.UI.generateTTFText(this.options.from,this.options.font),this.addChild(this.text),this.setContentSize2(this.text.getContentSize()),this.text.setPositionRound(this.width/2,this.height/2),this.current=this.options.from,this.paused=!1,this.started=!1},runAnimation:function(){this.started=!0,this.current=this.options.from,this.paused||this._animateStep()},_animateStep:function(){!this.paused&&this.started&&(this.current!==this.options.to+this.increment?this.text.runAction(new cc.Sequence(new cc.ScaleTo(this.options.time,this.options.scale),new cc.CallFunc(function(){this.text.setString(this.current),this.options.sfx&&cleverapps.audio.playSound(bundles.main.urls["countdown_effect_"+this.current])}.bind(this)),new cc.ScaleTo(this.options.time,1),
new cc.DelayTime(this.options.time),new cc.CallFunc(function(){this.current+=this.increment,this._animateStep()}.bind(this)))):this.options.onFinish())},pauseCountdown:function(){this.paused||(this.paused=!0)},resumeCountdown:function(){this.paused&&(this.paused=!1,this._animateStep())}});cleverapps.styles.AnimatedCounterComponent={};var RoundCountdownComponent=cc.Node.extend({ctor:function(e){this._super(),this.setAnchorPoint2(),this.text=cleverapps.UI.generateTTFText("messages:RoundCountdownComponent.text",cleverapps.styles.FONTS.ROUND_COUNTDOWN_TEXT),this.addChild(this.text),this.setContentSize2(this.text.getContentSize()),this.text.setPositionRound(this.width/2,this.height/2),this.text.setVisible(!1),this.countdown=new AnimatedCounterComponent({from:3,to:1,font:cleverapps.styles.FONTS.ROUND_COUNTDOWN_TIMER_TEXT,scale:1.5,sfx:!0,onFinish:function(){e()}}),this.addChild(this.countdown),this.countdown.setPositionRound(this.width/2,this.height/2),this.countdown.setVisible(!1),
this.runAction(new cc.Sequence(new cc.DelayTime(3),new cc.CallFunc(function(){this.text.setVisible(!0)}.bind(this)),new cc.DelayTime(1.5),new cc.CallFunc(function(){this.text.setVisible(!1),this.countdown.setVisible(!0),this.countdown.runAnimation()}.bind(this))))},pauseCountdown:function(){this.countdown.pauseCountdown()},resumeCountdown:function(){this.countdown.resumeCountdown()}});cleverapps.overrideFonts(cleverapps.styles.FONTS,{ROUND_COUNTDOWN_TEXT:{size:25,color:cleverapps.styles.COLORS.COLOR_BROWN},ROUND_COUNTDOWN_TIMER_TEXT:{name:"nostroke",size:50,color:cleverapps.styles.COLORS.COLOR_BROWN}});var TreasureSearchRewardComponent=cc.Node.extend({ctor:function(e){this._super();var t=cleverapps.styles.TreasureSearchRewardComponent;this.setAnchorPoint2(),e.addChild(this),this.setPositionRound(t);var n=new cleverapps.Spine(bundles.game.jsons.shovel_json,1);this.addChild(n),n.runAction(new cc.Sequence(new cc.DelayTime(2),new cc.CallFunc(function(){n.setAnimationAndIdleAfter("open",
"idle")})))}});TreasureSearchRewardComponent.IsAvailable=function(){return-1!==["olympics"].indexOf(cleverapps.config.name)},cleverapps.styles.TreasureSearchRewardComponent={x:{align:"center",dx:140},y:{align:"center",dy:150}};var WordsListComponent=cc.Node.extend({ctor:function(e){this._super(),this.options=e,this.setAnchorPoint2();var r=cleverapps.styles.WordsListComponent,t=this.options.words.map(function(e){var t=this.options.width-2*r.word.padding.x,n=r.word.height,s=new cc.Node;s.setAnchorPoint2(),s.setContentSize2(t,n);var i=this.createWordBg(t,n);s.addChild(i),i.setPositionRound(s.width/2,s.height/2);var o=cleverapps.UI.generateTTFText(e.toUpperCase(),cleverapps.styles.FONTS.EXTRA_WINDOW_LETTER_TEXT);return s.addChild(o),o.setPositionRound(r.word.text),s}.bind(this)),n=new cleverapps.Layout(t,{direction:cleverapps.UI.VERTICAL,margin:r.words.margin,padding:r.words.padding}),s=new cleverapps.UI.ScrollView(n,{childrenVisibility:cleverapps.UI.ScrollView.CHILDREN_VISIBILITY_LINEAR})
;s.setContentSize2(this.options.width,Math.min(this.options.height,n.height));var i=new cc.Node;if(i.setAnchorPoint2(),i.setContentSize2(s.width,this.options.height),i.addChild(s),s.setPositionRound(i.width/2,i.height-s.height/2),this.setContentSize2(i.width,i.height+2*r.topPadding),this.addChild(i),i.setPositionRound(this.width/2,this.height/2),r.bg){var o=new cc.Scale9Sprite(bundles.main.frames.light_bg_png);o.setContentSize2(this.getContentSize()),this.addChild(o),o.setLocalZOrder(-1),o.setPositionRound(this.width/2,this.height/2)}},createWordBg:function(e,t){var n=new cc.Scale9Sprite(this.getWordBgImage());if(cleverapps.styles.WordsListComponent.word.scaleYOnly){var s=t/n.height;n.width=e/s,n.setScale(s)}else n.setContentSize2(e,t);return n},getWordBgImage:function(){return"stacks"===cleverapps.config.subtype?Game.currentGame.board.level.isTricky()?bundles.game.frames.found_word_bg_tricky_png:Game.currentGame.board.level.isHard(
)?bundles.game.frames.found_word_bg_bonus_png:Game.currentGame.board.level.episode.isBonusRound()?bundles.game.frames.found_word_bg_bonus_png:bundles.game.frames.found_word_bg_png:bundles.main.frames.row_player_png}});cleverapps.styles.WordsListComponent={mouseScrollSpeed:200,word:{height:70,padding:{x:12},text:{x:{align:"center"},y:{align:"center",dy:-5}}},words:{margin:5,padding:{x:0,y:5}},topPadding:4,bg:!0};var MedallionComponent=cc.Node.extend({ctor:function(e){this.options=e,this._super();var t=cleverapps.styles.MedallionComponent;this.setAnchorPoint2(),this.setContentSize2(t),this.setPositionRound(t.positions[cleverapps.wideMode.mode]),this.setLocalZOrder(1e6),t.backgroundAnimation&&(this.backgroundAnimation=new cleverapps.Spine(t.backgroundAnimation),this.backgroundAnimation.setAnimation(0,"idle",!0),this.backgroundAnimation.setPosition(this.width/2,this.height/2),this.addChild(this.backgroundAnimation)),this.createContent(),0!==this.content.length&&(this.visible=!1,setTimeout(
this.showUp.bind(this),500))},showUp:function(){this.backgroundAnimation?this.runAction(new cc.Sequence(new cc.CallFunc(function(){this.visible=!0,this.backgroundAnimation.setAnimationAndIdleAfter("animation","idle")}.bind(this)),new cc.MoveBy(1.1,0,-cleverapps.styles.MedallionComponent.distance).easing(cc.easeBackOut()))):(this.visible=!0,this.y-=cleverapps.styles.MedallionComponent.distance);var n=function(){var e=this.content[this.contentIndex];if(this.contentView=e.spine,this.contentView.setVisible(!0),this.contentView.setPositionRound(this.width/2,this.height/2),1<e.amount&&!cleverapps.styles.MedallionComponent.noAmountText){var t=cleverapps.UI.generateTTFText("x"+e.amount,cleverapps.styles.FONTS.MEDALLION_TEXT);this.contentView.addChild(t),t.setPositionRound(cleverapps.styles.MedallionComponent.textPosition)}this.addChild(this.contentView),e.openAnimation?this.contentView.setAnimationAndIdleAfter(e.openAnimation,e.idleAnimation):this.contentView.setAnimation(0,e.idleAnimation,!0)
,1!==this.content.length?this.runAction(new cc.Sequence(new cc.DelayTime(3),new cc.CallFunc(function(){this.contentView.setVisible(!1),this.contentView.removeFromParent(),this.contentIndex++,this.contentIndex===this.content.length&&(this.contentIndex=0,this.options.showOnce)?this.hide():n()}.bind(this)))):this.options.showOnce&&setTimeout(this.hide.bind(this),3e3)}.bind(this);n()},createContent:function(){this.content=[],this.contentIndex=0,Object.keys(this.options).forEach(function(e){if("shovels"===e){var t=cleverapps.styles.MedallionComponent.animation&&cleverapps.styles.MedallionComponent.animation.shovels;this.content.push({spine:new cleverapps.Spine(bundles.game.jsons.shovel_json),openAnimation:t&&t["open"+this.options[e]]||"open",idleAnimation:t&&t["idle"+this.options[e]]||"idle",amount:this.options[e]})}else"clovers"===e?this.content.push({spine:new cleverapps.Spine(bundles.card.jsons.marks_json),idleAnimation:"gem_idle_counter"}):"stars"===e&&this.content.push({
spine:new cleverapps.Spine(bundles.game.jsons.star_json),openAnimation:"open",idleAnimation:"idle",amount:this.options[e]})}.bind(this))},hide:function(){this.contentView&&(this.contentView.setVisible(!1),this.contentView.removeFromParent(),this.contentView=void 0),this.backgroundAnimation&&(this.backgroundAnimation.removeFromParent(),this.backgroundAnimation=void 0,this.removeFromParent())}});MedallionComponent.IsAvailable=function(){return-1!==["riddles","heroes","wordsoup","crocword","tripeaks","differences","magicwords"].indexOf(cleverapps.config.name)},cleverapps.overrideFonts(cleverapps.styles.FONTS,{MEDALLION_TEXT:{size:40,color:cleverapps.styles.COLORS.WHITE}}),cleverapps.styles.MedallionComponent={backgroundAnimation:bundles.game.jsons.medallion_json,width:200,height:200,distance:400,positions:[{x:{align:"left",dx:20},y:{align:"top",dy:300}},{x:{align:"left",dx:160},y:{align:"top",dy:200}},{x:{align:"left",dx:200},y:{align:"top",dy:200}}],textPosition:{x:{align:"center",dx:30
},y:{align:"center",dy:-45}}};var RepeatablePattern=cleverapps.Layout.extend({ctor:function(e,t){for(var n=cleverapps.styles.RepeatablePattern,s=Math.ceil(e/new cc.Sprite(t).width),i=[],o=0;o<s;o++){var r=new cc.Sprite(t);i.push(r)}this._super(i,{direction:cleverapps.UI.HORIZONTAL,margin:n.margin}),this.setScale(e/this.width),this.setPositionRound(n)}});cleverapps.styles.RepeatablePattern={margin:0,x:{align:"center"},y:{align:"top",dy:5}};var Change=function(e){this.options=e};Change.prototype.isActive=function(){return!0},Change.prototype.calculateDelta=function(){return 0},Change.prototype.createView=function(){};var ChangeView=cc.Node.extend({ctor:function(e){this.options=e,this._super(),this.setVisible(!1),this.showUp()},showUp:function(){this.runAction(new cc.Sequence(new cc.DelayTime(2),new cc.CallFunc(function(){this.setScale(0),this.setVisible(!0)}.bind(this)),new cc.ScaleTo(.6,1).easing(cc.easeBackOut())))},animateChange:function(e){}}),LanternChange=function(e){Change.call(
this,e),this.lantern=e.lantern};LanternChange.prototype=Object.create(Change.prototype),(LanternChange.prototype.constructor=LanternChange).prototype.isActive=function(){return this.lantern&&this.lantern.isActive(this.options.level)},LanternChange.prototype.calculateDelta=function(){return 1},LanternChange.prototype.createView=function(e){this.lantern.beforeShownProgress||(this.lantern.beforeShownProgress=Math.max(0,this.lantern.getCurrentStreak()-1));var t=new LanternChangeView({before:this.lantern.beforeShownProgress,after:this.lantern.getCurrentStreak()});return e.window.addChild(t),this.lantern.beforeShownProgress=this.lantern.getCurrentStreak(),t};var LanternChangeView=ChangeView.extend({ctor:function(e){this._super(e);var t=cleverapps.styles.LanternChangeView,n=this.lantern=new cleverapps.Spine(bundles.lantern.jsons.lantern_game_json);n.setAnimation(0,"idle_"+this.options.before,!0),this.setLocalZOrder(t.zOrder),this.setAnchorPoint2(),this.setContentSize2(t),this.setScale(
t.isInitialScaleZero?0:t.scale),this.addChild(n),n.setPositionRound(this.width/2,this.height/2),this.setPositionRound(cleverapps.clone(t.wideModePositions[cleverapps.wideMode.mode],!0)),this.setVisible(!0)},showUp:function(){},animateChange:function(e){var t=cleverapps.styles.LanternChangeView;this.runAction(new cc.Sequence(new cc.DelayTime(.5),new cc.ScaleTo(.3,1.1*t.scale),new cc.ScaleTo(.1,t.scale),new cc.CallFunc(function(){this.options.before!==this.options.after&&this.lantern.setAnimationAndIdleAfter("charge_"+this.options.after,"idle_"+this.options.after)}.bind(this))))}});cleverapps.styles.LanternChangeView={wideModePositions:[{x:{align:"right",dx:-10},y:{align:"bottom",dy:120}},{x:{align:"right",dx:-10},y:{align:"bottom",dy:120}},{x:{align:"right",dx:-10},y:{align:"bottom",dy:120}}],zOrder:0,width:250,height:250,scale:.5};var VictoryChestChange=function(e){Change.call(this,e)};VictoryChestChange.prototype=Object.create(Change.prototype),(
VictoryChestChange.prototype.constructor=VictoryChestChange).prototype.isActive=function(){return cleverapps.styles.VictoryChestChangeView.ChestBlock&&0<this.options.stars},VictoryChestChange.prototype.calculateDelta=function(){return this.options.stars},VictoryChestChange.prototype.createView=function(e){var t=new VictoryChestChangeView({oldChestStars:this.options.oldChestStars});return e.addChild(t),t};var VictoryChestChangeView=ChangeView.extend({ctor:function(e){var t=cleverapps.styles.VictoryChestChangeView;this._super(e),this.setPositionRound(t.ChestBlock);var n=cleverapps.UI.createScale9Sprite(bundles.menubar.frames.menubar_bg_png);n.setAnchorPoint2(),n.setContentSize2(t.ChestBoard.width,t.ChestBoard.height),n.setPosition(t.ChestBoard.x,t.ChestBoard.y),this.addChild(n),this.chestBoard=n;var s=new cleverapps.Spine(bundles.starchest_window.jsons.star_chest_spine_json,t.Chest.scale);s.setPosition(t.Chest.x,t.Chest.y),s.setAnimation(0,"ready_to_open",!0),this.addChild(s),
this.chest=s;var i=cleverapps.UI.generateImageText(this.options.oldChestStars+"/"+cleverapps.StarChest.GOAL_AMOUNT,cleverapps.styles.FONTS.VICTORY_CHEST_TEXT);i.setAnchorPoint(1,.5),i.setPosition(n.width+t.ChestBoard.text.x,n.height/2+t.ChestBoard.text.y),n.addChild(i),this.chestBoardText=i},animateChange:function(e){this.runAction(new cc.Sequence(new cc.DelayTime(3),new cc.CallFunc(function(){this.runAction(new cc.Sequence(new cc.ScaleTo(.3,1.3),new cc.CallFunc(function(){cleverapps.UI.animateDelta(e,{x:this.chestBoardText.x-this.chestBoardText.width/2,y:this.chestBoardText.y,dy:cleverapps.styles.VictoryChestChangeView.ChestBoard.dy,parent:this.chestBoard}),this.chestBoardText.setString(cleverapps.starChest.stars+"/"+cleverapps.StarChest.GOAL_AMOUNT)}.bind(this)),new cc.ScaleTo(.3,1)))}.bind(this)),new cc.DelayTime(.5),new cc.CallFunc(function(){cleverapps.starChest.locked?this.runAction(new cc.Sequence(new cc.DelayTime(.5),new cc.ScaleTo(.4,0),new cc.RemoveSelf)):(
this.chest.setAnimation(0,"opening",!1),this.chest.setCompleteListener(function(){this.runAction(new cc.Sequence(new cc.ScaleTo(.5,0),new cc.RemoveSelf))}.bind(this)))}.bind(this))))}});cleverapps.styles.VictoryChestChangeView={ChestBlock:{x:{align:"center",dx:0},y:{align:"top",dy:-100}},ChestBoard:{x:80,y:5,dy:30,width:270,height:55,text:{x:-25,y:1}},Chest:{x:-55,y:0,scale:.5}};var TournamentBookChange=function(e){Change.call(this,e),this.mission=void 0};TournamentBookChange.prototype=Object.create(Change.prototype),(TournamentBookChange.prototype.constructor=TournamentBookChange).prototype.isActive=function(){return!("board"!==cleverapps.config.type||cleverapps.isKnockoutGame()||void 0===this.mission||!this.options.game.canPayReward(GameBase.REWARD_BACKGROUND_CLOVER)||MedallionComponent.IsAvailable())},TournamentBookChange.prototype.calculateDelta=function(){return this.options.game.rewards[GameBase.REWARD_BACKGROUND_CLOVER]},TournamentBookChange.prototype.createView=function(e){
var t=new TournamentBookChangeView({place:this.options.game.tournament&&this.options.game.competition&&this.options.game.competition.calcPlace()+1,isFinished:this.mission.result+this.mission.currency>=TreasureSearch.GEMS});return e.addChild(t),t};var TournamentBookChangeView=ChangeView.extend({ctor:function(e){this._super(e);var t=cleverapps.styles.TournamentBookChangeView;this.setAnchorPoint2(),this.setContentSize2(t);var n=this.animation=new cleverapps.Spine(bundles.main.jsons.tournament_book_json,1);n.setPosition(this.width/2,this.height/2),this.addChild(n),this.setPositionRound(t)},showUp:function(){},animateChange:function(e){this.runAction(new cc.Sequence(new cc.DelayTime(1.5),new cc.CallFunc(function(){this.setVisible(!0),this.animation.setAnimation(0,"animation",!1)}.bind(this))))}});cleverapps.styles.TournamentBookChangeView={width:300,height:400,x:{align:"center"},y:{align:"center",dy:190}};var RaffleChange=function(e){Change.call(this,e),
this.mission=cleverapps.missionManager.getRunningMission(Missions.SEMAPHORE_RAFFLE)};RaffleChange.prototype=Object.create(Change.prototype),(RaffleChange.prototype.constructor=RaffleChange).prototype.isActive=function(){return this.mission&&this.mission.isRunning()&&this.mission.raffle.needVictoryShow(this.options.level)},RaffleChange.prototype.calculateDelta=function(){return 1},RaffleChange.prototype.createView=function(e){var t=new RaffleChangeView;return e.window.addChild(t),t};var RaffleChangeView=ChangeView.extend({ctor:function(e){this._super(e),this.setLocalZOrder(10);var t=cleverapps.styles.RaffleChangeView;this.setAnchorPoint2(),this.setContentSize2(t);var n=this.animation=new cleverapps.Spine(bundles.raffle_victory.jsons.raffle_json);this.addChild(n),n.setPositionRound(this.width/2,this.height/2),this.setPositionRound(t.alignment),this.setVisible(!0)},showUp:function(){},animateChange:function(){this.runAction(new cc.Sequence(new cc.DelayTime(
cleverapps.styles.RaffleChangeView.delay),new cc.callFunc(this.animation.setAnimation.bind(this.animation,0,RaffleMissionLogic.getAnimationName(),!1))))}});cleverapps.styles.RaffleChangeView={width:100,height:150,delay:1,alignment:{x:{align:"center",dx:-40},y:{align:"center",dy:0}}},cleverapps.Reports={streams:{},get:function(e){return void 0===cleverapps.Reports.streams[e]&&(cleverapps.Reports.streams[e]=new cleverapps.ReportStream(e)),cleverapps.Reports.streams[e]},push:function(e,t){cleverapps.Reports.get(e).push(t)}},cleverapps.ReportStream=function(e){this.data=["REPORT: "+e.toUpperCase()]},cleverapps.ReportStream.prototype.push=function(e){this.data.push(e)},cleverapps.ReportStream.prototype.send=function(){var t=[new Date+""];this.data.forEach(function(e){t.push(e)}),cleverapps.environment&&t.push("Screen: "+cleverapps.environment.getScreen()),levels&&levels.user&&(t.push("Episode: "+cleverapps.environment.episodeNo),t.push("Level: "+cleverapps.environment.levelNo),t.push(
"User id: "+levels.user.id)),t.push("Version: "+cleverapps.config.version),t.push("Source: "+cleverapps.User.calcSource()),cleverapps.config&&cleverapps.config.name&&t.push("Name: "+cleverapps.config.name),t.push(window&&window.navigator?window.navigator.userAgent:"???"),t=(t=t.join(" - ")).replace(/(?:\r\n|\r|\n)/g," - ")+" ",console.log(t),cleverapps.isLocalhost()||cleverapps.RestClient.sendRaw(cleverapps.RestClient.METHODS.POST,cleverapps.LOG_ERROR_URL,t)},cleverapps.ReportStream.send=function(e,t){var n=new cleverapps.ReportStream(e);n.push(t),n.send()},cleverapps.ReportStream.debug=cleverapps.throttle(100,function(e){var t=new cleverapps.ReportStream("DebugMessage");Array.isArray(e)||(e=[e]),e.forEach(function(e){t.push(e)}),t.send()}),cleverapps.ErrorHandler={SEND_INTERVAL:"1 hour",lastSend:0,getBaseMessage:function(){var e=[new Date+""];return cleverapps.environment&&e.push("Screen: "+cleverapps.environment.getScreen()),cleverapps.User.calcSource&&e.push(
"Source: "+cleverapps.User.calcSource()),cleverapps.config&&cleverapps.config.name&&e.push("Name: "+cleverapps.config.name),cleverapps.config&&cleverapps.config.title&&e.push("Title: "+cleverapps.config.title),cleverapps.config&&cleverapps.config.version&&e.push("Version: "+cleverapps.config.version),levels&&levels.user&&(e.push("Episode: "+cleverapps.environment.episodeNo),e.push("Level: "+cleverapps.environment.levelNo),e.push("User id: "+levels.user.id)),cleverapps&&cleverapps.settings&&e.push("Language: "+cleverapps.settings.language),e.push(window&&window.navigator?window.navigator.userAgent:"???"),e},onerror:function(e,t,n,s,i){var o=cleverapps.ErrorHandler.getBaseMessage();return i&&i.arguments&&o.push("Arguments: "+i.arguments),cleverapps.newSceneStack&&i.stack&&(i.stack+=cleverapps.newSceneStack),i&&i.stack?(o.push("Message: "+e),o.push("Line: "+n),o.push("Column: "+s),o.push(i.stack)):(o.push("Message: "+e),o.push("URL: "+t),o.push("Line: "+n),o.push("Column: "+s),o.push(
"Error: "+JSON.stringify(i))),o=(o=o.join(" - ")).replace(/(?:\r\n|\r|\n)/g," - ")+" ",window&&window.assetsFolder&&(o=o.replace(new RegExp(window.assetsFolder,"g"),"")),cleverapps.config.workerTaskId&&cleverapps.RestClient.post("http://localhost:3201/tasks/finish/"+cleverapps.config.workerTaskId,{result:o}),cleverapps.ErrorHandler._onerror(o),!1},logError:function(e,t){var n=this.getBaseMessage();n.push("Message: "+e),t&&t.arguments&&n.push("Arguments: "+t.arguments),t&&t.stack&&n.push(t.stack),n=(n=n.join(" - ")).replace(/(?:\r\n|\r|\n)/g," - ")+" ",cleverapps.ErrorHandler._onerror(n)},_onerror:function(e){if(Date.now()-cleverapps.ErrorHandler.lastSend>=cleverapps.parseInterval(this.SEND_INTERVAL)&&(this.send(e),cleverapps.ErrorHandler.lastSend=Date.now()),cc.sys.isWebView){var t=cc.director.getTotalFrames(),n=function(){if(t===cc.director.getTotalFrames()||!cleverapps.metha)return cleverapps.eventLogger&&cleverapps.eventLogger.logEvent("webview_onerror_reload_silent"),
cleverapps.ReportStream&&cleverapps.ReportStream.debug("WebView error location reload silent"),void window.location.reload();var e={focus:"OnErrorRestartWindow",action:function(e){cleverapps.eventLogger&&cleverapps.eventLogger.logEvent("webview_onerror_reload_window"),cleverapps.ReportStream&&cleverapps.ReportStream.debug("WebView error location reload window"),new RestartWindow({contentMessage:"RestartWindow.OnError"}),cleverapps.metha.onceNoWindowsListener=e}};cleverapps.metha.isFocused()?cleverapps.metha.distract(e):cleverapps.metha.display(e)};setTimeout(function(){t===cc.director.getTotalFrames()&&(cc.game.pause(),cc.game.resume(),setTimeout(n,500))},500)}},send:function(e,t){console.log(e),cleverapps.RestClient.sendRaw(cleverapps.RestClient.METHODS.POST,cleverapps.LOG_ERROR_URL,e),cleverapps.eventLogger.logEvent(cleverapps.EVENTS.ERROR_AMOUNT)}},window.onerror=cleverapps.ErrorHandler.onerror,cleverapps.LOG_ERROR_URL="/log/",cleverapps.DataLoader={enabled:!0,corrupted:!1,
_onSavedCallbacks:[],data:{},_queue:{},haveSavedData:function(){return void 0!==cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.ID)},save:function(e,t,n){this._queue[e]={data:t,options:n},this._runSaveTimeout()},onSaved:function(e){void 0===this._saveTimeout?e():this._onSavedCallbacks.push(e)},processSaveQueue:function(){for(var e in this._queue)this._queue[e].data===cleverapps.DataLoader.REMOVE?this._removeProcess(e,this._queue[e].options):this._saveProcess(e,this._queue[e].data,this._queue[e].options);this._queue={},this._saveTimeout=void 0;for(var t=0;t<this._onSavedCallbacks.length;t++)this._onSavedCallbacks[t]();this._onSavedCallbacks=[]},_runSaveTimeout:function(){void 0===this._saveTimeout&&(this._saveTimeout=setTimeout(this.processSaveQueue.bind(this),1e3))},_saveProcess:function(e,t,n){var s=(n=n||{}).limit||cleverapps.DataLoader.FIFO_LIMIT,i=n.fifoKey,o=n.raw;if(i&&!this.hasKey(e)){for(var r=this.load(i)||[];r.length>=s;)this.remove(r[0],i),r=this.load(i);r.push(e),
this._saveProcess(i,r),this._saveProcess(e,t)}else{var a=o?t+"":JSON.stringify(t);if(this.data[e]=a,!this.enabled||this.corrupted)return;if(e!==cleverapps.DataLoaderTypes.CLIENT_SESSION&&(this.checkClientSession(),this.corrupted))return;try{if(void 0!==cleverapps.DataLoader.CLIENT_SESSION&&e!==cleverapps.DataLoaderTypes.CLIENT_SESSION&&!cc.sys.localStorage.getItem(cleverapps.DataLoaderTypes.CLIENT_SESSION))throw cleverapps.eventLogger&&cleverapps.eventLogger.logEvent(cleverapps.EVENTS.LOCALSTORAGE_CLEARED),1;if(a&&a.length>cleverapps.DataLoader.VALUE_LENGTH_LIMIT&&cleverapps.ErrorHandler.logError("Attempt to save huge value ("+a.length+") to localstorage key - "+e),cc.sys.localStorage.setItem(e,a),!cc.sys.isNative&&cc.sys.localStorage.getItem(e)!==a)throw e!==cleverapps.DataLoaderTypes.CLIENT_SESSION&&cleverapps.eventLogger&&cleverapps.eventLogger.logEvent(cleverapps.EVENTS.LOCALSTORAGE_ERROR_SET_ITEM),2}catch(e){cc.sys.localStorage.removeItem(
cleverapps.DataLoaderTypes.SESSION_SAVE_KEY),this.corrupted=!0}}},getCharValues:function(e){for(var t,n=[],s=0;s<e.str.length;s++)t=e.str.charCodeAt(s),e.encode?n.push(t<=65517?t+18:t):n.push(t<=65535?t-18:t);return n},hasKey:function(e){var t;return this._queue[e]?t=this._queue[e].data:(this.data.hasOwnProperty(e)||(this.data[e]=cc.sys.localStorage.getItem(e)),t=this.data[e]),null!=t},checkClientSession:function(){if(void 0!==cleverapps.DataLoader.CLIENT_SESSION){var e=cc.sys.localStorage.getItem(cleverapps.DataLoaderTypes.CLIENT_SESSION);if(e!==cleverapps.DataLoader.CLIENT_SESSION&&e)return this.corrupted=!0,cleverapps.synchronizer&&cleverapps.synchronizer.clientSessionExpired(),!1}return!0},load:function(e,t){if(this._queue[e]){if((s=this._queue[e].data)===cleverapps.DataLoader.REMOVE)return;return s=this._queue[e].options&&this._queue[e].options.raw?s+"":s,t&&t.raw?JSON.stringify(s):s}!this.data.hasOwnProperty(e)&&this.enabled&&(this.data[e]=cc.sys.localStorage.getItem(e))
;var n=this.data[e];if(null!=n){if(t&&t.raw)return n;var s;if((s=JSON.parse(n)).dataCodes){var i=this.getCharValues({str:s.dataCodes});s=JSON.parse(String.fromCharCode.apply(null,i))}return s}},remove:function(e,t){this._queue[e]={data:cleverapps.DataLoader.REMOVE,options:t},this._runSaveTimeout()},_removeProcess:function(e,t){if(this._queue[e]&&delete this._queue[e],delete this.data[e],this.enabled&&!this.corrupted&&cc.sys.localStorage.removeItem(e),t){var n=this.load(t);if(n){var s=n.indexOf(e);0<=s&&(n.splice(s,1),this.save(t,n))}}},cleanAll:function(){if(window.localStorage)for(var e in console.log("Clearing by prefix: "+cleverapps.config.prefix),this._queue={},this.data={},cc.sys.localStorage.setItem=function(){},window.localStorage)0===e.indexOf(cleverapps.config.prefix)&&-1===e.indexOf("_editor_episode_")&&-1===e.indexOf("_constant")&&(console.log("Clearing LOCALSTORAGE:"+e),cc.sys.localStorage.removeItem(e))},isEnabled:function(){if(!cc.sys.isNative)try{
return window.localStorage.setItem("test","testValue"),"testValue"!==window.localStorage.getItem("test")?!1:(window.localStorage.removeItem("test"),!0)}catch(e){return!1}return!0}},cleverapps.DataLoader.REMOVE=-12345,cleverapps.DataLoader.FIFO_LIMIT=10,cleverapps.DataLoader.VALUE_LENGTH_LIMIT=1e7,cleverapps.DataLoader.resetClientSession=function(){cleverapps.DataLoader.CLIENT_SESSION=void 0,cleverapps.DataLoader.enabled=!0,cleverapps.DataLoader.corrupted=!1,cc.sys.isNative||(cleverapps.DataLoader.CLIENT_SESSION=Math.floor(1e9*Math.random())+1+"",cleverapps.DataLoader._saveProcess(cleverapps.DataLoaderTypes.CLIENT_SESSION,cleverapps.DataLoader.CLIENT_SESSION,{raw:!0}),cleverapps.DataLoader.corrupted&&(cleverapps.DataLoader.enabled=!1,cleverapps.DataLoader.corrupted=!1,cleverapps.DataLoader.CLIENT_SESSION=void 0))},cleverapps.DataLoader.init=function(){var t=cleverapps.config.name+cleverapps.social.getLocalStoragePreffix();if(cleverapps.DataLoaderTypes={ID:t,HISTORY:t+"_history",
CLIENT_SESSION:t+"_client_session",SETTINGS:t+"_settings",DAILY_CHEST:t+"_periodicBonus",FRIENDS:t+"_friends",INVITABLE_FRIENDS:t+"_invitable_friends",BONUS_GAME_CHEST:t+"_bonus_game_chest",TUTORIAL:t+"_tutorial",LEVEL_HINTS:t+"_level_hints",PRODUCT_VIDEO_PROGRESS:t+"_v_p_",GAME_SAVE_FIFO:t+"_game_save_fifo",PAYMENTS_HISTORY:t+"_my_payments",PAYMENTS_HISTORY_5_PRICE:t+"_my_payments_5_price",SALE_MANAGER:t+"_sale_manager",SALE:t+"_sale",SERVER_VERSION:t+"_server_version",SESSION_SAVE_KEY:t+"_session",FAKE_FACEBOOK_LOGGING_TIME:t+"_fake_facebook_logging_time",PROMOTION:t+"_promotion",LOCALIZATION_MANAGER:t+"_localization_manager",RESULT_FIFO:t+"_result_fifo",RESULTS_FIFO:t+"_results_fifo",LIVES:t+"_lives",BOOSTERS_COUNTER:t+"_boosters_counter",STAR_CHEST:t+"_star_chest",BONUS_EPISODES_PROGRESS:t+"_bonus_episodes_progress",SERVER_FLAGS:t+"_server_flags",HELP_FROM_FRIENDS:t+"_help_from_friends",FORCES:t+"_forces",FREE_BOMB_MOVES:t+"_free_bomb_moves",TEMP_GOODS:t+"_temp_goods",
SORTER:t+"_sorter",FRIEND_REQUESTS:t+"_friend_requests",FAKE_REQUESTS:t+"_fake_request_time",ASKED_LIVES:t+"_asked_lives",ASKED_STARS:t+"_asked_stars",BOUNTY:t+"_bounty",PACK:t+"_pack",DAILY_TASKS:t+"_daily_tasks",BATTLE_PASS:t+"_battle_pass",WIN_STREAK:t+"_win_seria",LOCAL_PUSHES:t+"_local_pushes",TOURNAMENT_COMPETITORS:t+"_tournament_competitors",TOURNAMENT_PLAYERS:t+"_tournament_players",TOURNAMENT_RECORD:t+"_tournament_record",PLAY_SESSION:t+"_play_session",REWARDED_ADS_MANAGER:t+"_rewarded_ads",AD_ICON:t+"_adicon",REWARDED_TOOLBAR:t+"_rewarded_toolbar",SPECIAL_OFFER_LAST_TIME:t+"_special_offer_last_time",LEVEL_ATTEMPTS:t+"_level_attempts",LAST_VIEWED_FRIEND_REQUEST:t+"_last_viewed_friend_request",MISSIONS:t+"_missions",COMPETITION:t+"_competition",COMPETITION_PLAYERS:t+"_competition_players",COMPETITION_STATISTICS:t+"_competition_statistics",PLACEMENTS:t+"_placements",PIGGY_BANK:t+"_piggy_bank",SUBSCRIPTION:t+"_subscription",GUN:t+"_gun",
INSTANT_SHORTCUT_CREATED:t+"_instant_shortcut_created",INSTANT_BOT_CREATED:t+"_instant_bot_created",INSTANT_PAYMENTS:t+"_instant_payments",HEROES:t+"_heroes",DAILY_CUP:t+"_daily_cup",DAILY_CUP_RULES:t+"_daily_cup_rules",MINI_GAME_RECORD:t+"_mini_game_record",INFORMATION:t+"_info",SYNC:t+"_sync",FRIDAY_SALE:t+"_friday_sale",LANTERN:t+"_lantern",FARM:t+"_clockmaker_a",HOMEFIX:t+"_home",DRAUGIEM_AUTH_DATA:t+"_draugiem_auth_data",DAILY_LEVEL:t+"_daily_level",KNOCKOUT:t+"_knockout",WEEKLY_CUP:t+"_weekly_cup",WEEKLY_CUP_TOP:t+"_weekly_cup_top",COOKIE_JAR:t+"_cookie_jar",RATED:t+"_rated",APPLE_SOCIAL:t+"_apple_social",SIMPLE:t+"_simple",JACKPOT_LAST_APPEAR_TIME:t+"_jackpot_last_appear_time",CARD_SKINS:t+"_card_skins",ADMIN_CHART:t+"_admin_chart",ZOOM:t+"_zoom",UNIT_SAVER_KICKOUTS:t+"_unit_saver_kickouts",CHAT:t+"_chat"},cleverapps.DataLoader.resetClientSession(),"function"==typeof cc.sys.localStorage.getData)console.log("DataLoader.getData read single batch"),
cleverapps.DataLoader.data=cc.sys.localStorage.getData();else if(cc.sys.isNative)console.log("DataLoader.getData cant read all data");else try{void 0!==window.localStorage&&window.localStorage&&Object.keys(window.localStorage).forEach(function(e){0===e.indexOf(t)&&(this.data[e]=cc.sys.localStorage.getItem(e))}.bind(this))}catch(e){console.warn("DataLoader.getData cant read all data",e)}},cleverapps.WebViewData=function(){},cleverapps.WebViewData.prototype.init=function(e){webkitMessage("localStorage",{action:"init"}),this.initCallback=e},cleverapps.WebViewData.prototype.onInit=function(e,t){var n=JSON.parse(e);Object.keys(n).forEach(function(t){try{n[t]=decodeURIComponent(n[t])}catch(e){console.log("LocalStorage key - "+t+" decode error.")}}),this.localStorageData=n,t=JSON.parse(decodeWebViewData(t)),console.log("WebViewData.init data - "+JSON.stringify(t)),this.sourceApplicationUrl=t.sourceApplicationUrl,this.deviceVersion=t.deviceVersion,this.deviceName=t.deviceName,
this.advertisingId=t.advertisingId,this.langCode=t.langCode,this.appleSocialAvailable=t.appleSocial,console.log("device version "+this.deviceVersion+" device name "+this.deviceName),console.log("advertisingId "+this.advertisingId),console.log("langCode "+this.langCode),console.log("appleSocialAvailable "+this.appleSocialAvailable),this.initCallback&&(this.initCallback(),delete this.initCallback)},cleverapps.Availables={PERIODIC_BONUS:{episode:0,level:4},LEADER_BOARD:{episode:1,level:3},FRIEND_REQUESTS:{episode:0,level:6},BONUS_ROUND:{episode:0,level:10},DAILY_TASKS:{episode:2,level:13},MOVES:{episode:0,level:4},CREATE_SHORTCUT:{episode:0,level:5}},cleverapps.Settings=function(e){this.onChangeSoundListener=function(){},this.onChangeMusicListener=function(){},this.onChangeVibroListener=function(){},this.onChangeLanguageListener=function(){},this.load(),this.updateFrameRateByFpsMode()},cleverapps.Settings.getAvailableLanguages=function(){
return cleverapps.config.languages?cleverapps.config.languages:projects.default.languages},cleverapps.Settings.getDefaultLanguage=function(){var e=cleverapps.Settings.getAvailableLanguages(),t=cc.sys.language;if(t===cc.sys.LANGUAGE_DUTCH&&(t="nl"),-1===e.indexOf(t)||t===cc.sys.LANGUAGE_ENGLISH){for(var n=cleverapps.social.getDefaultLanguages(),s=0;s<n.length;s++){var i=n[s];if(-1!==e.indexOf(i))return i}return cc.sys.LANGUAGE_ENGLISH}return t},cleverapps.Settings.prototype.getSaveInfo=function(e){var t={sound:this.sound,music:this.music,vibro:this.vibro,language:this.language,fpsMode:this.fpsMode};return e&&(t.height=this.height),t},cleverapps.Settings.prototype.save=function(){cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.SETTINGS,this.getSaveInfo(!0)),cleverapps.synchronizer.addUpdateTask("settings")},cleverapps.Settings.prototype.loadData=function(e){void 0===e?(this.sound=!0,this.music=!0,this.vibro=!0,this.language=cleverapps.Settings.getDefaultLanguage(),
this.fpsMode=cleverapps.Settings.FPS_MODE_AUTO,this.save()):(this.sound=e.sound,this.music=e.music,this.vibro=void 0===e.vibro||e.vibro,this.language=e.language,this.height=e.height,this.manualResolution=e.manualResolution,this.manualResolution&&(this.resolution=this.manualResolution),this.fpsMode=void 0===e.fpsMode?cleverapps.Settings.FPS_MODE_AUTO:e.fpsMode),void 0===this.language&&(this.language=cleverapps.Settings.getDefaultLanguage())},cleverapps.Settings.prototype.load=function(){var e=cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.SETTINGS);this.loadData(e)},cleverapps.Settings.prototype.toggleSound=function(){this.sound=!this.sound,this.save(),this.onChangeSoundListener()},cleverapps.Settings.prototype.toggleMusic=function(){this.music=!this.music,cleverapps.audio.onChangeMusic(),this.save(),this.onChangeMusicListener()},cleverapps.Settings.prototype.toggleVibro=function(){this.vibro=!this.vibro,this.save(),this.onChangeVibroListener()},
cleverapps.Settings.prototype.setLanguage=function(e){this.language=e,this.save(),this.onChangeLanguageListener()},cleverapps.Settings.prototype.calcHeight=function(){var e=cc.view.getFrameSize().height;return cleverapps.isInstant()||"undefined"!=typeof window&&window.screen&&window.screen.height&&(e=Math.max(e,window.screen.height)),cleverapps.Mobage.isAppropriate()&&(e=cleverapps.Mobage.HEIGHT),this.height!==e&&(this.height=e,this.save()),e},cleverapps.Settings.prototype.calcResolution=function(){if(void 0!==this.resolution&&resolutions[this.resolution])return this.resolution;var e=this.calcHeight(),t=1;cc.sys.isNative||(t=Math.min(2,window.devicePixelRatio||1));var n=e*t,s=Object.keys(resolutions),i=s.filter(function(e){return resolutions[e].mobile});0<i.length&&(cc.sys.isMobile?s=i:i.length<s.length&&(s=cleverapps.substract(s,i))),s=s.sort(function(e,t){return resolutions[e].scale-resolutions[t].scale});for(var o=function(e){var t=e.scale*cleverapps.styles.SCENE_HEIGHT
;return n<=t?t-n:100*(n-t)},r=0,a=o(resolutions[s[r]]),c=1;c<s.length;c++){var l=o(resolutions[s[c]]);l<a&&(a=l,r=c)}return this.resolution=s[r]},cleverapps.Settings.prototype.setManualResolution=function(e){this.manualResolution=e;var t=this.getSaveInfo();t.manualResolution=this.manualResolution,cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.SETTINGS,t),cleverapps.DataLoader.processSaveQueue(),window.location.reload()},cleverapps.Settings.prototype.updateFrameRateByFpsMode=function(){},cleverapps.Settings.prototype.setFpsMode=function(e){this.fpsMode=e,this.updateFrameRateByFpsMode(),this.save()},cleverapps.Settings.SOURCE_LOAD_LOW_THRESHOLD=3e4,cleverapps.Settings.FPS_MODE_AUTO=-1,cleverapps.Settings.FPS_MODE_LOW=0,cleverapps.Settings.FPS_MODE_HIGH=1;var Event=function(e){this.features=e.features||[],this.options=e.options||{},this.projects=e.projects,this.networks=e.networks,this.start=this.convertTimezone(e.start),this.finish=this.convertTimezone(e.finish),this.debug=e.debug
,this.toolApplicable=e.toolApplicable};Event.prototype.convertTimezone=function(e){var t=new Date(e);return new Date(t.getTime()+t.getTimezoneOffset()*cleverapps.parseInterval("1 minute"))},Event.prototype.isRunning=function(){return this.start.getTime()<=Date.now()&&Date.now()<=this.finish.getTime()},Event.prototype.getTimeBeforeStart=function(){return this.start>new Date?this.start-new Date:0},Event.prototype.getTimeLeft=function(){return this.finish.getTime()-Date.now()},Event.prototype.activate=function(){};var EventManager=function(){this.currentFeatures={},this.events=cc.loader.getRes(bundles.main.jsons.friday_schedule),this.setCurrentFeatures()};EventManager.prototype.isActive=function(e){return this.currentFeatures[e]&&this.currentFeatures[e].isRunning()},EventManager.prototype.listCurrentFeatures=function(){return Object.keys(this.currentFeatures).filter(function(e){return this.currentFeatures[e].isRunning()},this)},EventManager.prototype.getFeatureEvent=function(e){
return this.currentFeatures[e]},EventManager.prototype.isEventApplicable=function(e){return cleverapps.config.debugMode&&void 0!==e.toolApplicable?e.toolApplicable:!!e.isRunning()&&((!e.networks||-1!==e.networks.indexOf(cleverapps.User.calcSource()))&&((!e.projects||-1!==e.projects.indexOf(cleverapps.config.name))&&!(e.debug&&!cleverapps.config.debugMode)))},EventManager.prototype.setCurrentFeatures=function(){var e=this.events.map(function(e){return new Event(e)}).filter(this.isEventApplicable.bind(this));this.currentFeatures={},e.forEach(function(t){t.features.forEach(function(e){this.currentFeatures[e]=t}.bind(this)),t.activate()},this)},EventManager.prototype.getNextFeatureEvent=function(t){return this.events.map(function(e){return new Event(e)}).filter(function(e){return-1!==e.features.indexOf(t)&&((!e.networks||-1!==e.networks.indexOf(cleverapps.User.calcSource()))&&((!e.projects||-1!==e.projects.indexOf(cleverapps.config.name))&&(!(e.debug&&!cleverapps.config.debugMode
)&&0<e.getTimeBeforeStart())))}).sort(function(e,t){return e.start>t.start?1:-1})[0]};var CommunityManager=function(){var e=cleverapps.User.calcChannel("promo");e&&this.update(e)};CommunityManager.prototype.update=function(e){var t=function(e){this.reward=e}.bind(this);cleverapps.RestClient.post("/community/"+cleverapps.user.id+"/"+e,{},t,function(e){console.log("failed updating community",e)})},CommunityManager.prototype.isRewardAvailable=function(){return this.reward},CommunityManager.prototype.receiveReward=function(){cleverapps.metha.display({focus:"RewardedCommunityManagerReward",action:function(e){new RewardWindow({reward:this.reward}),this.reward=void 0,cleverapps.metha.onceNoWindowsListener=e}.bind(this)})};var Placements=function(){this.data=this.initialize(),this.sortKeys(),this.load(),cleverapps.whenAllInitialized(function(){this.run(Placements.STARTUP)}.bind(this)),cleverapps.metha.onFocusLostListenerPlacements=function(){cleverapps.environment.isMainScene()?this.run(
Placements.FREE_FOCUS_MAIN):cleverapps.environment.isGameScene()?this.run(Placements.FREE_FOCUS_GAME):this.run(Placements.FREE_FOCUS_OTHER),cleverapps.metha.isFocused()||cleverapps.environment.isMethaScene()&&this.run(Placements.FREE_FOCUS_METHA)}.bind(this),cc.eventManager.addCustomListener(cc.game.EVENT_SHOW,cleverapps.throttle(1e3,function(){this.run(Placements.ONSHOW_NO_FOCUS_CHECK),setTimeout(this.runWhenFreeFocus.bind(this,Placements.ONSHOW),300)}.bind(this)))};Placements.prototype.runWhenFreeFocus=function(e){cleverapps.metha.whenFreeFocus(this.run.bind(this,e))},Placements.prototype.sortKeys=function(){this.sortedKeys=Object.keys(this.data),this.sortedKeys.sort(function(e,t){return e=this.data[e],((t=this.data[t]).priority||0)-(e.priority||0)}.bind(this)),this.keysByType={}},Placements.prototype.listKeys=function(t){return this.keysByType[t]?this.keysByType[t]:this.keysByType[t]=this.sortedKeys.filter(function(e){return 0!=(this.data[e].type&t)},this)},
Placements.prototype.initialize=function(){var t="merge"===cleverapps.config.type;return{dailyCupReward:{type:Placements.FREE_FOCUS,filter:function(){return DailyCup.IsAvailable(DailyCup.TYPE_DAILY)&&void 0!==cleverapps.dailyCup.calcRewardPlace()&&cleverapps.environment.isDailyCupScene()},action:function(){cleverapps.dailyCup.giveReward()}},weeklyCupReward:{type:Placements.FREE_FOCUS_MAIN,filter:function(){return DailyCup.IsAvailable(DailyCup.TYPE_WEEKLY)&&void 0!==cleverapps.weeklyCup.calcRewardPlace()},action:function(){cleverapps.weeklyCup.giveReward()}},recalculateFlags:{type:Placements.ONSHOW_OR_STARTUP|Placements.INTERMEDIATE_OR_AFTER_FINISH,action:function(){cleverapps.flags.update()}},versionCheck:{type:Placements.ONSHOW_OR_STARTUP,action:function(){cleverapps.versionChecker.check()},interval:"1 hour"},versionCheckAlert:{type:Placements.FREE_FOCUS,priority:10,filter:function(){return cleverapps.versionChecker.needUpdate()},action:function(){cleverapps.metha.display({
focus:"VersionChecker.Alert",action:function(e){new NewVersionWindow,cleverapps.metha.onceNoWindowsListener=e}.bind(this)})}},stuckwindow:{type:Placements.FREE_FOCUS_MAIN,action:StuckWindow.displayIfNeeded,priority:0,interval:"3 day"},communityManagerReward:{type:Placements.FREE_FOCUS_MAIN,priority:9,interval:"10 minutes",filter:function(){return cleverapps.communityManager.isRewardAvailable()},action:function(){cleverapps.communityManager.receiveReward()}},displaySceneIntro:{type:Placements.FREE_FOCUS,priority:-1e3,filter:function(){return cc.director.getRunningScene().needDisplayIntro&&!cleverapps.flags.introDisabled},action:function(){cc.director.getRunningScene()._playIntro()}},packManagerLowBalance:{type:Placements.FREE_FOCUS_MAIN,priority:3,filter:function(){return cleverapps.packManager.isAvailable()&&cleverapps.user.gold<100},action:function(){cleverapps.metha.display({focus:"showPackWindow",action:function(e){new PackWindow,cleverapps.metha.onceNoWindowsListener=e}})},
interval:t?"3 day":"5 minute"},packManager:{type:Placements.FREE_FOCUS_MAIN,priority:3,filter:function(){return cleverapps.packManager.isAvailable()&&100<=cleverapps.user.gold},action:function(){cleverapps.metha.display({focus:"showPackWindow",action:function(e){new PackWindow,cleverapps.metha.onceNoWindowsListener=e}})},interval:"3 day"},interstitialMerge:{type:Placements.FREE_FOCUS,priority:0,filter:function(){return t},action:function(){cleverapps.rewardedAdsManager.showInterstitial()},interval:PlingaAds.isAppropriate()?"5 minutes":"30 minutes"},subscribeBot:{type:Placements.STARTUP,filter:function(){return cleverapps.social.createBot},action:function(){cleverapps.social.createBot()}},createShortcut:{type:Placements.FREE_FOCUS,filter:function(){return Placements.needCreateShortcut},action:function(){Placements.needCreateShortcut=!1,cleverapps.social.createShortcut()},interval:"10 minutes"},addShortcut:{type:Placements.VICTORY,filter:function(){
return cleverapps.social.createShortcut&&levels.user.checkAvailable(cleverapps.Availables.CREATE_SHORTCUT)},action:function(){Placements.needCreateShortcut=!0},interval:"10 minutes"},canUpgradeHeroes:{type:Placements.FREE_FOCUS_MAIN,priority:-1,filter:function(){return"undefined"!=typeof match3&&void 0!==match3.heroes&&(match3.heroes.available()&&cleverapps.forces.isShown(Forces.HEROES_AVAILABLE.id)&&match3.heroes.canUpgradeSomebody())},action:function(){cleverapps.metha.display({focus:"CanUpgradeHeroWindow",action:function(e){new CanUpgradeHeroWindow,cleverapps.metha.onceNoWindowsListener=e}})},interval:"10 minutes"},piggyBankFull:{type:Placements.FREE_FOCUS_MAIN,filter:function(){return cleverapps.piggyBank.isActive()&&cleverapps.piggyBank.isFull()},action:function(){cleverapps.metha.display({focus:"PiggyBankWindow",control:"MenuBarGoldItem",action:function(e){new PiggyBankWindow,cleverapps.metha.onceNoWindowsListener=e}})},interval:"1 hour"},VKPromo:{
type:Placements.ONSHOW_OR_STARTUP,filter:function(){return cleverapps.social instanceof cleverapps.VK},action:function(){cleverapps.social.isPromoAvailable("2021-02-15","2021-02-28",["heroes"])&&cleverapps.social.processPromo(9)}},checkCompensatePayments:{type:Placements.INTERMEDIATE,filter:function(){return cleverapps.payments.canCompensate()},action:function(){cleverapps.payments.compensate()},interval:"1 second"},checkCompensatePaymentsCounter:{type:Placements.EMPTY_COUNTER,filter:function(){return cleverapps.payments.canCompensate()},action:function(){cleverapps.payments.compensate()},interval:"1 minute"},showCompensation:{type:Placements.FREE_FOCUS|Placements.EMPTY_COUNTER,filter:function(){return void 0!==cleverapps.payments.compensateProductCode},action:function(){var e=Product.Create(cleverapps.payments.compensateProductCode);cleverapps.payments.compensateProductCode=void 0,e.compensate()},interval:"1 second"},subscription:{type:Placements.FREE_FOCUS_MAIN,filter:function(){
return cleverapps.subscription&&cleverapps.subscription.isRewardReady()},action:function(){cleverapps.metha.display({focus:"SubscriptionWindow",action:function(e){new SubscriptionWindow,cleverapps.metha.onceNoWindowsListener=e}})},interval:"10 minute"},subscriptionOffer:{type:Placements.FREE_FOCUS_MAIN,filter:function(){return cleverapps.subscription&&!cleverapps.subscription.isActive()&&cleverapps.subscription.canBuyTrial()},action:function(){cleverapps.metha.display({focus:"SubscriptionWindow",action:function(e){new SubscriptionWindow,cleverapps.metha.onceNoWindowsListener=e}})},interval:-1!==["mobile_ok","web_ok"].indexOf(cleverapps.User.calcSource())?"30 minutes":"3 day"},dailyCup:{type:Placements.INTERMEDIATE_OR_AFTER_FINISH|Placements.ONSHOW_OR_STARTUP,filter:function(){return cleverapps.dailyCup&&DailyCup.IsAvailable(DailyCup.TYPE_DAILY)},action:function(){cleverapps.dailyCup.reload()}},weeklyCup:{type:Placements.INTERMEDIATE_OR_AFTER_FINISH|Placements.ONSHOW_OR_STARTUP,
filter:function(){return cleverapps.weeklyCup&&DailyCup.IsAvailable(DailyCup.TYPE_WEEKLY)},action:function(){cleverapps.weeklyCup.reload()}},promotion:{type:Placements.FREE_FOCUS_MAIN,priority:-1,filter:function(){return cleverapps.promotion.isReady()},action:function(){cleverapps.metha.display({focus:"PromotionWindow",action:function(e){cleverapps.Promotion.ShowFirstAvailable(),cleverapps.metha.onceNoWindowsListener=e}})},interval:"3 days"},starChest:{type:Placements.FREE_FOCUS_MAIN,filter:function(){return cleverapps.starChest&&!cleverapps.starChest.locked},action:function(){cleverapps.metha.display({focus:"StarChestWindow",action:function(e){new StarChestWindow,cleverapps.metha.onceNoWindowsListener=e}})}},unlimitedLivesStart:{type:Placements.ONSHOW_OR_STARTUP,filter:function(){return cleverapps.lives},action:function(){t||0!==levels.user.episode||cleverapps.tempGoods.checkGoodBuyed(cleverapps.TempGoods.UNLIMITED_LIVES)||(cleverapps.tempGoods.buyGood(
cleverapps.TempGoods.UNLIMITED_LIVES,cleverapps.parseInterval("3 hours")),cleverapps.lives.onBuyUnlimitedLivesListener())}},unlimitedLivesWindow:{type:Placements.FREE_FOCUS,priority:0,filter:function(){return cleverapps.lives&&(cleverapps.environment.isMainScene()||cleverapps.environment.isDailyCupScene())},action:function(){cleverapps.tempGoods.displayPromotionOnFinish()}},nativeInstall:{type:Placements.FREE_FOCUS_MAIN,priority:3,filter:function(){return"match3"===cleverapps.config.type},action:function(){cc.sys.isMobile&&!cc.sys.isNative&&-1===["mobile_ok","mobile_vk","mobile_mm","instant","sp_mbga","huzcom","plinga","pliega"].indexOf(cleverapps.User.calcSource())&&cleverapps.metha.display({focus:"NativeInstallWindow",action:function(e){new NativeInstallWindow,cleverapps.metha.onceNoWindowsListener=e}})},interval:"5 day"},minigameNudge:{type:Placements.FREE_FOCUS_MAIN,priority:4,filter:function(){return 0<cleverapps.missionManager.getPlayableMissions().length},action:function(){for(
var e=cleverapps.missionManager.getPlayableMissions(),t=0;t<e.length;t++){var n=e[t];if(n.nudgeWindow&&n.started&&(void 0===n.needShowStartWindow||n.needShowStartWindow))return void cleverapps.metha.display({focus:"NudgeWindow",action:function(e){new n.nudgeWindow(n),cleverapps.metha.onceNoWindowsListener=e}})}},interval:"10 minutes"},localstorageDisabled:{type:Placements.FREE_FOCUS_MAIN,priority:6,filter:function(){return!cleverapps.DataLoader.enabled&&!cleverapps.DataLoader.alerted},action:function(){cleverapps.DataLoader.alerted=!0,cleverapps.metha.display({focus:"LocalStorageDisabledWindow",action:function(e){new LocalStorageDisabledWindow,cleverapps.metha.onceNoWindowsListener=e}})}},sideBarRefresh:{priority:6,type:Placements.FREE_FOCUS,filter:function(){return cleverapps.environment.isMainScene()||cleverapps.environment.isEditorScene()},action:function(){cleverapps.sideBar.refreshAllIcons()}},sideBarForce:{type:Placements.FREE_FOCUS_MAIN,filter:function(){
return void 0!==cleverapps.sideBar.anyIconWithForceIndex()},action:function(){cleverapps.sideBar.showAnyForce()}},cryptexForce:{type:Placements.FREE_FOCUS_GAME,priority:5,filter:function(){return Game.currentGame&&Game.currentGame.cryptex&&Game.currentGame.cryptex.canShowForce()},action:function(){Game.currentGame.cryptex.showForce()}},playChangeOutcome:{type:Placements.FREE_FOCUS_GAME,priority:0,filter:function(){return cc.director.getRunningScene().wantAnimateChangeOutcome},action:function(){cc.director.getRunningScene().playChangeOutcome()}},gunForce:{type:Placements.FREE_FOCUS_GAME,priority:5,filter:function(){return Game.currentGame&&cleverapps.gun.isForceAvailable()},action:function(){cleverapps.gun.showForce()}},heroesUnlockTutorial:{type:Placements.FREE_FOCUS_OTHER,filter:function(){return cleverapps.environment.isHeroesScene()&&"undefined"!=typeof match3&&match3.heroes.canUnlockTutorial()},action:function(){match3.heroes.unlockTutorial()}},heroesUpgradeTutorial:{
type:Placements.FREE_FOCUS_OTHER,filter:function(){return cleverapps.environment.isHeroesScene()&&"undefined"!=typeof match3&&match3.heroes.canUpgradeTutorial()&&!match3.heroes.canUnlockTutorial()},action:function(){match3.heroes.upgradeTutorial()}},homefixNewTask:{type:Placements.FREE_FOCUS_METHA,filter:function(){return cleverapps.metha.getType()==Metha.HOMEFIX&&cleverapps.home.needNewTask()},action:function(){var e=cleverapps.home.furniture.filter(function(e){return e.readyToOpen()});cleverapps.metha.display({focus:"homefixNewTask",actions:e.map(function(t){return function(e){cleverapps.home.giveNewTask(e,t)}})})}},toolbarForce:{type:Placements.FREE_FOCUS_MAIN,filter:function(){return cleverapps.toolbar.anyItemWithForce()},action:function(){cleverapps.toolbar.showAnyForce()}},keypadForce:{priority:-1001,type:Placements.FREE_FOCUS_GAME,filter:function(){return Game.currentGame&&Game.currentGame.keypad&&Game.currentGame.keypad.isForceAvailable()},action:function(){
Game.currentGame.keypad.showForce()}},keypadTrickyForce:{priority:-1001,type:Placements.FREE_FOCUS_GAME,filter:function(){return Game.currentGame&&Game.currentGame.keypad&&Game.currentGame.keypad.isTrickyForceAvailable&&Game.currentGame.keypad.isTrickyForceAvailable()},action:function(){cleverapps.metha.display({focus:"TrickyForce",action:function(e){Game.currentGame.keypad.showTrickyForce(e)}})}},knockoutTutorial:{priority:-1001,type:Placements.FREE_FOCUS,filter:function(){return cleverapps.isKnockoutGame()&&cleverapps.knockoutTutorial.isAvailable()},action:function(){cleverapps.metha.display({focus:"KnockoutTutorialStep"+cleverapps.knockoutTutorial.step,control:cleverapps.knockoutTutorial.control,action:function(e){cleverapps.knockoutTutorial.run(e)}})}},missionFinished:{type:Placements.FREE_FOCUS_MAIN,priority:5,filter:function(){return cleverapps.missionManager.anyCompleted()},action:function(){cleverapps.missionManager.showCompleted()}},missionManagerProcess:{
type:Placements.FREE_FOCUS_MAIN,priority:5,action:function(){cleverapps.missionManager.run()}},missionStarted:{type:Placements.FREE_FOCUS_MAIN,priority:5,filter:function(){return cleverapps.missionManager.pendingStartWindow()},action:function(){cleverapps.missionManager.showStartWindow()}},displayBattlePassWindow:{type:Placements.FREE_FOCUS_MAIN,filter:function(){var e=cleverapps.missionManager.findByType(Mission.TYPE_BATTLEPASS);if(e)return e.logic.updateDisplayState(),e.logic.displayOnFreeFocus()},action:function(){cleverapps.metha.display({focus:"BattlePassWindow",action:function(e){var t=cleverapps.missionManager.findByType(Mission.TYPE_BATTLEPASS);new t.view(t),cleverapps.metha.onceNoWindowsListener=e}})}},friendsCache:{type:Placements.ONSHOW_OR_STARTUP,filter:function(){return cc.sys.isNative},action:function(){cleverapps.friends.reload(),cleverapps.invitalbleFriends.reload()}},parallax:{type:Placements.ONSHOW_OR_STARTUP,action:function(){cleverapps.Parallax.refresh()}},
localPushes:{type:Placements.ONSHOW_OR_STARTUP,action:function(){cleverapps.localPushes.onShow()}},syncClientSessionExpiredWindow:{type:Placements.FREE_FOCUS,priority:1e4,filter:function(){return cleverapps.synchronizer.needClientSessionExpiredWindow()},action:function(){cleverapps.synchronizer.showClientSessionExpiredWindow()}},syncReloadWindow:{type:Placements.FREE_FOCUS,priority:10001,filter:function(){return cleverapps.synchronizer._syncIn.needShowReloadWindow()},action:function(){cleverapps.synchronizer._syncIn.showReloadWindow()}},syncSocialConnectWindow:{type:Placements.FREE_FOCUS,priority:10,filter:function(){return cleverapps.synchronizer.wantsSocialConnectWindow},action:function(){cleverapps.synchronizer.displaySocialConnectWindow()}},sync:{type:Placements.ONSHOW_NO_FOCUS_CHECK,action:function(){cleverapps.synchronizer.syncWhenReady()},interval:"30 seconds"},nativeCheckConnection:{type:Placements.FREE_FOCUS_MAIN,filter:function(){var e={episode:1,level:2};return t&&(e={
episode:0,level:5}),cc.sys.isNative&&!cleverapps.social.isLoggedIn()&&cleverapps.user.checkAvailable(e)},action:function(){cleverapps.metha.display({focus:"nativeCheckConnection",action:function(e){cleverapps.social.checkConnection(e,e)}})},interval:"7 days"},mergeRateWindow:{type:Placements.FREE_FOCUS,filter:function(){return t&&cc.sys.isNative&&!cleverapps.flags.norest&&levels.user.checkAvailable(RateWindow.AVAILABLE)&&!RateWindow.hadRated()},action:function(){cleverapps.metha.display({focus:"nativePlacementRate",action:function(e){new RateWindow,cleverapps.metha.onceNoWindowsListener=e}})}},loginPlacementCheckConnection:{type:Placements.FREE_FOCUS,filter:function(){return cleverapps.social.loginPlacement&&!cleverapps.social.isLoggedIn()&&!cleverapps.social.placementConnectionChecked},action:function(){cleverapps.social.placementConnectionChecked=!0,cleverapps.social.checkConnection()}},bounty:{type:Placements.ONSHOW_OR_STARTUP|Placements.INTERMEDIATE,action:function(){
cleverapps.bountyManager.sendIfNeed()}},subscriptionReload:{type:Placements.ONSHOW_OR_STARTUP,filter:function(){return cleverapps.subscription},action:function(){cleverapps.subscription.reload()}},userDAU:{type:Placements.ONSHOW_OR_STARTUP,action:function(){cleverapps.user.calcIdfa(),cleverapps.user.visited<Date.now()-cleverapps.parseInterval(cleverapps.User.ON_SHOW_CHANGE_VISITED)&&(cleverapps.user.updateVisited(),cleverapps.user.reportDAU(!0))}},wardrobeItemReceived:{type:Placements.FREE_FOCUS_MAIN,priority:8,filter:function(){var e=cleverapps.missionManager.getRunningMission(Missions.SEMAPHORE_WARDROBE);return e&&e.logic.stageToShow},action:function(){var t=cleverapps.missionManager.getRunningMission(Missions.SEMAPHORE_WARDROBE),n=t.logic.stageToShow;cleverapps.metha.display({focus:"WardrobeWindow",actions:[function(e){new WardrobeReceiveWindow(t,WardrobeWindow.prizes[n]),cleverapps.metha.onceNoWindowsListener=e,cleverapps.eventLogger.logEvent(
"receive_"+cleverapps.styles.WardrobeWindow.eventName+"_"+n),t.logic.stageToShow=void 0},function(e){t.logic.runReceiveDialogue(e)},function(e){t.logic.givePrize(n,e)},function(e){new WardrobeWindow(t),cleverapps.metha.onceNoWindowsListener=e}]})}},appleRestore:{type:Placements.FREE_FOCUS_MAIN,filter:function(){return cc.sys.os===cc.sys.OS_IOS&&cc.sys.isNative&&cc.sys.isWebView&&cleverapps.subscription&&!cleverapps.subscription.isActive()},action:function(){cleverapps.payments.restore()},interval:"1 month"},appleBuyStoreProduct:{type:Placements.FREE_FOCUS,filter:function(){return cc.sys.os===cc.sys.OS_IOS&&cc.sys.isNative&&cc.sys.isWebView&&cleverapps.payments.storeProductName},action:function(){cleverapps.payments.buyStoreProduct()}},raceShowProgress:{type:Placements.FREE_FOCUS_OTHER,filter:function(){return cc.director.getRunningScene().needProgressShow},action:function(){cc.director.getRunningScene().showProgress()}},teaserRaffle:{type:Placements.FREE_FOCUS_MAIN,filter:function(){
var e=-1!==cleverapps.eventManager.listCurrentFeatures().indexOf("raffle"),t=!cleverapps.user.checkAvailable(Missions[Mission.TYPE_RAFFLE].available);return e&&RaffleMissionLogic.IsAvailable()&&t&&1<levels.user.getHumanReadableNumber()},action:function(){cleverapps.metha.display({focus:"RaffleWindow_teaser",action:function(e){new RaffleWindow(void 0),cleverapps.metha.onceNoWindowsListener=e}})},interval:"1 day"},animatePassLevel:{type:Placements.FREE_FOCUS_MAIN,priority:-2,filter:function(){return PlayButton.IsAvailable()&&cleverapps.playButton.passedLevel},action:function(){cleverapps.playButton.animatePassLevel()}},simpleForce:{type:Placements.FREE_FOCUS_MAIN,priority:9,filter:function(){return cleverapps.metha.getType()===Metha.SIMPLE&&cleverapps.simple.isForceAvailable()},action:function(){cleverapps.metha.display({focus:"simpleForce",control:["play_button","progress_view"],actions:[function(e){PlayButton.IsAvailable(
)&&cleverapps.playButton.passedLevel&&cleverapps.playButton.animatePassLevel(),0<cleverapps.simple.pendingsStars?cleverapps.simple.updateProgress(e):e()},function(e){cleverapps.simple.showForce(e)}]})}},simpleUpdateProgress:{type:Placements.FREE_FOCUS_MAIN,priority:-2,filter:function(){return cleverapps.metha.getType()===Metha.SIMPLE&&0<cleverapps.simple.pendingsStars&&!cleverapps.simple.canMoveNext()},action:function(){cleverapps.simple.updateProgress()}},simpleMoveNext:{type:Placements.FREE_FOCUS_MAIN,priority:9,filter:function(){return cleverapps.metha.getType()===Metha.SIMPLE&&cleverapps.simple.canMoveNext()},action:function(){cleverapps.metha.display({focus:"simpleMoveNext",control:["play_button","progress_view"],actions:[function(e){PlayButton.IsAvailable()&&cleverapps.playButton.passedLevel&&cleverapps.playButton.animatePassLevel(),0<cleverapps.simple.pendingsStars?cleverapps.simple.updateProgress(e):e()},function(e){cleverapps.simple.moveNext(e)}]})}},bonusWorldFinished:{
type:Placements.FREE_FOCUS,filter:function(){return cleverapps.environment.isBonusWorldScene()&&cc.director.getRunningScene().bonusWorld.isFinished()},action:function(){var t=cc.director.getRunningScene().bonusWorld;cleverapps.metha.display({focus:"bonusWorldFinished",action:function(e){t.finish(e)}})}},bonusWorldReward:{type:Placements.FREE_FOCUS,priority:2,filter:function(){return cleverapps.environment.isBonusWorldScene()&&cc.director.getRunningScene().bonusWorld.getAvailableReward()},action:function(){var t=cc.director.getRunningScene().bonusWorld;cleverapps.metha.display({focus:"bonusWorldReward",actions:[function(e){t.levelPassed?(t.animateChangeProgress(),setTimeout(e,2e3)):e()},function(e){t.giveReward(e)}]})}},bonusWorldProgress:{type:Placements.FREE_FOCUS,priority:1,filter:function(){return cleverapps.environment.isBonusWorldScene()&&cc.director.getRunningScene().bonusWorld.levelPassed},action:function(){cc.director.getRunningScene().bonusWorld.animateChangeProgress()}},
runCounterStages:{type:Placements.FREE_FOCUS,priority:1,action:function(){t&&Game.currentGame&&!Game.currentGame.counter.isActive()&&Game.currentGame.counter.setTimeout(function(){},0)}},slotMachineForce:{type:Placements.FREE_FOCUS_OTHER,filter:function(){return cleverapps.environment.isSlotMachineScene()&&cc.director.getRunningScene().slotMachine.isForceAvailable()},action:function(){cc.director.getRunningScene().slotMachine.showForce()}},runSpecialEnergyOffer:{type:Placements.FREE_FOCUS_MAIN,interval:cleverapps.config.debugMode?"1 minute":"24 hours",filter:function(){return cleverapps.config.debugMode&&void 0!==SpecialEnergyOfferWindow&&cleverapps.lives&&cleverapps.lives.needShowSpecialOffer&&cleverapps.lives.amount/cleverapps.Lives.MAX_REGEN_AMOUNT<.1},action:function(){cleverapps.metha.display({focus:"SpecialEnergyOfferWindow",action:function(e){delete cleverapps.lives.needShowSpecialOffer,new SpecialEnergyOfferWindow,cleverapps.metha.onceNoWindowsListener=e}})}}}},
Placements.prototype.resetAllPlacements=function(){this.lastStarts={},this.save()},Placements.prototype.run=function(e){for(var t=this.listKeys(e),n=0;n<t.length;n++){var s=t[n],i=this.data[s];if(i.interval){var o=cleverapps.parseInterval(i.interval);if((this.lastStarts[s]||0)+o>Date.now())continue}if(!i.filter||i.filter()){var r=0!=(i.type&Placements.FREE_FOCUS);if(r){if(cleverapps.metha.isFocused())continue;if(-1===i.priority&&this.lastFreeFocusStart+cleverapps.parseInterval("1 minute")>Date.now())continue}if(i.action(),this.lastStarts[s]=Date.now(),r&&cleverapps.metha.isFocused()){this.lastFreeFocusStart=Date.now();break}}}this.save()},Placements.prototype.load=function(){var e=cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.PLACEMENTS);this.lastStarts={},e&&e.lastStarts&&(this.lastStarts=e.lastStarts)},Placements.prototype.save=function(){cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.PLACEMENTS,{lastStarts:this.lastStarts})},Placements.STARTUP=1,
Placements.INTERMEDIATE=2,Placements.VICTORY=4,Placements.LOSE=16,Placements.AFTER_GAME_FINISH=32,Placements.ONSHOW=128,Placements.FREE_FOCUS_MAIN=256,Placements.FREE_FOCUS_GAME=512,Placements.FREE_FOCUS_METHA=1024,Placements.FREE_FOCUS_OTHER=2048,Placements.ONSHOW_NO_FOCUS_CHECK=4096,Placements.EMPTY_COUNTER=8192,Placements.FREE_FOCUS=Placements.FREE_FOCUS_MAIN|Placements.FREE_FOCUS_GAME|Placements.FREE_FOCUS_OTHER,Placements.ONSHOW_OR_STARTUP=Placements.ONSHOW|Placements.STARTUP,Placements.INTERMEDIATE_OR_AFTER_FINISH=Placements.INTERMEDIATE|Placements.AFTER_GAME_FINISH;var PlaySession=function(){this.load(),this.onEndSessionListeners=[PlaySession.ViralSentReporter,PlaySession.RewardedReporter,PlaySession.DailyTasksReporter,PlaySession.HelpByAttemptsReporter,PlaySession.SettingsReporter,PlaySession.DailyCupReporter,PlaySession.MiniGameReporter,PlaySession.MissionReporter,PlaySession.RaceReporter,PlaySession.PaymentReporter,PlaySession.BonusWorldReporter]}
;PlaySession.prototype.load=function(){var e=cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.PLAY_SESSION);e||(e={}),this.data=e},PlaySession.prototype.save=function(){cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.PLAY_SESSION,this.data)},PlaySession.prototype.endSession=function(){this.onEndSessionListeners.forEach(function(e){e(this.data)},this),this.data={},this.save()},PlaySession.prototype.inc=function(e,t){void 0===t&&(t=1);var n=this.data[e];void 0===n&&(n=0),this.set(e,n+t)},PlaySession.prototype.set=function(e,t){this.data[e]=t,this.save()},PlaySession.prototype.notifyActive=function(){var e=this.nextSendActive||0;if(Date.now()>=e){this.nextSendActive=Date.now()+cleverapps.parseInterval(PlaySession.ACTIVE_TIME_INTERVAL);var t=cleverapps.user.getDaysSinceRegistration(),n="RETENTION_"+t;cleverapps.EVENTS[n]&&cleverapps.eventLogger.logEvent(cleverapps.EVENTS.ACTIVE_TIME+"_"+t)}},PlaySession.SettingsReporter=function(e){cleverapps.eventLogger.logEvent(
"resolution_"+cleverapps.settings.calcResolution()),cleverapps.settings.fpsMode===cleverapps.Settings.FPS_MODE_LOW?cleverapps.eventLogger.logEvent(cleverapps.EVENTS.FPS_LOW):cleverapps.settings.fpsMode===cleverapps.Settings.FPS_MODE_HIGH?cleverapps.eventLogger.logEvent(cleverapps.EVENTS.FPS_HIGH):cleverapps.eventLogger.logEvent(cleverapps.EVENTS.FPS_AUTO)},PlaySession.ViralSentReporter=function(e){void 0===e.viral||0===e.viral?cleverapps.eventLogger.logEvent(cleverapps.EVENTS.VIRAL_SENT_NONE):e.viral<=3?cleverapps.eventLogger.logEvent(cleverapps.EVENTS.VIRAL_SENT_3):cleverapps.eventLogger.logEvent(cleverapps.EVENTS.VIRAL_SENT_REST)},PlaySession.RewardedReporter=function(e){cleverapps.whenAllInitialized(function(){RewardedAdsManager.IsEnabled()&&levels.user.checkAvailable(RewardedAdsManager.AVAILABLE)&&e[cleverapps.EVENTS.AD_READY+"_"+RewardedAdsManager.REWARDED]&&(cleverapps.eventLogger.logEvent(cleverapps.EVENTS.REWARDED_AVAILABLE),
e[cleverapps.EVENTS.REWARDED_WATCHED]&&cleverapps.eventLogger.logEvent(cleverapps.EVENTS.REWARDED_WATCHED))})},PlaySession.HelpByAttemptsReporter=function(e){cleverapps.eventLogger.logEvent(cleverapps.EVENTS.HELP_BY_ATTEMPTS_DAU);var t=e[cleverapps.EVENTS.HELP_BY_FIVE_ATTEMPTS];1<=t&&cleverapps.eventLogger.logEvent(cleverapps.EVENTS.HELP_BY_ATTEMPTS_ONE_AND_MORE),3<=t&&cleverapps.eventLogger.logEvent(cleverapps.EVENTS.HELP_BY_ATTEMPTS_THREE_AND_MORE),5<=t&&cleverapps.eventLogger.logEvent(cleverapps.EVENTS.HELP_BY_ATTEMPTS_FIVE_AND_MORE)},PlaySession.DailyTasksReporter=function(e){if(levels.user.checkAvailable(cleverapps.Availables.DAILY_TASKS)){cleverapps.eventLogger.logEvent(cleverapps.EVENTS.SESSION_DAILY_TASK_AVAILABLE),e[cleverapps.EVENTS.SESSION_DAILY_TASK_OPEN_WINDOW]&&cleverapps.eventLogger.logEvent(cleverapps.EVENTS.SESSION_DAILY_TASK_OPEN_WINDOW);var t=e[cleverapps.EVENTS.SESSION_DAILY_TASK_FINISH];t&&(3<t&&(t=3),cleverapps.eventLogger.logEvent(
cleverapps.EVENTS.SESSION_DAILY_TASK_FINISH+"_"+t));var n=e[cleverapps.EVENTS.SESSION_DAILY_TASK_REWARD];n&&(3<n&&(n=3),cleverapps.eventLogger.logEvent(cleverapps.EVENTS.SESSION_DAILY_TASK_REWARD+"_"+n))}},PlaySession.DailyCupReporter=function(e){e[cleverapps.EVENTS.DAILY_CUP_DAU]&&cleverapps.eventLogger.logEvent(cleverapps.EVENTS.DAILY_CUP_DAU),e[cleverapps.EVENTS.DAILY_CUP_PLAYERS]&&cleverapps.eventLogger.logEvent(cleverapps.EVENTS.DAILY_CUP_PLAYERS)},PlaySession.MiniGameReporter=function(t){Object.keys(t).forEach(function(e){0===e.indexOf(cleverapps.EVENTS.MINIGAME_FINISH)&&t[e]&&cleverapps.eventLogger.logEvent(e+"_dau")})},PlaySession.MissionReporter=function(t){Object.keys(t).forEach(function(e){0===e.indexOf(cleverapps.EVENTS.MISSION_DAU)&&t[e]?cleverapps.eventLogger.logEvent(e):0===e.indexOf(cleverapps.EVENTS.MISSION_START_DAU)&&t[e]&&cleverapps.eventLogger.logEvent(e)})},PlaySession.RaceReporter=function(e){
e[cleverapps.EVENTS.RACE_LEVELS_PASSED]&&cleverapps.eventLogger.logEvent(cleverapps.EVENTS.RACE_LEVELS_PASSED+"_"+e[cleverapps.EVENTS.RACE_LEVELS_PASSED]),e[cleverapps.EVENTS.RACE_LEVELS_PASSED_PREM]&&cleverapps.eventLogger.logEvent(cleverapps.EVENTS.RACE_LEVELS_PASSED_PREM+"_"+e[cleverapps.EVENTS.RACE_LEVELS_PASSED_PREM])},PlaySession.PaymentReporter=function(t){[cleverapps.EVENTS.PAYMENT_OPEN,cleverapps.EVENTS.PAYMENT_FAILURE,cleverapps.EVENTS.PAYMENT_CANCEL,cleverapps.EVENTS.PAYMENT_NOT_REFRESHED,cleverapps.EVENTS.PAYMENT_NOT_INITIALIZED,cleverapps.EVENTS.PAYMENT_SUCCESS].forEach(function(e){t[e]&&cleverapps.eventLogger.logEvent(e)})},PlaySession.BonusWorldReporter=function(e){e[cleverapps.EVENTS.BONUS_WORLD_DAU]&&cleverapps.eventLogger.logEvent(cleverapps.EVENTS.BONUS_WORLD_DAU),e[cleverapps.EVENTS.BONUS_WORLD_LEVEL_DAU]&&cleverapps.eventLogger.logEvent(cleverapps.EVENTS.BONUS_WORLD_LEVEL_DAU)},PlaySession.ACTIVE_TIME_INTERVAL="1 minute";var ExecutorPool=function(e){e=e||{},
this.amount=e.amount||1e3,this.interval=e.interval||"1 second",this.events=new cleverapps.EventsQueue(this.interval),this.delay=cleverapps.parseInterval(e.delay||"0 second"),this.tasks=[],this.timeout=void 0};ExecutorPool.prototype.execute=function(e){this.tasks.push({callback:e,event:Date.now()}),this.processFirst()},ExecutorPool.prototype.processFirst=function(){if(void 0!==this.timeout&&(clearTimeout(this.timeout),delete this.timeout),0!==this.tasks.length){var e=this.tasks[0],t=Date.now();if(e.event+100<t&&t<e.event+this.delay)this.timeout=setTimeout(this.processFirst.bind(this),t-e-this.delay);else{if(this.events.size()>=this.amount){var n=this.events.getShrinkLeftTime();if(n&&0<n&&this.events.size()>=this.amount)return void(this.timeout=setTimeout(this.processFirst.bind(this),n))}this.tasks.shift(),e.callback()!==cleverapps.NO_ACTION&&this.events.add(t),this.processFirst()}}},cleverapps.Flags=function(){this.init(),cleverapps.whenAllInitialized(function(){
cleverapps.paymentsHistory.onAddPaymentListeners.flags=this.update.bind(this),cleverapps.payments.onAvailableListeners.flags=this.update.bind(this),this.initAbTestFlags()}.bind(this))},cleverapps.Flags.prototype.initAbTestFlags=function(){},cleverapps.Flags.prototype.init=function(){var e=cleverapps.User.calcSource();this.noads=-1!==["huzcom","amazon","pliega"].indexOf(e),this.norest=-1!==["huzcom","pliega"].indexOf(e),this.noLogEvents=-1!==["huzcom","pliega"].indexOf(e),this.noviral=-1!==["huzcom","plinga","pliega"].indexOf(e),this.noshares=-1!==["android","amazon","ios","pliega","sp_mbga"].indexOf(e),this.nologin=-1!==["huzcom","plinga","pliega"].indexOf(e)||cleverapps.config.nologin,this.nocommunity=-1!==["huzcom","plinga","pliega"].indexOf(e),this.doubleRewards=-1!==["huzcom","plinga","pliega"].indexOf(e),this.reduceAds=-1!==["web_ok","mobile_ok","web_vk","mobile_vk","web_mm","mobile_mm"].indexOf(e),this.videoAdsMainMonetization=-1!==["plinga","instant"].indexOf(e),
this.nofirebase=-1!==["pliega"].indexOf(e),this.noadjust=-1!==["pliega"].indexOf(e),this.nofacebookevents=-1!==["pliega"].indexOf(e),this.nosocial=-1!==["pliega","huzcom"].indexOf(e),this.softCurrencyRealProduct=-1!==["mbga","sp_mbga"].indexOf(e),cleverapps.config.wysiwygMode&&(this.wysiwyg={skipSpecialOffer:!1,skipBuildingStage:!1,skipOpenChestWindow:!1,skipQuests:!0,mergeAnimation2:!1,automerge:!1,customMergeAnimation:!1,customCollectAnimation:!1,hidePrizeView:!1,hideGuideAndProgress:!1,hideFruitParticlesAnimation:!1,hideUnitPointAnimation:!1,customHighlight:!1},"match3"===cleverapps.config.type&&(this.adsField={}))},cleverapps.Flags.prototype.reset=function(){this.init(),this.update()},cleverapps.Flags.prototype.update=function(){this.nopayments=!cleverapps.payments.isAvailable(),(cleverapps.paymentsHistory.classify("3 month")!==cleverapps.PaymentsHistory.PAYER_NONE||cleverapps.user.getProgress()<20)&&(this.videoAdsMainMonetization||"merge"===cleverapps.config.type||(this.noads=!0),
(cc.sys.isNative||cleverapps.paymentsHistory.classify("1 month")>=cleverapps.PaymentsHistory.PAYER_WEAK||cleverapps.user.getProgress()<20)&&(this.noviral=!0,levels.friendRequests.deleteFakeRequests()));var e=cleverapps.User.calcSource();this.noviral||"instant"!==e||cleverapps.config.platform!==cleverapps.Instant.PLATFORM_WEB||(this.noviral=!0,levels.friendRequests.deleteFakeRequests())};var SuccessWait=function(e,t){this.task=e,this.callback=cleverapps.once(t),this.active=!0,this.timeout=void 0,this.run()};SuccessWait.prototype.run=function(){this.active&&(this.timeout=clearTimeout(this.timeout),this.task({onSuccess:this.onSuccess.bind(this),onFailure:this.onFailure.bind(this)}))},SuccessWait.prototype.onSuccess=function(){this.callback(),this.clear()},SuccessWait.prototype.onFailure=function(e){if(cleverapps.checkStatus(e,404))return console.log("receive 404"),void this.clear();this.timeout=clearTimeout(this.timeout),this.timeout=setTimeout(this.run.bind(this),
cleverapps.parseInterval("30 seconds"))},SuccessWait.prototype.cancel=SuccessWait.prototype.clear=function(){this.active=!1,this.timeout=clearTimeout(this.timeout)},cleverapps.Information=function(){this.data=cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.INFORMATION),void 0===this.data&&(this.data={}),this.diff={}},cleverapps.Information.prototype.onChangeUserId=function(){this.diff=this.data,this.update()},cleverapps.Information.prototype.reportMaxTextureSize=function(){if("undefined"!=typeof gl){var e=gl.getParameter(gl.MAX_TEXTURE_SIZE);this.setKeyValue("maxTextureSize",e)}},cleverapps.Information.prototype.reportPhone=function(){var e={};if(e[cc.sys.OS_ANDROID]={avatar:"#avatars/android_avatar.png",name:"Android"},e[cc.sys.OS_IOS]={avatar:"#avatars/ios_avatar.png",name:"iOS"},e[cc.sys.os]&&cc.sys.isNative){var t=cleverapps.social.isLoggedIn()&&"applesocial"!==cleverapps.social.getCode();this.data.avatar||t||cleverapps.info.setKeyValue("avatar",e[cc.sys.os].avatar),
this.data.name||cleverapps.social.isLoggedIn()||cleverapps.info.setKeyValue("name",e[cc.sys.os].name+"_"+cleverapps.user.id.substr(-3))}"plinga"===cleverapps.User.calcSource()&&cleverapps.info.setKeyValue("avatar","#avatars/game_distribution.png")},cleverapps.Information.prototype.save=function(){cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.INFORMATION,this.data)},cleverapps.Information.prototype.setKeyValue=function(e,t){this.data[e]&&"resolution"===e||JSON.stringify(this.data[e])!==JSON.stringify(t)&&(this.data[e]=t,this.diff[e]=t,this.update())},cleverapps.Information.prototype.update=function(){this.save(),this._updateInner()},cleverapps.Information.prototype._updateInner=cleverapps.accumulate(5e3,function(){console.log("Sending information: "+JSON.stringify(this.diff)),cleverapps.RestClient.post("/info/"+levels.user.id,this.diff,function(e){},function(){}),this.diff={}}),cleverapps.Information.prototype.reportUserAgent=function(){var e,t;if(
"object"==typeof DeviceInfoPlugin)e=DeviceInfoPlugin.getDeviceName(),t=DeviceInfoPlugin.getAndroidVersion();else if(cc.sys.os===cc.sys.OS_IOS&&cc.sys.isWebView)e=cleverapps.webViewData.deviceName,t=cleverapps.webViewData.deviceVersion;else if(cc.sys.isNative)e=cc.sys.os===cc.sys.OS_ANDROID?jsb.reflection.callStaticMethod("org/cocos2dx/javascript/AppActivity","getDeviceName","()Ljava/lang/String;"):jsb.reflection.callStaticMethod("AppController","getDeviceName"),t=cc.sys.os===cc.sys.OS_ANDROID?jsb.reflection.callStaticMethod("org/cocos2dx/javascript/AppActivity","getAndroidVersion","()Ljava/lang/String;"):jsb.reflection.callStaticMethod("AppController","getDeviceVersion");else{var n=(new UAParser).getResult(navigator.userAgent);e=n.browser.name,t=n.browser.major}this.setKeyValue("useragent",{browser:e,version:t})},cleverapps.Information.prototype.reportAppVersion=function(){this.setKeyValue("appversion",{version:cleverapps.config.version,source:cleverapps.User.calcSource()})},
cleverapps.Information.prototype.reportSysLanguage=function(){this.setKeyValue("syslanguage",cc.sys.language)};var ActionPlayer=function(e){this.actions=[],this.add(e)};ActionPlayer.prototype.add=function(e){Array.isArray(e)?e.forEach(function(e){this.add(e)}.bind(this)):e&&this.actions.push(e)},ActionPlayer.prototype._playNext=function(){this.index===this.actions.length||this._stopped||this.actions[this.index++](this._playNext.bind(this))},ActionPlayer.prototype.play=function(e){this.index=0,e&&this.actions.push(e),this._playNext()},ActionPlayer.prototype.stop=function(){this._stopped=!0},ActionPlayer.delay=function(t){return function(e){setTimeout(e,t)}};var NoMetha={gamePlayed:function(){}},Metha=function(){this.enabled=!0,this.focus="initialize",this.controls=[],this.onceNoWindowsListener=void 0,this.controlsVisible=!0,this.lastControlsVisible={},this.onControlsListeners={},this.pendingListeners=[]};Metha.prototype.registerControl=function(e,t){if(
!cleverapps.flags.controlsHideDisabled){if("object"==typeof t){var n=t;t=n.createListener(n.toggle.bind(n))}(this.onControlsListeners[e]=t)(!1,!0),this.lastControlsVisible[e]=!1,(this.controlsVisible||-1!==this.controls.indexOf(e))&&(t(!0),this.lastControlsVisible[e]=!0)}},Metha.prototype.updateControlsVisibility=function(){for(var e in this.onControlsListeners){var t=this.controlsVisible||-1!==this.controls.indexOf(e);this.lastControlsVisible[e]!==t&&(this.onControlsListeners[e](t),this.lastControlsVisible[e]=t)}},Metha.prototype.setControlsVisible=function(e){this.controlsVisible=e,this.updateTimeout&&clearTimeout(this.updateTimeout),this.updateTimeout=setTimeout(this.updateControlsVisibility.bind(this),100)},Metha.prototype.debugMessage=function(e){if(cleverapps.config.debugMode)throw cc.sys.isNative&&!cc.sys.isWebView&&console.log((new Error).stack),e;var t=(new Error).stack;setTimeout(function(){throw e+" .. "+t},0)},Metha.prototype.displayWhenFreeFocus=function(e){this.isFocused(
)?this.whenFreeFocus(this.display.bind(this,e)):this.display(e)},Metha.prototype.whenFreeFocus=function(e){this.isFocused()?this.pendingListeners.push(e):e()},Metha.prototype.distract=function(e){this.isFocused()||this.debugMessage("Distract without focus! "+e.focus),this.focus!==e.focus?(this.focus=!1,this.display(e)):this.debugMessage("Distract same focus!"+e.focus)},Metha.prototype.display=function(e){if(!this.isFocused()&&(!e.filter||e.filter())){var t=e.focus;this.grabFocus(t,e);var n=e.actions||[e.action];try{this.compound(this.freeFocus.bind(this,t),n)}catch(e){if(e instanceof RangeError||e.message&&-1!==e.message.indexOf("stack")){var s=e.message+" indexes - "+(e.indexes||[]).slice(-20)+" focuses - "+(e.focuses||[]).slice(-20)+" lengths - "+(e.actionsLength||[]).slice(-20)+" stack - "+JSON.stringify(e.stack);throw new Error(s)}throw e}}},Metha.prototype.compound=function(e,t,n,s){n=n||0,s=s||this.focus;if(this.focus===s)if(t.length!==n)try{t[n](this.compound.bind(this,e,t,n+1,s
))}catch(e){throw e.indexes=(e.indexes||[]).concat([n]),e.focuses=(e.focuses||[]).concat([s]),e.actionsLength=(e.actionsLength||[]).concat([t.length]),e}else e()},Metha.prototype.showControlsWhileFocused=function(e,t){cleverapps.toArray(e).forEach(function(e){this.isFocused()&&this.controls.indexOf(e)<0?(this.controls.push(e),!0!==this.lastControlsVisible[e]&&(this.onControlsListeners[e]&&this.onControlsListeners[e](!0,t),this.lastControlsVisible[e]=!0)):t&&this.onControlsListeners[e]&&this.onControlsListeners[e](!0,t)},this)},Metha.prototype.controlIsHidden=function(e){return!!this.isFocused()&&this.controls.indexOf(e)<0},Metha.prototype.hideAllControls=function(){this.isFocused()&&this.controls.forEach(function(e){!1!==this.lastControlsVisible[e]&&(this.onControlsListeners[e]&&this.onControlsListeners[e](!1),this.lastControlsVisible[e]=!1)},this),this.controls=[]},Metha.prototype.hideControlsWhileFocused=function(e){Array.isArray(e)||(e=[e]),e.forEach(function(e){this.isFocused(
)&&0<=this.controls.indexOf(e)&&(this.controls.splice(this.controls.indexOf(e),1),!1!==this.lastControlsVisible[e]&&(this.onControlsListeners[e]&&this.onControlsListeners[e](!1),this.lastControlsVisible[e]=!1))},this)},Metha.prototype.trigger=function(){if(!this.isFocused()){for(;0<this.pendingListeners.length;){if(this.pendingListeners.shift()(),this.isFocused())return}this.onFocusLostListenerPlacements()}},Metha.prototype.grabFocus=function(e,t){!1!==this.focus&&this.debugMessage("Want to grab focus: "+e+" focus is already given: "+this.focus),console.log("Grab focus: "+e),this.triggerTimeout&&(clearTimeout(this.triggerTimeout),this.triggerTimeout=void 0),this.focus=e,this.controls=[],t&&t.control&&(Array.isArray(t.control)?this.controls=t.control:this.controls=[t.control]),this.setControlsVisible(!1)},Metha.prototype.freeFocus=function(e){!1===this.focus&&this.debugMessage("Want to free focus: "+e+" focus is already free!"),this.focus===e?(console.log("Focus freed: "+this.focus),
this.focus=!1,this.setControlsVisible(!0),this.triggerTimeout=setTimeout(this.trigger.bind(this),0)):console.log("Wrong focus clearing: "+this.focus+" > "+e)},Metha.prototype.isFocused=function(){return!1!==this.focus},Metha.prototype.getType=function(){switch(cleverapps.config.metha){case"farm":return Metha.FARM;case"homefix":return Metha.HOMEFIX;case"knockout":return Metha.KNOCKOUT;case"simple":return Metha.SIMPLE;case"none":return Metha.NONE}return Metha.HOSE},Metha.prototype.withSimpleMain=function(){if(-1!==["wordsoup"].indexOf(cleverapps.config.name)){var e=cleverapps.User.calcSource();if(-1!==["mobile_ok","mobile_vk","mobile_mm"].indexOf(e)||cleverapps.isLocalhost())return!0}return!1},Metha.prototype.gotoMainScene=function(e){var t=this.getMainScene();cleverapps.scenes.replaceScene(new t,e)},Metha.prototype.getMainScene=function(){switch(this.getType()){case Metha.FARM:case Metha.HOMEFIX:return this.withSimpleMain()?MethaSimpleMainScene:MethaScene;case Metha.KNOCKOUT:
return KnockoutScene;case Metha.SIMPLE:return SimpleMainScene;case Metha.NONE:return MergeScene;default:return levels.EpisodesScene}},Metha.prototype.getMainObject=function(){switch(this.getType()){case Metha.FARM:return cleverapps.farm;case Metha.HOMEFIX:return cleverapps.home;case Metha.KNOCKOUT:return cleverapps.knockout;case Metha.SIMPLE:return cleverapps.simple;case Metha.NONE:return NoMetha;default:return levels.episodes}},Metha.prototype.wantsToPlay=function(e,t){if(cleverapps.lives&&cleverapps.lives.isEmpty())return new LivesShopWindow,void(cleverapps.metha.onceNoWindowsListener=e);this.getMainObject().wantsToPlay(e,t)},Metha.prototype.wantsToReplay=function(e,t){var n=t.level;BoostersBefore.isAvailable()?this.getMainObject().wantsToReplay&&n.building?this.getMainObject().wantsToReplay(e,t):(new LevelStartWindow(t),cleverapps.metha.onceNoWindowsListener=e):n.play(e,t)},Metha.prototype.isControlEnabled=function(e){return!this.isFocused()||0<=this.controls.indexOf(e)},
Metha.HOSE=0,Metha.FARM=1,Metha.HOMEFIX=2,Metha.KNOCKOUT=3,Metha.SIMPLE=4,Metha.NONE=5,cleverapps.User=function(n){if(cleverapps.EventEmitter.call(this),this.onCantTakeGold=function(){cleverapps.flags.nopayments&&!RewardedAdsManager.IsEnabled()?cleverapps.Notification.create("messages:NotEnoughCoins"):cleverapps.metha.isFocused()?new HardCurrencyShopWindow:cleverapps.metha.display({focus:"ShopWindow",control:"MenuBarGoldItem",action:function(e){new HardCurrencyShopWindow,cleverapps.metha.onceNoWindowsListener=e}})},this.onCantTakeExp=function(){},this.onLeagueChangeListener=function(){},this.onChangeExpListeners={},this.onChangeGold={},n)this.initializeNewPlayer();else{var e=cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.ID);this.loadData(e),this.lastReportDAU=this.getDaysSinceRegistration(e.visited)}var s=cleverapps.User.calcChannel();if(s&&(-1!==["web_ok","mobile_ok"].indexOf(this.source)||cleverapps.isLocalhost())){var t=(n?"user_channel_new_":"user_channel_old_")+s
;cleverapps.eventLogger.logEvent(t),this.reportChannel=cleverapps.once(function(){var e=cleverapps.getRequestParameters(location.search);e.custom_args&&(e=decodeURIComponent(e.custom_args));var t={source:this.source,channel:s,isnewuser:n,parameters:JSON.stringify(e)};cleverapps.RestClient.post("/users/playsession/"+this.id,t)}.bind(this)),n||(setTimeout(this.reportChannel.bind(this),0),this.channel=s,e.visited+cleverapps.parseInterval("7 days")<Date.now()&&(this.registered=Date.now()))}this.save(),this.reportDAU(),cc.eventManager.addCustomListener(cc.game.EVENT_SHOW,function(){this.calcIdfa(),this.visited<Date.now()-cleverapps.parseInterval(cleverapps.User.ON_SHOW_CHANGE_VISITED)&&(this.updateVisited(),this.reportDAU(!0))}.bind(this))},cleverapps.User.prototype=Object.create(cleverapps.EventEmitter.prototype),cleverapps.User.prototype.constructor=cleverapps.User,cleverapps.User.prototype.updateVisited=function(){this.visited=Date.now(),this.save()},
cleverapps.User.prototype.incProgressCompare=function(e,t){e=e||1,this.progressCompare+=e,t||this.save()},cleverapps.User.prototype.reportDAU=function(e){void 0!==this.lastReportDAU&&this.lastReportDAU===this.getDaysSinceRegistration()||(this.lastReportDAU=this.getDaysSinceRegistration(),cleverapps.User.reportAmountFriendsDau=function(){if(cleverapps.friends){var e=cleverapps.friends.listIds().length;5<e&&(e=5),cleverapps.eventLogger.logEvent(cleverapps.EVENTS["DAU_WFRIENDS_"+e]),cleverapps.User.reportAmountFriendsDau=void 0}},e&&cleverapps.User.reportAmountFriendsDau(),setTimeout(function(){if(cleverapps.playSession.endSession(),cleverapps.eventLogger.logEvent(cleverapps.EVENTS.DAU),cleverapps.eventLogger.logEvent(cleverapps.EVENTS.DAU_LANGUAGE),this.gold<=1e6&&cleverapps.eventLogger.logEvent(cleverapps.EVENTS.USER_GOLD_DAU,{amount:this.gold}),cc.sys.isNative&&cleverapps.social.isLoggedIn()){var e=cleverapps.social.getCode();cleverapps.eventLogger.logEvent(e+"_loggedin_dau")}
void 0!==cleverapps.abTest.group&&cleverapps.eventLogger.logEvent("abtest_"+cleverapps.abTest.group+"_"+cleverapps.EVENTS.DAU);var t=this.getDaysSinceRegistration(),n=function(){var e="RETENTION_"+t;cleverapps.EVENTS[e]&&cleverapps.eventLogger.logEvent(cleverapps.EVENTS[e])};0<t?n():(cleverapps.User.reportRetention=function(){cleverapps.user.checkAvailable(cleverapps.User.RETENTION_0_AVAILABLE)&&(n(),cleverapps.User.reportRetention=void 0)},cleverapps.User.reportRetention())}.bind(this),0))},cleverapps.User.prototype.getDaysSinceRegistration=function(e){return Math.floor(((e||Date.now())-this.registered)/1e3/24/60/60)},cleverapps.User.prototype.loadData=function(e){this.id=e.id,this.id||(this.id=this.generateTmpId()),this.gold=e.gold,this.registered=e.registered,this.source=e.source,this.source||(this.source=cleverapps.User.calcSource()),this.channel=e.channel,this.visited=Date.now(),this.exp=e.exp,this.league=this.calcLeague(),e.idfa1&&(this.idfa=e.idfa1),this.abtest=e.abtest,
this.progressCompare=e.progressCompare||0},cleverapps.User.prototype.isBeginner=function(){return this.episode<=1},cleverapps.User.prototype.isNovice=function(){return this.episode<=3&&1<this.episode},cleverapps.User.prototype.checkAvailable=function(e){return!0},cleverapps.User.prototype.generateTmpId=function(){return"__"+Math.floor(1e15*Math.random())},cleverapps.User.prototype.haveTmpId=function(){return 2<=this.id.length&&"__"===this.id.substr(0,2)},cleverapps.User.prototype.setGold=function(e,t){var n=e-this.gold;0<n&&cleverapps.history.add("gold",n),0!==n&&(this.gold=e,this.incProgressCompare(30,!0),this.save(),t||this.onChangeGold())},cleverapps.User.prototype.canTakeGold=function(e){return this.gold>=e},cleverapps.User.prototype.expAvailable=function(){return"undefined"!=typeof match3&&match3.heroes&&match3.heroes.available()||"merge"===cleverapps.config.type},cleverapps.User.prototype.canTakeExp=function(e){return this.exp>=e},cleverapps.User.prototype.takeGold=function(e){
return 0===e||(cleverapps.history.add("spent",e),this.canTakeGold(e)?(cleverapps.dailyTasks.addProgress(cleverapps.DailyTask.SPEND_COINS,e),cleverapps.playSession.inc(cleverapps.EVENTS.SPEND_COINS,e),cleverapps.eventLogger.logEvent(cleverapps.EVENTS.SPEND_COINS,{amount:e}),this.setGold(this.gold-e),!0):(this.onCantTakeGold(e-this.gold),!1))},cleverapps.User.prototype.takeExp=function(e){return 0===e||(this.canTakeExp(e)?(this.setExp(this.exp-e),!0):(this.onCantTakeExp(e-this.exp),!1))},cleverapps.User.prototype.getSaveInfo=function(){return{id:this.id,gold:this.gold,registered:this.registered,visited:this.visited,source:this.source,channel:this.channel,exp:this.exp,idfa1:this.idfa,abtest:this.abtest,progressCompare:this.progressCompare}},cleverapps.User.prototype.afterSync=function(){this.league=this.calcLeague()},cleverapps.User.prototype.save=function(e){!1===e&&this.afterSync(),cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.ID,this.getSaveInfo()),!1!==e&&(
this.incProgressCompare(3,!0),cleverapps.synchronizer.addUpdateTask("users"))},cleverapps.User.prototype.prepareSmallGoldReward=function(e){var t=cleverapps.paymentsHistory.getLastPayment();if(t&&t.time>Date.now()-cleverapps.parseInterval("3 day"))return e;var n=1;return 1e3<=this.gold?n=.2:500<=this.gold&&(n=.5),Math.ceil(e*n)},cleverapps.User.prototype.setRandomBoostersReward=function(e){if(!e.randomBoosters)return e;e.boosters={};for(var t=0;t<e.randomBoosters.amount;t++){var n=cleverapps.Random.choose(e.randomBoosters.types);e.boosters[n]=e.boosters[n]?e.boosters[n]+1:1}return delete e.randomBoosters,e},cleverapps.User.prototype.prepareRewardByRich=function(e,t){if(!e.gold&&!e.boosters&&!e.randomBoosters)return e;e=cleverapps.clone(e,!0),e=this.setRandomBoostersReward(e);var n=cleverapps.paymentsHistory.getLastPayment();if(n&&n.time>Date.now()-cleverapps.parseInterval("1 day"))return e;var s=!1;if(e.gold){var i=!0;n&&n.time>Date.now()-cleverapps.parseInterval("3 day")&&(i=!1)
;var o=1;1e3<=this.gold&&i?(o=.1,s=!0):600<=this.gold?(s=!0,o=.25):300<=this.gold&&(o=.5),e.gold=Math.max(5*Math.ceil(e.gold*o/5),t||0)}if(s){var r=[];if("match3"===cleverapps.config.type&&(r=[{stars:3,exp:1},{stars:3},{stars:2,exp:1},{exp:2}]),!e.unlimitedLives&&cleverapps.lives&&(r=r.concat([{unlimitedLives:"10 minutes"},{unlimitedLives:"15 minutes"},{unlimitedLives:"30 minutes"}])),0<r.length){var a=cleverapps.Random.choose(r);for(var c in a)e[c]?e[c]+=a[c]:e[c]=a[c]}}return e},cleverapps.User.calcPriceCoef=function(){var e=cleverapps.User.calcSource();return"mobile_vk"===e||"web_vk"===e?.2625:"mobile_ok"===e||"web_ok"===e?.25:"web_mm"===e||"mobile_mm"===e?.25:"nk"===e?.125:"fotostrana"===e?.375:1},cleverapps.User.calcSource=function(){if(cleverapps.config.source)return cleverapps.config.source;if(cc.sys.isNative){if(cc.sys.os===cc.sys.OS_ANDROID)return"android";if(cc.sys.os===cc.sys.OS_IOS)return"ios"}var e=function(e){return-1!==window.location.href.indexOf(e)};return e(
"dr_auth_code")?"draugiem":e("logged_user_id")?e("mob=true")?"mobile_ok":"web_ok":e("api.vk.com")?e("vkmobile=true")?"mobile_vk":"web_vk":e("nk.pl")?"nk":e("fotostrana.ru")?"fotostrana":cleverapps.config.myMailRu&&e("app_id="+cleverapps.config.myMailRu.appId)?e("view=app_mobile")?"mobile_mm":"web_mm":e("source=spmobage")?"sp_mbga":e("mbga-platform.jp")?"mbga":e("Xsolla")?"xsolla":"facebook"},cleverapps.User.calcChannel=function(e,t){if(!cc.sys.isNative){if(void 0===e){if(e="channel",cleverapps.VK.isAppropriate())return cleverapps.User.calcChannel("hash")||cleverapps.User.calcChannel("referrer")||"";if(cleverapps.MyMailRu.isAppropriate()&&document.referrer){var n=document.createElement("a");return n.href=document.referrer,cleverapps.User.calcChannel("channel",location.search)||cleverapps.User.calcChannel("channel",n.search)||""}}var s=cleverapps.getRequestParameters(t||location.search);if(s.custom_args){var i=decodeURIComponent(s.custom_args);0<=i.indexOf(e)&&(
s=cleverapps.getRequestParameters("?"+i))}if(s[e])return s[e]}return""},cleverapps.User.prototype.setChannel=function(e){this.channel!==e&&(this.channel=e,this.save())},cleverapps.User.prototype.calcIdfa=function(){if(this.idfa)cc.sys.isNative&&console.log("idfa - "+this.idfa);else{var t=cleverapps.Adversting.getIdfa();t&&(this.idfa=t,cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.ID,this.getSaveInfo()),cleverapps.RestClient.post("/users/idfa/"+levels.user.id,{idfa:this.idfa},function(e){e.campaign&&(this.setChannel(e.campaign),cleverapps.Adversting.postbackUnity(t))}.bind(this),function(){console.log("Failed updating idfa: "+this.idfa),delete this.idfa,cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.ID,this.getSaveInfo())}.bind(this)))}},cleverapps.User.prototype.initializeNewPlayerGold=function(){this.gold=100,"merge"===cleverapps.config.type&&(this.gold=15)},cleverapps.User.prototype.initializeNewPlayer=function(){this.initializeNewPlayerGold(),
this.id=this.generateTmpId(),this.registered=Date.now(),this.visited=Date.now(),this.source=cleverapps.User.calcSource(),this.channel=cleverapps.User.calcChannel(),this.exp=0,this.league=this.calcLeague(),this.progressCompare=0},cleverapps.User.prototype.calcLeague=function(){var e=0;if(!cleverapps.config.leagues)return e;for(;e<cleverapps.config.leagues.length&&cleverapps.config.leagues[e]&&this.getHumanReadableNumber()+(this.progress||0)>cleverapps.config.leagues[e];)e++;return e},cleverapps.User.prototype.setExp=function(e){if(this.exp!==e){var t=e-this.exp;this.exp=e,this.save(),cleverapps.values(this.onChangeExpListeners).forEach(function(e){e(t)})}},cleverapps.User.ON_SHOW_CHANGE_VISITED="1 hour",cleverapps.User.RETENTION_0_AVAILABLE={level:1},cleverapps.Scenes=function(){},cleverapps.Scenes.prototype.isLoaderScene=function(){var e=cc.director.getRunningScene();return e instanceof LoaderScene||!e},cleverapps.Scenes.prototype.runScene=function(e,t){cc.director.runScene(e),t()},
cleverapps.Scenes.prototype.replaceScene=function(t,e,n){cleverapps.metha.isFocused()||cleverapps.metha.debugMessage("Trying to replace scene without user focus! "+t.sceneName),e=e||function(){};var s=cc.director.getRunningScene();s&&s.onReplace&&s.onReplace(),cleverapps.Notification.remove(),t.isWide&&!this.sceneMaxWidthToRestore&&(this.sceneMaxWidthToRestore=cleverapps.styles.SCENE_MAX_WIDTH,cleverapps.setupDesignResolution({sceneMaxWidthOverride:5e3})),!t.isWide&&this.sceneMaxWidthToRestore&&(cleverapps.setupDesignResolution({sceneMaxWidthOverride:this.sceneMaxWidthToRestore}),this.sceneMaxWidthToRestore=void 0,s&&(s.scene.resizeScale=1,s.scene.width=s.width)),cleverapps.metha.compound(e,[function(e){cleverapps.FixedWidthScene.canDistractChangeSize=!1,t.isWide||cleverapps.flags.noTransitionAnimation?e():TransitionAnimation.createTransitionAnimation(e,cleverapps.metha.isFocused()&&0===cleverapps.metha.focus.indexOf("refreshSceneOnChangeSize"),n)},function(e){
t instanceof SceneProxy?t.whenLoaded(e):e()},function(e){t instanceof SceneProxy&&(t=t.instance),cleverapps.scenes.runScene(t,e)},function(e){t.isWide||cleverapps.flags.noTransitionAnimation?e():TransitionAnimation.removeTransitionAnimation(t,function(){e(),void 0!==ToolMenu&&(t.toolMenu=new ToolMenu,t.toolMenu.setLocalZOrder(1),t.addChild(t.toolMenu))})},function(e){delete cleverapps.newSceneStack,cleverapps.FixedWidthScene.canDistractChangeSize=!0;var t=cleverapps.FixedWidthScene.changedOrientation;if(cleverapps.FixedWidthScene.changedOrientation||cleverapps.FixedWidthScene.changedSize){delete cleverapps.FixedWidthScene.changedOrientation,delete cleverapps.FixedWidthScene.changedSize;var n=cc.director.getRunningScene();n&&n.onChangeSize&&n.onChangeSize(t)}e()}])},cleverapps.Scenes.prototype.reset=function(){TransitionAnimation.reset()};var TransitionAnimation=cc.Node.extend({ctor:function(e){if(this._super(),this.setAnchorPoint2(),this.setLocalZOrder(100),
this.animation=new cleverapps.Spine(e.styling.json),this.addChild(this.animation),bundles.transition.urls.transition_background){var t=cc.director.getRunningScene();this.background=new cc.Sprite(bundles.transition.urls.transition_background),this.addChild(this.background);var n=Math.max(t.width/this.background.width,t.height/this.background.height);this.background.setScale(n),this.background.setLocalZOrder(-10)}e.styling.skin&&this.animation.setSkin(e.styling.skin)},animate:function(e,t,n,s){t=cleverapps.once(t||function(){}),this.animation.setCompleteListener(function(){this.runAction(new cc.Sequence(new cc.CallFunc(t),new cc.CallFunc(function(){n||this.runAction(new cc.RemoveSelf)}.bind(this))))}.bind(this));var i=function(){s?this.animation.setTimeScale(1e3):(this.animation.setTimeScale(1),cleverapps.config.debugMode&&cleverapps.keyboardController.isPressed(cc.KEY.d)&&this.animation.setTimeScale(.1)),this.animation.setAnimation(0,e,!1),this.background&&(
"open"===e?this.background.runAction(new cc.FadeOut(1)):(this.background.setOpacity(0),this.background.runAction(new cc.FadeIn(1)))),"open"===e?cleverapps.audio.playSound(bundles.main.urls.transition_open_effect):cleverapps.audio.playSound(bundles.main.urls.transition_close_effect)}.bind(this),o=cleverapps.styles.TransitionAnimation;"open"===e?this.animation.runAction(new cc.Sequence(new cc.DelayTime(o.beforeOpen.delay),new cc.CallFunc(i),new cc.DelayTime(o.open.delay),new cc.CallFunc(t))):i()}});TransitionAnimation.animate=function(e,t){(t=t||{}).parent||(t.parent=cc.director.getRunningScene());var n=t.spine?t.spine:new TransitionAnimation({styling:t.styling});return n.setPositionRound(t.parent.width/2,t.parent.height/2),n.removeFromParent(),t.parent.addChild(n,1e3),n.animate(e,t.callback,t.notRemove,t.silent),n},TransitionAnimation.hideLoading=function(){var e=TransitionAnimation.closeCurtains;if(e&&e.loading){var t=.3*(1-e.loading.scale);e.loading.runAction(new cc.Sequence(
new cc.ScaleTo(t,1),new cc.DelayTime(Math.max(cleverapps.styles.TransitionAnimation.loading.hideDelay-t,0)),new cc.ScaleTo(.3,.1),new cc.RemoveSelf)),delete e.loading}},TransitionAnimation.clearCloseCurtains=function(){TransitionAnimation.closeCurtains&&(TransitionAnimation.hideLoading(),delete TransitionAnimation.closeCurtains)},TransitionAnimation.removeCloseCurtains=function(){TransitionAnimation.closeCurtains&&(TransitionAnimation.closeCurtains.removeFromParent(),delete TransitionAnimation.closeCurtains)},TransitionAnimation.reset=function(){this.removeCloseCurtains()},TransitionAnimation.closeCurtainsAnimation=function(e,t,n){var s=TransitionAnimation.animate("close",{styling:n,notRemove:!0,silent:t,callback:function(){cc.eventManager.removeListeners(s),e()}});return s},TransitionAnimation.chooseStyling=function(){var e,t=bundles.transition.jsons.transition_json,n=cleverapps.Spine.getSkins(t);return 0<n.length&&(e=n[levels.user.getVirtualLevel()%n.length]),{json:t,skin:e}},
TransitionAnimation.createTransitionAnimation=function(s,i,o){var e=function(){var e=cc.director.getRunningScene();if(e){(o=o||{}).level=o.level||e.level;var t=TransitionAnimation.chooseStyling(),n=TransitionAnimation.closeCurtainsAnimation(s,i,t);e.onTransitionAnimationDidStart(),TransitionAnimation.removeCloseCurtains(),TransitionAnimation.closeCurtains=n,TransitionAnimation.swallowTouches(n),TransitionAnimation.createLoadingAnimation(n,e)}else s()}.bind(this);cleverapps.bundleLoader.loadBundle("transition",{onSuccess:e})},TransitionAnimation.createLoadingAnimation=function(e,t){var n=bundles.main.jsons.wait_transition_json,s=cleverapps.styles.TransitionAnimation.loading;if(s&&cleverapps.bundleLoader.isLoaded(cleverapps.Spine.listBundles(n))&&!(t instanceof LoaderScene)){var i=e.loading=new cc.Node;if(i.setAnchorPoint2(),bundles.main.jsons.wait_transition_json){var o=new cleverapps.Spine(n);i.addChild(o),o.setAnimation(0,"idle",!0)}var r=cleverapps.UI.generateOnlyText(Messages.get(
"Loading")||"Loading",cleverapps.styles.FONTS.TRANSITION_LOADING_TEXT);i.addChild(r),r.setPositionRound(s.textPos),cleverapps.UI.wrap(i),e.runAction(new cc.Sequence(new cc.DelayTime(s.delay),new cc.CallFunc(function(){e.addChild(i),i.setPositionRound(s),i.setScale(0),i.runAction(new cc.ScaleTo(.3,1))})))}},TransitionAnimation.removeTransitionAnimation=function(e,t){var n=TransitionAnimation.animate("open",{callback:function(){cc.eventManager.removeListeners(n),t()},parent:e,spine:TransitionAnimation.closeCurtains});TransitionAnimation.clearCloseCurtains(),TransitionAnimation.swallowTouches(n)},TransitionAnimation.swallowTouches=function(e){cc.eventManager.addListener({event:cc.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:!0,onTouchBegan:function(){return!0},onTouchEnded:function(){return!0}},e),cc.eventManager.addListener({event:cc.EventListener.MOUSE,onMouseMove:function(e){return e&&e.stopPropagation&&e.stopPropagation(),!0},onMouseScroll:function(e){
return e&&e.stopPropagation&&e.stopPropagation(),!0}},e)},cleverapps.overrideFonts(cleverapps.styles.FONTS,{TRANSITION_LOADING_TEXT:{size:50,color:cleverapps.styles.COLORS.WHITE,stroke:cleverapps.styles.DECORATORS.IMAGE_FONT_STROKE}}),cleverapps.styles.TransitionAnimation={loading:{delay:.5,hideDelay:.3,x:{align:"center"},y:{align:"center",dy:-400},textPos:{x:{align:"center"},y:{align:"center",dy:60}}},open:{delay:.5},beforeOpen:{delay:.2}},cleverapps.RestClient={getBase:function(){return cc.sys.isNative||cleverapps.isInstant()||-1!==["mbga","nk","android","plinga","huzcom","pliega"].indexOf(cleverapps.User.calcSource())?cleverapps.config.deployment:""},sendRaw:function(e,t,n){var s=cc.sys.isNative?cc.loader.getXMLHttpRequest():new XMLHttpRequest,i=cleverapps.RestClient.getBase()+t;s.open(e,i),s.timeout=1e4,s.send(n)},createQueryString:function(e){var t=[];for(var n in e)t.push(n+"="+("string"==typeof e[n]?e[n]:JSON.stringify(e[n])));return t.join("&")},get:function(e,t,n,s,i){
this.send(cleverapps.RestClient.METHODS.GET,e,t,n,s,i)},post:function(e,t,n,s,i){this.send(cleverapps.RestClient.METHODS.POST,e,t,n,s,i)},send:function(e,t,n,s,i,o){if(!cleverapps.flags.norest){o=o||{},timeout=o.timeout||1e4;var r=cc.sys.isNative?cc.loader.getXMLHttpRequest():new XMLHttpRequest,a=setTimeout(function(){c.call({status:-1,statusText:"our timeout"})},timeout+1e3),c=function(){if(void 0!==a&&(clearTimeout(a),a=void 0),200<=this.status&&this.status<300){if(s){var e;try{e=this.responseText&&JSON.parse(this.responseText)}catch(e){throw"parse json error: path - "+t+", message - "+e.message}s(e)}}else console.log("XMLHttpRequest FAILED"),this.status&&console.log(this.status),this.statusText&&console.log(this.statusText),this.responseText&&(this.errorMessage=(this.responseText.split("\n")[0]||"").trim(),this.errorMessage&&console.log(this.errorMessage)),i&&i(this);s=function(){},i=function(){}}.bind(r);r.ontimeout=c,r.onload=c,r.onerror=c,r.onabort=c;var l=t;"http"!==l.substr(0,4
)&&(l=cleverapps.RestClient.getBase()+cleverapps.config.restApiURL+t),r.open(e,l),r.timeout=timeout,r.setRequestHeader("Content-Type","application/json"),o.authorization?r.setRequestHeader("authorization",o.authorization):r.setRequestHeader("Cache-Control","no-cache"),r.send(JSON.stringify(n))}},METHODS:{GET:"GET",POST:"POST"}},cleverapps.Tutorial=function(){this.tutorialSteps=new cleverapps.TutorialSteps,this.steps=this.tutorialSteps.list(this.nextStep.bind(this)),this.onStartedListener=function(){},this.onFinishedListener=function(){}},cleverapps.Tutorial.prototype.setGame=function(e){this.game=e,this.tutorialSteps.setGame(this.game)},cleverapps.Tutorial.prototype.stop=function(){this.running=!1,this.step=this.steps.length},cleverapps.Tutorial.prototype.start=function(){this.running=!0,this.setStep(0),this.onStartedListener()},cleverapps.Tutorial.prototype.remindStep=function(){this.isRunning()&&this.steps[this.step].call(this,this.game)},
cleverapps.Tutorial.prototype.setStep=function(e){this.step=e,this.step>=this.steps.length&&(this.running=!1);var t={step:e};if(this.isRunning()){var n="tutorial_step_"+(e+1);cleverapps.eventLogger.logEvent(n,t),0===e&&cleverapps.eventLogger.logEvent(cleverapps.EVENTS.TUTORIAL_BEGIN)}else this.onFinishedListener(),cleverapps.eventLogger.logEvent(cleverapps.EVENTS.TUTORIAL_COMPLETED,t),cleverapps.eventLogger.logEvent(cleverapps.EVENTS.TUTORIAL_COMPLETE);this.remindStep()},cleverapps.Tutorial.prototype.nextStep=function(){this.isRunning()&&this.setStep(this.step+1)},cleverapps.Tutorial.prototype.isRunning=function(){return this.running},cleverapps.EventsLogger=function(){this.pool={names:[],data:[]}},cleverapps.EventsLogger.prototype.logEvent=function(e,t){if(!cleverapps.flags||!cleverapps.flags.noLogEvents){40<e.length&&console.log(
"WARN: Invalid event name: "+e+"!. It must be between 1 and 40 characters, and must be contain only alphanumerics, , - or spaces, starting with alphanumeric or _.");var n=this.getBaseParameters();if(void 0!==t&&(n=cleverapps.extend(n,t)),cleverapps.firebase){var s=cleverapps.EventsLogger.FIREBASE_RENAMES[e]||e;-1!==["earn_virtual_currency","spend_virtual_currency"].indexOf(s)&&(n.virtual_currency_name="coins",n.value=n.amount||1),cleverapps.firebase.logEvent(s,n)}cleverapps.adjust&&cleverapps.adjust.logEvent(e);var i=cleverapps.EventsLogger.FACEBOOK_RENAMES[e]||e;cleverapps.social&&cleverapps.social.logEvent?cleverapps.social.logEvent(i,n):cleverapps.facebookEventsLogger.logEvent(i,n),-1===cleverapps.EventsLogger.IGNORED_EVENTS.indexOf(e)&&this.addEvent(e,t)}},cleverapps.EventsLogger.prototype.addEvent=function(e,t){void 0===t&&(t={}),
e===cleverapps.EVENTS.PRODUCT_BOUGHT_LANGUAGE?e=cleverapps.EVENTS.PRODUCT_BOUGHT+"_"+cleverapps.settings.language:e===cleverapps.EVENTS.DAU_LANGUAGE?e=cleverapps.EVENTS.DAU+"_"+cleverapps.settings.language:e===cleverapps.EVENTS.BOOSTERS_BOUGHT_ITEM?e=cleverapps.EVENTS.BOOSTERS_BOUGHT+"_"+t.id:e===cleverapps.EVENTS.STAR_CHEST_OPEN_ITEM?e=cleverapps.EVENTS.STAR_CHEST_OPEN+"_"+t.id:e===cleverapps.EVENTS.SHARE_ITEM&&(e=cleverapps.EVENTS.SHARE+"_"+t.id),this.pool.names.push(e),this.pool.data.push(t);var n=this.getBaseParameters();setTimeout(this.sendEvents.bind(this,n),0)},cleverapps.EventsLogger.prototype.sendEvents=function(e){if(0<this.pool.names.length){var t=this.pool.names.join(",");console.log("Sending events - "+t),(e=cleverapps.extend(e,this.getBaseParameters())).events=t,e.params=this.pool.data,cleverapps.RestClient.post("/events/",e,function(){},function(){console.log("Failure event - "+t)}),this.pool.names=[],this.pool.data=[]}},
cleverapps.EventsLogger.prototype.getBaseParameters=function(){var e={};cleverapps.user&&cleverapps.user.id&&(e.id=cleverapps.user.id),cleverapps.environment&&(cleverapps.environment.getScreen()&&(e.screen=cleverapps.environment.getScreen()),void 0!==cleverapps.environment.levelNo&&(e.level=cleverapps.environment.levelNo),void 0!==cleverapps.environment.episodeNo&&(e.episode=cleverapps.environment.episodeNo));var t=Game.currentGame&&Game.currentGame.level;return t&&(t.content&&(e.version=t.content.version),t.hash&&(e.hash=t.hash)),cleverapps.settings&&cleverapps.settings.language&&(e.language=cleverapps.settings.language),e.source=cleverapps.User.calcSource(),levels.episodes&&(e.amountEpisodes=levels.episodes.getAmountEpisodes()),e},cleverapps.EventsLogger.FIREBASE_RENAMES={},cleverapps.EventsLogger.FIREBASE_RENAMES[cleverapps.EVENTS.REWARD_RECEIVED]="earn_virtual_currency",cleverapps.EventsLogger.FIREBASE_RENAMES[cleverapps.EVENTS.SPEND_COINS]="spend_virtual_currency",
cleverapps.EventsLogger.FACEBOOK_RENAMES={},cleverapps.EventsLogger.FACEBOOK_RENAMES[cleverapps.EVENTS.SPEND_COINS]=cleverapps.EVENTS.FB_SPEND_COINS,cleverapps.EventsLogger.IGNORED_EVENTS=[cleverapps.EVENTS.ACHIEVED_LEVEL,cleverapps.EVENTS.LEVEL_UP],cleverapps.FacebookEventsLogger=function(){this.batch=[];var e=cleverapps.User.calcSource();(-1===["android","ios"].indexOf(e)||cleverapps.flags.nofacebookevents)&&cleverapps.override(this,cleverapps.FakeFacebookEventsLogger)},cleverapps.FacebookEventsLogger.prototype.logEvent=function(e,t){var n={name:e};t&&(n.params=t),this.batch.push(n),this.logEventsBatch()},cleverapps.FacebookEventsLogger.prototype.logEventsBatch=cleverapps.accumulate(1e3,function(){cc.sys.os===cc.sys.OS_ANDROID?FacebookPlugin.logEventsBatch(JSON.stringify(this.batch)):cc.sys.os===cc.sys.OS_IOS&&(console.log("FacebookEventsLogger logEventsBatch"),webkitMessage("facebook",{action:"logEventsBatch",events:this.batch})),this.batch=[]}),cleverapps.FakeFacebookEventsLogger={
logEvent:function(){},logEventsBatch:function(){}};var History=function(){this.enabled=!0,this.data={},this.dirty={},this.sent={},this.load(),this.hasDirty()&&this.schedulePush()};if(History.prototype.hasDirty=function(){return 0<Object.keys(this.dirty).length},History.prototype.load=function(){var e=cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.HISTORY);e?(this.data=e.data,this.dirty=e.dirty,cleverapps.extend(this.dirty,e.sent),this.sent={}):cleverapps.user.registered<Date.now()-6e5&&(this.enabled=!1)},History.prototype.save=function(){cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.HISTORY,{data:this.data,dirty:this.dirty,sent:this.sent})},History.prototype.add=function(e,t){var n=cleverapps.user.getDaysSinceRegistration();if(n>History.DAYS&&(this.enabled=!1),this.enabled){var s=this.data[n+"_"+e];this.set(e,(s||0)+t)}},History.prototype.set=function(e,t){var n=cleverapps.user.getDaysSinceRegistration();if(n>History.DAYS&&(this.enabled=!1),this.enabled){var s=n+"_"+e
;this.data[s]=t,this.dirty[s]=!0,this.save(),this.schedulePush()}},History.prototype.schedulePush=function(){if(!this.pushScheduled){this.pushScheduled=!0;var e=cleverapps.parseInterval(History.PUSH_INTERVAL)-Date.now()+(this.lastPushTime?this.lastPushTime:0);e<=0&&(e=0),setTimeout(this.push.bind(this),e)}},History.prototype.push=function(){this.lastPushTime=Date.now();var e={};for(var t in this.dirty)e[t]=this.data[t];this.sent=cleverapps.clone(this.dirty),this.dirty={},this.save(),cleverapps.RestClient.post("/history/"+cleverapps.user.id,e,function(){console.log("Success pushing history: "+JSON.stringify(Object.keys(this.sent))),this.pushScheduled=!1,this.sent={},this.save(),this.hasDirty()&&this.schedulePush()}.bind(this),function(){console.log("Failure pushing history: "+JSON.stringify(this.sent)),this.pushScheduled=!1,cleverapps.extend(this.dirty,this.sent),this.sent={},this.save(),this.schedulePush()}.bind(this))},History.PUSH_INTERVAL="30 seconds",History.DAYS=14,
"undefined"!=typeof module&&void 0===cleverapps)cleverapps={config:{},isLocalhost:function(){}};cleverapps.Random={state:0,m:2147483648,a:1103515245,c:12345,seed:function(e){if(isNaN(e)&&cleverapps.isLocalhost())throw new Error("Seed is NaN");if("number"!=typeof e)if("string"==typeof e)cleverapps.Random.state=cleverapps.Random.strToInt(e);else{var t="Expecting string as seed";if(cleverapps.config.debugMode&&cleverapps.isLocalhost())throw Error(t);console.log(t)}else cleverapps.Random.state=Math.abs(parseInt(e)||0)%cleverapps.Random.m},randomSeed:function(){cleverapps.Random.state=Math.floor(Math.random()*cleverapps.Random.m);for(var e=cleverapps.Random.state,t=[],n=0;n<100;n++){if(x=this.nextInt(),0<=t.indexOf(x))return void this.randomSeed();t.push(x)}cleverapps.Random.state=e},shuffle:function(e){for(var t=[],n=[],s=0;s<e.length;s++)n.push(s);for(s=0;s<e.length;s++){var i=cleverapps.Random.random(n.length);t.push(e[n[i]]),n.splice(i,1)}return t},strToInt:function(e){for(var t=0,
n=0;n<e.length;n++)t=(1e3*t+e.charCodeAt(n))%cleverapps.Random.m;return t},nextInt:function(){return cleverapps.Random.state=(cleverapps.Random.a*cleverapps.Random.state+cleverapps.Random.c)%cleverapps.Random.m},nextDouble:function(){return cleverapps.Random.nextInt()/cleverapps.Random.m},mathChoose:function(e){if(0!==e.length)return e[Math.floor(Math.random()*e.length)]},choose:function(e,t){if(0!==e.length)return e[cleverapps.Random.random(0,e.length-1,t)]},random:function(e,t,n){var s;void 0!==n&&(s=cleverapps.Random.state,cleverapps.Random.seed(!1!==n?n:Math.floor(1e6*Math.random()))),void 0===t&&(t=e-1,e=0);var i=t-e+1,o=cleverapps.Random.nextInt()/cleverapps.Random.m,r=e+Math.floor(o*i);return void 0!==s&&cleverapps.Random.seed(s),r}},cleverapps.Random.randomSeed(),"undefined"!=typeof module&&(module.exports=cleverapps.Random),cleverapps.Audio=function(){this.cache={},WebViewAudioEngine.IsApplicable()&&(cc.sys.isWebViewAudio=!0,cc.audioEngine=new WebViewAudioEngine),
this.disk=void 0,this.muted=!1,this.volume=1,this.currentFade=void 0,cleverapps.eventBus.on("gamePause",this.onChangeMusic.bind(this)),cleverapps.eventBus.on("gameResume",this.onChangeMusic.bind(this)),cc.sys.isNative||"undefined"==typeof window||window.addEventListener("focus",function(e){cc.Audio._context&&cc.Audio._context.resume&&cc.Audio._context.resume()})},cleverapps.Audio.prototype.insertDisk=function(e){this.stopFadeOut(),this.disk=processVirtualUrl(e),this.onChangeMusic()},cleverapps.Audio.prototype.eject=function(){this.stopFadeOut(),this.disk=void 0,this.onChangeMusic()},cleverapps.Audio.prototype.mute=function(){this.muted||(this.muted=!0,this.onChangeMusic())},cleverapps.Audio.prototype.unmute=function(){this.muted&&(this.muted=!1,this.onChangeMusic())},cleverapps.Audio.prototype.onChangeMusic=function(){if(this.disk&&!this.muted&&cleverapps.settings.music&&!cc.game.isPaused()){this.logSound(this.disk);try{this.volume!==this.realVolume&&this.setVolume(this.volume),
cc.sys.isWebViewAudio||cc.loader.getRes(this.disk)?cc.audioEngine.playMusic(this.disk,!0):cc.loader.load(this.disk,this.onChangeMusic.bind(this))}catch(e){var t=typeof cc.loader.getRes(this.disk);throw cleverapps.ReportStream.debug("AUDIO "+t+" url "+this.disk),e}}else cc.audioEngine.stopMusic()},cleverapps.Audio.prototype.stopFadeOut=function(){this.setVolume(1),this.currentFade&&(clearInterval(this.currentFade),delete this.currentFade)},cleverapps.Audio.prototype.setVolume=function(e){this.volume=e,cc.audioEngine.canChangeMusicVolume()&&!this.muted&&cleverapps.settings.music&&!cc.game.isPaused()&&(this.realVolume=e,cc.audioEngine.setMusicVolume(e))},cleverapps.Audio.prototype.fadeOut=function(e){if(this.stopFadeOut(),this.disk){var t=(e||400)/20,n=1/t;this.currentFade=setInterval(function(){0===t?this.eject():(t--,this.setVolume(Math.max(0,this.volume-n)))}.bind(this),20)}},cleverapps.Audio.prototype.playSound=function(e,t){if(cleverapps.settings.sound&&!cc.game.isPaused(
)&&!this.muted){if(e=processVirtualUrl(e,{useUnusedBundles:!0})){t=t||{},this.logSound(e,t);var n=this.cache[e],s=void 0!==t.throttle?t.throttle:cleverapps.Audio.THROTTLE_AUDIO;if(n){if(!cc.sys.isNative&&n.getPlaying()&&n.startPlaying+s>Date.now())return;cc.sys.isNative&&cc.audioEngine.stopEffect(n)}var i=(cc.audioEngine._audioPool[e]||[]).filter(function(e){return!e.getPlaying()})[0];return i&&cc.audioEngine.stopEffect(i),(n=cc.audioEngine.playEffect(e,t.loop))&&(n.startPlaying=Date.now(),this.cache[e]=n),n}cleverapps.config.debugMode}},cleverapps.Audio.prototype.stopSound=function(e){cc.audioEngine.stopEffect(e)},cleverapps.Audio.THROTTLE_AUDIO=250,cleverapps.Audio.prototype.logSound=function(e,t){cleverapps.config.debugMode&&cleverapps.keyboardController.isPressed(cc.KEY.s)&&(console.log("--------------------- sound logging ----------------------"),console.log("sound file",e),t&&console.log("sound options",t),console.log("----------------------------------------------------------"))
},cc.audioEngine.canChangeMusicVolume=function(){return cc.audioEngine._currMusic&&cc.audioEngine._currMusic.setVolume};var WebViewAudioEngine=function(){this._musicVolume=1,this._audioPool={},this.batch={},this.sendBatch=cleverapps.accumulate(0,this.sendBatch.bind(this))};WebViewAudioEngine.prototype._pausePlaying=function(){},WebViewAudioEngine.prototype._resumePlaying=function(){},WebViewAudioEngine.prototype.setMusicVolume=function(e){e-=0,isNaN(e)&&(e=1),1<e&&(e=1),e<0&&(e=0),this._musicVolume=e,this.batch.setMusicVolume={action:"setMusicVolume",volume:e},this.sendBatch()},WebViewAudioEngine.prototype.sendBatch=function(){var e=cleverapps.values(this.batch);cc.sys.os===cc.sys.OS_ANDROID&&(e=JSON.stringify(e)),AudioPlugin.sendBatch(e),this.batch={}},WebViewAudioEngine.prototype.getMusicVolume=function(){return this._musicVolume},WebViewAudioEngine.prototype.playMusic=function(e,t){e&&(this.batch.musicAction={action:"playMusic",url:e,loop:Boolean(t)},this.sendBatch())},
WebViewAudioEngine.prototype.stopMusic=function(){this.batch.musicAction={action:"stopMusic"},this.sendBatch()},WebViewAudioEngine.prototype.stopEffect=function(e){e&&e.url&&(this.batch["effect_"+e.url]={action:"stopEffect",url:e.url},this.sendBatch())},WebViewAudioEngine.prototype.stopAllEffects=function(){},WebViewAudioEngine.prototype.playEffect=function(e,t){if(e)return this.batch["effect_"+e]={action:"playEffect",url:e,loop:Boolean(t)},this.sendBatch(),new WebViewAudio(e,t)},WebViewAudioEngine.prototype.canChangeMusicVolume=function(){return!0},WebViewAudioEngine.IsApplicable=function(){return cc.sys.isWebView&&"undefined"!=typeof AudioPlugin};var WebViewAudio=function(e,t){this.url=e,this.loop=t,this.startPlaying=Date.now()};WebViewAudio.prototype.getPlaying=function(){return Date.now()<this.startPlaying+cleverapps.parseInterval(WebViewAudio.FAKE_DURATION)},WebViewAudio.FAKE_DURATION="1 second",cleverapps.ABTest=function(){this.group=void 0,this.setGroup(cleverapps.user.abtest)},
cleverapps.ABTest.prototype.isRunning=function(e){return cleverapps.ABTest.ACTIVE_TEST&&cleverapps.ABTest.ACTIVE_TEST.name===e},cleverapps.ABTest.prototype.setGroup=function(e){this.group=void 0,cleverapps.ABTest.ACTIVE_TEST&&(-1===cleverapps.ABTest.ACTIVE_TEST.groups.indexOf(e)?cleverapps.ABTest.wantAssignGroup()&&(this.group=cleverapps.Random.mathChoose(cleverapps.ABTest.ACTIVE_TEST.groups)):this.group=e),cleverapps.user.abtest!==this.group&&(cleverapps.user.abtest=this.group,this.afterGroupChosen&&this.afterGroupChosen(),cleverapps.user.save())},cleverapps.ABTest.prototype.purchaseEvent=function(e){void 0!==this.group&&cleverapps.eventLogger.logEvent("abtest_"+this.group,{amount:e})};var Alarm=function(){this.on=!1,this.alarms={},this.priority=0,this.onChangeListeners={}};Alarm.prototype.isOn=function(){return 0<this.priority},Alarm.prototype.start=function(e,t){this.alarms[e]=t||1,this.onChange()},Alarm.prototype.stop=function(e){delete this.alarms[e],this.onChange()},
Alarm.prototype.clear=function(){this.alarms={},this.onChange()},Alarm.prototype.onChange=function(){var e=0;for(var t in this.alarms)this.alarms[t]>e&&(e=this.alarms[t]);if(e!==this.priority)for(var t in this.priority=e,this.onChangeListeners)this.onChangeListeners[t](e)};var Mission=function(e,t,n){this.started=void 0,this.type=e,this.completed=!1,this.details={},this.result=0,this.onChangeResults=function(){},cleverapps.extend(this,Missions[this.type]),this.isMinigameMission()&&(this.currency=this.getStartCurrency()),this.type===Mission.TYPE_LANTERN&&(this.result=1);var s=!t;if(s){if(this.started=Date.now(),this.needShowStartWindow=!0,this.oncePerEvent){var i=cleverapps.eventManager.getFeatureEvent(this.feature);this.eventFinishTime=i?i.finish.getTime():Date.now()}}else this.load(t);if(this.competition){(s||n)&&Competition.CLEAN_SAVED(this.type);var o=Competition.optionsByMission(this);this.runningCompetition=new Competition(o),
this.runningCompetition.onChangeResultsListeners.mission=this.resultsChanged.bind(this),cleverapps.friends.playerInfoChangedListeners.mission=this.userInfoChanged.bind(this),this.runningCompetition.start()}this.logic&&(this.logic=new this.logic(this,s)),this.onUpdateState()};Mission.prototype.onUpdateState=function(){this.countdown&&(this.countdown.remove(),delete this.countdown),this.isRunning()?this.countdown=new cleverapps.CountDown(this.getTimeLeft(),{onFinish:this.onUpdateState.bind(this),permanent:!0}):(this.autoComplete&&(this.completed=!0),this.runningCompetition&&this.runningCompetition.stop());var e=cleverapps.sideBar.findMissionIcon(this.type);e&&e.resetState()},Mission.prototype.userInfoChanged=function(e){this.runningCompetition.onUserInfoChanged(e),cleverapps.missionManager.table.resetResults(this.type),this.resultsChanged()},Mission.prototype.resultsChanged=function(){this.onChangeResults(),this.logic&&this.logic.onChangeResults&&this.logic.onChangeResults()},
Mission.prototype.beforeRemove=function(){this.countdown&&(this.countdown.remove(),delete this.countdown),this.runningCompetition&&this.runningCompetition.stop()},Mission.prototype.load=function(e){this.started=e.started,this.result=e.result,this.details=e.details,this.currency=e.currency,this.eventFinishTime=e.eventFinishTime},Mission.prototype.update=function(e,t){if(this.isRunning()&&(this.result+=e,t&&(this.details=t)),this.runningCompetition&&0!==e&&this.runningCompetition.updatePlayerResult(cleverapps.user.id,this.result),this.onUpdateState(),this.onChangeResults(),cleverapps.missionManager.save(),this.logic&&this.logic.onUpdate)return this.logic.onUpdate(this);this.semaphore===Missions.SEMAPHORE_CLASSIC&&cleverapps.missionManager.dispatchEvent(Mission.EVENT_COLLECT_CLOVER,{amount:e})},Mission.prototype.receiveReward=function(){if(this.logic&&this.logic.receiveReward)return this.logic.receiveReward(this);var e=this.getPrize(),t="_lost";return e&&(t="_prize"),
0===this.place&&this.runningCompetition&&(t="_first"),cleverapps.eventLogger.logEvent(cleverapps.EVENTS.MISSION_FINISH+t),e&&cleverapps.history.add("mwin",1),cleverapps.history.add("misn"+this.type,this.result),e},Mission.prototype.skipNext=function(){return this.logic&&this.logic.skipNext&&this.logic.skipNext()},Mission.prototype.useMissionIntent=function(e){var t=this.getViewClass();cleverapps.scenes.replaceScene(new t(this),e)},Mission.prototype.updateCurrency=function(e,t){0!==e&&void 0!==this.currency&&(this.currency+=e,t&&(this.details=t),this.onUpdateState(),cleverapps.missionManager.save())},Mission.prototype.getSummary=function(){return this.runningCompetition?{place:this.runningCompetition.calcPlace(),points:this.runningCompetition.player.amount}:{place:"?",points:this.result}},Mission.prototype.getResults=function(){if(!this.runningCompetition)return[];var e=this.runningCompetition.getResults().map(function(e,t){return{id:e.id,player:e.player,text:e.name,avatar:{id:e.id,
avatar:e.avatar},amount:e.amount}});return e.sort(function(e,t){return t.amount-e.amount}),e.forEach(function(e,t){e.place=t+1}),e},Mission.prototype.save=function(){return{started:this.started,type:this.type,result:this.result,currency:this.currency,eventFinishTime:this.eventFinishTime,details:this.details}},Mission.prototype.getName=function(){return this.name},Mission.prototype.getWindowBundleName=function(){return this.bundle},Mission.prototype.isMinigameMission=function(){return void 0!==this.minigame},Mission.prototype.isBattlePassMission=function(){return void 0!==this.battlePass},Mission.prototype.getViewClass=function(){return this.view},Mission.prototype.complete=function(){this.completed=!0},Mission.prototype.getIcon=function(){return cleverapps.skins.getSlot("missionIcon",{type:this.type})},Mission.prototype.wantsToActOnFinish=function(){return this.logic&&this.logic.wantsToActOnFinish?this.logic.wantsToActOnFinish():0!==this.result&&"?"!==this.getSummary().place},
Mission.prototype.finishTime=function(){if(this.feature){if(this.oncePerEvent)return this.eventFinishTime;var e=cleverapps.eventManager.getFeatureEvent(this.feature);return e?e.finish.getTime():Date.now()}return this.started+cleverapps.parseInterval(this.duration)},Mission.prototype.getTimeLeft=function(){return Math.max(0,this.finishTime()-Date.now())},Mission.prototype.isRunning=function(){return!this.isCompleted()&&this.finishTime()>Date.now()},Mission.prototype.isCompleted=function(){return this.completed},Mission.prototype.canPlayMinigame=function(){return this.isMinigameMission()&&this.currency&&this.currency>=this.getMinigamePrice()},Mission.prototype.getMinigamePrice=function(){return this.minigame.price},Mission.prototype.isMinigameReadyToFinish=function(){return this.isMinigameMission()&&this.logic&&this.logic.isMinigameReadyToFinish&&this.logic.isMinigameReadyToFinish()},Mission.prototype.getStartCurrency=function(){
return void 0!==this.startCurrency?this.startCurrency:this.getMinigamePrice()},Mission.prototype.getMinigameClass=function(){return this.minigame.className},Mission.prototype.getLevelReward=function(){return-1!==[Mission.TYPE_TREASURE_SEARCH].indexOf(this.type)?[1,3,2]:[1,1]},Mission.prototype.getPrize=function(){if(this.prize)return this.minigame?this.prize.prepareByRich?cleverapps.user.prepareRewardByRich(this.prize):this.prize:(this.place=this.getSummary().place,this.place<this.prize.length?RewardsConfig.Tournament.prepareByRich?cleverapps.user.prepareRewardByRich(this.prize[this.place]):this.prize[this.place]:void 0)},Mission.prototype.updateCompetitionResults=function(){this.runningCompetition&&this.runningCompetition.updatePlayerResult(cleverapps.user.id,this.result)},Mission.cooldownInterval=function(e){return cleverapps.config.debugMode?"10 seconds":Missions[e]?Missions[e].cooldown:"10 seconds"};var MissionManager=function(){this.missions=[],this.lastRemoved={},
this.table=new cleverapps.Table,this.load(cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.MISSIONS))};MissionManager.isObsoleteMissionType=function(e){return-1===[Mission.TYPE_COMBO,Mission.TYPE_COLLECT_MARK,Mission.TYPE_BURN_NEARBY,Mission.TYPE_LETTER,Mission.TYPE_TREASURE_SEARCH,Mission.TYPE_LANTERN,Mission.TYPE_WARDROBE,Mission.TYPE_FAVORITE_SALE,Mission.TYPE_LIVES_SALE,Mission.TYPE_BOOSTERS_SALE,Mission.TYPE_COINS_SALE,Mission.TYPE_BATTLEPASS,Mission.TYPE_RACE,Mission.TYPE_RAFFLE,Mission.TYPE_STICKERS_COLLECTION,Mission.TYPE_BONUS_WORLD,Mission.TYPE_ENERGY_FEAST,Mission.TYPE_SLOT_MACHINE].indexOf(e)},MissionManager.prototype.load=function(e,t){if(e){this.missions=[],this.lastRemoved=e.lastRemoved||{};for(var n=this.listAvailableTypes(),s=(Array.isArray(e)?e:e.missions)||[],i=0;i<s.length;i++){var o=s[i];-1===n.indexOf(o.type)||MissionManager.isObsoleteMissionType(o.type)||(void 0===o.lastRemoved?this.add(o.type,o,t):this.lastRemoved[o.type]=o.lastRemoved)}}},
MissionManager.prototype.getPlayableMissions=function(){return this.missions.filter(function(e){return e.isRunning()&&e.canPlayMinigame()})},MissionManager.prototype.getRunningMission=function(e){for(var t=0;t<this.missions.length;t++)if(this.missions[t].isRunning()&&this.missions[t].semaphore&e)return this.missions[t]},MissionManager.prototype.skipNext=function(){return 0<this.missions.filter(function(e){return e.skipNext()}).length},MissionManager.prototype.getMissionWithIntent=function(){for(var e in this.missions){var t=this.missions[e];if(t.logic&&t.logic.hasIntent&&t.logic.hasIntent())return t}},MissionManager.prototype.dispatchEvent=function(e,t){for(var n in this.missions){var s=this.missions[n];s.logic&&s.logic.processEvent&&s.logic.processEvent(e,t||{})}},MissionManager.prototype.findByType=function(e){for(var t=0;t<this.missions.length;t++)if(this.missions[t].type===e)return this.missions[t]},MissionManager.prototype.reset=function(e){this.missions=[],this.lastRemoved={},
this.save()},MissionManager.prototype.encodeLastRemoved=function(){return this.missions.forEach(function(e){delete this.lastRemoved[e.type]},this),Object.keys(this.lastRemoved).forEach(function(e){(!Missions[e]||MissionManager.isObsoleteMissionType(+e)||this.lastRemoved[e]+cleverapps.parseInterval(Mission.cooldownInterval(e))<Date.now())&&delete this.lastRemoved[e]},this),Object.keys(this.lastRemoved).map(function(e){var t=this.lastRemoved[e];return{type:parseInt(e),lastRemoved:t}},this)},MissionManager.prototype.save=function(e){var t=this.missions.map(function(e){return e.save()});t=t.concat(this.encodeLastRemoved()),cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.MISSIONS,t),e||this.addUpdateTask()},MissionManager.prototype.sendUpdateTask=function(){Game.currentGame&&Game.currentGame.onChangeOutcomeListeners.missionsUpdate&&(Game.currentGame.onChangeOutcomeListeners.missionsUpdate=function(){}),MissionManager.sendUpdateTimeout&&(clearTimeout(MissionManager.sendUpdateTimeout),
MissionManager.sendUpdateTimeout=void 0),cleverapps.synchronizer.addUpdateTask("missions")},MissionManager.prototype.addUpdateTask=function(){"merge"!==cleverapps.config.type&&Game.currentGame&&Game.currentGame.outcome===GameBase.OUTCOME_UNKNOWN?MissionManager.sendUpdateTimeout||cleverapps.environment.isSceneWithPreview()||(Game.currentGame.onChangeOutcomeListeners.missionsUpdate=this.addUpdateTask.bind(this),MissionManager.sendUpdateTimeout=setTimeout(this.sendUpdateTask.bind(this),cleverapps.parseInterval("1 minute"))):this.sendUpdateTask()},MissionManager.prototype.getInfo=function(){var n=[];return this.missions.forEach(function(e){var t=e.isCompleted()?{type:e.type,lastRemoved:Date.now()}:e.save();n.push(t)}),n=n.concat(this.encodeLastRemoved())},MissionManager.prototype.updateInfo=function(e,t){for(;0<this.missions.length;)this.remove(this.missions[0],t);this.lastRemoved={},this.load(e,t),this.save(t)},MissionManager.prototype.anyCompleted=function(){for(
var e=0;e<this.missions.length;e++){var t=this.missions[e];if(t.isCompleted()){if(t.wantsToActOnFinish())return t;this.remove(t)}}},MissionManager.prototype.showCompleted=function(){var s=this.anyCompleted();s&&cleverapps.metha.display({focus:"missionCompleted"+s.name,actions:[function(e){this.remove(s);var t=s.finishView;if(t){var n=new t(s);n instanceof cleverapps.FixedWidthScene||n instanceof SceneProxy?cleverapps.scenes.replaceScene(n,e):cleverapps.metha.onceNoWindowsListener=e}else e()}.bind(this),function(e){var t=s.receiveReward();t?(new RewardWindow({reward:t}),cleverapps.metha.onceNoWindowsListener=e):e()}]})},MissionManager.prototype.pendingStartWindow=function(){for(var e=0;e<this.missions.length;e++)if(this.missions[e].needShowStartWindow&&this.missions[e].startWindow)return this.missions[e]},MissionManager.prototype.showStartWindow=function(){var t=this.pendingStartWindow();t.needShowStartWindow=!1,cleverapps.metha.display({focus:"missionStartWindow_"+t.type,
action:function(e){new t.startWindow(t),cleverapps.metha.onceNoWindowsListener=e}.bind(this)})},MissionManager.prototype.getProjectAvailableTypes=function(){var e=[Mission.TYPE_FAVORITE_SALE,Mission.TYPE_RAFFLE,Mission.TYPE_BOOSTERS_SALE];if("board"===cleverapps.config.type?(e.push(Mission.TYPE_LETTER),e.push(Mission.TYPE_COINS_SALE),e.push(Mission.TYPE_RACE),e.push(Mission.TYPE_WARDROBE)):"solitaire"===cleverapps.config.type?(e.push(Mission.TYPE_LETTER),cleverapps.config.debugMode&&e.push(Mission.TYPE_COINS_SALE)):"differences"===cleverapps.config.type?e.push(Mission.TYPE_LETTER):(e.push(Mission.TYPE_COMBO),e.push(Mission.TYPE_COLLECT_MARK),e.push(Mission.TYPE_BURN_NEARBY),cleverapps.config.editorMode||e.push(Mission.TYPE_LANTERN)),cleverapps.lives&&e.push(Mission.TYPE_LIVES_SALE),-1!==["riddles","heroes","olympics","tripeaks","differences","scramble","wordheaps"].indexOf(cleverapps.config.name)&&e.push(Mission.TYPE_TREASURE_SEARCH),-1!==["wordsoup","crocword","magicwords"].indexOf(
cleverapps.config.name)&&e.push(Mission.TYPE_STICKERS_COLLECTION),-1!==["scramble","wordheaps","riddles","heroes"].indexOf(cleverapps.config.name)&&e.push(Mission.TYPE_BONUS_WORLD),cleverapps.config.debugMode&&-1!==["scramble","wordheaps"].indexOf(cleverapps.config.name)&&e.push(Mission.TYPE_SLOT_MACHINE),-1!==["merge"].indexOf(cleverapps.config.type)&&(e=[Mission.TYPE_ENERGY_FEAST,Mission.TYPE_BATTLEPASS]),cleverapps.config.debugMode&&-1!==["riddles","heroes"].indexOf(cleverapps.config.name)){e.push(Mission.TYPE_BATTLEPASS);var t=e.indexOf(Mission.TYPE_LANTERN);-1!==t&&e.splice(t,1)}return e},MissionManager.prototype.listAvailableTypes=function(){return-1!==["spades"].indexOf(cleverapps.config.name)?[]:this.getProjectAvailableTypes().filter(function(e){var t=Missions[e].feature;if(t&&-1===cleverapps.eventManager.listCurrentFeatures().indexOf(t))return!1;if(t){var n=(Missions[e].productsCheap||[]).concat(Missions[e].productsExpensive||[]);if(
cleverapps.payments.isProductsExists&&!cleverapps.payments.isProductsExists(n))return!1}var s=Missions[e].logic;return!(s&&s.IsAvailable&&!s.IsAvailable())&&cleverapps.user.checkAvailable(Missions[e].available)}.bind(this))},MissionManager.prototype.canCreateTypes=function(){var e=this.listAvailableTypes(),t=cleverapps.skins.getSlot("removeMissions");if(t&&(e=cleverapps.substract(e,t)),0===e.length)return!1;for(var s=0,n=0;n<this.missions.length;n++)s|=this.missions[n].semaphore;var i=cleverapps.competitionPlayers.getAmount();e=e.filter(function(e){var t=this.lastRemoved[e]||0,n=Missions[e].competition&&Missions[e].competition.amount[1]||0;return 0==(s&Missions[e].semaphore)&&t+cleverapps.parseInterval(Mission.cooldownInterval(e))<=Date.now()&&n<=i}.bind(this));var o=0;return e.forEach(function(e){var t=Missions[e].priority||0;o<t&&(o=t)}),e.filter(function(e){return(Missions[e].priority||0)===o})},MissionManager.prototype.run=function(){this.checkIcons();var e=this.canCreateTypes()
;if(0<e.length){var t=cleverapps.Random.choose(e);this.add(t),this.save(),cleverapps.playSession.set(cleverapps.EVENTS.MISSION_START_DAU+"_"+Missions[t].name,!0)}},MissionManager.prototype.checkIcons=function(){this.missions.forEach(function(e){if(e.isRunning()&&!cleverapps.sideBar.findMissionIcon(e.type)){var t=new MissionIcon(e);cleverapps.sideBar.addIcon(t)}})},MissionManager.prototype.remove=function(e,t){e.beforeRemove();var n=this.missions.indexOf(e);if(-1!==n){this.table.resetResults(e.type),this.missions.splice(n,1),this.lastRemoved[e.type]=Date.now(),e.oncePerEvent&&(this.lastRemoved[e.type]=e.eventFinishTime),t||this.save();var s=cleverapps.sideBar.findMissionIcon(e.type);return s?s.removeFromSideBar():cleverapps.ReportStream.debug("Removing non-existent icon of type: "+e.type+" - "+JSON.stringify((new Error).stack)),!0}},MissionManager.prototype.add=function(e,t,n){var s=new Mission(e,t,n);this.missions.push(s);var i=new MissionIcon(s);cleverapps.sideBar.addIcon(i)},
cleverapps.Adversting={idfa:void 0,getIdfa:function(){return this.idfa?(cc.sys.isNative&&console.log("idfa - "+this.idfa),this.idfa):(cc.sys.isNative&&cc.sys.isWebView&&cc.sys.os===cc.sys.OS_ANDROID?"undefined"!=typeof AdverstingPlugin&&"function"==typeof AdverstingPlugin.getIdfa&&(e=AdverstingPlugin.getIdfa(),console.log("android idfa - "+this.idfa)):cc.sys.isNative&&cc.sys.isWebView&&cc.sys.os===cc.sys.OS_IOS?(e=cleverapps.webViewData.advertisingId,console.log("ios idfa - "+this.idfa)):cleverapps.isLocalhost()&&(e="localhostIDFA"),this.idfa=e);var e},postbackUnity:function(e){var t=cleverapps.User.calcSource();if("amazon"===t||"android"===t){var n=cleverapps.config.android.unityGameId;"ios"===t&&(n=cleverapps.config.ios.unityGameId);var s="https://postback.unityads.unity3d.com/games/"+n+"/install?advertisingTrackingId="+e;cleverapps.RestClient.get(s,{},function(e){})}}},cleverapps.Adjust=function(){this.settings=cleverapps.config.adjust||{},
this.settings.events=this.settings.events||{},this.settings&&cc.sys.isNative&&"undefined"!=typeof AdjustPlugin&&!cleverapps.flags.noadjust||cleverapps.override(this,cleverapps.FakeAdjust),this.initialize()},cleverapps.Adjust.prototype.initialize=function(){var e=this.settings.token;AdjustPlugin.init(e,cleverapps.Adjust.ENVIRONMENT,cleverapps.Adjust.LOG_LEVEL)},cleverapps.Adjust.prototype.logPurchase=function(e,t,n){var s=this.settings.purchaseToken;AdjustPlugin.logPurchase(s,e,t,n)},cleverapps.Adjust.prototype.logEvent=function(e){var t=this.settings.events[e];t&&AdjustPlugin.logEvent(t)},cleverapps.FakeAdjust={initialize:function(){},logPurchase:function(){},logEvent:function(){}},cleverapps.Adjust.SANDBOX="sandbox",cleverapps.Adjust.PRODUCTION="production",cleverapps.Adjust.ENVIRONMENT=cleverapps.Adjust.PRODUCTION,cleverapps.Adjust.LOG_LEVEL="VERBOSE",cleverapps.FirebaseManager={run:function(){
return cc.sys.isWebView&&cc.sys.os===cc.sys.OS_IOS?cleverapps.WebViewIosFirebase:cleverapps.flags.nofirebase?cleverapps.FakeFirebase:cc.sys.isNative&&cc.sys.isWebView&&"undefined"!=typeof FirebasePlugin?cleverapps.WebViewAndroidFirebase:"undefined"!=typeof sdkbox&&sdkbox.firebase?sdkbox.firebase.Analytics:(cc.sys.isNative&&console.log("No firebase plugin found!"),cleverapps.FakeFirebase)}},cleverapps.SdkBoxFirebase={init:function(){console.log("init firebase"),sdkbox.firebase.Analytics.init(),sdkbox.firebase.Analytics.setUserID(cleverapps.user.id)},logEvent:function(e,t){sdkbox.firebase.Analytics.logEvent(e,t)},setScreenName:function(e,t){sdkbox.firebase.Analytics.setScreenName(e,t)}},cleverapps.WebViewAndroidFirebase={batch:[],sendBatch:cleverapps.accumulate(1e3,function(){var e=cleverapps.WebViewAndroidFirebase;0<e.batch.length&&(FirebasePlugin.sendBatch(JSON.stringify(e.batch)),e.batch=[])}),init:function(){this.batch.push({method:"setUserID",id:cleverapps.user.id}),this.sendBatch()
},logEvent:function(e,t){this.batch.push({method:"logEvent",name:e,data:JSON.stringify(t)}),this.sendBatch()},setScreenName:function(e,t){this.batch.push({method:"setScreenName",screen:e,scene:t}),this.sendBatch()}},cleverapps.WebViewIosFirebase={init:function(){webkitMessage("firebase",{action:"setUserID",id:cleverapps.user.id})},logEvent:function(e,t){webkitMessage("firebase",{action:"logEvent",name:e,data:JSON.stringify(t)})},setScreenName:function(e,t){webkitMessage("firebase",{action:"setScreenName",screen:e,scene:t})}},cleverapps.FakeFirebase={init:function(){},logEvent:function(){},setScreenName:function(){}},cleverapps.LocalPushes=function(){this.initSender(),this.load(),this.queue={},Messages.onInitializedListeners.localPushes=this.processQueue.bind(this)},cleverapps.LocalPushes.prototype.getByCode=function(e){for(var t in e=cleverapps.castType(e),cleverapps.LocalPushes.TYPES){var n=cleverapps.LocalPushes.TYPES[t];if(n.code===e)return n}},
cleverapps.LocalPushes.prototype.processQueue=function(){var e=this.queue;for(var t in e){var n=e[t],s=this.getByCode(t);s&&this.sendPush(s,n)}this.queue={}},cleverapps.LocalPushes.prototype.init=function(){this.onShow(),cc.eventManager.addCustomListener(cc.game.EVENT_SHOW,cleverapps.throttle(1e3,this.onShow.bind(this)))},cleverapps.LocalPushes.prototype.onShow=function(){this.cancelSoonPushes(),cleverapps.user.checkAvailable(cleverapps.LocalPushes.LETS_PLAY_AVAILABLE)?this.sendPush(cleverapps.LocalPushes.TYPES.LETS_PLAY,cleverapps.parseInterval(cleverapps.LocalPushes.LETS_PLAY_TIMEOUT)):this.sendPush(cleverapps.LocalPushes.TYPES.LETS_PLAY,cleverapps.parseInterval(cleverapps.LocalPushes.LETS_PLAY_BEGGINERS_TIMEOUT))},cleverapps.LocalPushes.prototype.initSender=function(){cc.sys.isNative&&cc.sys.os===cc.sys.OS_IOS?this.sender=cleverapps.LocalPushes.IosWebViewSender:"object"==typeof LocalPushesPlugin?this.sender=cleverapps.LocalPushes.AndroidWebViewSender:(levels.user.haveTmpId(
)||cleverapps.isLocalhost()||(this.sender=cleverapps.LocalPushes.FacebookSender),[cleverapps.FakeInstant,cleverapps.FakeFacebook].forEach(function(e){cleverapps.social instanceof e&&(this.sender=void 0)},this)),this.sender||(this.sender=cleverapps.LocalPushes.FakeSender)},cleverapps.LocalPushes.prototype.load=function(){var e=cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.LOCAL_PUSHES);this.data=e||{}},cleverapps.LocalPushes.prototype.save=function(){cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.LOCAL_PUSHES,this.data)},cleverapps.LocalPushes.prototype.sendPush=function(e,t){var n=e.code;if(t<cleverapps.parseInterval(cleverapps.LocalPushes.TIMEOUT_THRESHOLD))this.cancelPush(e);else if(Messages.isInitialized()){var s=Date.now()+t;this.data[n]&&Math.abs(this.data[n].when-s)<Math.max(.1*t,cleverapps.parseInterval("1 minute"))||(this.data[n]={when:s},this.save(),this.sender.sendPush(e,t))}else this.queue[n]=t},cleverapps.LocalPushes.prototype.cancelPush=function(e){
var t=e.code;delete this.queue[t],this.sender.cancelPush(e),this.data[t]&&(delete this.data[t],this.save())},cleverapps.LocalPushes.prototype.cancelSoonPushes=function(){for(var e in this.data){if(this.data[e].when-Date.now()<=cleverapps.parseInterval(cleverapps.LocalPushes.TIMEOUT_THRESHOLD)){var t=this.getByCode(e);t&&this.cancelPush(t)}}},cleverapps.LocalPushes.GetPushData=function(e,t){var n=Messages.get(e.message),s=Messages.get(e.title,{gameTitle:Messages.get(cleverapps.config.title)});return Array.isArray(n)||(n=[n]),Array.isArray(s)||(s=[s]),void 0===t&&(t=cleverapps.Random.random(0,n.length-1)),{text:n[t],title:s[t]||cleverapps.Random.mathChoose(s),index:t}},cleverapps.LocalPushes.TYPES={BOUNTY:{code:0,title:"LocalPushes.Bounty.Title",message:"LocalPushes.Bounty"},BONUS_ROUND:{code:2,title:"LocalPushes.BonusRound.Title",message:"LocalPushes.BonusRound"},LIVES:{code:3,title:"LocalPushes.Lives.Title",message:"LocalPushes.Lives"},MINI_GAME:{code:4,
title:"LocalPushes.MiniGame.Title",message:"LocalPushes.MiniGame"},LETS_PLAY:{code:5,title:"LocalPushes.LetsPlay.Title",message:"LocalPushes.LetsPlay"},FREE_CHEST:{code:6,title:"LocalPushes.FreeChest.Title",message:"LocalPushes.FreeChest"},ENERGY_LOTTERY:{code:7,title:"LocalPushes.EnergyLottery.Title",message:"LocalPushes.EnergyLottery"},FRUIT_RIPE:{code:8,title:"LocalPushes.FruitRipe.Title",message:"LocalPushes.FruitRipe"},CASTLE_PRIZE:{code:9,title:"LocalPushes.CastlePrize.Title",message:"LocalPushes.CastlePrize"},ORDER_READY:{code:10,title:"LocalPushes.OrderReady.Title",message:"LocalPushes.OrderReady"},TREE_CHOPPED:{code:11,title:"LocalPushes.TreeChopped.Title",message:"LocalPushes.TreeChopped"},BUILDING_BUILT:{code:12,title:"LocalPushes.BuildingBuilt.Title",message:"LocalPushes.BuildingBuilt"},MAGIC_PLANT_READY:{code:13,title:"LocalPushes.MagicPlantReady.Title",message:"LocalPushes.MagicPlantReady"},MINI_GAME_PRIZE:{code:14,title:"LocalPushes.MineSweeperReady.Title",
message:"LocalPushes.MineSweeperReady"}},"merge"===cleverapps.config.type&&(cleverapps.LocalPushes.TYPES.LIVES={code:3,title:"LocalPushes.Energy.Title",message:"LocalPushes.Energy"}),cleverapps.LocalPushes.TIMEOUT_THRESHOLD="1 minute",cleverapps.LocalPushes.LETS_PLAY_TIMEOUT="7 days",cleverapps.LocalPushes.LETS_PLAY_BEGGINERS_TIMEOUT="1 day",cleverapps.LocalPushes.LETS_PLAY_AVAILABLE={episode:1,level:0},"merge"===cleverapps.config.type&&(cleverapps.LocalPushes.LETS_PLAY_AVAILABLE={episode:0,level:6}),cleverapps.LocalPushes.FakeSender={askPermission:function(){},sendPush:function(e,t){if(cleverapps.config.debugMode){var n=cleverapps.LocalPushes.GetPushData(e),s=e.code;n.text&&n.title?(this.pushes||(this.pushes={}),this.pushes[e.code]=setTimeout(function(){cleverapps.config.wysiwygMode||cleverapps.Notification.create(n.text)},t),console.log("FakeSender: scheduled: "+n.text,cleverapps.intervalToString(t))):cleverapps.throwAsync("empty fake push - "+s)}},cancelPush:function(e){if(
cleverapps.config.debugMode){this.pushes&&this.pushes[e.code]&&(clearTimeout(this.pushes[e.code]),this.pushes[e.code]=void 0);var t=cleverapps.LocalPushes.GetPushData(e);cleverapps.config.wysiwygMode||cleverapps.Notification.create("Removed: "+t.text),console.log("FakeSender: removed: "+t.text,e)}}},cleverapps.LocalPushes.AndroidWebViewSender={askPermission:function(){},sendPush:function(e,t){var n=cleverapps.LocalPushes.GetPushData(e),s=e.code,i=n.title,o=n.text;if(o&&i){var r=LocalPushesPlugin.scheduleNotification(i,o,t,s);r&&cleverapps.ReportStream.debug("Android send push error "+r),cleverapps.LocalPushes.FacebookSender.sendPush(e,t,n.index)}else cleverapps.throwAsync("empty android push - "+s)},cancelPush:function(e){LocalPushesPlugin.cancelNotification(e.code),cleverapps.LocalPushes.FacebookSender.cancelPush(e)}},cleverapps.LocalPushes.IosWebViewSender={askPermission:function(){webkitMessage("localPushes",{action:"askPermission"})},sendPush:function(e,t){
var n=cleverapps.LocalPushes.GetPushData(e),s=n.title,i=n.text,o=e.code;i?(webkitMessage("localPushes",{action:"sendPush",title:s,message:i,timeout:t,code:o}),cleverapps.LocalPushes.FacebookSender.sendPush(e,t,n.index)):cleverapps.throwAsync("empty ios push - "+o)},cancelPush:function(e){webkitMessage("localPushes",{action:"cancelPush",code:e.code}),cleverapps.LocalPushes.FacebookSender.cancelPush(e)}},cleverapps.LocalPushes.FacebookSender={askPermission:function(){},sendPush:function(e,t,n){if(!levels.user.haveTmpId()&&!cleverapps.isLocalhost()){var s=e.code,i=levels.user.id,o=cleverapps.User.calcSource();"mobile_mm"!==o&&"web_mm"!==o||(i="mw_"+i),"mobile_ok"!==o&&"web_ok"!==o||(i="ok_"+i),"mobile_vk"!==o&&"web_vk"!==o||(i="vk_"+i);var r="/localpushes/send/"+i+"/"+s,a=cleverapps.LocalPushes.GetPushData(e,n),c={message:a.text,timeout:t};cleverapps.isInstant()&&(c.title=a.title),c.message?(console.log("Sending push - "+s,c),cleverapps.RestClient.post(r,c,function(){console.log(
"Success push - "+s)},function(){console.log("Failure push - "+s)})):cleverapps.throwAsync("empty facebook push - "+s)}},cancelPush:function(e){if(!levels.user.haveTmpId()&&!cleverapps.isLocalhost()){var t=e.code,n="/localpushes/cancel/"+levels.user.id+"/"+t;console.log("Sending cancel push - "+t),cleverapps.RestClient.post(n,{},function(){console.log("Success cancel push - "+t)},function(){console.log("Failure cancel push - "+t)})}}};var NativeInvite={nativeInviteFriends:!0,inviteFriends:function(e,t){this.onInviteFriendsListener=t;var n={title:e.title,message:e.message,link:cleverapps.config.deployment+"/res/applink.html"};if(e.element&&e.element.parent){var s=e.element.parent.convertToWorldSpace(e.element.getPosition()),i=cc.view.getFrameSize();n.element={x:s.x/i.width,y:1-s.y/i.height}}cc.sys.os===cc.sys.OS_ANDROID?MessagesPlugin.sendMessageAllVariants(JSON.stringify(n)):(n.action="sendMessageAllVariants",webkitMessage("messages",n))},onInviteFriends:function(e){
this.onInviteFriendsListener&&(this.onInviteFriendsListener(e),delete this.onInviteFriendsListener)}},NativeReview={isAvailable:function(){return cc.sys.os===cc.sys.OS_ANDROID&&"undefined"!=typeof ReviewPlugin},requestReview:function(e){this.onRequestReviewListener=e,console.log("NativeReview - start"),ReviewPlugin.requestReview()},onRequestReview:function(e){console.log("NativeReview - finish, result - "+e),this.onRequestReviewListener&&(this.onRequestReviewListener(e),delete this.onRequestReviewListener)}};cleverapps.Social=function(){this.onInitializedListeners={},this.initialized=!1},cleverapps.Social.prototype.initialize=function(e){this.init(function(){this.setInitialized(!0),e()}.bind(this))},cleverapps.Social.prototype.init=function(e){e()},cleverapps.Social.prototype.isLoggedIn=function(){},cleverapps.Social.prototype.isInitialized=function(){return!1!==this.initialized},cleverapps.Social.prototype.setInitialized=function(e){if(this.initialized=e,this.initialized){for(
var t in this.onInitializedListeners){(0,this.onInitializedListeners[t])()}this.onInitializedListeners={}}},cleverapps.Social.prototype.whenInitialized=function(e,t){this.isInitialized()?t():this.onInitializedListeners[e]=t},cleverapps.Social.prototype.getLocalStoragePreffix=function(){return""},cleverapps.Social.prototype.getUserID=function(){},cleverapps.Social.prototype.getAccessToken=function(){},cleverapps.Social.prototype.login=function(e,t){},cleverapps.Social.prototype.inviteFriends=function(e,t){},cleverapps.Social.prototype.inviteFriendsShare=function(e,n){var t=cleverapps.ShareBonus.cycleShareData("share");this.shareDialog({description:e.message?e.message:Messages.get("SettingsWindow.InviteFriends.message"),name:e.title?e.title:Messages.get("SettingsWindow.InviteFriends.title"),picture:t.picture,vk:t.vk},function(e,t){e===cleverapps.Social.CODE_SUCCEED&&cleverapps.history.add("share",1),n&&n(e,t)})},cleverapps.Social.prototype.request=function(e,t){},
cleverapps.Social.prototype.shareDialog=function(e,t){},cleverapps.Social.prototype.listFriends=function(e){e(cleverapps.Social.CODE_SUCCEED,[])},cleverapps.Social.prototype.listInvitableFriends=function(e){e(cleverapps.Social.CODE_SUCCEED,[])},cleverapps.Social.prototype.aboutMe=function(e){this.aboutUser("me",e)},cleverapps.Social.prototype.aboutUser=function(e,t,n){},cleverapps.Social.prototype.deleteAllRequests=function(){},cleverapps.Social.prototype.api=function(e,t,n,s){},cleverapps.Social.isAppropriate=function(){},cleverapps.Social.prepareId=function(e){return""+e},cleverapps.Social.prototype.checkConnection=function(e,t,n){if(e=e||function(){},cleverapps.flags.nologin)e();else{if("object"==typeof t&&(n=t,t=function(){}),t=t||function(){},n=n||{},!this.isInitialized())return cleverapps.Notification.create("messages:SocialManager.Initialization"),void t();this.isLoggedIn()?e():cc.sys.isNative||n.withWindow?new FbConnectWindow(e,t,n):this.login(e,t)}},
cleverapps.Social.prototype.sendRequest=function(i,o,r){Array.isArray(i)||(i=[i]),this.checkConnection(function(){this.request({to:i,message:Messages.get(o+".message"),title:Messages.get(o+".title")},function(e){if(e===cleverapps.Social.CODE_SUCCEED){cleverapps.history.add("rqst",i.length),levels.friendSorter.markUsed(i),cleverapps.playSession.inc("viral",i.length);var t=cleverapps.friends.listIds(),n=i.filter(function(e){return-1!==t.indexOf(e)});0<n.length&&cleverapps.eventLogger.logEvent(cleverapps.EVENTS.MESSAGE_SENT_FRIEND,{amount:n.length}),0<i.length-n.length&&cleverapps.eventLogger.logEvent(cleverapps.EVENTS.MESSAGE_SENT_INVITE,{amount:i.length-n.length}),cleverapps.eventLogger.logEvent(cleverapps.EVENTS.MESSAGE_SENT_PREFIX+o,{amount:i.length}),r&&r()}else if(cleverapps.eventLogger.logEvent(cleverapps.EVENTS.MESSAGE_CANCEL_PREFIX+o,{amount:i.length}),-1===cleverapps.Social.CANCEL_CODES.indexOf(e)){var s=cleverapps.EVENTS.MESSAGE_ERROR+"_"+cleverapps.User.calcSource()
;"number"==typeof e&&(s+="_"+e),cleverapps.eventLogger.logEvent(s)}})}.bind(this))},cleverapps.Social.prototype.inviteFriendsWindow=function(n,e){e||(e="SettingsWindow.InviteFriends"),this.checkConnection(function(){cleverapps.history.add("invt",1),this.inviteFriends({message:Messages.get(e+".message"),title:Messages.get(e+".title")},function(e,t){n&&e===cleverapps.Social.CODE_SUCCEED&&n()})}.bind(this))},cleverapps.Social.prototype.inviteRandomFriends=function(t,n){this.checkConnection(function(){var e=levels.friendSorter.listInactiveFriends().map(function(e){return e.id});0<e.length?(e.sort(function(){return Math.random()-.5}),e.length>cleverapps.Social.MAX_INVITE_RANDOM_FRIENDS&&(e=e.slice(0,cleverapps.Social.MAX_INVITE_RANDOM_FRIENDS)),this.sendRequest(e,n,t)):this.inviteFriendsWindow(t,n)}.bind(this))},cleverapps.Social.prototype.requestFullScreen=function(e){e()},cleverapps.Social.prototype.getDefaultLanguages=function(){return[]},cleverapps.Social.prototype.getCodes=function(){
return this.getCode().split("-").sort()},cleverapps.Social.prototype.getCode=function(){return cleverapps.User.calcSource()},cleverapps.Social.CODE_SUCCEED=0,cleverapps.Social.CODE_FAILED=1,cleverapps.Social.CODE_CANCELLED=2,cleverapps.Social.MAX_INVITE_RANDOM_FRIENDS=10,cleverapps.Social.CANCEL_CODES=[cleverapps.Social.CODE_CANCELLED],cleverapps.Social.ACTIVITY={LVL_PASSED:0,DAILY_TASK:1,PASSED_FRIEND:2},cleverapps.Social.ACTIVITIES_CONFIG={},cleverapps.Social.ACTIVITIES_CONFIG[cleverapps.Social.ACTIVITY.LVL_PASSED]={probability:.25,messages:[{title:"messages:Activity.PassLevel.title",body:"messages:Activity.PassLevel.body1"},{title:"messages:Activity.PassLevel.title",body:"messages:Activity.PassLevel.body2"},{title:"messages:Activity.PassLevel.title",body:"messages:Activity.PassLevel.body3"}]},cleverapps.Social.ACTIVITIES_CONFIG[cleverapps.Social.ACTIVITY.DAILY_TASK]={probability:.5,messages:[{title:"messages:Activity.DailyTask.title",body:"messages:Activity.DailyTask.body1"},{
title:"messages:Activity.DailyTask.title",body:"messages:Activity.DailyTask.body2"}]},cleverapps.Social.ACTIVITIES_CONFIG[cleverapps.Social.ACTIVITY.PASSED_FRIEND]={probability:1,messages:[{title:"messages:Activity.BeatFriend.title",body:"messages:Activity.BeatFriend.body1"}]},cleverapps.BaseFB=function(){cleverapps.Social.call(this),cleverapps.Social.CANCEL_CODES.push(cleverapps.BaseFB.FACEBOOK_CANCEL_DIALOG)},cleverapps.BaseFB.prototype=Object.create(cleverapps.Social.prototype),cleverapps.BaseFB.prototype.constructor=cleverapps.BaseFB,cleverapps.BaseFB.prototype.pagingLoading=function(n,s,i,e,o){o||(o=[]),e||(e=""),i||(i=0),i>=cleverapps.BaseFB.MAX_PAGE?s(cleverapps.Social.CODE_SUCCEED,o):this.api(n+"&limit=100"+e,function(e,t){e===cleverapps.Social.CODE_SUCCEED?(t.data&&(o=o.concat(t.data)),t.paging&&t.paging.cursors&&t.paging.next&&t.paging.cursors.after?this.pagingLoading(n,s,i+1,"&after="+t.paging.cursors.after,o):s(cleverapps.Social.CODE_SUCCEED,o)):o.length?s(
cleverapps.Social.CODE_SUCCEED,o):s(e,o)}.bind(this))},cleverapps.BaseFB.prototype.getShareDialogLink=function(e){return cleverapps.config.deployment+cleverapps.config.restApiURL+"/share/?name="+encodeURIComponent(e.name)+"&description="+encodeURIComponent(e.description)+"&picture="+encodeURIComponent(cleverapps.config.deployment+e.picture)},cleverapps.BaseFB.prototype.listFriends=function(e){this.pagingLoading("/me/friends?fields=first_name,id,picture.type(large)",e)},cleverapps.BaseFB.prototype.listInvitableFriends=function(e){e([])},cleverapps.BaseFB.prototype.aboutMe=function(e){this.aboutUser("me",e)},cleverapps.BaseFB.prototype.aboutUser=function(s,i,o){this.api("/"+s+"/?fields=currency,first_name,name,picture.type(large)",function(e,t){if(e===cleverapps.Social.CODE_SUCCEED)i(t);else if(console.log("Error: "+e),console.log(t),o&&o(e,t),0<=cleverapps.BaseFB.USERS_BLACK_LIST_ERROR_CODES.indexOf(e)){t.error_message;var n={code:e,data:t};cleverapps.RestClient.post(
"/users/blacklist/add/"+s,n,function(){console.log("Success add to black list:"+s)},function(){console.log("Failure add to black list:"+s)})}})},cleverapps.BaseFB.prototype.deleteAllRequests=function(){this.api("me/apprequests",function(e,t){if(e===cleverapps.Social.CODE_SUCCEED){if(t.data)for(var n=0;n<t.data.length;n++)console.log("START DELETE REQUEST",t.data[n].id),this.api(t.data[n].id,"delete",function(e,t){console.log("DELETE REQUEST",e,t)})}else console.log("Error: "+e),console.log(t)}.bind(this))},cleverapps.BaseFB.MAX_PAGE=20,cleverapps.BaseFB.USERS_BLACK_LIST_ERROR_CODES=[100],cleverapps.BaseFB.FACEBOOK_CANCEL_DIALOG=4201,cleverapps.BaseFB.PERMISSIONS=["public_profile","user_friends"].join(","),0<=["wordheaps","spades","mergeriddles","mergeheroes","mergecraft"].indexOf(cleverapps.config.name)&&(cleverapps.BaseFB.PERMISSIONS="public_profile"),cleverapps.SelectSocial=function(e){console.log("Choosing Select Social ("+JSON.stringify(Object.keys(e))+")"),this.socials=e,
cleverapps.Social.call(this)},cleverapps.SelectSocial.prototype=Object.create(cleverapps.Social.prototype),cleverapps.SelectSocial.prototype.constructor=cleverapps.SelectSocial,cleverapps.SelectSocial.prototype.onInit=function(e){if(console.log("SelectSocial.onInit - "+this.socialInitializing),this.socialInitializing){var t=this.socials[this.socialInitializing];delete this.socialInitializing,t.onInit.apply(t,arguments)}},cleverapps.SelectSocial.prototype.init=function(n){var t=function(){for(var e in this.socials){var t=this.socials[e];if(t.isLoggedIn()){cleverapps.social=t,console.log("Change social to "+e);break}}n()}.bind(this),s=Object.keys(this.socials),i=function(){if(0!==s.length){var e=this.socialInitializing=s.shift();this.socials[e].initialize(i)}else t()}.bind(this);i()},cleverapps.SelectSocial.prototype.onLogin=function(e){if(this.socialLogining){var t=this.socials[this.socialLogining];e===cleverapps.Social.CODE_SUCCEED&&(cleverapps.social=t,console.log(
"Change social to "+this.socialLogining)),delete this.socialLogining,t.onLogin.apply(t,arguments)}},cleverapps.SelectSocial.prototype.login=function(e,t,n){this.socialLogining=n.source,this.socials[this.socialLogining].login(e,t)},cleverapps.SelectSocial.prototype.getCode=function(){return Object.keys(this.socials).sort().join("-")},cc.sys.isNative&&cleverapps.override(cleverapps.SelectSocial.prototype,NativeInvite);var FriendsCache=function(e){this.data={},this.player=void 0,this.lastUpdateTime=0,this.isInvitable=e,this.load(),this.onFriendsUpdatedListeners=[],this.onUserUpdatedListener=function(){},this.playerInfoChangedListeners={}};FriendsCache.prototype.getStoreKey=function(){return this.isInvitable?cleverapps.DataLoaderTypes.INVITABLE_FRIENDS:cleverapps.DataLoaderTypes.FRIENDS},FriendsCache.prototype.reset=function(){this.data={},this.player=void 0,this.lastUpdateTime=0,this.save()},FriendsCache.prototype.load=function(){var e=cleverapps.DataLoader.load(this.getStoreKey());e&&(
this.data=e.data,this.player=e.player,this.lastUpdateTime=e.when)},FriendsCache.prototype.save=function(){var e={data:this.data,player:this.player,when:this.lastUpdateTime};cleverapps.DataLoader.save(this.getStoreKey(),e)},FriendsCache.prototype.isEmpty=function(){return 0===this.lastUpdateTime||0===this.data.length},FriendsCache.prototype.haveData=function(){return 0!==this.lastUpdateTime},FriendsCache.prototype.addFriendsUpdatedListener=function(e){this.onFriendsUpdatedListeners.push(e)},FriendsCache.prototype.setData=function(e){var t=Object.keys(this.data).length;this.data={},e.forEach(function(e){this.data[e.id]={id:e.id,name:e.first_name,avatar:e.picture&&e.picture.data&&e.picture.data.url}},this);var n=Object.keys(this.data).length;this.lastUpdateTime=Date.now(),this.save(),t<n&&this.onFriendsUpdatedListeners.forEach(function(e){e()})},FriendsCache.prototype.getPlayer=function(){return void 0!==this.player?this.player:FriendsCache.DEFAULT_PLAYER_INFO()},
FriendsCache.prototype.updatePlayerInfo=function(e){var t=this.getPlayer();this.player={id:cleverapps.user.id,self:!0,name:e.first_name,avatar:e.picture&&e.picture.data&&e.picture.data.url},this.save(),t.id===this.player.id&&t.name===this.player.name&&t.avatar===this.player.avatar||(this.onUserUpdatedListener(),cleverapps.values(this.playerInfoChangedListeners).forEach(function(e){e(t.id)}.bind(this)))},FriendsCache.prototype.getById=function(e){return this.data[e]},FriendsCache.prototype.listIds=function(){return Object.keys(this.data)},FriendsCache.prototype.listFriends=function(){return cleverapps.values(this.data)},FriendsCache.prototype.inApp=function(e){return void 0!==this.data[e]},FriendsCache.prototype.reload=function(){cleverapps.social.isLoggedIn()?this.isInvitable?cleverapps.social.listInvitableFriends(function(e,t){void 0!==t&&this.setData(t)}.bind(this)):cleverapps.social.listFriends(function(e,t){void 0!==t&&(this.setData(t),
cleverapps.User.reportAmountFriendsDau&&cleverapps.User.reportAmountFriendsDau())}.bind(this)):cleverapps.User.reportAmountFriendsDau&&cleverapps.User.reportAmountFriendsDau()},FriendsCache.RELOAD_INTERVAL=cleverapps.parseInterval("1 hour"),FriendsCache.DEFAULT_PLAYER_INFO=function(){return{id:cleverapps.user.id,self:!0,name:Messages.get("Friends.You"),avatar:bundles.main.frames.user_avatar}},cleverapps.AndroidSocial=function(){console.log("Choosing Android Social"),cleverapps.Social.call(this),cc.eventManager.addCustomListener(cc.game.EVENT_SHOW,this.refresh.bind(this)),setInterval(this.refresh.bind(this),cleverapps.parseInterval("30 minutes"))},cleverapps.AndroidSocial.prototype=Object.create(cleverapps.Social.prototype),cleverapps.AndroidSocial.prototype.constructor=cleverapps.AndroidSocial,cleverapps.AndroidSocial.prototype.refresh=function(){AndroidSocialPlugin.refresh()},cleverapps.AndroidSocial.prototype.isLoggedIn=function(){return AndroidSocialPlugin.isLoggedIn()},
cleverapps.AndroidSocial.prototype.getUserID=function(){return"android_"+AndroidSocialPlugin.getUserID()},cleverapps.AndroidSocial.prototype.getAccessToken=function(){return AndroidSocialPlugin.getAccessToken()},cleverapps.AndroidSocial.prototype.onLogin=function(e){this.onLoginListener&&(this.onLoginListener(e),delete this.onLoginListener)},cleverapps.AndroidSocial.prototype.login=function(t,n){this.onLoginListener=function(e){e===cleverapps.Social.CODE_SUCCEED?(cleverapps.SocialManager.onLogin(),cleverapps.history.set("fblog",1),t()):(cleverapps.SocialManager.onFailedLogin(),n&&n())},AndroidSocialPlugin.login()},cleverapps.AndroidSocial.prototype.aboutMe=function(e){var t=AndroidSocialPlugin.aboutMe();t=decodeWebViewData(t),(t=JSON.parse(t))&&t.picture&&t.picture.data&&t.picture.data.url&&(t.picture.data.url=decodeWebViewData(t.picture.data.url)),console.log("AndroidSocial.aboutMe - "+JSON.stringify(t)),e(t)},cleverapps.AndroidSocial.prototype.getCode=function(){
return cleverapps.AndroidSocial.CODE},cleverapps.AndroidSocial.isAvailable=function(){return cc.sys.isNative&&"android"===cleverapps.User.calcSource()},cleverapps.override(cleverapps.AndroidSocial.prototype,NativeInvite),cleverapps.AndroidSocial.CODE="androidsocial",cleverapps.AppleSocial=function(){console.log("Choosing Apple Social"),cleverapps.Social.call(this)},cleverapps.AppleSocial.prototype=Object.create(cleverapps.Social.prototype),cleverapps.AppleSocial.prototype.constructor=cleverapps.AppleSocial,cleverapps.AppleSocial.prototype.updateNameFromServer=function(n){var e=function(e){var t=e.name||"";console.log("AppleSocial.updateNameFromServer success - "+t),this.name=t,this.save(),n()}.bind(this),t=function(e){console.log("AppleSocial.updateNameFromServer failure - "+e),n()}.bind(this);console.log("AppleSocial.updateNameFromServer"),cleverapps.RestClient.get("/info/name/"+this.getUserID(),{},e,t)},cleverapps.AppleSocial.prototype.prepareData=function(e,t){e=decodeWebViewData(e)
,e=JSON.parse(e),console.log("AppleSocial.prepareData - "+JSON.stringify(e)),this.id=e.id||"",this.token=e.token||"",e.name&&(this.name=e.name),this.save(),this.id&&!this.name?this.updateNameFromServer(t):t()},cleverapps.AppleSocial.prototype.onInit=function(e){var t=function(){this.onInitCallback&&(console.log("AppleSocial.onInit"),this.onInitCallback(),delete this.onInitCallback)}.bind(this);this.prepareData(e,t)},cleverapps.AppleSocial.prototype.save=function(){cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.APPLE_SOCIAL,{id:this.id,token:this.token,name:this.name})},cleverapps.AppleSocial.prototype.init=function(e){var t=cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.APPLE_SOCIAL);this.onInitCallback=e,webkitMessage("appleSocial",{action:"init",data:t}),console.log("AppleSocial.init - "+JSON.stringify(t))},cleverapps.AppleSocial.prototype.isLoggedIn=function(){return this.getUserID()&&this.getAccessToken()},cleverapps.AppleSocial.prototype.getUserID=function(){if(
this.id)return"apple_"+this.id},cleverapps.AppleSocial.prototype.getAccessToken=function(){return this.token},cleverapps.AppleSocial.prototype.onLogin=function(e,t){var n=function(){this.onLoginListener&&(console.log("AppleSocial.onLogin - "+e),this.onLoginListener(e),delete this.onLoginListener)}.bind(this);this.prepareData(t,n)},cleverapps.AppleSocial.prototype.login=function(t,n){this.onLoginListener=function(e){e===cleverapps.Social.CODE_SUCCEED?(cleverapps.SocialManager.onLogin(),cleverapps.history.set("fblog",1),t()):(cleverapps.SocialManager.onFailedLogin(),n&&n())},webkitMessage("appleSocial",{action:"login"}),console.log("AppleSocial.login")},cleverapps.AppleSocial.prototype.aboutMe=function(e){var t={id:this.getUserID(),first_name:this.name,name:this.name};console.log("AppleSocial.aboutMe - "+JSON.stringify(t)),e(t)},cleverapps.AppleSocial.prototype.getCode=function(){return cleverapps.AppleSocial.CODE},cleverapps.AppleSocial.isAvailable=function(){
return cc.sys.isNative&&cleverapps.webViewData&&cleverapps.webViewData.appleSocialAvailable&&"ios"===cleverapps.User.calcSource()},cleverapps.override(cleverapps.AppleSocial.prototype,NativeInvite),cleverapps.AppleSocial.CODE="applesocial",cleverapps.StartFacebook=function(){plugin.extend("facebook",{name:"",version:"",_userInfo:null,_isLoggedIn:void 0,HttpMethod:{GET:"get",POST:"post",DELETE:"delete"},CODE_SUCCEED:0,AppEvent:{ACTIVATED_APP:FB.AppEvents.EventNames.ACTIVATED_APP,COMPLETED_REGISTRATION:FB.AppEvents.EventNames.COMPLETED_REGISTRATION,VIEWED_CONTENT:FB.AppEvents.EventNames.VIEWED_CONTENT,SEARCHED:FB.AppEvents.EventNames.SEARCHED,RATED:FB.AppEvents.EventNames.RATED,COMPLETED_TUTORIAL:FB.AppEvents.EventNames.COMPLETED_TUTORIAL,ADDED_TO_CART:FB.AppEvents.EventNames.ADDED_TO_CART,ADDED_TO_WISHLIST:FB.AppEvents.EventNames.ADDED_TO_WISHLIST,INITIATED_CHECKOUT:FB.AppEvents.EventNames.INITIATED_CHECKOUT,ADDED_PAYMENT_INFO:FB.AppEvents.EventNames.ADDED_PAYMENT_INFO,
PURCHASED:FB.AppEvents.EventNames.PURCHASED,ACHIEVED_LEVEL:FB.AppEvents.EventNames.ACHIEVED_LEVEL,UNLOCKED_ACHIEVEMENT:FB.AppEvents.EventNames.UNLOCKED_ACHIEVEMENT,SPENT_CREDITS:FB.AppEvents.EventNames.SPENT_CREDITS},AppEventParam:{CURRENCY:FB.AppEvents.ParameterNames.CURRENCY,REGISTRATION_METHOD:FB.AppEvents.ParameterNames.REGISTRATION_METHOD,CONTENT_TYPE:FB.AppEvents.ParameterNames.CONTENT_TYPE,CONTENT_ID:FB.AppEvents.ParameterNames.CONTENT_ID,SEARCH_STRING:FB.AppEvents.ParameterNames.SEARCH_STRING,SUCCESS:FB.AppEvents.ParameterNames.SUCCESS,MAX_RATING_VALUE:FB.AppEvents.ParameterNames.MAX_RATING_VALUE,PAYMENT_INFO_AVAILABLE:FB.AppEvents.ParameterNames.PAYMENT_INFO_AVAILABLE,NUM_ITEMS:FB.AppEvents.ParameterNames.NUM_ITEMS,LEVEL:FB.AppEvents.ParameterNames.LEVEL,DESCRIPTION:FB.AppEvents.ParameterNames.DESCRIPTION},AppEventParamValue:{VALUE_YES:"1",VALUE_NO:"0"},_checkLoginStatus:function(e){var t=this;FB.getLoginStatus(function(e){e&&"connected"===e.status?(t._isLoggedIn=!0,
t._userInfo=e.authResponse):(t._isLoggedIn=!1,t._userInfo={})})},ctor:function(e){this.name="facebook",this.version="1.0",this._userInfo={},this._isLoggedIn=void 0,FB&&(FB.init(e),this._checkLoginStatus(!0),plugin.FacebookAgent=this)},getInstance:function(){return this},login:function(e,n){var t={scope:e,return_scopes:!0};cleverapps.social.loginPopup&&(t.display="popup"),FB.login(function(e){if(e.authResponse){this._isLoggedIn=!0,this._userInfo=e.authResponse;var t=e.authResponse.grantedScopes.split(",");"function"==typeof n&&n(0,{accessToken:e.authResponse.accessToken,permissions:t})}else this._isLoggedIn=!1,this._userInfo={},"function"==typeof n&&n(e.error_code||1,{error_message:e.error_message||"Unknown error"})}.bind(this),t)},isLoggedIn:function(){return this._isLoggedIn},logout:function(t){var n=this;FB.logout(function(e){e.authResponse?(n._isLoggedIn=!1,n._userInfo={},"function"==typeof t&&t(0,{isLoggedIn:!1})):"function"==typeof t&&t(e.error_code||1,{
error_message:e.error_message||"Unknown error"})})},_requestPermissions:function(e,n){var t=e.join(","),s=this;FB.login(function(e){if(e.authResponse){var t=e.authResponse.grantedScopes.split(",");s._isLoggedIn=!0,s._userInfo=e.authResponse,"function"==typeof n&&n(0,{permissions:t})}else s._isLoggedIn=!1,s._userInfo={},"function"==typeof n&&n(e.error_code||1,{error_message:e.error_message||"Unknown error"})},{scope:t,return_scopes:!0})},getAccessToken:function(){return this._userInfo?this._userInfo.accessToken:null},getUserID:function(){return this._userInfo?this._userInfo.userID:null},_share:function(e,t){FB.ui({method:"share",caption:e.caption,href:e.link},function(e){e?e.post_id?"function"==typeof t&&t(0,{didComplete:!0,post_id:e.post_id}):"function"==typeof t&&t(e.error_code||1,{error_message:e.error_message||"Unknown error"}):"function"==typeof t&&t(1,{error_message:"Unknown error"})})},dialog:function(e,t){if(e)if(this.canPresentDialog(e)){e.name=e.name||e.site,delete e.site,
e.href=e.href||e.link||e.siteUrl,delete e.siteUrl,delete e.link,e.picture=e.picture||e.image||e.photo||e.imageUrl||e.imagePath,delete e.imageUrl,delete e.imagePath,delete e.photo,delete e.image,e.caption=e.title||e.caption,delete e.title,e.description=e.text||e.description,delete e.text;var n=e.dialog;if(delete e.dialog,"shareLink"===n||"feedDialog"==n)e.method="share";else if("messageLink"==n)e.method="send",e.link=e.href;else if("shareOpenGraph"==n&&(e.method="share_open_graph",e.url)){var s={};for(var i in e.preview_property_name?s[e.preview_property_name]=e.url:s.object=e.url,e)"method"!=i&&"action_type"!=i&&"action_properties"!=i&&(e[i]&&(s[i]=e[i]),delete e[i]);e.action_properties=JSON.stringify(s)}FB.ui(e,function(e){e&&"function"==typeof t?e.post_id||e.success?t(0,{didComplete:!0,post_id:e.post_id||""}):e.error_code?t(e.error_code,{error_message:e.error_message||"Unknown error"}):t(0,e):null==e&&"function"==typeof t&&t(1,{error_message:"Unknown error"})})
}else"function"==typeof t&&t(1,{error_message:"The requested dialog: "+e.dialog+" can not be presented on Web"});else"function"==typeof t&&t(1,{error_message:"No info parameter provided"})},canPresentDialog:function(e){return!(!e||!e.dialog||"shareLink"!==e.dialog&&"feedDialog"!==e.dialog&&"shareOpenGraph"!==e.dialog&&"messageLink"!==e.dialog)},api:function(e,t,n,s){"function"==typeof n&&(s=n,n={}),FB.api(e,t,n,function(e){e.error?"function"==typeof s&&s(e.error.code,{error_message:e.error.message||"Unknown error"}):"function"==typeof s&&s(0,e)})},_getPermissionList:function(s){FB.api("/me/permissions",function(e){if(e.data){for(var t=[],n=0;n<e.data.length;n++)"granted"==e.data[n].status&&t.push(e.data[n].permission);"function"==typeof s&&s(0,{permissions:t})}else e.error||(e.error={}),"function"==typeof s&&s(e.error.code||1,{error_message:e.error.message||"Unknown error"})})},destroyInstance:function(){},canvas:{pay:function(e,t){var n={method:"pay",action:"purchaseitem",
product:e.product};"subscription"===e.type&&(n.action="create_subscription"),-1!==["cancel_subscription","reactivate_subscription","change_subscription"].indexOf(e.action)&&(n.action=e.action,n.subscription_id=e.subscription_id),FB.ui(n,function(e){e.error_code?t(e.error_code||1,{error_message:e.error_message||e.error_msg||"Unknown error"}):t(0,e)})}},appRequest:function(e,t){e?(e.method="apprequests",FB.ui(e,function(e){e?e.error_code?"function"==typeof t&&t(e.error_code,{error_message:e.error_message||"Unknown error"}):"function"==typeof t&&t(0,e):"function"==typeof t&&t(1,{error_message:"Unknown error"})})):"function"==typeof t&&t(1,{error_message:"No info parameter provided"})},logEvent:function(e,t,n){null!=e&&(void 0===t&&void 0===n?FB.AppEvents.logEvent(e,null,null):"number"==typeof t&&void 0===n?FB.AppEvents.logEvent(e,t):"object"==typeof t&&void 0===n?FB.AppEvents.logEvent(e,null,t):FB.AppEvents.logEvent(e,t,n))},activateApp:function(){FB.AppEvents.activateApp()},
logPurchase:function(e,t,n){FB.AppEvents.logPurchase(e,t,n)}})},cleverapps.VK=function(){this instanceof cleverapps.MobileVk||console.log("Choosing html5-Vk"),cleverapps.Social.MAX_INVITE_RANDOM_FRIENDS=1,cleverapps.Social.call(this),cleverapps.config.debugMode&&this.debugUsers().indexOf(this.getUserID())<0&&(document.body.innerHTML="  ")},cleverapps.VK.prototype=Object.create(cleverapps.Social.prototype),cleverapps.VK.prototype.constructor=cleverapps.VK,cleverapps.VK.prototype.getLocalStoragePreffix=function(){return"_VK"},cleverapps.VK.prototype.debugUsers=function(){return["8593874","519644122","559432346","74852834","120601236","13506358"]},cleverapps.VK.prototype.init=function(e){var t=cleverapps.once(function(){VK.addCallback("onRequestSuccess",function(e){console.log("onRequestSuccess",e),this.listeners.onRequest(cleverapps.Social.CODE_SUCCEED,e)}.bind(this)),VK.addCallback("onRequestCancel",function(e){console.log("onRequestCancel",e),
this.listeners.onRequest(cleverapps.Social.CODE_CANCELLED,e)}.bind(this)),VK.addCallback("onRequestFail",function(e){console.log("onRequestFail",e),this.listeners.onRequest(cleverapps.Social.CODE_FAIL,e)}.bind(this)),e()}.bind(this));this.listeners={onRequest:function(){}};var n=function(e){plugin.FacebookAgent=cleverapps.FakeFacebookAgent,t(),"timeout"===e?cleverapps.eventLogger.logEvent(cleverapps.EVENTS.FAKEFB_BY_TIMEOUT):cleverapps.eventLogger.logEvent(cleverapps.EVENTS.FAKEFB_BY_SCRIPT_ERROR)}.bind(this);cleverapps.loadSdk("//vk.com/js/api/xd_connection.js?2",{onSuccess:function(){VK.init(t,n,cleverapps.VK.API_VERSION)},onFailure:n})},cleverapps.VK.prototype.sendActivity=function(e,t){if(e===cleverapps.Social.ACTIVITY.LVL_PASSED){var n=void 0,s=0,i=levels.user.getHumanReadableNumber();cleverapps.VK.MISSIONS.forEach(function(e){i===e.level&&(n=e.id)}),void 0===n&&(n=1,s=t.levelNo,cleverapps.Random.mathChoose([0,1])&&void 0!==t.score&&(n=2,s=t.score));var o={user_id:this.getUserID(
),activity_id:n,value:s,v:cleverapps.VK.API_VERSION},r=[];for(var a in o)r.push(a+"="+o[a]);cleverapps.RestClient.get("/vkappevents?"+r.join("&"),{})}},cleverapps.VK.prototype.createShortcut=function(){VK.api("account.getAppPermissions",{user_id:this.getUserID()},function(e){console.log("getAppPermissions: "+e.response),0==(256&e.response)&&FullscreenControlButton.exitFullscreen(function(){VK.callMethod("showSettingsBox",256)})})},cleverapps.VK.prototype.isLoggedIn=function(){return!0},cleverapps.VK.prototype.getUserID=function(){return cleverapps.getRequestParameters().viewer_id},cleverapps.VK.prototype.getAccessToken=function(){return"VK_"+cleverapps.getRequestParameters().auth_key},cleverapps.VK.prototype.login=function(e){e()},cleverapps.VK.prototype.inviteFriends=function(e,t){FullscreenControlButton.exitFullscreen(function(){VK.callMethod("showInviteBox"),t(cleverapps.Social.CODE_SUCCEED)})},cleverapps.VK.prototype.requestToOne=function(e,t,n){this.listeners.onRequest=n,
FullscreenControlButton.exitFullscreen(function(){VK.callMethod("showRequestBox",parseInt(e),t.message)})},cleverapps.VK.prototype.request=function(e,n){var s=e.to;Array.isArray(s)||(s=[s]);var i=[],o=function(t){t===s.length?n(i.length>Math.floor(s.length/2)?cleverapps.Social.CODE_SUCCEED:cleverapps.Social.CODE_CANCELLED,i):this.requestToOne(s[t],e,function(e){cleverapps.config.debugMode&&cleverapps.ReportStream.debug("requestToOne - "+JSON.stringify(arguments)),e===cleverapps.Social.CODE_SUCCEED&&i.push(s[t]),o(t+1)})}.bind(this);o(0)},cleverapps.VK.prototype.shareDialog=function(e,t){if(!e.vk)throw"No vk data to share!";FullscreenControlButton.exitFullscreen(function(){VK.api("wall.post",{message:e.description+"\n"+cleverapps.config.vk.url,attachments:[e.vk,"https://vk.com/app"+cleverapps.config.vk.appId].join(",")},function(e){e.error?t(cleverapps.Social.CODE_CANCELLED,e.error):t(cleverapps.Social.CODE_SUCCEED)})})},cleverapps.VK.prototype.processPromo=function(t){
cleverapps.eventLogger.logEvent("vk_promo_check"),VK.api("apps.promoHasActiveGift",{promo_id:t},function(e){if(cleverapps.eventLogger.logEvent("vk_promo_response"),e&&1===e.response){if(this.givePromoReward(),-1!==["4252816","74852834","559432346","9938687","4615499"].indexOf(cleverapps.user.id))return;VK.api("apps.promoUseGift",{promo_id:t})}}.bind(this))},cleverapps.VK.prototype.isPromoAvailable=function(e,t,n){return this.isInitialized()&&-1!==n.indexOf(cleverapps.config.name)&&(null===e||Date.now()>new Date(e).getTime())&&(null===t||Date.now()<new Date(t).getTime())},cleverapps.VK.prototype.givePromoReward=function(){cleverapps.metha.displayWhenFreeFocus({focus:"VKPromoRewardWindow",action:function(e){new RewardWindow({reward:cleverapps.VK.PROMO_REWARD,rewardName:"vkpromo"}),cleverapps.metha.onceNoWindowsListener=e}}),cleverapps.eventLogger.logEvent("vk_promo_reward")},cleverapps.VK.prototype.listFriendsByApp=function(n,s){VK.api("friends.getAppUsers",{},function(e){if(e.error)s(
cleverapps.Social.CODE_FAILED,[]);else if(e.response){var t=e.response.map(cleverapps.VK.prepareId);VK.api("friends.get",{extended:1,count:1e3,fields:"photo_200"},function(e){e.error?s(cleverapps.Social.CODE_FAILED,[]):s(cleverapps.Social.CODE_SUCCEED,this.prepareFriendsData(e.response&&e.response.items,t,n))}.bind(this))}else s(cleverapps.Social.CODE_FAILED,[])}.bind(this))},cleverapps.VK.prototype.prepareFriendsData=function(e,t,n){return(e||[]).filter(function(e){return void 0===e.deactivated}).map(cleverapps.VK.formatUserData).filter(function(e){return n===(-1!==t.indexOf(e.id))})},cleverapps.VK.prototype.listFriends=function(e){this.listFriendsByApp(!0,e)},cleverapps.VK.prototype.listInvitableFriends=function(e){this.listFriendsByApp(!1,e)},cleverapps.VK.prepareId=function(e){return""+e},cleverapps.VK.formatUserData=function(e){return{id:cleverapps.VK.prepareId(e.id),name:e.first_name+" "+e.last_name,first_name:e.first_name,picture:{data:{url:e.photo_200&&-1===e.photo_200.indexOf(
"camera_200.png")?e.photo_200:void 0}}}},cleverapps.VK.prototype.aboutMe=function(n){VK.api("users.get",{fields:"photo_200"},function(e){if(e&&e.response){var t=e.response[0];n(cleverapps.VK.formatUserData(t))}else console.log("Error: "+JSON.stringify(e))})},cleverapps.VK.prototype.logEvent=function(e,t){},cleverapps.VK.prototype.getDefaultLanguages=function(){return[cc.sys.LANGUAGE_RUSSIAN]},cleverapps.VK.isAppropriate=function(){return!cc.sys.isNative&&"web_vk"===cleverapps.User.calcSource()},cleverapps.VK.PROMO_REWARD={gold:50},"match3"===cleverapps.config.type&&cleverapps.config.results?cleverapps.VK.PROMO_REWARD={unlimitedLives:"12 hours",stars:10}:"match3"===cleverapps.config.type?cleverapps.VK.PROMO_REWARD={unlimitedLives:"12 hours",gold:20}:"stacks"===cleverapps.config.subtype&&(cleverapps.VK.PROMO_REWARD={gold:100}),cleverapps.VK.DEFAULT_HEIGHT=720,cleverapps.VK.DEFAULT_WIDTH=800,cleverapps.VK.MIN_HEIGHT=480,cleverapps.VK.SCREEN_HEIGHT_RESERVED=230,
cleverapps.VK.API_VERSION="5.107",cleverapps.VK.MISSIONS=[{id:3,level:1},{id:4,level:2},{id:5,level:3},{id:6,level:4},{id:7,level:5},{id:8,level:6},{id:9,level:10},{id:10,level:20},{id:11,level:50},{id:12,level:100},{id:13,level:150},{id:14,level:200},{id:15,level:300},{id:16,level:500},{id:17,level:750},{id:18,level:1e3},{id:19,level:1500},{id:20,level:2e3}],cleverapps.MobileVk=function(){console.log("Choosing html5-VkConnect"),cc.sys.openURL=function(e){var t=document.createElement("a");t.setAttribute("target","_blank"),t.setAttribute("href",e),t.click()},cleverapps.VK.call(this)},cleverapps.MobileVk.prototype=Object.create(cleverapps.VK.prototype),cleverapps.MobileVk.prototype.constructor=cleverapps.MobileVk,cleverapps.MobileVk.getPlatfrom=function(){return cleverapps.getRequestParameters().platform},cleverapps.MobileVk.prototype.init=function(t){"4252816"===cleverapps.user.id&&cleverapps.ReportStream.debug(window.location.href);var n=function(e){
plugin.FacebookAgent=cleverapps.FakeFacebookAgent,"vkConnect"===e&&cleverapps.eventLogger.logEvent(cleverapps.EVENTS.FAKEFB_BY_SCRIPT_ERROR),t()},s=function(){var e=function(e,t){e===cleverapps.Social.CODE_SUCCEED&&(this.accessToken=t.access_token,this.scope=t.scope)}.bind(this);this.subscribe("VKWebAppAccessTokenReceived","VKWebAppAccessTokenFailed",e),vkConnect.send("VKWebAppGetAuthToken",{app_id:parseInt(cleverapps.config.vk.appId),scope:"friends"})}.bind(this),e=function(){vkConnect.isWebView()&&this.subscribe("VKWebAppInitResult","VKWebAppInitFailed",function(e){e===cleverapps.Social.CODE_SUCCEED?(t(),s()):n()}.bind(this)),vkConnect.send("VKWebAppInit",{}),vkConnect.isWebView()||(t(),s())}.bind(this);cleverapps.loadSdk(cleverapps.config.staticUrl+"cleverapps/res/vk-connect.js",{onSuccess:e,onFailure:function(){n("vkConnect")}})},cleverapps.MobileVk.prototype.createShortcut=function(){},cleverapps.MobileVk.prototype.aboutMe=function(n){this.subscribe("VKWebAppGetUserInfoResult",
"VKWebAppGetUserInfoFailed",function(e,t){e===cleverapps.Social.CODE_SUCCEED&&n(cleverapps.VK.formatUserData(t))}),vkConnect.send("VKWebAppGetUserInfo",{})},cleverapps.MobileVk.prototype.subscribe=function(t,n,s){var i=function(e){cleverapps.config.debugMode&&cleverapps.RestClient.post("/applogs/"+cleverapps.user.id,{event:JSON.stringify(e),type:e.detail.type,error_type:e.detail.data.error_type,error_code:e.detail.data.error_data&&e.detail.data.error_data.error_code,error_reason:e.detail.data.error_data&&e.detail.data.error_data.error_reason,detailData:e.detail.data?JSON.stringify(e.detail.data):"none",accessToken:this.accessToken,scope:this.scope}),e.detail.type===t&&(s(cleverapps.Social.CODE_SUCCEED,e.detail.data),vkConnect.unsubscribe(i)),e.detail.type===n&&(s(cleverapps.Social.CODE_FAILED,e.detail.data),vkConnect.unsubscribe(i))}.bind(this);vkConnect.subscribe(i)},cleverapps.MobileVk.prototype.showLeaderBoardBox=function(e,t){this.subscribe("VKWebAppShowLeaderBoardBoxResult",
"VKWebAppShowLeaderBoardBoxFailed",t),vkConnect.send("VKWebAppShowLeaderBoardBox",{user_result:e.userResult})},cleverapps.MobileVk.prototype.showOrderBox=function(e,t){this.subscribe("VKWebAppShowOrderBoxResult","VKWebAppShowOrderBoxFailed",t),vkConnect.send("VKWebAppShowOrderBox",{type:e.type,item:e.item})},cleverapps.MobileVk.prototype.inviteFriends=function(e,t){this.subscribe("VKWebAppShowInviteBoxResult","VKWebAppShowInviteBoxFailed",t),vkConnect.send("VKWebAppShowInviteBox",{})},cleverapps.MobileVk.prototype.requestToOne=function(e,t,n){(function(){this.subscribe("VKWebAppShowRequestBoxResult","VKWebAppShowRequestBoxFailed",n),cleverapps.config.debugMode&&cleverapps.RestClient.post("/applogs/"+cleverapps.user.id,{method:"VKWebAppShowRequestBox",uid:parseInt(e),message:t.message}),vkConnect.send("VKWebAppShowRequestBox",{uid:parseInt(e),message:t.message,requestKey:"key"})}).bind(this)()},cleverapps.MobileVk.prototype.shareDialog=function(e,t){if(!e.vk)throw"No vk data to share!"
;this.subscribe("VKWebAppShowWallPostBoxResult","VKWebAppShowWallPostBoxFailed",t),vkConnect.send("VKWebAppShowWallPostBox",{message:e.description+"\n"+cleverapps.config.vk.url,attachments:e.vk+",https://vk.com/app"+cleverapps.config.vk.appId})},cleverapps.MobileVk.prototype.listInvitableFriends=function(e){e(cleverapps.Social.CODE_SUCCEED,[])},cleverapps.MobileVk.prototype.listFriendsByApp=function(i,o){var e=function(e,t){if(e===cleverapps.Social.CODE_SUCCEED)if(t&&t.response&&t.response.map){var n=t.response.map(cleverapps.VK.prepareId),s=function(e,t){e===cleverapps.Social.CODE_SUCCEED?o(cleverapps.Social.CODE_SUCCEED,this.prepareFriendsData(t.response&&t.response.items,n,i)):o(cleverapps.Social.CODE_FAILED,[])}.bind(this);this.subscribe("VKWebAppCallAPIMethodResult","VKWebAppCallAPIMethodFailed",s),vkConnect.send("VKWebAppCallAPIMethod",{method:"friends.get",params:{v:cleverapps.MobileVk.API_VERSION,access_token:this.accessToken,count:1e3,fields:"photo_200"}})}else o(
cleverapps.Social.CODE_FAILED,[]);else o(cleverapps.Social.CODE_FAILED,[])}.bind(this);this.subscribe("VKWebAppCallAPIMethodResult","VKWebAppCallAPIMethodFailed",e),vkConnect.send("VKWebAppCallAPIMethod",{method:"friends.getAppUsers",params:{v:cleverapps.MobileVk.API_VERSION,access_token:this.accessToken}})},cleverapps.MobileVk.prototype.processPromo=function(n){cleverapps.eventLogger.logEvent("vk_promo_check");var e=function(e,t){e===cleverapps.Social.CODE_SUCCEED&&(cleverapps.eventLogger.logEvent("vk_promo_response"),t&&1===t.response&&(this.givePromoReward(),vkConnect.send("VKWebAppCallAPIMethod",{method:"apps.promoUseGift",params:{v:cleverapps.MobileVk.API_VERSION,access_token:this.accessToken,promo_id:n}})))}.bind(this);this.subscribe("VKWebAppCallAPIMethodResult","VKWebAppCallAPIMethodFailed",e),vkConnect.send("VKWebAppCallAPIMethod",{method:"apps.promoHasActiveGift",params:{v:cleverapps.MobileVk.API_VERSION,access_token:this.accessToken,promo_id:n}})},
cleverapps.MobileVk.isAppropriate=function(){return!cc.sys.isNative&&"mobile_vk"===cleverapps.User.calcSource()},cleverapps.MobileVk.API_VERSION="5.107",cleverapps.OK=function(){this instanceof cleverapps.MobileOK||console.log("Choosing html5-ok"),cleverapps.Social.call(this)},cleverapps.OK.prototype=Object.create(cleverapps.Social.prototype),cleverapps.OK.prototype.constructor=cleverapps.OK,cleverapps.OK.prototype.getLocalStoragePreffix=function(){return"_OK"},cleverapps.OK.prototype.updateSize=function(){this.listeners.getPageInfo=function(e,t){var n;try{n=JSON.parse(t).innerHeight}catch(e){n=window&&window.innerHeight||document&&document.body&&document.body.clientHeight||800}var s=n-75;s<600&&(s=600),FAPI.UI.setWindowSize(760,s),cc.view.setFrameSize(cc.view.getFrameSize().width,s)}.bind(this),[0,5,10,20,60].forEach(function(e){setTimeout(FAPI.UI.getPageInfo,1e3*e)})},cleverapps.OK.prototype.init=function(e){var t=cleverapps.once(function(){window.API_callback=function(e,t,n){if(
console.log("Received "+e,t,n),this.listeners[e]){var s=this.listeners[e];this.listeners[e]=void 0,s.call(this,t,n)}}.bind(this),this.updateSize(),e()}.bind(this));this.listeners={};var n=function(e){"undefined"==typeof FAPI&&(FAPI=cleverapps.FakeFAPI),t(),"timeout"===e?cleverapps.eventLogger.logEvent(cleverapps.EVENTS.FAKEFB_BY_TIMEOUT):cleverapps.eventLogger.logEvent(cleverapps.EVENTS.FAKEFB_BY_SCRIPT_ERROR)}.bind(this);cleverapps.loadSdk("//api.ok.ru/js/fapi5.js",{onSuccess:function(){var e=FAPI.Util.getRequestParameters();FAPI.init(e.api_server,e.apiconnection,t,n)},onFailure:n})},cleverapps.OK.prototype.isLoggedIn=function(){return FAPI!==cleverapps.FakeFAPI},cleverapps.OK.prototype.setStatus=function(e,i){console.log("setStatus",e,i),FAPI.Client.call({method:"sdk.setStatus",event:e,status:i},function(e,t,n){console.log("sdk.setStatus response",JSON.stringify(arguments));var s="set_status_"+i+"_ok";e!==cleverapps.OK.CODE_SUCCEED&&(cleverapps.ReportStream.debug(
"sdk.setStatus '"+i+"'error: "+JSON.stringify(n)),s="set_status_"+i+"_error"),cleverapps.eventLogger.logEvent(s)})},cleverapps.OK.prototype.getUserID=function(){return FAPI.Util.getRequestParameters().logged_user_id},cleverapps.OK.prototype.getAccessToken=function(){return"OK_"+FAPI.Util.getRequestParameters().session_key+"_"+FAPI.Util.getRequestParameters().auth_sig},cleverapps.OK.prototype.login=function(e){e()},cleverapps.OK.prototype.inviteFriends=function(e,n){this.listeners.showInvite=function(e,t){"noUsers"===t&&cleverapps.Notification.create("messages:inviteFriends.noUsers"),e===cleverapps.OK.CODE_SUCCEED?n(cleverapps.Social.CODE_SUCCEED):n(cleverapps.Social.CODE_CANCELLED,t)},FullscreenControlButton.exitFullscreen(function(){FAPI.UI.showInvite(e.message)})},cleverapps.OK.prototype.request=function(e,n){"object"==typeof e.to&&(e.to=e.to.join(";")),this.listeners.showNotification=function(e,t){"error"!==e||"noUsers"!==t?e===cleverapps.OK.CODE_SUCCEED?(t=t.split(","),n(
cleverapps.Social.CODE_SUCCEED,t)):n(cleverapps.Social.CODE_CANCELLED,t):n(cleverapps.Social.CODE_SUCCEED,[])},FullscreenControlButton.exitFullscreen(function(){FAPI.UI.showNotification(e.message,"",e.to)})},cleverapps.OK.prototype.shareDialog=function(e,n){var t=cleverapps.config.deployment+e.picture;0<=t.indexOf("?")&&(t=t.substr(0,t.indexOf("?")));var s=[{type:"app",text:e.description,images:[{url:t,title:e.name}],actions:[{text:e.name,mark:e.name}]}];this.listeners.postMediatopic=function(e,t){e===cleverapps.OK.CODE_SUCCEED?n(cleverapps.Social.CODE_SUCCEED):n(cleverapps.Social.CODE_CANCELLED,t)},FullscreenControlButton.exitFullscreen(function(){FAPI.UI.postMediatopic({media:s},!0)})},cleverapps.OK.prototype.loadFriendsPerPage=function(e,t){e=e.slice(0,1e3);for(var n=[],s=0;s<e.length;s+=100)n.push(e.slice(s,s+100));var i=n.length,o=[],r=function(e){e!==cleverapps.Social.CODE_CANCELLED&&(o=o.concat(e)),0===--i&&t(cleverapps.Social.CODE_SUCCEED,o)};n.forEach(function(e){
this.aboutUser(e,r,r)}.bind(this))},cleverapps.OK.prototype.listFriends=function(i){FAPI.Client.call({method:"friends.getAppUsers"},function(e,t,n){if(e!==cleverapps.OK.CODE_SUCCEED)return console.log("list friends error: "+n),void i(cleverapps.Social.CODE_CANCELLED);var s=t.uids;cleverapps.social.loadFriendsPerPage(s,i)})},cleverapps.OK.prototype.listInvitableFriends=function(o){FAPI.Client.call({method:"friends.get",sort_type:"PRESENT"},function(e,t,n){if(e!==cleverapps.OK.CODE_SUCCEED)return console.log("list ivitable friends error: "+n),void o(cleverapps.Social.CODE_CANCELLED);var i=t;FAPI.Client.call({method:"friends.getAppUsers"},function(e,t,n){if(e!==cleverapps.OK.CODE_SUCCEED)return console.log("list friends error: "+n),void o(cleverapps.Social.CODE_CANCELLED);var s=t.uids;cleverapps.social.loadFriendsPerPage(cleverapps.substract(i,s),o)})})},cleverapps.OK.formatUserData=function(e){return-1!==e.pic128x128.indexOf("stub_128x128.gif")&&(e.pic128x128=""),
-1!==e.pic128x128.indexOf("stub/user")&&(e.pic128x128=""),{id:e.uid,name:e.first_name+" "+e.last_name,first_name:e.first_name,picture:{data:{url:e.pic128x128}}}},cleverapps.OK.prototype.aboutUser=function(e,i,o){var r=!Array.isArray(e);r||(e=e.join(",")),FAPI.Client.call({uids:e,fields:"first_name,last_name,uid,pic128x128",method:"users.getInfo"},function(e,t,n){if(e===cleverapps.OK.CODE_SUCCEED){var s=t.map(function(e){return cleverapps.OK.formatUserData(e)});i(r?s[0]:s)}else o&&o(cleverapps.Social.CODE_CANCELLED,n)})},cleverapps.OK.prototype.aboutMe=function(e){this.aboutUser(this.getUserID(),e)},cleverapps.OK.prototype.logEvent=function(e,t){},cleverapps.OK.prototype.getDefaultLanguages=function(){return[cc.sys.LANGUAGE_RUSSIAN]},cleverapps.OK.isAppropriate=function(){return!cc.sys.isNative&&"web_ok"===cleverapps.User.calcSource()},cleverapps.OK.CODE_SUCCEED="ok",cleverapps.FakeFAPI={UI:{getPageInfo:function(){},showInvite:function(){},showNotification:function(){},
postMediatopic:function(){},setWindowSize:function(){},showPayment:function(){}},invokeUIMethod:function(){},Util:{getRequestParameters:function(){return{}}},Client:{call:function(){}}},cleverapps.MobileOK=function(){console.log("Choosing mobile-ok"),cleverapps.OK.call(this),this.isFullScreen=!1,cc.eventManager.addCustomListener(cc.game.EVENT_HIDE,function(){this.isFullScreen=!1}.bind(this)),this.isInApp()&&(cleverapps.Promotion.prototype.isReady=function(){return!1})},cleverapps.MobileOK.prototype=Object.create(cleverapps.OK.prototype),cleverapps.MobileOK.prototype.constructor=cleverapps.MobileOK,cleverapps.MobileOK.prototype.updateSize=function(){},cleverapps.MobileOK.prototype.createShortcut=function(){"undefined"!=typeof OKApp&&"function"==typeof OKApp.suggestDesktopIcon&&OKApp.suggestDesktopIcon()},cleverapps.MobileOK.prototype.isInApp=function(){var e=window&&window.navigator&&window.navigator.userAgent;return!!(e&&0<=e.indexOf("OkApp"))},
cleverapps.MobileOK.isAppropriate=function(){return!cc.sys.isNative&&"mobile_ok"===cleverapps.User.calcSource()},cleverapps.MobileOK.prototype.isFullScreenAvailable=function(){return this.isInitialized()&&!this.isInApp()&&cc.sys.os===cc.sys.OS_ANDROID},cleverapps.MobileOK.prototype.requestFullScreen=function(n){n=n||function(){},this.isFullScreenAvailable()&&!this.isFullScreen?(this.listeners.requestFullscreen=cleverapps.once(function(e,t){"ok"===e?cleverapps.whenResolutionStable(function(){n(),this.isFullScreen=!0}.bind(this)):n()}.bind(this)),FAPI.invokeUIMethod("requestFullscreen")):n()},cleverapps.MyMailRu=function(){this instanceof cleverapps.MobileMyMailRu||console.log("Choosing html5-MyMailRu"),cleverapps.UI.SOCIAL_CLICK_THROTTLE=3e3,cleverapps.Social.call(this)},cleverapps.MyMailRu.prototype=Object.create(cleverapps.Social.prototype),cleverapps.MyMailRu.prototype.constructor=cleverapps.MyMailRu,cleverapps.MyMailRu.prototype.getLocalStoragePreffix=function(){return"_MM"},
cleverapps.MyMailRu.prototype.init=function(t){this.listeners={friendsInvitation:function(){},friendsRequest:function(){},streamPublish:function(){}};var n=cleverapps.once(function(){if(this instanceof cleverapps.MobileMyMailRu)this.createHeaderAndFooter(t);else{if("undefined"!=typeof window&&window.outerHeight&&window.innerHeight){var e=window.outerHeight-250;mailru.app.utils.setHeight(e),cc.view.setFrameSize(window.innerWidth,e)}mailru.events.listen(mailru.app.events.friendsInvitation,function(e){this.listeners.friendsInvitation(e)}.bind(this)),mailru.events.listen(mailru.app.events.friendsRequest,function(e){this.listeners.friendsRequest(e)}.bind(this)),mailru.events.listen(mailru.common.events.streamPublish,function(e){this.listeners.streamPublish(e)}.bind(this)),mailru.events.listen(mailru.app.events.readHash,function(e){e&&e.channel&&levels.user.setChannel(e.channel)}),mailru.app.utils.hash.read(),setTimeout(t,300)}}.bind(this)),e=function(e){"undefined"==typeof mailru&&(
mailru=cleverapps.FakeMailRU),n(),"timeout"===e?cleverapps.eventLogger.logEvent(cleverapps.EVENTS.FAKEFB_BY_TIMEOUT):cleverapps.eventLogger.logEvent(cleverapps.EVENTS.FAKEFB_BY_SCRIPT_ERROR)}.bind(this);cleverapps.loadSdk("//connect.mail.ru/js/loader.js",{onSuccess:function(){mailru.loader.require("api",function(){mailru.app.init(cleverapps.config.myMailRu.privateKey),n()})},onFailure:e})},cleverapps.MyMailRu.prototype.getRequestParameters=function(){var e={},t=window.location.search;if(t)for(var n=(t=t.substr(1)).split("&"),s=0;s<n.length;s++){var i=n[s].split("="),o=i[0],r=i[1];r=decodeURIComponent(r.replace(/\+/g," ")),e[o]=r}return e},cleverapps.MyMailRu.prototype.isLoggedIn=function(){return!0},cleverapps.MyMailRu.prototype.getUserID=function(){return this.getRequestParameters().vid},cleverapps.MyMailRu.prototype.getAccessToken=function(){var e=[],t=this.getRequestParameters();for(var n in t)"sig"!==n&&e.push(n);e.sort();for(var s="",i=0;i<e.length;i++)s+=e[i]+"="+t[e[i]]
;return"MM_"+t.sig+"_"+s},cleverapps.MyMailRu.prototype.login=function(e){e()},cleverapps.MyMailRu.prototype.inviteFriends=function(e,t){this.listeners.friendsInvitation=function(e){"opened"!==e.status&&t(e.data&&e.data.length?cleverapps.Social.CODE_SUCCEED:cleverapps.Social.CODE_CANCELLED)},FullscreenControlButton.exitFullscreen(function(){mailru.app.friends.invite({text:e.message})})},cleverapps.MyMailRu.prototype.request=function(e,t){this.listeners.friendsRequest=function(e){"opened"!==e.status&&(e.data&&e.data.length?t(cleverapps.Social.CODE_SUCCEED,e.data):t(cleverapps.Social.CODE_CANCELLED))},FullscreenControlButton.exitFullscreen(function(){mailru.app.friends.request({text:e.message,image_url:cleverapps.config.deployment+cleverapps.ShareBonus.cycleShareData("share").picture,friends:e.to})})},cleverapps.MyMailRu.prototype.shareDialog=function(e,t){this.listeners.streamPublish=function(e){"opened"!==e.status&&("publishSuccess"===e.status?t(cleverapps.Social.CODE_SUCCEED):(
console.log(e.status),t(cleverapps.Social.CODE_CANCELLED)))};var n={title:e.name,text:e.description,img_url:cleverapps.config.deployment+e.picture};FullscreenControlButton.exitFullscreen(function(){mailru.common.stream.post(n)})},cleverapps.MyMailRu.prototype.listFriends=function(s){mailru.common.friends.getAppUsers(function(e){for(var t=[],n=0;n<e.length;n++)t.push(cleverapps.MyMailRu.formatUserData(e[n]));s(cleverapps.Social.CODE_SUCCEED,t)},!0)},cleverapps.MyMailRu.prototype.listInvitableFriends=function(s){mailru.common.friends.getExtended(function(e){for(var t=[],n=0;n<e.length;n++)e[n].app_installed||t.push(cleverapps.MyMailRu.formatUserData(e[n]));s(cleverapps.Social.CODE_SUCCEED,t)})},cleverapps.MyMailRu.formatUserData=function(e){return{id:e.uid,name:e.first_name+" "+e.last_name,first_name:e.first_name,picture:{data:{url:e.pic_128}}}},cleverapps.MyMailRu.prototype.aboutUser=function(e,n,s){var i=!Array.isArray(e);mailru.common.users.getInfo(function(e){if(e.error)s&&s(
cleverapps.Social.CODE_FAILED,e.error);else{e&&"function"==typeof e.map||cleverapps.ReportStream.debug("MailRU aboutUser response - "+JSON.stringify(e));var t=e.map(function(e){return cleverapps.MyMailRu.formatUserData(e)});n(i?t[0]:t)}},e)},cleverapps.MyMailRu.prototype.aboutMe=function(e){this.aboutUser(this.getUserID(),e)},cleverapps.MyMailRu.prototype.logEvent=function(e,t){},cleverapps.MyMailRu.prototype.getDefaultLanguages=function(){return[cc.sys.LANGUAGE_RUSSIAN]},cleverapps.MyMailRu.isAppropriate=function(){return!cc.sys.isNative&&"web_mm"===cleverapps.User.calcSource()},cleverapps.FakeMailRU={events:{listen:function(){}},app:{friends:{invite:function(){},request:function(){}},utils:{setHeight:function(){},hash:{read:function(){}}},events:{},init:function(){}},common:{stream:{post:function(){}},friends:{getAppUsers:function(){},getExtended:function(){}},users:{getInfo:function(){}},events:{}},loader:{require:function(){}}},cleverapps.MobileMyMailRu=function(){console.log(
"Choosing mobile-MyMailRu"),cleverapps.MyMailRu.call(this)},cleverapps.MobileMyMailRu.prototype=Object.create(cleverapps.MyMailRu.prototype),cleverapps.MobileMyMailRu.prototype.constructor=cleverapps.MobileMyMailRu,cleverapps.MobileMyMailRu.prototype.createHeaderAndFooter=function(s){var e=this.getRequestParameters();mailru.callhf=function(e){var t=document.createElement("div");t.innerHTML=e.header,document.body.insertBefore(t,document.body.firstChild);var n=document.createElement("div");n.style.position="absolute",n.style.top=window.innerHeight-27+"px",n.style.left="0px",n.style.height="27px",n.style.width="100%",n.style.zIndex="-1",n.innerHTML=e.footer,document.body.appendChild(n),cleverapps.canvasTop="43px",cleverapps.decCanvasHeight=70,cleverapps.setupDesignResolution(),s()};var t={method:"mobile.getCanvas",app_id:e.app_id,cb:"mailru.callhf",session_key:e.session_key,mobile_spec:e.mobile_spec};t=mailru.utils.sign(t),mailru.utils.apiOverJSONP(t,"https://appsmail.ru/platform/api")},
cleverapps.MobileMyMailRu.prototype.inviteFriends=function(e,t){cleverapps.Notification.create("messages:mobileNotAvailable"),t(cleverapps.Social.CODE_CANCELLED)},cleverapps.MobileMyMailRu.prototype.request=function(e,t){cleverapps.Notification.create("messages:mobileNotAvailable"),t(cleverapps.Social.CODE_CANCELLED)},cleverapps.MobileMyMailRu.prototype.shareDialog=function(e,t){cleverapps.Notification.create("messages:mobileNotAvailable"),t(cleverapps.Social.CODE_CANCELLED)},cleverapps.MobileMyMailRu.isAppropriate=function(){return!cc.sys.isNative&&"mobile_mm"===cleverapps.User.calcSource()},cleverapps.Mobage=function(){this instanceof cleverapps.SPMobage||console.log("Choosing html5-mobage"),cleverapps.Social.call(this),this.increaseViralBonuses()},cleverapps.Mobage.prototype=Object.create(cleverapps.Social.prototype),cleverapps.Mobage.prototype.constructor=cleverapps.Mobage,cleverapps.Mobage.prototype.increaseViralBonuses=function(){HelpFromFriendsWindow.TYPES.addmoves.amount=5,
BountyManager.PRIZES.forEach(function(e){e.amount*=2})},cleverapps.Mobage.prototype.getLocalStoragePreffix=function(){return"_mbga"},cleverapps.Mobage.HEIGHT=860,cleverapps.Mobage.prototype.init=function(s){cleverapps.once(function(){gadgets.window.adjustHeight(cleverapps.Mobage.HEIGHT);var e=opensocial.newDataRequest();e.add(e.newFetchPersonRequest(opensocial.IdSpec.PersonId.VIEWER),"viewer"),e.send(function(e){if(e.hadError());else{var t=e.get("viewer");if(t.hadError());else{var n=t.getData();this.user=cleverapps.Mobage.formatUserData(n),console.log(this.user),s()}}}.bind(this))}.bind(this))()},cleverapps.Mobage.prototype.isLoggedIn=function(){return!0},cleverapps.Mobage.prototype.getUserID=function(){return this.user.id},cleverapps.Mobage.prototype.getAccessToken=function(){return"mbga"},cleverapps.Mobage.prototype.login=function(e){e()},cleverapps.Mobage.prototype.sendActivity=function(e,t){var n=cleverapps.Social.ACTIVITIES_CONFIG[e];if(n.probability>Math.random()){
var s=cleverapps.Random.mathChoose(n.messages),i={};i[opensocial.Activity.Field.TITLE]=Messages.get(s.title),i[opensocial.Activity.Field.BODY]=Messages.get(s.body,t);var o=opensocial.newActivity(i);opensocial.requestCreateActivity(o,opensocial.CreateActivityPriority.LOW,function(e){e.hadError()})}},cleverapps.Mobage.prototype.inviteFriends=function(e,t){var n={};n[opensocial.Message.Field.TITLE]=e.title;var s=opensocial.newMessage(e.message,n);FullscreenControlButton.exitFullscreen(function(){opensocial.requestShareApp("VIEWER_FRIENDS",s,function(e){e.hadError()?t(cleverapps.Social.CODE_CANCELLED,e):t(cleverapps.Social.CODE_SUCCEED)})})},cleverapps.Mobage.prototype.requestToOne=function(e,t,n){var s={};s[opensocial.Message.Field.TITLE]=t.title;var i=t.message,o=opensocial.newMessage(i,s),r=e;FullscreenControlButton.exitFullscreen(function(){opensocial.requestSendMessage(r,o,function(e){if(e.hadError())n(cleverapps.Social.CODE_CANCELLED);else{var t=e.getData()
;t.recipientIds&&0<t.recipientIds.length?n(cleverapps.Social.CODE_SUCCEED):n(cleverapps.Social.CODE_CANCELLED)}})})},cleverapps.Mobage.prototype.request=function(e,n){var s=e.to;Array.isArray(s)||(s=[s]);var i=[],o=function(t){t===s.length?n(0<i.length?cleverapps.Social.CODE_SUCCEED:cleverapps.Social.CODE_CANCELLED,i):this.requestToOne(s[t],e,function(e){e===cleverapps.Social.CODE_SUCCEED&&i.push(s[t]),setTimeout(function(){o(t+1)},500)})}.bind(this);o(0)},cleverapps.Mobage.prototype.shareDialog=function(e,n){var t=cleverapps.config.deployment+e.picture;0<=t.indexOf("?")&&(t=t.substr(0,t.indexOf("?")));var s=opensocial.newMediaItem("image/jpg",t);s.setField(opensocial.MediaItem.Field.TYPE,opensocial.MediaItem.Type.IMAGE);var i={};i[mbga.Diary.Field.TITLE]=e.name,i[mbga.Diary.Field.CONTENT]=e.description,i[mbga.Diary.Field.MEDIA_ITEMS]=[s];var o=mbga.newCreateDiary(i);FullscreenControlButton.exitFullscreen(function(){mbga.requestCreateDiary(o,function(e){if(e.hadError())n(
cleverapps.Social.CODE_FAILED,e);else{var t=e.getData().getEntryURL();console.log(t),n(t?cleverapps.Social.CODE_SUCCEED:cleverapps.Social.CODE_CANCELLED)}})})},cleverapps.Mobage.prototype.listFriendsByApp=function(n,s){var e={};e[opensocial.DataRequest.PeopleRequestFields.MAX]=1e3,e[opensocial.DataRequest.PeopleRequestFields.PROFILE_DETAILS]=[opensocial.Person.Field.HAS_APP];var t={};t[opensocial.IdSpec.Field.USER_ID]=opensocial.IdSpec.PersonId.VIEWER,t[opensocial.IdSpec.Field.GROUP_ID]=opensocial.IdSpec.GroupId.FRIENDS;var i=opensocial.newIdSpec(t),o=opensocial.newDataRequest();o.add(o.newFetchPeopleRequest(i,e),"friends"),o.send(function(e){if(e.hadError())s(cleverapps.Social.CODE_FAILED);else{var t=e.get("friends").getData().asArray();t=t.filter(function(e){return e.getField(opensocial.Person.Field.HAS_APP)===n}),s(cleverapps.Social.CODE_SUCCEED,t.map(cleverapps.Mobage.formatUserData))}})},cleverapps.Mobage.prototype.listFriends=function(e){this.listFriendsByApp(!0,e)},
cleverapps.Mobage.prototype.listInvitableFriends=function(e){this.listFriendsByApp(!1,e)},cleverapps.Mobage.formatUserData=function(e){var t="",n={id:e.getId(),name:e.getDisplayName(),first_name:e.getDisplayName()};try{return t=cleverapps.Mobage.proxyAvatar(e.getField(opensocial.Person.Field.THUMBNAIL_URL)),n.picture={data:{url:t}},n}catch(e){if(e instanceof TypeError||e.message&&-1!==e.message.indexOf("of null")){var s=e.message+" avatarUrl - "+t+" reqUserId - "+n.id+" reqUserName - "+n.name+" stack - "+JSON.stringify(e.stack);throw new Error(s)}throw e}},cleverapps.Mobage.proxyAvatar=function(e){return cleverapps.config.deployment.replace("https","http")+"/proxy"+e.match(/.*profile(.*)/)[1]},cleverapps.Mobage.prototype.aboutMe=function(e){e(this.user)},cleverapps.Mobage.prototype.logEvent=function(e,t){},cleverapps.Mobage.prototype.getDefaultLanguages=function(){return[cc.sys.LANGUAGE_JAPANESE]},cleverapps.Mobage.isAppropriate=function(){
return!cc.sys.isNative&&"mbga"===cleverapps.User.calcSource()},cleverapps.Mobage.CODE_SUCCEED="ok",cleverapps.SPMobage=function(){console.log("Choosing sp-mobage"),cleverapps.Mobage.call(this),this.clientData=cleverapps.SPMobage.CLIEND_DATA;var e=cleverapps.config.deployment.replace("https","http");this.clientData.redirectUrl=e+"/publish/html5"+(cleverapps.config.debugMode?"-staging":"")+"/index.html"},cleverapps.SPMobage.prototype=Object.create(cleverapps.Mobage.prototype),cleverapps.SPMobage.prototype.constructor=cleverapps.SPMobage,cleverapps.SPMobage.prototype.getLocalStoragePreffix=function(){return"_sp_mbga"},cleverapps.SPMobage.prototype.needTokenRefresh=function(){return!this.clientData.token||!this.clientData.token.expireTime||this.clientData.token.expireTime<=Date.now()},cleverapps.SPMobage.prototype.checkAccessToken=function(s){s=s||function(){};var e=function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n+"="+e[n]);cleverapps.RestClient.get(e.path+"?"+t.join("&"),
{},function(e){this.clientData.token.accessToken=e.accessToken,this.clientData.token.refreshToken=e.refreshToken,this.clientData.token.expireTime=Date.now()+1e3*e.expiresIn,s()}.bind(this))}.bind(this),t={redirect_uri:this.clientData.redirectUrl};this.clientData.token?this.needTokenRefresh()?(t.path="/spmbgatoken/refresh",t.refresh_token=this.clientData.token.refreshToken,e(t)):s():(this.clientData.token={},t.path="/spmbgatoken/get",t.code=this.clientData.code,e(t))},cleverapps.SPMobage.prototype.init=function(t){this.loggedIn=!1;var e=function(){AddSPMobageFooter(),this.checkLoginStatus(t),setInterval(this.periodicCheck.bind(this),cleverapps.parseInterval(cleverapps.SPMobage.CHECK_STATUS_INTERVAL))}.bind(this),n=function(e){"undefined"==typeof mobage&&(mobage=cleverapps.FakeSPMobage),"timeout"===e?cleverapps.eventLogger.logEvent(cleverapps.EVENTS.FAKEFB_BY_TIMEOUT):cleverapps.eventLogger.logEvent(cleverapps.EVENTS.FAKEFB_BY_SCRIPT_ERROR),t()}.bind(this),
s=cleverapps.config.debugMode?cleverapps.SPMobage.MOBAGE_API.SANDBOX:cleverapps.SPMobage.MOBAGE_API.PRODUCTION;cleverapps.loadSdk(s,{onFailure:n}),document.addEventListener("mobageReady",function(){try{mobage.init({clientId:this.clientData.clientId,redirectUri:this.clientData.redirectUrl}),e()}catch(e){console.log("Mobage init fail",e),n()}}.bind(this))},cleverapps.SPMobage.prototype.getPlayerInfo=function(n){mobage.api.people.get({userId:"@me",groupId:"@self",fields:["id","displayName","thumbnailUrl"]},function(e,t){e?console.log("Failed requesting user info",e):this.user=cleverapps.SPMobage.formatUserData(t),n()}.bind(this))},cleverapps.SPMobage.prototype.login=function(e,t){e()},cleverapps.SPMobage.prototype.checkLoginStatus=function(t){t=t||function(){};var n=function(){this.loggedIn=!0,this.getPlayerInfo(t)}.bind(this);try{mobage.oauth.getConnectedStatus({state:this.clientData.state},function(e,t){e?(this.clientData.platformLogin=e.login,this.clientData.connected=e.connected,
this.processAutoLogin(n)):(this.clientData.platformLogin=!0,this.clientData.connected=!0,this.clientData.code=t.response.code,n())}.bind(this))}catch(e){console.log("Get connect status error",e),t()}},cleverapps.SPMobage.prototype.periodicCheck=function(){if(!this.checkInProcess){this.checkInProcess=!0;try{mobage.oauth.getConnectedStatus({state:this.clientData.state},function(e,t){this.checkInProcess=!1,t&&(this.clientData.code=t.response.code,this.checkAccessToken())}.bind(this))}catch(e){this.checkInProcess=!1,console.log("Get connect status error",e)}}},cleverapps.SPMobage.prototype.processAutoLogin=function(s){var i=ResourceProcessor.calcProbablyNeed(),o=setInterval(function(){if(cleverapps.bundleLoader.isLoaded(i)){clearInterval(o);var t=this.createAutoLoginScreen(s),e=cc.director.getRunningScene().onChangeSize;if(e){var n=t.createListener(function(){var e=cc.director.getWinSize();t.setContentSize2(e),t.buttonNode.setPositionRound(e.width/2,e.height/2)}.bind(this))
;cc.director.getRunningScene().onChangeSize=function(){e.apply(cc.director.getRunningScene(),arguments),n()}}}}.bind(this),300)},cleverapps.SPMobage.prototype.createAutoLoginScreen=function(e){var t=cc.director.getWinSize(),n=new cc.LayerColor(cleverapps.styles.COLORS.WHITE,t.width,t.height);cc.director.getRunningScene().addChild(n,9999);var s=n.buttonNode=new SpPlatformButtons(t.width,function(){n.removeFromParent(),e()});return n.addChild(s),s.setPositionRound(t.width/2,t.height/2),n},cleverapps.SPMobage.prototype.isLoggedIn=function(){return this.loggedIn},cleverapps.SPMobage.formatUserData=function(e){return{id:e.id,name:e.displayName,first_name:e.displayName,picture:{data:{url:cleverapps.SPMobage.proxyAvatar(e.thumbnailUrl)}}}},cleverapps.SPMobage.proxyAvatar=function(e){return cleverapps.config.deployment.replace("https","http")+"/proxy/sp"+e.match(/.*img_u(.*)/)[1]},cleverapps.SPMobage.prototype.listFriendsByApp=function(s,i){mobage.api.people.get({userId:"@me",
groupId:"@friends",fields:["id","displayName","thumbnailUrl","hasApp"]},function(e,t){if(e)console.log("Failed fetching friends",e),i(cleverapps.Social.CODE_FAILED);else{var n=t.entry;n=n.filter(function(e){return e.hasApp===s}),i(cleverapps.Social.CODE_SUCCEED,n.map(cleverapps.SPMobage.formatUserData))}})},cleverapps.SPMobage.prototype.inviteFriends=function(e,n){mobage.ui.open("invitation",{},function(e,t){e?n(cleverapps.Social.CODE_CANCELLED,e):"mobage"===t.response.result.channel&&n(cleverapps.Social.CODE_SUCCEED)})},cleverapps.SPMobage.prototype.request=function(e,t){t(cleverapps.Social.CODE_SUCCEED)},cleverapps.SPMobage.prototype.shareDialog=function(e,t){t(cleverapps.Social.CODE_SUCCEED)},cleverapps.SPMobage.prototype.sendActivity=function(e,t){},cleverapps.SPMobage.isAppropriate=function(){return!cc.sys.isNative&&"sp_mbga"===cleverapps.User.calcSource()},cleverapps.SPMobage.MOBAGE_API={SANDBOX:"https://cdn-sb-connect.mobage.jp/jssdk/mobage-jssdk-client.3.9.1.min.js",
PRODUCTION:"https://cdn-connect.mobage.jp/jssdk/mobage-jssdk-client.3.9.1.min.js"},cleverapps.SPMobage.CLIEND_DATA={clientId:cleverapps.config.sp_mbga&&cleverapps.config.sp_mbga.url,state:"mobage-connect_"+Math.random().toString(36).slice(-16),code:null,connected:!1,platformLogin:!1},cleverapps.SPMobage.CHECK_STATUS_INTERVAL="10 minutes",cleverapps.FakeSPMobage={ui:{open:function(){},show:function(){}},event:{subscribe:function(){},unsubscribe:function(){}},oauth:{connect:function(){},getConnectedStatus:function(){}},api:{people:{get:function(){}}}},cleverapps.overrideFonts(cleverapps.styles.FONTS,{BLUE_LINK_TEXT:{size:30,color:new cc.Color(62,158,254)},BLACK_LINK_TEXT:{size:30,color:cleverapps.styles.COLORS.BLACK}});var AddSPMobageFooter=function(){var e=document.createElement("div");e.style.position="absolute",e.style.zIndex="2",e.style.bottom="0",e.style.height="27px",e.style.width="100%",e.style.background="#e3e3e3",e.style.display="table",
e.innerHTML=AddSPMobageFooter.getContentHtml(),document.body.appendChild(e),cleverapps.decCanvasHeight=27,cleverapps.setupDesignResolution()};AddSPMobageFooter.getContentHtml=function(){var e="style='display: table-cell;\nwidth: 25%;\ntext-align: center;\nvertical-align: middle;\nborder-right: 1px solid #5f5f5f;\nfont-size: 80%;\ncolor: #5f5f5f;\nline-height: normal;\nfont-weight: bold;'";return"<div "+e+" onclick='mobage.ui.show(\"portal\", {});'>Mobage</div><div "+e+" onclick='mobage.ui.show(\"inquiry\", {});'></div><div "+e+" onclick='mobage.ui.open(\"client_configuration\", {}, function() {});'></div><div "+e+" onclick='mobage.ui.show(\"commercial_transaction\");'></div>"};var SpPlatformButtons=cleverapps.Layout.extend({ctor:function(e,t){this.buttonWidth=e,this.callback=t,this._super(this.createItems(),{direction:cleverapps.UI.VERTICAL,margin:cleverapps.styles.SpPlatformButtons.buttonsMargin})},createItems:function(){var e=[]
;return cleverapps.social.clientData.platformLogin?e.push(this.createOneButton("",this.createLink(")"))):(e.push(this.createOneButton("ID",this.createLink(")"))),-1===SpPlatformButtons.EASY_REGISTRATION_UNAVAILABLE.indexOf(cleverapps.config.name)&&e.push(this.createOneButton("",this.createLink(")",!0),!0))),e},createOneButton:function(e,t,n){var s=function(e,t){e?console.log("Authorization failed:",e):(cleverapps.social.clientData.platformLogin=!0,cleverapps.social.clientData.connected=!0,cleverapps.social.clientData.code=t.response.code,cleverapps.social.checkAccessToken(),this.callback())}.bind(this),i=new cleverapps.UI.Button({text:e,maxWidth:.8*this.buttonWidth,onClicked:function(){var e={state:cleverapps.social.clientData.state};n&&(e.easyRegistration=!0,e.requestType="window"),mobage.oauth.connect(e,s)}});return new cleverapps.Layout([i,t],{direction:cleverapps.UI.VERTICAL,margin:cleverapps.styles.SpPlatformButtons.linkMargin})},
createLink:function(e,t){var n=cleverapps.UI.generateOnlyText(e,cleverapps.styles.FONTS.BLUE_LINK_TEXT),s=cleverapps.UI.generateOnlyText(" ",cleverapps.styles.FONTS.BLACK_LINK_TEXT),i=new cleverapps.Layout([n,s],{direction:cleverapps.UI.HORIZONTAL,margin:cleverapps.styles.SpPlatformButtons.textMargin});return cleverapps.UI.applyHover(i),cleverapps.UI.onClick(i,function(){t?mobage.ui.show("client_agreement_menu",{isEasyRegistration:!0}):mobage.ui.show("client_agreement_menu")}),i}});SpPlatformButtons.EASY_REGISTRATION_UNAVAILABLE=["riddles","heroes","tripeaks","crocword","runes"],cleverapps.styles.SpPlatformButtons={buttonsMargin:50,linkMargin:10,textMargin:5},cleverapps.Xsolla=function(){console.log("Choosing Xsolla"),cleverapps.Social.call(this),this.accessToken=cleverapps.getRequestParameters(location.search).token},cleverapps.Xsolla.prototype=Object.create(cleverapps.Social.prototype),cleverapps.Xsolla.prototype.constructor=cleverapps.Xsolla,
cleverapps.Xsolla.prototype.init=function(t){var e,n,s,i,o;cleverapps.config.debugMode||(e=window,n=document,e.fbq||(s=e.fbq=function(){s.callMethod?s.callMethod.apply(s,arguments):s.queue.push(arguments)},e._fbq||(e._fbq=s),(s.push=s).loaded=!0,s.version="2.0",s.queue=[],(i=n.createElement("script")).async=!0,i.src="https://connect.facebook.net/en_US/fbevents.js",(o=n.getElementsByTagName("script")[0]).parentNode.insertBefore(i,o)),fbq("init",cleverapps.config.fbPixelId),fbq("track","PageView")),cleverapps.RestClient.get("https://login.xsolla.com/api/users/me",{},function(e){this.user=e,t()}.bind(this),this.redirectToLogin,{authorization:"Bearer "+this.accessToken})},cleverapps.Xsolla.prototype.getUserID=function(){return this.user?this.user.id:void 0},cleverapps.Xsolla.prototype.isLoggedIn=function(){return!0},cleverapps.Xsolla.prototype.getAccessToken=function(){return"XS_"+this.accessToken},cleverapps.Xsolla.prototype.redirectToLogin=function(){var e=function(){
var e=new XsollaLogin.Widget({projectId:cleverapps.config.xsollaLoginProject,preferredLocale:"en_US"}),t=document.createElement("div");t.id="loginDiv",t.style.zIndex="3",t.style.width="inherit",t.style.height="inherit",document.body.appendChild(t),e.mount("loginDiv")}.bind(this);cleverapps.loadSdk("https://login-sdk.xsolla.com/latest/",{onSuccess:e,onFailure:function(){console.log("Failed initialize xsolla sdk")}})},cleverapps.Xsolla.prototype.aboutMe=function(t){cleverapps.RestClient.get("https://login.xsolla.com/api/users/me/social_providers",{},function(e){e&&0<e.length?(e=e[0],t({id:this.getUserID(),name:e.full_name,first_name:e.nickname,picture:{data:{url:e.picture}}})):console.log("Error: "+JSON.stringify(e))}.bind(this),this.redirectToLogin,{authorization:"Bearer "+this.accessToken})},cleverapps.Xsolla.prototype.getLocalStoragePreffix=function(){return"_xsolla"},cleverapps.Xsolla.isAppropriate=function(){return"xsolla"===cleverapps.User.calcSource(
)&&void 0!==cleverapps.getRequestParameters(location.search).token},cleverapps.Html5=function(){console.log("Choosing html5-facebook"),cleverapps.BaseFB.call(this),this.loginPlacement=!0},cleverapps.Html5.prototype=Object.create(cleverapps.BaseFB.prototype),cleverapps.Html5.prototype.constructor=cleverapps.Html5,cleverapps.Html5.prototype.init=function(e){var t,n,s=cleverapps.once(function(){setTimeout(e,500),void 0!==n&&(clearInterval(n),n=void 0),void 0!==t&&(clearTimeout(t),t=void 0),cleverapps.social.deleteAllRequests()}),i=function(e){plugin.FacebookAgent&&plugin.FacebookAgent.getInstance()&&void 0!==plugin.FacebookAgent.getInstance()._isLoggedIn?s():(plugin.FacebookAgent=cleverapps.FakeFacebookAgent,s(),"timeout"===e?cleverapps.eventLogger.logEvent(cleverapps.EVENTS.FAKEFB_BY_TIMEOUT):cleverapps.eventLogger.logEvent(cleverapps.EVENTS.FAKEFB_BY_SCRIPT_ERROR))}.bind(this);cleverapps.loadSdk("//connect.facebook.net/en_US/sdk.js",{onSuccess:function(){t=setTimeout(function(){i(
"timeout")},9e4)},onFailure:i}),window.fbAsyncInit=function(){plugin.FacebookAgent||(cleverapps.StartFacebook(),n=setInterval(function(){plugin.FacebookAgent&&plugin.FacebookAgent.getInstance()&&void 0!==plugin.FacebookAgent.getInstance()._isLoggedIn&&(cleverapps.eventLogger.logEvent(cleverapps.EVENTS.FACEBOOK_INITED),s())},50))}},cleverapps.Html5.prototype.isLoggedIn=function(){return this.initialized&&plugin.FacebookAgent.getInstance().isLoggedIn()},cleverapps.Html5.prototype.getUserID=function(){return plugin.FacebookAgent.getInstance().getUserID()},cleverapps.Html5.prototype.getAccessToken=function(){return plugin.FacebookAgent.getInstance().getAccessToken()},cleverapps.Html5.prototype.login=function(t,n){if(!this.isInitialized())return cleverapps.Notification.create("messages:SocialManager.Initialization"),void(n&&n());FullscreenControlButton.exitFullscreen(function(){plugin.FacebookAgent.getInstance().login(cleverapps.BaseFB.PERMISSIONS,function(e){
e===cleverapps.Social.CODE_SUCCEED?(cleverapps.SocialManager.onLogin(),t()):(cleverapps.SocialManager.onFailedLogin(),n&&n())})})},cleverapps.Html5.prototype.inviteFriends=function(e,t){this.request(e,t)},cleverapps.Html5.prototype.request=function(e,t){delete e.element,"object"==typeof e.to&&(e.to=e.to.join(",")),FullscreenControlButton.exitFullscreen(function(){plugin.FacebookAgent.getInstance().appRequest(e,t)})},cleverapps.Html5.prototype.shareDialog=function(e,t){var n=this.getShareDialogLink(e);console.log("share link",n);var s={dialog:"feedDialog",link:n,caption:Messages.get(cleverapps.config.title)};FullscreenControlButton.exitFullscreen(function(){plugin.FacebookAgent.getInstance().dialog(s,t)})},cleverapps.Html5.prototype.api=function(e,t,n,s){if("function"==typeof(n=n||{})&&(s=n,n={}),!this.isLoggedIn())return console.log("Not logged in!"),void(s&&s(cleverapps.Social.CODE_CANCELLED));void 0===t?(t=plugin.FacebookAgent.HttpMethod.GET,s=function(){}):"function"==typeof t&&(s=t
,t=plugin.FacebookAgent.HttpMethod.GET),plugin.FacebookAgent.getInstance().api(e,t,n,s)},cleverapps.Html5.prototype.logEvent=function(e,t){if(plugin.FacebookAgent&&plugin.FacebookAgent.getInstance()){var n=0;t&&1<t.amount&&(n=t.amount),plugin.FacebookAgent.getInstance().logEvent(e,n,t)}},cleverapps.Html5.isAppropriate=function(){return!cc.sys.isNative},cleverapps.FakeFacebookAgent={getInstance:function(){return this},isLoggedIn:function(){return!1},logEvent:function(){},login:function(e,t){t(cleverapps.Social.CODE_FAILED)},getAccessToken:function(){},dialog:function(e,t){t(cleverapps.Social.CODE_FAILED)},appRequest:function(e,t){t(cleverapps.Social.CODE_FAILED)},api:function(e,t,n,s){"function"==typeof n&&(s=n,n={}),s(cleverapps.Social.CODE_FAILED)},HttpMethod:{GET:"get"}},cleverapps.Instant=function(){console.log("Choosing Instant-facebook"),cleverapps.Social.call(this),SelectFriendWindow.MAX_SELECTED=1},cleverapps.Instant.prototype=Object.create(cleverapps.Social.prototype),
cleverapps.Instant.prototype.constructor=cleverapps.Instant,cleverapps.Instant.Adapt=function(){FBInstant.onPause(function(){cleverapps.eventLogger.logEvent("instant_pause")}),cc.eventManager.addCustomListener(cc.game.EVENT_HIDE,function(){cleverapps.eventLogger.logEvent("instant_hide")})},cleverapps.Instant.LoadSdk=function(e){var t=document.createElement("script");t.setAttribute("type","text/javascript"),t.setAttribute("src","//connect.facebook.net/en_US/fbinstant.6.3.js"),t.onload=function(){console.log("Loaded FBInstant sdk"),e()},t.onerror=function(){console.log("Failed initialize sdk")},document.body.appendChild(t)},cleverapps.Instant.prototype.createBot=function(){FBInstant.player.canSubscribeBotAsync().then(function(e){e&&(cleverapps.eventLogger.logEvent(cleverapps.EVENTS.INSTANT_BOT_SHOW),FBInstant.player.subscribeBotAsync().then(function(){cleverapps.eventLogger.logEvent(cleverapps.EVENTS.INSTANT_BOT)}))}).catch(function(e){-1===["No page associated to the Instant Game.",
"User already subscribed to this game bot.","Exceed API policy limit."].indexOf(e.message)&&cleverapps.eventLogger.logEvent(cleverapps.EVENTS.INSTANT_BOT_ERROR),console.log(e.code+" "+e.message)})},cleverapps.Instant.prototype.createShortcut=function(){cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.INSTANT_SHORTCUT_CREATED)||FBInstant.canCreateShortcutAsync().then(function(e){e&&(cleverapps.eventLogger.logEvent(cleverapps.EVENTS.INSTANT_SHORTCUT_SHOW),FBInstant.createShortcutAsync().then(function(){cleverapps.eventLogger.logEvent(cleverapps.EVENTS.INSTANT_SHORTCUT),cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.INSTANT_SHORTCUT_CREATED,1)}))})},cleverapps.Instant.prototype._update=function(n,s){var e=n.image||cleverapps.ShareBonus.cycleShareData("share").picture;this.getBase64Image(e,function(e,t){e?(console.log(e),s(cleverapps.Social.CODE_FAILED)):(s(cleverapps.Social.CODE_SUCCEED),cleverapps.eventLogger.logEvent(cleverapps.EVENTS.INSTANT_UPDATE),FBInstant.updateAsync({
action:"CUSTOM",image:t,text:{default:n.message},template:n.template,strategy:"IMMEDIATE",notification:"PUSH"}))})},cleverapps.Instant.prototype.init=function(n){cleverapps.Instant.LoadSdk(function(){FBInstant.initializeAsync().then(function(){cleverapps.Instant.Adapt(),cleverapps.config.platform=FBInstant.getPlatform();var e=FBInstant.getEntryPointData(),t=e&&e.channel;t&&!cleverapps.user.channel&&0===cleverapps.user.getProgress()&&cleverapps.user.setChannel(t),n()}.bind(this))}.bind(this))},cleverapps.Instant.prototype.logEvent=function(e,t){"undefined"!=typeof FBInstant&&FBInstant.logEvent(e,1,t)},cleverapps.Instant.prototype.isLoggedIn=function(){return!0},cleverapps.Instant.prototype.getUserID=function(){return FBInstant.player.getID()},cleverapps.Instant.prototype.inviteFriends=function(e,t){t=this.waitWindowCallback(t),FBInstant.context.chooseAsync({filters:["NEW_PLAYERS_ONLY"],minSize:2,maxSize:2}).then(function(){this._update({template:"invite",message:e.message},t)}.bind(this
)).catch(function(){t(cleverapps.Social.CODE_FAILED)})},cleverapps.Instant.prototype.request=function(t,n){n=this.waitWindowCallback(n),FBInstant.context.createAsync(t.to[0]).then(function(){this._update({template:"request",message:t.message},n)}.bind(this)).catch(function(e){console.log("send request to "+t.to[0]+" failed",e),-1===["SAME_CONTEXT","INVALID_PARAM"].indexOf(e.code)?n(cleverapps.Social.CODE_FAILED):n(cleverapps.Social.CODE_SUCCEED)})},cleverapps.Instant.prototype.shareDialog=function(n,s){s=this.waitWindowCallback(s),this.getBase64Image(n.picture,function(e,t){e?(console.log(e),s(cleverapps.Social.CODE_FAILED)):FBInstant.shareAsync({intent:"SHARE",image:t,text:n.description}).then(function(){s(cleverapps.Social.CODE_SUCCEED)}).catch(function(){s(cleverapps.Social.CODE_FAILED)})})},cleverapps.Instant.prototype.waitWindowCallback=function(e){var t=new WaitWindow;return cleverapps.metha.display({focus:"waitWindowCallback",action:function(e){
cleverapps.metha.onceNoWindowsListener=e}}),function(){t.close(),e.apply(this,arguments)}},cleverapps.Instant.prototype.getBase64Image=function(n,s){0===(n=n.replace(".jpg",".txt").replace(".png","txt")).indexOf("/")&&(n=n.substr(1)),cc.loader.load(n,function(e,t){n=t&&Array.isArray(t)&&0<t.length?t[0]:void 0,s(e,n)})},cleverapps.Instant.prototype.listFriends=function(n){FBInstant.player.getConnectedPlayersAsync().then(function(e){var t=e.map(function(e){return{id:e.getID(),first_name:e.getName(),picture:{data:{url:e.getPhoto()}}}});n(cleverapps.Social.CODE_SUCCEED,t)}).catch(function(){n(cleverapps.Social.CODE_FAILED)})},cleverapps.Instant.prototype.listInvitableFriends=function(e){e(cleverapps.Social.CODE_SUCCEED,[])},cleverapps.Instant.prototype.aboutMe=function(e){e({currency:{user_currency:"USD"},name:FBInstant.player.getName(),first_name:FBInstant.player.getName(),picture:{data:{url:FBInstant.player.getPhoto()}}})},cleverapps.Instant.prototype.getAccessToken=function(){
return"instant"},cleverapps.Instant.isAppropriate=function(){return cleverapps.isInstant()},cleverapps.Instant.PLATFORM_WEB="WEB",cleverapps.Instant.PLATFORM_MOBILE_WEB="MOBILE_WEB",cleverapps.Instant.PLATFORM_IOS="IOS",cleverapps.Instant.PLATFORM_ANDROID="ANDROID",cleverapps.FakeInstant=function(){console.log("Choosing FakeInstant-facebook"),this.__mockState={initialized:!1},cleverapps.Instant.call(this)},cleverapps.FakeInstant.prototype=Object.create(cleverapps.Instant.prototype),cleverapps.FakeInstant.prototype.constructor=cleverapps.FakeInstant,cleverapps.FakeInstant.prototype.init=function(e){cleverapps.config.restApiURL=cleverapps.config.fakeRestApiURL,cleverapps.Instant.LoadSdk=function(e){e()},FBInstant={initializeAsync:function(){return new Promise(function(e,t){var n=document.createElement("link");n.href="cleverapps/res/css/mock-3cdb8ce066-3cdb8ce066.css",n.rel="stylesheet",n.type="text/css",document.head.appendChild(n),Utils.log("initializeAsync"),e()})},startGameAsync:function(){
return new Promise(function(e,t){Utils.log("startGameAsync","Showing game start dialog"),Utils.createAlert({message:"Game has finished loading. <br /> Play now?",cta:"Play!"},function(){cleverapps.social.__mockState.initialized=!0,e()})})},setLoadingProgress:function(n){return new Promise(function(e,t){Utils.log("progress",n,"%"),e()})},getSupportedAPIs:function(){var e=[];for(var t in FBInstant)e.push(t);for(var t in FBInstant.player)e.push("player."+t);for(var t in FBInstant.context)e.push("context."+t);return e}},cleverapps.Instant.LoadSdk(function(){FBInstant.initializeAsync().then(function(){console.log("FBInstant.initializeAsync()"),InstantLoaderScene.whenLoaded(function(){FBInstant.startGameAsync().then(e)})}.bind(this))}.bind(this))},cleverapps.FakeInstant.prototype.logEvent=function(e,t){return Utils.log("logEvent",e,1,t),null},cleverapps.FakeInstant.prototype.isLoggedIn=function(){return!0},cleverapps.FakeInstant.prototype.getUserID=function(){return Utils.returnUserData(
123456789)},cleverapps.FakeInstant.prototype.inviteFriends=function(e,t){Utils.shareAsync({intent:"INVITE",image:DEFAULT_INVITE_PICTURE,text:e.message}).then(function(){t(cleverapps.Social.CODE_SUCCEED)})},cleverapps.FakeInstant.prototype.request=function(e,t){Utils.shareAsync({intent:"REQUEST",image:e.picture,text:e.message}).then(function(){t()})},cleverapps.FakeInstant.prototype.shareDialog=function(e,t){Utils.shareAsync({intent:"SHARE",image:e.picture,text:e.description}).then(function(){t()})},cleverapps.FakeInstant.prototype.listFriends=function(t){new Promise(function(e,t){var n=[];cleverapps.social.__mockState.initialized?n=[{getID:function(){return 42},getName:function(){return"Friend 1"},getPhoto:function(){return"cleverapps/res/img/mock/friend1-f27202440f.png"}},{getID:function(){return 43},getName:function(){return"Friend 2"},getPhoto:function(){return"cleverapps/res/img/mock/friend2-607bb2c069.png"}},{getID:function(){return 44},getName:function(){return"Friend 3"},
getPhoto:function(){return"cleverapps/res/img/mock/friend3-5d09776058.png"}}]:Utils.log("getConnectedPlayersAsync","Connected players data is not available before startGameAsync resolves"),Utils.log("getConnectedPlayersAsync","players: ",n),e(n)}).then(function(e){t(cleverapps.Social.CODE_SUCCEED,e.map(function(e){return{id:e.getID(),name:e.getName(),first_name:e.getName(),picture:{data:{url:e.getPhoto()}}}}))})},cleverapps.FakeInstant.prototype.listInvitableFriends=function(e){return[]},cleverapps.FakeInstant.prototype.aboutMe=function(e){e({currency:{user_currency:"USD"},name:Utils.returnUserData("Player 1"),first_name:Utils.returnUserData("Player 1"),picture:{data:{url:Utils.returnUserData("cleverapps/res/img/mock/profile-2f8a5e0f94.jpg")}}})};var Utils={shareAsync:function(n){var s="Share Intent: "+n.intent;return s+="<br />",s+="Share text: "+n.text,s+="<br />",s+="Share payload: "+JSON.stringify(n.data),new Promise(function(e,t){Utils.createAlert({title:"Shared content",
message:s,image:n.image,cta:"Close"},e)})},createAlert:function(e,t){var n=document.createElement("div");n.className="mockDialog";var s=document.createElement("h3");if(s.innerHTML="(FBFakeInstant Mock)",s.innerHTML+=" "+(e.title||""),n.appendChild(s),e.message){var i=document.createElement("p");i.innerHTML=e.message,n.appendChild(i)}if(e.image){var o=document.createElement("img");o.src=e.image,n.appendChild(o)}var r=document.createElement("input");r.type="button",r.value=e.cta||"Close",n.appendChild(r),r.onclick=function(){document.body.removeChild(n),t()},document.body.appendChild(n)},log:function(){args=[],args.push("[FBFakeInstant Mock]:");for(var e=0;e<arguments.length;e++)args.push(arguments[e]);console.log.apply(console,args)},getQueryString:function(){var i={};return location.search&&location.search.substr(1).split("&").forEach(function(e){var t=e.split("="),n=t[0],s=t[1]&&decodeURIComponent(t[1]);(i[n]=i[n]||[]).push(s)}),i},returnAndLog:function(e){
return caller=Utils.returnAndLog.caller,caller?Utils.log(caller.name,e):Utils.log(e),e},returnUserData:function(e){return cleverapps.social.__mockState.initialized?Utils.returnAndLog(e):(Utils.log("User Data is not available until startGameAsync has resolved"),null)},getFromLocalStorage:function(i,o){return new Promise(function(e,t){var n=localStorage.getItem(i),s={};n&&(n=JSON.parse(n),o.forEach(function(e){"undefined"!==n[e]&&(s[e]=n[e])})),Utils.log(s),e(s)})},writeToLocalStorage:function(n,s){return new Promise(function(e,t){Utils.log(JSON.stringify(s)),localStorage.setItem(n,JSON.stringify(s)),e()})}};cleverapps.FakeInstant.isAppropriate=function(){return!cc.sys.isNative&&"instant"===cc.game.config.source&&cleverapps.isLocalhost()},cleverapps.FakeFacebook=function(){cleverapps.BaseFB.call(this)},cleverapps.FakeFacebook.prototype=Object.create(cleverapps.BaseFB.prototype),cleverapps.FakeFacebook.prototype.constructor=cleverapps.FakeFacebook,
cleverapps.FakeFacebook.prototype.init=function(e){cleverapps.config.restApiURL=cleverapps.config.fakeRestApiURL,this.DIALOG_CANCELLED=2,this.loggedIn=!1,this.token=void 0,setTimeout(function(){this.isExpired()||(this.token="123",this.loggedIn=!0),e()}.bind(this),1e3)},cleverapps.FakeFacebook.prototype.isExpired=function(){var e=cc.sys.localStorage.getItem(cleverapps.DataLoaderTypes.FAKE_FACEBOOK_LOGGING_TIME);return null===e||parseInt(e)+cleverapps.FakeFacebook.FAKE_SESSION_TIMEOUT<Date.now()},cleverapps.FakeFacebook.prototype.logEvent=function(e,t){},cleverapps.FakeFacebook.prototype.isLoggedIn=function(){return this.loggedIn&&!this.isExpired()},cleverapps.FakeFacebook.prototype.getUserID=function(){return"1"},cleverapps.FakeFacebook.prototype.getAccessToken=function(){return this.isExpired()?void 0:this.token},cleverapps.FakeFacebook.prototype.login=function(e,t){confirm("Do you want to log in?")?(cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.FAKE_FACEBOOK_LOGGING_TIME,
Date.now()),this.token="123",this.loggedIn=!0,cleverapps.SocialManager.onLogin(),(e=e||function(){})()):(cc.sys.localStorage.removeItem(cleverapps.DataLoaderTypes.FAKE_FACEBOOK_LOGGING_TIME),cleverapps.SocialManager.onFailedLogin(),t&&t())},cleverapps.FakeFacebook.prototype.inviteFriends=function(e,t){this.request(e,t)},cleverapps.FakeFacebook.prototype.request=function(e,t){delete e.element,t=t||function(){},confirm("Do you to post "+JSON.stringify(e)+"?")?t(cleverapps.Social.CODE_SUCCEED,{to:["__333"]}):t(cleverapps.Social.DIALOG_CANCELLED,"FakeFB")},cleverapps.FakeFacebook.prototype.shareDialog=function(e,t){confirm("Do you to post "+JSON.stringify(e)+"?")?t(cleverapps.Social.CODE_SUCCEED,"FakeFB"):t(cleverapps.Social.DIALOG_CANCELLED,"FakeFB")},cleverapps.FakeFacebook.prototype.listFriends=function(e){setTimeout(function(){e(cleverapps.Social.CODE_SUCCEED,[{id:"111",name:"Friend 111",first_name:"Friend1",picture:{data:{
url:"https://graph.facebook.com/41803173/picture?height=200&width=200"}}},{id:"222",name:"Friend 222",first_name:"Friend2",picture:{data:{url:"https://graph.facebook.com/692982514/picture?height=200&width=200"}}}])},500)},cleverapps.FakeFacebook.prototype.listInvitableFriends=function(e){setTimeout(function(){e(cleverapps.Social.CODE_SUCCEED,[{id:"__333",name:"Invitable1",first_name:"Invitable1",picture:{data:{url:"https://graph.facebook.com/100028444590540/picture?height=200&width=200"}}},{id:"__444",name:"Invitable2",first_name:"Invitable2",picture:{data:{url:"https://graph.facebook.com/100001008129789/picture?height=200&width=200"}}},{id:"__555",name:"Invitable3",first_name:"Invitable3",picture:{data:{url:"https://graph.facebook.com/100011706990070/picture?height=200&width=200"}}},{id:"__666",name:"Invitable4",first_name:"Invitable4",picture:{data:{url:"https://graph.facebook.com/100001575006940/picture?height=200&width=200"}}},{id:"__777",name:"Invitable5",first_name:"Invitable5",
picture:{data:{url:"https://graph.facebook.com/100000318466656/picture?height=200&width=200"}}}])},500)},cleverapps.FakeFacebook.prototype.api=function(e,t){switch(e){case"/me/?fields=is_eligible_promo":FB={ui:function(e,t){t({status:"completed"})}},t(cleverapps.Social.CODE_SUCCEED,{is_eligible_promo:1})}},cleverapps.FakeFacebook.prototype.aboutMe=function(e){setTimeout(function(){e({currency:{user_currency:"USD"},name:"FakeFB User",first_name:"FakeFB",picture:{data:{url:"https://graph.facebook.com/100001828353521/picture?height=200&width=200"}}})},500)},cleverapps.FakeFacebook.isAppropriate=function(){return!cc.sys.isNative&&cleverapps.isLocalhost()},cleverapps.FakeFacebook.FAKE_SESSION_TIMEOUT=cleverapps.parseInterval("10 minutes"),cleverapps.MobileFacebook=function(){this.constructor===cleverapps.MobileFacebook&&console.log("Choosing mobile-facebook (sdkbox)"),this.apiJobs=[],this.apiProcessing=!1,cleverapps.BaseFB.call(this)},cleverapps.MobileFacebook.prototype=Object.create(
cleverapps.BaseFB.prototype),cleverapps.MobileFacebook.prototype.constructor=cleverapps.MobileFacebook,cleverapps.MobileFacebook.prototype.init=function(e){sdkbox.PluginFacebook.init(),this.listeners={},sdkbox.PluginFacebook.setListener({onLogin:cleverapps.whenShow(this.onLogin.bind(this)),onFetchFriends:cleverapps.whenShow(this.onFetchFriends.bind(this)),onAPI:cleverapps.whenShow(this.onApi.bind(this)),onRequestInvitableFriends:cleverapps.whenShow(this.onRequestInvitableFriends.bind(this)),onInviteFriendsWithInviteIdsResult:cleverapps.whenShow(this.onInviteFriendsWithInviteIdsResult.bind(this)),onInviteFriendsResult:cleverapps.whenShow(this.onInviteFriendsResult.bind(this)),onSharedSuccess:cleverapps.whenShow(this.onShared.bind(this,cleverapps.Social.CODE_SUCCEED)),onSharedFailed:cleverapps.whenShow(function(e){this.onShared(cleverapps.Social.CODE_FAILED,e)}.bind(this)),onSharedCancel:cleverapps.whenShow(this.onShared.bind(this,cleverapps.Social.CODE_CANCELLED))}),e&&e(),
cc.eventManager.addCustomListener(cc.game.EVENT_SHOW,function(){this.deleteAllRequests()}.bind(this)),this.deleteAllRequests()},cleverapps.MobileFacebook.prototype.onShared=function(e,t){cc.sys.os===cc.sys.OS_IOS&&2===e&&(e=cleverapps.Social.CODE_SUCCEED),e===cleverapps.Social.CODE_FAILED&&cleverapps.Notification.create("messages:ShareError"),this.listeners.onShared&&(this.listeners.onShared(e),delete this.listeners.onShared)},cleverapps.MobileFacebook.prototype.onLogin=function(e){this.listeners.onLogin&&(this.listeners.onLogin(e),delete this.listeners.onLogin)},cleverapps.MobileFacebook.prototype.onApi=function(e,t){this.listeners.onApi&&(t=decodeWebViewData(t),this.listeners.onApi(cleverapps.Social.CODE_SUCCEED,JSON.parse(t)),delete this.listeners.onApi),this.apiProcessing=!1,this.processApi()},cleverapps.MobileFacebook.prototype.onFetchFriends=function(e,t){if(this.listeners.onFetchFriends){if(e){t=decodeWebViewData(t);var n=JSON.parse(t);cc.sys.os===cc.sys.OS_IOS&&(n=n.data),
this.listeners.onFetchFriends(cleverapps.Social.CODE_SUCCEED,n)}else this.listeners.onFetchFriends(cleverapps.Social.CODE_FAILED,t);delete this.listeners.onFetchFriends}},cleverapps.MobileFacebook.prototype.onInviteFriendsWithInviteIdsResult=function(e,t){this.listeners.onInviteFriendsWithInviteIdsResult&&(this.listeners.onInviteFriendsWithInviteIdsResult(e,t),delete this.listeners.onInviteFriendsWithInviteIdsResult)},cleverapps.MobileFacebook.prototype.onRequestInvitableFriends=function(e){if(this.listeners.onRequestInvitableFriends){var t=decodeWebViewData(e.data);this.listeners.onRequestInvitableFriends(t),delete this.listeners.onRequestInvitableFriends}},cleverapps.MobileFacebook.prototype.onInviteFriendsResult=function(e,t){cleverapps.config.debugMode&&console.log("ON onInviteFriendsResult"),this.listeners.onInviteFriendsResult&&(this.listeners.onInviteFriendsResult(e,t),delete this.listeners.onInviteFriendsResult)},cleverapps.MobileFacebook.prototype.isLoggedIn=function(){
return sdkbox.PluginFacebook.isLoggedIn()},cleverapps.MobileFacebook.prototype.getUserID=function(){return sdkbox.PluginFacebook.getUserID()},cleverapps.MobileFacebook.prototype.getAccessToken=function(){return sdkbox.PluginFacebook.getAccessToken()},cleverapps.MobileFacebook.prototype.login=function(t,n){this.listeners.onLogin=function(e){e===cleverapps.Social.CODE_SUCCEED?(cleverapps.SocialManager.onLogin(),cleverapps.history.set("fblog",1),t()):(cleverapps.SocialManager.onFailedLogin(),n&&n())},sdkbox.PluginFacebook.login(cleverapps.BaseFB.PERMISSIONS)},cleverapps.MobileFacebook.prototype.inviteFriendsShare=function(e,t){cleverapps.Social.prototype.inviteFriendsShare.call(this,e,t)},cleverapps.MobileFacebook.prototype.request=function(e,t){t&&t(cleverapps.Social.CODE_SUCCEED)},cleverapps.MobileFacebook.prototype.getShareDialogData=function(e){return{type:"link",link:this.getShareDialogLink(e),title:e.name,text:e.description,image:cleverapps.config.deployment+e.picture}},
cleverapps.MobileFacebook.prototype.shareDialog=function(e,t){this.listeners.onShared=t,sdkbox.PluginFacebook.dialog(this.getShareDialogData(e))},cleverapps.MobileFacebook.prototype.api=function(e,t,n,s){if("function"==typeof(n=n||{})&&(s=n,n={}),!this.isLoggedIn())return console.log("Not logged in!"),void(s&&s(cleverapps.Social.CODE_CANCELLED));void 0===t?(t="GET",s=function(){}):"function"==typeof t&&(s=t,t="GET"),this.addApiJob(e,t,n,s),this.processApi()},cleverapps.MobileFacebook.prototype.addApiJob=function(e,t,n,s){this.apiJobs.push({apiMethod:e,httpMethod:t,params:n,callback:s})},cleverapps.MobileFacebook.prototype.processApi=function(){if(!this.apiProcessing&&0!==this.apiJobs.length){this.apiProcessing=!0;var e=this.apiJobs.shift();this.listeners.onApi=e.callback,sdkbox.PluginFacebook.api(e.apiMethod,e.httpMethod,e.params,"api")}},cleverapps.MobileFacebook.prototype.getCode=function(){return"facebook"},cleverapps.MobileFacebook.isAppropriate=function(){return cc.sys.isNative},
cleverapps.override(cleverapps.MobileFacebook.prototype,NativeInvite),cleverapps.MobileFacebook.APPINVITES_SDKBOX_ERROR="Unrecognized 'com.facebook.platform.protocol.PROTOCOL_ACTION' extra: 'com.facebook.platform.action.request.APPINVITES_DIALOG'.",cleverapps.AndroidWebViewFacebook=function(){console.log("Choosing android-facebook (webview)"),"undefined"==typeof sdkbox&&(sdkbox={}),sdkbox.PluginFacebook=FacebookPlugin,cleverapps.override(sdkbox.PluginFacebook,{setListener:function(){},init:function(){}}),cleverapps.MobileFacebook.call(this)},cleverapps.AndroidWebViewFacebook.prototype=Object.create(cleverapps.MobileFacebook.prototype),cleverapps.AndroidWebViewFacebook.prototype.constructor=cleverapps.AndroidWebViewFacebook,cleverapps.AndroidWebViewFacebook.prototype.init=function(e){cleverapps.MobileFacebook.prototype.init.apply(this,arguments)},cleverapps.AndroidWebViewFacebook.prototype.shareDialog=function(e,t){this.listeners.onShared=t,sdkbox.PluginFacebook.dialog(JSON.stringify(
this.getShareDialogData(e)))},cleverapps.AndroidWebViewFacebook.prototype.request=function(e,t){this.listeners.onRequest=t,sdkbox.PluginFacebook.inviteFriendsWithInviteIds(e.to?JSON.stringify(e.to):null,e.title,e.message)},cleverapps.AndroidWebViewFacebook.prototype.inviteFriendsShare=function(e,t){cleverapps.Social.prototype.inviteFriendsShare.call(this,e,t)},cleverapps.AndroidWebViewFacebook.prototype.onRequest=function(e){this.listeners.onRequest&&(this.listeners.onRequest(e),delete this.listeners.onRequest)},cleverapps.AndroidWebViewFacebook.prototype.addApiJob=function(e,t,n,s){cleverapps.MobileFacebook.prototype.addApiJob.call(this,e,t,JSON.stringify(n),s)},cleverapps.iOSWebViewFacebook=function(){console.log("Choosing ios-facebook (webview)"),"undefined"==typeof sdkbox&&(sdkbox={}),sdkbox.PluginFacebook={},cleverapps.override(sdkbox.PluginFacebook,{init:function(){webkitMessage("facebook",{action:"init"})},logPurchase:function(e,t){console.log("logPurchase success "+e+" "+t),
webkitMessage("facebook",{action:"logPurchase",amount:e,currency:t})},dialog:function(e){webkitMessage("facebook",{action:"dialog",jsonInfo:JSON.parse(e)})},login:function(e){webkitMessage("facebook",{action:"login",permissions:e})},logout:function(){webkitMessage("facebook",{action:"logout"})},setListener:function(){},isLoggedIn:function(){return console.log("isLoggedIn check"),void 0!==this.tokenString&&0<this.tokenString.length}.bind(this),getAccessToken:function(){return this.tokenString}.bind(this),getPermissionList:function(){return this.permissionList}.bind(this),getUserID:function(){return this.userID}.bind(this),getAppId:function(){return this.appId}.bind(this),getSDKVersion:function(){return this.sdkVersion}.bind(this),api:function(e,t,n,s){webkitMessage("facebook",{action:"api",path:e,method:t,paramsJson:JSON.parse(n),tag:s})},inviteFriendsWithInviteIds:function(e,t,n){webkitMessage("facebook",{action:"inviteFriendsWithInviteIds",inviteIdsJson:JSON.parse(e),title:t,text:n})
},enableDebug:function(e){webkitMessage("facebook",{action:"enableDebug",enable:e})}}),cleverapps.MobileFacebook.call(this)},cleverapps.iOSWebViewFacebook.prototype=Object.create(cleverapps.MobileFacebook.prototype),cleverapps.iOSWebViewFacebook.prototype.constructor=cleverapps.iOSWebViewFacebook,cleverapps.iOSWebViewFacebook.prototype.init=function(e){this.onInitListener=e,cleverapps.MobileFacebook.prototype.init.apply(this)},cleverapps.iOSWebViewFacebook.prototype.onInit=function(e){console.log("Init callback called: "+JSON.stringify(e)),this.tokenString=e.tokenString,this.permissionList=e.permissionList,this.userID=e.userID,this.sdkVersion=e.sdkVersion,this.onInitListener&&(this.onInitListener(),delete this.onInitListener)},cleverapps.iOSWebViewFacebook.prototype.onLogin=function(e,t){console.log("Login callback called: ",t),this.tokenString=t.tokenString,this.permissionList=t.permissionList,this.userID=t.userID,this.sdkVersion=t.sdkVersion,
this.tokenString&&cleverapps.MobileFacebook.prototype.onLogin.call(this,cleverapps.Social.CODE_SUCCEED,"success")},cleverapps.iOSWebViewFacebook.prototype.shareDialog=function(e,t){this.listeners.onShared=t,sdkbox.PluginFacebook.dialog(JSON.stringify(this.getShareDialogData(e)))},cleverapps.iOSWebViewFacebook.prototype.request=function(e,t){this.listeners.onRequest=t,sdkbox.PluginFacebook.inviteFriendsWithInviteIds(e.to?JSON.stringify(e.to):null,e.title,e.message)},cleverapps.iOSWebViewFacebook.prototype.inviteFriendsShare=function(e,t){cleverapps.Social.prototype.inviteFriendsShare.call(this,e,t)},cleverapps.iOSWebViewFacebook.prototype.onRequest=function(e){this.listeners.onRequest&&(this.listeners.onRequest(e),delete this.listeners.onRequest)},cleverapps.iOSWebViewFacebook.prototype.addApiJob=function(e,t,n,s){cleverapps.MobileFacebook.prototype.addApiJob.call(this,e,t,JSON.stringify(n),s)},cleverapps.SocialManager={create:function(){if(cleverapps.flags.nosocial
)return new cleverapps.NoSocial;var e=cleverapps.User.calcSource();if(cc.sys.isNative)return cleverapps.AndroidSocial.isAvailable()?new cleverapps.SelectSocial({facebook:new cleverapps.AndroidWebViewFacebook,androidsocial:new cleverapps.AndroidSocial}):cc.sys.os===cc.sys.OS_IOS&&cleverapps.AppleSocial.isAvailable()?new cleverapps.SelectSocial({facebook:new cleverapps.iOSWebViewFacebook,applesocial:new cleverapps.AppleSocial}):cc.sys.os===cc.sys.OS_ANDROID?new cleverapps.AndroidWebViewFacebook:new cleverapps.iOSWebViewFacebook;var t=cleverapps.isLocalhost()&&-1!==["instant","facebook"].indexOf(e)?{instant:cleverapps.FakeInstant,default:cleverapps.FakeFacebook}:{plinga:cleverapps.Plinga,instant:cleverapps.Instant,mobile_ok:cleverapps.MobileOK,web_ok:cleverapps.OK,mobile_mm:cleverapps.MobileMyMailRu,web_mm:cleverapps.MyMailRu,mobile_vk:cleverapps.MobileVk,web_vk:cleverapps.VK,sp_mbga:cleverapps.SPMobage,mbga:cleverapps.Mobage,nk:cleverapps.NK,draugiem:cleverapps.Draugiem,
fotostrana:cleverapps.FotoStrana,xsolla:cleverapps.Xsolla,default:cleverapps.Html5};return new(t[e]||t.default)},onFailedLogin:function(){cleverapps.Notification.create("messages:SocialManager.FailedLogging")},onLogin:function(){if(levels.user.haveTmpId()){var t=levels.user.id,e=cleverapps.social.getUserID();cleverapps.RestClient.post("/users/off/"+t,{newId:e},function(e){console.log("Success marked off: "+t+", response "+JSON.stringify(e)),e&&e.signUp&&cleverapps.eventLogger.logEvent(cleverapps.EVENTS.SIGN_UP,{method:cleverapps.social.getCode()})},function(){console.log("Failed marking off: "+t)}),levels.user.setId(e),cleverapps.synchronizer.reset(),cleverapps.info.onChangeUserId()}else levels.user.id!==cleverapps.social.getUserID()&&(console.log("second login!"),cc.sys.isNative?levels.user.setId(cleverapps.social.getUserID()):(cleverapps.DataLoader.cleanAll(),window.location.reload()));cleverapps.DataLoader.processSaveQueue(),cleverapps.social.deleteAllRequests(),
cleverapps.synchronizer.syncWhenReady(),cleverapps.whenAllInitialized(this.onLoginRefreshes.bind(this))},onLoginRefreshes:function(){-1===["mobile_vk","web_vk","plinga"].indexOf(cleverapps.User.calcSource())&&cleverapps.Notification.create("messages:SocialManager.Connected"),cleverapps.social.aboutMe(this.onLoadUserInfo.bind(this)),cleverapps.localPushes.initSender(),cleverapps.user.calcIdfa(),cleverapps.friends.reload(),cleverapps.invitalbleFriends.reload()},onLoadUserInfo:function(n){if(cleverapps.friends.updatePlayerInfo(n),n.currency&&n.currency.user_currency){var e=n.currency.user_currency,t={USD:"$",EUR:"",GBP:""};t[e]&&(Product.CURRENCY=t[e],Product.CURRENCY_CODE=e)}if(n.first_name&&!cleverapps.flags.nologin&&setTimeout(function(){var e=void 0,t=cleverapps.friends.getPlayer();t.avatar&&t.avatar!==FriendsCache.DEFAULT_PLAYER_INFO().avatar&&((e=new cleverapps.UI.Avatar(t)).width&&e.height||(e=void 0)),cleverapps.Notification.create("messages:SocialManager.Welcome",{toReplace:{
userName:n.first_name},image:e})},1e3),n.name){var s=n.name.substr(0,50);cleverapps.info.setKeyValue("name",s)}n.picture&&n.picture.data&&n.picture.data.url&&cleverapps.info.setKeyValue("avatar",n.picture.data.url),cleverapps.periodicBonus&&cleverapps.periodicBonus.refreshItems()}},cleverapps.NK=function(){console.log("Choosing html5-nk"),cleverapps.Social.call(this)},cleverapps.NK.prototype=Object.create(cleverapps.Social.prototype),cleverapps.NK.prototype.constructor=cleverapps.NK,cleverapps.NK.prototype.getLocalStoragePreffix=function(){return"_NK"},cleverapps.NK.prototype.init=function(s){cleverapps.once(function(){NKOverrideRest();var e=opensocial.newDataRequest();e.add(e.newFetchPersonRequest(opensocial.IdSpec.PersonId.VIEWER),"request_id"),e.send(function(e){if(e.hadError());else{var t=e.get("request_id");if(t.hadError());else{var n=t.getData();this.user=cleverapps.NK.formatUserData(n),console.log(this.user),s()}}}.bind(this))}.bind(this))()},
cleverapps.NK.prototype.isLoggedIn=function(){return!0},cleverapps.NK.prototype.getUserID=function(){return this.user.id},cleverapps.NK.prototype.getAccessToken=function(){return"NK"},cleverapps.NK.prototype.login=function(e){e()},cleverapps.NK.prototype.inviteFriends=function(e,t){FullscreenControlButton.exitFullscreen(function(){nk.requestInviteFriends(e.message,{},function(e){e.hadError()?t(cleverapps.Social.CODE_CANCELLED,e):t(cleverapps.Social.CODE_SUCCEED)})})},cleverapps.NK.prototype.listFriendsByApp=function(e,n){var t=opensocial.newDataRequest();t.add(t.newFetchPersonRequest(opensocial.IdSpec.PersonId.VIEWER),"request_id");var s=opensocial.newIdSpec({userId:"VIEWER",groupId:"FRIENDS"});t.add(t.newFetchPeopleRequest(s,{max:1e3}),"another_id"),t.send(function(e){if(e.hadError())n(cleverapps.Social.CODE_FAILED);else{var t=e.get("another_id").getData().asArray();n(cleverapps.Social.CODE_SUCCEED,t.map(cleverapps.NK.formatUserData))}})},cleverapps.NK.formatUserData=function(e){
return{id:cleverapps.Social.prepareId(e.getId()),name:e.getDisplayName(),first_name:e.getDisplayName(),picture:{data:{url:e.getField(opensocial.Person.Field.THUMBNAIL_URL)}}}},cleverapps.NK.prototype.aboutMe=function(e){e(this.user)},cleverapps.NK.prototype.requestToOne=function(e,t,n){var s={title:t.title,type:"notification"},i=opensocial.newMessage(t.message,s);FullscreenControlButton.exitFullscreen(function(){opensocial.requestSendMessage([e],i,function(e){e.hadError()?(console.log("error",e),n(cleverapps.Social.CODE_FAILED)):(console.log("ok",e),n(cleverapps.Social.CODE_SUCCEED))})})},cleverapps.NK.prototype.request=function(e,n){var s=e.to;Array.isArray(s)||(s=[s]);var i=[],o=function(t){t===s.length?n(0<i.length?cleverapps.Social.CODE_SUCCEED:cleverapps.Social.CODE_CANCELLED,i):this.requestToOne(s[t],e,function(e){e===cleverapps.Social.CODE_SUCCEED&&i.push(s[t]),setTimeout(function(){o(t+1)},500)})}.bind(this);o(0)},cleverapps.NK.prototype.shareDialog=function(e,t){
var n=cleverapps.config.deployment+e.picture;0<=n.indexOf("?")&&(n=n.substr(0,n.indexOf("?")));var s=opensocial.newMediaItem("image",n);s.setField(opensocial.MediaItem.Field.TYPE,opensocial.MediaItem.Type.IMAGE);var i={};i[opensocial.Activity.Field.TITLE]=e.name,i[opensocial.Activity.Field.MEDIA_ITEMS]=[s];var o=opensocial.newActivity(i);FullscreenControlButton.exitFullscreen(function(){opensocial.requestCreateActivity(o,opensocial.CreateActivityPriority.HIGH,function(e){e.hadError()?(console.log("Share failed",e),t(cleverapps.Social.CODE_FAILED,e)):(console.log("Share ok"),t(cleverapps.Social.CODE_SUCCEED))})})},cleverapps.NK.prototype.joinGroup=function(n){var t=function(t){var e=opensocial.newDataRequest();e.add(nk.groups.newIsUserInAppGroupRequest(),"isInGroup"),e.send(function(e){e.hadError()?n(cleverapps.Social.CODE_FAILED):e.get("isInGroup").getData()?n(cleverapps.Social.CODE_SUCCEED):t?t():n(cleverapps.Social.CODE_FAILED)})},e=function(){nk.groups.requestAddUserToAppGroup(
function(e){e.hadError()&&n(cleverapps.Social.CODE_FAILED),t()})};FullscreenControlButton.exitFullscreen(function(){t(e)})},cleverapps.NK.prototype.listFriends=function(e){this.listFriendsByApp(!0,e)},cleverapps.NK.prototype.listInvitableFriends=function(e){e(cleverapps.Social.CODE_SUCCEED,[])},cleverapps.NK.isAppropriate=function(){return!cc.sys.isNative&&"nk"===cleverapps.User.calcSource()},cleverapps.NK.prototype.getDefaultLanguages=function(){return[cc.sys.LANGUAGE_POLISH]},cleverapps.FotoStrana=function(){console.log("Choosing fotostrana"),cleverapps.Social.call(this)},cleverapps.FotoStrana.prototype=Object.create(cleverapps.Social.prototype),cleverapps.FotoStrana.prototype.constructor=cleverapps.FotoStrana,cleverapps.FotoStrana.prototype.getLocalStoragePreffix=function(){return"_FS"},cleverapps.FotoStrana.prototype.init=function(e){var t=cleverapps.once(function(){e()}.bind(this)),n=function(e){t(),"timeout"===e?cleverapps.eventLogger.logEvent(cleverapps.EVENTS.FAKEFB_BY_TIMEOUT
):cleverapps.eventLogger.logEvent(cleverapps.EVENTS.FAKEFB_BY_SCRIPT_ERROR)}.bind(this),s=function(){window.FSClient=new fsapi(cleverapps.config.fotostrana.appId,cleverapps.config.fotostrana.privateKey),FSClient.init(function(){console.log("API Error!")}),t()}.bind(this);cleverapps.loadSdk(cleverapps.getRequestParameters().fsapi,{onSuccess:s,onFailure:n})},cleverapps.FotoStrana.prototype.isLoggedIn=function(){return!0},cleverapps.FotoStrana.prototype.fromSocialUserId=function(e){return"FS_"+e},cleverapps.FotoStrana.prototype.toSocialUserId=function(e){return e.substr(3)},cleverapps.FotoStrana.prototype.getUserID=function(){return this.fromSocialUserId(cleverapps.getRequestParameters().viewerId)},cleverapps.FotoStrana.prototype.getAccessToken=function(){return"FS_"+cleverapps.getRequestParameters().authKey},cleverapps.FotoStrana.prototype.login=function(e){e()},cleverapps.FotoStrana.prototype.inviteFriends=function(e,t){FullscreenControlButton.exitFullscreen(function(){FSClient.event(
"invite",function(e){t(e.send?cleverapps.Social.CODE_SUCCEED:cleverapps.Social.CODE_CANCELLED)})})},cleverapps.FotoStrana.prototype.request=function(e,t){"object"!=typeof e.to&&(e.to=[e.to]);var n=[];e.to.forEach(function(e){n.push(this.toSocialUserId(e))}.bind(this)),FullscreenControlButton.exitFullscreen(function(){FSClient.event("sendMessageAndInvite",function(e){t(e.messSent||e.invSent?cleverapps.Social.CODE_SUCCEED:cleverapps.Social.CODE_CANCELLED)},{message:e.message,customIds:n.join(",")})})},cleverapps.FotoStrana.prototype.shareDialog=function(e,t){var n=cleverapps.config.deployment+e.picture;0<=n.indexOf("?")&&(n=n.substr(0,n.indexOf("?"))),FullscreenControlButton.exitFullscreen(function(){FSClient.event("postUserEventOnWall",function(e){t("success"===e.result?cleverapps.Social.CODE_SUCCEED:cleverapps.Social.CODE_CANCELLED)},{title:e.title,text:e.description,imgUrl:n})})},cleverapps.FotoStrana.prototype.loadUsersData=function(e,s){e&&e.length?FSClient.api("User.getProfiles",{
userIds:e.join(","),fields:"user_name, user_lastname, photo_small"},function(e){var t=[];if(e.response){for(var n in e.response)t.push(this.formatUserData(e.response[n]));s(cleverapps.Social.CODE_SUCCEED,t)}else s(cleverapps.Social.CODE_FAILED,t)}.bind(this)):s(cleverapps.Social.CODE_CANCELLED,[])},cleverapps.FotoStrana.prototype.listFriends=function(t){FSClient.api("User.getAppFriends",{appId:cleverapps.config.fotostrana.appId,limit:500},function(e){this.loadUsersData(e.response,t)}.bind(this))},cleverapps.FotoStrana.prototype.listInvitableFriends=function(n){FSClient.api("User.getFriends",{limit:200},function(e){if(e.response&&e.response.length){var t=e.response;FSClient.api("User.getAppFriends",{appId:cleverapps.config.fotostrana.appId,limit:500},function(e){e.response&&e.response.length&&(t=cleverapps.substract(t,e.response)),this.loadUsersData(t,n)}.bind(this))}}.bind(this))},cleverapps.FotoStrana.prototype.formatUserData=function(e){return{id:this.fromSocialUserId(e.user_id),
name:e.user_name+" "+e.user_lastname,first_name:e.user_name,picture:{data:{url:e.photo_small}}}},cleverapps.FotoStrana.prototype.aboutMe=function(n){this.loadUsersData([this.toSocialUserId(this.getUserID())],function(e,t){e===cleverapps.Social.CODE_SUCCEED&&t.length&&n(t[0])})},cleverapps.FotoStrana.prototype.logEvent=function(e,t){},cleverapps.FotoStrana.prototype.getDefaultLanguages=function(){return[cc.sys.LANGUAGE_RUSSIAN]},cleverapps.FotoStrana.isAppropriate=function(){return!cc.sys.isNative&&"fotostrana"===cleverapps.User.calcSource()},cleverapps.Plinga=function(){console.log("Choosing Plinga"),cleverapps.Social.call(this),this.eventListener=function(){},(cleverapps.isLocalhost()||cleverapps.isStagingHost())&&cleverapps.extend(this,cleverapps.FakePlinga)},cleverapps.Plinga.prototype=Object.create(cleverapps.Social.prototype),cleverapps.Plinga.prototype.constructor=cleverapps.Plinga,cleverapps.Plinga.prototype.init=function(e){window.GD_OPTIONS={
gameId:cleverapps.config.plinga.appId,onEvent:function(e){switch(console.log("plinga event",JSON.stringify(e)),e.name){case"SDK_GAME_START":cc.director.resume();break;case"SDK_GAME_PAUSE":cc.director.pause()}this.eventListener(e)}.bind(this)};cleverapps.loadSdk("//html5.api.gamedistribution.com/main.min.js",{onSuccess:e,onFailure:function(){cleverapps.eventLogger.logEvent("plinga_init_error"),e()},crossorigin:!0})},cleverapps.Plinga.isAppropriate=function(){return!cc.sys.isNative&&"plinga"===cleverapps.User.calcSource()},cleverapps.Plinga.prototype.getLocalStoragePreffix=function(){return"_plinga"},cleverapps.FakePlinga={init:function(e){e()}},cleverapps.NoSocial=function(){console.log("Choosing without Social"),cleverapps.Social.call(this)},cleverapps.NoSocial.prototype=Object.create(cleverapps.Social.prototype),cleverapps.NoSocial.prototype.constructor=cleverapps.NoSocial,cleverapps.NoSocial.prototype.init=function(e){e()},cleverapps.NoSocial.isAppropriate=function(){
return cleverapps.flags.nosocial},cleverapps.NoSocial.prototype.getLocalStoragePreffix=function(){return"_nosocial"};var NKOverrideRest=function(){var d=cleverapps.RestClient.send;cleverapps.RestClient.send=function(e,t,n,s,i,o){if(-1!==t.indexOf("newsync"))return r=cleverapps.RestClient.getBase()+cleverapps.config.restApiURL+t,a=n,c=s,l=i,(p={})[gadgets.io.RequestParameters.METHOD]=gadgets.io.MethodType.PUT,p[gadgets.io.RequestParameters.AUTHORIZATION]=gadgets.io.AuthorizationType.SIGNED,p[gadgets.io.RequestParameters.CONTENT_TYPE]=gadgets.io.ContentType.JSON,p[gadgets.io.RequestParameters.POST_DATA]=JSON.stringify(a),p[gadgets.io.RequestParameters.HEADERS]={"Content-Type":"application/json"},void gadgets.io.makeRequest(r,function(e){if(e.text){var t=gadgets.json.parse(e.text);void 0!==t.error?l(t.error):c(t)}else l(e)},p);var r,a,c,l,p;d(e,t,n,s,i,o)}};if(cleverapps.Draugiem=function(){console.log("Choosing html5-draugiem"),cleverapps.Social.call(this)},
cleverapps.Draugiem.prototype=Object.create(cleverapps.Social.prototype),cleverapps.Draugiem.prototype.constructor=cleverapps.Draugiem,cleverapps.Draugiem.prototype.getLocalStoragePreffix=function(){return"_draugiem"},cleverapps.Draugiem.prototype.api=function(e,t,n){t.action=e,this.accessToken&&(t.apikey=this.accessToken),cleverapps.RestClient.post("/draugiem",t,function(e){e.error?(console.log("Error response: ",e),n(cleverapps.Social.CODE_FAILED,e)):(console.log("Success api response: ",e),n(cleverapps.Social.CODE_SUCCEED,e))})},cleverapps.Draugiem.prototype.init=function(r){var e=function(){draugiem_callback_url=cleverapps.config.deployment+"/cleverapps/res/callback-e75ca99e40-e75ca99e40.html",draugiem_domain="www.draugiem.lv";var i=function(e){this.accessToken=e,cleverapps.setUrlHash({saved_token:e}),this.api("userdata",{},function(e,t){this.user=cleverapps.Draugiem.formatUserData(cleverapps.values(t.users)[0]),r()}.bind(this))}.bind(this),o=cleverapps.getRequestParameters().dr_auth_code,
e=cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.DRAUGIEM_AUTH_DATA);e&&e.code===o?i(e.token):this.api("authorize",{code:o},function(e,t){if(t&&!t.error&&t.apikey)this.accessToken=t.apikey,this.user=cleverapps.Draugiem.formatUserData(t.users[t.uid]),cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.DRAUGIEM_AUTH_DATA,{code:o,token:this.accessToken}),cleverapps.setUrlHash({saved_token:this.accessToken});else{if(t&&t.error&&106===t.error.code){var n=cleverapps.getRequestParameters(window.location.hash).saved_token;if(n)return void i(n)}var s=JSON.stringify({arguments:arguments,auth_code:o});cleverapps.ReportStream.debug("draugiem authorize empty result "+s),this.user=cleverapps.Draugiem.formatUserData({uid:"1"})}r()}.bind(this))}.bind(this);cleverapps.loadSdk("//draugiem.lv/applications/external/draugiem.js",{onSuccess:e,onFailure:function(){console.log("Failed to load draugiem.js api")}})},cleverapps.Draugiem.prototype.isLoggedIn=function(){return!0},
cleverapps.Draugiem.prototype.getUserID=function(){return this.user.id},cleverapps.Draugiem.prototype.getAccessToken=function(){return"DRG_"+this.accessToken},cleverapps.Draugiem.prototype.login=function(e){e()},cleverapps.Draugiem.prototype.sendActivity=function(e,t){if(!(this.lastActivitySent&&Date.now()-this.lastActivitySent<cleverapps.parseInterval("1 day"))){var n=cleverapps.Social.ACTIVITIES_CONFIG[e];if(n.probability>Math.random()){var s=cleverapps.Random.mathChoose(n.messages),i={prefix:Messages.get(s.title),text:Messages.get(s.body,t),link:cleverapps.config.deployment};cleverapps.social.api("add_activity",i,function(e,t){t&&"OK"===t.status&&(this.lastActivitySent=Date.now())}.bind(this))}}},cleverapps.Draugiem.prototype.inviteFriends=function(e,t){draugiemSendInvite(e.message,"",function(e){t(e?cleverapps.Social.CODE_SUCCEED:cleverapps.Social.CODE_CANCELLED)})},cleverapps.Draugiem.prototype.requestToOne=function(n,s,i){FullscreenControlButton.exitFullscreen(function(){
var e=cleverapps.config.draugiem.url,t=s.message+"\n"+e;draugiemSendMessage(n,s.title,t,function(e){i(e?cleverapps.Social.CODE_SUCCEED:cleverapps.Social.CODE_FAILED)})})},cleverapps.Draugiem.prototype.request=function(e,n){var s=e.to;Array.isArray(s)||(s=[s]);var i=[],o=function(t){t===s.length?n(0<i.length?cleverapps.Social.CODE_SUCCEED:cleverapps.Social.CODE_CANCELLED,i):this.requestToOne(s[t],e,function(e){e===cleverapps.Social.CODE_SUCCEED&&i.push(s[t]),setTimeout(function(){o(t+1)},500)})}.bind(this);o(0)},cleverapps.Draugiem.prototype.shareDialog=function(t,n){FullscreenControlButton.exitFullscreen(function(){var e=cleverapps.config.draugiem.url;draugiemSay(t.name,e,Messages.get("PlayNow"),t.description,function(e){n(e?cleverapps.Social.CODE_SUCCEED:cleverapps.Social.CODE_FAILED)})})},cleverapps.Draugiem.prototype.listFriendsByApp=function(e,t){},cleverapps.Draugiem.prototype.listFriends=function(s){this.api("app_friends",{},function(e,t){if(e===cleverapps.Social.CODE_SUCCEED){
var n=[];0<t.total&&(n=cleverapps.values(t.users).map(cleverapps.Draugiem.formatUserData)),s(cleverapps.Social.CODE_SUCCEED,n)}else s(cleverapps.Social.CODE_FAILED)}.bind(this))},cleverapps.Draugiem.prototype.listInvitableFriends=function(e){e()},cleverapps.Draugiem.formatUserData=function(e){return{id:""+e.uid,name:e.surname+" "+e.name,first_name:e.name,picture:{data:{url:e.img}}}},cleverapps.Draugiem.prototype.aboutMe=function(e){e(this.user)},cleverapps.Draugiem.prototype.logEvent=function(e,t){},cleverapps.Draugiem.prototype.getDefaultLanguages=function(){return[cc.sys.LANGUAGE_LATVIAN,cc.sys.LANGUAGE_RUSSIAN]},cleverapps.Draugiem.isAppropriate=function(){return!cc.sys.isNative&&"draugiem"===cleverapps.User.calcSource()},cc.sys.LANGUAGE_LATVIAN="lv",cleverapps.Payments=function(){this.oncePaymentFinished=void 0},cleverapps.Payments.prototype.onPaymentFinished=function(){if(this.oncePaymentFinished){var e=this.oncePaymentFinished;delete this.oncePaymentFinished,e()}},
cleverapps.Payments.prototype.isProductsExists=function(e){return e.length===e.filter(function(e){return this.isProductExists(e)}.bind(this)).length},cleverapps.Payments.prototype.isProductExists=function(e){return cleverapps.config.products[e]},cleverapps.CompensatePayments=function(){cleverapps.Payments.call(this),this.compensateProductCode=void 0},cleverapps.CompensatePayments.prototype=Object.create(cleverapps.Payments.prototype),cleverapps.CompensatePayments.prototype.constructor=cleverapps.CompensatePayments,cleverapps.CompensatePayments.prototype.getMobile=function(){return 0},cleverapps.CompensatePayments.prototype.getBasePath=function(){return""},cleverapps.CompensatePayments.prototype.canCompensate=function(){return!1},cleverapps.CompensatePayments.prototype.stopCheckPayments=function(){this.checkPaymentTimeout&&(clearTimeout(this.checkPaymentTimeout),this.checkPaymentTimeout=void 0)},cleverapps.CompensatePayments.prototype.runCheckPayments=function(){var e=[].concat(
cleverapps.CompensatePayments.CHECK_TIMEOUTS),t=function(){this.stopCheckPayments(),e.length<cleverapps.CompensatePayments.CHECK_TIMEOUTS.length&&this.checkPayment(),0<e.length&&(this.checkPaymentTimeout=setTimeout(t,cleverapps.parseInterval(e.shift())))}.bind(this);t()},cleverapps.CompensatePayments.prototype.callPaymentCallback=function(e){this.paymentCallback&&(this.paymentCallback(cleverapps.Social.CODE_SUCCEED,e),this.paymentCallback=void 0)},cleverapps.CompensatePayments.prototype.checkPayment=function(){var e="/"+this.getBasePath()+"/check/"+this.getMobile()+"/"+levels.user.id;"subscription"===this.productType&&(e="/"+this.getBasePath()+"/checksubscription/"+levels.user.id);var t=function(e){"ok"===e&&(this.stopCheckPayments(),this.callPaymentCallback())}.bind(this);cleverapps.RestClient.get(e,{},t)},cleverapps.CompensatePayments.prototype.compensate=function(){if(!this.checkPaymentTimeout&&!this.compensateProductCode){var e="/"+this.getBasePath()+"/compensate/"+levels.user.id
;cleverapps.RestClient.get(e,{},function(e){"none"!==e&&(this.compensateProductCode=e)}.bind(this))}},cleverapps.CompensatePayments.prototype.validateByPath=function(t,e){if(!cleverapps.config.debugMode||!cleverapps.Tool.compensateCheck){t=cleverapps.once(t||function(){});var n=[].concat(cleverapps.CompensatePayments.VALIDATE_TIMEOUTS),s=void 0,i=function(){cleverapps.RestClient.get(e,{},function(e){"ok"===e&&(t(),clearTimeout(s))}),0<n.length&&(s=setTimeout(i,cleverapps.parseInterval(n.shift())))};i()}},cleverapps.CompensatePayments.prototype.open=function(e,t){},cleverapps.CompensatePayments.prototype.isAvailable=function(){return!0},cleverapps.CompensatePayments.prototype.logPurchase=function(e){},cleverapps.CompensatePayments.prototype.compensateValidate=function(e){this.getBasePath()?this.validateByPath(e,"/"+this.getBasePath()+"/compensatevalidate/"+levels.user.id):e()},cleverapps.CompensatePayments.prototype.validate=function(e,t){this.getBasePath()?this.validateByPath(t,
"/"+this.getBasePath()+"/validate/"+this.getMobile()+"/"+levels.user.id):t()},cleverapps.CompensatePayments.prototype.setPaymentChecked=function(){this.getBasePath()&&this.validateByPath(function(){},"/"+this.getBasePath()+"/check/"+this.getMobile()+"/"+levels.user.id)},cleverapps.CompensatePayments.CHECK_TIMEOUTS=["1 second","1 second","3 seconds","5 seconds","5 seconds","5 seconds","10 seconds","10 seconds","20 seconds","20 seconds","20 seconds","20 seconds","1 minute","1 minute","3 minutes","5 minutes","5 minutes"],cleverapps.CompensatePayments.VALIDATE_TIMEOUTS=["5 seconds","10 seconds","15 seconds","30 seconds","30 seconds","30 seconds","1 minute","1 minute","1 minute","5 minutes","5 minutes","5 minutes"],cleverapps.FakePayments=function(){cleverapps.Payments.call(this)},cleverapps.FakePayments.prototype=Object.create(cleverapps.Payments.prototype),cleverapps.FakePayments.prototype.constructor=cleverapps.FakePayments,cleverapps.FakePayments.prototype.open=function(e,t){setTimeout(
function(){confirm(Messages.get("FakePayments.Buying")+" "+e.title+" for "+e.price)?setTimeout(function(){t(cleverapps.Social.CODE_SUCCEED)},cleverapps.FakePayments.PROCESS_TIMEOUT):setTimeout(function(){console.log(Messages.get("FakePayments.Cancelled")),t(cleverapps.Social.CODE_CANCELLED)},cleverapps.FakePayments.PROCESS_TIMEOUT)},1e3)},cleverapps.FakePayments.prototype.isAvailable=function(){return!0},cleverapps.FakePayments.isAppropriate=function(){return!!cleverapps.isLocalhost()},cleverapps.FakePayments.prototype.validate=function(e,t){t&&t()},cleverapps.FakePayments.prototype.logPurchase=function(e){},cleverapps.FakePayments.prototype.restore=function(e){setTimeout(function(){e&&e(!0)},1e3)},cleverapps.FakePayments.PROCESS_TIMEOUT=0,cleverapps.InstantPayments=function(){this.ready=!1,this.consumed={},this.load(),cleverapps.social.whenInitialized("instantpayments",function(){var e=FBInstant.getSupportedAPIs();console.log("Searching payments.purchaseAsync",e),-1!==e.indexOf(
"payments.purchaseAsync")&&(console.log("Found payments.purchaseAsync support!"),FBInstant.payments.onReady(function(){console.log("Payments ready!"),this.ready=!0,this.loadProducts(),cleverapps.flags.update(),cleverapps.values(this.onAvailableListeners).forEach(cleverapps.callFunc)}.bind(this)))}.bind(this)),this.onAvailableListeners={}},cleverapps.InstantPayments.prototype.load=function(){var e=cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.INSTANT_PAYMENTS);e&&e.consumed&&(this.consumed=e.consumed)},cleverapps.InstantPayments.prototype.save=function(){cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.INSTANT_PAYMENTS,{consumed:this.consumed})},cleverapps.InstantPayments.prototype.open=function(n,s){if(this.isAvailable()){var e=function(e){console.log("success purchase",e),n.signedRequest=e.signedRequest,cleverapps.eventLogger.logEvent(cleverapps.EVENTS.INSTANT_PAYMENT+"ok"),s(cleverapps.Social.CODE_SUCCEED,n),this.consumePurchase(e)}.bind(this),t=function(e){console.log(
"error purchase",e);var t=cleverapps.Social.CODE_FAILED;e&&"USER_INPUT"===e.code&&(t=cleverapps.Social.CODE_CANCELLED),cleverapps.eventLogger.logEvent(cleverapps.EVENTS.INSTANT_PAYMENT+(t===cleverapps.Social.CODE_CANCELLED?"cancel":"error")),s(t,n)}.bind(this);FBInstant.payments.purchaseAsync({productID:n.id.instant}).then(e).catch(t)}else s(cleverapps.Social.CODE_FAILED,n,"messages:InstantPayments.NotAvailable")},cleverapps.InstantPayments.prototype.logPayment=function(e){var t="ok";e&&(t="error"),e&&"USER_INPUT"===e.code&&(t="canceled"),cleverapps.eventLogger.logEvent(cleverapps.EVENTS.INSTANT_PAYMENT+t)},cleverapps.InstantPayments.prototype.isAvailable=function(){return-1!==["1832499670188919","1887333567973110","1920167364724450","2076714912381045","2585442014807608"].indexOf(cleverapps.user.id)||this.ready},cleverapps.InstantPayments.isAppropriate=function(){return cleverapps.isInstant()},cleverapps.InstantPayments.prototype.getProductByInstantId=function(e){for(
var t in cleverapps.config.products){var n=cleverapps.config.products[t];if(e===n.id.instant)return n}},cleverapps.InstantPayments.prototype.loadProducts=function(){FBInstant.payments.getCatalogAsync().then(function(e){console.log(e),e.forEach(function(e){var t=this.getProductByInstantId(e.productID);t&&(t.loadedPrice=e.price)},this)}.bind(this))},cleverapps.InstantPayments.prototype.consumePurchase=function(e){var t=this.getProductByInstantId(e.productID),n={userId:cleverapps.user.id,purchase:e,productCode:e.productID,status:""};t&&(n.price=t.price,n.textPrice=t.loadedPrice,n.productCode=t.key),cleverapps.RestClient.post("/instantpayments/addpayment/",n);FBInstant.payments.consumePurchaseAsync(e.purchaseToken).then(function(){console.log("consume success",e),cleverapps.eventLogger.logEvent(cleverapps.EVENTS.INSTANT_CONSUME+"ok"),n.status="consumed",cleverapps.RestClient.post("/instantpayments/addpayment/",n)}).catch(function(e){console.log("consume error",e),
cleverapps.eventLogger.logEvent(cleverapps.EVENTS.INSTANT_CONSUME+"error"),n.error=e,n.status="consume_error",cleverapps.RestClient.post("/instantpayments/addpayment/",n)}),this.consumed[e.paymentID]=!0,this.save()},cleverapps.InstantPayments.prototype.validate=function(e,t,n){var s={signedRequest:e.signedRequest,userId:cleverapps.user.id};cleverapps.RestClient.post("/instantpayments/validate/",s,function(e){"ok"===e?(t(),console.log("Purchase validation success")):(n&&n(),console.log("Purchase validation error",e))})},cleverapps.InstantPayments.prototype.canCompensate=function(){return!0},cleverapps.InstantPayments.prototype.compensate=function(){if(!this.compensateProductCode&&!this.compensateRunning){this.compensateRunning=!0;var e=function(e){if(0!==(e=e.filter(function(e){var t=!this.consumed[e.paymentID]&&this.getProductByInstantId(e.productID);return t||this.consumePurchase(e),t},this)).length){var t=e[0];console.log("compensate validate purchase",t);var n=function(){
console.log("compensate validate purchase success"),this.compensateRunning=!1,this.compensatePurchase=t,this.compensateProductCode=this.getProductByInstantId(t.productID).key}.bind(this),s=function(){console.log("compensate validate purchase error"),this.compensateRunning=!1,this.consumed[t.paymentID]=!0,this.save()}.bind(this);this.validate(t,n,s)}else this.compensateRunning=!1}.bind(this),t=function(e){this.compensateRunning=!1,console.log("error getPurchasesAsync",e)}.bind(this);FBInstant.payments.getPurchasesAsync().then(e).catch(t)}},cleverapps.InstantPayments.prototype.compensateValidate=function(e){var t=this.compensatePurchase;t&&(delete this.compensatePurchase,e(),this.consumePurchase(t))},cleverapps.InstantPayments.prototype.logPurchase=function(e){},cleverapps.MobagePayments=function(){for(var e in cleverapps.config.products){var t=cleverapps.config.products[e];t.loadedPrice=cleverapps.MobagePayments.calcLoadedPrice(t.price)}},
cleverapps.MobagePayments.prototype.calcLoadedPrice=function(e){return cleverapps.MobagePayments.calcLoadedPrice(e)},cleverapps.MobagePayments.calcLoadedPrice=function(e){var t=100;return-1!==cleverapps.MobagePayments.TESTER_IDS.indexOf(cleverapps.user.id)&&(t=1),cleverapps.formatAmount(Math.ceil(e*t))+" MC"},cleverapps.MobagePayments.prototype.getSKU=function(e){var t=0;for(var n in cleverapps.PaymentsManager.PRODUCTS)if(t++,n===e.itemId)return t},cleverapps.MobagePayments.prototype.open=function(e,n){var t={};t[opensocial.BillingItem.Field.SKU_ID]=this.getSKU(e),t[opensocial.BillingItem.Field.PRICE]=parseInt(e.loadedPrice.replace(" ","")),t[opensocial.BillingItem.Field.COUNT]=1,t[mbga.BillingItem.Field.NAME]=e.description,t[mbga.BillingItem.Field.IMAGE_URL]=cleverapps.config.deployment.replace("https","http")+e.image;var s=opensocial.newBillingItem(t),i={};i[opensocial.Payment.Field.ITEMS]=[s],
i[opensocial.Payment.Field.AMOUNT]=t[opensocial.BillingItem.Field.PRICE]*t[opensocial.BillingItem.Field.COUNT];var o=opensocial.newPayment(i);FullscreenControlButton.exitFullscreen(function(){opensocial.requestPayment(o,function(e){if(e.hadError())n(cleverapps.Social.CODE_FAILED,e);else{var t=e.getData();n(cleverapps.Social.CODE_SUCCEED,t)}})})},cleverapps.MobagePayments.prototype.isAvailable=function(){return!0},cleverapps.MobagePayments.isAppropriate=function(){return cleverapps.Mobage.isAppropriate()},cleverapps.MobagePayments.prototype.validate=function(e,t){t&&t()},cleverapps.MobagePayments.prototype.logPurchase=function(e){},cleverapps.MobagePayments.TESTER_IDS=["mbga.jp:155776208"],cleverapps.VKPayments=function(){for(var e in cleverapps.config.products){var t=cleverapps.config.products[e];t.loadedPrice=this.calcLoadedPrice(t.price)}this.paymentHandler=function(e){},cleverapps.social.whenInitialized("vkpayments",this.init.bind(this))},
cleverapps.VKPayments.prototype.calcLoadedPrice=function(e){return Math.round(21*e)+" "},cleverapps.VKPayments.prototype.init=function(){VK.addCallback("onOrderSuccess",function(e){this.paymentHandler(cleverapps.Social.CODE_SUCCEED,e)}.bind(this)),VK.addCallback("onOrderCancel",function(){this.paymentHandler(cleverapps.Social.CODE_CANCELLED)}.bind(this)),VK.addCallback("onOrderFail",function(e){this.paymentHandler(cleverapps.Social.CODE_FAILED,e)}.bind(this))},cleverapps.VKPayments.prototype.open=function(e,n){this.paymentHandler=function(e,t){e===cleverapps.Social.CODE_FAILED?(console.log(t),n(cleverapps.Social.CODE_FAILED,t)):e===cleverapps.Social.CODE_SUCCEED&&n(cleverapps.Social.CODE_SUCCEED,t)};var t={type:"item",item:e.itemId};FullscreenControlButton.exitFullscreen(function(){VK.callMethod("showOrderBox",t)})},cleverapps.VKPayments.prototype.isAvailable=function(){return!0},cleverapps.VKPayments.isAppropriate=function(){return cleverapps.VK.isAppropriate()},
cleverapps.VKPayments.prototype.validate=function(e,t){cleverapps.RestClient.post("/vkpayments/check/",{orderId:e},function(e){"ok"===e&&t&&t()})},cleverapps.VKPayments.prototype.logPurchase=function(e){},cleverapps.MobileVkPayments=function(){for(var e in cleverapps.config.products){var t=cleverapps.config.products[e];t.loadedPrice=this.calcLoadedPrice(t.price)}},cleverapps.MobileVkPayments.prototype.calcLoadedPrice=function(e){return Math.round(21*e)+" "},cleverapps.MobileVkPayments.prototype.open=function(e,t){this.isAvailable()?cleverapps.social.showOrderBox({type:"item",item:e.itemId},function(e){e===cleverapps.Social.CODE_SUCCEED&&t(cleverapps.Social.CODE_SUCCEED)}):t(cleverapps.Social.CODE_FAILED,e,"messages:InstantPayments.NotAvailable")},cleverapps.MobileVkPayments.prototype.isAvailable=function(){return"html5_ios"!==cleverapps.MobileVk.getPlatfrom()},cleverapps.MobileVkPayments.isAppropriate=function(){return cleverapps.MobileVk.isAppropriate()},
cleverapps.MobileVkPayments.prototype.validate=function(e,t){cleverapps.RestClient.post("/vkpayments/mobile/",{userId:cleverapps.user.id},function(e){"ok"===e&&t&&t()})},cleverapps.MobileVkPayments.prototype.logPurchase=function(e){},cleverapps.MyMailRuPayments=function(){for(var e in cleverapps.config.products){var t=cleverapps.config.products[e];t.loadedPrice=this.calcLoadedPrice(t.price)}cleverapps.social.whenInitialized("mymailrupayments",this.init.bind(this))},cleverapps.MyMailRuPayments.prototype.init=function(){this instanceof cleverapps.MobileMyMailRuPayments||(this.listeners={status:function(){},income:function(){}},mailru.events.listen(mailru.app.events.paymentDialogStatus,function(e){this.listeners.status(e)}.bind(this)),mailru.events.listen(mailru.app.events.incomingPayment,function(e){this.listeners.income(e)}.bind(this)))},cleverapps.MyMailRuPayments.prototype.calcLoadedPrice=function(e){return Math.floor(20*e)+" "},
cleverapps.MyMailRuPayments.prototype.checkPayment=function(t){cleverapps.RestClient.get("/mmrupayments/check/"+levels.user.id,{},function(e){"ok"===e&&t()})},cleverapps.MyMailRuPayments.prototype.processPayment=function(){cleverapps.RestClient.get("/mmrupayments/close/"+levels.user.id,{},function(){})},cleverapps.MyMailRuPayments.prototype.open=function(e,t){this.listeners.status=function(e){console.log("PAYMENT DIALOG",e)},this.listeners.income=function(e){console.log("INCOM",e),"success"===e.status?(t(cleverapps.Social.CODE_SUCCEED),this.processPayment()):t(cleverapps.Social.CODE_CANCELLED)}.bind(this),FullscreenControlButton.exitFullscreen(function(){mailru.app.payments.showDialog({service_id:e.id.mymailru,service_name:e.title,mailiki_price:parseInt(e.loadedPrice)})})},cleverapps.MyMailRuPayments.prototype.isAvailable=function(){return!0},cleverapps.MyMailRuPayments.isAppropriate=function(){return cleverapps.MyMailRu.isAppropriate()},
cleverapps.MyMailRuPayments.prototype.validate=function(e,t){t&&t()},cleverapps.MyMailRuPayments.prototype.logPurchase=function(e){},cleverapps.MobileMyMailRuPayments=function(){cleverapps.MyMailRuPayments.call(this)},cleverapps.MobileMyMailRuPayments.prototype=Object.create(cleverapps.MyMailRuPayments.prototype),cleverapps.MobileMyMailRuPayments.prototype.constructor=cleverapps.MobileMyMailRuPayments,cleverapps.MobileMyMailRuPayments.prototype.runChecker=function(e){var t,n=0,s=function(){"16111471373067017624"===cleverapps.user.id&&cleverapps.ReportStream.send("mmdebug","close popup "+JSON.stringify((new Error).stack)),cleverapps.MobileMyMailRu.widgetWindow&&(cleverapps.MobileMyMailRu.widgetWindow.close(),cleverapps.MobileMyMailRu.widgetWindow=void 0),clearInterval(t)};t=setInterval(function(){3600<++n&&("16111471373067017624"===cleverapps.user.id&&cleverapps.ReportStream.send("mmdebug","close popup uid"),s());try{
cleverapps.MobileMyMailRu.widgetWindow.location&&cleverapps.MobileMyMailRu.widgetWindow.location.href&&0<=cleverapps.MobileMyMailRu.widgetWindow.location.href.indexOf("vid=")&&("16111471373067017624"===cleverapps.user.id&&cleverapps.ReportStream.send("mmdebug","close by href "+cleverapps.MobileMyMailRu.widgetWindow.location.href),s(),n=0)}catch(e){}n%3==0&&this.checkPayment(function(){this.processPayment(),e(cleverapps.Social.CODE_SUCCEED),e=function(){},s()}.bind(this))}.bind(this),500)},cleverapps.MobileMyMailRuPayments.prototype.open=function(e,t){this.processPayment();var n=cleverapps.social.getRequestParameters(),s={appid:cleverapps.config.myMailRu.appId,session_key:n.session_key,service_id:e.id.mymailru,service_name:e.title,mailiki_price:parseInt(e.loadedPrice),mob:1},i=[];for(var o in s)if(s.hasOwnProperty(o))if("service_name"===o){var r=o+"="+s[o].split("").map(function(e){return e.match(/[-]/i)?e:encodeURIComponent(e)}).join("");i.push(r)}else i.push(
o+"="+encodeURIComponent(s[o]));i="http://m.my.mail.ru/cgi-bin/app/paymentm?"+i.join("&"),cleverapps.MobileMyMailRu.widgetWindow=window.open(i),this.runChecker(t),"16111471373067017624"===cleverapps.user.id&&(cleverapps.ReportStream.send("mmdebug","open mobile payment "+i),cleverapps.ReportStream.send("mmdebug","is window null - "+!cleverapps.MobileMyMailRu.widgetWindow))},cleverapps.MobileMyMailRuPayments.isAppropriate=function(){return"16111471373067017624"===cleverapps.user.id&&cleverapps.ReportStream.send("mmdebug","source"+cleverapps.User.calcSource()),cleverapps.MobileMyMailRu.isAppropriate()},cleverapps.OKPayments=function(){for(var e in cleverapps.CompensatePayments.call(this),cleverapps.config.products){var t=cleverapps.config.products[e];t.loadedPrice=this.calcLoadedPrice(t.price)}},cleverapps.OKPayments.prototype=Object.create(cleverapps.CompensatePayments.prototype),cleverapps.OKPayments.prototype.constructor=cleverapps.OKPayments,
cleverapps.OKPayments.prototype.calcLoadedPrice=function(e){var t=-1!==["580731438762","577203420866","585959187481","576593702177","8593874","573573968467","578403383621","573870870859","583443371977"].indexOf(cleverapps.user.id),n=Math.floor(20*e)+" OK";return cleverapps.config.debugMode&&t&&(n=Math.max(1,Math.round(e/3))+" OK"),n},cleverapps.OKPayments.prototype.open=function(e,t){FAPI!==cleverapps.FakeFAPI?"subscription"!==e.type?(this.paymentCallback=t,this.productType=e.type,this.runCheckPayments(),cleverapps.social.listeners.showPayment=function(e){e===cleverapps.OK.CODE_SUCCEED&&(this.checkPayment(),this.callPaymentCallback())}.bind(this),FullscreenControlButton.exitFullscreen(function(){FAPI.UI.showPayment(e.description,e.title,e.itemId,parseInt(e.loadedPrice),null,JSON.stringify({type:this.getMobile()?"mobile":"social"}),"ok","true")}.bind(this))):this.openSubscription(e,t):t(cleverapps.Social.CODE_CANCELLED)},cleverapps.OKPayments.prototype.getBasePath=function(){
return"okpayments"},cleverapps.OKPayments.prototype.canCompensate=function(){return!0},cleverapps.OKPayments.prototype.openSubscription=function(e,t){this.paymentCallback=t,this.productType=e.type,this.runCheckPayments(),FullscreenControlButton.exitFullscreen(function(){FAPI.invokeUIMethod("showPaymentSubscription",e.id.ok,parseInt(e.loadedPrice))})},cleverapps.OKPayments.prototype.isAvailable=function(){return!0},cleverapps.OKPayments.isAppropriate=function(){return cleverapps.OK.isAppropriate()},cleverapps.OKPayments.prototype.logPurchase=function(e){},cleverapps.MobileOKPayments=function(){cleverapps.OKPayments.call(this)},cleverapps.MobileOKPayments.prototype=Object.create(cleverapps.OKPayments.prototype),cleverapps.MobileOKPayments.prototype.constructor=cleverapps.MobileOKPayments,cleverapps.MobileOKPayments.prototype.getMobile=function(){return 1},cleverapps.MobileOKPayments.isAppropriate=function(){return cleverapps.MobileOK.isAppropriate()},cleverapps.NoPayments=function(){
cleverapps.CompensatePayments.call(this)},cleverapps.NoPayments.prototype=Object.create(cleverapps.CompensatePayments.prototype),cleverapps.NoPayments.prototype.constructor=cleverapps.NoPayments,cleverapps.NoPayments.isAppropriate=function(){return-1!==["huzcom","plinga","pliega"].indexOf(cleverapps.User.calcSource())},cleverapps.NoPayments.prototype.isAvailable=function(){return!1},cleverapps.SPMobagePayments=function(){for(var e in cleverapps.config.products){var t=cleverapps.config.products[e];t.loadedPrice=cleverapps.MobagePayments.calcLoadedPrice(t.price)}},cleverapps.SPMobagePayments.calcLoadedPrice=function(e){return cleverapps.MobagePayments.calcLoadedPrice(e)},cleverapps.SPMobagePayments.prototype.getSKU=function(e){var t=0;for(var n in cleverapps.PaymentsManager.PRODUCTS)if(t++,n===e.itemId)return t},cleverapps.SPMobagePayments.prototype.open=function(e,s){cleverapps.metha.display({focus:"SPMobagePaymentsOpen",action:function(e){var t=new WaitWindow,n=t.createListener(
t.close.bind(t,[!0]));setTimeout(n,4e3);var s=mobage.event.subscribe("modal.afterOpen",function(){n(),mobage.event.unsubscribe(s)});cleverapps.metha.onceNoWindowsListener=e}});var t=function(n){mobage.ui.open("payment",{transactionId:n.transactionId,orderId:n.orderId},function(e,t){e?(this.reportPaymentResult(n,e),mobage.bank.clearPaymentBacklog(n.transactionId),s(cleverapps.Social.CODE_FAILED,t)):(this.reportPaymentResult(n),s(cleverapps.Social.CODE_SUCCEED,t))}.bind(this))}.bind(this);this.createTransaction(e,t)},cleverapps.SPMobagePayments.prototype.createTransaction=function(s,i){var e=function(){var e={userId:levels.user.id.substring(levels.user.id.indexOf(":")+1),id:this.getSKU(s),name:s.title,price:parseInt(s.loadedPrice.replace("MC","").replace(" ","")),description:"ja"===cleverapps.settings.language?s.description:s.description.substring(0,s.description.lastIndexOf("!")),imageUrl:cleverapps.config.deployment.replace("https","http")+s.image,
accessToken:cleverapps.social.clientData.token.accessToken},t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n+"="+e[n]);cleverapps.RestClient.get("/spmbgapayments?"+t.join("&"),{},function(e){i(e)}.bind(this))}.bind(this);cleverapps.social.checkAccessToken(e)},cleverapps.SPMobagePayments.prototype.reportPaymentResult=function(e,t){var n={orderId:e.orderId,transactionId:e.transactionId};t&&(n.error=!0);var s=[];for(var i in n)n.hasOwnProperty(i)&&s.push(i+"="+n[i]);cleverapps.RestClient.post("/spmbgapayments/old?"+s.join("&"),{},function(e){e&&e.transactionId&&mobage.bank.clearPaymentBacklog(e.transactionId)}.bind(this))},cleverapps.SPMobagePayments.prototype.isAvailable=function(){return!0},cleverapps.SPMobagePayments.isAppropriate=function(){return cleverapps.SPMobage.isAppropriate()},cleverapps.SPMobagePayments.prototype.validate=function(e,t){t&&t()},cleverapps.SPMobagePayments.prototype.logPurchase=function(e){},cleverapps.FacebookPayments=function(){
cleverapps.CompensatePayments.call(this),cleverapps.CompensatePayments.CHECK_TIMEOUTS=["5 second","5 second","5 seconds","5 seconds","10 seconds","10 seconds"],cleverapps.CompensatePayments.VALIDATE_TIMEOUTS=["1 second","1 second","1 second","1 second","1 second","3 seconds","5 seconds","5 seconds","5 seconds","10 seconds","15 seconds","30 seconds","30 seconds","30 seconds"]},cleverapps.FacebookPayments.prototype=Object.create(cleverapps.CompensatePayments.prototype),cleverapps.FacebookPayments.prototype.constructor=cleverapps.FacebookPayments,cleverapps.FacebookPayments.UserCanceled=1383010,cleverapps.FacebookPayments.SuccessStatuses=["completed","active"],cleverapps.FacebookPayments.prototype.getBasePath=function(){return"fbpayments"},cleverapps.FacebookPayments.prototype.canCompensate=function(){return!0},cleverapps.FacebookPayments.prototype.open=function(n,s){var i=cleverapps.once(s),o=cleverapps.once(s);s=function(e,t){cleverapps.Social.CODE_SUCCEED===e?i(e,t):o(e,t)},
this.paymentCallback=s,this.productType=n.type;var e={product:n.id.facebook,type:n.type};"subscription"===n.type?e.action="create_subscription":this.runCheckPayments(),FullscreenControlButton.exitFullscreen(function(){plugin.FacebookAgent.getInstance().canvas.pay(e,function(e,t){e===cleverapps.FacebookPayments.UserCanceled?(console.log("Payment "+n.itemId+" error "+t.error_message),s(cleverapps.Social.CODE_CANCELLED,t)):t&&-1===cleverapps.FacebookPayments.SuccessStatuses.indexOf(t.status)?(console.log("Payment "+n.itemId+" status: ",t.status),s(cleverapps.Social.CODE_CANCELLED,t)):(this.setPaymentChecked(),this.stopCheckPayments(),this.callPaymentCallback(t))}.bind(this))}.bind(this))},cleverapps.FacebookPayments.prototype.reactivateSubscription=function(e,t){t=t||function(){},plugin.FacebookAgent.getInstance().canvas.pay({action:"reactivate_subscription",subscription_id:e},function(e){e===cleverapps.FacebookPayments.UserCanceled&&(e=cleverapps.Social.CODE_CANCELLED),t(e)})},
cleverapps.FacebookPayments.prototype.cancelSubscription=function(e,t){t=t||function(){},plugin.FacebookAgent.getInstance().canvas.pay({action:"cancel_subscription",subscription_id:e},function(e){e===cleverapps.FacebookPayments.UserCanceled&&(e=cleverapps.Social.CODE_CANCELLED),t(e)})},cleverapps.FacebookPayments.prototype.isAvailable=function(){return!0},cleverapps.FacebookPayments.isAppropriate=function(){return!cc.sys.isNative},cleverapps.FacebookPayments.prototype.logPurchase=function(e){},cleverapps.FotoStranaPayments=function(){for(var e in cleverapps.config.products){var t=cleverapps.config.products[e];t.loadedPrice=this.calcLoadedPrice(t.price)}},cleverapps.FotoStranaPayments.prototype.calcLoadedPrice=function(e){return(e+" ").replace(".",",")},cleverapps.FotoStranaPayments.prototype.open=function(e,t){var n=["FS_113127743","FS_76785158","FS_113139157","FS_113139202"].indexOf(cleverapps.user.id)?1:0;t=cleverapps.once(t),FSClient.event("buyItemCallback",function(e){t(
"success"===e.result?cleverapps.Social.CODE_SUCCEED:cleverapps.Social.CODE_CANCELLED)},{itemId:e.id.mymailru,name:e.description,forwardData:e.itemId,picUrl:cleverapps.config.deployment+e.image.replace("fbproducts","fsproducts"),priceFmCents:Math.floor(100*e.price),isDebug:n})},cleverapps.FotoStranaPayments.prototype.isAvailable=function(){return!0},cleverapps.FotoStranaPayments.prototype.validate=function(e,t){t&&t()},cleverapps.FotoStranaPayments.isAppropriate=function(){return cleverapps.FotoStrana.isAppropriate()},cleverapps.FotoStranaPayments.prototype.logPurchase=function(e){},cleverapps.IAPWebViewPayments=function(){cleverapps.Payments.call(this),cc.sys.os===cc.sys.OS_IOS&&(PurchasesPlugin=cleverapps.IOSWebViewPurchasesPluginAdapter),PurchasesPlugin.init(),cc.eventManager.addCustomListener(cc.game.EVENT_SHOW,this.checkInitialized.bind(this)),setInterval(this.checkInitialized.bind(this),cleverapps.parseInterval("2 minutes")),this.startTime=Date.now(),
this.purchaseCallback=function(){}},cleverapps.IAPWebViewPayments.prototype=Object.create(cleverapps.Payments.prototype),cleverapps.IAPWebViewPayments.prototype.constructor=cleverapps.IAPWebViewPayments,cleverapps.IAPWebViewPayments.prototype.checkInitialized=cleverapps.timeredThrottle(1e3,function(){this.initialized?this.refreshed?this.refreshedSubscriptions?this.refreshedSubscriptionsTokens?this.requestedStoreProduct||this.requestStoreProduct():this.refreshSubscriptionsTokens():PurchasesPlugin.refresh("subscription"):PurchasesPlugin.refresh("consumable"):PurchasesPlugin.init()}),cleverapps.IAPWebViewPayments.prototype.requestStoreProduct=function(){PurchasesPlugin.requestStoreProduct&&PurchasesPlugin.requestStoreProduct(),console.log("IAPWebViewPayments.requestStoreProduct"),this.requestedStoreProduct=!0},cleverapps.IAPWebViewPayments.prototype.onRequestStoreProduct=function(e){this.storeProductName=e,console.log("IAPWebViewPayments.onRequestStoreProduct - "+e),this.checkInitialized(
),this.buyStoreProduct()},cleverapps.IAPWebViewPayments.prototype.buyStoreProduct=function(){if(this.storeProductName&&!cleverapps.metha.isFocused()){var t=this.findProductByName(this.storeProductName);delete this.storeProductName,t&&cleverapps.metha.display({focus:"buyStoreProduct",action:function(e){cleverapps.payments.oncePaymentFinished=e,(t=Product.Create(t.key)).buy()}})}},cleverapps.IAPWebViewPayments.prototype.refreshSubscriptionsTokens=function(){if(void 0!==PurchasesPlugin.getSubscriptionsTokens&&cleverapps.subscription){var e=decodeWebViewData(PurchasesPlugin.getSubscriptionsTokens());if(e.error)return void console.log("IAPWebViewPayments.refreshSubscriptionsTokens error "+e.error);cleverapps.subscription.addPurchaseTokens(e)}this.refreshedSubscriptionsTokens=!0,this.checkInitialized()},cleverapps.IAPWebViewPayments.prototype.addSubscriptionTokens=function(e,t){Array.isArray(e)||(e=[e]);var s=cleverapps.User.calcSource();if(-1!==["android","ios"].indexOf(s
)&&cleverapps.subscription){var n=e.map(function(e){var t=this.findProductByName(e.name);if(t&&"subscription"===t.type){var n={name:e.name};return"android"===s?(n.purchaseToken=e.receipt.purchaseToken,n.packageName=e.receipt.packageName,n.productId=e.receipt.productId):(n.purchaseToken=e.receipt,n.packageName=e.packageName,n.productId=e.productId),n}}.bind(this)).filter(function(e){return e});0<n.length&&cleverapps.subscription.addPurchaseTokens(n,t)}},cleverapps.IAPWebViewPayments.prototype.onRestoreSuccess=function(e){e=decodeWebViewData(e),console.log("IAPWebViewPayments.onRestoreSuccess"+e.length,e),e=JSON.parse(e),this.restoreCallback&&(this.restoreCallback(cleverapps.Social.CODE_SUCCEED),delete this.restoreCallback),this.addSubscriptionTokens(e,!0)},cleverapps.IAPWebViewPayments.prototype.onPurchaseSuccess=function(e){cleverapps.playSession.set(cleverapps.EVENTS.PAYMENT_SUCCESS,!0),e=decodeWebViewData(e),console.log("IAPWebViewPayments.onPurchaseSuccess",e),e=JSON.parse(e),
this.addSubscriptionTokens(e),this.purchaseCallback(cleverapps.Social.CODE_SUCCEED,e)},cleverapps.IAPWebViewPayments.prototype.logError=function(t,n){if(console.log("IAPWebViewPayments."+t,n),n){var e=function(e){cleverapps.throwAsync(t+" "+e+" "+n)};-1!==n.indexOf("client is null or not ready")?e(0):"service timeout"===n?e(1):"feature not support"===n?e(2):"service disconnected"===n?e(3):"user canceled"===n?e(4):"service unavailable"===n?e(5):"billing unavailable"===n?e(6):"item unavailable"===n?e(7):"developer error"===n?e(8):"item already owned"===n?e(9):"item not owned"===n?e(10):-1!==n.indexOf("cant find product:")?e(11):-1!==n.indexOf("cant find sku details:")?e(12):e("transaction failed"===n?13:"network unreachable"===n?14:"unknown error"===n?15:"client is not allowed to issue the request"===n?16:"purchase identifier was invalid"===n?17:"this device is not allowed to make the payment"===n?18:19)}},cleverapps.IAPWebViewPayments.prototype.onPurchaseFailure=function(e){
cleverapps.playSession.set(cleverapps.EVENTS.PAYMENT_FAILURE,!0),this.logError("onPurchaseFailure",decodeWebViewData(e)),this.purchaseCallback(cleverapps.Social.CODE_FAILED)},cleverapps.IAPWebViewPayments.prototype.onRestoreFailure=function(e){this.restoreCallback&&(this.restoreCallback(cleverapps.Social.CODE_FAILED),delete this.restoreCallback),console.log("IAPWebViewPayments.onRestoreFailure",decodeWebViewData(e))},cleverapps.IAPWebViewPayments.prototype.onPurchaseCancelled=function(){cleverapps.playSession.set(cleverapps.EVENTS.PAYMENT_CANCEL,!0),console.log("IAPWebViewPayments.onPurchaseCancelled"),this.purchaseCallback(cleverapps.Social.CODE_CANCELLED)},cleverapps.IAPWebViewPayments.prototype.onInitialized=function(e,t){e?(this.initialized=!0,this.checkInitialized()):(this.onInitializedError=decodeWebViewData(t),console.log("IAPWebViewPayments.onInitialized",this.onInitializedError),this.initialized=!1)},cleverapps.IAPWebViewPayments.prototype.onProductRequestSuccess=function(e,t
){t=decodeWebViewData(t),console.log("IAPWebViewPayments.onProductRequestSuccess "+e,t),t=JSON.parse(t);for(var n=0;n<t.length;n++){var s=this.findProductByName(t[n].name);void 0!==s&&(s.loadedPrice=t[n].price,s.loadedCurrencyCode=t[n].price_currency_code,s.loadedPriceAmount=t[n].price_amount_micros/1e6,this.loadedCurrencyCode||(this.loadedCurrencyCode=s.loadedCurrencyCode),console.log("iapwebviewpayments product "+t[n].productId+" "+s.loadedPrice+" "+s.loadedCurrencyCode+" "+s.loadedPriceAmount))}"consumable"===e?this.refreshed=!0:"subscription"===e&&(this.refreshedSubscriptions=!0),this.checkInitialized()},cleverapps.IAPWebViewPayments.prototype.isProductExists=function(e){var t=cleverapps.config.products[e];return t&&t.loadedPrice},cleverapps.IAPWebViewPayments.prototype.findProductByName=function(e){for(var t in cleverapps.config.products){var n=cleverapps.config.products[t];if((cc.sys.os===cc.sys.OS_IOS?n.id.ios:n.id.android)===e)return n}},
cleverapps.IAPWebViewPayments.prototype.restore=function(e){e=e||function(){},PurchasesPlugin.restore&&this.initialized?(this.restoreCallback=e,PurchasesPlugin.restore()):e(!1)},cleverapps.IAPWebViewPayments.prototype.open=function(e,n){cleverapps.playSession.set(cleverapps.EVENTS.PAYMENT_OPEN,!0),n=n||function(){};var t=Math.floor((Date.now()-this.startTime)/1e3);if(!this.initialized)return this.logError("onInitialized "+t+"s",this.onInitializedError),cleverapps.playSession.set(cleverapps.EVENTS.PAYMENT_NOT_INITIALIZED,!0),void n(cleverapps.Social.CODE_FAILED);if(!this.refreshed||"subscription"===e.type&&!this.refreshedSubscriptions)return this.logError("onProductRequestError "+t+"s debugMessage - "+this.onProductRequestErrorMessage,this.onProductRequestError),cleverapps.playSession.set(cleverapps.EVENTS.PAYMENT_NOT_REFRESHED,!0),void n(cleverapps.Social.CODE_FAILED);this.purchaseCallback=function(e,t){n.apply(this,arguments)}.bind(this)
;var s=cc.sys.os===cc.sys.OS_IOS?e.id.ios:e.id.android;PurchasesPlugin.hasProductByName(s)||cleverapps.ErrorHandler.logError("Product '"+s+"' not configured correctly (please check sdkbox_config.json)");var i=this.findProductByName(s);void 0===i||i.loadedPrice||cleverapps.ReportStream.debug("Product '"+s+"' has not loaded price"),PurchasesPlugin.purchase(s)},cleverapps.IAPWebViewPayments.prototype.onProductRequestFailure=function(e,t,n){this.onProductRequestError=decodeWebViewData(t),this.onProductRequestErrorMessage=decodeWebViewData(n)||"",console.log("IAPWebViewPayments.onProductRequestFailure "+e,this.onProductRequestError,this.onProductRequestErrorMessage)},cleverapps.IAPWebViewPayments.prototype.isAvailable=function(){return!0},cleverapps.IAPWebViewPayments.prototype.validate=function(e,t){if(t=t||function(){},-1!==["android","ios"].indexOf(cleverapps.User.calcSource())){var n={userid:cleverapps.user.id};cc.sys.os===cc.sys.OS_IOS?(n.receipt=e.receipt,n.productId=e.productId,
n.packageName=e.packageName,n.platform="apple",e.noDetails&&cleverapps.ReportStream.debug("IAPWEBVIEW noDetails "+JSON.stringify(e))):cc.sys.os===cc.sys.OS_ANDROID&&(n.receipt=e.receipt.purchaseToken,n.packageName=e.receipt.packageName,n.productId=e.receipt.productId,n.platform="google");var s=this.findProductByName(e.name);n.type=s&&s.type;var i={amount:s&&s.price?Math.round(s.price):1};cleverapps.RestClient.post("/purchasevalidator/validate/",n,function(e){console.log("Success purchase validate - "+JSON.stringify(e)),cleverapps.eventLogger.logEvent(cleverapps.EVENTS.PURCHASE_VALIDATE_SUCCESS,i),t()},function(){console.log("Failure purchase validate"),cleverapps.eventLogger.logEvent(cleverapps.EVENTS.PURCHASE_VALIDATE_FAILURE,i)})}else t()},cleverapps.IAPWebViewPayments.prototype.logPurchase=function(e){var t=e.orderId||e.receipt.orderId,n=this.findProductByName(e.name),s=n?n.price:0,i="USD";e.price_amount_micros&&e.price_currency_code?(s=e.price_amount_micros/1e6,
i=e.price_currency_code):n.loadedPriceAmount&&n.loadedCurrencyCode&&(s=n.loadedPriceAmount,i=n.loadedCurrencyCode),cc.sys.os===cc.sys.OS_IOS||FacebookPlugin.logPurchase(s,i),cleverapps.adjust.logPurchase(t,s,i)},cleverapps.IAPWebViewPayments.prototype.calcLoadedPrice=function(e){var t=cleverapps.EXCHANGE_RATES[this.loadedCurrencyCode];if(t){var n=Product.CURRENCY_CODE===this.loadedCurrencyCode?Product.CURRENCY:this.loadedCurrencyCode;return Math.floor(e*t)+".00 "+n}return Product.CURRENCY+" "+e},cleverapps.IAPWebViewPayments.isAppropriate=function(){return cc.sys.isNative&&cc.sys.isWebView&&("undefined"!=typeof PurchasesPlugin||cc.sys.os===cc.sys.OS_IOS)},cleverapps.IOSWebViewPurchasesPluginAdapter={init:function(){console.log("IOSWebViewPurchasesPluginAdapter init"),webkitMessage("purchase",{action:"init"})},refresh:function(e){console.log("IOSWebViewPurchasesPluginAdapter refresh"),webkitMessage("purchase",{action:"refresh",type:e})},hasProductByName:function(e){return!0},
purchase:function(e){webkitMessage("purchase",{action:"purchase",productName:e})},restore:function(e){webkitMessage("purchase",{action:"restore"})},requestStoreProduct:function(){webkitMessage("purchase",{action:"requestStoreProduct"})}},void 0===cleverapps)cleverapps={config:{source:void 0}};if(void 0===config)var config={debugMode:void 0};if(void 0===LivesProductTile)LivesProductTile=void 0;if(void 0===PackProductTile)PackProductTile=void 0;cleverapps.PaymentsManager={init:function(){var t=cleverapps.clone(cleverapps.PaymentsManager.PRODUCTS,!0);cleverapps.override(t,cleverapps.config.products||{}),Object.keys(t).forEach(function(e){!1===t[e]&&delete t[e]}),cleverapps.config.products=t;var e=null;return cleverapps.NoPayments.isAppropriate()?e=new cleverapps.NoPayments:cleverapps.IAPWebViewPayments.isAppropriate()?e=new cleverapps.IAPWebViewPayments:cleverapps.XsollaPayments.isAppropriate()?e=new cleverapps.XsollaPayments:cleverapps.FakePayments.isAppropriate(
)?e=new cleverapps.FakePayments:cleverapps.InstantPayments.isAppropriate()?e=new cleverapps.InstantPayments:cleverapps.MobileOKPayments.isAppropriate()?e=new cleverapps.MobileOKPayments:cleverapps.SPMobagePayments.isAppropriate()?e=new cleverapps.SPMobagePayments:cleverapps.OKPayments.isAppropriate()?e=new cleverapps.OKPayments:cleverapps.MobileMyMailRuPayments.isAppropriate()?e=new cleverapps.MobileMyMailRuPayments:cleverapps.MyMailRuPayments.isAppropriate()?e=new cleverapps.MyMailRuPayments:cleverapps.MobileVkPayments.isAppropriate()?e=new cleverapps.MobileVkPayments:cleverapps.VKPayments.isAppropriate()?e=new cleverapps.VKPayments:cleverapps.MobagePayments.isAppropriate()?e=new cleverapps.MobagePayments:cleverapps.FotoStrana.isAppropriate()?e=new cleverapps.FotoStranaPayments:cleverapps.NK.isAppropriate()?e=new cleverapps.NKPayments:cleverapps.Draugiem.isAppropriate()?e=new cleverapps.DraugiemPayments:cleverapps.FacebookPayments.isAppropriate()&&(e=new cleverapps.FacebookPayments),
e.onAvailableListeners=e.onAvailableListeners||{},e.canCompensate=e.canCompensate||function(){},e}},cleverapps.PaymentsManager.PRODUCTS={buyExp10:{id:{facebook:"buyexp10.html",android:"buyexp10",ios:"buyexp10",instant:"buyexp10",mymailru:1},title:"messages:Shop.BuyExp10.Title",description:"messages:Shop.BuyExp10.Description",boughtMessage:"messages:Shop.BuyExp10.BoughtMessage",image:"/res/fbproducts/buyexp10.png",price:9.99,reward:{exp:10}},buyExp150:{id:{facebook:"buyexp150.html",android:"buyexp150",ios:"buyexp150",instant:"buyexp150",mymailru:2},title:"messages:Shop.BuyExp150.Title",description:"messages:Shop.BuyExp150.Description",boughtMessage:"messages:Shop.BuyExp150.BoughtMessage",image:"/res/fbproducts/buyexp150.png",price:99.99,reward:{exp:150}},addMoves1:{id:{facebook:"addmoves1.html",android:"addmoves1",ios:"addmoves1",instant:"addmoves1",mymailru:8},title:"messages:Shop.AddMoves1.Title",description:"messages:Shop.AddMoves1.Description",
boughtMessage:"messages:Shop.AddMoves.BoughtMessage",image:"/res/fbproducts/addmoves.png",price:.99,moves:5,bonus:1,compensateReward:{gold:200}},addMoves2:{id:{facebook:"addmoves2.html",android:"addmoves2",ios:"addmoves2",instant:"addmoves2",mymailru:9},title:"messages:Shop.AddMoves2.Title",description:"messages:Shop.AddMoves2.Description",boughtMessage:"messages:Shop.AddMoves.BoughtMessage",image:"/res/fbproducts/addmoves.png",price:1.99,moves:10,bonus:1,compensateReward:{gold:400}},addMoves3:{id:{facebook:"addmoves3.html",android:"addmoves3",ios:"addmoves3",instant:"addmoves3",mymailru:10},title:"messages:Shop.AddMoves3.Title",description:"messages:Shop.AddMoves3.Description",boughtMessage:"messages:Shop.AddMoves.BoughtMessage",image:"/res/fbproducts/addmoves.png",price:2.99,moves:15,bonus:1,compensateReward:{gold:600}},addMoves5:{id:{facebook:"addmoves5.html",android:"addmoves5",ios:"addmoves5",instant:"addmoves5",mymailru:11},title:"messages:Shop.AddMoves5.Title",
description:"messages:Shop.AddMoves5.Description",boughtMessage:"messages:Shop.AddMoves.BoughtMessage",image:"/res/fbproducts/addmoves.png",price:4.99,moves:15,bonus:2,compensateReward:{gold:1e3}},piggybank500:{id:{facebook:"piggybank500.html",android:"piggybank500",ios:"piggybank500",instant:"piggybank500",mymailru:12},title:"messages:Shop.PiggyBank1.Title",description:"messages:Shop.PiggyBank1.Description",image:"/res/fbproducts/piggy_bank.png?v=1",price:2.99,reward:{gold:500}},piggybank1800:{id:{facebook:"piggybank1800.html",android:"piggybank1800",ios:"piggybank1800",instant:"piggybank1800",mymailru:13},title:"messages:Shop.PiggyBank2.Title",description:"messages:Shop.PiggyBank2.Description",image:"/res/fbproducts/piggy_bank.png?v=1",price:9.99,reward:{gold:1800}},piggybank6000:{id:{facebook:"piggybank6000.html",android:"piggybank6000",ios:"piggybank6000",instant:"piggybank6000",mymailru:14},title:"messages:Shop.PiggyBank3.Title",description:"messages:Shop.PiggyBank3.Description",
image:"/res/fbproducts/piggy_bank.png?v=1",price:29.99,reward:{gold:6e3}},piggybank25000:{id:{facebook:"piggybank25000.html",android:"piggybank25000",ios:"piggybank25000",instant:"piggybank25000",mymailru:15},title:"messages:Shop.PiggyBank4.Title",description:"messages:Shop.PiggyBank4.Description",image:"/res/fbproducts/piggy_bank.png?v=1",price:99.99,reward:{gold:25e3}},gunShot:{id:{facebook:"gunshot.html",android:"gunshot",ios:"gunshot",instant:"gunshot",mymailru:16},title:"messages:Shop.GunShot.Title",description:"messages:Shop.GunShot.Description",boughtMessage:"messages:Shop.GunShot.BoughtMessage",image:"/res/fbproducts/gunshot.png?v=5",price:1.99,reward:{gun:1},compensateReward:{gold:400}},addMoves:{id:{facebook:"addmoves.html",android:"addmoves",ios:"addmoves",instant:"addmoves",mymailru:20},title:"messages:Shop.AddMoves.Title",description:"messages:Shop.AddMoves.Description",boughtMessage:"messages:Shop.AddMoves.BoughtMessage",image:"/res/fbproducts/addmoves0.png",price:.99,
compensateReward:{gold:200}},gold500:{id:{facebook:"500gold.html",android:"500gold",ios:"500gold",instant:"500gold",mymailru:21},title:"messages:Shop.Gold500.Title",description:"messages:Shop.Gold500.Description",image:"/res/fbproducts/gold2_200.png?v=2",price:2.99,videoPrice:10,videoReward:{gold:150},reward:{gold:500},icon:"shop_gold2_png"},gold1800:{id:{facebook:"1800gold.html",android:"1800gold",ios:"1800gold",instant:"1800gold",mymailru:22},title:"messages:Shop.Gold1800.Title",description:"messages:Shop.Gold1800.Description",image:"/res/fbproducts/gold3_200.png?v=1",price:9.99,oldPrice:1.99,videoPrice:30,videoReward:{gold:500},label:1800,reward:{gold:1800},icon:"shop_gold3_png"},gold3800:{id:{facebook:"3800gold.html",android:"3800gold",ios:"3800gold",instant:"3800gold",mymailru:39},title:"messages:Shop.Gold3800.Title",description:"messages:Shop.Gold3800.Description",image:"/res/fbproducts/heap_gold.png?v=1",price:19.99,videoPrice:50,videoReward:{gold:1e3},reward:{gold:3800},
icon:"heap_gold_png"},gold6000:{id:{facebook:"6000gold.html",android:"6000gold",ios:"6000gold",instant:"6000gold",mymailru:23},title:"messages:Shop.Gold6000.Title",description:"messages:Shop.Gold6000.Description",image:"/res/fbproducts/gold4_200.png?v=1",price:29.99,oldPrice:5.99,videoPrice:100,videoReward:{gold:2500},label:6e3,reward:{gold:6e3},icon:"shop_gold4_png"},gold25000:{id:{facebook:"25000gold.html",android:"25000gold",ios:"25000gold",instant:"25000gold",mymailru:24},title:"messages:Shop.Gold25000.Title",description:"messages:Shop.Gold25000.Description",image:"/res/fbproducts/gold5_200.png?v=1",price:99.99,videoPrice:300,videoReward:{gold:1e4},reward:{gold:25e3},icon:"shop_gold5_png"},starterPack0:{id:{facebook:"starterpack0.html",android:"starterpack0",ios:"starterpack0",instant:"starterpack0",mymailru:25},title:"messages:StarterPack0.Title",description:"messages:StarterPack0.Description",boughtMessage:"messages:StarterPack.Bought",boughtMessageParams:{
title:"messages:StarterPack0.Title"},image:"/res/fbproducts/starter_pack0.png?v=1",price:.99},starterPack:{id:{facebook:"starterpack.html",android:"starterpack",ios:"starterpack",instant:"starterpack",mymailru:26},title:"messages:StarterPack1.Title",description:"messages:StarterPack1.Description",boughtMessage:"messages:StarterPack.Bought",boughtMessageParams:{title:"messages:StarterPack1.Title"},image:"/res/fbproducts/starter_pack.png?v=1",price:4.99},starterPack2:{id:{facebook:"starterpack2.html",android:"starterpack2",ios:"starterpack2",instant:"starterpack2",mymailru:27},title:"messages:StarterPack2.Title",description:"messages:StarterPack2.Description",boughtMessage:"messages:StarterPack.Bought",boughtMessageParams:{title:"messages:StarterPack2.Title"},image:"/res/fbproducts/starter_pack2.png?v=1",price:29.99},subsWeek:{id:{facebook:"subsweek.html",android:"subsweek",ios:"subsweek",ok:"subsweek",mymailru:31},title:"messages:Shop.SubsWeek.Title",
description:"messages:Shop.SubsWeek.Description",boughtMessage:"messages:Shop.SubsWeek.BoughtMessage",image:"/res/fbproducts/premium.png",price:9.99,trial:"1 day",period:"2 weeks",type:"subscription",projects:["riddles","heroes","wordsoup","crocword","olympics","tripeaks","scramble","magicwords"]},subsMonth:{id:{facebook:"subsmonth.html",android:"subsmonth",ios:"subsmonth",ok:"subsmonth",mymailru:32},title:"messages:Shop.SubsMonth.Title",description:"messages:Shop.SubsMonth.Description",boughtMessage:"messages:Shop.SubsMonth.BoughtMessage",image:"/res/fbproducts/premium.png",price:14.99,period:"1 month",type:"subscription",projects:["riddles","heroes","wordsoup","crocword","olympics","tripeaks","scramble","magicwords"]},subsWeekTest:{id:{facebook:"subsweektest.html",android:"subsweektest",ios:"subsweektest",ok:"subsweektest",mymailru:33},title:"messages:Shop.SubsWeek.Title",description:"messages:Shop.SubsWeek.Description",boughtMessage:"messages:Shop.SubsWeek.BoughtMessage",
image:"/res/fbproducts/premium.png",price:.05,trial:"1 day",period:"2 weeks",type:"subscription",projects:["riddles","heroes","wordsoup","crocword"]},subsMonthTest:{id:{facebook:"subsmonthtest.html",android:"subsmonthtest",ios:"subsmonthtest",ok:"subsmonthtest",mymailru:34},title:"messages:Shop.SubsMonth.Title",description:"messages:Shop.SubsMonth.Description",boughtMessage:"messages:Shop.SubsMonth.BoughtMessage",image:"/res/fbproducts/premium.png",price:.1,period:"1 month",type:"subscription",projects:["riddles","heroes","wordsoup","crocword"]},cellPack05:{id:{facebook:"cellpack05.html",android:"cellpack05",ios:"cellpack05",instant:"cellpack05",mymailru:46},title:"messages:TileShop.cellPack05.Title",description:"messages:TileShop.cellPack05.Description",image:"/res/fbproducts/cell_pack_200.png",boughtMessage:"messages:Shop.cellPack05.boughtMessage",price:.49,oldPrice:4.99,reward:{boosters:{0:5}},icon:"cellbooster_png",label:5},linePack074:{id:{facebook:"linepack074.html",
android:"linepack074",ios:"linepack074",instant:"linepack074",mymailru:47},title:"messages:TileShop.linePack074.Title",description:"messages:TileShop.linePack074.Description",image:"/res/fbproducts/line_pack_200.png",boughtMessage:"messages:Shop.linePack074.boughtMessage",price:.74,oldPrice:7.49,reward:{boosters:{1:5}},icon:"linebooster_png",label:5},colorPack10:{id:{facebook:"colorpack10.html",android:"colorpack10",ios:"colorpack10",instant:"colorpack10",mymailru:48},title:"messages:TileShop.colorPack10.Title",description:"messages:TileShop.colorPack10.Description",image:"/res/fbproducts/color_pack_200.png",boughtMessage:"messages:Shop.colorPack10.boughtMessage",price:.99,oldPrice:9.99,reward:{boosters:{2:5}},icon:"colorbooster_png",label:5},cellPack2:{id:{facebook:"cellpack2.html",android:"cellpack2",ios:"cellpack2",instant:"cellpack2",mymailru:49},title:"messages:TileShop.cellPack10.Title",description:"messages:TileShop.cellPack10.Description",
image:"/res/fbproducts/cell_pack_200.png",boughtMessage:"messages:Shop.cellPack10.boughtMessage",price:1.99,oldPrice:19.99,reward:{boosters:{0:10}},icon:"cellbooster_png",label:10},linePack3:{id:{facebook:"linepack3.html",android:"linepack3",ios:"linepack3",instant:"linepack3",mymailru:50},title:"messages:TileShop.linePack15.Title",description:"messages:TileShop.linePack15.Description",image:"/res/fbproducts/line_pack_200.png",boughtMessage:"messages:Shop.linePack15.boughtMessage",price:2.99,oldPrice:29.99,reward:{boosters:{1:10}},icon:"linebooster_png",label:10},colorPack4:{id:{facebook:"colorpack4.html",android:"colorpack4",ios:"colorpack4",instant:"colorpack4",mymailru:51},title:"messages:TileShop.colorPack20.Title",description:"messages:TileShop.colorPack20.Description",image:"/res/fbproducts/color_pack_200.png",boughtMessage:"messages:Shop.colorPack20.boughtMessage",price:3.99,oldPrice:39.99,reward:{boosters:{2:10}},icon:"colorbooster_png",label:10},unlimitedLives05:{id:{
facebook:"unlimitedlives05.html",android:"unlimitedlives05",ios:"unlimitedlives05",instant:"unlimitedlives05",mymailru:52},title:"messages:UnlimitedLives.Title",description:"messages:TileShop.unlimitedLives05.Description",image:"/res/fbproducts/unlimitedlives.png",boughtMessage:"messages:UnlimitedLivesBought",price:.49,oldPrice:2.99,reward:{unlimitedLives:"3 days"},icon:"life_unlim",label:"messages:UnlimitedLives.3 day"},lives074:{id:{facebook:"lives074.html",android:"lives074",ios:"lives074",instant:"lives074",mymailru:53},title:"messages:TileShop.lives074.Title",description:"messages:TileShop.lives074.Description",image:"/res/fbproducts/lives.png",boughtMessage:"messages:Shop.lives074.boughtMessage",price:.74,oldPrice:7.49,reward:{lives:50},icon:"level_failed_heart_png",label:50},exp1:{id:{facebook:"exp1.html",android:"exp1",ios:"exp1",instant:"exp1",mymailru:54},title:"messages:TileShop.exp1.Title",description:"messages:TileShop.exp1.Description",
image:"/res/fbproducts/buyexp150.png",boughtMessage:"messages:Shop.exp1.boughtMessage",price:.99,oldPrice:19.99,reward:{exp:25},icon:"exp_png",label:25},unlimitedLives2:{id:{facebook:"unlimitedlives2.html",android:"unlimitedlives2",ios:"unlimitedlives2",instant:"unlimitedlives2",mymailru:55},title:"messages:UnlimitedLives.Title",description:"messages:TileShop.unlimitedLives2.Description",image:"/res/fbproducts/unlimitedlives.png",boughtMessage:"messages:UnlimitedLivesBought",price:1.99,oldPrice:4.99,reward:{unlimitedLives:"5 days"},icon:"life_unlim",label:"messages:UnlimitedLives.5 day"},lives3:{id:{facebook:"lives3.html",android:"lives3",ios:"lives3",instant:"lives3",mymailru:56},title:"messages:TileShop.lives3.Title",description:"messages:TileShop.lives3.Description",image:"/res/fbproducts/lives.png",boughtMessage:"messages:Shop.lives3.boughtMessage",price:2.99,oldPrice:29.99,reward:{lives:100},icon:"level_failed_heart_png",label:100},exp4:{id:{facebook:"exp4.html",android:"exp4",
ios:"exp4",instant:"exp4",mymailru:57},title:"messages:TileShop.exp4.Title",description:"messages:TileShop.exp4.Description",image:"/res/fbproducts/buyexp150.png",boughtMessage:"messages:Shop.exp4.boughtMessage",price:3.99,oldPrice:39.99,reward:{exp:50},icon:"exp_png",label:50},raceKey:{id:{facebook:"racekey.html",android:"racekey",ios:"racekey",instant:"racekey",mymailru:61},title:"messages:Race.product.title",description:"messages:Race.product.description",image:"/res/fbproducts/baloon_key_200.png",boughtMessage:"messages:Race.product.bought",price:19.99,oldPrice:40,reward:{raceKey:1},compensateReward:{gold:4e3}},gold500sale:{id:{facebook:"500goldsale.html",android:"500goldsale",ios:"500goldsale",instant:"500goldsale",mymailru:65},title:"messages:Shop.Gold500.Title",description:"messages:Shop.Gold500.Description",image:"/res/fbproducts/gold2_200.png",price:.99,oldPrice:2.99,label:500,reward:{gold:500},icon:"shop_gold2_png"},gold1800sale:{id:{facebook:"1800goldsale.html",
android:"1800goldsale",ios:"1800goldsale",instant:"1800goldsale",mymailru:59},title:"messages:Shop.Gold1800.Title",description:"messages:Shop.Gold1800.Description",image:"/res/fbproducts/gold3_200.png",price:2.99,oldPrice:9.99,label:1800,reward:{gold:1800},icon:"shop_gold3_png"},gold6000sale:{id:{facebook:"6000goldsale.html",android:"6000goldsale",ios:"6000goldsale",instant:"6000goldsale",mymailru:60},title:"messages:Shop.Gold6000.Title",description:"messages:Shop.Gold6000.Description",image:"/res/fbproducts/gold4_200.png",price:5.99,oldPrice:29.99,label:6e3,reward:{gold:6e3},icon:"shop_gold4_png"},unlimitedLives:{id:{facebook:"unlimitedlives.html",android:"unlimitedlives",ios:"unlimitedlives",instant:"unlimitedlives",mymailru:64},title:"messages:UnlimitedLives.Title",description:"messages:UnlimitedLives.Description",boughtMessage:"messages:UnlimitedLivesBought",image:"/res/fbproducts/unlimitedlives.png",price:2.99,reward:{unlimitedLives:"3 days"},icon:"unlimitedLives_png",
animation:"animation",ViewClassName:LivesProductTile},gold1:{id:{facebook:"gold1.html",android:"gold1",ios:"gold1",instant:"gold1",mymailru:62},title:"messages:TileShop.gold1.Title",description:"messages:TileShop.gold1.Description",image:"/res/fbproducts/gold2_200.png",boughtMessage:"messages:Shop.gold1.boughtMessage",price:.99,oldPrice:9.99,reward:{gold:1e3},icon:"boosters_sale_coin_png",label:"1000"},gold4:{id:{facebook:"gold4.html",android:"gold4",ios:"gold4",instant:"gold4",mymailru:63},title:"messages:TileShop.gold4.Title",description:"messages:TileShop.gold4.Description",image:"/res/fbproducts/gold4_200.png",boughtMessage:"messages:Shop.gold4.boughtMessage",price:3.99,oldPrice:39.99,reward:{gold:5e3},icon:"boosters_sale_coin_png",label:"5000"},coins150:{id:{facebook:"150coins.html",android:"150coins",ios:"150coins",instant:"150coins",mymailru:69},title:"messages:Shop.Coins150.Title",description:"messages:Shop.Coins150.Description",
image:"/res/fbproducts/soft_currency_small_200.png?v=2",price:.99,reward:{coins:150},icon:"soft_currency_small_png",boughtMessage:"messages:Product.SoftCurrencyBought"},coins1000:{id:{facebook:"1000coins.html",android:"1000coins",ios:"1000coins",instant:"1000coins",mymailru:70},title:"messages:Shop.Coins1000.Title",description:"messages:Shop.Coins1000.Description",image:"/res/fbproducts/soft_currency_medium_200.png?v=2",price:4.99,reward:{coins:1e3},icon:"soft_currency_medium_png",boughtMessage:"messages:Product.SoftCurrencyBought"},coins2500:{id:{facebook:"2500coins.html",android:"2500coins",ios:"2500coins",instant:"2500coins",mymailru:71},title:"messages:Shop.Coins2500.Title",description:"messages:Shop.Coins2500.Description",image:"/res/fbproducts/soft_currency_large_200.png?v=2",price:9.99,reward:{coins:2500},icon:"soft_currency_large_png",boughtMessage:"messages:Product.SoftCurrencyBought"}},cleverapps.PaymentsManager.SCRAMBLE_PRODUCTS={highlightPack1:{id:{
facebook:"highlightpack1.html",android:"highlightpack1",ios:"highlightpack1",instant:"highlightpack1",mymailru:66},title:"messages:TileShop.highlightPack1.Title",description:"messages:TileShop.highlightPack1.Description",image:"/res/fbproducts/highlight_booster_200.png",boughtMessage:"messages:Shop.highlightPack1.boughtMessage",price:.99,oldPrice:1.99,reward:{boosters:{13:10}},icon:"highlight",label:"x10",ViewClassName:PackProductTile},eyePack2:{id:{facebook:"eyepack2.html",android:"eyepack2",ios:"eyepack2",instant:"eyepack2",mymailru:67},title:"messages:TileShop.eyePack2.Title",description:"messages:TileShop.eyePack2.Description",image:"/res/fbproducts/eye_booster_200.png",boughtMessage:"messages:Shop.eyePack2.boughtMessage",price:1.99,oldPrice:4.99,reward:{boosters:{14:10}},icon:"eye",label:"x10",ViewClassName:PackProductTile},hintBoosterBeforePack3:{id:{facebook:"hintboosterbeforepack3.html",android:"hintboosterbeforepack3",ios:"hintboosterbeforepack3",
instant:"hintboosterbeforepack3",mymailru:68},title:"messages:TileShop.hintBoosterBeforePack3.Title",description:"messages:TileShop.hintBoosterBeforePack3.Description",image:"/res/fbproducts/hint_booster_before_200.png",boughtMessage:"messages:Shop.hintBoosterBeforePack3.boughtMessage",price:2.99,oldPrice:6.99,reward:{boosters:{15:10}},icon:"bonus_hint_sale_png",label:"x10",ViewClassName:PackProductTile}},cleverapps.PaymentsManager.PACK_PRODUCTS={sweetPack:{id:{facebook:"sweetpack.html",android:"sweetpack",ios:"sweetpack",instant:"sweetpack",mymailru:35},title:"messages:TileShop.sweetPack.Title",description:"messages:TileShop.sweetPack.Description",image:"/res/fbproducts/sweet_pack_200.png",boughtMessage:"messages:Shop.sweetPack.boughtMessage",price:5.99,reward:{gold:500,boosters:{0:1,1:1}},icon:"sweet_pack_png",ViewClassName:PackProductTile},jamPack:{id:{facebook:"jampack.html",android:"jampack",ios:"jampack",instant:"jampack",mymailru:36},title:"messages:TileShop.jamPack.Title",
description:"messages:TileShop.jamPack.Description",image:"/res/fbproducts/jam_pack_200.png",boughtMessage:"messages:Shop.jamPack.boughtMessage",price:12.99,reward:{gold:1800,boosters:{0:1,1:1,2:1}},icon:"jam_pack_png",ViewClassName:PackProductTile},tastyPack:{id:{facebook:"tastypack.html",android:"tastypack",ios:"tastypack",instant:"tastypack",mymailru:40},title:"messages:TileShop.tastyPack.Title",description:"messages:TileShop.tastyPack.Description",image:"/res/fbproducts/tasty_pack_200.png?v=1",boughtMessage:"messages:Shop.tastyPack.boughtMessage",price:25.99,reward:{gold:3800,boosters:{0:3,1:3,2:3}},icon:"tasty_pack_png",ViewClassName:PackProductTile},honeyPack:{id:{facebook:"honeypack.html",android:"honeypack",ios:"honeypack",instant:"honeypack",mymailru:37},title:"messages:TileShop.honeyPack.Title",description:"messages:TileShop.honeyPack.Description",image:"/res/fbproducts/honey_pack_200.png?v=1",boughtMessage:"messages:Shop.honeyPack.boughtMessage",price:39.99,reward:{gold:6e3,
boosters:{0:5,1:5,2:5}},icon:"honey_pack_png",ViewClassName:PackProductTile},epicPack:{id:{facebook:"epicpack.html",android:"epicpack",ios:"epicpack",instant:"epicpack",mymailru:38},title:"messages:TileShop.epicPack.Title",description:"messages:TileShop.epicPack.Description",image:"/res/fbproducts/epic_pack_200.png?v=1",boughtMessage:"messages:Shop.epicPack.boughtMessage",price:129.99,reward:{gold:25e3,boosters:{0:20,1:20,2:20}},icon:"epic_pack_png",ViewClassName:PackProductTile}};var customizeProducts=function(){var e=cleverapps.extend||Object.assign;for(var t in"match3"!==cleverapps.config.type&&"differences"!==cleverapps.config.type||e(cleverapps.PaymentsManager.PRODUCTS,cleverapps.PaymentsManager.PACK_PRODUCTS),"merge"===cleverapps.config.type&&(cleverapps.PaymentsManager.PRODUCTS.gold500.reward={gold:200},cleverapps.PaymentsManager.PRODUCTS.gold500.videoReward={gold:50},cleverapps.PaymentsManager.PRODUCTS.gold1800.reward={gold:900},
cleverapps.PaymentsManager.PRODUCTS.gold1800.videoReward={gold:200},cleverapps.PaymentsManager.PRODUCTS.gold3800.reward={gold:2100},cleverapps.PaymentsManager.PRODUCTS.gold3800.videoReward={gold:600},cleverapps.PaymentsManager.PRODUCTS.gold6000.reward={gold:3500},cleverapps.PaymentsManager.PRODUCTS.gold6000.videoReward={gold:1e3},cleverapps.PaymentsManager.PRODUCTS.gold25000.reward={gold:14e3},cleverapps.PaymentsManager.PRODUCTS.gold25000.videoReward={gold:4e3}),"differences"===cleverapps.config.type&&(cleverapps.PaymentsManager.PRODUCTS.sweetPack.reward.boosters={8:2,9:2},cleverapps.PaymentsManager.PRODUCTS.jamPack.reward.boosters={8:3,9:3},cleverapps.PaymentsManager.PRODUCTS.tastyPack.reward.boosters={8:5,9:5},cleverapps.PaymentsManager.PRODUCTS.honeyPack.reward.boosters={8:7,9:7},cleverapps.PaymentsManager.PRODUCTS.epicPack.reward.boosters={8:30,9:30}),"solitaire"===cleverapps.config.type&&"spades"!==cleverapps.config.name&&(e(cleverapps.PaymentsManager.PRODUCTS,
cleverapps.PaymentsManager.PACK_PRODUCTS),cleverapps.PaymentsManager.PRODUCTS.addMoves1.price=1.49,cleverapps.PaymentsManager.PRODUCTS.sweetPack.reward.boosters={10:2,11:2,12:2},cleverapps.PaymentsManager.PRODUCTS.jamPack.reward.boosters={10:3,11:3,12:3},cleverapps.PaymentsManager.PRODUCTS.tastyPack.reward.boosters={10:5,11:5,12:5},cleverapps.PaymentsManager.PRODUCTS.honeyPack.reward.boosters={10:7,11:7,12:7},cleverapps.PaymentsManager.PRODUCTS.epicPack.reward.boosters={10:30,11:30,12:30}),"match3"===cleverapps.config.type&&(cleverapps.PaymentsManager.PRODUCTS.sweetPack.reward.boosters={5:1,6:1,7:1},cleverapps.PaymentsManager.PRODUCTS.jamPack.reward.boosters={5:2,6:2,7:2},cleverapps.PaymentsManager.PRODUCTS.tastyPack.reward.boosters={0:3,1:3,5:3,6:3,7:3},cleverapps.PaymentsManager.PRODUCTS.honeyPack.reward.boosters={0:5,1:5,5:5,6:5,7:5},cleverapps.PaymentsManager.PRODUCTS.epicPack.reward.boosters={0:18,1:18,5:18,6:18,7:18}),"ios"===cleverapps.config.source&&(
cleverapps.PaymentsManager.PRODUCTS.gold25000.price=99.99),"ios"===cleverapps.config.source&&cleverapps.PaymentsManager.PRODUCTS.epicPack&&(cleverapps.PaymentsManager.PRODUCTS.epicPack.price=99.99),-1!==["instant","ios"].indexOf(cleverapps.config.source)&&(cleverapps.PaymentsManager.PRODUCTS.cellPack05.price=.99,cleverapps.PaymentsManager.PRODUCTS.cellPack05.oldPrice=9.99,cleverapps.PaymentsManager.PRODUCTS.linePack074.price=1.99,cleverapps.PaymentsManager.PRODUCTS.linePack074.oldPrice=19.99,cleverapps.PaymentsManager.PRODUCTS.colorPack10.price=2.99,cleverapps.PaymentsManager.PRODUCTS.colorPack10.oldPrice=29.99,cleverapps.PaymentsManager.PRODUCTS.lives074.price=1.99,cleverapps.PaymentsManager.PRODUCTS.lives074.oldPrice=19.99,cleverapps.PaymentsManager.PRODUCTS.unlimitedLives05.price=.99,cleverapps.PaymentsManager.PRODUCTS.unlimitedLives05.oldPrice=9.99),-1!==["android","ios"].indexOf(cleverapps.config.source)&&(cleverapps.PaymentsManager.PRODUCTS.subsWeek.price=4.99,
cleverapps.PaymentsManager.PRODUCTS.subsWeek.trial="3 days",cleverapps.PaymentsManager.PRODUCTS.subsWeek.period="1 week",cleverapps.PaymentsManager.PRODUCTS.subsWeek.title="messages:Shop.SubsWeek.ThreeDays.Title",cleverapps.PaymentsManager.PRODUCTS.subsWeek.description="messages:Shop.SubsWeek.ThreeDays.Description"),"olympics"===cleverapps.config.name&&(cleverapps.PaymentsManager.PRODUCTS.lives3.icon="boosters_sale_energy_png",cleverapps.PaymentsManager.PRODUCTS.lives074.icon="boosters_sale_energy_png"),"scramble"!==cleverapps.config.name&&"wordheaps"!==cleverapps.config.name||(e(cleverapps.PaymentsManager.PRODUCTS,cleverapps.PaymentsManager.PACK_PRODUCTS),e(cleverapps.PaymentsManager.PRODUCTS,cleverapps.PaymentsManager.SCRAMBLE_PRODUCTS),cleverapps.PaymentsManager.PRODUCTS.sweetPack.reward.boosters={13:2,14:2,15:2},cleverapps.PaymentsManager.PRODUCTS.jamPack.reward.boosters={13:3,14:3,15:3},cleverapps.PaymentsManager.PRODUCTS.tastyPack.reward.boosters={13:5,14:5,15:5},
cleverapps.PaymentsManager.PRODUCTS.honeyPack.reward.boosters={13:7,14:7,15:7},cleverapps.PaymentsManager.PRODUCTS.epicPack.reward.boosters={13:30,14:30,15:30}),cleverapps.PaymentsManager.PRODUCTS)cleverapps.PaymentsManager.PRODUCTS[t].key=t};"undefined"!=typeof exports?module.exports={getProducts:function(e){return Object.assign(cleverapps.config,e),customizeProducts(),cleverapps.PaymentsManager.PRODUCTS}}:customizeProducts(),cleverapps.PaymentsHistory=function(){this.load(),this.onAddPaymentListeners={}},cleverapps.PaymentsHistory.prototype.addPayment=function(e){var t={price:e.price,productId:e.id,textPrice:e.getCurrentPrice(),time:Date.now()};if(this.payments.push(t),this.save(),cleverapps.serverFlags.setFlag(cleverapps.ServerFlags.PAYER),cleverapps.abTest){var n=Math.round(e.price*cleverapps.User.calcPriceCoef()*100)/100;cleverapps.abTest.purchaseEvent(n)}var s=cleverapps.missionManager.getRunningMission(Missions.SEMAPHORE_CLASSIC);if(s){var i=s.getName()
;cleverapps.eventLogger.logEvent("mission_"+i,{amount:Math.round(e.price*cleverapps.User.calcPriceCoef()*100)/100})}cleverapps.values(this.onAddPaymentListeners).forEach(cleverapps.callFunc)},cleverapps.PaymentsHistory.prototype.isPayer=function(){return 0<this.payments.length||cleverapps.serverFlags.hasFlag(cleverapps.ServerFlags.PAYER)},cleverapps.PaymentsHistory.prototype.getLastPayment=function(){return 0<this.payments.length?this.payments[this.payments.length-1]:void 0},cleverapps.PaymentsHistory.prototype.calcFavoriteProduct=function(e){var n={},t={},s=e.filter(function(e){return cleverapps.config.products[e]});s.forEach(function(e){t[cleverapps.config.products[e].price]=e,n[e]=0}),this.payments.forEach(function(e){t[e.price]&&n[t[e.price]]++});var i=void 0,o=0;return s.forEach(function(e){var t=cleverapps.config.products[e].price;2<=n[e]&&o<t&&(i=e,o=t)}),i},cleverapps.PaymentsHistory.prototype.load=function(){var e=cleverapps.DataLoader.load(
cleverapps.DataLoaderTypes.PAYMENTS_HISTORY);e||(e={payments:[]}),Array.isArray(e)&&(e={payments:e}),this.payments=e.payments},cleverapps.PaymentsHistory.prototype.save=function(){cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.PAYMENTS_HISTORY,{payments:this.payments})},cleverapps.PaymentsHistory.PAYER_NONE=0,cleverapps.PaymentsHistory.PAYER_WEAK=1,cleverapps.PaymentsHistory.PAYER_NORMAL=2,cleverapps.PaymentsHistory.PAYER_WHALE=3,cleverapps.PaymentsHistory.PAYER_BIGWHALE=4,cleverapps.PaymentsHistory.BRACKETS=[2.99,9.99,29.99,99.99],cleverapps.PaymentsHistory.prototype.classify=function(e){void 0===e&&(e="1 month");for(var t=0,n=this.payments.length-1;0<=n;n--){var s=this.payments[n];if(s.time+cleverapps.parseInterval(e)<Date.now())break;t+=s.price}for(var i=0;i<cleverapps.PaymentsHistory.BRACKETS.length&&!(t<cleverapps.PaymentsHistory.BRACKETS[i]+.001);i++);return i},cleverapps.NKPayments=function(){for(var e in cleverapps.config.products){var t=cleverapps.config.products[e]
;t.loadedPrice=this.calcLoadedPrice(t.price)}},cleverapps.NKPayments.prototype.calcLoadedPrice=function(e){return Math.floor(10*e)+"EGB"},cleverapps.NKPayments.prototype.open=function(e,n){var t={};t[opensocial.Payment.Field.AMOUNT]=parseInt(e.loadedPrice),t[opensocial.Payment.Field.MESSAGE]=e.description;var s=opensocial.newPayment(t);FullscreenControlButton.exitFullscreen(function(){opensocial.requestPayment(s,function(e){var t=e.getData();e.hadError()||!t.getField("responseMessage")?n(cleverapps.Social.CODE_FAILED,e):n(cleverapps.Social.CODE_SUCCEED,t)})})},cleverapps.NKPayments.prototype.isAvailable=function(){return!0},cleverapps.NKPayments.isAppropriate=function(){return cleverapps.NK.isAppropriate()},cleverapps.NKPayments.prototype.validate=function(e,t){t&&t()},cleverapps.NKPayments.prototype.logPurchase=function(e){},cleverapps.DraugiemPayments=function(){for(var e in cleverapps.Payments.call(this),cleverapps.config.products){var t=cleverapps.config.products[e]
;t.loadedPrice=this.calcLoadedPrice(t.price)}this.paymentTesters=["5531190","5531196","5531268"]},cleverapps.DraugiemPayments.prototype=Object.create(cleverapps.Payments.prototype),cleverapps.DraugiemPayments.prototype.constructor=cleverapps.DraugiemPayments,cleverapps.DraugiemPayments.prototype.calcLoadedPrice=function(e){return e+" "},cleverapps.DraugiemPayments.prototype.stopCheckPayments=function(){this.checkPaymentInterval&&(clearInterval(this.checkPaymentInterval),this.checkPaymentInterval=void 0)},cleverapps.DraugiemPayments.prototype.runCheckPayments=function(){this.stopCheckPayments();var e=Date.now();this.checkPaymentInterval=setInterval(function(){this.checkPayment(),Date.now()-e>cleverapps.parseInterval("3 minutes")&&this.onFailedPayment()}.bind(this),1e3)},cleverapps.DraugiemPayments.prototype.onFailedPayment=function(){this.stopCheckPayments(),this.paymentCallback&&(this.paymentCallback=void 0)},cleverapps.DraugiemPayments.prototype.onSuccessPayment=function(){
this.stopCheckPayments(),this.paymentCallback&&(this.paymentCallback(cleverapps.Social.CODE_SUCCEED),this.paymentCallback=void 0)},cleverapps.DraugiemPayments.prototype.checkPayment=function(){console.log("ask transaction status: "+this.paymentId),cleverapps.social.api("transactions/check",{id:this.paymentId},function(e,t){void 0!==t&&(console.log("status: ",t.status),"FAILED"===t.status?this.onFailedPayment():"OK"===t.status&&this.onSuccessPayment())}.bind(this))},cleverapps.DraugiemPayments.prototype.isProductExists=function(e){return cleverapps.config.products[e]&&DraugiemProducts[e]},cleverapps.DraugiemPayments.prototype.open=function(n,s){if(!DraugiemProducts[n.key])return s(cleverapps.Social.CODE_FAILED),void setTimeout(function(){throw console.log(n),"Draugiem payment configuration error for "+n.key},0);var e={price:Math.round(100*parseFloat(n.loadedPrice)),service:DraugiemProducts[n.key]};-1!==this.paymentTesters.indexOf(cleverapps.social.getUserID())&&(e.price=1),
cleverapps.social.api("transactions/create",e,function(e,t){console.log(DraugiemProducts[n.key],e,t),e===cleverapps.Social.CODE_SUCCEED?(this.paymentId=t.transaction.id,this.paymentCallback=s,draugiemWindowOpen(t.transaction.link,350,400,function(){this.runCheckPayments()}.bind(this))):(console.log(DraugiemProducts[n.key],n,n.key),s(cleverapps.Social.CODE_FAILED))}.bind(this))},cleverapps.DraugiemPayments.prototype.isAvailable=function(){return!0},cleverapps.DraugiemPayments.isAppropriate=function(){return cleverapps.Draugiem.isAppropriate()},cleverapps.DraugiemPayments.prototype.validate=function(e,t){t&&t()},cleverapps.DraugiemPayments.prototype.logPurchase=function(e){},cleverapps.XsollaPayments=function(){},cleverapps.XsollaPayments.prototype.open=function(e,t){t=cleverapps.once(t);var s=!1,i=!1,n=document.getElementById("xsollaPayStationIframe"),o=document.getElementById("xsollaPayStationCloseButton"),r=document.getElementById("xsollaPayStation"),a=document.getElementById(
"xsollaShadow"),c="https://store.xsolla.com/pages/buy.php?type=virtual_item&project_id="+cleverapps.config.xsollaProjectId+"&sku="+e.itemId+"&xsolla_login_token="+cleverapps.social.accessToken;cleverapps.config.debugMode&&(c+="&mode=sandbox");var l=function(){n.style.marginTop=(cc.view.getFrameSize().height-n.clientHeight)/2+"px";var e=n.getBoundingClientRect();o.style.top=45+e.top+"px",o.style.right=6+e.left+"px"};cleverapps.afterResolutionChanged(l),o.onclick=r.onclick=function(){if(!i)return setTimeout(function(){r.style.display="none",s&&!cleverapps.config.debugMode&&fbq("track","Purchase",{currency:"USD",value:e.price}),t(s?cleverapps.Social.CODE_SUCCEED:cleverapps.Social.CODE_CANCELLED)},700),a.style.opacity="0",n.onload=void 0,n.src="",!1},n.src=c,n.onload=function(){r.style.display="block",l(),a.style.opacity="0.6";var e=window.addEventListener?"addEventListener":"attachEvent";(0,window[e])("attachEvent"==e?"onmessage":"message",function(e){if(e.data&&"string"==typeof e.data){
var t=JSON.parse(e.data);if(t.data&&t.data.paymentInfo){var n=t.data.paymentInfo.status;cleverapps.config.debugMode&&console.log("Xsolla payment event: "+JSON.stringify(t.data.paymentInfo)),"invoice"===n?i=!0:"done"===n?s=!(i=!1):"troubled"===n&&(s=i=!1)}}},!1)}},cleverapps.XsollaPayments.prototype.isAvailable=function(){return!0},cleverapps.XsollaPayments.prototype.validate=function(e,t){t&&t()},cleverapps.XsollaPayments.isAppropriate=function(){return cleverapps.Xsolla.isAppropriate()},cleverapps.XsollaPayments.prototype.logPurchase=function(e){};var CustomSyncers={extractors:{users:function(){var e=cleverapps.user;if(e){var t={id:e.id,gold:e.gold,registered:e.registered,visited:e.visited,source:e.source,channel:e.channel,abtest:e.abtest,progressCompare:e.progressCompare,progress:e.progress};return void 0!==e.level&&(t.level=e.level),void 0!==e.episode&&(t.episode=e.episode),void 0!==e.exp&&(t.exp=e.exp),t}},bonuses:function(){if(cleverapps.periodicBonus)return{
event:cleverapps.periodicBonus.when}},bonusgames:function(){if(cleverapps.bonusRoundChest)return{event:cleverapps.bonusRoundChest.when}},games:function(){if(cleverapps.GameSyncer)return cleverapps.GameSyncer.getInfo()},settings:function(){if(cleverapps.settings)return cleverapps.settings.getSaveInfo()},serverflags:function(){if(cleverapps.serverFlags)return cleverapps.serverFlags.getInfo()},tempgoods:function(){if(cleverapps.tempGoods)return cleverapps.tempGoods.getInfo()},lives:function(){if(cleverapps.lives)return cleverapps.lives.getInfo()},boosters:function(){if(cleverapps.boostersCounter)return cleverapps.boostersCounter.data},starchests:function(){if(cleverapps.starChest)return{stars:cleverapps.starChest.stars}},packs:function(){if(cleverapps.packManager)return{used:cleverapps.packManager.used}},dailytasks:function(){if(cleverapps.dailyTasks)return cleverapps.dailyTasks.getInfo()},missions:function(){if(cleverapps.missionManager)return cleverapps.missionManager.getInfo()},
piggybank:function(){if(cleverapps.piggyBank)return cleverapps.piggyBank.getInfo()},gun:function(){if(cleverapps.gun)return cleverapps.gun.getInfo()},heroes:function(){if("undefined"!=typeof match3&&match3&&match3.heroes)return match3.heroes.getInfo()},subscription:function(){if(cleverapps.subscription)return cleverapps.subscription.getInfo()},userdailycup:function(){if(cleverapps.dailyCup)return cleverapps.dailyCup.getInfo()},userweeklycup:function(){if(cleverapps.weeklyCup)return cleverapps.weeklyCup.getInfo()},forces:function(){if(cleverapps.forces)return cleverapps.forces.getInfo()},metha:function(){if(cleverapps.metha.getType()!==Metha.HOSE&&cleverapps.metha.getMainObject().getInfo)return cleverapps.metha.getMainObject().getInfo()},cookiejar:function(){if(levels&&levels.cookieJar)return levels.cookieJar.getCounterValue()},competitionstatistics:function(){if(cleverapps.competitionStatistics)return cleverapps.competitionStatistics.getInfo()},cardskins:function(){if(
cleverapps.cardSkins)return cleverapps.cardSkins.getInfo()}},importerData:{users:function(e){var t=cleverapps.user;if(t){for(var n in e)t[n]=e[n];t.save(!1),cleverapps.abTest&&cleverapps.abTest.setGroup(t.abtest),levels.episodes.reset(),levels.episodes.setCurrentEpisode(cleverapps.user.episode)}},bonuses:function(e){if(cleverapps.periodicBonus){var t=cleverapps.periodicBonus;e.event<t.when||e.event>Date.now()+t.interval||(t.locked=!0,t.setWhenUnlock(e.event),t.save(!1),t.changeLockedListener())}},bonusgames:function(e){if(cleverapps.bonusRoundChest){var t=cleverapps.bonusRoundChest;e.event<t.when||e.event>Date.now()+t.interval||(t.locked=!0,t.setWhenUnlock(e.event),t.save(!1),t.changeLockedListener())}},games:function(e){cleverapps.GameSyncer&&cleverapps.GameSyncer.saveInfo(e)},settings:function(){},boosters:function(e){cleverapps.boostersCounter&&(cleverapps.boostersCounter.data=e,cleverapps.boostersCounter.addInitAmount(!0),cleverapps.boostersCounter.save(!1))},serverflags:function(e
){cleverapps.serverFlags&&cleverapps.serverFlags.updateInfo(e,!0)},tempgoods:function(e){cleverapps.tempGoods&&cleverapps.tempGoods.updateInfo(e,!0)},lives:function(e){cleverapps.lives&&cleverapps.lives.updateInfo(e,!0)},missions:function(e){cleverapps.missionManager&&cleverapps.missionManager.updateInfo(e,!0)},piggybank:function(e){cleverapps.piggyBank&&cleverapps.piggyBank.updateInfo(e,!0)},starchests:function(e){cleverapps.starChest&&(cleverapps.starChest.locked=!0,cleverapps.starChest.setStars(e.stars),cleverapps.starChest.save(!1),cleverapps.starChest.changeLockedListener())},packs:function(e){cleverapps.packManager&&(cleverapps.packManager.used=e.used,cleverapps.packManager.save(!1))},dailytasks:function(e){cleverapps.dailyTasks&&(cleverapps.dailyTasks.load(e),cleverapps.dailyTasks.save(!1))},gun:function(e){cleverapps.gun&&cleverapps.gun.updateInfo(e,!0)},heroes:function(e){"undefined"!=typeof match3&&match3&&match3.heroes&&match3.heroes.updateInfo(e,!0)},subscription:function(e
){cleverapps.subscription&&cleverapps.subscription.updateInfo(e,!0)},userdailycup:function(e){cleverapps.dailyCup&&cleverapps.dailyCup.updateInfo(e,!0)},userweeklycup:function(e){cleverapps.weeklyCup&&cleverapps.weeklyCup.updateInfo(e,!0)},forces:function(e){cleverapps.forces&&cleverapps.forces.updateInfo(e,!0)},metha:function(e){cleverapps.metha.getType()!==Metha.HOSE&&cleverapps.metha.getMainObject().updateInfo&&cleverapps.metha.getMainObject().updateInfo(e)},cookiejar:function(e){levels&&levels.cookieJar&&levels.cookieJar.updateValue(e,!0)},competitionstatistics:function(e){cleverapps.competitionStatistics&&cleverapps.competitionStatistics.updateInfo(e,!0)},cardskins:function(e){cleverapps.cardSkins&&cleverapps.cardSkins.updateInfo(e,!0)},units:function(e){cleverapps.unitSyncer&&cleverapps.unitSyncer.updateInfo(e,!0)}}};if(cleverapps.Synchronizer=function(){this._session="a";var e=cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.SESSION_SAVE_KEY,{raw:!0});null!=e&&(
this._session=e),this._syncIn=new cleverapps.SyncIn,this._syncOut=new cleverapps.SyncOut,this._syncInProgress=!1,this._needResync=!1,this._syncId=0,this._clientSessionExpired=!1,this.synced=!1,cleverapps.DataLoader.checkClientSession()||this.clientSessionExpired()},cleverapps.Synchronizer.prototype._startCheckInterval=function(){if(!this._checkIntervalRunned){this._checkIntervalRunned=!0;var e=0;return setInterval(function(){this.synced&&e%15!=0||this.syncWhenReady(),e++}.bind(this),6e4),!0}return!1},cleverapps.Synchronizer.prototype.needClientSessionExpiredWindow=function(){return this._clientSessionExpired},cleverapps.Synchronizer.prototype.showClientSessionExpiredWindow=function(){cleverapps.metha.display({focus:"clientSessionExpired",action:function(){new RestartWindow({title:"ClientSessionExpired.title",contentMessage:"ClientSessionExpired.message"})}})},cleverapps.Synchronizer.prototype.clientSessionExpired=function(){this._clientSessionExpired||(this.synced=!1,
this._clientSessionExpired=!0,cleverapps.allInitialized&&(cleverapps.metha.isFocused()||this.showClientSessionExpiredWindow()))},cleverapps.Synchronizer.prototype.reset=function(){this.synced=!1,this._loadedSession=void 0,this._loadedSync=void 0,this._session="a",this._syncInProgress=!1,this._needResync=!1,cc.sys.localStorage.removeItem(cleverapps.DataLoaderTypes.SESSION_SAVE_KEY),this._syncOut.reset()},cleverapps.Synchronizer.prototype.syncWhenReady=function(){cleverapps.DataLoader.checkClientSession(),this._syncInProgress?this._needResync=!0:this._sync()},cleverapps.Synchronizer.prototype.addUpdateTask=function(e){cleverapps.flags.norest||("users"!==e&&cleverapps.user.incProgressCompare(),this._syncOut.addUpdateTask(e))},cleverapps.Synchronizer.prototype.on=function(){this._clientSessionExpired||(void 0!==this._loadedSession&&(this._session=this._loadedSession,cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.SESSION_SAVE_KEY,this._session,{raw:!0}),
cleverapps.DataLoader.processSaveQueue()),this._loadedSession=void 0,this._loadedSync=void 0,this.synced=!0,this._syncOut.run(),this._onSyncLoaded(),this.onceSyncCompletedListener&&(this.onceSyncCompletedListener(),this.onceSyncCompletedListener=void 0),this._needResync&&(this._needResync=!1,this.syncWhenReady()))},cleverapps.Synchronizer.prototype._getPath=function(e){return"/"+e+"/"+cleverapps.user.id+"/"+this._session},cleverapps.Synchronizer.prototype._syncCallback=function(e){var t=this._syncId;return function(){this._syncId!==t||this._clientSessionExpired||e.apply(this,arguments)}.bind(this)},cleverapps.Synchronizer.prototype._sync=function(){if(!this._syncInProgress&&!this._clientSessionExpired){var t=this._startCheckInterval();this._syncId++,this._syncInProgress=!0;var n=this.synced;this.synced=!1;var s=cleverapps.social.getAccessToken()||"undefined",e=this._getPath("newsync")+"/"+s,i={episode:levels.user.episode,level:levels.user.level,progress:levels.user.progress,
progressCompare:cleverapps.user.progressCompare,exp:levels.user.exp,localStorageEnabled:cleverapps.DataLoader.enabled,localStorageCorrupted:cleverapps.DataLoader.corrupted,version:cleverapps.config.version};"merge"===cleverapps.config.type&&(i.game=cleverapps.GameSyncer.getInfo());var o=this._syncCallback(function(e){this._syncInProgress=!1,this._loadedSession=e.key,this._loadedSync=e.sync,void 0!==this._loadedSession?this._loadedSync?(console.log("sync in"),this._syncIn.process()):this._syncOut.process():this.on()}).bind(this),r=this._syncCallback(function(e){if(this._syncInProgress=!1,e&&403===e.status){if("undefined"===s&&cleverapps.social.getAccessToken())return void this.syncWhenReady();cleverapps.social.isLoggedIn()||(this.wantsSocialConnectWindow=!0,this.displaySocialConnectWindow())}else(t||n)&&setTimeout(function(){cleverapps.Notification.create("messages:Synchronizer.ErrorSavingProgress")},t?2500:0);this._onSyncLoaded()}).bind(this);cleverapps.RestClient.post(e,i,o,r)}},
cleverapps.Synchronizer.prototype.displaySocialConnectWindow=function(){cleverapps.metha.display({focus:"SynchronizerCheckConnection",actions:[function(e){cleverapps.social.checkConnection(function(){e(),this.syncWhenReady()}.bind(this),e,{withWindow:!0,errorMessage:"messages:FbConnectWindow.TryAgain"})}.bind(this),function(e){this.wantsSocialConnectWindow=!1,e()}.bind(this)]})},cleverapps.Synchronizer.prototype._onSyncLoaded=function(){this._onceFirstSyncCompletedListener&&(this._onceFirstSyncCompletedListener(),this._onceFirstSyncCompletedListener=void 0)},cleverapps.Synchronizer.SESSION_EXPIRED=99,cleverapps.SyncIn=function(){},cleverapps.SyncIn.prototype.executeSync=function(e){for(var t in cleverapps.synchronizer._clientSessionExpired&&(cleverapps.DataLoader.resetClientSession(),cleverapps.synchronizer._clientSessionExpired=!1),cleverapps.synchronizer._syncOut.reset(),e){var n=e[t],s=CustomSyncers.importerData[t];s?s(n):console.log("No importer for "+t)}
cleverapps.DataLoader.processSaveQueue()},cleverapps.SyncIn.prototype.sceneRefresh=function(){cleverapps.flags.reset(),levels&&(levels.reset(),cleverapps.windows.reset(),cleverapps.scenes.reset(),cleverapps.isKnockoutGame()&&cleverapps.metha.getMainObject().knockoutGame.stopRumble(),cleverapps.metha.distract({focus:"afterReloadWindow",action:function(e){cleverapps.metha.gotoMainScene(e)}}))},cleverapps.SyncIn.prototype.needShowReloadWindow=function(){return cleverapps.synchronizer._loadedSync},cleverapps.SyncIn.prototype.showReloadWindow=function(){cleverapps.metha.display({focus:"ReloadWindow",action:function(e){Game.currentGame&&Game.currentGame.stop(),new ReloadWindow(function(){this.needShowReloadWindow()?(this.executeSync(cleverapps.synchronizer._loadedSync),cleverapps.synchronizer.on(),this.sceneRefresh()):e()}.bind(this))}.bind(this)})},cleverapps.SyncIn.prototype.process=function(){cleverapps.scenes.isLoaderScene()&&!cleverapps.allInitialized?(this.executeSync(
cleverapps.synchronizer._loadedSync),cleverapps.synchronizer.on()):cleverapps.metha.isFocused()||this.showReloadWindow()},cleverapps.SyncOut=function(){this.task={},this.currentTask={},this.onTasksEmptyListener=function(){},this.inProgress=!1,this.sendNextUpdate=cleverapps.accumulate(cleverapps.SyncOut.ACCUMULATE_TIMEOUT,this._sendUpdateInner.bind(this)),(cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.SYNC)||[]).forEach(function(e){CustomSyncers.extractors[e]&&(this.task[e]=!0)},this)},cleverapps.SyncOut.prototype.run=function(){this.sendNextUpdate()},cleverapps.SyncOut.prototype.save=function(){var e=cleverapps.extend(this.currentTask,this.task);cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.SYNC,Object.keys(e))},cleverapps.SyncOut.prototype.reset=function(){this.task={},this.currentTask={},this.save()},cleverapps.SyncOut.prototype.nextTask=function(){this.currentTask=this.task,this.task={}},cleverapps.SyncOut.prototype.addUpdateTask=function(e){
CustomSyncers.extractors[e]&&!this.task[e]&&(this.task[e]=!0,this.save(),cleverapps.synchronizer.synced&&cleverapps.allInitialized&&this.sendNextUpdate())},cleverapps.SyncOut.prototype.onSuccess=function(e){if(this.inProgress=!1,cleverapps.synchronizer.synced){if(e.error&&e.error===cleverapps.Synchronizer.SESSION_EXPIRED)return console.log("onUpdate: session needs renewal"),cleverapps.synchronizer.reset(),void cleverapps.synchronizer.syncWhenReady();0===e&&console.log("error saving object"),this.currentTask={},this.save(),this.sendNextUpdate()}},cleverapps.SyncOut.prototype.onFailure=function(e){this.inProgress=!1,cleverapps.synchronizer.synced&&(console.log("Failure: ",e),this.task=cleverapps.extend(this.currentTask,this.task),this.currentTask={},setTimeout(this.sendNextUpdate.bind(this),cleverapps.SyncOut.RETRY_TIMEOUT))},cleverapps.SyncOut.prototype._sendUpdateInner=function(){cleverapps.DataLoader.onSaved(function(){if(!this.inProgress&&cleverapps.synchronizer.synced&&(
cleverapps.DataLoader.checkClientSession(),!cleverapps.synchronizer._clientSessionExpired))if(this.nextTask(),0!==Object.keys(this.currentTask).length){var e={};for(var t in this.currentTask){var n=CustomSyncers.extractors[t]();e[t]=n}this.inProgress=!0,console.log("Sending update ",e),cleverapps.RestClient.post(cleverapps.synchronizer._getPath("sync"),e,this.onSuccess.bind(this),this.onFailure.bind(this))}else this.onTasksEmptyListener()}.bind(this))},cleverapps.SyncOut.prototype.process=function(){for(var e in CustomSyncers.extractors)CustomSyncers.extractors[e]&&!this.task[e]&&(this.task[e]=!0);cleverapps.synchronizer.on()},cleverapps.SyncOut.RETRY_TIMEOUT=6e4,cleverapps.SyncOut.ACCUMULATE_TIMEOUT=2e3,RewardsConfig={Packs:[],Tournament:{},DailyCup:{}},"board"!==cleverapps.config.type&&"spades"!==cleverapps.config.name||(RewardsConfig={Tournament:{prepareByRich:!0,places:[{gold:300},{gold:250},{gold:200},{gold:100},{gold:50}]},Sale:{gold:500},TreasureSearch:{prepareByRich:!0,gold:100
},StickersCollection:{prepareByRich:!0,gold:100},DailyTask:{prepareByRich:!0,low:[{gold:80}],mid:[{gold:120}],hard:[{gold:160}]},DailyCup:{places:[{gold:400},{gold:250},{gold:150},{gold:50},{gold:50},{gold:50},{gold:50},{gold:50},{gold:50},{gold:50}]},Packs:[{gold:800},{gold:2600},{gold:17e3}],Subscription:{gold:600},MiniGame:[{gold:50},{gold:100}],MiniGameNovice:[{gold:50}],Favorite:{gold1800:{gold:300},gold3800:{gold:600},gold6000:{gold:1200},gold25000:{gold:5e3}}}),"match3"===cleverapps.config.type)var RewardsConfig={MiniGame:[{gold:50},{boosters:{5:1},gold:50},{boosters:{5:1}},{gold:50},{boosters:{6:1}},{boosters:{6:1},gold:50},{gold:50},{boosters:{7:1}},{boosters:{7:1},gold:50}],MiniGameBeginner:[{unlimitedLives:"30 minutes"}],MiniGameNovice:[{gold:50}],Tournament:{prepareByRich:!0,places:[{boosters:{5:2,6:2,7:2},unlimitedLives:"12 hours"},{boosters:{6:1,7:1},unlimitedLives:"6 hour"},{boosters:{5:1,6:1},unlimitedLives:"1 hour"},{boosters:{6:1},unlimitedLives:"45 minutes",exp:5},{
boosters:{5:1},unlimitedLives:"30 minutes",exp:3}]},Sale:{boosters:{0:1,1:1,2:1}},DailyTask:{prepareByRich:!0,low:[{boosters:{5:1}},{gold:50},{stars:3}],mid:[{boosters:{0:1},gold:50,exp:1},{boosters:{1:1},exp:1},{stars:4,gold:50,exp:1}],hard:[{boosters:{2:1},gold:50,exp:3},{boosters:{0:1,1:1},gold:50,exp:3},{boosters:{0:1,1:1,2:1},exp:3}]},TreasureSearch:{prepareByRich:!0,unlimitedLives:"12 hours",stars:10,exp:20},DailyCup:{places:[{unlimitedLives:"1 day",boosters:{5:5,6:5,7:5}},{unlimitedLives:"6 hours",boosters:{5:4,6:4,7:4}},{unlimitedLives:"3 hours",boosters:{5:3,6:3,7:3}},{unlimitedLives:"2 hour",boosters:{5:1,6:1,7:1}},{boosters:{5:1,6:1},unlimitedLives:"2 hour"},{boosters:{5:1,6:1},unlimitedLives:"2 hour"},{boosters:{5:1,6:1},unlimitedLives:"2 hour"},{boosters:{5:1},unlimitedLives:"1 hour"},{boosters:{5:1},unlimitedLives:"1 hour"},{boosters:{5:1},unlimitedLives:"1 hour"}]},Packs:[{boosters:{0:1,1:1,2:1},gold:300,unlimitedLives:"1 day"},{boosters:{2:3},gold:1800,
unlimitedLives:"3 day"},{boosters:{0:9,1:9,2:9},gold:12e3,unlimitedLives:"9 day"}],Subscription:{gold:300,exp:1,unlimitedLives:"2 hours",randomBoosters:{types:[0,1,2],amount:3}},Favorite:{sweetPack:{unlimitedLives:"12 hours",exp:3,stars:2},jamPack:{unlimitedLives:"1 day",exp:5,stars:4},tastyPack:{unlimitedLives:"2 days",exp:15,stars:6},honeyPack:{unlimitedLives:"3 days",exp:20,stars:8},epicPack:{unlimitedLives:"5 days",exp:40,stars:12},gold1800:{unlimitedLives:"1 day",exp:5,stars:4},gold3800:{unlimitedLives:"2 day",exp:15,stars:6},gold6000:{unlimitedLives:"3 day",exp:20,stars:8},gold25000:{unlimitedLives:"5 day",exp:40,stars:10}}};-1!==["tripeaks"].indexOf(cleverapps.config.name)&&(RewardsConfig={Sale:{gold:500},MiniGame:[{gold:50,randomBoosters:{types:[10,11,12],amount:1}},{gold:50,randomBoosters:{types:[10,11,12],amount:2}},{randomBoosters:{types:[10,11,12],amount:1}},{betGold:500,randomBoosters:{types:[10,11,12],amount:2}}],MiniGameBeginner:[{gold:50},{gold:100}],MiniGameNovice:[{
gold:50,randomBoosters:{types:[10,11,12],amount:1}}],TreasureSearch:{unlimitedLives:"12 hours",boosters:{10:1,11:1,12:1}},Tournament:{prepareByRich:!0,places:[{boosters:{10:2,11:2,12:2},unlimitedLives:"3 hours"},{boosters:{11:2,12:2},unlimitedLives:"1 hour"},{boosters:{10:1,11:1,12:1},unlimitedLives:"30 minutes"},{boosters:{11:1,12:1},unlimitedLives:"15 minutes"},{boosters:{10:1,11:1},unlimitedLives:"15 minutes"}]},DailyTask:{low:[{unlimitedLives:"15 minutes"}],mid:[{boosters:{11:1},gold:80}],hard:[{boosters:{12:2},gold:160,unlimitedLives:"15 minutes"}]},DailyCup:{places:[{unlimitedLives:"1 day",betGold:2400,boosters:{10:5,11:5,12:5}},{unlimitedLives:"6 hours",boosters:{10:4,11:4,12:4}},{unlimitedLives:"3 hours",boosters:{10:3,11:3,12:3}},{unlimitedLives:"1 hour",boosters:{10:2,11:2,12:2}},{unlimitedLives:"30 minutes",boosters:{10:1,11:1,12:1}},{unlimitedLives:"30 minutes",boosters:{10:1,11:1,12:1}},{unlimitedLives:"30 minutes",boosters:{10:1,11:1,12:1}},{unlimitedLives:"15 minutes",
betGold:50,boosters:{10:1,11:1,12:1}},{unlimitedLives:"15 minutes",betGold:50,boosters:{10:1,11:1,12:1}},{unlimitedLives:"15 minutes",betGold:50,boosters:{10:1,11:1,12:1}}]},Packs:[{boosters:{0:0,1:0,2:0,10:2,11:2,12:2},gold:200,unlimitedLives:void 0},{boosters:{0:0,1:0,2:0,10:6,11:6,12:6},gold:800},{boosters:{0:0,1:0,2:0,10:30,11:30,12:30},gold:8e3}],Subscription:{gold:250,unlimitedLives:"3 hours",boosters:{10:2,11:2,12:2}},Favorite:{gold1800:{unlimitedLives:"1 day",gold:150},gold3800:{unlimitedLives:"2 day",gold:300},gold6000:{unlimitedLives:"3 day",gold:600},gold25000:{unlimitedLives:"5 day",gold:2500},sweetPack:{unlimitedLives:"30 minutes",boosters:{10:1,11:1,12:1}},jamPack:{gold:250,boosters:{10:1,11:1,12:1},unlimitedLives:"2 hours"},tastyPack:{gold:550,boosters:{10:2,11:2,12:2},unlimitedLives:"6 hours"},honeyPack:{gold:750,boosters:{10:3,11:3,12:3},unlimitedLives:"12 hours"},epicPack:{gold:5e3,boosters:{10:6,11:6,12:6},unlimitedLives:"1 day"}}}),
"differences"===cleverapps.config.type&&(RewardsConfig={Tournament:{prepareByRich:!0,places:[{boosters:{8:3,9:3},unlimitedLives:"3 hours"},{boosters:{8:2,9:2},unlimitedLives:"1 hour"},{boosters:{8:1,9:1},unlimitedLives:"30 minutes"},{boosters:{8:1},unlimitedLives:"15 minutes"},{boosters:{9:1},unlimitedLives:"15 minutes"}]},Sale:{boosters:{8:1,9:1}},DailyTask:{low:[{unlimitedLives:"15 minutes"}],mid:[{gold:80,boosters:{8:1}}],hard:[{gold:160,unlimitedLives:"15 minutes",boosters:{8:1,9:1}}]},MiniGame:[{gold:50,randomBoosters:{types:[8,9],amount:1}},{gold:100}],MiniGameBeginner:[{gold:50,randomBoosters:{types:[8,9],amount:1}},{gold:100}],MiniGameNovice:[{gold:50,randomBoosters:{types:[8,9],amount:1}}],TreasureSearch:{unlimitedLives:"12 hours",boosters:{8:1,9:2}},DailyCup:{places:[{unlimitedLives:"1 day",boosters:{2:1}},{unlimitedLives:"6 hours",boosters:{1:1}},{unlimitedLives:"3 hours",boosters:{0:1}},{unlimitedLives:"1 hour"},{unlimitedLives:"30 minutes"},{unlimitedLives:"30 minutes"},{
unlimitedLives:"30 minutes"},{unlimitedLives:"15 minutes"},{unlimitedLives:"15 minutes"},{unlimitedLives:"15 minutes"}]},Packs:[{boosters:{0:0,1:0,2:0,8:2,9:2},gold:200},{boosters:{0:0,1:0,2:0,8:6,9:6},gold:800},{boosters:{0:0,1:0,2:0,8:30,9:30},gold:8e3}],Subscription:{unlimitedLives:"3 hours",gold:250,boosters:{8:3,9:3}},WeeklyCup:{places:[{gold:3e3},{gold:2e3},{gold:1e3},{gold:200},{gold:200},{gold:200},{gold:200},{gold:200},{gold:200},{gold:200}]}}),"olympics"===cleverapps.config.name&&(RewardsConfig.Subscription={gold:600,unlimitedLives:"3 hours"},RewardsConfig.TreasureSearch={unlimitedLives:"12 hours"},RewardsConfig.WeeklyCup={places:[{gold:3e3},{gold:2e3},{gold:1e3},{gold:200},{gold:200},{gold:200},{gold:200},{gold:200},{gold:200},{gold:200}]},RewardsConfig.Favorite={gold1800:{unlimitedLives:"1 day",gold:150},gold3800:{unlimitedLives:"2 day",gold:300},gold6000:{unlimitedLives:"3 day",gold:600},gold25000:{unlimitedLives:"5 day",gold:2500}}),"scramble"===cleverapps.config.name&&(
RewardsConfig.Tournament={prepareByRich:!0,places:[{boosters:{13:2,14:2,15:2}},{boosters:{14:2,15:2}},{boosters:{13:1,14:1,15:1}},{boosters:{14:1,15:1}},{boosters:{13:1,14:1}}]},RewardsConfig.Packs=[{boosters:{13:2,14:2,15:2},gold:200},{boosters:{13:6,14:6,15:6},gold:800},{boosters:{13:30,14:30,15:30},gold:8e3}],RewardsConfig.DailyTask={low:[{boosters:{13:1}}],mid:[{boosters:{14:1},gold:80}],hard:[{boosters:{15:2},gold:160}]},RewardsConfig.DailyCup={places:[{boosters:{13:5,14:5,15:5},gold:300},{boosters:{13:4,14:4,15:4},gold:200},{boosters:{13:3,14:3,15:3},gold:100},{boosters:{13:2,14:2,15:2},gold:50},{boosters:{13:1,14:1,15:1},gold:50},{boosters:{13:1,14:1,15:1},gold:50},{boosters:{13:1,14:1,15:1},gold:50},{boosters:{13:1,14:1,15:1}},{boosters:{13:1,14:1,15:1}},{boosters:{13:1,14:1,15:1}}]},RewardsConfig.MiniGame=[{gold:50,randomBoosters:{types:[14,15],amount:1}},{gold:50,randomBoosters:{types:[14,15],amount:2}},{randomBoosters:{types:[14,15],amount:1}},{randomBoosters:{types:[14,15],
amount:2}}],RewardsConfig.MiniGameBeginner=[{gold:50},{gold:100}],RewardsConfig.MiniGameNovice=[{gold:50,randomBoosters:{types:[13,14,15],amount:1}}],RewardsConfig.Subscription={gold:250,boosters:{13:2,14:2,15:2}},RewardsConfig.Favorite.sweetPack={boosters:{13:1,14:1,15:1}},RewardsConfig.Favorite.jamPack={gold:250,boosters:{13:1,14:1,15:1}},RewardsConfig.Favorite.tastyPack={gold:550,boosters:{13:2,14:2,15:2}},RewardsConfig.Favorite.honeyPack={gold:750,boosters:{13:3,14:3,15:3}},RewardsConfig.Favorite.epicPack={gold:5e3,boosters:{13:6,14:6,15:6}},RewardsConfig.TreasureSearch={gold:100,boosters:{13:1,14:1,15:1}}),-1!==["heroes","runes","riddles","adventure","mergeriddles","mergeheroes"].indexOf(cleverapps.config.name)&&(RewardsConfig.Packs=[{boosters:{5:1,6:1,7:1},gold:500,unlimitedLives:"1 day"},{boosters:{5:2,6:2,7:2},gold:1800,unlimitedLives:"3 day"},{boosters:{5:14,6:14,7:14},gold:12e3,unlimitedLives:"9 day"}]),"merge"===cleverapps.config.type&&(RewardsConfig.Packs=[{gold:50,
energy:200},{gold:100,energy:350,wands:250,worker:"3 day"},{gold:1e3,energy:1500,wands:500,coins:3e3,worker:"5 day"}],RewardsConfig.Tournament={places:[{unit:{code:"treasure",stage:2,amount:1}},{unit:{code:"treasure",stage:1,amount:1}},{unit:{code:"treasure",stage:0,amount:1}}]}),RewardsConfig.BonusWorld=[{level:3,reward:{boosters:{13:1,14:1}}},{level:8,reward:{gold:50,boosters:{13:1,14:1}}},{level:15,reward:{gold:200,boosters:{13:1,14:1,15:1}}}],"match3"===cleverapps.config.type&&(RewardsConfig.BonusWorld=[{level:3,reward:{unlimitedLives:"1 hour"}},{level:8,reward:{unlimitedLives:"1 hours",exp:5,boosters:{5:1,6:1}}},{level:15,reward:{gold:150,unlimitedLives:"24 hours",boosters:{5:1,6:1,7:1}}}]);var RewardsHelper={iconByRewardName:function(e){return RewardsHelper.ICONS[e]},textByRewardName:function(e,t,n){var s=""+t;return"unlimitedLives"===e?s=Messages.get(Product.FormatUnlimitedLives(t,n.short).title):-1===["stars","exp","gold"].indexOf(e)&&isNaN(parseInt(e))||(s=(n.itemsPrefix||""
)+s),s},getDisplayData:function(e,t){t=t||{};var n={};for(var s in e)if("boosters"===s)for(var i in e.boosters)n["booster_"+i]={img:RewardsHelper.iconByRewardName(i),txt:RewardsHelper.textByRewardName(i,e.boosters[i],t)};else n[s]={img:RewardsHelper.iconByRewardName(s),txt:RewardsHelper.textByRewardName(s,e[s],t)};return n}};RewardsHelper.ICONS={unlimitedLives:bundles.reward_icons.frames.life_unlim_small,gold:bundles.reward_icons.frames.gold_small_png,stars:bundles.reward_icons.frames.stars_small_png,exp:bundles.reward_icons.frames.reward_exp_small_png,0:bundles.reward_icons.frames.cellbooster,1:bundles.reward_icons.frames.linebooster,2:bundles.reward_icons.frames.colorbooster,3:bundles.reward_icons.frames.gold_small_png,4:bundles.reward_icons.frames.joker_png,5:bundles.reward_icons.frames.heroes_png,6:bundles.reward_icons.frames.moves_png,7:bundles.reward_icons.frames.multicolor_png,8:bundles.reward_icons.frames.hat,9:bundles.reward_icons.frames.pot,
10:bundles.reward_icons.frames.magnet_small_png,11:bundles.reward_icons.frames.dice_small_png,12:bundles.reward_icons.frames.joker_small_png,13:bundles.reward_icons.frames.highlight,14:bundles.reward_icons.frames.eye,15:bundles.reward_icons.frames.hint};var RewardedAdsManager=function(){RewardedAdsManager.IsEnabled()&&("undefined"==typeof sdkbox&&(sdkbox={}),PlingaAds.isAppropriate()?sdkbox.PluginSdkboxAds=new PlingaAds:WebViewAds.isAppropriate()?sdkbox.PluginSdkboxAds=new WebViewAds:OKAppAds.isAppropriate()?sdkbox.PluginSdkboxAds=new OKAppAds:OKAds.isAppropriate()?sdkbox.PluginSdkboxAds=new OKAds:cleverapps.Instant.isAppropriate()?sdkbox.PluginSdkboxAds=new InstantAds:VideoAds.isAppropriate()&&(sdkbox.PluginSdkboxAds=new VideoAds),this.onStartPlayListeners={},this.onEndPlayListeners={},this.onRewardListeners={},this.load(),sdkbox.PluginSdkboxAds.setListener({onAdAction:function(e,t,n){switch(console.log("RewardedAdsManager onAdAction "+JSON.stringify(arguments)),n){
case RewardedAdsManager.AD_ACTION_TYPE.LOADED:cleverapps.eventLogger.logEvent(cleverapps.EVENTS.AD_READY+"_"+t),cleverapps.playSession.set(cleverapps.EVENTS.AD_READY+"_"+t,!0);break;case RewardedAdsManager.AD_ACTION_TYPE.LOAD_FAILED:setTimeout(this.cacheNextAd.bind(this,t),cleverapps.parseInterval(RewardedAdsManager.NEXT_AD_ERROR_DELAY));break;case RewardedAdsManager.AD_ACTION_TYPE.AD_STARTED:case RewardedAdsManager.AD_ACTION_TYPE.REWARD_STARTED:cleverapps.audio.mute(),cleverapps.eventLogger.logEvent(cleverapps.EVENTS.AD_START+"_"+t),t===RewardedAdsManager.INTERSTITIAL&&cleverapps.dailyTasks.addProgress(cleverapps.DailyTask.WATCH_ADS),this.runListeners(this.onStartPlayListeners,t);break;case RewardedAdsManager.AD_ACTION_TYPE.AD_ENDED:case RewardedAdsManager.AD_ACTION_TYPE.AD_CANCELED:case RewardedAdsManager.AD_ACTION_TYPE.REWARD_ENDED:case RewardedAdsManager.AD_ACTION_TYPE.REWARD_CANCELED:cleverapps.audio.unmute(),setTimeout(this.cacheNextAd.bind(this,t),cleverapps.parseInterval(
RewardedAdsManager.NEXT_AD_DELAY)),this.runListeners(this.onEndPlayListeners,t)}}.bind(this),onRewardAction:function(e,t,n,s){console.log("RewardedAdsManager onRewardAction "+JSON.stringify(arguments)),cleverapps.history.add("video",1),RewardedAdsManager.rewardTime=Date.now(),cleverapps.eventLogger.logEvent(cleverapps.EVENTS.AD_FINISH+"_"+t),cleverapps.user.channel&&cleverapps.eventLogger.logEvent("ad_r_"+cleverapps.user.channel),cleverapps.dailyTasks.addProgress(cleverapps.DailyTask.WATCH_ADS),setTimeout(function(){this.runListeners(this.onRewardListeners,t)}.bind(this),0),cleverapps.playSession.inc(cleverapps.EVENTS.REWARDED_WATCHED),this.data.reward[t]=Date.now(),this.save()}.bind(this)}),this.cacheQueue={},setInterval(this.checkCacheQueue.bind(this),cleverapps.parseInterval("1 minute")))};RewardedAdsManager.prototype.init=function(){RewardedAdsManager.IsEnabled()&&sdkbox.PluginSdkboxAds&&sdkbox.PluginSdkboxAds.init(function(){RewardedAdsManager.ACTIVE_ADS.forEach(
this.cacheNextAd.bind(this))}.bind(this))},RewardedAdsManager.prototype.checkCacheQueue=function(){var e=this.cacheQueue;this.cacheQueue={},Object.keys(e).forEach(function(e){this.cacheNextAd(e)}.bind(this))},RewardedAdsManager.prototype.cacheNextAd=function(e){e=e||RewardedAdsManager.REWARDED,this.canCache(e)?(console.log("RewardedAdsManager caching "+e),sdkbox.PluginSdkboxAds.cache(RewardedAdsManager.ADMOB,e)):this.cacheQueue[e]=!0},RewardedAdsManager.prototype.isAvailable=function(e){return e=e||RewardedAdsManager.REWARDED,levels.user.checkAvailable(RewardedAdsManager.AVAILABLE)&&RewardedAdsManager.IsEnabled()&&sdkbox.PluginSdkboxAds.isAvailable(e)},RewardedAdsManager.prototype.play=function(e,t,n){if(this.isAvailable(e))"function"==typeof t&&(this.onRewardListeners[e]=t),e=e||RewardedAdsManager.REWARDED,sdkbox.PluginSdkboxAds.playAd("AdMob",e);else if(n&&this.canCache(e)){cleverapps.rewardedAdsManager.cacheNextAd(e);var s=new WaitWindow,i=Date.now(),o=setInterval(function(){if(
this.isAvailable(e)||Date.now()>i+1e4)return s.close(!0),clearInterval(o),void this.play(e,t)}.bind(this),1e3)}else cleverapps.Notification.create("messages:AdsUnavailable")},RewardedAdsManager.prototype.canCache=function(e){return e=e||RewardedAdsManager.REWARDED,!(!RewardedAdsManager.IsEnabled()||-1===RewardedAdsManager.ACTIVE_ADS.indexOf(e)||!levels.user.checkAvailable(RewardedAdsManager.AVAILABLE))&&(e===RewardedAdsManager.REWARDED||!!levels.user.checkAvailable(RewardedAdsManager.INTERSTITIAL_AVAILABLE)&&(!cleverapps.paymentsHistory.isPayer()&&(!((this.data.reward[RewardedAdsManager.REWARDED]||0)+cleverapps.parseInterval(RewardedAdsManager.INTERSTITIAL_REWARD_INTERVAL)>Date.now())&&(!((this.data.reward[RewardedAdsManager.INTERSTITIAL]||0)+cleverapps.parseInterval(RewardedAdsManager.INTERSTITIAL_INTERVAL)>Date.now())&&0<RewardedAdsManager.INTERSTITIAL_PROB[Math.min(levels.user.episode,RewardedAdsManager.INTERSTITIAL_PROB.length-1)]))))},
RewardedAdsManager.prototype.showInterstitial=function(){if(this.isAvailable(RewardedAdsManager.INTERSTITIAL)&&this.canCache(RewardedAdsManager.INTERSTITIAL)){var e=RewardedAdsManager.INTERSTITIAL_PROB[Math.min(levels.user.episode,RewardedAdsManager.INTERSTITIAL_PROB.length-1)];Math.random()<e&&(this.play(RewardedAdsManager.INTERSTITIAL),this.data.reward[RewardedAdsManager.INTERSTITIAL]=Date.now(),this.save())}},RewardedAdsManager.prototype.runListeners=function(e,t){for(var n in e)0===n.indexOf(t)&&e[n]()},RewardedAdsManager.prototype.load=function(){var e=cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.REWARDED_ADS_MANAGER);e||(e={}),e.reward||(e.reward={}),this.data=e},RewardedAdsManager.prototype.save=function(){cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.REWARDED_ADS_MANAGER,this.data)},RewardedAdsManager.ADMOB="AdMob",RewardedAdsManager.REWARDED="rewarded",RewardedAdsManager.INTERSTITIAL="interstitial",RewardedAdsManager.ACTIVE_ADS=[RewardedAdsManager.REWARDED],
RewardedAdsManager.NEXT_AD_DELAY="10 seconds",RewardedAdsManager.NEXT_AD_ERROR_DELAY="3 minutes",RewardedAdsManager.AVAILABLE={episode:0,level:10},RewardedAdsManager.INTERSTITIAL_PROB=[0,0,.3,.3,.5,.5,.7,1],RewardedAdsManager.INTERSTITIAL_REWARD_INTERVAL="3 day",RewardedAdsManager.INTERSTITIAL_INTERVAL="10 minutes","merge"===cleverapps.config.type&&(RewardedAdsManager.AVAILABLE={episode:0,level:2},RewardedAdsManager.INTERSTITIAL_PROB=[1],RewardedAdsManager.INTERSTITIAL_AVAILABLE={episode:0,level:5}),RewardedAdsManager.AD_ACTION_TYPE={LOADED:0,LOAD_FAILED:1,CLICKED:2,REWARD_STARTED:3,REWARD_ENDED:4,REWARD_CANCELED:5,AD_STARTED:6,AD_CANCELED:7,AD_ENDED:8,ADACTIONTYPE_UNKNOWN:9},RewardedAdsManager.IsEnabled=function(){var e=cleverapps.User.calcSource();if(-1===["huzcom","pliega"].indexOf(e)&&(!cleverapps.flags||!cleverapps.flags.noads||cleverapps.config.debugMode))return cc.sys.isNative||cleverapps.isLocalhost()||-1!==["web_ok","mobile_ok","plinga","instant"].indexOf(e)}
;var FlyingHint=function(e,t){cleverapps.EventEmitter.call(this),cleverapps.flags.reduceAds&&(FlyingHint.INTERVAL="20 minutes"),cleverapps.flags.videoAdsMainMonetization&&(FlyingHint.INTERVAL="5 minutes"),cleverapps.config.debugMode&&(FlyingHint.INTERVAL="30 seconds",FlyingHint.START_PLAY_INTERVAL="30 seconds",FlyingHint.CHECK_INTERVAL="1 seconds"),this.game=e,this.onReward=t,this.game.counter.registerStage(1001,function(){this.ready&&this.enable()}.bind(this)),FlyingHint.IsAvailable()&&setTimeout(this.checkIfReady.bind(this),cleverapps.parseInterval(FlyingHint.GAME_START_DELAY)),RewardedAdsManager.IsEnabled()&&(cleverapps.rewardedAdsManager.onStartPlayListeners[RewardedAdsManager.REWARDED+"_adicon"]=this.startPlay.bind(this),"ios"===cleverapps.User.calcSource()&&(cleverapps.rewardedAdsManager.onEndPlayListeners[RewardedAdsManager.REWARDED+"_adicon"]=this.startPlay.bind(this)))};FlyingHint.prototype=Object.create(cleverapps.EventEmitter.prototype),(
FlyingHint.prototype.constructor=FlyingHint).prototype.onClick=function(){this.enabled&&(this.trigger("activate"),this.game.counter.setTimeout(function(){this.playAds()}.bind(this),1e3))},FlyingHint.prototype.playAds=function(){RewardedAdsManager.IsEnabled()?cleverapps.rewardedAdsManager.play(RewardedAdsManager.REWARDED,this.reward.bind(this)):(this.startPlay(),this.reward())},FlyingHint.prototype.checkIfReady=function(){Game.currentGame===this.game&&(this.isReady()?(this.ready=!0,this.game.counter.isActive()||this.enable()):setTimeout(this.checkIfReady.bind(this),cleverapps.parseInterval(FlyingHint.CHECK_INTERVAL)))},FlyingHint.prototype.isReady=function(){return(cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.AD_ICON,{raw:!0})||0)<Date.now()&&(FlyingHint.debugHint||cleverapps.rewardedAdsManager.isAvailable(RewardedAdsManager.REWARDED))},FlyingHint.prototype.enable=function(){this.enabled||cleverapps.metha.isFocused()||(this.enabled=!0,this.trigger("enable"))},
FlyingHint.prototype.disable=function(){this.enabled&&(this.enabled=!1,this.trigger("disable"))},FlyingHint.prototype.reward=function(){cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.AD_ICON,Date.now()+cleverapps.parseInterval(FlyingHint.INTERVAL),{raw:!0}),this.onReward(),cleverapps.eventLogger.logEvent(cleverapps.EVENTS.REWARDED_HINT)},FlyingHint.prototype.startPlay=function(){this.enabled&&(cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.AD_ICON,Date.now()+cleverapps.parseInterval(FlyingHint.START_PLAY_INTERVAL),{raw:!0}),this.ready=!1,this.disable(),this.checkIfReady())},FlyingHint.IsAvailable=function(){return RewardedAdsManager.IsEnabled()&&levels.user.checkAvailable(RewardedAdsManager.AVAILABLE)&&cleverapps.paymentsHistory.classify()<=cleverapps.PaymentsHistory.PAYER_NORMAL},FlyingHint.INTERVAL="10 minutes",FlyingHint.START_PLAY_INTERVAL="1 minute",FlyingHint.CHECK_INTERVAL="30 seconds",FlyingHint.GAME_START_DELAY="10 seconds";var FlyingHintView=cc.Node.extend({
ctor:function(e){this._super(),cleverapps.config.debugMode&&(FlyingHintView.TIMEOUT=30),this.setAnchorPoint2(),this.flyingHint=e;var t=cleverapps.styles.FlyingHintView;this.setContentSize2(t),this.animation=new cleverapps.Spine(bundles.game.jsons.flying_hint_json),this.animation.setSkin("normal"),this.addChild(this.animation),this.animation.setPositionRound(t.animation),this.setVisible(!1),cleverapps.wideMode.mode===cleverapps.WideMode.VERTICAL&&(this.setScale(t.mobile.scale),this.baseScale=this.scale),this.onMouseOver=function(){this.animation.setSkin("hover")}.bind(this),this.onMouseOut=function(){this.animation.setSkin("normal")}.bind(this),cleverapps.UI.applyHover(this),cleverapps.UI.onClick(this,this.flyingHint.onClick.bind(this.flyingHint)),this.setLocalZOrder(10),cleverapps.metha.registerControl("flyingHint",function(e){this.enabled&&this.setVisible(e)}.bind(this)),this.enable(),this.flyingHint.on("disable",this.createListener(this.disable.bind(this))),this.flyingHint.on(
"enable",this.createListener(this.enable.bind(this))),this.flyingHint.on("activate",this.createListener(this.disappear.bind(this)))},disappear:function(){this.stopAllActions(),this.enabled=!1,this.animation.setAnimation(0,"application",!1),this.animation.setCompleteListener(function(){this.setVisible(!1),this.animation.setCompleteListener(function(){})}.bind(this))},runMoveAnimation:function(){var e=cc.director.getRunningScene().scene,t=cleverapps.styles.FlyingHintView;this.setPositionRound(e.width/2,e.height/2+t.yOffset),this._runMoveAnimation(1,0)},_runMoveAnimation:function(e,t){if(t>FlyingHintView.TOTAL_FLY_TIMEOUT)return this.disappear(),void this.runAction(new cc.Sequence(new cc.DelayTime(1),new cc.Hide,new cc.DelayTime(FlyingHintView.TIMEOUT),new cc.CallFunc(function(){this.enable()}.bind(this))));var n,s=cc.director.getRunningScene().scene,i=cleverapps.styles.FlyingHintView,o=cleverapps.wideMode.mode===cleverapps.WideMode.VERTICAL?i.mobile.xBorderOffset:i.xBorderOffset;0<e?(
n=cc.p(s.width-o,this.y),this.animation.setScaleX(1)):(n=cc.p(o,this.y),this.animation.setScaleX(-1));var r=cleverapps.styles.FlyingHintView.speed,a=cc.pDistance(this.getPosition(),n)/r,c=Math.round(a/7),l=new cc.MoveBy(a,cc.p(n.x-this.getPosition().x,0));if(0<c){for(var p=[],d=a/c/2,u=0;u<c;u++)p.push(new cc.MoveBy(d/2,cc.p(0,cleverapps.styles.FlyingHintView.animation.dy/2))),p.push(new cc.MoveBy(d,cc.p(0,-cleverapps.styles.FlyingHintView.animation.dy))),p.push(new cc.MoveBy(d/2,cc.p(0,cleverapps.styles.FlyingHintView.animation.dy/2)));l=new cc.Spawn(l,new cc.Sequence(p))}this.runAction(new cc.Sequence(l,new cc.CallFunc(function(){this._runMoveAnimation(-e,t+a)}.bind(this))))},enable:function(){this.flyingHint.enabled&&(this.enabled=!0,this.stopAllActions(),this.setVisible(!cleverapps.metha.isFocused()),this.animation.setAnimationAndIdleAfter("appearance","idle"),this.runMoveAnimation())},disable:function(){this.enabled=!1,this.stopAllActions(),this.setVisible(!1)}})
;FlyingHintView.TOTAL_FLY_TIMEOUT=45,FlyingHintView.TIMEOUT=300,cleverapps.styles.FlyingHintView={width:200,height:200,mobile:{xBorderOffset:160,scale:.8},animation:{x:{align:"center"},y:{align:"center",dy:-30},dy:60},yOffset:375,xBorderOffset:300,speed:80};var AdsPlugin=function(){};AdsPlugin.prototype.init=function(e){e()};var VideoAds=function(){this.loading={},this.cached={},AdsPlugin.call(this),this.listener={onAdAction:function(e,t,n){},onRewardAction:function(e,t,n,s){}}};VideoAds.prototype=Object.create(AdsPlugin.prototype),(VideoAds.prototype.constructor=VideoAds).isAppropriate=function(){return cleverapps.isLocalhost()},VideoAds.prototype.setListener=function(e){this.listener=e},VideoAds.prototype.cache=function(e,t){this.loading[t]?console.log("Loading in progress, skipping request"):(this.loading[t]=!0,setTimeout(function(){delete this.loading[t],this.cached[t]=!0,this.listener.onAdAction(e,t,RewardedAdsManager.AD_ACTION_TYPE.LOADED)}.bind(this),3e3))},
VideoAds.prototype.isAvailable=function(e){return this.cached[e]},VideoAds.prototype.playAd=function(e,t){if(this.cached[t]){this.listener.onAdAction(e,t,RewardedAdsManager.AD_ACTION_TYPE.AD_STARTED);var n=cc.director.getRunningScene(),s=n.width,i=n.height;this.overlay=new cc.LayerColor(new cc.Color(200,200,255,255),s,i),cc.eventManager.addListener({event:cc.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:!0,onTouchBegan:function(){return!0}},this.overlay),n.addChild(this.overlay);var o={font:cleverapps.styles.FONTS.BUTTON_TEXT,width:300*resolutionScale,height:100*resolutionScale,padding:20,onClicked:function(){this.stop(t)}.bind(this),text:"Skip ad"},r=new cleverapps.UI.Button(o);r.setPositionRound(this.overlay.width/2,200),r.disable(),this.waitForReward=setTimeout(function(){t===RewardedAdsManager.REWARDED&&this.listener.onRewardAction(e,t,"gold",1),this.stop(t)}.bind(this),3e3),delete this.cached[t],r.runAction(new cc.Sequence(new cc.DelayTime(1),new cc.CallFunc(function(){r.enable()}
))),this.overlay.addChild(r)}else console.log("Show: No video cached!")},VideoAds.prototype.stop=function(e){this.overlay&&(clearTimeout(this.waitForReward),this.listener.onAdAction("AdMob",e,RewardedAdsManager.AD_ACTION_TYPE.AD_CANCELED),delete this.cached[e],this.overlay.isRunningSafe()&&this.overlay.removeFromParent(!0))};var OKAds=function(){this.cached={},this.inited=!1,AdsPlugin.call(this),this.listener={onAdAction:function(e,t,n){},onRewardAction:function(e,t,n,s){}},RewardedAdsManager.ACTIVE_ADS=[RewardedAdsManager.REWARDED,RewardedAdsManager.INTERSTITIAL]};OKAds.prototype=Object.create(AdsPlugin.prototype),(OKAds.prototype.constructor=OKAds).isAppropriate=function(){return cleverapps.OK.isAppropriate()||cleverapps.MobileOK.isAppropriate()},OKAds.prototype.init=function(e){cleverapps.whenAllInitialized(function(){this.isInitialized()&&(this.inited=!0,e())}.bind(this))},OKAds.prototype.setListener=function(e){this.listener=e},OKAds.prototype.log=function(e){console.log(e)},
OKAds.prototype.windowApiCallbackRewarded=function(e,t){this.log("window.API_callback "+e+" "+JSON.stringify(t)),"error"===e?this.listener.onAdAction(RewardedAdsManager.ADMOB,RewardedAdsManager.REWARDED,RewardedAdsManager.AD_ACTION_TYPE.LOAD_FAILED):"ready"===t||"ad_prepared"===t?(this.cached[RewardedAdsManager.REWARDED]=!0,this.listener.onAdAction(RewardedAdsManager.ADMOB,RewardedAdsManager.REWARDED,RewardedAdsManager.AD_ACTION_TYPE.LOADED)):"complete"!==t&&"ad_shown"!==t||(this.listener.onAdAction(RewardedAdsManager.ADMOB,RewardedAdsManager.REWARDED,RewardedAdsManager.AD_ACTION_TYPE.AD_ENDED),this.listener.onRewardAction(RewardedAdsManager.ADMOB,RewardedAdsManager.REWARDED))},OKAds.prototype.windowApiCallbackInterstitial=function(e,t){this.log("window.API_callback "+e+" "+JSON.stringify(t)),"no_ads"===t||"error"===e?this.listener.onAdAction(RewardedAdsManager.ADMOB,RewardedAdsManager.INTERSTITIAL,RewardedAdsManager.AD_ACTION_TYPE.LOAD_FAILED):"ad_prepared"===t?(
this.listener.onAdAction(RewardedAdsManager.ADMOB,RewardedAdsManager.INTERSTITIAL,RewardedAdsManager.AD_ACTION_TYPE.LOADED),cleverapps.social.listeners.showAd=this.windowApiCallbackInterstitial.bind(this)):"ad_shown"===t&&this.listener.onAdAction(RewardedAdsManager.ADMOB,RewardedAdsManager.INTERSTITIAL,RewardedAdsManager.AD_ACTION_TYPE.AD_ENDED),this.cache(RewardedAdsManager.ADMOB,RewardedAdsManager.INTERSTITIAL)},OKAds.prototype.cache=function(e,t){this.inited&&(RewardedAdsManager.REWARDED===t?(FAPI.UI.loadAd(),cleverapps.social.listeners.loadAd=this.windowApiCallbackRewarded.bind(this)):RewardedAdsManager.INTERSTITIAL===t&&(this.cached[RewardedAdsManager.INTERSTITIAL]=!0))},OKAds.prototype.isAvailable=function(e){return this.cached[e]},OKAds.prototype.isInitialized=function(){return"undefined"!=typeof FAPI&&FAPI.UI.showAd&&FAPI.UI.showLoadedAd},OKAds.prototype.playAd=function(e,t){this.inited&&this.cached[t]&&(this.cached[t]=void 0,FullscreenControlButton.exitFullscreen(function(){
t===RewardedAdsManager.REWARDED?(FAPI.UI.showLoadedAd(),cleverapps.social.listeners.showLoadedAd=this.windowApiCallbackRewarded.bind(this)):t===RewardedAdsManager.INTERSTITIAL&&(FAPI.UI.showAd(),cleverapps.social.listeners.showAd=this.windowApiCallbackInterstitial.bind(this)),this.listener.onAdAction(e,t,RewardedAdsManager.AD_ACTION_TYPE.AD_STARTED)}.bind(this)))};var OKAppAds=function(){OKAds.call(this)};OKAppAds.prototype=Object.create(OKAds.prototype),(OKAppAds.prototype.constructor=OKAppAds).prototype.isInitialized=function(){return"undefined"!=typeof FAPI&&FAPI.UI.showAd&&FAPI.UI.showLoadedAd&&FAPI.UI.isNativeAdSupported&&FAPI.UI.isNativeAdSupported()},OKAppAds.isAppropriate=function(){return cleverapps.MobileOK.isAppropriate()&&cleverapps.isOkApp()};var PlingaAds=function(){this.inited=!1,RewardedAdsManager.ACTIVE_ADS=[RewardedAdsManager.REWARDED,RewardedAdsManager.INTERSTITIAL],(cleverapps.isLocalhost()||cleverapps.isStagingHost())&&cleverapps.extend(this,FakePlingaAds),
AdsPlugin.call(this),this.cached={},this.playing=void 0,this.reward=!1,this.listener={onAdAction:function(e,t,n){},onRewardAction:function(e,t,n,s){}},RewardedAdsManager.AVAILABLE={episode:0,level:0},RewardedAdsManager.INTERSTITIAL_AVAILABLE={episode:0,level:0},RewardedAdsManager.INTERSTITIAL_PROB=[1],RewardedAdsManager.INTERSTITIAL_REWARD_INTERVAL="0 seconds",RewardedAdsManager.INTERSTITIAL_INTERVAL="5 minutes"};PlingaAds.prototype=Object.create(AdsPlugin.prototype),(PlingaAds.prototype.constructor=PlingaAds).isAppropriate=function(){return cleverapps.social instanceof cleverapps.Plinga},PlingaAds.prototype.init=function(e){cleverapps.social.whenInitialized("plingaads",function(){cleverapps.social.eventListener=this.onEvent.bind(this),cleverapps.whenAllInitialized(function(){console.log("plinga social inited - cache ads"),this.inited=!0,e()}.bind(this))}.bind(this))},PlingaAds.prototype.onEvent=function(e){if(this.playing)switch(e.name){case"USER_CLOSE":case"SKIPPED":
this.listener.onAdAction(RewardedAdsManager.ADMOB,this.playing,this.lastAction=RewardedAdsManager.AD_ACTION_TYPE.AD_CANCELED);break;case"STARTED":this.listener.onAdAction(RewardedAdsManager.ADMOB,this.playing,this.lastAction=RewardedAdsManager.AD_ACTION_TYPE.AD_STARTED);break;case"ALL_ADS_COMPLETED":this.playing===RewardedAdsManager.REWARDED&&this.listener.onRewardAction(RewardedAdsManager.ADMOB,this.lastAction=RewardedAdsManager.REWARDED),this.reward=!1,this.listener.onAdAction(RewardedAdsManager.ADMOB,this.playing,this.lastAction=RewardedAdsManager.AD_ACTION_TYPE.AD_ENDED),this.playing=void 0}},PlingaAds.prototype.setListener=function(e){this.listener=e},PlingaAds.prototype.cache=function(e,t){if(this.inited)if(this.cached[t])console.log("Already have "+t);else try{"undefined"!==gdsdk&&"undefined"!==gdsdk.preloadAd&&gdsdk.preloadAd(t).then(function(e){console.log("Plinga ads: have ads!",t,e),this.cached[t]=!0}.bind(this)).catch(function(e){console.log("Plinga ads: NO ads!",e)})
}catch(e){console.log("Error gdsdk.preloadAd",e);var n=new Error("Error gdsdk.preloadAd");throw n.stack+=e.stack,n}},PlingaAds.prototype.isAvailable=function(e){return this.inited&&this.cached[e]},PlingaAds.prototype.playAd=function(t,n){if(this.cached[n])try{"undefined"!==gdsdk&&"undefined"!==gdsdk.showAd&&(this.playing=n,delete this.lastAction,gdsdk.showAd(n).then(function(e){this.cached[n]=!1,this.reward=!1,void 0===this.lastAction&&this.listener.onAdAction(t,n,RewardedAdsManager.AD_ACTION_TYPE.AD_STARTED)}.bind(this)).catch(function(e){delete this.playing,console.log("Plinga showAd error:",e)}))}catch(e){console.log("Error gdsdk.showAd",e);var s=new Error("Error gdsdk.showAd");throw s.stack+=e.stack,s}else console.log("No ads for: "+n)};var FakePlingaAds={onEvent:function(e){},cache:function(e,t){},isAvailable:function(e){return!1},playAd:function(e,t){}},InstantAds=function(){this.supported=!0,AdsPlugin.call(this),console.log("Choose InstantAds"),cleverapps.social.whenInitialized(
"instantads",function(){-1===FBInstant.getSupportedAPIs().indexOf("getRewardedVideoAsync")?(console.log("FBInstant getRewardedVideoAsync is not supported!"),this.supported=!1):console.log("Found support for FBInstant getRewardedVideoAsync")}.bind(this)),this.cached={},this.loaded={},this.listener={onAdAction:function(e,t,n){},onRewardAction:function(e,t,n,s){}}};InstantAds.prototype=Object.create(AdsPlugin.prototype),(InstantAds.prototype.constructor=InstantAds).prototype.setListener=function(e){this.listener=e},InstantAds.prototype.cache=function(e,t){if(this.supported&&cleverapps.config.instantAds){var n=cleverapps.config.instantAds[t];if(n)this.cached[t]=void 0,(t===RewardedAdsManager.REWARDED?FBInstant.getRewardedVideoAsync:FBInstant.getInterstitialAdAsync).call(FBInstant,n).then(function(e){return this.cached[t]=e,this.loaded[t]=!1,console.log("Loaded instant ad config: "+t),e.loadAsync()}.bind(this)).then(function(){this.loaded[t]=!0,console.log("Loaded instant ad video: "+t),
this.listener.onAdAction(e,t,RewardedAdsManager.AD_ACTION_TYPE.LOADED)}.bind(this))}},InstantAds.prototype.isAvailable=function(e){return!!this.supported&&this.loaded[e]},InstantAds.prototype.playAd=function(t,n){this.supported&&(this.cached[n]?(this.listener.onAdAction(t,n,RewardedAdsManager.AD_ACTION_TYPE.AD_STARTED),this.loaded[n]=!1,this.cached[n].showAsync().then(function(){this.listener.onAdAction(t,n,RewardedAdsManager.AD_ACTION_TYPE.AD_ENDED),n===RewardedAdsManager.REWARDED&&this.listener.onRewardAction(t,n)}.bind(this)).catch(function(e){console.error(e.message),this.listener.onAdAction(t,n,RewardedAdsManager.AD_ACTION_TYPE.AD_ENDED)}.bind(this))):console.log("Show: No video cached: "+n))};var WebViewAds=function(){this.available={},cc.sys.os===cc.sys.OS_IOS&&(AdMobPlugin=new cleverapps.IOSWebViewAdMobPluginAdapter,this.inited=!1),AdsPlugin.call(this),this.listener={onAdAction:function(e,t,n){},onRewardAction:function(e,t,n,s){}}};WebViewAds.prototype=Object.create(
AdsPlugin.prototype),(WebViewAds.prototype.constructor=WebViewAds).prototype.init=function(e){cc.sys.os===cc.sys.OS_IOS?(this.onInitCallback=e,AdMobPlugin.init()):e()},WebViewAds.prototype.onInit=function(){if(this.inited=!0,this.onInitCallback){var e=this.onInitCallback;delete this.onInitCallback,e()}},WebViewAds.prototype.setListener=function(e){this.listener=e},WebViewAds.prototype.cache=function(e,t){!1!==this.inited&&AdMobPlugin.cache(t)},WebViewAds.prototype.onAdLoaded=function(e){this.listener.onAdAction(RewardedAdsManager.ADMOB,e,RewardedAdsManager.AD_ACTION_TYPE.LOADED)},WebViewAds.prototype.onAdClosed=function(e){this.listener.onAdAction(e,e,RewardedAdsManager.AD_ACTION_TYPE.AD_ENDED)},WebViewAds.prototype.onAdFailedToLoad=function(e){this.listener.onAdAction(RewardedAdsManager.ADMOB,e,RewardedAdsManager.AD_ACTION_TYPE.LOAD_FAILED)},WebViewAds.prototype.onAdLeftApplication=function(e){},WebViewAds.prototype.onAdOpened=function(e){this.listener.onAdAction(
RewardedAdsManager.ADMOB,e,RewardedAdsManager.AD_ACTION_TYPE.AD_STARTED)},WebViewAds.prototype.onReward=function(e,t,n){this.listener.onRewardAction(RewardedAdsManager.ADMOB,e,n,!0)},WebViewAds.prototype.isAvailable=function(e){return this.available[e]},WebViewAds.prototype.playAd=function(e,t){AdMobPlugin.show(t)},WebViewAds.isAppropriate=function(){return cc.sys.isNative&&cc.sys.isWebView&&("undefined"!=typeof AdMobPlugin||cc.sys.os===cc.sys.OS_IOS)},cleverapps.IOSWebViewAdMobPluginAdapter=function(){},cleverapps.IOSWebViewAdMobPluginAdapter.prototype.init=function(){console.log("IOSWebViewAdMobPluginAdapter init"),webkitMessage("adMob",{action:"init"})},cleverapps.IOSWebViewAdMobPluginAdapter.prototype.cache=function(e){console.log("IOSWebViewAdMobPluginAdapter cache"),webkitMessage("adMob",{action:"cache",name:e})},cleverapps.IOSWebViewAdMobPluginAdapter.prototype.show=function(e){console.log("IOSWebViewAdMobPluginAdapter show"),webkitMessage("adMob",{action:"show",name:e})}
;var BountyManager=function(){this.when=void 0,this.prizes=[],cleverapps.config.debugMode&&(BountyManager.POPUP_INTERVAL="10 minutes"),this.load(),cleverapps.friends.addFriendsUpdatedListener(this.onFriendsUpdated.bind(this))};BountyManager.openWindow=function(e){new BountyWindow(e)},BountyManager.prototype.onFriendsUpdated=function(){cleverapps.social instanceof cleverapps.MobileVk&&(this.prizes=this.prizes.filter(function(e){return e.friends=e.friends.filter(function(e){return cleverapps.friends.inApp(e.id)}),0<e.friends.length&&(void 0===e.minFriendsNo||e.friends.length>=e.minFriendsNo)}),this.save(this.when))},BountyManager.prototype.load=function(){var e=cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.BOUNTY);e?(this.when=e.when,this.prizes=e.prizes||[],this.when>Date.now()&&this.save()):this.save(-1)},BountyManager.prototype.save=function(e){this.when=e||Date.now(),cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.BOUNTY,{when:this.when,prizes:this.prizes})},
BountyManager.prototype.collect=function(e,t){if(t&&t.removeAllChildren(),e.type===BountyManager.TYPE_STAR)return cleverapps.starChest.addStars(e.amount),void(cleverapps.starChest.locked||cleverapps.metha.display({focus:"BountyManagerStarChestWindow",action:function(e){new StarChestWindow,cleverapps.metha.onceNoWindowsListener=e}}));e.type===BountyManager.TYPE_LIFE&&cleverapps.lives?WindowHelper.animateCollect(t,{scale:.8,target:cleverapps.styles.MenuBar.LivesItem.target},function(){cleverapps.lives.setAmount(cleverapps.lives.amount+e.amount)}):WindowHelper.animateCollect(t,{scale:.8,target:cleverapps.styles.MenuBar.GoldItem.target},function(){levels.user.setGold(levels.user.gold+e.amount)})},BountyManager.prototype.isActive=function(){return!cleverapps.flags.noviral},BountyManager.prototype.needRefresh=function(){return Date.now()-this.when>=cleverapps.parseInterval(BountyManager.POPUP_INTERVAL)},BountyManager.prototype.refreshPrizes=function(){if(!this.needRefresh())return!1
;var e=levels.friendSorter.listActiveFriends();cleverapps.Random.shuffle(e);var t=levels.friendSorter.listInactiveFriends();cleverapps.Random.shuffle(t);var i=e.concat(t).map(function(e){if(e&&e.id)return{id:e.id,avatar:e.avatar}});return this.prizes=[],BountyManager.PRIZES.forEach(function(e,t){(e=cleverapps.clone(e,!0)).id=t;var n=i;if(!(!e.minFriendsNo&&e.friendsNo>n.length||e.minFriendsNo>n.length||!cleverapps.lives&&e.type===BountyManager.TYPE_LIFE||!cleverapps.config.results&&e.type===BountyManager.TYPE_STAR)&&BountyManager.ACTIVE_TYPES[e.type]){var s=e.friendsNo;s>n.length&&(s=n.length),e.friends=n.splice(0,s),this.prizes.push(e)}}.bind(this)),this.save(),cleverapps.localPushes.sendPush(cleverapps.LocalPushes.TYPES.BOUNTY,cleverapps.parseInterval(BountyManager.POPUP_INTERVAL)),!0},BountyManager.prototype.sendIfNeed=function(){if(this.isActive()&&0!==cleverapps.friends.listFriends().length){var e=this.refreshPrizes();if(!(this.prizes.length<1)){
var t=levels.friendRequests.notProcessed.filter(function(e){return e.from===levels.FriendRequest.SYSTEM_ID&&e.type===levels.FriendRequest.TYPE_BOUNTY_READY});0<t.length?e&&(t.forEach(function(e){levels.friendRequests.processById(e.id)}),this.createRequest()):this.createRequest()}}},BountyManager.prototype.createRequest=function(){levels.friendRequests.notProcessed.push(levels.FriendRequest.createFriendRequest({id:"__"+Math.floor(1e15*Math.random()),from:levels.FriendRequest.SYSTEM_ID,type:levels.FriendRequest.TYPE_BOUNTY_READY,fake:!0})),levels.friendRequests.save(),levels.friendRequests.onNewListener()},BountyManager.prototype.listPrizes=function(){return this.prizes},BountyManager.prototype.removePrize=function(e){for(var t=0;t<this.prizes.length;t++)if(this.prizes[t].id===e.id){this.prizes.splice(t,1),this.save();break}},BountyManager.POPUP_INTERVAL="12 hour",BountyManager.TYPE_LIFE=0,BountyManager.TYPE_STAR=1,BountyManager.TYPE_GOLD_1=2,BountyManager.TYPE_GOLD_2=3,
BountyManager.ACTIVE_TYPES={},BountyManager.ACTIVE_TYPES[BountyManager.TYPE_LIFE]=!0,BountyManager.ACTIVE_TYPES[BountyManager.TYPE_STAR]=!0,BountyManager.ACTIVE_TYPES[BountyManager.TYPE_GOLD_1]=!0,BountyManager.ACTIVE_TYPES[BountyManager.TYPE_GOLD_2]=!0,BountyManager.PRIZES=[{type:BountyManager.TYPE_GOLD_1,amount:5,friendsNo:1},{type:BountyManager.TYPE_STAR,amount:1,friendsNo:2,minFriendsNo:1},{type:BountyManager.TYPE_GOLD_2,amount:10,friendsNo:3,minFriendsNo:1},{type:BountyManager.TYPE_LIFE,amount:1,friendsNo:4,minFriendsNo:1},{type:BountyManager.TYPE_GOLD_2,amount:15,friendsNo:5,minFriendsNo:3},{type:BountyManager.TYPE_STAR,amount:1,friendsNo:10,minFriendsNo:3},{type:BountyManager.TYPE_GOLD_2,amount:15,friendsNo:10,minFriendsNo:4},{type:BountyManager.TYPE_GOLD_2,amount:10,friendsNo:10,minFriendsNo:5}];var BountyItemView=cc.Node.extend({ctor:function(e){this._super(),this.prize=e,this.onAcceptListener=function(){};var i=cleverapps.styles.BountyItemView,
t=cleverapps.UI.createScale9Sprite(i.Background.image,cleverapps.UI.Scale9Rect.TwoPixelXY),n=i.Background.width;cleverapps.wideMode.mode!==cleverapps.WideMode.VERTICAL&&(n+=i.wide.Background.x),t.setContentSize2(n,i.Background.height),this.simpleBg=t,this.setAnchorPoint(.5,.5),this.setContentSize(t.getContentSize()),t.setPosition(this.width/2,this.height/2),this.addChild(t);var s=this.content=new cc.Node;s.setAnchorPoint2(),s.setPosition(cleverapps.styles.BountyItemView.icon.x,this.height/2),this.addChild(s);var o=cleverapps.styles.BountyItemView.ICONS[e.type],r=new cc.Sprite(o);r.setScale(cleverapps.styles.BountyItemView.icon.scale);var a=r.getContentSize();s.setContentSize(a.width*r.scale,a.height*r.scale),s.addChild(r),r.setPositionRound(s.width/2,s.height/2),this.image=r,e.amount&&this.addAmountToIcon(e.amount);var c=i.avatars.width;cleverapps.wideMode.mode!==cleverapps.WideMode.VERTICAL&&(c+=i.wide.avatars.width);var l=i.avatar.x,p=e.friends.length;10<p&&(p=10),c<p*l&&(l=c/p),
e.friends.forEach(function(e,t){if(!(p<t)){var n=e.id;if("string"==typeof e&&(n=e,e=void 0),e=e||cleverapps.friends.getById(n)||cleverapps.invitalbleFriends.getById(n)){var s=new cleverapps.UI.Avatar(e);s.setPosition(s.width/2+i.avatars.x+t*l,this.height/2+i.avatar.y),this.addChild(s),s.setScale(.8)}}},this);var d=this.getButton(e);this.addChild(d),cleverapps.UI.applyHover(this),cleverapps.UI.onClick(this,this.onAcceptListener.bind(this))},addAmountToIcon:function(e){var t=cleverapps.styles.BountyItemView,n=cleverapps.UI.generateImageText("+"+e,cleverapps.styles.FONTS.BOUNTY_AMOUNT_TEXT||cleverapps.styles.FONTS.WINDOW_SMALL_TEXT);n.setPosition(this.content.width/2+t.amount.x,this.content.height/2+t.amount.y),this.content.addChild(n)},onMouseOver:function(){var e=cleverapps.styles.BountyItemView.Background;e.imageOn?this.simpleBg.setSpriteFrame(cc.spriteFrameCache.getSpriteFrame(e.imageOn)):this.simpleBg.setColor(cleverapps.styles.COLORS.COLOR_VERYLIGHTBROWN)},onMouseOut:function(){
var e=cleverapps.styles.BountyItemView.Background;e.imageOn?this.simpleBg.setSpriteFrame(cc.spriteFrameCache.getSpriteFrame(e.image)):this.simpleBg.setColor(cleverapps.styles.COLORS.WHITE)},getButton:function(e){var t=cleverapps.styles.BountyItemView.Button,n=new cc.Node;n.setPosition(t.width/2,t.height/2);var s=cleverapps.UI.generateOnlyText("messages:Collect",t.font);s.fitTo(.9*t.width),s.setPosition(0,t.text.y),n.addChild(s);var i={onClicked:function(){this.onAcceptListener()}.bind(this),width:t.width,height:t.height,content:n,button_png:t.button_png,button_on_png:t.button_on_png},o=new cleverapps.UI.Button(i);return o.setPositionRound(this.width-o.width/2+cleverapps.styles.BountyItemView.Button.x,this.height/2),o},animateBuy:function(){cleverapps.styles.MenuBar.LivesItem.target&&WindowHelper.animateCollect(this.content,{scale:.3,target:cleverapps.styles.MenuBar.LivesItem.target})}});cleverapps.styles.BountyItemView={ICONS:{},Background:{scale9:!0,width:680,height:100,
image:bundles.main.frames.bounty_item_bg},wide:{Background:{x:100},avatars:{width:80}},icon:{scale:1,x:50},amount:{x:60,y:-20},avatars:{x:170,width:240},avatar:{x:100,y:-3},Button:{width:160,height:70,x:-15,button_png:bundles.buttons_main.frames.small_green_button,button_on_png:bundles.buttons_main.frames.small_green_button_on,font:cleverapps.styles.FONTS.BUTTON_SMALL_TEXT,text:{y:0}}},cleverapps.styles.BountyItemView.ICONS[BountyManager.TYPE_GOLD_1]=bundles.main.frames.coin_png,cleverapps.styles.BountyItemView.ICONS[BountyManager.TYPE_GOLD_2]=bundles.main.frames.coin_png,cleverapps.styles.BountyItemView.ICONS[BountyManager.TYPE_LIFE]=bundles.request_center.frames.accept_life_icon,cleverapps.styles.BountyItemView.ICONS[BountyManager.TYPE_STAR]=bundles.request_center.frames.accept_star_icon;var BountyWindow=Window.extend({onWindowLoaded:function(i){var e=cleverapps.styles.BountyWindow,t=new cc.Node;t.setAnchorPoint(.5,.5),this.content=t,this.onSocialRequestResponse=this.createListener(
function(e,t){t.onAcceptListener=function(){},cleverapps.bountyManager.collect(e,t.image),t.runAction(new cc.Sequence(new cc.ScaleTo(.3,0),new cc.RemoveSelf,new cc.CallFunc(function(){this.bountyViews.splice(this.bountyViews.indexOf(t),1),this.moveToPosition()},this)))});var n=cleverapps.throttle(cleverapps.UI.SOCIAL_CLICK_THROTTLE,function(e,t){var n="bountyGold";e.type===BountyManager.TYPE_STAR&&(n="bountyStar"),e.type===BountyManager.TYPE_LIFE&&(n="bountyLife");var s=e.friends.map(function(e){return e&&e.id?e.id:e});cleverapps.social.sendRequest(s,n,function(){this.onSocialRequestResponse(e,t)}.bind(this)),cleverapps.bountyManager.removePrize(e),i.remove()}.bind(this));cleverapps.eventLogger.logEvent(cleverapps.EVENTS.BOUNTY_OPENED),this.bountyViews=cleverapps.bountyManager.listPrizes().map(function(e){var t=new BountyItemView(e);return t.onAcceptListener=function(){n(e,t)},this.content.addChild(t),t}.bind(this));var s=this.bountyViews.map(function(e){return e});s.reverse()
;var o=cleverapps.UI.arrangeWithMargins(s,{y:e.items.y,margin:e.item.y,direction:cleverapps.UI.VERTICAL,x:Math.round(e.width/2)});if(this.total=o,t.setContentSize2(e.width,o+e.height),0===s.length)this.generateNoFriendsContent();else{var r=cleverapps.UI.generateTTFText("messages:BountyWindow.Text",cleverapps.styles.FONTS.WINDOW_TEXT);r.setPositionRound(t.width/2,o+e.text.y),t.addChild(r)}this._super({name:"bountywindow",title:"messages:BountyWindow.Title",content:t}),cleverapps.audio.playSound(bundles.game.urls.perfect_effect)},moveToPosition:function(){if(0!==this.bountyViews.length){var e=this.bountyViews.map(function(e){return e});e.reverse();var t=cleverapps.styles.BountyWindow,n=cleverapps.UI.arrangeWithMargins(e,{y:t.items.y,margin:t.item.y,direction:cleverapps.UI.VERTICAL,x:Math.round(t.width/2),iterator:function(){}});cleverapps.UI.arrangeWithMargins(e,{y:t.items.y+(this.total-n),margin:t.item.y,direction:cleverapps.UI.VERTICAL,x:Math.round(t.width/2),iterator:function(e,t,n){
e.stopAllActions(),e.runAction(new cc.MoveTo(.5,t,n))}})}else this.close()},generateNoFriendsContent:function(){var e=cleverapps.styles.BountyWindow.noFriends;this.content.setContentSize(e.width,e.height);var t=cleverapps.UI.generateTTFText("messages:BountyWindow.noFriendsText",cleverapps.styles.FONTS.WINDOW_TEXT);t.setPositionRound(this.content.width/2,e.Text.y),t.setDimensions(e.Text.width,e.Text.height),t.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER),this.content.addChild(t);var n=new cleverapps.UI.Button({text:Messages.get("SettingsWindow.InviteFriends"),width:e.Button.width,height:e.Button.height,font:cleverapps.styles.FONTS.BUTTON_TEXT,onClicked:function(){cleverapps.social.inviteFriendsWindow(function(){this.close()}.bind(this))}.bind(this)});n.setPositionRound(this.content.width/2,e.Button.y),this.content.addChild(n)}});cleverapps.styles.BountyWindow={width:690,height:150,noFriends:{width:690,height:500,Text:{y:250,width:550,height:200},Button:{width:450,height:120,y:0}},
text:{y:60},items:{y:-20},item:{y:10},animation:{x:300,y:200}};var PiggyBank=function(){cleverapps.config.debugMode&&(PiggyBank.LIFETIME="10 minutes",PiggyBank.INTERMISSION="2 day"),this.active=void 0,this.when=void 0,this.level=void 0,this.amount=0,this.load()};PiggyBank.prototype.load=function(){var e=cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.PIGGY_BANK);void 0===e&&(e={active:!1,when:void 0,level:0,amount:0}),this.active=e.active,this.when=e.when,this.level=e.level,this.amount=e.amount,this.updateState()},PiggyBank.prototype.getInfo=function(){return{active:this.active,when:this.when,level:this.level,amount:this.amount}},PiggyBank.prototype.updateInfo=function(e,t){this.active=e.active,this.when=e.when,this.level=e.level,this.amount=e.amount,this.save(t)},PiggyBank.prototype.getLeftTime=function(){return cleverapps.parseInterval(PiggyBank.LIFETIME)-(Date.now()-this.when)},PiggyBank.prototype.getProduct=function(){return Product.Create(["piggybank500","piggybank1800",
"piggybank6000","piggybank25000"][this.level])},PiggyBank.prototype.buy=function(e){var t=this.getProduct();t.reward.gold=this.amount,t.piggyBankLevel=this.level,t.buy(function(){this.onBuy(),e()}.bind(this))},PiggyBank.prototype.onBuy=function(){cleverapps.history.add("piggy",1),this.stop()},PiggyBank.prototype.updateState=function(){var e=!1;this.active&&this.when+cleverapps.parseInterval(PiggyBank.LIFETIME)<Date.now()&&(this.active=!1,this.when=this.when+cleverapps.parseInterval(PiggyBank.LIFETIME),e=!0,this.logStop()),this.active||(void 0===this.when||this.when+cleverapps.parseInterval(PiggyBank.INTERMISSION)<Date.now())&&(this.start(),e=!1),e&&this.save(),clearTimeout(this.timer),this.timer=new cleverapps.LongTimeout(function(){cleverapps.sideBar.resetByClassName(PiggyBankIcon)}.bind(this),this.getLeftTime())},PiggyBank.prototype.save=function(e){cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.PIGGY_BANK,{active:this.active,when:this.when,level:this.level,amount:this.amount}
),e||cleverapps.synchronizer.addUpdateTask("piggybank")},PiggyBank.prototype.getBaseAmount=function(){return this.getProduct().reward.gold},PiggyBank.prototype.getAddAmount=function(){return(this.getMaxAmount()-this.getBaseAmount())/PiggyBank.WINS_TO_FULFILL},PiggyBank.prototype.getMaxAmount=function(){return Math.round(this.getBaseAmount()*PiggyBank.MAX_COEF/PiggyBank.WINS_TO_FULFILL)*PiggyBank.WINS_TO_FULFILL},PiggyBank.prototype.isFull=function(){return this.amount>=this.getMaxAmount()},PiggyBank.prototype.addGold=function(e){this.isFull()||(this.amount+=e,this.save(),this.isFull()&&cleverapps.sideBar.resetByClassName(PiggyBankIcon))},PiggyBank.MAX_COEF=1.4,PiggyBank.prototype.start=function(){this.active=!0,this.when=Date.now(),this.level=cleverapps.paymentsHistory.classify(),this.level===cleverapps.PaymentsHistory.PAYER_BIGWHALE&&(this.level=cleverapps.PaymentsHistory.PAYER_WHALE);var e=this.getProduct();this.amount=e.reward.gold,this.save()},PiggyBank.prototype.logStop=function(
){cleverapps.eventLogger.logEvent(cleverapps.EVENTS.PIGGY_BANK+"_stop"),this.isFull()&&cleverapps.eventLogger.logEvent(cleverapps.EVENTS.PIGGY_BANK+"_stop_full")},PiggyBank.prototype.stop=function(){this.logStop(),this.active=!1,this.when=Date.now(),this.save(),cleverapps.sideBar.resetByClassName(PiggyBankIcon)},PiggyBank.prototype.isActive=function(){return!!levels.user.checkAvailable(PiggyBank.AVAILABLE)&&(!cleverapps.flags.nopayments&&(this.updateState(),this.active||this.start(),this.active))},PiggyBank.AVAILABLE={episode:1,level:12},PiggyBank.WINS_TO_FULFILL=10,PiggyBank.LIFETIME="3 days",PiggyBank.INTERMISSION="3 days";var PiggyBankVictoryAnimation=cleverapps.Spine.extend({ctor:function(){this._super(bundles.piggybank_window.jsons.piggy_bank_window_json),this.setAnimation(0,"piggy_victory",!0)}}),PiggyBankWindow=Window.extend({onWindowLoaded:function(){var e=cleverapps.piggyBank.getLeftTime();if(!(e<=0)){var t=cleverapps.styles.PiggyBankWindow,n=new cc.Node;n.setContentSize2(
t.animation.width,t.animation.height),n.setAnchorPoint2();var s=new cleverapps.Spine(t.animation.json);s.setAnimation(0,cleverapps.piggyBank.isFull()?"piggy_full":"piggy_bank",!0),s.setPositionRound(n.width/2,n.height/2+t.animation.y),n.addChild(s);var i=new cc.Node,o=cleverapps.UI.generateTTFText("messages:Balance",cleverapps.styles.FONTS.WINDOW_TEXT);o.setVerticalAlignment(cc.TEXT_ALIGNMENT_CENTER),o.setDimensions(0,t.text.height),i.addChild(o);var r=cleverapps.UI.createScale9Sprite(t.timer.bg);r.setContentSize2(t.amount.width,t.amount.height);var a=new cc.Node,c=new cc.Sprite(bundles.menubar.frames.coin_png);c.setFlippedX(t.amount.coin.flip),c.setScale(t.amount.coin.scale),a.addChild(c);var l=cleverapps.UI.generateImageText(cleverapps.formatAmount(cleverapps.piggyBank.amount),cleverapps.styles.FONTS.PIGGY_BANK_AMOUNT_TEXT,{});a.addChild(l),cleverapps.UI.arrangeWithMargins(a.children,{direction:cleverapps.UI.HORIZONTAL,margin:t.amount.margin}),cleverapps.UI.wrap(a),l.y+=t.amount.y,
a.setAnchorPoint2(),a.setPositionRound(r.width/2,r.height/2),r.addChild(a),i.addChild(r),cleverapps.UI.arrangeWithMargins(i.children,{direction:cleverapps.UI.HORIZONTAL,margin:t.timer.margin.x}),cleverapps.UI.wrap(i),i.setAnchorPoint2();var p=cleverapps.piggyBank.getProduct(),d=cleverapps.UI.generateTTFText("messages:PiggyBankWindow.text2",cleverapps.styles.FONTS.WINDOW_TEXT);d.setVerticalAlignment(cc.TEXT_ALIGNMENT_CENTER),d.setDimensions(0,t.text.height);var u=cleverapps.UI.createScale9Sprite(t.timer.bg);u.setContentSize2(t.timer.width,t.timer.height);var h={background_content:u,font:cleverapps.styles.FONTS.PIGGY_BANK_WINDOW_TIMER_TEXT||cleverapps.styles.FONTS.WHITE_TEXT,timerPosition:t.timer,regularFontTimerPosition:t.timer.regularFont},g=new cleverapps.CountDownView(new cleverapps.CountDown(e,{onFinish:function(){this.close()}.bind(this)}),h),v=new cc.Node;v.addChild(d),v.addChild(g),cleverapps.UI.arrangeWithMargins(v.children,{direction:cleverapps.UI.HORIZONTAL,
margin:t.timer.margin.x}),cleverapps.UI.wrap(v),v.setAnchorPoint2();var m=cleverapps.piggyBank.isFull()?"messages:PiggyBankWindow.text1.Full":"messages:PiggyBankWindow.text1",f=cleverapps.UI.generateTTFText(m,cleverapps.styles.FONTS.WINDOW_TEXT,{price:p.getCurrentPrice()});f.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER),f.setDimensions(t.text.width,0),f.fitTo(void 0,t.text.height);var _=new cc.Node;_.setContentSize2(0,t.amount.margin);var y=new cc.Node;y.addChild(f),y.addChild(_),y.addChild(i),y.addChild(n),n.setLocalZOrder(1),y.addChild(v),cleverapps.UI.arrangeWithMargins(y.children,{direction:cleverapps.UI.VERTICAL,margin:t.margin}),cleverapps.UI.wrap(y),y.setAnchorPoint2(),y=cleverapps.UI.wrapWithPadding(y,{x:0,y:t.padding.y});var w=t.button;w.text=Messages.get("GetIt"),w.font=cleverapps.styles.FONTS.PIGGY_BANK_BUTTON_TEXT,w.onPressed=function(){cleverapps.piggyBank.buy(this.close.bind(this))}.bind(this);var b=cleverapps.overrideStyles(cleverapps.styles.Window,
cleverapps.styles.PiggyBankWindow,!0);this._super({name:"piggybankwindow",title:cleverapps.piggyBank.isFull()?"messages:PiggyBankWindow.Title.Full":"messages:PiggyBankWindow.Title",content:y,button:w,help:function(){new PiggyBankRulesWindow},styles:b}),cleverapps.audio.playSound(bundles.main.urls.piggybank_window_effect||bundles.main.urls.shop_buy_effect),Lottery.addIcon(this.button),Lottery.addText(this)}}});PiggyBankWindow.prototype.listBundles=function(){return["piggybank_window"]},cleverapps.styles.PiggyBankWindow={margin:20,padding:{y:60},animation:{width:600,height:450,y:-90,json:bundles.piggybank_window.jsons.piggy_bank_window_json},amount:{width:260,height:64,margin:10,y:0,coin:{flip:!0,scale:1}},text:{width:640,height:150},button:{width:300,height:100},timer:{width:220,height:50,bg:bundles.main.frames.timer_bg_png,margin:{x:30},x:0,y:0}};var PiggyBankRulesWindow=RulesWindow.extend({onWindowLoaded:function(){this._super({name:"piggybankwindow",
styles:cleverapps.styles.PiggyBankRulesWindow})}});PiggyBankRulesWindow.prototype.listBundles=function(){return["piggybank_window"]},cleverapps.styles.PiggyBankRulesWindow={font:cleverapps.styles.FONTS.PIGGY_BANK_WINDOW_SMALL_TEXT,prefix:"messages:PiggyBankRulesWindow.",animation:{json:bundles.piggybank_window.jsons.piggy_bank_window_json,name:"piggy_help"}};var PackManager=function(e){cleverapps.config.debugMode&&(PackManager.NEXT_STAGE_INTERVAL="10 seconds"),e?(this.whenBuy=-1,this.used=0,this.save()):this.load()};PackManager.prototype.load=function(){var e=cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.PACK);this.whenBuy=e&&e.whenBuy&&e.whenBuy<Date.now()?e.whenBuy:-1,this.used=e&&e.used?e.used:0},PackManager.prototype.save=function(e){cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.PACK,{whenBuy:this.whenBuy,used:this.used}),!1!==e&&cleverapps.synchronizer.addUpdateTask("packs")},PackManager.prototype.get=function(){var e=PackManager.PACKS[PackManager.PACK_NAME]
;return e=(e=Array.isArray(e)?e:[e]).filter(function(e){return!1!==e.active}),(e=this.used<e.length?e[this.used]:void 0)&&(e.stage=this.used,e.id=PackManager.PACK_NAME),e},PackManager.prototype.onBuyPack=function(){this.used++;var e=PackManager.PACKS[PackManager.PACK_NAME].length;this.used>e&&(this.used=e),this.whenBuy=Date.now(),this.save(),cleverapps.history.add("pack",1),cleverapps.sideBar.resetByClassName(PackIcon)},PackManager.prototype.isAvailable=function(){var e=this.get();if(!e)return!1;if(cleverapps.flags.nopayments)return!1;if(!e.active&&!cleverapps.config.debugMode)return!1;if(e.available){var t=e.available;if(!levels.user.checkAvailable(t))return!1}return!(Date.now()<this.whenBuy+cleverapps.parseInterval(PackManager.NEXT_STAGE_INTERVAL))},PackManager.PACK_NAME="starterPack",PackManager.NEXT_STAGE_INTERVAL="1 day",PackManager.PACKS={starterPack:[{product:"starterPack0",title:"messages:StarterPack0.Title",animation:"animation1",bundle:"starter_pack",
banner:"starter_pack_banner_png",icon:"starter_pack_0_icon_png",description:"messages:StarterPack0.Description",reward:RewardsConfig.Packs[0],active:!0,available:{episode:1,level:5}},{product:"starterPack",title:"messages:StarterPack1.Title",animation:"animation2",bundle:"starter_pack",banner:"starter_pack_banner_png",icon:"starter_pack_1_icon_png",description:"messages:StarterPack1.Description",reward:RewardsConfig.Packs[1],active:!0,available:{episode:2,level:5}},{product:"starterPack2",title:"messages:StarterPack2.Title",animation:"animation3",bundle:"starter_pack",banner:"starter_pack_banner_png",icon:"starter_pack_2_icon_png",description:"messages:StarterPack2.Description",reward:RewardsConfig.Packs[2],active:!0,available:{episode:3,level:5}}]},"merge"===cleverapps.config.type&&(PackManager.PACKS.starterPack[0].available={episode:0,level:4},PackManager.PACKS.starterPack[1].available={episode:0,level:6},PackManager.PACKS.starterPack[2].available={episode:0,level:8}),
PackManager.PACKS.starterPack.forEach(function(e){cleverapps.PaymentsManager.PRODUCTS[e.product].reward=e.reward});var PackWindow=Window.extend({onWindowLoaded:function(e){e=e||{};var t=cleverapps.packManager.get();this.pack=t;var n=cleverapps.styles.PackWindow,s=n.button;this.setButtonContent(s),s.onPressed=function(){this.buyPackProduct()}.bind(this);var i=this.generateContent(t),o=cleverapps.overrideStyles(cleverapps.clone(cleverapps.styles.Window,!0),cleverapps.styles.PackWindow);if(this._super({name:"packwindow",title:n.title?{text:t.title,margin:{x:0,y:n.title.margin.y},font:n.title.font||cleverapps.styles.FONTS.WINDOW_TITLE_TEXT}:"",content:i,button:s,windowBg:e.windowBg,styles:o}),n.heroAnimation){var r=new cleverapps.Spine(n.heroAnimation.json,Array.isArray(n.heroAnimation.scale)?n.heroAnimation.scale[cleverapps.wideMode.mode]:n.heroAnimation.scale);r.setAnimation(0,n.heroAnimation.animation,!0),r.setPositionRound(n.heroAnimation.position),this.addChild(r),r.y-=r.height,
r.runAction(new cc.MoveBy(.4,0,r.height).easing(cc.easeBackOut()))}cleverapps.audio.playSound(bundles.main.urls.window_effect),cleverapps.eventLogger.logEvent(cleverapps.EVENTS.PACKWINDOW_OPENED),cleverapps.eventLogger.logEvent(cleverapps.EVENTS.PACKWINDOW_OPENED+"_"+this.pack.id+(0===this.pack.stage?"":"_"+this.pack.stage)),Lottery.addIcon(this.button),Lottery.addText(this)},setButtonContent:function(e){var t=Product.Create(this.pack.product);e.content=this.generateButtonText(t)},generateButtonText:function(e){return new ProductPriceView(e,{font:cleverapps.styles.PackWindow.button.font,fitTo:{width:cleverapps.styles.PackWindow.BottomButton.width}})},onShow:function(){var t=cleverapps.styles.PackWindow,e=this.content;this.runAction(new cc.Sequence(new cc.DelayTime(.1),new cc.PlaySound(bundles.starter_pack.urls.starter_pack_effect))),e.rewards&&e.rewards.children.forEach(function(e){e.setOpacity(0),e.runAction(new cc.Sequence(new cc.DelayTime(t.rewards.delay||0),new cc.FadeIn(
t.rewards.duration||0)))}),e.discountLabel&&(e.discountLabel.setOpacity(0),e.discountLabel.runAction(new cc.Sequence(new cc.DelayTime(t.discountLabel.delay||0),new cc.FadeIn(t.discountLabel.duration||0)))),e.title&&(e.title.setOpacity(0),e.title.runAction(new cc.Sequence(new cc.DelayTime(t.Title.delay||0),new cc.FadeIn(t.Title.duration||0))))},generateContent:function(e){var t=cleverapps.styles.PackWindow,n=this.content=new cc.Node;return n.setAnchorPoint2(),n.setPositionRound({align:"center"},{align:"center"}),n.setContentSize2(t),t.animation&&(n.animation=this.generateAnimation(e,t.animation),n.addChild(n.animation)),t.rewards&&(n.rewards=this.generateRewards(e,t.rewards),n.addChild(n.rewards)),t.discountLabel&&(n.discountLabel=this.generateText(t.discountLabel.text,t.discountLabel),n.addChild(n.discountLabel)),t.Title&&(n.title=this.generateText(e.title,t.Title),n.addChild(n.title)),n.setScale(t.scales[cleverapps.wideMode.mode]),n},applyTextStyles:function(e,t){t.split&&(
e.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER),e.setString(e.string.split(/\s+/).join("\n"))),t.fontSize&&e.setFontSize(t.fontSize),t.fitTo&&e.fitTo(t.fitTo.width,t.fitTo.height),t.lineHeight&&e.setLineHeight&&e.setLineHeight(t.lineHeight),t.rotation&&e.setRotation(t.rotation)},generateAnimation:function(e,t){t=cleverapps.extend({},t.default||{},t[e.product]||{});var n=new cleverapps.Spine(bundles[e.bundle].jsons.pack_json,1);return n.setAnchorPoint2(),n.setPositionRound({align:"center",dx:t.dx||0},{align:"center",dy:t.dy||0}),t.introAnimation?(n.setAnimation(0,t.introAnimation,!1),n.addAnimation(0,t.idleAnimation,!0,t.idleDelay||0)):n.setAnimation(0,t.idleAnimation,!0),n},generateText:function(e,t){var n=cleverapps.UI.generateTTFText(e,t.font);return this.applyTextStyles(n,t),n.setAnchorPoint2(),n.setPositionRound({align:"center",dx:t.dx||0},{align:"center",dy:t.dy||0}),n},generateRewards:function(e,s){s=cleverapps.clone(s);var t=cleverapps.extend({},s.positions.default||{},
s.positions[e.product]||{}),i=new cc.Node;i.setAnchorPoint2(),i.setPositionRound({align:"center"},{align:"center"});var n=function(e,t){var n=new cleverapps.UI.generateTTFText(e,s.font);s.split=t.split,s.rotation=t.rotation,this.applyTextStyles(n,s),n.setAnchorPoint2(),n.setPositionRound(t),i.addChild(n)};for(var o in e.reward){var r=e.reward[o],a=t[o];if(void 0!==a)if("boosters"===o)for(var c in r){var l=r[c],p=a[c];void 0!==p&&n.call(this,"x"+l,p)}else n.call(this,"unlimitedLives"===o||"worker"===o?Product.FormatUnlimitedLives(r).title:"x"+r,a)}return i},buyPackProduct:function(){Product.Create(this.pack.product).buy(function(){this.close(),cleverapps.packManager.onBuyPack()}.bind(this))}});PackWindow.prototype.listBundles=function(){return[cleverapps.packManager.get().bundle]},cleverapps.styles.COLORS=cleverapps.overrideColors(cleverapps.styles.COLORS,{PACKWINDOW_TITLE_YELLOW:new cc.Color(249,205,23,255),PACKWINDOW_TITLE_SHADOW:new cc.Color(97,47,1,255),
PACKWINDOW_PRICE_STROKE:new cc.Color(9,88,3,255)}),cleverapps.styles.DECORATORS=cleverapps.overrideStyles(cleverapps.styles.DECORATORS,{PACKWINDOW_TITLE_STROKE:{size:3,color:cleverapps.styles.COLORS.PACKWINDOW_TITLE_SHADOW},PACKWINDOW_BUTTON_STROKE:{size:3,color:cleverapps.styles.COLORS.PACKWINDOW_PRICE_STROKE},PACKWINDOW_LABEL_STROKE:{color:cleverapps.styles.COLORS.BLACK,size:3}}),cleverapps.overrideFonts(cleverapps.styles.FONTS,{PACKWINDOW_TITLE_TEXT:{size:70,color:cleverapps.styles.COLORS.PACKWINDOW_TITLE_YELLOW,stroke:cleverapps.styles.DECORATORS.PACKWINDOW_TITLE_STROKE},PACKWINDOW_BUTTON_TEXT:{size:60,color:cleverapps.styles.COLORS.WHITE,stroke:cleverapps.styles.DECORATORS.PACKWINDOW_BUTTON_STROKE},PACKWINDOW_LABEL_TEXT:{size:80,color:cleverapps.styles.COLORS.WHITE,stroke:cleverapps.styles.DECORATORS.PACKWINDOW_LABEL_STROKE},PACK_LABELS:{size:77,color:cleverapps.styles.COLORS.WHITE,stroke:cleverapps.styles.DECORATORS.MESSAGE_RED_STROKE}}),cleverapps.styles.PackWindow={width:440,
height:750,noAds:!1,noBackground:!0,title:void 0,margin:20,y:60,content:{height:{dy:0}},text:{margin:{width:10}},description:{y:0},BottomButton:{bottomPadding:40,width:260},button:{width:300,height:100,price:{margin:{x:10,y:0}},x:0,y:50,font:cleverapps.styles.FONTS.BUTTON_TEXT},window:{Title:{zIndex:1}},scales:[.85,1,1],Title:void 0,discountLabel:void 0,animation:void 0,rewards:void 0},cleverapps.ShareBonus=function(e){if(this.id=e.id,this.storageKey=cleverapps.config.prefix+cleverapps.social.getLocalStoragePreffix()+"_"+e.id,this.bonus=e.bonus,this.interval=cleverapps.parseInterval(e.interval),this.type=e.type,this.initStorageKey(e.startAvailable),e.isRewardedVideo&&cleverapps.rewardedAdsManager.isAvailable(RewardedAdsManager.REWARDED)){var t=this.storageKey;this.storageKey+="_video",this.initStorageKey(e.startAvailable),this.isReady()?(this.type=cleverapps.ShareBonus.VIDEO,cleverapps.flags.reduceAds&&(this.bonus=cleverapps.ShareBonus.BONUS_REDUCED)):this.storageKey=t}
cleverapps.ShareBonus.IsRewardAvailable()||this.type===cleverapps.ShareBonus.VIDEO||(this.bonus=0),this.takeBonusListener=function(){}},cleverapps.ShareBonus.prototype.initStorageKey=function(e){void 0===cleverapps.DataLoader.load(this.storageKey)&&cleverapps.DataLoader.save(this.storageKey,e?0:Date.now())},cleverapps.ShareBonus.prototype.markTaken=function(){cleverapps.DataLoader.save(this.storageKey,Date.now())},cleverapps.ShareBonus.prototype.createShareCallback=function(t,n){return function(e){e===cleverapps.Social.CODE_SUCCEED?(n!==cleverapps.ShareBonus.REQUEST&&n!==cleverapps.ShareBonus.DIALOG||(cleverapps.eventLogger.logEvent(cleverapps.EVENTS.SHARE),cleverapps.eventLogger.logEvent(cleverapps.EVENTS.SHARE_ITEM,{id:this.id})),this.bonus&&cleverapps.eventLogger.logEvent(cleverapps.EVENTS.REWARD_RECEIVED,{amount:this.bonus}),this.markTaken(),this.bonus&&(levels.user.setGold(levels.user.gold+this.bonus),this.takeBonusListener()),t()):console.log(Messages.get("ShareBonus.ShareFailed"
)+e)}.bind(this)},cleverapps.ShareBonus.cycleShareData=function(e,t){t=cleverapps.extend({},t||{},{gameTitle:Messages.get(cleverapps.config.title),gameName:cleverapps.config.name});var n=cc.loader.getRes(bundles.main.jsons.share_json)[e],s=cleverapps.DataLoader.load(cleverapps.config.prefix+cleverapps.social.getLocalStoragePreffix()+"_"+e+"ShareId");void 0===s?s=Math.floor(3*Math.random()):s++,cleverapps.DataLoader.save(cleverapps.config.prefix+cleverapps.social.getLocalStoragePreffix()+"_"+e+"ShareId",s);var i=n[cleverapps.settings.language]||n[cc.sys.LANGUAGE_ENGLISH],o={};i&&(o.picture=i[s%i.length]),n.vk&&(o.vk=n.vk[s%n.vk.length]);var r=n.texts[s%n.texts.length];for(var a in r){var c=r[a];"to"===a?o[a]=Messages.replace(c,t):"string"==typeof c&&0===c.indexOf("messages:")&&(c=Messages.replace(c,t),o[a]=Messages.get(c,t))}return o},cleverapps.ShareBonus.prototype.request=function(t,n){cleverapps.social.checkConnection(function(){var e=cleverapps.ShareBonus.cycleShareData(this.id,n)
;cleverapps.social.request(e,this.createShareCallback(function(){cleverapps.history.add("rqst",1),t()},cleverapps.ShareBonus.REQUEST))}.bind(this))},cleverapps.ShareBonus.prototype.shareDialog=function(t,n){cleverapps.social.checkConnection(function(){var e=cleverapps.ShareBonus.cycleShareData(this.id,n);cleverapps.social.shareDialog(e,this.createShareCallback(function(){cleverapps.history.add("share",1),t()},cleverapps.ShareBonus.DIALOG))}.bind(this))},cleverapps.ShareBonus.prototype.rewardedVideo=function(e){if(cleverapps.rewardedAdsManager.isAvailable(RewardedAdsManager.REWARDED)){var t=this.createShareCallback(e,cleverapps.ShareBonus.VIDEO);cleverapps.rewardedAdsManager.play(RewardedAdsManager.REWARDED,function(){t(cleverapps.Social.CODE_SUCCEED),cleverapps.eventLogger.logEvent(cleverapps.EVENTS.REWARDED_SHARE)})}else cleverapps.Notification.create("messages:AdsUnavailable")},cleverapps.ShareBonus.prototype.takeBonus=function(e,t){switch(this.type){
case cleverapps.ShareBonus.DIALOG:this.shareDialog(e,t);break;case cleverapps.ShareBonus.VIDEO:this.rewardedVideo(e);break;default:this.request(e,t)}},cleverapps.ShareBonus.prototype.isReady=function(){return parseInt(cc.sys.localStorage.getItem(this.storageKey))+this.interval<=Date.now()},cleverapps.ShareBonus.IsRewardAvailable=function(){if(cleverapps.flags.noviral||cleverapps.flags.noshares)return!1;var e=cleverapps.User.calcSource();return-1===["instant","mobile_vk"].indexOf(e)&&("mobile_ok"===e||"web_ok"===e||cleverapps.user.checkAvailable(cleverapps.ShareBonus.REWARD_AVAILABLE))},cleverapps.ShareBonus.DIALOG="dialog",cleverapps.ShareBonus.REQUEST="request",cleverapps.ShareBonus.VIDEO="video",cleverapps.ShareBonus.SHARES={victory:{bonus:20,interval:"20 minutes",type:cleverapps.ShareBonus.DIALOG,isRewardedVideo:!0},finishEpisode:{bonus:30,interval:"1 hour",type:cleverapps.ShareBonus.DIALOG,isRewardedVideo:!0,startAvailable:!0},beatFriend:{bonus:10,interval:"1 minute",
type:cleverapps.ShareBonus.REQUEST,startAvailable:!0},champion:{bonus:20,interval:"1 hour",type:cleverapps.ShareBonus.DIALOG,isRewardedVideo:!0},newLeague:{bonus:50,interval:"1 hour",type:cleverapps.ShareBonus.DIALOG,isRewardedVideo:!0,startAvailable:!0},dailyCup:{bonus:20,interval:"20 minutes",type:cleverapps.ShareBonus.DIALOG,isRewardedVideo:!0}},Object.keys(cleverapps.ShareBonus.SHARES).forEach(function(e){cleverapps.ShareBonus.SHARES[e].id=e}),cleverapps.ShareBonus.BONUS_REDUCED=10,cleverapps.ShareBonus.REWARD_AVAILABLE={episode:2,level:1};var ShareBonusButton=BonusButton.extend({ctor:function(e){var t=this.shareBonus=new cleverapps.ShareBonus(e.shareBonus),n=e.callback||function(){},s=t.type===cleverapps.ShareBonus.VIDEO?"messages:WatchAd":"messages:Share",i={score:e.score};e.level&&(i.levelNo=e.level.getHumanReadableNumber()),e.toReplace&&cleverapps.override(i,e.toReplace),this._super({reward:t.bonus,text:s,onClick:function(){t.takeBonus(this.createListener(function(){
Buttons.remove(this),e.window&&e.window.addReward&&e.window.addReward(t.bonus)?n():this.animateCollectCoin(n)}.bind(this)),i)}})}});ShareBonusButton.create=function(e){var t=new cleverapps.ShareBonus(e.shareBonus);if(!cleverapps.flags.noviral&&!cleverapps.flags.noshares&&cleverapps.social.isLoggedIn()&&t.isReady())return new ShareBonusButton(e)},cleverapps.styles.ShareBonusButton={width:280,height:110};var ShareCheckBox=cleverapps.UI.CheckBox.extend({ctor:function(e,t){this.window=t,this.shareOptions=e,this._super({onChange:this.onChange.bind(this),label:{text:"messages:Share",font:this.window.withBg?cleverapps.styles.FONTS.WINDOW_TEXT:cleverapps.styles.FONTS.WHITE_TEXT,clickable:!0},styles:cleverapps.styles.ShareCheckBox}),this.updateState()},onChange:function(e){ShareCheckBox.UNCHECKED[this.window.name]=!e},shareDialog:function(t){cleverapps.social.checkConnection(function(){var e=cleverapps.ShareBonus.cycleShareData(t.shareId,t.toReplace);cleverapps.social.shareDialog(e,function(e){
e===cleverapps.Social.CODE_SUCCEED?(cleverapps.history.add("share",1),cleverapps.eventLogger.logEvent(cleverapps.EVENTS.SHARE),cleverapps.eventLogger.logEvent(cleverapps.EVENTS.SHARE_ITEM,{id:t.shareId})):console.log(Messages.get("ShareBonus.ShareFailed")+e)}.bind(this))}.bind(this))},updateState:function(){this.checkBox.setSelected(this.isWindowChecked())},onWindowClose:function(){this.isWindowChecked()&&this.shareDialog(this.shareOptions)},isWindowChecked:function(){return!ShareCheckBox.UNCHECKED[this.window.name]}});ShareCheckBox.UNCHECKED={},cleverapps.styles.ShareCheckBox={margin:15,padding:{x:0,y:0},checkImage:bundles.main.frames.select_friend_checkbox_selected,bgImage:bundles.main.frames.select_friend_checkbox};var Messages={dictionary:void 0,onInitializedListeners:{},isInitialized:function(){return this.dictionary},get:function(e,t){if(!Messages.dictionary)return"";"string"==typeof e&&0===e.indexOf("messages:")&&(e=e.substring("messages:".length))
;var n=cleverapps.skins.getSlot("localization");n[e]&&(e=n[e]);var s=Messages.dictionary[e];if(void 0===s)return console.log("WARN: langugage_"+cleverapps.settings.language),console.log("Cant find TEXT string by code: "+e),console.log((new Error).stack),"";if(Array.isArray(s))for(var i=0;i<s.length;i++)s[i]=Messages.replace(s[i],t);else s=Messages.replace(s,t);return s},has:function(e){return!!Messages.dictionary&&("string"==typeof e&&0===e.indexOf("messages:")&&(e=e.substring("messages:".length)),Messages.dictionary[e])},replace:function(e,t){if(void 0===t&&(t={}),"string"==typeof e&&-1!==e.indexOf("%{facebook}")){var n=cleverapps.social.getCode();"mobile_ok"!==n&&"web_ok"!==n||(n="ok"),"mobile_vk"!==n&&"web_vk"!==n||(n="vk"),"mbga"!==n&&"sp_mbga"!==n||(n="mbga"),"nk"===n&&(n="nk"),Messages.dictionary[n]||(n="facebook"),t.facebook=Messages.get(n)}if("string"==typeof e)for(var s in t){var i=t[s];"string"==typeof i&&0===i.indexOf("messages:")&&(i=Messages.get(i)),e=(e=e.replace(
"%{"+s+"}",i)).replace("%{"+s+"}",i)}return e},getLocalized:function(e,t){if("string"==typeof e)return 0===e.indexOf("messages:")&&(e=Messages.get(e.substring("messages:".length))),e=Messages.replace(e,t);if("object"==typeof e&&0<cleverapps.intersect(Object.keys(e),cleverapps.Settings.getAvailableLanguages()).length)return e=void 0!==e[cleverapps.settings.language]?e[cleverapps.settings.language]:e[cc.sys.LANGUAGE_ENGLISH],Messages.getLocalized(e,t);if("object"!=typeof e)return e;for(var n in e=cleverapps.clone(e))e[n]=Messages.getLocalized(e[n],t);return e},preload:function(t,n){cleverapps.bundleLoader.loadBundle("language_"+t,{onSuccess:function(e){Messages.dictionary={},[e.jsons.common_json,e.jsons.lang_json,e.jsons.skin_json,e.jsons.project_json,e.jsons.farm_json,e.jsons.solitaire_json,e.jsons.quests_json].forEach(function(e){e&&cleverapps.extend(Messages.dictionary,cc.loader.getRes(e))}),cleverapps.bundleLoader.deleteBundle("language_"+t),cleverapps.values(
Messages.onInitializedListeners).forEach(cleverapps.callFunc),n()},blocked:!0})}};cleverapps.LocalizationManager={run:function(){(void 0===cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.LOCALIZATION_MANAGER)&&this.hasInconsistentLanguage()||this.hasFirstInitLanguageWindow())&&this.displayLanguageWindow()},hasInconsistentLanguage:function(){var e=cleverapps.settings.language,t=cleverapps.Settings.getAvailableLanguages(),n=cleverapps.Settings.getDefaultLanguage();return e!==n&&0<=t.indexOf(n)},hasFirstInitLanguageWindow:function(){return 0===levels.user.episode&&0===levels.user.level&&"plinga"===cleverapps.User.calcSource()&&"riddles"===cleverapps.config.name},displayLanguageWindow:function(){cleverapps.metha.displayWhenFreeFocus({focus:"displayInconsistentLanguage",action:function(e){cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.LOCALIZATION_MANAGER,1),new LanguagesWindow,cleverapps.metha.onceNoWindowsListener=e}})}},cleverapps.TempGoods=function(){this.load()},
cleverapps.TempGoods.prototype.buyGood=function(e,t){this.checkGoodBuyed(e)?this.currentGooods[e].actionTime+=t:this.currentGooods[e]={buyTime:Date.now(),actionTime:t,fpShowed:0},this.save()},cleverapps.TempGoods.prototype.reset=function(){this.currentGooods={},this.save()},cleverapps.TempGoods.prototype.resetGood=function(e){this.currentGooods[e]&&(delete this.currentGooods[e],this.save())},cleverapps.TempGoods.prototype.goodLeftTime=function(e){if(void 0===this.currentGooods[e])return 0;var t=this.currentGooods[e].buyTime+this.currentGooods[e].actionTime-Date.now();return t<=0?0:t},cleverapps.TempGoods.prototype.checkGoodBuyed=function(e){return 0<this.goodLeftTime(e)},cleverapps.TempGoods.prototype.displayPromotionOnFinish=function(){if(!cleverapps.flags.nopayments)for(var e in this.currentGooods)if(!this.currentGooods[e].fpShowed&&0===this.goodLeftTime(e))return void this.showPromotion(e)},cleverapps.TempGoods.prototype.showPromotion=function(t){cleverapps.metha.display({
focus:"TempGoodFinishWindow",action:function(e){this.currentGooods[t].fpShowed=1,this.save(),new TempGoodFinishWindow(t),cleverapps.metha.onceNoWindowsListener=e}.bind(this)})},cleverapps.TempGoods.prototype.getInfo=function(){return this.currentGooods},cleverapps.TempGoods.prototype.updateInfo=function(e,t){this.currentGooods=e,this.save(t)},cleverapps.TempGoods.prototype.load=function(){var e=cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.TEMP_GOODS);this.currentGooods=void 0!==e?e:{}},cleverapps.TempGoods.prototype.save=function(e){cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.TEMP_GOODS,this.getInfo()),e||cleverapps.synchronizer.addUpdateTask("tempgoods")},cleverapps.TempGoods.UNLIMITED_LIVES=1;var TempGoodFinishWindow=Window.extend({onWindowLoaded:function(e){this.goodType=parseInt(e);var t=cleverapps.styles.TempGoodFinishWindow,n=new cc.Node;if(n.setContentSize(t.width,t.height),n.setAnchorPoint(.5,.5),bundles.temp_good_finish_window.jsons.lives_json){
var s=new cleverapps.Spine(bundles.temp_good_finish_window.jsons.lives_json);n.addChild(s),-1!==["differences","tripeaks"].indexOf(cleverapps.config.name)?s.setAnimationAndIdleAfter("no_life","idle"):s.setAnimation(0,"no_life",!0),s.setPosition(cleverapps.styles.TempGoodFinishWindow.sad_icon.x,cleverapps.styles.TempGoodFinishWindow.sad_icon.y)}var i=cleverapps.UI.generateTTFText("messages:TempGoodsFinishWindow.unlimitedLivesText",cleverapps.styles.FONTS.WINDOW_TEXT);if(n.addChild(i),i.setDimensions(cleverapps.styles.TempGoodFinishWindow.text.width,0),i.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER),i.setPosition(cleverapps.styles.TempGoodFinishWindow.text.x,cleverapps.styles.TempGoodFinishWindow.text.y),t.goodIcon){var o=new cc.Sprite(bundles.reward_icons.frames.life_unlim);n.addChild(o),o.setPosition(cleverapps.styles.TempGoodFinishWindow.good_icon.x,cleverapps.styles.TempGoodFinishWindow.good_icon.y)}var r=cleverapps.overrideStyles(cleverapps.styles.Window,t.window,!0);this._super(
{content:n,title:"messages:TempGoodsFinishWindow.title",name:"tempgoodsfinishwindow",styles:r,button:{content:this.getButtonContent(),width:cleverapps.styles.TempGoodFinishWindow.button.width,height:cleverapps.styles.TempGoodFinishWindow.button.height,onPressed:this.onBuy.bind(this)}}),Lottery.addIcon(this.button),t.hero&&(this.hero=new cleverapps.Spine(bundles.hero.jsons.hero_json,1),this.hero.setAnimation(0,"lose",!0),this.hero.setPositionRound(t.hero),this.addChild(this.hero)),cleverapps.audio.playSound(bundles.temp_good_finish_window.urls.lives_effect)},onBuy:function(){if(this.goodType===cleverapps.TempGoods.UNLIMITED_LIVES){var e=Product.Create("unlimitedLives"),t=function(){this.close()}.bind(this);e.buy(t)}},getButtonContent:function(){if(this.goodType===cleverapps.TempGoods.UNLIMITED_LIVES)return new ProductPriceView(Product.Create("unlimitedLives"),{font:cleverapps.styles.FONTS.BUTTON_TEXT});var e=new cc.Node;return e.setAnchorPoint(.5,.5),e},listBundles:function(){return[
"temp_good_finish_window"]}});cleverapps.styles.TempGoodFinishWindow={width:650,height:400,goodIcon:!0,sad_icon:{x:100,y:190},good_icon:{x:170,y:110},text:{x:450,y:190,width:400},button:{width:300,height:100},window:{}},function(i,d){"use strict";var u="function",e="undefined",t="model",n="name",s="type",o="vendor",r="version",a="architecture",c="console",l="mobile",p="tablet",h="smarttv",g="wearable",v={extend:function(e,t){var n={};for(var s in e)t[s]&&t[s].length%2==0?n[s]=t[s].concat(e[s]):n[s]=e[s];return n},has:function(e,t){return"string"==typeof e&&-1!==t.toLowerCase().indexOf(e.toLowerCase())},lowerize:function(e){return e.toLowerCase()},major:function(e){return"string"==typeof e?e.replace(/[^\d\.]/g,"").split(".")[0]:d},trim:function(e){return e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}},m={rgx:function(e,t){for(var n,s,i,o,r,a,c=0;c<t.length&&!r;){var l=t[c],p=t[c+1];for(n=s=0;n<l.length&&!r;)if(r=l[n++].exec(e))for(i=0;i<p.length;i++)a=r[++s],"object"==typeof(o=p[i]
)&&0<o.length?2==o.length?typeof o[1]==u?this[o[0]]=o[1].call(this,a):this[o[0]]=o[1]:3==o.length?typeof o[1]!==u||o[1].exec&&o[1].test?this[o[0]]=a?a.replace(o[1],o[2]):d:this[o[0]]=a?o[1].call(this,a,o[2]):d:4==o.length&&(this[o[0]]=a?o[3].call(this,a.replace(o[1],o[2])):d):this[o]=a||d;c+=2}},str:function(e,t){for(var n in t)if("object"==typeof t[n]&&0<t[n].length){for(var s=0;s<t[n].length;s++)if(v.has(t[n][s],e))return"?"===n?d:n}else if(v.has(t[n],e))return"?"===n?d:n;return e}},f={browser:{oldsafari:{version:{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}}},device:{amazon:{model:{"Fire Phone":["SD","KF"]}},sprint:{model:{"Evo Shift 4G":"7373KT"},vendor:{HTC:"APA",Sprint:"Sprint"}}},os:{windows:{version:{ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"}}}},_={browser:[[/(opera\smini)\/([\w\.-]+)/i,
/(opera\s[mobiletab]+).+version\/([\w\.-]+)/i,/(opera).+version\/([\w\.]+)/i,/(opera)[\/\s]+([\w\.]+)/i],[n,r],[/(opios)[\/\s]+([\w\.]+)/i],[[n,"Opera Mini"],r],[/\s(opr)\/([\w\.]+)/i],[[n,"Opera"],r],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?([\w\.]+)*/i,/(avant\s|iemobile|slim|baidu)(?:browser)?[\/\s]?([\w\.]*)/i,/(?:ms|\()(ie)\s([\w\.]+)/i,/(rekonq)\/([\w\.]+)*/i,/(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser)\/([\w\.-]+)/i],[n,r],[/(trident).+rv[:\s]([\w\.]+).+like\sgecko/i],[[n,"IE"],r],[/(edge)\/((\d+)?[\w\.]+)/i],[n,r],[/(yabrowser)\/([\w\.]+)/i],[[n,"Yandex"],r],[/(puffin)\/([\w\.]+)/i],[[n,"Puffin"],r],[/((?:[\s\/])uc?\s?browser|(?:juc.+)ucweb)[\/\s]?([\w\.]+)/i],[[n,"UCBrowser"],r],[/(comodo_dragon)\/([\w\.]+)/i],[[n,/_/g," "],r],[/(micromessenger)\/([\w\.]+)/i],[[n,"WeChat"],r],[/(QQ)\/([\d\.]+)/i],[n,r],[/m?(qqbrowser)[\/\s]?([\w\.]+)/i],[n,r],[/xiaomi\/miuibrowser\/([\w\.]+)/i],[
r,[n,"MIUI Browser"]],[/;fbav\/([\w\.]+);/i],[r,[n,"Facebook"]],[/headlesschrome(?:\/([\w\.]+)|\s)/i],[r,[n,"Chrome Headless"]],[/\swv\).+(chrome)\/([\w\.]+)/i],[[n,/(.+)/,"$1 WebView"],r],[/((?:oculus|samsung)browser)\/([\w\.]+)/i],[[n,/(.+(?:g|us))(.+)/,"$1 $2"],r],[/android.+version\/([\w\.]+)\s+(?:mobile\s?safari|safari)*/i],[r,[n,"Android Browser"]],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?([\w\.]+)/i],[n,r],[/(dolfin)\/([\w\.]+)/i],[[n,"Dolphin"],r],[/((?:android.+)crmo|crios)\/([\w\.]+)/i],[[n,"Chrome"],r],[/(coast)\/([\w\.]+)/i],[[n,"Opera Coast"],r],[/fxios\/([\w\.-]+)/i],[r,[n,"Firefox"]],[/version\/([\w\.]+).+?mobile\/\w+\s(safari)/i],[r,[n,"Mobile Safari"]],[/version\/([\w\.]+).+?(mobile\s?safari|safari)/i],[r,n],[/webkit.+?(gsa)\/([\w\.]+).+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[[n,"GSA"],r],[/webkit.+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[n,[r,m.str,f.browser.oldsafari.version]],[/(konqueror)\/([\w\.]+)/i,/(webkit|khtml)\/([\w\.]+)/i],[n,r],[
/(navigator|netscape)\/([\w\.-]+)/i],[[n,"Netscape"],r],[/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?([\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([\w\.-]+)$/i,/(mozilla)\/([\w\.]+).+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir)[\/\s]?([\w\.]+)/i,/(links)\s\(([\w\.]+)/i,/(gobrowser)\/?([\w\.]+)*/i,/(ice\s?browser)\/v?([\w\._]+)/i,/(mosaic)[\/\s]([\w\.]+)/i],[n,r]],cpu:[[/(?:(amd|x(?:(?:86|64)[_-])?|wow|win)64)[;\)]/i],[[a,"amd64"]],[/(ia32(?=;))/i],[[a,v.lowerize]],[/((?:i[346]|x)86)[;\)]/i],[[a,"ia32"]],[/windows\s(ce|mobile);\sppc;/i],[[a,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?:\smac|;|\))/i],[[a,/ower/,"",v.lowerize]],[/(sun4\w)[;\)]/i],[[a,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|arm(?:64|(?=v\d+;))|(?=atmel\s)avr|(?:irix|mips|sparc)(?:64)?(?=;)|pa-risc)/i],[[a,v.lowerize]]],device:[[/\((ipad|playbook);[\w\s\);-]+(rim|apple)/i],[t,o,[s,p]],[
/applecoremedia\/[\w\.]+ \((ipad)/],[t,[o,"Apple"],[s,p]],[/(apple\s{0,1}tv)/i],[[t,"Apple TV"],[o,"Apple"]],[/(archos)\s(gamepad2?)/i,/(hp).+(touchpad)/i,/(hp).+(tablet)/i,/(kindle)\/([\w\.]+)/i,/\s(nook)[\w\s]+build\/(\w+)/i,/(dell)\s(strea[kpr\s\d]*[\dko])/i],[o,t,[s,p]],[/(kf[A-z]+)\sbuild\/[\w\.]+.*silk\//i],[t,[o,"Amazon"],[s,p]],[/(sd|kf)[0349hijorstuw]+\sbuild\/[\w\.]+.*silk\//i],[[t,m.str,f.device.amazon.model],[o,"Amazon"],[s,l]],[/\((ip[honed|\s\w*]+);.+(apple)/i],[t,o,[s,l]],[/\((ip[honed|\s\w*]+);/i],[t,[o,"Apple"],[s,l]],[/(blackberry)[\s-]?(\w+)/i,/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[\s_-]?([\w-]+)*/i,/(hp)\s([\w\s]+\w)/i,/(asus)-?(\w+)/i],[o,t,[s,l]],[/\(bb10;\s(\w+)/i],[t,[o,"BlackBerry"],[s,l]],[/android.+(transfo[prime\s]{4,10}\s\w+|eeepc|slider\s\w+|nexus 7|padfone)/i],[t,[o,"Asus"],[s,p]],[/(sony)\s(tablet\s[ps])\sbuild\//i,/(sony)?(?:sgp.+)\sbuild\//i],[[o,"Sony"],[t,"Xperia Tablet"],[s,p]],[
/android.+\s([c-g]\d{4}|so[-l]\w+)\sbuild\//i],[t,[o,"Sony"],[s,l]],[/\s(ouya)\s/i,/(nintendo)\s([wids3u]+)/i],[o,t,[s,c]],[/android.+;\s(shield)\sbuild/i],[t,[o,"Nvidia"],[s,c]],[/(playstation\s[34portablevi]+)/i],[t,[o,"Sony"],[s,c]],[/(sprint\s(\w+))/i],[[o,m.str,f.device.sprint.vendor],[t,m.str,f.device.sprint.model],[s,l]],[/(lenovo)\s?(S(?:5000|6000)+(?:[-][\w+]))/i],[o,t,[s,p]],[/(htc)[;_\s-]+([\w\s]+(?=\))|\w+)*/i,/(zte)-(\w+)*/i,/(alcatel|geeksphone|lenovo|nexian|panasonic|(?=;\s)sony)[_\s-]?([\w-]+)*/i],[o,[t,/_/g," "],[s,l]],[/(nexus\s9)/i],[t,[o,"HTC"],[s,p]],[/d\/huawei([\w\s-]+)[;\)]/i,/(nexus\s6p)/i],[t,[o,"Huawei"],[s,l]],[/(microsoft);\s(lumia[\s\w]+)/i],[o,t,[s,l]],[/[\s\(;](xbox(?:\sone)?)[\s\);]/i],[t,[o,"Microsoft"],[s,c]],[/(kin\.[onetw]{3})/i],[[t,/\./g," "],[o,"Microsoft"],[s,l]],[/\s(milestone|droid(?:[2-4x]|\s(?:bionic|x2|pro|razr))?(:?\s4g)?)[\w\s]+build\//i,/mot[\s-]?(\w+)*/i,/(XT\d{3,4}) build\//i,/(nexus\s6)/i],[t,[o,"Motorola"],[s,l]],[
/android.+\s(mz60\d|xoom[\s2]{0,2})\sbuild\//i],[t,[o,"Motorola"],[s,p]],[/hbbtv\/\d+\.\d+\.\d+\s+\([\w\s]*;\s*(\w[^;]*);([^;]*)/i],[[o,v.trim],[t,v.trim],[s,h]],[/hbbtv.+maple;(\d+)/i],[[t,/^/,"SmartTV"],[o,"Samsung"],[s,h]],[/\(dtv[\);].+(aquos)/i],[t,[o,"Sharp"],[s,h]],[/android.+((sch-i[89]0\d|shw-m380s|gt-p\d{4}|gt-n\d+|sgh-t8[56]9|nexus 10))/i,/((SM-T\w+))/i],[[o,"Samsung"],t,[s,p]],[/smart-tv.+(samsung)/i],[o,[s,h],t],[/((s[cgp]h-\w+|gt-\w+|galaxy\snexus|sm-\w[\w\d]+))/i,/(sam[sung]*)[\s-]*(\w+-?[\w-]*)*/i,/sec-((sgh\w+))/i],[[o,"Samsung"],t,[s,l]],[/sie-(\w+)*/i],[t,[o,"Siemens"],[s,l]],[/(maemo|nokia).*(n900|lumia\s\d+)/i,/(nokia)[\s_-]?([\w-]+)*/i],[[o,"Nokia"],t,[s,l]],[/android\s3\.[\s\w;-]{10}(a\d{3})/i],[t,[o,"Acer"],[s,p]],[/android.+([vl]k\-?\d{3})\s+build/i],[t,[o,"LG"],[s,p]],[/android\s3\.[\s\w;-]{10}(lg?)-([06cv9]{3,4})/i],[[o,"LG"],t,[s,p]],[/(lg) netcast\.tv/i],[o,t,[s,h]],[/(nexus\s[45])/i,/lg[e;\s\/-]+(\w+)*/i,/android.+lg(\-?[\d\w]+)\s+build/i],[t,[o,"LG"],[s,l
]],[/android.+(ideatab[a-z0-9\-\s]+)/i],[t,[o,"Lenovo"],[s,p]],[/linux;.+((jolla));/i],[o,t,[s,l]],[/((pebble))app\/[\d\.]+\s/i],[o,t,[s,g]],[/android.+;\s(oppo)\s?([\w\s]+)\sbuild/i],[o,t,[s,l]],[/crkey/i],[[t,"Chromecast"],[o,"Google"]],[/android.+;\s(glass)\s\d/i],[t,[o,"Google"],[s,g]],[/android.+;\s(pixel c)\s/i],[t,[o,"Google"],[s,p]],[/android.+;\s(pixel xl|pixel)\s/i],[t,[o,"Google"],[s,l]],[/android.+(\w+)\s+build\/hm\1/i,/android.+(hm[\s\-_]*note?[\s_]*(?:\d\w)?)\s+build/i,/android.+(mi[\s\-_]*(?:one|one[\s_]plus|note lte)?[\s_]*(?:\d\w)?)\s+build/i,/android.+(redmi[\s\-_]*(?:note)?(?:[\s_]*[\w\s]+)?)\s+build/i],[[t,/_/g," "],[o,"Xiaomi"],[s,l]],[/android.+(mi[\s\-_]*(?:pad)?(?:[\s_]*[\w\s]+)?)\s+build/i],[[t,/_/g," "],[o,"Xiaomi"],[s,p]],[/android.+;\s(m[1-5]\snote)\sbuild/i],[t,[o,"Meizu"],[s,p]],[/android.+a000(1)\s+build/i],[t,[o,"OnePlus"],[s,l]],[/android.+[;\/]\s*(RCT[\d\w]+)\s+build/i],[t,[o,"RCA"],[s,p]],[/android.+[;\/]\s*(Venue[\d\s]*)\s+build/i],[t,[o,"Dell"],[s,p
]],[/android.+[;\/]\s*(Q[T|M][\d\w]+)\s+build/i],[t,[o,"Verizon"],[s,p]],[/android.+[;\/]\s+(Barnes[&\s]+Noble\s+|BN[RT])(V?.*)\s+build/i],[[o,"Barnes & Noble"],t,[s,p]],[/android.+[;\/]\s+(TM\d{3}.*\b)\s+build/i],[t,[o,"NuVision"],[s,p]],[/android.+[;\/]\s*(zte)?.+(k\d{2})\s+build/i],[[o,"ZTE"],t,[s,p]],[/android.+[;\/]\s*(gen\d{3})\s+build.*49h/i],[t,[o,"Swiss"],[s,l]],[/android.+[;\/]\s*(zur\d{3})\s+build/i],[t,[o,"Swiss"],[s,p]],[/android.+[;\/]\s*((Zeki)?TB.*\b)\s+build/i],[t,[o,"Zeki"],[s,p]],[/(android).+[;\/]\s+([YR]\d{2}x?.*)\s+build/i,/android.+[;\/]\s+(Dragon[\-\s]+Touch\s+|DT)(.+)\s+build/i],[[o,"Dragon Touch"],t,[s,p]],[/android.+[;\/]\s*(NS-?.+)\s+build/i],[t,[o,"Insignia"],[s,p]],[/android.+[;\/]\s*((NX|Next)-?.+)\s+build/i],[t,[o,"NextBook"],[s,p]],[/android.+[;\/]\s*(Xtreme\_?)?(V(1[045]|2[015]|30|40|60|7[05]|90))\s+build/i],[[o,"Voice"],t,[s,l]],[/android.+[;\/]\s*(LVTEL\-?)?(V1[12])\s+build/i],[[o,"LvTel"],t,[s,l]],[
/android.+[;\/]\s*(V(100MD|700NA|7011|917G).*\b)\s+build/i],[t,[o,"Envizen"],[s,p]],[/android.+[;\/]\s*(Le[\s\-]+Pan)[\s\-]+(.*\b)\s+build/i],[o,t,[s,p]],[/android.+[;\/]\s*(Trio[\s\-]*.*)\s+build/i],[t,[o,"MachSpeed"],[s,p]],[/android.+[;\/]\s*(Trinity)[\-\s]*(T\d{3})\s+build/i],[o,t,[s,p]],[/android.+[;\/]\s*TU_(1491)\s+build/i],[t,[o,"Rotor"],[s,p]],[/android.+(KS(.+))\s+build/i],[t,[o,"Amazon"],[s,p]],[/android.+(Gigaset)[\s\-]+(Q.+)\s+build/i],[o,t,[s,p]],[/\s(tablet|tab)[;\/]/i,/\s(mobile)(?:[;\/]|\ssafari)/i],[[s,v.lowerize],o,t],[/(android.+)[;\/].+build/i],[t,[o,"Generic"]]],engine:[[/windows.+\sedge\/([\w\.]+)/i],[r,[n,"EdgeHTML"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],[n,r],[/rv\:([\w\.]+).*(gecko)/i],[r,n]],os:[[/microsoft\s(windows)\s(vista|xp)/i],[n,r],[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*)[\s\/]?([\d\.\s]+\w)*/i,
/(windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i],[n,[r,m.str,f.os.windows.version]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[[n,"Windows"],[r,m.str,f.os.windows.version]],[/\((bb)(10);/i],[[n,"BlackBerry"],r],[/(blackberry)\w*\/?([\w\.]+)*/i,/(tizen)[\/\s]([\w\.]+)/i,/(android|webos|palm\sos|qnx|bada|rim\stablet\sos|meego|contiki)[\/\s-]?([\w\.]+)*/i,/linux;.+(sailfish);/i],[n,r],[/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]+)*/i],[[n,"Symbian"],r],[/\((series40);/i],[n],[/mozilla.+\(mobile;.+gecko.+firefox/i],[[n,"Firefox OS"],r],[/(nintendo|playstation)\s([wids34portablevu]+)/i,/(mint)[\/\s\(]?(\w+)*/i,/(mageia|vectorlinux)[;\s]/i,/(joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|(?=\s)arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|linpus)[\/\s-]?(?!chrom)([\w\.-]+)*/i,/(hurd|linux)\s?([\w\.]+)*/i,/(gnu)\s?([\w\.]+)*/i],[n,r],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[[n,"Chromium OS"],r],[/(sunos)\s?([\w\.]+\d)*/i],[[n,"Solaris"],r],[
/\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]+)*/i],[n,r],[/(haiku)\s(\w+)/i],[n,r],[/cfnetwork\/.+darwin/i,/ip[honead]+(?:.*os\s([\w]+)\slike\smac|;\sopera)/i],[[r,/_/g,"."],[n,"iOS"]],[/(mac\sos\sx)\s?([\w\s\.]+\w)*/i,/(macintosh|mac(?=_powerpc)\s)/i],[[n,"Mac OS"],[r,/_/g,"."]],[/((?:open)?solaris)[\/\s-]?([\w\.]+)*/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.]*)*/i,/(plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos|openvms)/i,/(unix)\s?([\w\.]+)*/i],[n,r]]},y=function(e,t){if("object"==typeof e&&(t=e,e=d),!(this instanceof y))return new y(e,t).getResult();var n=e||(i&&i.navigator&&i.navigator.userAgent?i.navigator.userAgent:""),s=t?v.extend(_,t):_;return this.getBrowser=function(){var e={name:d,version:d};return m.rgx.call(e,n,s.browser),e.major=v.major(e.version),e},this.getCPU=function(){var e={architecture:d};return m.rgx.call(e,n,s.cpu),e},this.getDevice=function(){var e={vendor:d,model:d,type:d};return m.rgx.call(e,n,s.device),e},this.getEngine=function(){var e={name:d,version:d}
;return m.rgx.call(e,n,s.engine),e},this.getOS=function(){var e={name:d,version:d};return m.rgx.call(e,n,s.os),e},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return n},this.setUA=function(e){return n=e,this},this};y.VERSION="0.7.17",y.BROWSER={NAME:n,MAJOR:"major",VERSION:r},y.CPU={ARCHITECTURE:a},y.DEVICE={MODEL:t,VENDOR:o,TYPE:s,CONSOLE:c,MOBILE:l,SMARTTV:h,TABLET:p,WEARABLE:g,EMBEDDED:"embedded"},y.ENGINE={NAME:n,VERSION:r},y.OS={NAME:n,VERSION:r},typeof exports!==e?(typeof module!==e&&module.exports&&(exports=module.exports=y),exports.UAParser=y):typeof define===u&&define.amd?define(function(){return y}):i&&(i.UAParser=y);var w=i&&(i.jQuery||i.Zepto);if(typeof w!==e){var b=new y;w.ua=b.getResult(),w.ua.get=function(){return b.getUA()},w.ua.set=function(e){b.setUA(e);var t=b.getResult();for(var n in t)w.ua[n]=t[n]}}}(
"object"==typeof window?window:this),function(e,t){"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?module.exports=t():e.SuperGif=t()}(this,function(){var a=function(e){return e.reduce(function(e,t){return 2*e+t},0)},c=function(e){for(var t=[],n=7;0<=n;n--)t.push(!!(e&1<<n));return t},se=function(e){this.data=e,this.len=this.data.length,this.pos=0,this.readByte=function(){if(this.pos>=this.data.length)throw new Error("Attempted to read past end of stream.");return e instanceof Uint8Array?e[this.pos++]:255&e.charCodeAt(this.pos++)},this.readBytes=function(e){for(var t=[],n=0;n<e;n++)t.push(this.readByte());return t},this.read=function(e){for(var t="",n=0;n<e;n++)t+=String.fromCharCode(this.readByte());return t},this.readUnsigned=function(){var e=this.readBytes(2);return(e[1]<<8)+e[0]}},ie=function(i,o){o||(o={});var s=function(e){for(var t=[],n=0;n<e;n++)t.push(i.readBytes(3));return t},r=function(){var e,t;for(t="";e=i.readByte(),t+=i.read(e),0!==e;);return t
},t=function(e){e.leftPos=i.readUnsigned(),e.topPos=i.readUnsigned(),e.width=i.readUnsigned(),e.height=i.readUnsigned();var t=c(i.readByte());e.lctFlag=t.shift(),e.interlaced=t.shift(),e.sorted=t.shift(),e.reserved=t.splice(0,2),e.lctSize=a(t.splice(0,3)),e.lctFlag&&(e.lct=s(1<<e.lctSize+1)),e.lzwMinCodeSize=i.readByte();var n=r();e.pixels=function(t,s){for(var e,n,i=0,o=function(e){for(var t=0,n=0;n<e;n++)s.charCodeAt(i>>3)&1<<(7&i)&&(t|=1<<n),i++;return t},r=[],a=1<<t,c=a+1,l=t+1,p=[],d=function(){p=[],l=t+1;for(var e=0;e<a;e++)p[e]=[e];p[a]=[],p[c]=null};;)if(n=e,(e=o(l))!==a){if(e===c)break;if(e<p.length)n!==a&&p.push(p[n].concat(p[e][0]));else{if(e!==p.length)throw new Error("Invalid LZW code.");p.push(p[n].concat(p[n][0]))}r.push.apply(r,p[e]),p.length===1<<l&&l<12&&l++}else d();return r}(e.lzwMinCodeSize,n),e.interlaced&&(e.pixels=function(e,t){for(var n,s,i,o=new Array(e.length),r=e.length/t,a=[0,4,2,1],c=[8,8,4,2],l=0,p=0;p<4;p++)for(var d=a[p];d<r;d+=c[p])n=d,s=l,i=e.slice(
s*t,(s+1)*t),o.splice.apply(o,[n*t,t].concat(i)),l++;return o}(e.pixels,e.width)),o.img&&o.img(e)},n=function(){var e={};switch(e.sentinel=i.readByte(),String.fromCharCode(e.sentinel)){case"!":e.type="ext",function(e){var t,n;switch(e.label=i.readByte(),e.label){case 249:e.extType="gce",function(e){i.readByte();var t=c(i.readByte());e.reserved=t.splice(0,3),e.disposalMethod=a(t.splice(0,3)),e.userInput=t.shift(),e.transparencyGiven=t.shift(),e.delayTime=i.readUnsigned(),e.transparencyIndex=i.readByte(),e.terminator=i.readByte(),o.gce&&o.gce(e)}(e);break;case 254:e.extType="com",(n=e).comment=r(),o.com&&o.com(n);break;case 1:e.extType="pte",s=e,i.readByte(),s.ptHeader=i.readBytes(12),s.ptData=r(),o.pte&&o.pte(s);break;case 255:e.extType="app",function(e){var t,n;switch(i.readByte(),e.identifier=i.read(8),e.authCode=i.read(3),e.identifier){case"NETSCAPE":n=e,i.readByte(),n.unknown=i.readByte(),n.iterations=i.readUnsigned(),n.terminator=i.readByte(),o.app&&o.app.NETSCAPE&&o.app.NETSCAPE(n
);break;default:(t=e).appData=r(),o.app&&o.app[t.identifier]&&o.app[t.identifier](t)}}(e);break;default:e.extType="unknown",(t=e).data=r(),o.unknown&&o.unknown(t)}var s}(e);break;case",":e.type="img",t(e);break;case";":e.type="eof",o.eof&&o.eof(e);break;default:throw new Error("Unknown block: 0x"+e.sentinel.toString(16))}"eof"!==e.type&&setTimeout(n,0)};!function(){var e={};if(e.sig=i.read(3),e.ver=i.read(3),"GIF"!==e.sig)throw new Error("Not a GIF file.");e.width=i.readUnsigned(),e.height=i.readUnsigned();var t=c(i.readByte());e.gctFlag=t.shift(),e.colorRes=a(t.splice(0,3)),e.sorted=t.shift(),e.gctSize=a(t.splice(0,3)),e.bgColor=i.readByte(),e.pixelAspectRatio=i.readByte(),e.gctFlag&&(e.gct=s(1<<e.gctSize+1)),o.hdr&&o.hdr(e)}(),setTimeout(n,0)};return function(e){var s,i,a={vp_l:0,vp_t:0,vp_w:null,vp_h:null,c_w:null,c_h:null};for(var t in e)a[t]=e[t];a.vp_w&&a.vp_h&&(a.is_vp=!0);var n=null,o=!1,r=null,c=null,l=null,p=null,d=null,u=null,h=null,g=!0,v=!1,m=[],f=[],_=[],y=a.gif;if(!y){
var w=new Image;w.crossOrigin="Anonymous",w.src="",y=w}void 0===a.auto_play&&(a.auto_play=!y.getAttribute("rel:auto_play")||"1"==y.getAttribute("rel:auto_play"));var b,T,S,E,C,A,I,R,L,O,P,x,k=a.hasOwnProperty("on_end")?a.on_end:null,M=a.hasOwnProperty("loop_delay")?a.loop_delay:0,N=a.hasOwnProperty("loop_mode")?a.loop_mode:"auto",B=!a.hasOwnProperty("draw_while_loading")||a.draw_while_loading,D=!!B&&(!a.hasOwnProperty("show_progress_bar")||a.show_progress_bar),F=a.hasOwnProperty("progressbar_height")?a.progressbar_height:25,U=a.hasOwnProperty("progressbar_background_color")?a.progressbar_background_color:"rgba(255,255,255,0.4)",W=a.hasOwnProperty("progressbar_foreground_color")?a.progressbar_foreground_color:"rgba(255,0,22,.8)",V=function(){d=l,u=l=c=r=null},G=function(){try{ie(s,Q)}catch(e){z("parse")}},H=function(e,t){L.width=e*$(),L.height=t*$(),P.style.minWidth=e*$()+"px",x.width=e,x.height=t,x.style.width=e+"px",x.style.height=t+"px",x.getContext("2d").setTransform(1,0,0,1,0,0)},
j=function(e,t,n){if(n&&D){var s,i,o,r=F;a.is_vp?v?(i=(a.vp_t+a.vp_h-r)/$(),r/=$(),s=a.vp_l/$()+e/t*(a.vp_w/$()),o=L.width/$()):(i=a.vp_t+a.vp_h-r,r=r,s=a.vp_l+e/t*a.vp_w,o=L.width):(i=(L.height-r)/(v?$():1),s=e/t*L.width/(v?$():1),o=L.width/(v?$():1),r/=v?$():1),O.fillStyle=U,O.fillRect(s,i,o-s,r),O.fillStyle=W,O.fillRect(0,i,s,r)}},z=function(e){n=e,i={width:y.width,height:y.height},m=[],f=[]},Y=function(){if(u){m.push({data:u.getImageData(0,0,i.width,i.height),delay:c}),_.push({x:0,y:0});var e=new Image;e.addEventListener("load",function(){f.push(e)},!1),e.src=u.canvas.toDataURL()}},X=(E=-1,C=0,A=function(e){E+=e,R()},b=!1,T=function(){null!==k&&k(y),C++,!1!==N||C<0?S():g=b=!1},S=function(){if(b=g){A(1);var e=10*m[E].delay;e||(e=100),0==(E+1+m.length)%m.length?(e+=M,setTimeout(T,e)):setTimeout(S,e)}},R=function(){var e;(E=parseInt(E,10))>m.length-1&&(E=0),E<0&&(E=0),e=_[E],x.getContext("2d").putImageData(m[E].data,e.x,e.y),O.globalCompositeOperation="copy",O.drawImage(x,0,0)},{
init:function(){n||(a.c_w&&a.c_h||O.scale($(),$()),a.auto_play?I():(E=0,R()))},step:I=function(){b||setTimeout(S,0)},play:function(){g=!0,I()},pause:function(){g=!1},getFrames:function(){return f},playing:g,move_relative:A,current_frame:function(){return E},length:function(){return m.length},move_to:function(e){E=e,R()}}),K=function(e){j(s.pos,s.data.length,e)},q=function(){},Z=function(t,n){return function(e){t(e),K(n)}},Q={hdr:Z(function(e){H((i=e).width,i.height)}),gce:Z(function(e){Y(),V(),r=e.transparencyGiven?e.transparencyIndex:null,c=e.delayTime,l=e.disposalMethod}),com:Z(q),app:{NETSCAPE:Z(q)},img:Z(function(e){u||(u=x.getContext("2d"));var t=m.length,n=e.lctFlag?e.lct:i.gct;0<t&&(3===d?null!==p?u.putImageData(m[p].data,0,0):u.clearRect(h.leftPos,h.topPos,h.width,h.height):p=t-1,2===d&&u.clearRect(h.leftPos,h.topPos,h.width,h.height));var s=u.getImageData(e.leftPos,e.topPos,e.width,e.height);e.pixels.forEach(function(e,t){e!==r&&(s.data[4*t+0]=n[e][0],s.data[4*t+1]=n[e][1],
s.data[4*t+2]=n[e][2],s.data[4*t+3]=255)}),u.putImageData(s,e.leftPos,e.topPos),v||(O.scale($(),$()),v=!0),B&&(O.drawImage(x,0,0),B=a.auto_play),h=e},!0),eof:function(e){Y(),K(!1),a.c_w&&a.c_h||(L.width=i.width*$(),L.height=i.height*$()),X.init(),o=!1,te&&te(y)}},J=function(){var e=y.parentNode;e||(e=document.createElement("div")).appendChild(y);var t=document.createElement("div");L=document.createElement("canvas"),O=L.getContext("2d"),P=document.createElement("div"),x=document.createElement("canvas"),t.width=L.width=y.width,t.height=L.height=y.height,P.style.minWidth=y.width+"px",t.className="jsgif",P.className="jsgif_toolbar",t.appendChild(L),t.appendChild(P),e.insertBefore(t,y),e.removeChild(y),a.c_w&&a.c_h&&H(a.c_w,a.c_h),ee=!0},$=function(){return a.max_width&&i&&i.width>a.max_width?a.max_width/i.width:1},ee=!1,te=!1,ne=function(e){return!(o||(te=e||!1,o=!0,m=[],f=[],V(),h=u=d=p=null))};return{play:X.play,pause:X.pause,getFrames:X.getFrames,move_relative:X.move_relative,
move_to:X.move_to,get_playing:function(){return g},get_canvas:function(){return L},get_canvas_scale:function(){return $()},get_loading:function(){return o},get_auto_play:function(){return a.auto_play},get_length:function(){return X.length()},get_current_frame:function(){return X.current_frame()},load_url:function(e,t){if(ne(t)){var n=new XMLHttpRequest;n.open("GET",e,!0),"overrideMimeType"in n?n.overrideMimeType("text/plain; charset=x-user-defined"):"responseType"in n?n.responseType="arraybuffer":n.setRequestHeader("Accept-Charset","x-user-defined"),n.onloadstart=function(){ee||J()},n.onload=function(e){200!=this.status&&z("xhr - response"),"response"in this||(this.response=new VBArray(this.responseText).toArray().map(String.fromCharCode).join(""));var t=this.response;0<t.toString().indexOf("ArrayBuffer")&&(t=new Uint8Array(t)),s=new se(t),setTimeout(G,0)},n.onprogress=function(e){e.lengthComputable&&j(e.loaded,e.total,!0)},n.onerror=function(){z("xhr")},n.send()}},load:function(e){
this.load_url(y.getAttribute("rel:animated_src")||y.src,e)},load_raw:function(e,t){ne(t)&&(ee||J(),s=new se(e),setTimeout(G,0))},set_frame_offset:function(e,t){_[e]?(void 0!==t.x&&(_[e].x=t.x),void 0!==t.y&&(_[e].y=t.y)):_[e]=t}}}}),function(){function s(e,t){var n=this instanceof s?this:i;return n.reset(t),"string"==typeof e&&0<e.length&&n.hash(e),n!==this?n:void 0}var i;s.prototype.hash=function(e){var t,n,s,i,o;switch(o=e.length,this.len+=o,n=this.k1,s=0,this.rem){case 0:n^=s<o?65535&e.charCodeAt(s++):0;case 1:n^=s<o?(65535&e.charCodeAt(s++))<<8:0;case 2:n^=s<o?(65535&e.charCodeAt(s++))<<16:0;case 3:n^=s<o?(255&e.charCodeAt(s))<<24:0,n^=s<o?(65280&e.charCodeAt(s++))>>8:0}if(this.rem=3&o+this.rem,0<(o-=this.rem)){for(t=this.h1;t=4294967295&5*(t=(t^=n=4294967295&13715*(n=(n=4294967295&11601*n+3432906752*(65535&n))<<15|n>>>17)+461832192*(65535&n))<<13|t>>>19)+3864292196,!(o<=s);)n=65535&e.charCodeAt(s++)^(65535&e.charCodeAt(s++))<<8^(65535&e.charCodeAt(s++))<<16,n^=(255&(
i=e.charCodeAt(s++)))<<24^(65280&i)>>8;switch(n=0,this.rem){case 3:n^=(65535&e.charCodeAt(s+2))<<16;case 2:n^=(65535&e.charCodeAt(s+1))<<8;case 1:n^=65535&e.charCodeAt(s)}this.h1=t}return this.k1=n,this},s.prototype.result=function(){var e,t;return e=this.k1,t=this.h1,0<e&&(t^=e=4294967295&13715*(e=(e=4294967295&11601*e+3432906752*(65535&e))<<15|e>>>17)+461832192*(65535&e)),t^=this.len,t=4294967295&51819*(t^=t>>>16)+2246770688*(65535&t),t=4294967295&44597*(t^=t>>>13)+3266445312*(65535&t),(t^=t>>>16)>>>0},s.prototype.reset=function(e){return this.h1="number"==typeof e?e:0,this.rem=this.k1=this.len=0,this},i=new s,"undefined"!=typeof module?module.exports=s:this.MurmurHash3=s}();var RecursiveHasher=function(t,n,s){if("object"==typeof t){if(void 0===s&&(s=new MurmurHash3,n=cleverapps.createSet(n)),Array.isArray(t)){s.hash(""+t.length);for(var e=0;e<t.length;e++)RecursiveHasher(t[e],n,s)}else{Object.keys(t).sort().forEach(function(e){!n[e]&&t[e]&&(s.hash(e),RecursiveHasher(t[e],n,s))})}
return s.result()}"number"==typeof t?s.hash(""+t):s.hash(t)};cleverapps.BoostersCounter=function(e){e?this.initialize():this.load(),this.onChangeListener=function(){},this.onChangeListeners={}},cleverapps.BoostersCounter.prototype.initialize=function(){this.data={},this.addInitAmount()},cleverapps.BoostersCounter.prototype.addInitAmount=function(e){var t=["undefined"!=typeof CellBooster?CellBooster.ID:void 0,"undefined"!=typeof LineBooster?LineBooster.ID:void 0,"undefined"!=typeof ColorBooster?ColorBooster.ID:void 0];"match3"===cleverapps.config.type&&(t=t.concat([BoostersBefore.TYPE_COMBO,BoostersBefore.TYPE_MOVES,BoostersBefore.TYPE_MULTICOLOR])),"solitaire"===cleverapps.config.type&&(t=t.concat([BoostersBefore.TYPE_MAGNET,BoostersBefore.TYPE_DICE,BoostersBefore.TYPE_TWO_JOKERS]));var n=!1;t.forEach(function(e){void 0!==e&&void 0===this.data[e]&&(this.data[e]=cleverapps.BoostersCounter.INIT_AMOUNT,n=!0)},this),n&&!e&&this.save()},
cleverapps.BoostersCounter.prototype.totalAmount=function(){var e=0;for(var t in this.data)e+=this.data[t];return e},cleverapps.BoostersCounter.prototype.load=function(){var e=cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.BOOSTERS_COUNTER);this.data=e||{},this.addInitAmount()},cleverapps.BoostersCounter.prototype.save=function(e){cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.BOOSTERS_COUNTER,this.data),!1!==e&&cleverapps.synchronizer.addUpdateTask("boosters")},cleverapps.BoostersCounter.prototype.getAmount=function(e){return this.data[e]?this.data[e]:0},cleverapps.BoostersCounter.prototype.canUse=function(e){return 0<this.getAmount(e)},cleverapps.BoostersCounter.prototype.use=function(e){this.canUse(e)&&(this.data[e]=this.data[e]-1,this.save(),BoostersBeforeConfig[e]||cleverapps.dailyTasks.addProgress(cleverapps.DailyTask.USE_BOOSTER,{booster:e}),("undefined"!=typeof HintBooster&&e===HintBooster.ID||"undefined"!=typeof DiscoverBooster&&e===DiscoverBooster.ID
)&&cleverapps.dailyTasks.addProgress(cleverapps.DailyTask.USE_HINTS),this.runChangeListeners(e))},cleverapps.BoostersCounter.prototype.add=function(e,t){t=t||1,this.setAmount(e,this.getAmount(e)+t)},cleverapps.BoostersCounter.prototype.setAmount=function(e,t){this.getAmount(e)!==t&&(this.data[e]=t,this.save(),this.runChangeListeners(e))},cleverapps.BoostersCounter.prototype.runChangeListeners=function(e){this.onChangeListener(e),cleverapps.values(this.onChangeListeners).forEach(function(e){e()})},cleverapps.BoostersCounter.INIT_AMOUNT=2;var BoosterAmountView=cc.Node.extend({ctor:function(e){this._super(),this.setAnchorPoint(.5,.5),this.setCascadeOpacityEnabled(!0);var t=cleverapps.styles.BoosterAmountView;this.bg=bundles.game.frames.booster_amount_bg_png?new cc.Sprite(bundles.game.frames.booster_amount_bg_png):new cc.Sprite,this.bg.setScale(t.background.scale),this.bg.setAnchorPoint2(),this.addChild(this.bg),this.amount=cleverapps.UI.generateImageText("",
cleverapps.styles.FONTS.BOOSTER_AMOUNT_TEXT),this.addChild(this.amount),this.booster=e,this.setAmount(e.getAmount())},setAmount:function(e){0<e?(this.visible=!0,this.bg.setVisible(!0),this.amount.setVisible(!0),this.amount.setString(e),this.amount.fitTo(this.bg.width*this.bg.scale*.85)):(this.visible=!1,this.bg.setVisible(!1),this.amount.setVisible(!1)),this.setContentSize2(Math.max(this.bg.width*this.bg.scale,this.amount.width*this.amount.scale),Math.max(this.bg.height*this.bg.scale,this.amount.height*this.amount.scale)),this.amount.setPositionRound(this.width/2,this.height/2+cleverapps.styles.BoosterAmountView.amount.offsetY),this.bg.setPositionRound(this.width/2,this.height/2)}});cleverapps.styles.BoosterAmountView={background:{scale:1},amount:{offsetY:0}};var Gun=function(){this.onShowUpListener=function(){},this.onShowForceListener=function(){},this.onAnimateListener=function(){},this.onAttackListener=function(){},this.onShowListener=function(){},this.onHideListener=function(){},
this.onMouseOverListener=function(){},this.onMouseOutListener=function(){},this.load(),this.state=Gun.STATE_CREATE,this.showTime=void 0};Gun.prototype.onClick=function(){cleverapps.forces.isRunningForce()&&(cleverapps.eventLogger.logEvent(cleverapps.EVENTS.GUN_SHOT_FORCE),cleverapps.forces.closeRunningForce()),-1===[Gun.STATE_BOMBING,Gun.STATE_HIDDEN].indexOf(this.state)&&(!this.showTime||this.showTime<Date.now()-300)&&cleverapps.metha.display({focus:"GunExecute",control:this.getControls(),action:this.execute.bind(this)})},Gun.prototype.showForce=function(){cleverapps.metha.display({focus:"GunForce",control:this.getControls(),actions:[function(e){setTimeout(e,500)},function(e){this.onShowForceListener(),this.setAmount(1),cleverapps.forces.onceForceClosed=e}.bind(this)]})},Gun.prototype.getControls=function(){return["gun"]},Gun.prototype.showUp=function(){this.isAvailable()&&this.state!==Gun.STATE_SHOW_UP&&(this.onShowUpListener(),this.state=Gun.STATE_SHOW_UP)},
Gun.prototype.isForceAvailable=function(){return!(!Game.currentGame||this.state!==Gun.STATE_SHOW_UP)&&(!(Game.currentGame.tutorial&&!Game.currentGame.tutorial.finished)&&(Game.currentGame.outcome===GameBase.OUTCOME_UNKNOWN&&!cleverapps.forces.isShown(Forces.GUN.id)))},Gun.prototype.animate=function(e,t){this.onAnimateListener(e,t)},Gun.prototype.onMouseOver=function(){this.state!==Gun.STATE_HIDDEN&&this.onMouseOverListener()},Gun.prototype.onMouseOut=function(){this.state!==Gun.STATE_HIDDEN&&this.onMouseOutListener()},Gun.prototype.attack=function(){this.onAttackListener(),this.state=Gun.STATE_BOMBING},Gun.prototype.hide=function(){this.onHideListener()},Gun.prototype.show=function(){this.onShowListener(),this.showTime=Date.now()},Gun.prototype.resetState=function(){this.state=Gun.STATE_CREATE},Gun.prototype.execute=function(e){if(Game.currentGame&&("board"!==cleverapps.config.type||Game.currentGame.board))if(0<this.amount)this.onExecute(e);else{e();var t=this.getProduct(),
n=Game.currentGame;t.buy(cleverapps.once(function(){cleverapps.metha.displayWhenFreeFocus({focus:"GunExecute",control:this.getControls(),action:function(e){Game.currentGame===n&&void 0===Game.currentGame.outcome?this.onExecute(e):e()}.bind(this)})}.bind(this)),this.getControls())}else e()},Gun.prototype.onExecute=function(e){console.log("Override me!")},Gun.prototype.setAmount=function(e){e<0&&(e=0),this.amount=e},Gun.prototype.getAmount=function(){return this.amount?this.amount:0},Gun.prototype.addAmount=function(e){var t=this.getAmount();this.setAmount(t+e),this.save()},Gun.prototype.getProduct=function(){return Product.Create("gunShot")},Gun.prototype.getInfo=function(){return{amount:this.getAmount()}},Gun.prototype.updateInfo=function(e,t){this.amount=e.amount,this.save(t)},Gun.prototype.save=function(e){cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.GUN,this.getInfo()),e||cleverapps.synchronizer.addUpdateTask("gun")},Gun.prototype.load=function(){
var e=cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.GUN);this.amount=e&&e.amount?e.amount:0,this.amount<0&&(this.amount=0)},Gun.prototype.reset=function(){this.amount=0,this.save()},Gun.prototype.isAvailable=function(){return!cleverapps.flags.nopayments&&((!cleverapps.config.debugMode||!cleverapps.screenshotsMode)&&cleverapps.user.checkAvailable(Gun.AVAILABLE))},Gun.AVAILABLE={episode:1,level:8,spades:{disabled:!0}},Gun.STATE_SHOW_UP=0,Gun.STATE_BOMBING=1,Gun.STATE_WIN_ANIMATION=2,Gun.STATE_CREATE=3,Gun.STATE_HIDDEN=4;var GunView=cc.Node.extend({ctor:function(e,t){this._super(),this.gun=e,this.gameScene=t,e.onShowUpListener=this.createListener(this.showUp.bind(this)),e.onShowForceListener=this.createListener(this.showForce.bind(this)),e.onAnimateListener=this.createListener(this.animate.bind(this)),e.onAttackListener=this.createListener(this.attack.bind(this)),e.onHideListener=this.createListener(this.hide.bind(this)),e.onShowListener=this.createListener(this.show.bind(this))
;var n=cleverapps.styles.GunView,s=n.size[cleverapps.wideMode.mode]||n.size;this.setContentSize(s),this.setPositionRound(n.position),this.basePosition=this.getPosition(),this.setLocalZOrder(19),t.gunView=this,t.scene.addChild(this),n.useSceneDelta&&(this.y-=cleverapps.UI.getSceneOffsetY(),this.basePosition.y-=cleverapps.UI.getSceneOffsetY()),n.flyHintStartPos&&(this.flyHintStart=new cc.Node,this.flyHintStart.setPositionRound(n.flyHintStartPos),this.addChild(this.flyHintStart)),this.createView(),this.gun.resetState(),this.visible=!1,cleverapps.flags.introDisabled&&"match3"!==cleverapps.config.type&&(this.visible=!0)},createView:function(){var e=cleverapps.styles.GunView,t=e.scale[cleverapps.wideMode.mode];this.animation=new cleverapps.Spine(e.json,t),this.addChild(this.animation),e.animation.wideModePosition?this.animation.setPositionRound(e.animation.wideModePosition[cleverapps.wideMode.mode]):this.animation.setPositionRound(e.animation),
cleverapps.flags.introDisabled&&"match3"!==cleverapps.config.type&&this.animation.setAnimation(0,"idle",!0),this.price=new GunPriceView(this.gun,this),this.price.setPositionRound(e.price.position),this.addChild(this.price),cleverapps.UI.applyHover(this),cleverapps.UI.onClick(this,this.gun.onClick.bind(this.gun))},showUp:function(){this.amount&&this.amount.showUp(),this.price&&this.price.showUp();var e=cleverapps.styles.GunView.startAnimation;this.animation.setAnimation(0,e,!1),this.animation.setCompleteListener(function(){this.animation.setCompleteListener(function(){}),this.animation.setAnimation(0,"idle",!0)}.bind(this)),setTimeout(function(){cleverapps.audio.playSound(cleverapps.styles.GunView.showUpSound)},1e3*cleverapps.styles.GunView.showUp.delay),this.setVisible(!0)},attack:function(){cleverapps.audio.playSound(bundles.game.urls.game_start_effect||bundles.game.urls.gun_bombing_effect);var e=cleverapps.styles.GunView;this.amount&&this.amount.hide(),this.price&&this.price.hide()
;var t=e.actionAnimation;"board"!==cleverapps.config.type||cleverapps.wideMode.mode!==cleverapps.WideMode.VERTICAL||cleverapps.styles.GunView.disableMobileSpecialAnimation||(t=e.mobileActionAnimation);var n=void 0;cleverapps.styles.GunView.animation.actionPosition&&(n=this.animation.getPosition(),this.animation.setPositionRound(cleverapps.styles.GunView.animation.actionPosition)),this.animation.setAnimation(0,t,!1),this.animation.setCompleteListener(function(){n&&this.animation.setPositionRound(n),this.animation.setCompleteListener(function(){}),this.animation.setAnimation(0,"idle",!0),"scramble"===cleverapps.config.name&&(this.animation.setPositionRound(this.animation.x,this.animation.positionY-this.height),this.show()),this.amount&&this.amount.showUp(),this.price&&this.price.showUp()}.bind(this))},animate:function(e){console.log("Animating gun for: ",e)},showForce:function(){this.amount&&this.amount.setVisible(!1),this.price&&this.price.setVisible(!1),cleverapps.forces.create(this,
Forces.GUN)},hide:function(){this.amount&&this.amount.hide(),this.price&&this.price.hide(),this.setVisible(!1)},show:function(){this.gun.state!==Gun.STATE_BOMBING&&(this.amount&&this.amount.show(),this.price&&this.price.show()),this.visible=!0}});cleverapps.styles.GunView={showUpSound:bundles.game.urls.gun_show_up_effect,json:bundles.game.jsons.gun_animation_json,startAnimation:"start",actionAnimation:"bombing",mobileActionAnimation:"bombing_mobile",position:[{x:50,y:{align:"top",dy:-140}},{x:60,y:{align:"top",dy:-140}},{x:60,y:{align:"top",dy:-140}}],scale:[1,1,1],animation:{x:{align:"center",dx:-90},y:{align:"center",dy:-90}},amount:{position:[{x:118,y:76},{x:108,y:86},{x:108,y:86}]},price:{position:[{x:20,y:-16},{x:0,y:-16},{x:0,y:-16}]},size:{width:100,height:150},showUp:{delay:1},touchDy:6};var GunAmountView=cc.Node.extend({ctor:function(e){this._super(),this.setAnchorPoint(.5,.5),this.setCascadeOpacityEnabled(!0);var t=cleverapps.styles.GunAmountView;t.background&&(
t.background.scale9?(this.bg=new cc.Scale9Sprite(bundles.game.frames.booster_amount_bg_png),this.bg.setContentSize2(t.background.scale9)):(this.bg=new cc.Sprite(t.background.image),this.bg.setScale(t.background.scale)),this.addChild(this.bg)),this.amount=cleverapps.UI.generateImageText("",cleverapps.styles.FONTS.TEXT),this.addChild(this.amount),this.gun=e,this.updateAmount(),this.baseScale=t.scale||this.getScale(),this.setScale(this.baseScale),this.setVisible(!1)},updateAmount:function(e){return void 0===e&&(e=this.gun.getAmount()),e&&this.amount.setString(e),e},showUp:function(){this.updateAmount()&&(this.stopAllActions(),this.setScale(0),this.setVisible(!0),this.runAction(new cc.Sequence(new cc.DelayTime(cleverapps.styles.GunAmountView.delay),new cc.ScaleTo(.2,this.baseScale))))},executeAnimation:function(e){this.runAction(new cc.Sequence(new cc.ScaleTo(.25,this.baseScale+.25*this.baseScale),new cc.CallFunc(function(){this.updateAmount(this.gun.getAmount())}.bind(this)),
new cc.DelayTime(.25),new cc.ScaleTo(.25,0),new cc.CallFunc(function(){this.setVisible(!1),e()}.bind(this))))},hide:function(){this.isVisible()&&(this.stopAllActions(),this.runAction(new cc.Sequence(new cc.ScaleTo(.2,0),new cc.CallFunc(function(){this.setVisible(!1)}.bind(this)))))},show:function(){!this.isVisible()&&this.updateAmount()&&(this.stopAllActions(),this.runAction(new cc.Sequence(new cc.DelayTime(.3),new cc.ScaleTo(.2,this.baseScale),new cc.CallFunc(function(){this.setVisible(!0)}.bind(this)))))}});cleverapps.styles.GunAmountView={delay:1.5,scale:.6,background:{image:bundles.game.frames.gun_amount_bg_png,scale:2}};var GunHoverAnimation=function(e){var t=cleverapps.styles.GunView.hoverAnimation;this.animation=new cleverapps.Spine(t.json,1),this.animation.setPosition(e.width/2+t.offsetX,e.height/2+t.offsetY),e.addChild(this.animation,-1)};GunHoverAnimation.prototype.on=function(){this.isOn||(this.animation.visible=!0,this.isOn=!0,this.animation.setAnimation(0,"on",!1),
this.animation.addAnimation(0,"idle",!0),this.animation.setCompleteListener(function(){}))},GunHoverAnimation.prototype.off=function(){this.isOn&&!this.locked&&(this.isOn=!1,this.animation.setAnimation(0,"off",!1),this.animation.setCompleteListener(function(){this.animation.visible=!1}.bind(this)))},GunHoverAnimation.prototype.lock=function(){this.locked=!0},GunHoverAnimation.prototype.unlock=function(){this.locked=!1},GunHoverAnimation.prototype.forceOff=function(){this.unlock(),this.off()};var GunPriceView=cc.Node.extend({ctor:function(e,t){this._super(),this.gun=e;var n=cleverapps.styles.GunPriceView;this.baseScale=n.scale||this.getScale(),this.setScale(this.baseScale);var s={font:cleverapps.styles.FONTS.GUN_PRICE_TEXT,iconScale:n.icon.scale,offsetY:n.icon.offsetY};if(n.fitTo?s.fitTo=n.fitTo:s.fitTo={width:.9*t.width},this.price=new ProductPriceView(this.gun.getProduct(),s),this.price.setLocalZOrder(1),this.addChild(this.price),this.setContentSize2(this.price.getContentSize()),
n.background&&(this.bg=cleverapps.UI.createSprite({image:bundles.game.frames.gun_price_bg_png||bundles.buttons_main.frames.small_green_button,scale9:n.background.scale9,width:this.price.width+2*n.background.padding.x,height:Math.max(this.price.height+2*n.background.padding.y,n.background.minHeight)}),this.addChild(this.bg)),cleverapps.social instanceof cleverapps.OK&&n.label){var i=cleverapps.UI.generateTTFText(Messages.get("Take"),cleverapps.styles.FONTS.GUN_PRICE_BUY_TEXT||cleverapps.styles.FONTS.GUN_PRICE_TEXT);cleverapps.wideMode.mode===cleverapps.WideMode.VERTICAL&&n.label.mobileScale&&i.setScale(n.label.mobileScale),this.price.addChild(i);var o=n.label.offset.y;Array.isArray(o)&&(o=o[cleverapps.wideMode.mode]*resolutionScale),i.setPositionRound(this.width/2,this.height/2+o)}this.bg&&(this.setContentSize2(this.bg.getContentSize()),this.bg.setPositionRound(this.width/2,this.height/2)),this.price.setPositionRound(n.position),this.setAnchorPoint2(),this.setCascadeOpacityEnabled(!0),
this.setVisible(!1),n.hover&&cleverapps.UI.applyHover(this),"wordheaps"!==cleverapps.config.name&&cleverapps.UI.onClick(this,e.onClick.bind(e))},getProduct:function(){return this.gun.getProduct()},updatePriceString:function(){this.price.setString(this.getProduct())},showUp:function(){if(!this.gun.getAmount()){var e=cleverapps.styles.GunPriceView;this.setScale(0),this.opacity=255,this.setVisible(!0),this.price.setString(this.getProduct()),this.stopAllActions(),this.runAction(new cc.Sequence(new cc.DelayTime(e.showUp.delay),new cc.ScaleTo(.2,this.baseScale)))}},hide:function(){this.isVisible()&&(this.stopAllActions(),this.inHide=!0,this.runAction(new cc.Sequence(new cc.FadeOut(.3),new cc.CallFunc(function(){this.inHide=!1,this.opacity=255,this.setVisible(!1)}.bind(this)))))},show:function(){this.gun.getAmount()||(this.inHide&&(this.stopAllActions(),this.opacity=255,this.scale=this.baseScale,this.visible=!0),this.isVisible()||(this.stopAllActions(),this.opacity=0,this.scale=this.baseScale
,this.visible=!0,this.runAction(new cc.Sequence(new cc.DelayTime(.3),new cc.FadeIn(.3)))))}});cleverapps.styles.GunPriceView={showUp:{delay:1.5},scale:.6,background:{padding:{x:32,y:4},minHeight:70,scale9:cleverapps.UI.Scale9Rect.TwoPixelXY},icon:{scale:.8},amount:{scale:1},position:{x:{align:"center"},y:{align:"center"}}};var TournamentPlayerView=cc.Node.extend({ctor:function(e,t){this._super(),this.player=e,this.competition=t,this.game=Game.currentGame;var n=cleverapps.styles.TournamentPlayerView;this.setContentSize2(n.width,n.height),this.setAnchorPoint2(.5,.5),this.setScale(n.scale[cleverapps.wideMode.mode]),this.baseScale=this.scale,this.colorNode=new cc.Node,this.colorNode.setContentSize2(this.getContentSize()),this.colorNode.setAnchorPoint2(.5,.5),this.colorNode.setCascadeColorEnabled(!0),this.colorNode.setPositionRound(this.width/2,this.height/2),this.addChild(this.colorNode),this.createBackground();var s=this.avatar=new cleverapps.UI.Avatar(e.avatar);s.setCascadeColorEnabled(
!1),this.colorNode.addChild(s),s.setScale(n.avatar.scale),s.setLocalZOrder(-1),s.setPositionRound(n.avatar.x,n.avatar.y),this.createName(),this.addAmount(),this.processPlaceAnimation(),this.prevAmount=this.player.amount,this.setCascadeColorEnabled(!0),cleverapps.config.debugMode&&cleverapps.UI.onClick(this,function(){Game.currentGame&&Game.currentGame.discoverDebug(this.player)}.bind(this)),this.competition.onChangeResultsListeners["player_"+this.player.id]=this.createListener(this.onChangeResults.bind(this)),this.player.id===cleverapps.user.id&&(this.competition.onChangeResultsListeners.processPlaceAnimation=this.createListener(this.processPlaceAnimation.bind(this)))},createName:function(){var e=cleverapps.styles.TournamentPlayerView,t=this.player.name;t||(cleverapps.throwAsync("No player name "+JSON.stringify(this.player)),t="Player_"+this.player.id.substr(-3)),0<t.indexOf(" ")&&(t=t.substring(0,t.indexOf(" ")));var n=cleverapps.UI.createSprite(e.name.bg);this.colorNode.addChild(n),
n.setPositionRound(e.name.bg),e.name.bg.playerColor&&this.player.self&&n.setColor(e.name.bg.playerColor),this.name=cleverapps.UI.generateTTFText(t,cleverapps.styles.FONTS.PLAYER_NAME_TEXT),this.name.fitTo(n.width-2*e.name.padding.x),n.addChild(this.name),this.name.setPositionRound(e.name)},addAmount:function(){var e=cleverapps.styles.TournamentPlayerView.amount,t=new cc.Sprite(this.player.id===cleverapps.user.id?bundles.game.frames.tournament_mark_1_png:bundles.game.frames.tournament_mark_0_png);t.setPosition(t.width/2,t.height/2);var n=this.score=new cc.Node;n.setAnchorPoint2(),n.setContentSize2(t.getContentSize()),n.addChild(t),n.setCascadeColorEnabled(!0);var s=this.amountText=cleverapps.UI.generateTTFText(this.player.amount+"",this.player.id===cleverapps.user.id?cleverapps.styles.FONTS.PLAYER_SCORE:cleverapps.styles.FONTS.BOT_SCORE);n.addChild(s),s.setPositionRound(e.text),this.colorNode.addChild(n),n.setPositionRound(e)},createBackground:function(){var e,
t=cleverapps.styles.TournamentPlayerView.background;t&&(!1===t.scale9?((e=new cc.Sprite(t.image)).setScaleX(this.width/e.width),e.setScaleY(this.height/e.height)):(e=cleverapps.UI.createScale9Sprite(t.image,t.scale9)).setContentSize2(this.width,this.height),e.setPosition(this.width/2,this.height/2),this.colorNode.addChild(e),e.setLocalZOrder(-1),this.player.self?e.setColor(cleverapps.styles.COLORS.PLAYER_BG_COLOR):e.setColor(cleverapps.styles.COLORS.COMPETITOR_BG_COLOR||cleverapps.styles.COLORS.WHITE))},onChangeResults:function(e){e===this.player.id&&(this.score.runAction(new cc.Sequence(new cc.Spawn(new cc.ScaleTo(.4,1.4).easing(cc.easeOut(3)),new cc.Sequence(new cc.RotateTo(.15,15),new cc.RotateTo(.15,-15),new cc.RotateTo(.1,0))),new cc.ScaleTo(.15,1))),this.amountText.setString(this.player.amount+""))},processPlaceAnimation:function(e){if(this.player.id===cleverapps.user.id&&!(this.competition.calcPlace()<3||this.competition.getFinishedOpponents(
).length===this.competition.results.length-1||this.placeAnimationProcessing)){var t=cleverapps.styles.COLORS.PLAYER_ALARM_COLOR,n=cleverapps.styles.COLORS.WHITE;this.placeAnimationProcessing=!0,this.colorNode.runAction(new cc.Sequence(new cc.TintTo(.5,t.r,t.g,t.b),new cc.TintTo(.5,n.r,n.g,n.b),new cc.CallFunc(function(){this.placeAnimationProcessing=!1,this.processPlaceAnimation()}.bind(this)))),this.framePulsation||(this.framePulsation=new cc.Sprite(bundles.game.frames.avatar_frame_red_png),this.avatar.addChild(this.framePulsation),this.framePulsation.setPositionRound(this.avatar.width/2,this.avatar.height/2),this.framePulsation.setLocalZOrder(-1),this.framePulsation.setColor(cc.color.RED),this.framePulsation.setContentSize2(this.avatar.width,this.avatar.height)),this.framePulsation.runAction(new cc.Sequence(new cc.ScaleTo(.5,1.2),new cc.ScaleTo(.5,1)))}},animateReorder:function(e){if(!(Math.abs(this.y-e.y)<1&&this.player.amount===this.prevAmount)||this.reorderAnimationRunning){
var t=e.y>this.y||this.player.amount>this.prevAmount;this.prevAmount=this.player.amount,this.reorderAnimationRunning=!0,this.stopAllActions(),this.runAction(new cc.Sequence(new cc.Spawn(new cc.ScaleTo(.2,this.baseScale*(t?1.2:.9)),new cc.MoveTo(.35,e).easing(cc.easeIn(1)),new cc.Sequence(new cc.CallFunc(function(){this.rotation=0}.bind(this)),new cc.DelayTime(.08),new cc.RotateBy(.108,e.y>this.y?20:0).easing(cc.easeInOut(.5)),new cc.RotateBy(.135,e.y>this.y?-30:0),new cc.RotateBy(.027,e.y>this.y?10:0)),new cc.Sequence(new cc.DelayTime(.3),new cc.ScaleTo(.2,this.baseScale))),new cc.CallFunc(function(){this.reorderAnimationRunning=!1}.bind(this))))}},animateResult:function(e){var t=cleverapps.styles.TournamentPlayerView;cleverapps.UI.animateDelta(e,{parent:this,font:cleverapps.styles.FONTS.PLAYER_VIEW_DELTA_TEXT,x:this.width/2+t.delta.x,y:this.height/2+t.delta.y})}});cleverapps.overrideFonts(cleverapps.styles.FONTS,{PLAYER_SCORE:{size:25,color:cleverapps.styles.COLORS.BLACK},BOT_SCORE:{
size:25,color:cleverapps.styles.COLORS.BLACK},PLAYER_VIEW_DELTA_TEXT:{size:25,color:cleverapps.styles.COLORS.BLACK}}),cleverapps.styles.TournamentPlayerView={background:{image:bundles.game.frames.tournament_bg_png,scale9:cleverapps.UI.Scale9Rect.TwoPixelXY},width:145,height:140,scale:[1,1,1],avatar:{x:{align:"center"},y:{align:"center",dy:10},scale:1},amount:{x:{align:"right"},y:{align:"bottom"},text:{x:{align:"center"},y:{align:"center"}}},name:{x:{align:"center"},y:{align:"center"},padding:{x:17},bg:{image:bundles.menubar.frames.menubar_bg_png,width:100,height:40,x:{align:"center"},y:{align:"bottom"}}},delta:{x:55,y:0}};var TournamentPlayersView=cc.Node.extend({ctor:function(t){this._super(),this.competition=t,this.players=t.results,this.competition.calcPlace(),this.views=this.players.map(function(e){return new TournamentPlayerView(e,t)}.bind(this));var e=cleverapps.styles.TournamentPlayersView,n=new cleverapps.Layout(this.views,{direction:cleverapps.UI.VERTICAL,margin:e.margin})
;this.setContentSize2(n.width,n.height),this.addChild(n),n.setPositionRound(this.width/2+e.content.offset.x,this.height/2+e.content.offset.y),this.setPositionRound(e.x,e.y[cleverapps.wideMode.mode],cleverapps.UI.getSceneSize()),this.positions={},this.views.forEach(function(e,t){this.positions[t]=e.getPosition()}.bind(this)),this.createBg(),this.setLocalZOrder(1),t.onChangeResultsListeners.tournamentPlayers=cleverapps.whenShow(this.createListener(cleverapps.timeredThrottle(10,this.onChangeResults.bind(this)))),this.onChangeResults(),Game.currentGame.afterOnChangeOutcomeListeners.tournamentPlayerViews=this.createListener(this.afterOnChangeOutcome.bind(this)),this.setVisible(!1),cleverapps.UI.makeHideable(this,cleverapps.UI.HORIZONTAL),cleverapps.metha.registerControl("tournamentPlayersView",this)},afterOnChangeOutcome:function(){var e=-cleverapps.UI.getSceneSize().width/2*.025;this.runAction(new cc.MoveBy(1,e,0).easing(cc.easeInOut(1.5)))},createBg:function(){
var e=cleverapps.styles.TournamentPlayersView.bg;if(e){var t=new cc.Scale9Sprite(e.image);this.addChild(t),t.setLocalZOrder(-1);var n=1.3*(this.width+e.padding.x),s=this.height+2*e.padding.y;e.rotate90?(t.setContentSize2(s,n),t.setRotation(90)):t.setContentSize2(n,s),t.setPositionRound(this.width+e.padding.x-n/2,this.height/2)}},onChangeResults:function(e){this.competition.calcPlace(),this.views.sort(function(e,t){var n=this.competition.results.indexOf(e.player);return this.competition.results.indexOf(t.player)-n}.bind(this)),this.views.forEach(function(e,t){e.setLocalZOrder(t+1),e.animateReorder(this.positions[t])}.bind(this))},animateResults:function(t){this.views.forEach(function(e){e.player.player&&e.animateResult(t)})}});cleverapps.styles.TournamentPlayersView={align:"left",x:130,y:[620,620,620],margin:10,bg:{image:bundles.game.frames.tournament_bg_png,padding:{x:15,y:20}},content:{offset:{x:0,y:0}}};var ExpInfoWindow=Window.extend({onWindowLoaded:function(){
var e=cleverapps.styles.ExpInfoWindow,t=this.generateContent();this._super({title:"messages:ExpInfoWindow.Title",name:"expinfowindow",content:t}),t.y-=e.topBottom,Lottery.addText(this)},generateProductOption:function(e,t){var n=cleverapps.styles.ExpInfoWindow,s=Product.Create(e),i=cleverapps.UI.generateTTFText(s.reward.exp,cleverapps.styles.FONTS.BUTTON_TEXT),o=new cc.Sprite(bundles.reward_icons.frames.reward_exp_png);o.setScale(n.button.amountIcon.scale);var r=new cleverapps.Layout([i,o],{direction:cleverapps.UI.HORIZONTAL,margin:n.button.amountMargin}),a=new cleverapps.UI.Button({content:r,onClicked:function(){s.buy(function(){this.close()}.bind(this))}.bind(this),width:n.button.width,height:n.button.height});Lottery.addIcon(a);var c=new ProductPriceView(s,{font:cleverapps.styles.FONTS.ADDMOVES_PRICE}),l=new cc.Sprite(t);return new cleverapps.Layout([a,c,l],{direction:cleverapps.UI.VERTICAL,margin:n.button.itemsMargin})},generateContent:function(){
var e=cleverapps.styles.ExpInfoWindow,t=cleverapps.UI.generateTTFText("messages:ExpInfoWindow.Message",cleverapps.styles.FONTS.WINDOW_SMALL_TEXT);t.setDimensions(e.width,0),t.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER);var n=cleverapps.UI.generateTTFText("messages:ExpInfoWindow.BuyMessage",cleverapps.styles.FONTS.WINDOW_SMALL_TEXT);n.setDimensions(e.width,0),n.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER);var s=new cleverapps.Layout([this.generateProductOption("buyExp10",bundles.exp_window.frames.small_exp_box),this.generateProductOption("buyExp150",bundles.exp_window.frames.exp_box)],{direction:cleverapps.UI.HORIZONTAL,margin:e.buttonsMargin,align:cleverapps.UI.ALIGN_START});return new cleverapps.Layout([s,n,t],{direction:cleverapps.UI.VERTICAL,margin:e.margin})},listBundles:function(){return["exp_window"]}});cleverapps.styles.ExpInfoWindow={width:600,margin:30,buttonsMargin:50,topBottom:70,exp:{width:400,height:200},button:{amountMargin:10,itemsMargin:3,width:300,height:100,
amountIcon:{scale:.7}}};var Chat=function(){this.messages=[],cleverapps.EventEmitter.call(this),this.editingMode=!1,this.closing=!1,this.hasUnread=!1,this.loadSave(),setInterval(this.reload.bind(this),cleverapps.parseInterval(Chat.RELOAD_INTERVAL))};Chat.prototype=Object.create(cleverapps.EventEmitter.prototype),(Chat.prototype.constructor=Chat).IsAvailable=function(){if(cleverapps.chat.hasUnread)return!0;if(-1!==["mbga","sp_mbga"].indexOf(cleverapps.User.calcSource()))return!1;if(0<cleverapps.paymentsHistory.classify())return!0;var e={};if("merge"===cleverapps.config.type){if(Game.currentGame&&Game.currentGame.gameLevel.getLevel()<9)return!1}else e.episode=1,e.level=0;return e.registered="3 days",levels.user.checkAvailable(e)},Chat.prototype.loadSave=function(){var e=cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.CHAT)||{};this.processed=e.processed||{}},Chat.prototype.storeSave=function(){cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.CHAT,{processed:this.processed})},
Chat.prototype.load=function(s,e){cleverapps.RestClient.get("/chat/messages/"+cleverapps.user.id,{},function(e){var t=e.map(ChatMessage.fromData);this.messages=[];var n=void 0;this.hasUnread=!1,t.forEach(function(e){var t=new Date(e.postDate).toLocaleDateString(cleverapps.settings.language,{year:"numeric",month:"long",day:"numeric"});t!==n&&(n=t,this.messages.push(ChatMessage.createServiceMessage(t))),(1===e.isResponse&&0===e.readByUser||e.hasGift()&&!e.isGiftTaken()&&e.isApplicable())&&(this.hasUnread=!0),e.hasGift()&&this.processed[e.id]&&(e.isGiftTaken()?(delete this.processed[e.id],this.storeSave()):cleverapps.RestClient.post("/chat/acceptGift",{id:e.id})),this.messages.push(e)}.bind(this)),0===this.messages.length&&this.messages.push(ChatMessage.createServiceMessage("messages:ChatGreetingMessage")),this.closing||(this.trigger("removeTemporaryMessages"),this.trigger("messagesUpdated")),s&&s()}.bind(this),e||this.printConnectionError.bind(this))},Chat.prototype.postMessage=function(
t){var n=ChatMessage.createTemporaryMessage(t);this.messages.push(n),this.trigger("messagesUpdated");var e=cleverapps.friends.getPlayer().name;e===Messages.get("Friends.You")&&(e=Messages.get("LeadersWindow.player")),cleverapps.RestClient.post("/chat/message",{message:t,userid:cleverapps.user.id,isresponse:0,payerlevel:cleverapps.paymentsHistory.classify(),name:e,language:cleverapps.settings.language,source:cleverapps.user.source},function(){this.load()}.bind(this),function(){var e=this.messages.indexOf(n);-1!==e&&this.messages.splice(e,1),this.trigger("removeTemporaryMessages"),this.trigger("returnMessageBack",t),this.printConnectionError()}.bind(this))},Chat.prototype.markAsRead=function(){cleverapps.RestClient.post("/chat/markAsRead",{userid:cleverapps.user.id},this.reload.bind(this))},Chat.prototype.acceptGift=function(e,t){if(this.processed[e.id])this.reload();else{if(t){if(e.progress)levels.user.level=parseInt(e.progress.level),levels.user.episode=parseInt(e.progress.episode),
levels.user.save(),levels.episodes.reset(),levels.episodes.setCurrentEpisode(levels.user.episode);else if(e.presents)cleverapps.Chest.prototype._receiveReward(e.presents,!0);else if(e.metha)if(e.metha.simple)cleverapps.simple.current=e.metha.simple.current,cleverapps.simple.stars=0,cleverapps.simple.save();else if(e.metha.farm){Farm.Reset();var n=Farm.GetBuildingProgress(e.metha.farm.building,e.metha.farm.quest);cleverapps.farm.load(n),cleverapps.farm.save()}else e.metha.home&&(cleverapps.home.load(Home.GetFurnitureProgress(e.metha.home.furniture,e.metha.home.stage)),cleverapps.home.save());cleverapps.audio.playSound(bundles.main.urls.shop_buy_effect)}this.processed[e.id]=!0,this.storeSave(),cleverapps.RestClient.post("/chat/acceptGift",{id:e.id},this.reload.bind(this))}},Chat.prototype.printConnectionError=function(){this.messages.push(ChatMessage.createServiceMessage(Messages.get("RestartWindow.AnErrorOccured"),"error_"+(new Date).toLocaleTimeString())),this.trigger("messagesUpdated"
)},Chat.prototype.reload=function(){Chat.IsAvailable()&&(cleverapps.environment.isChatScene()||cleverapps.environment.isMainScene())&&this.load()},Chat.RELOAD_INTERVAL="1 minute";var ChatMessage=function(){};ChatMessage.fromData=function(e){var t=new ChatMessage;return t.id=e.id,t.userId=e.userId,t.postDate=e.postDate,t.message=e.message,t.isResponse=e.isResponse,t.readByUser=e.readByUser,t.tag=e.tag,t.type=ChatMessage.MESSAGE_TYPE.CHAT,t},ChatMessage.createServiceMessage=function(e,t){var n=new ChatMessage;return n.id=t||"service_"+e,n.message=e,n.type=ChatMessage.MESSAGE_TYPE.SERVICE,n},ChatMessage.createTemporaryMessage=function(e){var t=new ChatMessage;return t.id="tmp_"+e,t.message=e,t.type=ChatMessage.MESSAGE_TYPE.TEMPORARY,t.postDate=(new Date).toString(),t},ChatMessage.prototype.hasGift=function(){return"gift"===this.tag||"takengift"===this.tag},ChatMessage.prototype.isGiftTaken=function(){return"takengift"===this.tag},ChatMessage.prototype.isApplicable=function(){if(
this.parseGift(),this.metha)if(this.metha.farm){var e=parseInt(this.metha.farm.building),t=cleverapps.farm.buildings[e],n=parseInt(this.metha.farm.quest);if(!t||n>=t.quests.length)return!1}else if(this.metha.simple)return parseInt(this.metha.simple.current)<cleverapps.simple.bgsAmount;return!0},ChatMessage.prototype.parseGift=function(){if(!this.parsed){this.parsed=!0;var e=JSON.parse(this.message);if(e.presents){var s=this.presents={};e.presents.forEach(function(e){if("object"==typeof e&&e.hasOwnProperty("type")&&e.hasOwnProperty("amount")){var t=e.type;if(-1!==["gold","unlimitedLives","stars","exp","gun","wardrobe","lives","coins","wands","worker"].indexOf(t)||0===t.indexOf("booster")||0===t.indexOf("hl")){var n=e.amount;0===t.indexOf("booster")?(void 0===s.boosters&&(s.boosters=[]),s.boosters[parseInt(t.replace("booster",""))]=n):"unlimitedLives"===t?s.unlimitedLives={interval:n+" hour",amount:n,title:"messages:AMOUNT_HOURS"}:"worker"===t?s.worker={interval:n+" hour",amount:n,
title:"messages:AMOUNT_HOURS"}:-1!==t.indexOf("hl")?(s.herolevels||(s.herolevels=[]),s.herolevels.push([t.replace("hl",""),e.amount])):s[t]=n}}})}else e.progress?this.progress=e.progress:e.metha&&(this.metha=e.metha)}},ChatMessage.MESSAGE_TYPE={CHAT:0,SERVICE:1,TEMPORARY:2};var ChatHeader=cc.Scale9Sprite.extend({ctor:function(e){this._super(bundles.chat.frames.panelup),this.setAnchorPoint2(0,1);var t=cleverapps.styles.ChatHeader,n=cleverapps.UI.generateOnlyText(Messages.get("messages:ChatTitle"),cleverapps.styles.FONTS.CHAT_HEADER_TEXT);e.closing=!1;var s=this.backButton=new cleverapps.UI.Button({noBg:!0,content:new cc.Sprite(bundles.chat.frames.icon_back),onClicked:function(){e.closing=!0,setTimeout(function(){cc.director.getRunningScene().closeAction()}.bind(this),cc.sys.isMobile&&e.editingMode?500:100)}.bind(this),width:t.back.width,height:t.back.height,useInteractiveScale:!0});s.setPosition(0,t.back.offsetY),this.content=new cleverapps.Layout([s,n],{
direction:cleverapps.UI.HORIZONTAL,margin:t.back.margin}),this.addChild(this.content),cleverapps.eventBus.on("changeSceneSize",this.onChangeSize.bind(this),this),this.onChangeSize()},onChangeSize:function(){var e=cleverapps.styles.ChatHeader;this.setContentSize2(cc.director.getWinSize().width,e.height),this.setPosition(0,cc.director.getWinSize().height),this.content.setPositionRound(this.width/2+e.content.offsetX,this.height/2),cleverapps.UI.fitToBox(this.content,{width:.8*cc.director.getWinSize().width,height:e.height}),this.backButton.setScale(1/this.content.scale)}});cleverapps.styles.ChatHeader={height:130,content:{offsetX:-50},back:{width:120,height:120,margin:25,offsetY:5}},cleverapps.overrideFonts(cleverapps.styles.FONTS,{CHAT_HEADER_TEXT:{size:50,color:cleverapps.styles.COLORS.BLACK}});var ChatInput=cc.Scale9Sprite.extend({ctor:function(e){this._super(bundles.chat.frames.paneldown);var t=cleverapps.styles.ChatInput;this.chat=e,
this.isVertical="horizontal"!==cleverapps.config.orientation,this.inputHeight=this.isVertical?t.verticalHeight:t.height,this.setAnchorPoint2(0,0);var n=this.sendButton=new cleverapps.UI.Button({noBg:!0,content:new cc.Sprite(bundles.chat.frames.panel_on),contentOff:new cc.Sprite(bundles.chat.frames.panel_off),onClicked:this.send.bind(this),width:t.sendButton.width,height:this.inputHeight,fitTo:!1,useInteractiveScale:!0});n.disable(),this.addChild(n),this.charsCountText=cleverapps.UI.generateOnlyText("0/500",cleverapps.styles.FONTS.CHAT_CHARS_COUNT_TEXT),this.charsCountText.setVisible(!1),this.charsCountText.setDimensions(t.charsCount.width,0),this.charsCountText.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER),this.addChild(this.charsCountText);var s=this.textAreaBg=cleverapps.UI.createScale9Sprite(bundles.chat.frames.textbox);this.addChild(s);var i=this.text=new cc.EditBox(cc.size(s.width-t.textPadding.x,s.height-t.textPadding.y));i.setDelegate(this),i.stayOnTop(!0),i.setTouchEnabled()
,i.setMaxLength(500),i.setFontColor(cleverapps.styles.FONTS.CHAT_INPUT_FIELD_TEXT.color),this.textAreaBg.addChild(this.text),this.onChangeSize(),cleverapps.eventBus.on("changeSceneSize",this.onChangeSize.bind(this),this),this.chat.on("returnMessageBack",this.returnMessageBack.bind(this))},onChangeSize:function(){var e=cleverapps.styles.ChatInput;this.setContentSize2(cc.director.getWinSize().width,this.inputHeight+e.padding),this.setPosition(0,0),this.textAreaBg.setContentSize(this.width-(this.isVertical?e.textArea.vertical.rightMargin:e.textArea.rightMargin),this.inputHeight),this.textAreaBg.setPositionRound(this.isVertical?e.textArea.vertical:e.textArea),this.sendButton.setContentSize(e.sendButton.width,this.inputHeight),this.sendButton.setPositionRound(this.isVertical?e.sendButton.vertical:e.sendButton),this.text.setContentSize(this.textAreaBg.width-e.textPadding.x,this.textAreaBg.height-e.textPadding.y),this.text.setPositionRound(this.textAreaBg.width/2,this.textAreaBg.height/2),
this.charsCountText.setPositionRound(this.isVertical?e.charsCount.vertical:e.charsCount)},send:function(){var e=this.getMessageText();0<e.length&&(this.text.setString(""),this.sendButton.disable(),this.charsCountText.setVisible(!1),this.chat.postMessage(e))},returnMessageBack:function(e){this.text.setString(e),this.editBoxTextChanged(this.text,e)},editBoxTextChanged:function(e,t){0<this.getMessageText(t).length?this.sendButton.enable():this.sendButton.disable(),this.text.setFont("Rubik",cleverapps.styles.FONTS.CHAT_INPUT_FIELD_TEXT.size),400<=this.text.getString().length?(this.charsCountText.setVisible(!0),this.charsCountText.setString(this.text.getString().length+"/500"),this.charsCountText.setFont(450<=this.text.getString().length?cleverapps.styles.FONTS.CHAT_CHARS_COUNT_RED_TEXT:cleverapps.styles.FONTS.CHAT_CHARS_COUNT_TEXT)):this.charsCountText.setVisible(!1)},editBoxReturn:function(){setTimeout(this.send.bind(this),0)},getMessageText:function(e){return(e=e||this.text.getString()
).trim().replace(/(?:\r\n|\r|\n)/g,"").replace(/([\u2700-\u27BF]|[\uE000-\uF8FF]|\uD83C[\uDC00-\uDFFF]|\uD83D[\uDC00-\uDFFF]|[\u2011-\u26FF]|\uD83E[\uDD10-\uDDFF])/g,"")},editBoxEditingDidBegin:function(){this.chat.editingMode=!0},editBoxEditingDidEnd:function(){this.chat.editingMode=!1}});cleverapps.overrideFonts(cleverapps.styles.FONTS,{CHAT_INPUT_FIELD_TEXT:{size:40,color:cleverapps.styles.COLORS.BLACK,font:bundles.chat.urls.strict_font_ttf},CHAT_CHARS_COUNT_TEXT:{size:22,color:cleverapps.styles.COLORS.COLOR_VERY_DARK_GRAY,font:bundles.chat.urls.strict_font_ttf},CHAT_CHARS_COUNT_RED_TEXT:{size:22,color:new cc.Color(243,60,60,255),font:bundles.chat.urls.strict_font_ttf}}),cleverapps.styles.ChatInput={height:150,verticalHeight:200,padding:22,sendButton:{x:{align:"right",dx:-35},y:{align:"center"},vertical:{x:{align:"right"},y:{align:"center"}},width:110},charsCount:{x:{align:"right",dx:-40},y:{align:"bottom",dy:10},vertical:{x:{align:"right",dx:-6},y:{align:"bottom",dy:25}},width:100
},textArea:{rightMargin:230,x:{align:"left",dx:50},y:{align:"center",dy:-6},vertical:{rightMargin:130,x:{align:"left",dx:20},y:{align:"center",dy:-6}}},textPadding:{x:40,y:12}};var ChatMessageView=cc.Node.extend({ctor:function(e){this._super(),this.chatMessage=e,this.setAnchorPoint2(0,.5);var t=new Date(e.postDate).toLocaleTimeString(cleverapps.settings.language,{hour12:!1,hour:"2-digit",minute:"2-digit"}),n=this.messageTimeText=cleverapps.UI.generateOnlyText(t,cleverapps.styles.FONTS.CHAT_MESSAGE_TIME_TEXT);n.setHorizontalAlignment(cc.TEXT_ALIGNMENT_RIGHT);var s=this.bg=cleverapps.UI.createScale9Sprite(this.chatMessage.isResponse?bundles.chat.frames.dialog_box_white:bundles.chat.frames.dialog_box_green);this.addChild(s,-1),this.content=this.createContent(this.chatMessage),s.addChild(this.content),s.addChild(n),this.chatMessage.isResponse||(this.chatMessage.readByUser?this.mark=new cc.Sprite(bundles.chat.frames.checkmark_read
):this.chatMessage.type===ChatMessage.MESSAGE_TYPE.TEMPORARY?this.mark=new cc.Sprite(bundles.chat.frames.checkmark_tmp):this.mark=new cc.Sprite(bundles.chat.frames.checkmark_sent),s.addChild(this.mark)),this.onChangeSize()},createContent:function(e){return e.hasGift()?new GiftContentView(e):(this.messageText=cleverapps.UI.generateOnlyText(e.message,cleverapps.styles.FONTS.CHAT_MESSAGE_TEXT),this.messageText.setHorizontalAlignment(cc.TEXT_ALIGNMENT_LEFT),this.messageText)},updateContent:function(e){this.content&&this.content.removeFromParent(),this.content=this.createContent(e),this.bg.addChild(this.content),this.onChangeSize()},onChangeSize:function(){var e=cleverapps.styles.ChatMessageView,t=.7*cc.director.getWinSize().width;t>e.maxWidth?t=e.maxWidth:t<e.minWidth&&(t=e.minWidth),this.messageText?(this.messageText.setDimensions(t,0),this.setContentSize2(cc.director.getWinSize().width,this.messageText._getHeight()+2*e.text.padding)):this.setContentSize2(cc.director.getWinSize().width,
this.content.height+2*e.text.padding),this.bg.setContentSize(t+2*e.text.padding,this.height),this.chatMessage.isResponse?(this.bg.setAnchorPoint2(0,.5),this.bg.setPosition("horizontal"!==cleverapps.config.orientation?e.responseBg.verticalOffsetX:e.responseBg.offsetX,this.height/2)):this.bg.setPositionRound(e.questionBg),this.content.setPositionRound(this.bg.width/2+(this.chatMessage.isResponse?e.text.responceOffsetX:0),this.bg.height/2+e.text.offsetY),this.messageTimeText.setDimensions(e.time.width,e.time.height),this.messageTimeText.setPositionRound(this.chatMessage.isResponse?e.time.response:e.time.question),this.mark&&this.mark.setPositionRound(e.mark)}});cleverapps.styles.ChatMessageView={minWidth:500,maxWidth:900,text:{padding:30,responceOffsetX:5,offsetY:2},time:{width:200,height:24,response:{x:{align:"right",dx:-34},y:{align:"bottom",dy:14}},question:{x:{align:"right",dx:-56},y:{align:"bottom",dy:14}}},mark:{x:{align:"right",dx:-22},y:{align:"bottom",dy:18}},responseBg:{
offsetX:32,verticalOffsetX:4},questionBg:{x:{align:"right",dx:-30},y:{align:"center"}}},cleverapps.overrideFonts(cleverapps.styles.FONTS,{CHAT_MESSAGE_TEXT:{size:40,color:cleverapps.styles.COLORS.BLACK,font:bundles.chat.urls.strict_font_ttf},CHAT_MESSAGE_TIME_TEXT:{size:26,color:new cc.Color(138,138,138,255),font:bundles.chat.urls.strict_font_ttf}});var ServiceMessageView=cc.Node.extend({ctor:function(e){this._super(),this.chatMessage=e,this.setAnchorPoint2(0,.5),this.messageText=cleverapps.UI.generateOnlyText(e.message,cleverapps.styles.FONTS.SERVICE_MESSAGE_TEXT),this.messageText.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER),this.addChild(this.messageText),this.onChangeSize()},onChangeSize:function(){this.messageText.setDimensions(cc.director.getWinSize().width-cleverapps.styles.ServiceMessageView.padding,0),this.setContentSize2(cc.director.getWinSize().width,this.messageText._getHeight()+cleverapps.styles.ServiceMessageView.padding),this.messageText.setPositionRound(this.width/2,
this.height/2)}});cleverapps.styles.ServiceMessageView={padding:20},cleverapps.overrideFonts(cleverapps.styles.FONTS,{SERVICE_MESSAGE_TEXT:{size:30,color:new cc.Color(83,97,106,255),font:bundles.chat.urls.strict_font_ttf}});var GiftContentView=cleverapps.Layout.extend({ctor:function(e){this.chatMessage=e;var t=cleverapps.styles.GiftContentView;this.chatMessage.parseGift();var n=Math.min(.6*cc.director.getWinSize().width,t.width),s=[],i=cleverapps.UI.createScale9Sprite(bundles.chat.frames.gift_bg),o=new cc.Sprite(bundles.chat.frames.checkmark_gift),r=this.chatMessage.isGiftTaken()?o.height:0;if(this.chatMessage.progress||this.chatMessage.metha){if(this.chatMessage.metha){if(this.chatMessage.metha.simple){var a=parseInt(this.chatMessage.metha.simple.current);_=a<cleverapps.simple.bgsAmount?cleverapps.UI.generateOnlyText("messages:AdminSetMethaProgress.Text",cleverapps.styles.FONTS.CHAT_MESSAGE_TEXT,{bgIndex:a}):cleverapps.UI.generateOnlyText(
"messages:AdminSetMethaProgress.Text.Unavailable",cleverapps.styles.FONTS.CHAT_MESSAGE_TEXT)}else if(this.chatMessage.metha.farm){var c=parseInt(this.chatMessage.metha.farm.building),l=cleverapps.farm.buildings[c],p=parseInt(this.chatMessage.metha.farm.quest);if(l&&p<l.quests.length){var d=Messages.get("building."+cleverapps.farm.buildings[c].name),u=Messages.get(0<p?"messages:AdminSetFarmProgress.Text.Quest":"messages:AdminSetFarmProgress.Text",{buildingName:d,questName:Messages.get(l.quests[p].title)});_=cleverapps.UI.generateOnlyText(u,cleverapps.styles.FONTS.CHAT_MESSAGE_TEXT)}else _=cleverapps.UI.generateOnlyText("messages:AdminSetFarmProgress.Text.Unavailable",cleverapps.styles.FONTS.CHAT_MESSAGE_TEXT)}else if(this.chatMessage.metha.home){var h=parseInt(this.chatMessage.metha.home.furniture),g=cleverapps.home.furniture[h],v=parseInt(this.chatMessage.metha.home.stage);if(g&&v<g.stages.length){var m=Messages.get("building."+g.name);u=Messages.get(
0<v?"messages:AdminSetHomeProgress.Text.Stage":"messages:AdminSetHomeProgress.Text",{furnitureName:m,stageName:Messages.get(g.stages[v].title)});_=cleverapps.UI.generateOnlyText(u,cleverapps.styles.FONTS.CHAT_MESSAGE_TEXT)}else _=cleverapps.UI.generateOnlyText("messages:AdminSetHomeProgress.Text.Unavailable",cleverapps.styles.FONTS.CHAT_MESSAGE_TEXT)}}else{var f=cleverapps.humanReadableNumber(parseInt(this.chatMessage.progress.episode),parseInt(this.chatMessage.progress.level));_=cleverapps.UI.generateOnlyText("messages:AdminSetProgress.Text",cleverapps.styles.FONTS.CHAT_MESSAGE_TEXT,{levelNo:f})}_.setDimensions(n,0),_.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER),i.setContentSize(n+t.bg.padding,Math.max(t.minHeight,_.height+t.bg.padding+r)),i.addChild(_),_.setPositionRound(i.width/2,i.height/2+r/2),s.push(i)}else if(this.chatMessage.presents){var _,y=this.chatMessage.presents.herolevels&&0<this.chatMessage.presents.herolevels.length;(_=cleverapps.UI.generateOnlyText(
y?"messages:AdminGiftsHeroes":"messages:AdminGiftsText",cleverapps.styles.FONTS.CHAT_MESSAGE_TEXT)).setDimensions(n,0),_.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER),s.push(_);var w=new RewardsListComponent(this.chatMessage.presents,{amountInRow:y?3:2,font:cleverapps.styles.FONTS.CHAT_REWARD_COUNT_TEXT,onlyText:!0,reward:{direction:cleverapps.UI.HORIZONTAL}}),b=Math.min(.9*n/w.width,1);w.setScale(b),i.setContentSize(n+t.bg.padding,Math.max(t.minHeight,w.height*b+r+t.bg.padding)),i.addChild(w),w.setPositionRound(i.width/2,i.height/2+r/2),s.push(i)}if(this.chatMessage.isGiftTaken())o.setPositionRound(t.checkmark),i.addChild(o);else if(this.chatMessage.isApplicable()){var T=new cleverapps.UI.Button({text:Messages.get("No"),button_png:bundles.chat.frames.no_button,button_on_png:bundles.chat.frames.no_button_on,onClicked:function(){cleverapps.chat.acceptGift(this.chatMessage,!1)}.bind(this),font:cleverapps.styles.FONTS.CHAT_MESSAGE_BUTTON_TEXT,width:t.buttons.width,
height:t.buttons.height});T.visible=void 0!==this.chatMessage.progress||void 0!==this.chatMessage.metha;var S=new cleverapps.UI.Button({text:void 0!==this.chatMessage.progress?Messages.get("Yes"):Messages.get("Accept"),button_png:bundles.chat.frames.accept_button,button_on_png:bundles.chat.frames.accept_button_on,onClicked:function(){cleverapps.chat.acceptGift(this.chatMessage,!0)}.bind(this),font:cleverapps.styles.FONTS.CHAT_MESSAGE_BUTTON_TEXT,width:t.buttons.width,height:t.buttons.height});s.push(new cleverapps.Layout([T,S],{direction:cleverapps.UI.HORIZONTAL,margin:t.margin}))}this._super(s.reverse(),{direction:cleverapps.UI.VERTICAL,margin:t.margin,padding:t.padding})}});cleverapps.styles.GiftContentView={width:840,minHeight:220,margin:10,padding:{x:10,y:10},buttons:{width:200,height:60},checkmark:{x:{align:"right",dx:-6},y:{align:"bottom",dy:10}},bg:{padding:20}},cleverapps.overrideFonts(cleverapps.styles.FONTS,{CHAT_MESSAGE_BUTTON_TEXT:{size:40,
color:cleverapps.styles.COLORS.WHITE,font:bundles.chat.urls.strict_font_ttf},CHAT_REWARD_COUNT_TEXT:{size:60,color:cleverapps.styles.COLORS.BLACK,font:bundles.chat.urls.strict_font_ttf}});var ChatView=cc.Node.extend({ctor:function(e){this.chat=e,this.messageViews={},this._super(),this.setAnchorPoint2();var t=this.container=new cc.Node;t.setAnchorPoint2(),this.scroll=new cleverapps.UI.ScrollView(t,{childrenVisibility:cleverapps.UI.ScrollView.CHILDREN_VISIBILITY_FULLCHECK}),this.scroll.setAnchorPoint2(0,0),this.scroll.setPositionRound(0,0),this.addChild(this.scroll),this.onChangeSize(),cleverapps.eventBus.on("changeSceneSize",this.onChangeSize.bind(this),this),this.chat.on("messagesUpdated",this.updateMessages.bind(this)),this.chat.on("removeTemporaryMessages",this.removeTemporaryMessages.bind(this))},updateMessages:function(){this.chat.messages.forEach(function(e){if(this.messageViews[e.id])e.tag!==this.messageViews[e.id].chatMessage.tag&&this.messageViews[e.id].updateContent(e);else{
var t=e.type===ChatMessage.MESSAGE_TYPE.SERVICE?new ServiceMessageView(e):new ChatMessageView(e);this.container.addChild(t),this.messageViews[e.id]=t}}.bind(this));var e=cleverapps.UI.arrangeWithMargins(this.container.getChildren(),{margin:cleverapps.styles.ChatView.margin,direction:cleverapps.UI.TOP_TO_BOTTOM});e<this.scroll.height&&(e=this.scroll.height),this.container.setContentSize2(cc.director.getWinSize().width,e),this.scroll.updateInnerContent(),this.scroll.scrollToPercent(0)},removeTemporaryMessages:function(){Object.keys(this.messageViews).forEach(function(e){this.messageViews[e]&&this.messageViews[e].chatMessage&&this.messageViews[e].chatMessage.type===ChatMessage.MESSAGE_TYPE.TEMPORARY&&(this.messageViews[e].removeFromParent(),this.messageViews[e]=void 0)}.bind(this)),this.updateMessages()},onChangeSize:function(){var e=cleverapps.styles.ChatView,t="horizontal"!==cleverapps.config.orientation?cleverapps.styles.ChatInput.verticalHeight:cleverapps.styles.ChatInput.height,
n=cc.director.getWinSize().height-cleverapps.styles.ChatHeader.height-t-e.extraHeight;this.scroll.setContentSize2(cc.director.getWinSize().width,n),this.setContentSize2(this.scroll.getContentSize()),this.setPositionRound(e),this.chat.messages.forEach(function(e){this.messageViews[e.id]&&this.messageViews[e.id].onChangeSize()}.bind(this)),this.updateMessages()}});cleverapps.styles.ChatView={x:{align:"center"},y:{align:"top",dy:-128},margin:4,scrollBarPosition:{x:4,y:14},extraHeight:8};var ChatScene=cleverapps.FixedWidthScene.extend({ctor:function(e){this._super(cleverapps.Environment.SCENE_CHAT),this.windowsContainer=!0,this.chat=e;var t=new ChatHeader(this.chat);this.addChild(t);var n=new ChatView(this.chat);this.addChild(n);var s=new ChatInput(this.chat);this.addChild(s),cleverapps.placements.run(Placements.INTERMEDIATE),this.chat.hasUnread&&this.chat.markAsRead()},getBackgroundStyles:function(){return{pattern:bundles.chat.urls.window_bg}}});ChatScene.BUNDLES=function(){var e=["chat",
"reward_icons"];return"undefined"!=typeof match3&&e.push("heroes"),"merge"===cleverapps.config.type&&e.push("episode_0"),e};var Toolbar=function(){this.items=[],this.freezed=!1,this.enabled=!1,this.onUpdateItemsListener=function(){},this.onAddItemListener=function(e){},this.onRemoveItemListener=function(e){},this.onEnableListener=function(){},this.addItem(new FriendRequestsToolbarItem),this.addItem(new PeriodicBonusToolbarItem),this.addItem(new DailyTasksToolbarItem),this.addItem(new LeaderBoardToolbarItem),RewardedAdsManager.IsEnabled()&&this.addItem(new RewardedVideoToolbarItem),this.updateItems()};Toolbar.prototype.anyItemWithForce=function(){for(var e=0;e<this.items.length;e++){var t=this.items[e].force;if(t&&this.items[e].isVisible()&&this.items[e].isForceEnabled()&&!cleverapps.forces.isShown(t.id))return this.items[e]}},Toolbar.prototype.showAnyForce=function(){var t=this.anyItemWithForce();cleverapps.metha.display({focus:"toolbarItemForce",control:"toolbar",actions:[function(e){
setTimeout(e,500)},function(e){this.onForceItem(),t.showForce(t.force),cleverapps.forces.onceForceClosed=e}.bind(this)]})},Toolbar.prototype.addItem=function(e){void 0===this.getItem(e.type)&&(this.items.push(e),this.items.sort(function(e,t){return e.type-t.type}),this.onAddItemListener(e),this.update())},Toolbar.prototype.hasVisibleItems=function(){return 0<this.items.filter(function(e){return e.isVisible()}).length},Toolbar.prototype.removeItem=function(e){0<=this.items.indexOf(e)&&(this.items.splice(this.items.indexOf(e),1),this.onRemoveItemListener(e)),this.update()},Toolbar.prototype.getItem=function(e){for(var t=0;t<this.items.length;++t)if(this.items[t].type===e)return this.items[t]},Toolbar.prototype.updateItems=function(e){this.freezed||(this.onUpdateItemsListener(e),this.update())},Toolbar.prototype.freezeUpdates=function(){this.freezed=!0},Toolbar.prototype.unfreezeUpdates=function(){this.freezed=!1,this.updateItems()},Toolbar.prototype.update=function(){
this.hasVisibleItems()?this.enable():this.disable()},Toolbar.prototype.enable=function(){this.enabled||(this.enabled=!0,this.onEnableListener(this.enabled))},Toolbar.prototype.disable=function(){this.enabled&&(this.enabled=!1,this.onEnableListener(this.enabled))};var ToolbarItem=function(e){cleverapps.extend(this,e),this.enabled=!1,this.marked=!1,this.onChangeStateListener=function(){},this.showForce=function(){}};ToolbarItem.prototype.isVisible=function(){return this.enabled},ToolbarItem.prototype.onClick=function(){this.unmark()},ToolbarItem.prototype.enable=function(){this.enabled||(this.enabled=!0,this.onChangeStateListener(),cleverapps.toolbar&&cleverapps.toolbar.updateItems())},ToolbarItem.prototype.isForceEnabled=function(){return!0},ToolbarItem.prototype.disable=function(){this.enabled&&(this.unmark(),this.enabled=!1,this.onChangeStateListener(),cleverapps.toolbar&&cleverapps.toolbar.updateItems())},ToolbarItem.prototype.mark=function(){this.marked||(this.marked=!0,
this.onChangeStateListener())},ToolbarItem.prototype.unmark=function(){this.marked&&(this.marked=!1,this.onChangeStateListener())},ToolbarItem.FRIEND_REQUESTS={type:0,icon:bundles.toolbar.frames.toolbar_mail_icon_png},ToolbarItem.BONUS_GAME={type:1,icon:bundles.toolbar.frames.toolbar_bonusround_icon_png,grayscaleDisabled:!0,force:Forces.BONUS_ROUND_FORCE},ToolbarItem.PERIODIC_BONUS={type:2,icon:bundles.toolbar.frames.toolbar_dailybonus_icon_png,countdown:!0,grayscaleDisabled:!0,force:Forces.PERIODIC_BONUS_FORCE},ToolbarItem.LEADER_BOARD={type:3,icon:bundles.toolbar.frames.toolbar_leader_board_icon_png},ToolbarItem.DAILY_TASKS={type:4,icon:bundles.toolbar.frames.toolbar_daily_tasks_icon_png,countdown:!0,force:Forces.DAILY_TASKS_FORCE},ToolbarItem.REWARDED_VIDEO={type:5,icon:bundles.toolbar.frames.toolbar_rewarded_video_icon_png};var BonusRoundToolbarItem=function(){ToolbarItem.call(this,ToolbarItem.BONUS_GAME),cleverapps.bonusRoundChest.changeLockedListener=this.changeLocked.bind(this),
this.changeLocked()};BonusRoundToolbarItem.prototype=Object.create(ToolbarItem.prototype),(BonusRoundToolbarItem.prototype.constructor=BonusRoundToolbarItem).prototype.isVisible=function(){return(void 0===typeof match3||!cleverapps.environment.isGameScene())&&(!!cleverapps.bonusRoundChest.isActive()&&this.enabled)},BonusRoundToolbarItem.prototype.changeLocked=function(){cleverapps.bonusRoundChest.locked?this.disable():(this.enable(),this.mark())},BonusRoundToolbarItem.prototype.onClick=function(){cleverapps.bonusRoundChest.locked?cleverapps.Notification.create("messages:BonusRound.ClosedText"):(this.unmark(),cleverapps.metha.display({focus:"BonusRoundWindow",action:function(e){cleverapps.bonusRoundChest.open(e)}}))};var PeriodicBonusToolbarItem=function(){ToolbarItem.call(this,ToolbarItem.PERIODIC_BONUS),this.countdown=cleverapps.periodicBonus.countdown,cleverapps.periodicBonus.changeLockedListener=this.changeLocked.bind(this),this.changeLocked()}
;PeriodicBonusToolbarItem.prototype=Object.create(ToolbarItem.prototype),(PeriodicBonusToolbarItem.prototype.constructor=PeriodicBonusToolbarItem).prototype.isVisible=function(){return levels.user.checkAvailable(cleverapps.MiniGame.AVAILABLE)},PeriodicBonusToolbarItem.prototype.unlock=function(){this.mark()},PeriodicBonusToolbarItem.prototype.changeLocked=function(){cleverapps.periodicBonus.locked?this.disable():(this.enable(),this.mark())},PeriodicBonusToolbarItem.prototype.onClick=function(){cleverapps.periodicBonus.locked?cleverapps.Notification.create(cleverapps.periodicBonus.closedText,{image:new cc.Sprite(this.icon)}):(this.unmark(),cleverapps.metha.display({focus:"MiniGameWindowFromToolbar",action:function(e){cleverapps.periodicBonus.openWindow(e)}}))};var FriendRequestsToolbarItem=function(){ToolbarItem.call(this,ToolbarItem.FRIEND_REQUESTS),this.lastNotProceedId=cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.LAST_VIEWED_FRIEND_REQUEST,{raw:!0}),
levels.friendRequests.onNewListener=function(){this.mark(),cleverapps.toolbar.updateItems()}.bind(this),levels.friendRequests.onChangeListener=function(){levels.friendRequests.existNotProcessed()||(this.unmark(),cleverapps.toolbar.updateItems(!0))}.bind(this),this.enable(),this.mark()};FriendRequestsToolbarItem.prototype=Object.create(ToolbarItem.prototype),(FriendRequestsToolbarItem.prototype.constructor=FriendRequestsToolbarItem).prototype.mark=function(){if(0!==cleverapps.friends.listFriends().concat(cleverapps.invitalbleFriends.listFriends()).length){var e=levels.friendRequests.lastNotProcessedId();!1!==e&&e!==this.lastNotProceedId&&ToolbarItem.prototype.mark.apply(this)}},FriendRequestsToolbarItem.prototype.isVisible=function(){return levels.friendRequests.existNotProcessed()},FriendRequestsToolbarItem.prototype.onClick=function(){this.lastNotProceedId=levels.friendRequests.lastNotProcessedId(),cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.LAST_VIEWED_FRIEND_REQUEST,
this.lastNotProceedId,{raw:!0}),this.unmark(),cleverapps.metha.display({focus:"FriendRequestsWindow",control:["MenuBarGoldItem","MenuBarLivesItem"],action:function(e){new FriendRequestsWindow,cleverapps.metha.onceNoWindowsListener=e}})};var LeaderBoardToolbarItem=function(){ToolbarItem.call(this,ToolbarItem.LEADER_BOARD),this.enable()};LeaderBoardToolbarItem.prototype=Object.create(ToolbarItem.prototype),LeaderBoardToolbarItem.prototype.constructor=FriendRequestsToolbarItem,LeaderBoardToolbarItem.prototype.onClick=function(){cleverapps.social instanceof cleverapps.MobileVk?cleverapps.social.showLeaderBoardBox({userResult:levels.user.getHumanReadableNumber()},function(){}):cleverapps.metha.display({focus:"LeadersWindow",action:function(e){new LeadersWindow,cleverapps.metha.onceNoWindowsListener=e}})},LeaderBoardToolbarItem.prototype.isVisible=function(){return!cleverapps.flags.norest&&ToolbarItem.prototype.isVisible.call(this)&&levels.user.checkAvailable(
cleverapps.Availables.LEADER_BOARD)};var RewardedVideoToolbarItem=function(){ToolbarItem.call(this,ToolbarItem.REWARDED_VIDEO),cleverapps.config.debugMode&&(RewardedVideoToolbarItem.INTERVAL="20 seconds",RewardedVideoToolbarItem.START_PLAY_INTERVAL="10 seconds",RewardedVideoToolbarItem.CHECK_INTERVAL="10 seconds"),this.isAvailable()?this.enable():this.disable(),this.checkAvailable=setInterval(function(){!this.enabled&&this.isAvailable()&&this.enable()}.bind(this),cleverapps.parseInterval(RewardedVideoToolbarItem.CHECK_INTERVAL)),cleverapps.rewardedAdsManager.onStartPlayListeners[RewardedAdsManager.REWARDED+"_toolbar"]=this.startPlay.bind(this),cleverapps.rewardedAdsManager.onEndPlayListeners[RewardedAdsManager.REWARDED+"_toolbar"]=this.startPlay.bind(this)};RewardedVideoToolbarItem.prototype=Object.create(ToolbarItem.prototype),(RewardedVideoToolbarItem.prototype.constructor=RewardedVideoToolbarItem).prototype.enable=function(){this.enabled||(ToolbarItem.prototype.enable.apply(this),
this.mark())},RewardedVideoToolbarItem.prototype.onClick=function(){this.isAvailable()&&cleverapps.rewardedAdsManager.play(RewardedAdsManager.REWARDED,this.reward.bind(this))},RewardedVideoToolbarItem.prototype.isVisible=function(){return ToolbarItem.prototype.isVisible.call(this)&&levels.user.checkAvailable(RewardedAdsManager.AVAILABLE)&&cleverapps.rewardedAdsManager.isAvailable(RewardedAdsManager.REWARDED)},RewardedVideoToolbarItem.prototype.isAvailable=function(){return(cc.sys.localStorage.getItem(cleverapps.DataLoaderTypes.REWARDED_TOOLBAR)||0)<Date.now()&&levels.user.checkAvailable(RewardedAdsManager.AVAILABLE)&&cleverapps.rewardedAdsManager.isAvailable(RewardedAdsManager.REWARDED)},RewardedVideoToolbarItem.prototype.startPlay=function(){this.disabled||(cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.REWARDED_TOOLBAR,Date.now()+cleverapps.parseInterval(RewardedVideoToolbarItem.START_PLAY_INTERVAL)),this.disable())},RewardedVideoToolbarItem.prototype.reward=function(){
cleverapps.metha.displayWhenFreeFocus({focus:"RewardedAdToolbarReward",action:function(e){cleverapps.eventLogger.logEvent(cleverapps.EVENTS.REWARDED_TOOLBAR_WINDOW_SHOW),new RewardWindow({reward:{gold:RewardedVideoToolbarItem.REWARD.gold},callback:function(){cleverapps.eventLogger.logEvent(cleverapps.EVENTS.REWARDED_TOOLBAR_WINDOW_CLOSE)}}),cleverapps.metha.onceNoWindowsListener=e}}),cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.REWARDED_TOOLBAR,Date.now()+cleverapps.parseInterval(RewardedVideoToolbarItem.INTERVAL)),cleverapps.eventLogger.logEvent(cleverapps.EVENTS.REWARDED_TOOLBAR)},RewardedVideoToolbarItem.REWARD={gold:10},RewardedVideoToolbarItem.INTERVAL="5 minutes",RewardedVideoToolbarItem.START_PLAY_INTERVAL="1 minute",RewardedVideoToolbarItem.CHECK_INTERVAL="30 seconds";var DailyTasksToolbarItem=function(){ToolbarItem.call(this,ToolbarItem.DAILY_TASKS),this.countdown=new cleverapps.CountDown(cleverapps.dailyTasks.getTimeLeft()),this.enable(),
cleverapps.dailyTasks.onChangeStateListener=this.onChangeState.bind(this),this.onChangeState()};DailyTasksToolbarItem.prototype=Object.create(ToolbarItem.prototype),(DailyTasksToolbarItem.prototype.constructor=DailyTasksToolbarItem).prototype.onChangeState=function(){0<cleverapps.dailyTasks.getNotCollectedTasks().length||!cleverapps.dailyTasks.isRunning()?this.mark():this.unmark(),this.countdown.resetTimeLeft(cleverapps.dailyTasks.getTimeLeft()),this.countdown.nextSecond(Date.now())},DailyTasksToolbarItem.prototype.isVisible=function(){return levels.user.checkAvailable(cleverapps.Availables.DAILY_TASKS)},DailyTasksToolbarItem.prototype.onClick=function(){cleverapps.metha.display({focus:"DailyTasksWindow",action:function(e){new DailyTasksWindow,cleverapps.metha.onceNoWindowsListener=e}})};var ToolbarView=cc.Node.extend({ctor:function(e){this._super(),this.toolbar=cleverapps.toolbar,this.toolbar.update();var t=cleverapps.styles.ToolbarView;this.setAnchorPoint2(),this.height=t.bg.height,
this.createBg(),this.itemsViews=[],this.toolbar.items.forEach(function(e){var t=new ToolbarItemView(e);this.itemsViews.push(t),this.addChild(t)}.bind(this)),this.setPositionRound(t.position),this.deltaY=cleverapps.UI.getSceneOffsetY(),this.alignment=cleverapps.clone(this.alignment,!0),this.alignment.y.dy-=this.deltaY,e.addChild(this),this.hidePosition=cc.p(this.x,this.y-2*this.height),cleverapps.UI.makeHideable(this,cleverapps.UI.VERTICAL)},createBg:function(){bundles.toolbar.frames.toolbar_bg_png?this.bg=new cc.Scale9Sprite(bundles.toolbar.frames.toolbar_bg_png):(this.bg=new cc.Node,this.bg.setAnchorPoint2()),this.addChild(this.bg),this.bg.height=this.height,this.bg.setPositionRound(this.width/2,this.height/2)},onEnter:function(){this._super(),this.toolbar.onAddItemListener=this.createListener(this.addItem.bind(this)),this.toolbar.onRemoveItemListener=this.createListener(this.removeItem.bind(this)),this.toolbar.onUpdateItemsListener=this.createListener(this.updateItems.bind(this)),
this.toolbar.onEnableListener=this.createListener(this.updateEnabled.bind(this)),this.toolbar.onForceItem=this.createListener(this.onForceItem.bind(this)),this.updateItems(!0),this.hide(!0),this.updateEnabled(this.toolbar.enabled),cleverapps.metha.registerControl("toolbar",this.createListener(function(e){this.stopAllActions(),e?this.toolbar.enabled&&this.show():this.hide()}.bind(this)))},onForceItem:function(){this.show(!0)},addItem:function(e){var t=new(e.getViewClass())(e);this.addChild(t),this.itemsViews.push(t),this.itemsViews.sort(function(e,t){return e.toolbarItem.type-t.toolbarItem.type}),this.updateItems()},removeItem:function(t){var e=this.itemsViews.filter(function(e){return e.toolbarItem===t});e&&(this.itemsViews.splice(this.itemsViews.indexOf(e),1),e.removeFromParent(),this.updateItems())},updateItems:function(s){var e=cleverapps.styles.ToolbarView,i=[],o=[],r=[],a=0;this.itemsViews.forEach(function(e){var t=e.visible;t&&a++;var n=e.toolbarItem.isVisible();n!==t&&(o.push(e)
,n?e.setVisible(!0):s?e.setVisible(!1):(r.push(e),e.stopAllActions(),e.runAction(new cc.Sequence(new cc.ScaleTo(.3,0),new cc.CallFunc(function(){e.setVisible(!1),e.setScale(1)}))))),n&&i.push(e)}.bind(this));var c=(i.length-1)*e.margin;i.forEach(function(e){e.baseScaleX=1,c+=e.width});var t=0;0<i.length&&(t=cleverapps.UI.arrangeWithMargins(i,{direction:cleverapps.UI.HORIZONTAL,margin:e.margin,y:this.height/2+e.items.dy,iterator:function(e,t,n){t-=c/2,s?(e.scale=1,e.setPositionRound(t,n)):(-1!==o.indexOf(e)&&(e.scale=0,e.setPositionRound(t,n)),e.stopAllActions(),e.runAction(new cc.Spawn(new cc.ScaleTo(.6,1).easing(new cc.easeBackOut(.05)),new cc.MoveTo(.6,cc.p(t,n)))))}})),this.updateBg(t,a,i.length,s)},updateBg:function(e,t,n,s){this.bg.stopAllActions(),s||t<n?this._updateBg(e):this.bg.runAction(new cc.Sequence(new cc.DelayTime(.6),new cc.CallFunc(this._updateBg.bind(this,e))))},_updateBg:function(e){var t=cleverapps.styles.ToolbarView;this.bg.width=e+2*t.margin+2*t.bg.padding,
this.bg.setPositionRound(this.width/2,this.height/2),this.setScale(this.bg.width>cc.director.getWinSize().width?cc.director.getWinSize().width/this.bg.width:1),this.decors&&(this.decors.forEach(function(e){e.removeFromParent()}),delete this.decors),this.decors=SceneDecors.add(this.bg,cleverapps.skins.getSlot("toolbarDecors"))},updateEnabled:function(e){this.stopAllActions(),e&&0===cleverapps.windows.list.length?(this.hide(!0),this.show()):this.hide()}});cleverapps.styles.ToolbarView={position:{x:{align:"center",dx:0},y:{align:"bottom",dy:0}},bg:{height:115,padding:0},hover:{margin:6},items:{dy:0},margin:30};var ToolbarItemCountdownView=cleverapps.CountDownView.extend({ctor:function(e){var t=cleverapps.overrideStyles(cleverapps.styles.ToolbarItemView.countdownView,{font:cleverapps.styles.FONTS.TOOLBAR_ITEM_TIMER_TEXT},!0);if(t.scale9){var n=new cc.Scale9Sprite(t.background_image);n.setContentSize2(t.bg.width,t.bg.height),t.background_content=n}this._super(e,t)},refresh:function(){
this._super(),this.visible=0<this.countDown.getTimeLeft()},whatToDoOnStop:function(){this.countDown.onSecond=function(){}}}),ToolbarItemView=cc.Node.extend({ctor:function(e){this._super(),this.toolbarItem=e;var t=cleverapps.styles.ToolbarItemView;this.shakeTimeout=new cc.Node,this.addChild(this.shakeTimeout),this.hideTimeout=new cc.Node,this.addChild(this.hideTimeout);var n=new cc.Sprite(this.toolbarItem.icon);n.setAnchorPoint2(),this.addChild(n),this.icon=n,this.setContentSize2(this.icon.getContentSize()),this.setAnchorPoint2(),this.icon.setPositionRound(t.icon);var s=new cc.Sprite(t.mark.icon);s.setAnchorPoint2(),this.addChild(s),s.setPositionRound(t.mark),(this.mark=s).runAction(new cc.RepeatForever(new cc.Sequence(new cc.ScaleTo(.3,1.1),new cc.ScaleTo(.3,1)))),cleverapps.UI.applyHover(this),cleverapps.UI.onClick(this,function(){cleverapps.audio.playSound(bundles.main.urls.click_effect),cleverapps.forces.isRunningForce()&&(this.toolbarItem.countdown&&this.addTimerView(),
cleverapps.forces.closeRunningForce()),this.toolbarItem.onClick()}.bind(this)),this.toolbarItem.countdown&&this.addTimerView()},showForce:function(e){cleverapps.forces.create(this,e)},addTimerView:function(){this.timerView&&(this.timerView.removeFromParent(),delete this.timerView);var e=cleverapps.styles.ToolbarItemView.timer,t=new ToolbarItemCountdownView(this.toolbarItem.countdown);t.setPosition(this.width/2+e.offsetX,this.height/2+e.offsetY),t.setScale(e.scale),this.addChild(t),this.timerView=t},onEnter:function(){this._super(),this.toolbarItem.onChangeStateListener=this.createListener(this.onChangeState.bind(this)),this.toolbarItem.showForce=this.createListener(this.showForce.bind(this)),this.onChangeState()},grayscale:function(){this.icon.setColor(this.toolbarItem.enabled?cleverapps.styles.COLORS.GRAY_SCALE_RESTORE_COLOR:cleverapps.styles.COLORS.GRAY_SCALE_COLOR),this.toolbarItem.countdown&&(this.timerView.setVisible(!this.toolbarItem.enabled),this.timerView.refresh())},
onChangeState:function(){if(this.toolbarItem.grayscaleDisabled&&this.grayscale(),this.mark.setVisible(this.toolbarItem.marked),this.toolbarItem.marked){var e=Math.floor(8*Math.random())+8;this.shake(e)}},shake:function(e){if(this.toolbarItem.marked&&!this.shakeRunned){this.shakeRunned=!0;var t=function(){this.toolbarItem.marked&&this.parent.visible&&(cleverapps.audio.playSound(bundles.main.urls.icon_jump_effect),this.runAction(new cc.Sequence(new cc.ScaleTo(.5,1.2,.8),new cc.Spawn(new cc.ScaleTo(.2,1,1),new cc.MoveBy(.2,0,150)),new cc.MoveBy(.2,0,-150),new cc.MoveBy(.1,0,30),new cc.MoveBy(.1,0,-30),new cc.CallFunc(function(){this.shakeRunned=!1,this.shake(Math.floor(8*Math.random())+8)}.bind(this)))))}.bind(this);this.shakeTimeout.runAction(new cc.Sequence(new cc.DelayTime(e),new cc.CallFunc(t)))}},onMouseOver:function(){this.toolbarItem.enabled&&this.setScale(1.05*this.baseScale||1.05)}});cleverapps.overrideFonts(cleverapps.styles.FONTS,{TOOLBAR_ITEM_TIMER_TEXT:{name:"default",size:40
}}),cleverapps.styles.ToolbarItemView={timer:{offsetY:-10,offsetX:0,scale:.6},icon:{x:{align:"center"},y:{align:"center"}},mark:{icon:bundles.toolbar.frames.toolbar_attention_icon_png,x:{align:"center",dx:-30},y:{align:"center",dy:30}},countdownView:{background_image:bundles.main.frames.timer_bg_png,timerPosition:{x:0,y:0}}},cleverapps.FBLoginOrInvite=function(){if(cleverapps.social.isInitialized()&&!cleverapps.flags.nologin){var e=!1;if((cleverapps.social.isLoggedIn()||cleverapps.social.nativeInviteFriends)&&(e=!0),!e||!cleverapps.flags.noviral){var t=cleverapps.styles.FBLoginOrInvite,n=new cc.Node;n.setAnchorPoint2();var s=n.createListener(function(){var e=cleverapps.social.isLoggedIn()?cleverapps.EVENTS.FBLOGINORINVITE_INVITE:cleverapps.EVENTS.FBLOGINORINVITE_LOGIN;cleverapps.eventLogger.logEvent(e),n.removeFromParent(!0)}),i=new FbButton({showIcon:!1,onSuccess:s});n.setContentSize2(i.getContentSize());var o=cleverapps.UI.getSceneSize();if(n.setPosition(o.width/2+t.x,
i.height/2+cleverapps.UI.getSceneOffsetY()+t.y),n.addChild(i),i.setPositionRound(n.width/2,n.height/2),i.onMouseOver=function(){},i.onMouseOut=function(){},t.images.avatars){var r=new cleverapps.UI.Avatar({avatar:bundles.main.frames.default_avatar,frame:bundles.avatar.frames.avatar_frame2});r.setScale(t.images.avatars.scale),r.setPositionRound(t.images.avatars.right.x,t.images.avatars.right.y,n.getContentSize()),r.setRotation(t.images.avatars.right.rotation),n.addChild(r);var a=new cleverapps.UI.Avatar({avatar:bundles.main.frames.default_avatar,frame:bundles.avatar.frames.avatar_frame2});a.setScale(t.images.avatars.scale),a.setPositionRound(t.images.avatars.left.x,t.images.avatars.left.y,n.getContentSize()),a.setRotation(t.images.avatars.left.rotation),n.addChild(a)}var c=cleverapps.UI.generateTTFText(e?"messages:FBLoginOrInvite.invite":"messages:FBLoginOrInvite.login",cleverapps.styles.FONTS.FBLOGINORINVITE_TEXT);return c.setPosition(n.width/2+t.text.offsetX,n.height+t.text.offsetY),
c.fitTo(t.text.width),n.addChild(c),n.setScale(0),n.runAction(new cc.Sequence(new cc.ScaleTo(.5,1).easing(new cc.easeBackOut),new cc.CallFunc(function(){cleverapps.UI.applyHover(n)}))),c.setOpacity(0),c.runAction(new cc.Sequence(new cc.DelayTime(.5),new cc.FadeIn(.5))),n.setLocalZOrder(5),n}}},cleverapps.styles.FBLoginOrInvite={y:4,x:40,images:{avatars:{scale:.7,left:{x:{align:"left",dx:-70},y:{align:"center"},rotation:-7},right:{x:{align:"left",dx:-40},y:{align:"center",dy:5},rotation:13}}},text:{offsetX:-40,offsetY:26,width:700}},cleverapps.Row=cc.Scale9Sprite.extend({getStyles:function(){return cleverapps.styles.Row},getMaxTextLength:function(){return 12},ctor:function(e){var t,n=this.getStyles();e.player&&(this.player=!0),this.notInTop=e.notInTop,this.clickableArea=e.clickableArea,e.player?t=n.you_bg:(t=n.bg,(e.place-1)%2==1&&n.bg2&&(t=n.bg2));var s=new cc.Sprite(t);this._super(s.getSpriteFrame()),this.setContentSize2(n.size),this.updatePlace(e.place,!0)
;var i=new cleverapps.UI.Avatar(e.avatar);i.setPosition(n.avatar.position.x,n.avatar.position.y+this.height/2),i.setScale(n.avatar.scale),this.addChild(i);var o=e.text||"";if(o||"string"!=typeof e.id||(o="Player_"+e.id.substr(-3)),o.length>this.getMaxTextLength()){var r=(o=o.replace(/^[\s]+/,"")).lastIndexOf(" ",this.getMaxTextLength());r<=0&&(r=this.getMaxTextLength()),o=o.substr(0,r)}var a=cleverapps.UI.generateTTFText(o,e.player?cleverapps.styles.FONTS.ROW_PLAYER_TEXT||n.text.playerFont:cleverapps.styles.FONTS.ROW_TEXT||n.text.font);n.text.width&&a.fitTo(n.text.width),a.setPosition(n.text.x,n.text.y+this.height/2),this.addChild(a),this.generateData(e)},updateParams:function(e){this.notInTop=e.notInTop},generateDataBg:function(e){var t,n=this.getStyles();if(n.data.bg){var s=e.player&&n.data.bgYou?n.data.bgYou:n.data.bg;t=new cc.Scale9Sprite(new cc.Sprite(s).getSpriteFrame())}else(t=new cc.Node).setAnchorPoint2();return this.addChild(t),t.setContentSize2(n.data.size),t.setPosition(
n.data.position.x,n.data.position.y+this.height/2),t},generateDataContent:function(e,t){var n=this.getStyles(),s=t.dataIcon||n.data.icon;if(s){var i=new cc.Sprite(s);i.setPosition(n.data.iconPosition.x,n.data.iconPosition.y+e.height/2),i.setScale(n.data.scale),i.setRotation(n.data.rotation),e.addChild(i)}this.dataAmount=cleverapps.UI.generateImageText("",cleverapps.styles.FONTS.ROW_DATA_TEXT||n.data.amount.font),this.dataAmount.baseScale=this.dataAmount.scale,this.dataAmount.setPosition(n.data.amount.x,e.height/2+n.data.amount.y),e.addChild(this.dataAmount),this.updateAmount(t.amount,!0)},generateData:function(e){this.getStyles();var t=this.generateDataBg(e);this.getTooltipText()&&cleverapps.tooltipManager.create(t,{text:this.getTooltipText(),position:cleverapps.styles.UI.Tooltip.LOCATION.below,clickableArea:this.clickableArea}),this.generateDataContent(t,e)},getTooltipText:function(){return""},updatePlace:function(e,t){this.currentPlace!==e&&(this.currentPlace=e,this.refreshPlace(
this.currentPlace,t),this.refreshReward(this.currentPlace,t))},updateAmount:function(e,t){var n=this.getStyles();this.currentAmount!==e&&(this.currentAmount=e,this.dataAmount.stopAllActions(),this.dataAmount.setScale(this.dataAmount.baseScale),this.dataAmount.setString(this.currentAmount),this.dataAmount.fitTo(n.data.amount.width,n.data.amount.height),this.dataAmount.baseScale=this.dataAmount.scale,t||this.dataAmount.runAction(new cc.Sequence(new cc.ScaleTo(.2,1.5*this.dataAmount.baseScale),new cc.ScaleTo(.2,this.dataAmount.baseScale))))},refreshReward:function(e){var t=this.getStyles();t.reward&&(this.reward&&this.reward.removeFromParent(!0),this.reward=this.generatePrizeBanner(e),this.reward&&(this.reward.setPosition(t.reward.x,t.reward.y+this.height/2),this.addChild(this.reward)))},refreshPlace:function(e){var t=this.getStyles();this.place&&this.place.removeFromParent(!0),this.place=this.generatePlaceBadge(e),this.place.setPosition(t.place.x,this.place.y+t.place.y+this.height/2),
this.addChild(this.place)},generatePlaceBadge:function(e){var t=this.getStyles(),n=this.player?t.place.playerFont:t.place.font;if(!(t=t.placeBadges)||e>t.icons.length)return this.generatePlaceText(e,n);var s=new cc.Sprite(t.icons[e-1]);return s.setPositionRound(t.x,t.y),s},generatePlaceText:function(e,t){var n=e;return this.notInTop&&(n="-"),cleverapps.UI.generateTTFText(n,t)},generatePrizeBanner:function(e){var t=this.getStyles();if(t.prizes&&!(e>(t=t.prizes).length)){t=t[e-1];var n=new cc.Node;if(t.banner){var s=new cc.Sprite(t.banner);n.addChild(s)}if(t.icon){var i=new cc.Sprite(t.icon);i.setScale(t.scale),n.addChild(i),i.setPosition(0,t.y);var o=new cc.Node;o.setContentSize2(i.getContentSize()),o.setAnchorPoint2(),n.addChild(o);var r=Messages.get("PrizeTooltip");this.currentPlace&&this.currentPlace<=5&&(r=Messages.get("Cup"+this.currentPlace+"PlaceTooltip")),this.addPrizeBannerTooltip(r,o)}return n}},getRewards:function(){},addPrizeBannerTooltip:function(e,t){
cleverapps.tooltipManager.create(t,{rewards:this.getRewards(),text:e,position:cleverapps.styles.UI.Tooltip.LOCATION.above,clickableArea:this.clickableArea})}}),cleverapps.styles.Row={bg:bundles.main.frames.row_player_png,bg2:bundles.main.frames.row_player_2_png,you_bg:bundles.main.frames.row_you_png,size:{width:680,height:70},placeBadges:{x:0,y:8,icons:[bundles.main.frames.levelstart_cup_1,bundles.main.frames.levelstart_cup_2,bundles.main.frames.levelstart_cup_3]},place:{x:56,y:0,font:cleverapps.styles.FONTS.TEXT,playerFont:cleverapps.styles.FONTS.WHITE_TEXT},avatar:{scale:.5,position:{x:150,y:0}},text:{x:290,y:-4,font:cleverapps.styles.FONTS.SMALL_TEXT,playerFont:cleverapps.styles.FONTS.SMALL_WHITE_TEXT,width:200},reward:{x:464,y:-4},prizes:[{banner:bundles.main.frames.red_banner_png,icon:bundles.menubar.frames.star_chest_icon_png,scale:.85,y:6},{banner:bundles.main.frames.blue_banner_png,icon:bundles.menubar.frames.star_chest_icon_png,scale:.8,y:6},{
banner:bundles.main.frames.green_banner_png,icon:bundles.menubar.frames.star_chest_icon_png,scale:.75,y:6},{icon:bundles.menubar.frames.star_chest_icon_png,scale:.7,y:6},{icon:bundles.menubar.frames.star_chest_icon_png,scale:.7,y:6}],data:{size:{width:140,height:60},bg:bundles.main.frames.light_bg_png,scale:.5,rotation:-10,iconPosition:{x:32,y:0},position:{x:604,y:0},amount:{x:100,y:0,font:cleverapps.styles.FONTS.WHITE_TEXT}}},cleverapps.LeadersRow=cleverapps.Row.extend({getStyles:function(){return cleverapps.styles.LeadersRow},getMaxTextLength:function(){return 16}}),cleverapps.styles.LeadersRow={bg:bundles.main.frames.row_player_png,you_bg:bundles.main.frames.row_you_png,size:{width:680,height:70},badgeY:8,place:{x:56,y:0,font:cleverapps.styles.FONTS.TEXT,playerFont:cleverapps.styles.FONTS.WHITE_TEXT},placeBadges:{x:0,y:8,icons:[bundles.main.frames.levelstart_cup_1,bundles.main.frames.levelstart_cup_2,bundles.main.frames.levelstart_cup_3]},avatar:{scale:.5,position:{x:150,y:0}},
text:{x:360,y:-4,font:cleverapps.styles.FONTS.SMALL_TEXT,playerFont:cleverapps.styles.FONTS.SMALL_WHITE_TEXT,width:280},data:{size:{width:140,height:60},bg:bundles.main.frames.light_bg_png,position:{x:604,y:0},amount:{x:70,y:0,font:cleverapps.styles.FONTS.WHITE_TEXT}}},cleverapps.MissionRow=cleverapps.Row.extend({getRewards:function(){var e=cleverapps.clone(RewardsConfig.Tournament.places[this.currentPlace-1],!0);return RewardsConfig.Tournament.prepareByRich&&(e=cleverapps.user.prepareRewardByRich(e)),e},getTooltipText:function(){return Messages.get("ResultTooltip")}}),cleverapps.DailyCupRow=cleverapps.Row.extend({getStyles:function(){return cleverapps.styles.DailyCupRow},getRewards:function(){return cleverapps.dailyCup.data.rewards[this.currentPlace-1]},getTooltipText:function(){return Messages.get("ResultTooltip")}}),cleverapps.styles.DailyCupRow=cleverapps.overrideStyles(cleverapps.styles.Row,{data:{icon:bundles.main.frames.stars_star,scale:.4,rotation:0}},!0),function(){
cleverapps.styles.DailyCupRow.prizes=[];for(var e=[.85,.8,.7],t=[bundles.main.frames.red_banner_png,bundles.main.frames.blue_banner_png,bundles.main.frames.green_banner_png],n=0;n<3;n++)cleverapps.styles.DailyCupRow.prizes[n]={banner:t[n],icon:bundles.menubar.frames.star_chest_icon_png,iconBet:bundles.menubar.frames.star_chest_icon_png,scale:e[n],y:6};for(n=3;n<10;n++)cleverapps.styles.DailyCupRow.prizes[n]={icon:bundles.reward_icons.frames.life_unlim_small,iconBet:bundles.reward_icons.frames.gold_small_png,scale:1,y:6}}(),cleverapps.DailyCupLeadersRow=cleverapps.Row.extend({getStyles:function(){return cleverapps.styles.DailyCupLeadersRow},generateMedalAmount:function(e,t){var n=this.getStyles(),s=new cc.Sprite(bundles.daily_cup.frames["place_badge_"+e]||bundles.main.frames["levelstart_cup_"+e]);s.setScale(n.medal.scale);var i=cleverapps.UI.generateImageText(t,cleverapps.styles.FONTS.DAILY_CUP_LEADERS_ROW_AMOUNT||cleverapps.styles.FONTS.SMALL_WHITE_TEXT);i.setVerticalAlignment(
cc.TEXT_ALIGNMENT_CENTER),i.fitTo(n.medal.width);var o=new cc.Node;return o.setAnchorPoint2(),o.setContentSize2(n.medal.width,i.height),o.addChild(i),i.setPositionRound(i.width/2*i.scale,i.height/2),new cleverapps.Layout([s,o],{direction:cleverapps.UI.HORIZONTAL,margin:n.medal.iconMargin})},generateDataContent:function(e,t){var n=this.getStyles(),s=[];s.push(this.generateMedalAmount(1,t.firstPlace)),s.push(this.generateMedalAmount(2,t.secondPlace)),s.push(this.generateMedalAmount(3,t.thirdPlace));var i=new cleverapps.Layout(s,{direction:cleverapps.UI.HORIZONTAL,margin:n.medal.margin});e.addChild(i),i.setPositionRound(e.width/2,e.height/2)}}),cleverapps.styles.DailyCupLeadersRow=cleverapps.overrideStyles(cleverapps.styles.Row,{prizes:[],placeBadges:void 0,medal:{scale:.5,width:50,iconMargin:2,margin:4},place:{x:36},avatar:{position:{x:96}},text:{x:240},data:{size:{width:320,height:60},position:{x:514,y:0}}},!0),cleverapps.Table=function(){this.results={}},
cleverapps.Table.prototype.updateResults=function(e,t){this.results[e]=[];for(var n=0;n<t.length;n++)this.results[e].push(cleverapps.clone(t[n]))},cleverapps.Table.prototype.resetResults=function(e){this.results[e]=void 0},cleverapps.Table.prototype.getResults=function(e){return this.results[e]},cleverapps.Table.prototype.createTableView=function(e){var t=new cleverapps.TableView(e.data,this.results[e.id],e.rowConstructor,e.dataIcon,e.options);return this.updateResults(e.id,e.data),t},cleverapps.TableView=cc.Node.extend({setupRowPosition:function(e,t,n){var s=function(){e.view.currentPlace===e.data.place&&e.data.place>this.amountRows?(e.view.removeFromParent(),delete this.rows[e.data.id]):this.scroll&&this.setRowVisibility(e),n&&n()}.bind(this);t=this.amountRows-t;var i=cc.p(this.styles.innerPadding,this.styles.innerPadding+(this.styles.margin+e.view.height)*t+e.view.height/2);e.view.setLocalZOrder(t),n&&(this.isVisiblePosition(e.view.y,e.view.height)||this.isVisiblePosition(i.y,
e.view.height))?e.view.runAction(new cc.Sequence(new cc.MoveTo(.2,i),new cc.CallFunc(s))):(e.view.setPositionRound(i),s())},isVisiblePosition:function(e,t){return e-=this.scroll.innerContent.height/2,-this.scroll.innerContent.y-this.scroll.height/2-t/2<=e&&e<=-this.scroll.innerContent.y+this.scroll.height/2+t/2},finishAnimation:function(){this.inSwapAnimation--,0===this.inSwapAnimation&&this.swapIfNeed()},startAnimation:function(e){e||(e=1),this.inSwapAnimation+=e},swapPairIfNeed:function(e,t){var n,s=e.view.currentPlace,i=t.view.currentPlace;this.startAnimation(2),e.view.updatePlace(i),t.view.updatePlace(s),this.setupRowPosition(e,i,this.finishAnimation.bind(this)),this.setupRowPosition(t,s,this.finishAnimation.bind(this)),e.data.player?n=t.view:t.data.player&&(n=e.view),n&&this.scroll.scrollToMakeNodeVisible(n,.2,{top:.8,bottom:.8},{easing:cc.easeInOut(1)})},findRowWithPlace:function(e){for(var t in this.rows)if(this.rows[t].view.currentPlace===e)return this.rows[t];return!1},
swapIfNeed:function(){if(0===this.inSwapAnimation){var e,t,n=this.amountRows+2;for(t in this.rows)this.rows[t].view.currentPlace>this.rows[t].data.place&&this.rows[t].data.place<n&&(n=this.rows[t].data.place,e=this.rows[t]);for(t in e&&this.swapPairIfNeed(this.findRowWithPlace(e.view.currentPlace-1),e),this.rows)this.rows[t].data.place<=n&&this.rows[t].view.updateAmount(this.rows[t].data.amount)}},setRowVisibility:function(e){e&&e.view&&e.view.setVisible(this.isVisiblePosition(e.view.y,e.view.height))},setRowsVisibility:function(){for(var e in this.rows)this.setRowVisibility(this.rows[e])},cloneResults:function(e){var t,n=[];for(t=0;t<e.length;t++)n.push(cleverapps.clone(e[t]));return n},updateResults:function(e){if(this.amountRows!==e.length)return!1;var t,n=this.cloneResults(e),s=this.amountRows+1;for(t in this.rows)this.rows[t].data.place=s;for(t=0;t<n.length;t++)if(this.rows[n[t].id])this.rows[n[t].id].data=n[t],this.rows[n[t].id].view.updateParams(n[t]);else{this.dataIcon&&(
n[t].dataIcon=this.dataIcon);var i=cleverapps.clone(n[t]);i.place=s,this.rows[n[t].id]={view:new this.rowConstructor(i),data:n[t]},this.rows[n[t].id].view.setAnchorPoint2(0,.5),this.node.addChild(this.rows[n[t].id].view),this.setupRowPosition(this.rows[n[t].id],i.place)}return this.swapIfNeed(),!0},findPlayerView:function(){for(var e in this.rows)if(this.rows[e].data.player)return this.rows[e].view},ctor:function(e,t,n,s,i){var o;for(i=i||{},this.rows={},this.amountRows=0,this.inSwapAnimation=0,this.startAnimation(),t&&e.length!==t.length&&(t=void 0),e=this.cloneResults(e),t||(t=e),t=this.cloneResults(t),n||(n=cleverapps.Row),this.rowConstructor=n,this.dataIcon=s,o=0;o<t.length;o++)this.dataIcon&&(t[o].dataIcon=this.dataIcon),(t[o].clickableArea=this).rows[t[o].id]={view:new this.rowConstructor(t[o]),data:t[o]},this.amountRows++;var r=cleverapps.styles.TableView;i.styles&&(r=cleverapps.overrideStyles(r,i.styles,!0)),this.styles=r,this._super(),this.setAnchorPoint2()
;var a=this.node=new cc.Node;a.setAnchorPoint2();var c=this.styles.width,l=0;for(o in this.rows)this.rows[o].view.setAnchorPoint2(0,.5),a.addChild(this.rows[o].view),c=this.rows[o].view.width,l=this.rows[o].view.height,this.setupRowPosition(this.rows[o],this.rows[o].data.place);l=this.amountRows*l+(this.amountRows-1)*r.margin+2*r.innerPadding,a.setContentSize2(c+2*r.innerPadding,l);var p=0,d=r.height+2*r.innerPadding;l<=d&&(p=d-l),this.scroll=new cleverapps.UI.ScrollView(a,{childrenVisibility:cleverapps.UI.ScrollView.CHILDREN_VISIBILITY_NONE,containerMovedListener:this.createListener(this.setRowsVisibility.bind(this))}),this.scroll.setContentSize2(a.width,0===p?d:l+1),this.scroll.setBarPadding(r.barPadding),0===p&&this.scroll.scrollTo(this.findPlayerView()),this.scroll.setAnchorPoint2(0,0),this.scroll.setPosition(r.padding,r.padding+p),this.setContentSize2(this.scroll.width+2*r.padding,d+2*r.padding),this.addChild(this.scroll),r.bg&&(this.bg=new cc.Scale9Sprite(r.bg),this.addChild(
this.bg),this.bg.setContentSize2(this.getContentSize()),this.bg.setPositionRound(this.width/2,this.height/2),this.bg.setLocalZOrder(-1)),this.runAction(new cc.Sequence(new cc.DelayTime(.7),new cc.CallFunc(this.finishAnimation.bind(this)))),this.updateResults(e),this.setRowsVisibility()}}),cleverapps.styles.TableView={bg:bundles.main.frames.light_bg_png,width:500,height:732,margin:4,padding:6,innerPadding:6,barPadding:{cornerPadding:20,sidePadding:5}};var DialoguePersonTitleView=cc.Scale9Sprite.extend({ctor:function(){var e=cleverapps.styles.DialoguePersonTitleView;this._super(e.image),this.originalSize=this.getContentSize();var t=this.titleText=cleverapps.UI.generateOnlyText("",cleverapps.styles.FONTS.DIALOGUE_PERSON_TITLE_TEXT);t.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER),this.addChild(t),this.setAnchorPoint2(),this.setCascadeOpacityEnabled(!0),this.setOpacity(0),this.setVisible(!1)},updateString:function(e){var t=cleverapps.styles.DialoguePersonTitleView.text,n=this.titleText
;n.setString(e),n.setFontSize(cleverapps.styles.FONTS.DIALOGUE_PERSON_TITLE_TEXT.size),this.setContentSize2(Math.max(n.width+2*t.padding.x,this.originalSize.width),Math.max(n.height+2*t.padding.y,this.originalSize.height)),n.setPositionRound(this.width/2,this.height/2+t.offset.y)},updatePosition:function(e){var t=cleverapps.styles.DialoguePersonTitleView,n=e.x,s=t.offsetX;n-this.width/2-s<0&&(n=this.width/2+s),n+this.width/2+s>this.parent.width&&(n=this.parent.width-this.width/2-s),this.setPositionRound(n,t.y)},update:function(e,t){this.visible?this.isLeft===t.isLeft&&this.title===e||this.runAction(new cc.Sequence(new cc.FadeOut(.2),new cc.CallFunc(function(){this.updateString(e),this.updatePosition(t.hideHandler.originalPosition)}.bind(this)),new cc.FadeIn(.2))):(this.updateString(e),this.updatePosition(t.hideHandler.originalPosition),this.setVisible(!0),this.runAction(new cc.FadeIn(.2))),this.isLeft=t.isLeft,this.title=e},hide:function(){this.visible&&this.runAction(new cc.Sequence(
new cc.FadeOut(.2),new cc.CallFunc(function(){this.setVisible(!1)}.bind(this))))}});cleverapps.styles.DialoguePersonTitleView={image:bundles.dialogues.frames.dialogue_name,offsetX:0,y:{align:"top",anchor:"center",dy:0},text:{padding:{x:5,y:0},offset:{y:-3}}};var DialoguePersonView=cc.Node.extend({ctor:function(e,t){this._super(),this.isLeft="right"!==e.position,this.setCascadeColorEnabled(!0),this.setAnchorPoint2(.5,0),this.setContentSize2(e.styles);var n=cleverapps.wideMode.mode===cleverapps.WideMode.VERTICAL&&void 0!==e.styles.mobileOffsetX?e.styles.mobileOffsetX:e.styles.offsetX,s=cleverapps.wideMode.mode===cleverapps.WideMode.VERTICAL&&void 0!==e.styles.mobileOffsetY?e.styles.mobileOffsetY:e.styles.offsetY;this.setPositionRound(this.isLeft?this.width/2*this.scale+n:t.width-(this.width/2*Math.abs(this.scaleX)+n),t.height+s);var i=this.personAnimation=new cleverapps.Spine(e.styles.json);i.setAnchorPoint2(.5,0),i.setPositionRound(e.styles.jsonPos),this.addChild(i),
cleverapps.UI.makeHideable(this,cleverapps.UI.HORIZONTAL),t.addChild(this,-1),cleverapps.wideMode.mode===cleverapps.WideMode.VERTICAL?this.setScale(e.styles.mobileScale||cleverapps.styles.DialoguePersonView.mobileScale):this.setScale(e.styles.scale||cleverapps.styles.DialoguePersonView.scale),this.isLeft||0<this.scaleX&&this.setScaleX(-this.scaleX),this.update(e,!0)},update:function(e,t){var n=cleverapps.styles.DialoguePersonView,s=!!this.curState,i=this.curState=e.active;this.setColor(i?cleverapps.styles.COLORS.WHITE:n.tintColor),t&&n.animateCharChange?(this.hide(!0),this.show(!1,.2),i||this.personAnimation.setScale(n.inactive.scale)):s!==this.curState&&(i?(this.personAnimation.setScale(n.inactive.scale),this.personAnimation.runAction(new cc.ScaleTo(.1,1))):this.personAnimation.runAction(new cc.ScaleTo(.1,n.inactive.scale)));var o=e.animation,r=e.idleAnimation?e.idleAnimation:o;this.isSpeaking=i,this.personAnimation.setAnimation(0,i?o:r,!1),this.personAnimation.setCompleteListener(
function(){this.personAnimation.setAnimation(0,this.isSpeaking?o:r,!1)}.bind(this))},finishSpeaking:function(){this.isSpeaking=!1},remove:function(){cleverapps.styles.DialoguePersonView.animateCharChange?(this.hide(),this.runAction(new cc.Sequence(new cc.DelayTime(.2),new cc.RemoveSelf))):this.runAction(new cc.RemoveSelf)}});cleverapps.styles.DialoguePersonView={zOrder:-1,mobileScale:.9,scale:1,inactive:{scale:.8},tintColor:new cc.Color(180,180,180),animateCharChange:!1};var DialogueView=Window.extend({onWindowLoaded:function(e,t){this.options=t||{},this.options.button=this.options.button||{},this.dialogue=e,this.dialogueStyles=this.options.styles||cleverapps.styles.DialogueView;var n=cleverapps.overrideStyles(cleverapps.styles.Window,this.dialogueStyles.Window,!0);n.shadow=this.options.overlay&&!1!==this.options.shadow,n.bgOffset={x:0,y:this.calcYOffset()},this._super({name:"DialogueViewWindow",content:this.generateContent(),closeButton:!1,closeByBackButton:!1,noBackground:!0,
notCloseByTouchInShadow:!0,minHeight:this.dialogueStyles.height,styles:n}),this.startPosition=new cc.p(cleverapps.UI.getSceneSize().width/2,-this.content.height/2-this.dialogueStyles.showUp.y),this.finalPosition=new cc.p(cleverapps.UI.getSceneSize().width/2,this.content.height/2+this.dialogueStyles.offsetY),this.dialogue.options.showUp||this.content.setPositionRound(this.finalPosition),e.on("showUp",this.showUp.bind(this),this),e.on("showPerson",this.showPerson.bind(this),this),e.on("hidePerson",this.hidePerson.bind(this),this),e.on("updatePerson",this.updatePerson.bind(this),this),e.on("updatePersonTitle",this.updatePersonTitle.bind(this),this),e.on("changeText",this.changeText.bind(this),this),e.on("updateButton",this.updateButton.bind(this),this),e.on("finishTyping",this.byLetterAnimationFinish.bind(this),this),e.on("beforeClose",this.close.bind(this),this),cleverapps.audio.playSound(bundles.game.urls.dialogue_effect),e.onBundlesLoaded()},calcYOffset:function(){return-(
cleverapps.UI.getSceneSize().height/2-this.dialogueStyles.height/2+cleverapps.UI.getSceneOffsetY())},generateContent:function(){var t=this.content=new cc.Node;return t.setAnchorPoint2(),t.setContentSize2(cleverapps.UI.getSceneSize().width-2*this.dialogueStyles.widthPadding,this.dialogueStyles.height),cc.eventManager.addListener({event:cc.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:void 0===this.options.swallowTouches||this.options.swallowTouches,onTouchBegan:function(e){return!!(this.options.overlay||this.options.screenClicked||cc.rectContainsPoint(cc.rect(0,0,t.width,t.height),t.convertTouchToNodeSpace(e)))&&(this.dialogue.screenClicked(),!0)}.bind(this)},t),t},showUp:function(){this.content.setPositionRound(this.startPosition),this.content.runAction(new cc.Sequence(new cc.DelayTime(this.options.delay||0),new cc.MoveTo(.2,this.finalPosition.x,this.finalPosition.y+this.dialogueStyles.showUp.offset),new cc.MoveTo(.1,this.finalPosition)))},showPerson:function(e){e.styles||(
e=this.dialogueStyles.persons.default);var t=new DialoguePersonView(e,this.content);t.isLeft?this.leftPersonView=t:this.rightPersonView=t},updatePerson:function(e){("right"===e.position?this.rightPersonView:this.leftPersonView).update(e)},updatePersonTitle:function(e){if(this.personTitle||(this.personTitle=new DialoguePersonTitleView,this.content.addChild(this.personTitle,1)),!e)return this.personTitle.hide(),void(this.textBgArrow&&this.textBgArrow.setVisible(!1));var t="right"!==e.position;e.styles||(e=this.dialogueStyles.persons.default),e.styles.title?this.personTitle.update(e.styles.title,t?this.leftPersonView:this.rightPersonView):this.personTitle.hide();var n=this.dialogueStyles.text.arrow;n&&(this.textBgArrow||(this.textBgArrow=new cc.Sprite(n.img),this.textBg.addChild(this.textBgArrow,n.zOrder||1)),this.textBgArrow.setVisible(!0),this.textBgArrow.setScaleX(t?1:-1),"relative"===n.offsetX?this.textBgArrow.setPositionRound(
t?this.leftPersonView.x+this.leftPersonView.width/2:this.rightPersonView.x-this.rightPersonView.width/2,n.y):this.textBgArrow.setPositionRound(t?n.offsetX:this.content.width-n.offsetX,n.y))},hidePerson:function(e){"right"!==e&&this.leftPersonView&&(this.leftPersonView.remove(),delete this.leftPersonView),"right"===e&&this.rightPersonView&&(this.rightPersonView.remove(),delete this.rightPersonView)},changeText:function(e,t,n){this.textBg||(this.textBg=new cc.Scale9Sprite(bundles.dialogues.frames.bg_png),this.textBg.setContentSize2(this.content.width,this.content.height),this.textBg.setPositionRound(this.content.width/2,this.content.height/2),this.content.addChild(this.textBg)),this.text&&this.text.removeFromParent(),this.text=cleverapps.UI.generateOnlyText(e,this.dialogueStyles.font||cleverapps.styles.FONTS.FORCE_MESSAGE_TEXT),this.text.setHorizontalAlignment(this.dialogueStyles.text.alignment),this.text.setAnchorPoint2(.5,1),this.content.addChild(this.text,1)
;var s=this.dialogueStyles.text,i=this.content.width-s.padding.fromWallX,o=s.padding.x;t&&(i=this.content.width-s.padding.x,o=s.padding.fromWallX);var r=this.content.height-s.padding.y,a=1,c=i-o,l=r-((this.button&&this.button.visible?this.button.y+this.button.height/2:0)+s.padding.y);c>s.optimization.width&&(c/=a=1.5,l/=a,this.text.setFontSize(Math.round(this.text.getFontSize()/a))),this.text.setDimensions(c,0),this.text.fitToHeight(l),this.text.setScale(this.text.getScale()*a),this.text.setPositionRound((o+i)/2,r),this.text.byLetterAnimation({callback:n})},updateButton:function(e,t){e=!this.options.button.noButton&&e,!this.button&&e&&(this.button=new cleverapps.UI.Button({width:this.dialogueStyles.button.width,height:this.dialogueStyles.button.height,button_png:this.dialogueStyles.button.button_png,button_on_png:this.dialogueStyles.button.button_png_on,text:this.options.button.text||Messages.get("Next"),font:cleverapps.styles.FONTS.BUTTON_SMALL_TEXT,onClicked:function(){
this.dialogue.buttonClicked()}.bind(this),noThrottle:!0,padding:this.dialogueStyles.button.padding}),this.button.setPositionRound(this.content.width-(this.button.width/2+this.dialogueStyles.button.offset.x),this.button.height/2+this.dialogueStyles.button.offset.y),this.content.addChild(this.button,1)),this.button&&(this.button.visible=e,t&&this.button.text.setString(Messages.get("OK")))},close:function(){this.byLetterAnimationFinish(),this.content.stopAllActions(),this.dialogue.options.showUp?this.content.runAction(new cc.Sequence(new cc.DelayTime(.3),new cc.MoveTo(.15,cc.p(this.content.x,this.content.y+this.dialogueStyles.showUp.offset)),new cc.MoveTo(.15,this.startPosition),new cc.CallFunc(function(){Window.prototype.close.apply(this,arguments),this.dialogue.finishClose()}.bind(this)),new cc.RemoveSelf)):(this._super(),this.dialogue.finishClose())},byLetterAnimationFinish:function(){this.text&&this.text.byLetterAnimationFinish(),[this.leftPersonView,this.rightPersonView].forEach(
function(e){e&&e.finishSpeaking()})},listBundles:function(e){return e.bundlesToLoad}});cleverapps.styles.DialogueView={height:280,widthPadding:0,offsetY:20,showUp:{y:100,offset:75},button:{width:160,height:60,button_png:bundles.buttons_main.frames.small_green_button,button_png_on:bundles.buttons_main.frames.small_green_button_on,padding:{x:10},offset:{x:30,y:30}},text:{alignment:cc.TEXT_ALIGNMENT_LEFT,arrow:!1,padding:{fromWallX:30,x:30,y:30},optimization:{width:1e3}},persons:{default:{animation:"animation",position:"left",styles:{json:bundles.dialogues.jsons.default_json,width:350,height:300,offsetX:25,offsetY:0,jsonPos:{x:{align:"center"},y:{align:"center"}}}}},Window:{noWindowScale:!0,windowShowUpAnimation:!1}};var MinimalDialogue=cc.Node.extend({ctor:function(e){this._super(),this.options=e||{},this.setAnchorPoint2(),this.setLocalZOrder(20),this.shown=!0,cleverapps.bundleLoader.loadBundle("dialogues_minimal",{onSuccess:this.createListener(this.onLoaded.bind(this)),blocked:!0})},
onLoaded:function(){this.createContent(),this.calculatePosition(),this.showUp()},createContent:function(){var e=cleverapps.styles.MinimalDialogue,t=this.options.person||e.persons.default,n=Math.min(e.maxWidth,cleverapps.UI.getSceneSize().width-e.widthPadding);(!1===this.options.person||!1===t&&cleverapps.wideMode.mode!==cleverapps.WideMode.VERTICAL)&&(n-=e.person.width);var s=e.height;cleverapps.wideMode.mode===cleverapps.WideMode.VERTICAL&&(s=e.verticalHeight);var i=n-e.text.padding.fromWallX,o=cleverapps.wideMode.mode===cleverapps.WideMode.VERTICAL?e.text.padding.verticalX:e.text.padding.x;!1!==this.options.person&&(o+=t.styles.width/2+e.person.offsetX+e.person.width/2),this.text=cleverapps.UI.generateOnlyText(this.options.text,e.font||cleverapps.styles.FONTS.FORCE_MESSAGE_TEXT),this.text.setHorizontalAlignment(e.text.alignment),this.text.setDimensions(i-o,0),this.text.fitTo(void 0,s-e.text.padding.y);var r=Math.max(this.text.height,!1!==this.options.person?e.person.height:0
)+e.text.padding.y;if(this.setContentSize2(n,r),!1!==this.options.person){var a=new cc.Node;a.setAnchorPoint2(),a.setCascadeColorEnabled(!0),a.setContentSize2(e.person),a.setPositionRound(t.styles.width/2+e.person.offsetX,this.height/2+e.person.offsetY),this.personAnimation=new cleverapps.Spine(t.styles.minimalJson||bundles.dialogues_minimal.jsons.dialogue_minimal_json),this.personAnimation.setPositionRound(a.width/2,a.height/2),a.addChild(this.personAnimation),this.addChild(a,e.person.zOrder)}if(this.textBg=cleverapps.UI.createScale9Sprite(bundles.dialogues_minimal.frames.bg_minimal_png,cleverapps.UI.Scale9Rect.TwoPixelXY),this.textBg.setCascadeOpacityEnabled(!0),this.textBg.setContentSize2(this.text.width+2*e.text.bg.padding.x,this.text.height+2*e.text.bg.padding.y),this.textBg.setPositionRound((o+i)/2-e.text.bg.offsetX,this.height/2),this.textBg.setCascadeOpacityEnabled(!0),this.textBg.setOpacity(0),this.addChild(this.textBg),this.text.setPositionRound(this.textBg.width/2,
this.textBg.height/2-e.text.bg.offsetY),this.text.setOpacity(0),this.textBg.addChild(this.text),e.text.arrow){this.textBgArrow=new cc.Sprite(e.text.arrow.img),this.textBgArrow.setScaleX("right"===t.position?-1:1);var c="right"===t.position?this.textBg.width-e.text.arrow.offsetX:e.text.arrow.offsetX;this.textBgArrow.setPositionRound(c,e.text.arrow.y),this.textBg.addChild(this.textBgArrow,e.text.arrow.zOrder||1)}this.setVisible(!1)},calculatePosition:function(){var e=cleverapps.UI.getSceneSize(),t=cleverapps.styles.MinimalDialogue;if(this.options.forcePosition)this.options.forcePosition===Dialogue.POSITIONS.TOP?this.setPositionRound(e.width/2,e.height-this.height/2-t.positions.top.y):this.options.forcePosition===Dialogue.POSITIONS.TOP_LOWER?this.setPositionRound(e.width/2,e.height-this.height/2-t.positions.topLower.y):this.options.forcePosition===Dialogue.POSITIONS.BOTTOM?this.setPositionRound(e.width/2,this.height/2+t.positions.bottom.y
):this.options.forcePosition===Dialogue.POSITIONS.CENTER&&this.setPositionRound(e.width/2,e.height/2);else if(this.options.rects&&this.options.rects.length){if(!this.calcDynamicPosition()){var n=cc.view.getFrameSize(),s="Could not position minimal dialog with text: "+this.options.text+", screen size: "+n.width+" by "+n.height;cleverapps.ErrorHandler.logError(s)}}else this.setPositionRound(e.width/2,this.height/2+t.positions.bottom.y)},calcDynamicPosition:function(){for(var t=cleverapps.styles.MinimalDialogue.targetOffset,e=this.options.rects.map(function(e){return cc.rect(e.x-t,e.y-t,e.width+2*t,e.height+2*t)}.bind(this)),n=function(e){var t=cleverapps.UI.getSceneOffsetY(),n=cleverapps.UI.getSceneSize();return cc.p(Math.max(this.width/2,Math.min(e.x,n.width-this.width/2)),Math.max(-t+this.height/2,Math.min(e.y,n.height+t-this.height/2)))}.bind(this),s=cc.director.getRunningScene().scene,i=this.options.parent||s,o=Number.MAX_VALUE,r=0,a=[],c=0;c<e.length;c++)for(var l=e[c],p=[{
x:l.x-this.width/2,y:l.y+l.height/2},{x:l.x+l.width+this.width/2,y:l.y+l.height/2},{x:l.x+l.width/2,y:l.y+l.height+this.height/2},{x:l.x+l.width/2,y:l.y-this.height/2}],d=0;d<p.length;d++){var u=n(p[d]),h=i.convertToNodeSpace(s.convertToWorldSpace(u));this.setPositionRound(h),a.push(h);var g=0,v=0;if(e.forEach(function(e){var t=cc.rectIntersection(this.getGlobalBoundingBox(void 0,i),e);v=Math.max(v,Math.min(t.width,t.height));var n=(0<t.width?t.width:0)*(0<t.height?t.height:0);g<n&&(g=n)},this),v<=2)return!0;g<o&&(o=g,r=c*p.length+d)}return this.setPositionRound(a[r]),!1},showUp:function(){this.runAction(new cc.Sequence(new cc.DelayTime(this.options.delay||.5),new cc.Show,new cc.CallFunc(function(){cleverapps.audio.playSound(bundles.game.urls.dialogue_effect),this.personAnimation&&this.personAnimation.setAnimationAndIdleAfter("minimal_showup","talk_minimal"),this.textBg.runAction(new cc.Sequence(new cc.FadeIn(.3),new cc.CallFunc(function(){this.text.runAction(new cc.FadeIn(.6))}.bind(
this))))}.bind(this))))},hide:function(e){this.shown&&(this.personAnimation&&(this.personAnimation.setAnimation(0,"minimal_hide",!1),this.personAnimation.setCompleteListenerRemove()),this.textBg.runAction(new cc.FadeOut(.3)),this.runAction(new cc.Sequence(new cc.DelayTime(.6),new cc.CallFunc(function(){this.removeFromParent(),cleverapps.bundleLoader.deleteBundle("dialogues_minimal"),e&&e()}.bind(this)))),this.shown=!1)}});cleverapps.styles.MinimalDialogue={height:320,verticalHeight:450,maxWidth:1e3,widthPadding:0,targetOffset:30,person:{height:240,width:240,zOrder:-1,offsetX:25,offsetY:0},text:{alignment:cc.TEXT_ALIGNMENT_CENTER,width:500,padding:{fromWallX:30,verticalX:40,x:80,y:60},arrow:{img:bundles.dialogues_minimal.frames.arrow_minimal_png,y:{align:"center"},offsetX:-7},bg:{offsetX:0,offsetY:-4,padding:{x:20,y:20}}},positions:{topLower:{y:200},top:{y:100},bottom:{y:20}},skip:{x:{align:"right",dx:-30},y:{align:"bottom",dy:20},width:100,height:50},
persons:cleverapps.styles.DialogueView.persons};var ProlongationWindow=Window.extend({onWindowLoaded:function(e,t){if(!Game.currentGame)return!1;this.prolongation=e,this.price=e.getCoinsPrice(),this.moves=e.getAmountByCoins(),this.giveUpAlert=e.getGiveUpAlert(),0<this.price&&this.prolongation.addProlongation(),this.onCancel=t;var n=this.content=new cc.Node;n.setLocalZOrder(2),n.setAnchorPoint(.5,.5);var s=cleverapps.styles.ProlongationWindow,i=s.width,o=this.prolongation.countOfGoals&&this.prolongation.countOfGoals();if(o){var r=3===o&&cleverapps.wideMode.mode!==cleverapps.WideMode.VERTICAL;i=s.wider.width}n.setContentSize2(i,s.height);var a=cleverapps.UI.generateTTFText("messages:ProlongationWindow.addMoves",cleverapps.styles.FONTS.ADD_MOVES_QUESTION_TEXT||cleverapps.styles.FONTS.WINDOW_TEXT);n.addChild(a),a.setPositionRound(s.question),o&&this.createGoalsViews(o<3||r),this.prolongation.on("addMoves",this.createListener(this.onAddMoves.bind(this)));var c=cleverapps.once(function(e){
void 0===e.delay&&(e.delay=s.addMoves.delay),this.prolongation.addMoves(e)}.bind(this)),l=function(){this.giveUpAlert.onTakeMoves(),levels.user.takeGold(this.price)&&(c({moves:this.moves,goldUsed:!0,price:this.price}),l=function(){})}.bind(this);this.coinProlongButton=new CoinProlongButton(this.moves,this.price,cleverapps.styles.FONTS.ADDMOVES_PRICE,l);var p=[this.coinProlongButton];this.price&&!cleverapps.flags.nopayments&&(this.productProlongButton=new ProductProlongButton(this.prolongation.getProduct(),c),p.push(this.productProlongButton)),this.price&&"undefined"!=typeof BreakView&&BreakView.AddBreakViews(n,this.viewsLayout?[this.viewsLayout]:[a],cleverapps.styles.ProlongationWindow.breakView.y);var d=cleverapps.overrideStyles(cleverapps.styles.Window,cleverapps.styles.ProlongationWindow,!0);this._super({title:Messages.get("ProlongationWindow.title"),name:"prolongationwindow",content:n,buttons:p,styles:d,closeButton:0<this.price,notCloseByTouchInShadow:!0}),this.closeButton&&(
this.closeButton.settings.onClicked=this.giveUp.bind(this)),cleverapps.audio.playSound(bundles.game.urls.lose_effect);var u=cleverapps.windows.list.filter(function(e){return"confirmexitwindow"===e.name});0!==u.length&&u[0]&&u[0].close(),cleverapps.eventLogger.logEvent(cleverapps.EVENTS.MOVES_SHOW),this.scheduleUpdate(),s.hero&&(this.hero=new cleverapps.Spine(s.hero.json,1),this.hero.setAnimation(0,s.hero.animation,!0),this.hero.setPositionRound(s.hero),this.addChild(this.hero))},giveUp:function(){this.giveUpAlert.canShow()?this.giveUpAlertShow():(this.close(),this.onCancel())},giveUpAlertShow:function(){var e=cleverapps.styles.ProlongationWindow.alert,t=new GiveUpAlertView(this.giveUpAlert,{size:e.size,position:e.position});this.content.addChild(t);var n=this.window.convertToNodeSpace(t.getParent().convertToWorldSpace(t.getPosition()));this.closeButton.y-e.distToClose.height<n.y+t.height/2&&(this.addHeight=n.y+t.height/2-this.closeButton.y+e.distToClose.height)},onShow:function(){
this.goldInfo&&this.goldInfo.showUp(),this.productProlongButton&&this.productProlongButton.startAnimate(),this.coinProlongButton&&this.coinProlongButton.startAnimate()},onHide:function(){this.productProlongButton&&this.productProlongButton.stopAnimate(),this.coinProlongButton&&this.coinProlongButton.stopAnimate(),this.goldInfo&&this.goldInfo.onHide()},onClose:function(){this.goldInfo&&this.goldInfo.close(),this.finger&&this.finger.removeFromParent(!0),this.onCancel()},onAddMoves:function(e){this.onCancel=function(){},this.onAddMovesAnimation&&this.onAddMovesAnimation(e.moves),this.hint&&this.hint.close(),this.close()},listBundles:function(){return["prolongation_window"]},update:function(e){this._super(e);var t=cleverapps.styles.ProlongationWindow.alert.delta;0<this.addHeight&&(this.addHeight-=t,this.bg.setContentSize(this.bg.width,this.bg.height+t),this.bg.setPosition(this.bg.x,this.bg.y+t/2),this.window.titleText.setPosition(this.window.titleText.x,this.window.titleText.y+t),
this.closeButton.setPosition(this.closeButton.x,this.closeButton.y+t),this.onChangeBackground(this.window))}});cleverapps.styles.ProlongationWindow={y:294,width:720,height:270,wider:{width:780},addMoves:{delay:700},question:{x:{align:"center"},y:200},buttons:{x:70,phone:50},breakView:{y:50},goals:{scale:!1},alert:{}};var Prolongation=function(e){cleverapps.EventEmitter.call(this),this.game=e,this.counter=0,this.free=!1};Prolongation.prototype=Object.create(cleverapps.EventEmitter.prototype),(Prolongation.prototype.constructor=Prolongation).prototype.getCoinsPrice=function(){return this.free?0:0===this.counter&&(this.isWhale()||500<levels.user.gold)?250:cleverapps.config.prices.prolongations[this.counter]},Prolongation.prototype.updateFree=function(e){this.free=e},Prolongation.prototype.getAmountByCoins=function(){var e=5;return!this.free&&0===this.counter&&(this.isWhale()||500<levels.user.gold)&&(e=10),e},Prolongation.prototype.isWhale=function(){
return cleverapps.paymentsHistory.classify()===cleverapps.PaymentsHistory.PAYER_BIGWHALE||cleverapps.paymentsHistory.classify()===cleverapps.PaymentsHistory.PAYER_WHALE},Prolongation.prototype.addProlongation=function(){this.counter++,this.counter>=cleverapps.config.prices.prolongations.length&&(this.counter=cleverapps.config.prices.prolongations.length-1)},Prolongation.prototype.getProduct=function(){var e=Prolongation.PRODUCTS[0];switch(cleverapps.paymentsHistory.classify()){case cleverapps.PaymentsHistory.PAYER_NORMAL:e=Prolongation.PRODUCTS[1];break;case cleverapps.PaymentsHistory.PAYER_WHALE:e=Prolongation.PRODUCTS[2];break;case cleverapps.PaymentsHistory.PAYER_BIGWHALE:e=Prolongation.PRODUCTS[3]}return Product.Create(e)},Prolongation.prototype.getGiveUpAlert=function(){var e=this.game.gameMission,t=cleverapps.missionManager.getRunningMission(Missions.SEMAPHORE_LANTERN)&&cleverapps.missionManager.getRunningMission(Missions.SEMAPHORE_LANTERN).logic.lantern,
n=this.game.getPercentOfCompletion(),s=this.game.rewards[GameBase.REWARD_GOLD],i=void 0;return this.game.collectedBoosterCell?i=Prolongation.GIVE_UP_TYPES.BOOSTER:t&&t.isActive(this.game.level)&&0<t.getCurrentStreak()?i=Prolongation.GIVE_UP_TYPES.LANTERN:e&&e.isRunning()&&0<this.game.rewards.clover?i=Prolongation.GIVE_UP_TYPES.MISSION:s&&s>this.game.basicGoldReward?i=Prolongation.GIVE_UP_TYPES.GOLD_COLLECTED:.85<=n&&(i=Prolongation.GIVE_UP_TYPES.NEARLY),new GiveUpAlert(i)},Prolongation.prototype.addMoves=function(t){if(t.goldUsed&&(cleverapps.eventLogger.logEvent(cleverapps.EVENTS.HINT_USED,{amount:t.price}),cleverapps.eventLogger.logEvent(cleverapps.EVENTS.MOVES_BOUGHT+"_"+t.price)),cleverapps.history.add("moves",t.moves),this.trigger("addMoves",t),Game.currentGame){var n=Game.currentGame;n.hand&&n.hand.extra.hide(),n.counter.setTimeout(function(){if(n.hand?n.hand.addExtra(t.moves,t.bonus):n.setMoves(t.moves),n.score&&n.score.addBuyMoves(),t.bonus&&"match3"===cleverapps.config.type
)for(var e=0;e<t.bonus;e++)n.field.addRandomMulticolor()},t.delay||700)}},Prolongation.GIVE_UP_TYPES={BOOSTER:0,LANTERN:1,MISSION:2,GOLD_COLLECTED:3,NEARLY:4},Prolongation.PRODUCTS=["addMoves1","addMoves2","addMoves3","addMoves5"];var GiveUpAlert=function(e){cleverapps.EventEmitter.call(this),this.type=e,this.viewExists=!1};GiveUpAlert.prototype=Object.create(cleverapps.EventEmitter.prototype),(GiveUpAlert.prototype.constructor=GiveUpAlert).prototype.getMessage=function(){switch(this.type){case Prolongation.GIVE_UP_TYPES.BOOSTER:return"messages:AddMovesWindow.boosterGiveUp";case Prolongation.GIVE_UP_TYPES.MISSION:return"messages:AddMovesWindow.missionGiveUp."+Game.currentGame.gameMission.getName();case Prolongation.GIVE_UP_TYPES.LANTERN:return"messages:AddMovesWindow.lanternGiveUp";case Prolongation.GIVE_UP_TYPES.GOLD_COLLECTED:return"messages:AddMovesWindow.goldCollectedGiveUp";case Prolongation.GIVE_UP_TYPES.NEARLY:return"messages:AddMovesWindow.nearlyDoneGiveUp"}return""},
GiveUpAlert.prototype.onTakeMoves=function(){this.viewExists&&!this.takeMovesLogged&&(this.takeMovesLogged=!0,this.type===Prolongation.GIVE_UP_TYPES.NEARLY?cleverapps.eventLogger.logEvent(cleverapps.EVENTS.GIVEUP_CHANGE_NEARLY):void 0!==this.type&&cleverapps.eventLogger.logEvent(cleverapps.EVENTS.GIVEUP_CHANGE))},GiveUpAlert.prototype.canShow=function(){return void 0!==this.type&&!this.viewExists&&Game.currentGame&&Game.currentGame.outcome===GameBase.OUTCOME_UNKNOWN},GiveUpAlert.prototype.onShow=function(){this.viewExists||(this.viewExists=!0,this.type===Prolongation.GIVE_UP_TYPES.NEARLY?cleverapps.eventLogger.logEvent(cleverapps.EVENTS.GIVEUP_ATTENTION_NEARLY):this.type===Prolongation.GIVE_UP_TYPES.MISSION?cleverapps.eventLogger.logEvent(cleverapps.EVENTS.GIVEUP_MISSION):void 0!==this.type&&cleverapps.eventLogger.logEvent(cleverapps.EVENTS.GIVEUP_ATTENTION))};var GiveUpAlertView=cc.Node.extend({ctor:function(e,t){this._super(),this.giveUpAlert=e,this.giveUpAlert.onShow()
;var n=cleverapps.styles.GiveUpAlertView,s=cleverapps.UI.createScale9Sprite(n.bg.image,cleverapps.UI.Scale9Rect.TwoPixelXY);s.setContentSize2(t.size),s.setLocalZOrder(-1),this.setContentSize2(s.width,s.height),this.setAnchorPoint2(),s.setPositionRound(this.width/2,this.height/2),this.addChild(s),this.setCascadeOpacityEnabled(!0),this.setPositionRound(t.position);var i=cleverapps.UI.generateTTFText(e.getMessage(),cleverapps.styles.FONTS.LEVEL_TUTORIAL_TEXT);i.setCascadeOpacityEnabled(!0),i.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER),i.setVerticalAlignment(cc.TEXT_ALIGNMENT_CENTER),i.setDimensions(this.width+n.text.padding[cleverapps.wideMode.mode].x,0),i.fitTo(void 0,this.height),i.setPositionRound(n.text),this.addChild(i),this.showUp(),cleverapps.audio.playSound(bundles.game.urls.bubble_effect)},showUp:function(){this.setOpacity(0),this.runAction(new cc.Sequence(new cc.DelayTime(.3),new cc.FadeIn(.2),new cc.CallFunc(function(){var e=this.getScale();this.runAction(
new cc.RepeatForever(new cc.Sequence(new cc.ScaleTo(.5,1.05*e),new cc.ScaleTo(.5,e))))}.bind(this))))}});cleverapps.styles.GiveUpAlertView={bg:{image:bundles.main.frames.speak_bg_png},text:{x:{align:"center",dx:30},y:{align:"center",dy:0},padding:[{x:-50},{x:-50},{x:-50}]}};var ProductProlongButton=cleverapps.UI.Button.extend({ctor:function(e,t){var n=cleverapps.styles.ProductProlongButton;this.product=e,this._super({content:this.getButtonContent(),onClicked:function(){this.product.buy(function(){t({moves:e.moves,bonus:e.bonus})})}.bind(this),width:n.width,height:n.height}),this.baseScale=n.scale,this.setScale(this.baseScale);var s=new ProductPriceView(this.product,{font:cleverapps.styles.FONTS.ADDMOVES_PRICE,iconScale:n.okPrice.scale,offsetY:n.okPrice.offsetY});s.setPositionRound(this.width/2,n.price.y),this.addChild(s),Lottery.addIcon(this)},startAnimate:function(){this.setScale(0),this.runAction(new cc.Sequence(new cc.DelayTime(.4),new cc.ScaleTo(.5,this.baseScale).easing(
cc.easeBackOut())))},stopAnimate:function(){this.stopAllActions(),this.setScale(this.baseScale)},getButtonContent:function(){var e=new cc.Node;e.setAnchorPoint(.5,.5);var t=cleverapps.styles.ProductProlongButton.content,n=cleverapps.UI.generateImageText(this.product.moves,cleverapps.styles.FONTS.BUTTON_TEXT);e.addChild(n);var s=new cc.Sprite(bundles.moves.frames.game_moves_icon);if(s.setScale(t.moves.scale),s.setPositionRound(t.moves),e.addChild(s),this.product.bonus){var i=cleverapps.UI.generateImageText("+",cleverapps.styles.FONTS.BUTTON_TEXT);e.addChild(cleverapps.UI.wrapWithPadding(i,t.plus));var o=new cc.Node;o.setAnchorPoint2(.5,.5);for(var r=0;r<this.product.bonus;r++){var a=new cc.Sprite(t.bonus.image);a.setScale(t.bonus.scale),o.addChild(a)}cleverapps.UI.arrangeWithMargins(o.children,{margin:t.bonus.margin,direction:cleverapps.UI.HORIZONTAL}),cleverapps.UI.wrap(o),e.addChild(o),o.setPositionRound(t.bonus)}return cleverapps.UI.arrangeWithMargins(e.children,{margin:t.x,
direction:cleverapps.UI.HORIZONTAL}),cleverapps.UI.wrap(e),e.setAnchorPoint2(),e}});cleverapps.styles.ProductProlongButton={width:350,height:100,scale:1,price:{y:120},content:{x:0,bonus:{image:bundles.game.frames.cell_multicolor,scale:.5,margin:0,x:0,y:0},moves:{scale:1,x:0,y:0},plus:{x:15,y:0}},okPrice:{scale:.6,offsetY:0}};var CoinProlongButton=cleverapps.UI.Button.extend({ctor:function(e,t,n,s){var i=cleverapps.styles.CoinProlongButton;this.amount=e,this.price=t,this.font=n,this._super({content:this.getButtonContent(),width:i.width,height:i.height,onClicked:s}),this.baseScale=i.scale,this.addChild(this.getPriceContent())},startAnimate:function(){cleverapps.UI.removeHover(this),this.setScale(0),this.runAction(new cc.Sequence(new cc.DelayTime(.4),new cc.ScaleTo(.5,cleverapps.styles.CoinProlongButton.scale).easing(cc.easeBackOut()),new cc.CallFunc(function(){cleverapps.UI.applyHover(this)}.bind(this))))},stopAnimate:function(){this.stopAllActions(),this.setScale(
cleverapps.styles.CoinProlongButton.scale)},getButtonContent:function(){var e=cleverapps.styles.CoinProlongButton,t=new cc.Node;t.setAnchorPoint(.5,.5);var n=cleverapps.UI.generateImageText(this.amount,cleverapps.styles.FONTS.BUTTON_TEXT);t.addChild(n);var s=new cc.Sprite(bundles.moves.frames.game_moves_icon);return s.setScale(e.content.moves.scale),s.setPositionRound(e.content.moves),t.addChild(s),cleverapps.UI.arrangeWithMargins(t.children,{direction:cleverapps.UI.HORIZONTAL,margin:e.content.margin}),cleverapps.UI.wrap(t),t.setAnchorPoint2(),t},getPriceContent:function(){var e=new cc.Node;e.setAnchorPoint(.5,.5);var t=cleverapps.styles.CoinProlongButton,n=new cc.Sprite(bundles.menubar.frames.coin_png);n.setScale(t.content.coin.scale),e.addChild(n);var s=cleverapps.UI.generateOnlyText(0===this.price?"messages:FREE":this.price,this.font);return s.setDimensions(0,t.height),s.setVerticalAlignment(cc.TEXT_ALIGNMENT_CENTER),e.addChild(s),cleverapps.UI.arrangeWithMargins(e.children,{
margin:t.content.x,direction:cleverapps.UI.HORIZONTAL}),cleverapps.UI.wrap(e),e.setPositionRound(this.width/2,t.content.coin.y),e}});cleverapps.styles.CoinProlongButton={width:300,height:100,content:{x:10,margin:0,coin:{scale:.6,y:130},moves:{scale:1,x:0,y:0}},scale:.9};var RewardElementView=cc.Node.extend({ctor:function(e,t,n){this._super(),this.game=e.game;var s=cleverapps.styles.UI.RewardElementView;if(this.setLocalZOrder(s.zIndex),s.background){var i=s.background[cleverapps.wideMode.mode];i.image=bundles.reward_element.frames.reward_element_bg_png,this.bg=cleverapps.UI.createSprite(i),i.x&&this.bg.setPositionRound(i),this.addChild(this.bg),cleverapps.styles.COLORS.HARD&&this.game.level.isHard()&&this.bg.setColor(cleverapps.styles.COLORS.HARD)}if(this.icon=n.icon,this.icon.baseScale=s.image.scale,this.icon.setScale(this.icon.baseScale),s[n.name]&&s[n.name].icon?this.icon.setPositionRound(s[n.name].icon.x,s[n.name].icon.y):this.icon.setPositionRound(s.icon.x,s.icon.y),this.addChild(
this.icon),this.text=cleverapps.UI.generateImageText(this.getText(this.game.rewards[n.reward]||0),cleverapps.styles.FONTS.REWARD_ELEMENT_TEXT),s[n.name]&&s[n.name].color&&this.text.setColor(s[n.name].color),s.amountBg){var o=new cc.Sprite(s.amountBg.image);this.addChild(o),o.setPositionRound(s.text.x,s.text.y)}this.text.baseScale=this.text.scale,this.text.setPositionRound(s.text.x,s.text.y),this.addChild(this.text);var r=s.scale[cleverapps.wideMode.mode];this.setScale(r),this.setContentSize2(s.width,s.height),t.addChild(this);var a=s;if(a[n.name]&&a[n.name].position&&(a=a[n.name].position),a.positions)a=a.positions,Array.isArray(a)&&(a=a[cleverapps.wideMode.mode]),Array.isArray(a)&&(a=a[this.game.goals.amountGoals-1]),this.setPositionRound(a.x,a.y);else{var c=a.margin[cleverapps.wideMode.mode],l=cleverapps.UI.getSceneSize(),p="right"===c.align?l.width:"center"===c.align?l.width/2:0;this.setPositionRound(p+c.x,c.y)}var d=new cc.Node;t.addChild(d),d.setPositionRound(
this.x+s.targetPosition.offset.x,this.y),d.registerTarget(cleverapps.styles.UI.RewardElementView,n.targetName),-1!==["board","solitaire","differences"].indexOf(cleverapps.config.type)&&(cleverapps.UI.makeHideable(this,cleverapps.UI.HORIZONTAL),cleverapps.metha.registerControl(n.control,function(e){cleverapps.wideMode.mode===cleverapps.WideMode.VERTICAL&&e||this.toggle(e)}.bind(this)),cleverapps.wideMode.mode===cleverapps.WideMode.VERTICAL&&(e.groupToggler.addToGroup(this,this.getGroupName()),this.hide()))},getText:function(e){return e+""},getGroupName:function(){return"rewardElements"}});RewardElementView.rotateAnimation=function(e,t){e.text.setString(e.getText(t)),0===e.icon.getRotation()&&e.icon.runAction(new cc.Sequence(new cc.Spawn(new cc.Sequence(new cc.ScaleTo(.2,1.2*e.icon.baseScale),new cc.ScaleTo(.2,e.icon.baseScale)),new cc.RotateBy(.4,360)),new cc.CallFunc(function(){e.icon.setRotation(0)}))),e.text.stopAllActions(),e.text.runAction(new cc.Sequence(new cc.ScaleTo(.2,
1.5*e.text.baseScale),new cc.ScaleTo(.2,e.text.baseScale)))},RewardElementView.growAnimation=function(e,t){e.icon.stopAllActions(),e.icon.setScale(e.icon.baseScale),e.icon.runAction(new cc.Sequence(new cc.ScaleTo(.15,1.3*e.icon.baseScale),new cc.ScaleTo(.15,e.icon.baseScale)));var n=e.text.baseScale;e.text.stopAllActions(),e.text.setScale(n),e.text.runAction(new cc.Sequence(new cc.ScaleTo(.15,1.8*n),new cc.CallFunc(function(){e.text.setString(e.getText(t))}),new cc.ScaleTo(.15,n)))},cleverapps.overrideStyles(cleverapps.styles.FONTS,{REWARD_ELEMENT_TEXT:{name:"default",size:40}}),cleverapps.styles.UI.RewardElementView={zIndex:0,image:{scale:1.4},text:{y:0,x:0},icon:{x:0,y:0},amountBg:!1,scale:[.6,1,.7],width:100,height:100,margin:[{x:40,y:40},{x:-124,y:100,align:"right"},{x:340,y:58}],TulpanTournament:{icon:{x:0,y:26}},targetPosition:{offset:{x:0}}};var RewardGoldView=RewardElementView.extend({ctor:function(e,t){var n,s=e.game
;n=cleverapps.styles.UI.RewardElementView.missionIconAnimated?new CoinMarkView(new Mark("coin"),{counter:!0}):new cc.Sprite(bundles.menubar.frames.coin_png),this._super(e,t,{name:"gold",targetName:"rewardGoldViewTarget",icon:n,reward:GameBase.REWARD_GOLD,control:"rewardElementGold"}),s.onGoldRewardAdded=function(){this.hide&&cleverapps.wideMode.mode===cleverapps.WideMode.VERTICAL&&!cleverapps.styles.UI.RewardElementView.chest?e.groupToggler.show(this,this.getGroupName(),this.runCollectAnimation.bind(this)):this.runCollectAnimation()}.bind(this),cleverapps.tooltipManager.create(this.bg||this.icon,{text:"messages:RewardGoldTooltip",position:cleverapps.styles.UI.Tooltip.LOCATION.below,hideHandler:this.hideHandler})},runCollectAnimation:function(){RewardElementView.growAnimation(this,this.game.rewards[GameBase.REWARD_GOLD]),cleverapps.audio.playSound(bundles.main.urls.shop_buy_effect)}});cleverapps.UI.GroupToggler=function(e){this.game=e,this.groups={}},
cleverapps.UI.GroupToggler.prototype.addToGroup=function(e,t){this.groups[t]||(this.groups[t]=[]),this.groups[t].push(e)},cleverapps.UI.GroupToggler.prototype.show=function(e,t,n){for(var s=0;s<this.groups[t].length;s++)this.groups[t][s]!==e&&this.groups[t][s].hide();e.showForDuration(n)};var BaseGame=function(){cleverapps.EventEmitter.call(this),this.running=!0,this.paused=!1};BaseGame.prototype=Object.create(cleverapps.EventEmitter.prototype),(BaseGame.prototype.constructor=BaseGame).prototype.pause=function(){this.paused=!0},BaseGame.prototype.resume=function(){this.paused=!1,this.trigger("resumed")},BaseGame.prototype.getName=function(){return""},BaseGame.prototype.finish=function(e){e=e||{},this.running&&(this.running=!1,this.trigger("finish",e),cleverapps.eventLogger.logEvent(cleverapps.EVENTS.MINIGAME_FINISH+"_"+this.getName()),cleverapps.playSession.set(cleverapps.EVENTS.MINIGAME_FINISH+"_"+this.getName(),!0))};var MissionIcon=function(e){var t=Missions[e.type].sideBarJson,
n="function"==typeof t?t(e):t,s=-1!==[Mission.TYPE_FAVORITE_SALE,Mission.TYPE_COINS_SALE].indexOf(e.type),i=void 0;e.isBattlePassMission()&&(i="battlepass"),SideBarIcon.call(this,{animation:n,lottery:s,target:i}),this.mission=e};MissionIcon.prototype=Object.create(SideBarIcon.prototype),(MissionIcon.prototype.constructor=MissionIcon).prototype.resetState=function(){this.setAttention(this.isAttentionRequired());var e=this.mission.finishTime()-Date.now();0<e?(this.setLeftTime(e),this.setTitle(void 0)):(this.setLeftTime(0),this.setTitle("messages:Finished"))},MissionIcon.prototype.isAttentionRequired=function(){return this.mission.isMinigameMission()?this.mission.canPlayMinigame():this.mission.isBattlePassMission()?this.mission.battlePass.hasAnyReward():this.mission.type===Mission.TYPE_BONUS_WORLD},MissionIcon.prototype.getForce=function(){return this.mission.iconForce},MissionIcon.prototype.onPressed=function(){cleverapps.metha.display({focus:"MissionIconClicked",action:function(e){
var t=new(this.mission.getViewClass())(this.mission);t instanceof cleverapps.FixedWidthScene||t instanceof SceneProxy?cleverapps.scenes.replaceScene(t,e):cleverapps.metha.onceNoWindowsListener=e}.bind(this)})};var MissionWindow=Window.extend({onWindowLoaded:function(e){var t=cleverapps.styles.MissionWindow;this.mission=e,this.content=new cc.Node,this.content.setContentSize(t.width,t.height),this.content.setAnchorPoint(.5,.5),this.onStart();var n={width:t.button.width,height:t.button.height,text:Messages.get("Play").toUpperCase(),font:cleverapps.styles.FONTS.MISSION_BUTTON_TEXT,button_png:bundles.buttons_main.frames.mission_play_button,button_on_png:bundles.buttons_main.frames.mission_play_button_on,contentOffset:t.button.contentOffset,onPressed:function(){this.close(),cleverapps.metha.distract({focus:"MissionPlayButtonPressed",action:function(e){cleverapps.metha.wantsToPlay(e,{mission:!0})}})}.bind(this)};this.wasFinished&&(n=cleverapps.extend(n,{text:Messages.get(
this.prize?"ClaimPrize.Button.text":"OK"),onPressed:this.close.bind(this)}));var s={title:{text:"messages:Missions."+e.getName()+".Title",font:cleverapps.skins.getSlot("missionWindowTitleFont")},name:" missionwindow",content:this.content,styles:cleverapps.overrideStyles(cleverapps.styles.Window,t.window,!0),button:n};this.wasFinished?e.finishView===MissionWindow&&(e.finishView=!1):s.help=function(){new MissionRulesWindow(e)},this._super(s)},onStart:function(){this.contentLayout&&this.contentLayout.removeFromParent(),this.wasFinished=!this.mission.isRunning(),this.wasFinished&&(this.prize=this.mission.getPrize());var e=cleverapps.styles.MissionWindow,t=cleverapps.missionManager.table.createTableView({id:this.mission.type,data:this.mission.getResults(),dataIcon:this.mission.getIcon(),options:e.tableHeight,rowConstructor:cleverapps.MissionRow});t.setScale(e.table.scale);var n=[cleverapps.UI.generateTTFText(this.mission.isRunning(
)?"messages:Missions.windowRunning":"messages:Missions.windowFinished",cleverapps.styles.FONTS.MISSION_WINDOW_STATUS_TEXT||cleverapps.styles.FONTS.WINDOW_TEXT)],s={font:cleverapps.styles.FONTS.MISSION_WINDOW_TIMER_TEXT||cleverapps.styles.FONTS.TEXT};if(e.timer.bg){var i=cleverapps.UI.createScale9Sprite(e.timer.bg.image);i.setContentSize2(e.timer.bg),s.background_content=i}if(this.mission.isRunning()){var o=new cleverapps.CountDownView(new cleverapps.CountDown(this.mission.getTimeLeft(),{onFinish:function(){this.onFinishedSound&&"function"==typeof this.onFinishedSound&&this.onFinishedSound(!0),this.close()}.bind(this)}),s);o.setScale(e.timer.scale),n.push(o)}n.reverse();var r=new cleverapps.Layout(n,{}),a=new cc.Node;a.setContentSize(e.width,e.textAndTimerHeight),a.setAnchorPoint(.5,.5),a.setLocalZOrder(-1),a.addChild(r),r.setPositionRound({align:"center"},{align:"center"});var c=[a],l=bundles[this.mission.getWindowBundleName()],p=new cc.Scale9Sprite(new cc.Sprite(
cleverapps.styles.TableView.bg).getSpriteFrame());if(p.setContentSize2(t.width,e.animation.animationHeight),e.autoScrollText){var d;this.wasFinished&&(d=this.prize?"Win":"Lose");var u=e.text[this.mission.getName()]||"messages:Missions.CommonText";d&&(u="messages:Missions."+this.mission.getName()+".AnimationMainText"+d);var h=["messages:Missions."+this.mission.getName()+".AnimationMainTextInfo0","messages:Missions."+this.mission.getName()+".AnimationMainTextInfo1",u].filter(Messages.has),g=e.animation.animationWidth+e.contentObjectsMargin/2;this.autoScrollText=new AutoScrollText(h,{styles:{width:Math.max(e.contentObjectsMargin,t.width-g)-2*e.autoScrollText.offset.x,height:p.height-2*e.autoScrollText.offset.y,font:cleverapps.styles.FONTS.MISSIONS_TEXT,padding:e.autoScrollText.padding}}),p.addChild(this.autoScrollText),this.autoScrollText.setPositionRound(g+(p.width-g)/2,p.height/2);var v=new cc.Node;v.setContentSize2(e.animation.animationWidth,e.animation.animationHeight),
v.setAnchorPoint(0,0),v.setLocalZOrder(1);var m=new cleverapps.Spine(l.jsons.json);m.setAnimation(0,"finish",!0),m.setPosition(v.width/2,v.height/2),v.addChild(m),p.addChild(v),c.push(p)}if(c.push(t),c.reverse(),this.contentLayout=new cleverapps.Layout(c,{margin:e.contentObjectsMargin,padding:{x:0,y:1.5*e.contentObjectsMargin}}),this.content.addChild(this.contentLayout),this.contentLayout.setPositionRound(e.contentLayout),this.mission.onChangeResults=this.createListener(function(){var e=this.mission.getResults();t.updateResults(e),cleverapps.missionManager.table.updateResults(this.mission.type,e)}.bind(this)),e.titleAnimation&&bundles[this.mission.getWindowBundleName()].jsons.mission_window_json){var f=new cleverapps.Spine(bundles[this.mission.getWindowBundleName()].jsons.mission_window_json);f.setAnimation(0,"animation",!0),this.content.addChild(f),f.setPositionRound(e.titleAnimation)}SceneDecors.add(this.content,cleverapps.skins.getSlot("missionWindowDecors"))},
onFinishedSound:function(e){e&&this.mission&&!this.mission.finishTimeSoundPlayed&&cleverapps.windows.currentWindow()===this&&(this.mission.finishTimeSoundPlayed=!0,cleverapps.audio.playSound(bundles.main.urls.mission_finish_effect))},onShow:function(){this.onFinishedSound&&"function"==typeof this.onFinishedSound&&this.onFinishedSound(this.wasFinished),this.autoScrollText&&(this.autoScrollText.setTextByIndex(0),this.autoScrollText.reinitTimer()),cleverapps.audio.playSound(bundles.main.urls.window_effect)}});MissionWindow.prototype.listBundles=function(e){var t=[],n=e.getWindowBundleName();return n&&t.push(n),t},cleverapps.styles.MissionWindow={width:700,height:940,textAndTimerHeight:90,titleFont:cleverapps.styles.FONTS.WINDOW_TITLE_TEXT,timer:{font:cleverapps.styles.FONTS.TEXT,scale:.8},button:{width:260,height:100,contentOffset:{y:0}},window:{Border:{x:36}},tableHeight:{styles:{height:449}},contentObjectsMargin:20,animation:{animationWidth:250,animationHeight:247},autoScrollText:{
padding:{x:0,y:40},offset:{x:20,y:40}},table:{scale:1},contentLayout:{x:{align:"center"},y:{align:"top"}},text:{}};var MissionRulesWindow=RulesWindow.extend({onWindowLoaded:function(e){this.bundle=bundles[e.getWindowBundleName()];var t=cleverapps.styles.MissionRulesWindow;t.prefix="messages:MissionRulesWindow."+e.getName()+".",t.animation.json=cleverapps.skins.getSlot("missionRulesWindow",{bundle:this.bundle,type:e.type}),t.animation.json=t.animation.json||this.bundle.jsons.rules_json,t.animation.name="animation",this._super({name:"missionruleswindow",styles:t})},listBundles:function(e){var t=this._super(e);return t.push(e.getWindowBundleName()),t}});cleverapps.styles.MissionRulesWindow={margin:0,animation:{height:730,y:-110},subText:{width:240,left:{x:{align:"left",dx:0},y:{align:"top",dy:-250}},right:{x:{align:"right",dx:10},y:{align:"top",dy:-250}},bottom:{x:{align:"center",dx:15},y:{align:"bottom",dy:70}}}};var MissionAnimationView=cc.Node.extend({ctor:function(e){this._super(),
this.usePool=!0;var t=this.clover=new cc.Sprite(this.getIcon(e));t.setScale(cleverapps.styles.MissionAnimationView.scale),this.addChild(t),this.setLocalZOrder(100),this.setCascadeOpacityEnabled(!0),this.initialize(e)},initialize:function(e){var t=this.getFieldAlgorithm();e.victory&&(t=this.getVictoryAlgorithm()),t(this,e)},reuse:function(e){this.initialize(e)},remove:function(){this.usePool?cc.pool.putInPool(this):this.unuse()},unuse:function(){this.removeFromParent()}}),MissionAnimationGoldView=MissionAnimationView.extend({getIcon:function(){return bundles.menubar.frames.coin_png},getFieldAlgorithm:function(){return MissionAnimationView.SimpleFlyAlgorithm},getVictoryAlgorithm:function(){return MissionAnimationView.SimpleFlyAlgorithm}}),MissionAnimationCloverView=MissionAnimationView.extend({getIcon:function(){return bundles.game.frames.fly_clover_png},getFieldAlgorithm:function(){return MissionAnimationView.SimpleFlyAlgorithm},getVictoryAlgorithm:function(){
return MissionAnimationView.SimpleFlyAlgorithm}}),MissionAnimationRoseView=MissionAnimationView.extend({getIcon:function(e){return e.icon?e.icon:cleverapps.skins.getSlot("missionMarkIcon",{type:Mission.TYPE_COLLECT_MARK})},getFieldAlgorithm:function(){return MissionAnimationView.flyToAlgorithm},getVictoryAlgorithm:function(){return MissionAnimationView.SimpleFlyAlgorithm},reuse:function(e){this._super(e),this.clover.setSpriteFrame(this.getIcon(e))}}),MissionAnimationTulpanView=MissionAnimationView.extend({getIcon:function(){return cleverapps.skins.getSlot("missionIcon",{type:Mission.TYPE_BURN_NEARBY})},getFieldAlgorithm:function(){return MissionAnimationView.flyToAlgorithm},getVictoryAlgorithm:function(){return MissionAnimationView.SimpleFlyAlgorithm}}),MissionAnimationLetterView=MissionAnimationView.extend({ctor:function(e){cc.Node.prototype.ctor.call(this);var t=this.clover=this.getIcon(e.id);t.setScale(cleverapps.styles.MissionAnimationView.scale),this.addChild(t),
this.setLocalZOrder(100),this.setCascadeOpacityEnabled(!0),this.initialize(e)},reuse:function(e){this.clover.setSpriteFrame(this.getSpriteFrame(e.id))},getIcon:function(e){return new cc.Sprite(this.getSpriteFrame(e))},getSpriteFrame:function(e){var t=e%Missions[Mission.TYPE_LETTER].STAR_TYPES_AMOUNT;return cleverapps.skins.getSlot("missionStar",{type:t})},getFieldAlgorithm:function(){return MissionAnimationView.flyToAlgorithm},getVictoryAlgorithm:function(){return MissionAnimationView.SimpleFlyAlgorithm}});MissionAnimationView.flyToAlgorithm=function(e,t){var n=cleverapps.styles.MissionAnimationView,s=n.upY,i=t.beginPos,o=t.targetPos;e.setPosition(i),i.y+=s,e.setScale(t.beginScale),e.setOpacity(255);var r=cc.p(o.x,o.y+n.flyTo.second.y),a=[cc.p((i.x+r.x)/2,(i.y+r.y)/2+n.flyTo.first.y),r,o],c=Math.abs(o.x-i.x),l=Math.abs(o.y-i.y)+n.flyTo.first.y+n.flyTo.second.y,p=Math.sqrt(c*c+l*l);p/=n.flySpeed,t.targetScale||(t.targetScale=t.beginScale),t.finalScale||(t.finalScale=t.targetScale),
e.runAction(new cc.Sequence(new cc.Spawn(new cc.ScaleTo(.3,t.targetScale),new cc.MoveBy(.3,cc.p(0,s))),new cc.Spawn(new cc.ScaleTo(p,t.finalScale),new cc.BezierTo(p,a).easing(cc.easeIn(1))),new cc.CallFunc(function(){cleverapps.audio.playSound(bundles.game.urls.cell_collect_effect,{throttle:20}),e.remove(),t.callback&&t.callback()})))},MissionAnimationView.SimpleFlyAlgorithm=function(e,t){var n=t.beginPos;e.setPosition(n),e.setScale(0),e.setOpacity(255);var s=cleverapps.styles.MissionAnimationView.bezierLength,i=Math.random()*s;i<s/2&&(i-=s);var o=cc.p(n.x+i,n.y-2*s),r=cc.p(o.x,o.y+s),a=[cc.p(n.x,n.y+s*(1.5+.5*Math.random())),r,o],c=.2;3<c*t.amount&&(c=3/t.amount),e.runAction(new cc.Sequence(new cc.DelayTime(t.id*c),new cc.CallFunc(function(){cleverapps.audio.playSound(bundles.game.urls.boom_effect,{throttle:20})}),new cc.Spawn(new cc.ScaleTo(.3,.8),new cc.BezierTo(2,a),new cc.RotateBy(2,i<0?-360:360),new cc.Sequence(new cc.DelayTime(1.5),new cc.FadeOut(.5))),new cc.CallFunc(function(
){e.remove()})))},MissionAnimationCloverView.factory=function(e){return cc.pool.hasObject(MissionAnimationCloverView)?cc.pool.getFromPool(MissionAnimationCloverView,e):new MissionAnimationCloverView(e)},MissionAnimationRoseView.factory=function(e){return cc.pool.hasObject(MissionAnimationRoseView)?cc.pool.getFromPool(MissionAnimationRoseView,e):new MissionAnimationRoseView(e)},MissionAnimationTulpanView.factory=function(e){return cc.pool.hasObject(MissionAnimationTulpanView)?cc.pool.getFromPool(MissionAnimationTulpanView,e):new MissionAnimationTulpanView(e)},MissionAnimationLetterView.factory=function(e){return cc.pool.hasObject(MissionAnimationLetterView)?cc.pool.getFromPool(MissionAnimationLetterView,e):new MissionAnimationLetterView(e)},MissionAnimationGoldView.factory=function(e){return cc.pool.hasObject(MissionAnimationGoldView)?cc.pool.getFromPool(MissionAnimationGoldView,e):new MissionAnimationGoldView(e)},MissionAnimationView.show=function(e,t,n){n.amount||(n.amount=1);for(
var s=0;s<n.amount;s++)switch(n.id=s,e){case"gold":t.addChild(MissionAnimationGoldView.factory(n));break;case Mission.TYPE_COMBO:t.addChild(MissionAnimationCloverView.factory(n));break;case Mission.TYPE_COLLECT_MARK:t.addChild(MissionAnimationRoseView.factory(n));break;case Mission.TYPE_BURN_NEARBY:t.addChild(MissionAnimationTulpanView.factory(n));break;case Mission.TYPE_LETTER:t.addChild(MissionAnimationLetterView.factory(n))}},cleverapps.styles.MissionAnimationView={bezierLength:250,flySpeed:1500,upY:100,flyTo:{first:{y:300},second:{y:300}},scale:1};var CloversView=RewardElementView.extend({getAddedAnimation:function(e){switch(e){case Mission.TYPE_COMBO:return RewardElementView.rotateAnimation;case Mission.TYPE_COLLECT_MARK:case Mission.TYPE_BURN_NEARBY:case Mission.TYPE_LETTER:return RewardElementView.growAnimation}},runAddedAnimation:function(){var e=this.getAddedAnimation(this.game.gameMission.type);e&&e(this,this.game.rewards[GameBase.REWARD_CLOVER]),cleverapps.audio.playSound(
bundles.game.urls.tournament_element_collected)},ctor:function(e,t){var n,s=e.game,i=s.gameMission,o=cleverapps.styles.UI.RewardElementView;n=o.missionIconAnimated?new MissionMarkView(new Mark("mission"),{counter:!0}):new cc.Sprite(s.gameMission.getIcon()),this._super(e,t,{name:i.getName(),targetName:"cloversViewTarget",icon:n,reward:GameBase.REWARD_CLOVER,control:"rewardElementClover"}),cleverapps.tooltipManager.create(this.bg||this.icon,{text:"messages:CloversTooltip",position:"runes"===cleverapps.config.name?cleverapps.styles.UI.Tooltip.LOCATION.above:cleverapps.styles.UI.Tooltip.LOCATION.below,hideHandler:this.hideHandler,control:"cloversViewTooltip"}),s.onCloverAdded=function(){this.hide&&cleverapps.wideMode.mode===cleverapps.WideMode.VERTICAL?e.groupToggler.show(this,this.getGroupName(),this.runAddedAnimation.bind(this)):this.runAddedAnimation()}.bind(this),o.hideOnStart&&(this.visible=!1)}}),MainScene=cleverapps.FixedWidthScene.extend({ctor:function(){this._super(
cleverapps.Environment.SCENE_MAIN),this.addToolbar(),this.addSideBar(),cleverapps.environment.levelNo=levels.user.level,cleverapps.environment.episodeNo=levels.user.episode,cleverapps.placements.run(Placements.INTERMEDIATE)},getRefreshSceneActionOnChangeSize:function(){return function(e){cleverapps.metha.gotoMainScene(e)}},closeAction:function(){cleverapps.administrator?AdministratorScene.open():window.closeApplication&&window.closeApplication()},addSideBar:function(){var e=new SideBarView;e.setPositionRound(this.scene.width/2,this.scene.height/2),e.setLocalZOrder(1),this.scene.addChild(e)},addToolbar:function(){(this.downToolBar=new ToolbarView(this.scene)).setLocalZOrder(1)}}),MethaHelper={start:function(e,t,n){n=n||{};var s=MethaHelper.getCurrentLevel(t);0===s.episodeNo&&0===s.levelNo||!LevelStartWindow.isAvailable(s.episode.episodeNo,s.levelNo)||n.playNext&&!BoostersBefore.isAvailable()?s.play(e):cleverapps.metha.compound(e,[function(e){n.playNext&&BoostersBefore.isAvailable(
)?cleverapps.Plot.GameLeave(e,n):e()},function(e){t?(cleverapps.metha.showControlsWhileFocused("MenuBarGoldItem"),new BuildingStartWindow({building:t,level:s})):new LevelStartWindow({level:s}),cleverapps.metha.onceNoWindowsListener=e}])},getCurrentLevel:function(e){var t=void 0;cleverapps.metha.getType()===Metha.FARM?(t=e.label,cleverapps.playButton.disableIncLevel(),(void 0===t||t.episodeNo>=levels.episodes.getAmountEpisodes())&&(t=cleverapps.farm.chooseNextLevel(e)),e.label!==t&&(e.label=t,cleverapps.farm.save()),cleverapps.playButton.enableIncLevel()):t=cleverapps.user.getCurrentLevel(),cleverapps.isKnockoutGame()&&cleverapps.user.incLevel();var n=new Episode(t.episodeNo,t.levelNo).getLevel();return cleverapps.metha.getType()===Metha.FARM&&(n.building=e),n},prepare:function(){MethaHelper.prepareCharacters(),cleverapps.config.debugMode&&cleverapps.metha.getType()===Metha.FARM&&MethaHelper.validateDialogues(),cleverapps.metha.getType()===Metha.FARM&&MethaHelper.validateQuestItems()},
prepareCharacters:function(){var n=cleverapps.styles.WorldMap,e=0;cleverapps.styles.WorldMap.persons.person0&&(e=1);var t=function(e,t){n.persons[e]=n.persons[e]||cleverapps.overrideStyles(cleverapps.styles.DialogueView.persons.default,{styles:{json:t.jsons[e],title:"messages:"+e}},!0)};if(cleverapps.metha.getType()===Metha.HOMEFIX){var s=bundles.homefix_windows;if(!s)return;for(var i=e;i<100;i++){var o="person"+i;if(!s.jsons[o])break;t(o,s)}}else if(cleverapps.metha.getType()===Metha.FARM)for(i=e;i<100;i++){if(!bundles[o="person"+i])break;t(o,bundles[o])}},validateQuestItems:function(){MethaHelper.readConfig().questItems.forEach(function(e,t){if(!bundles.farm_windows.frames["item"+t])throw"No questItem resource - "+e})},readConfig:function(){return cleverapps.metha.getType()===Metha.FARM?cleverapps.farm.readConfig():cleverapps.metha.getType()===Metha.HOMEFIX?cleverapps.home.readConfig():void 0},validateDialogues:function(){cleverapps.values(this.readConfig().dialogues).forEach(
function(e){e.forEach(function(e){if("string"==typeof e.person&&!cleverapps.styles.WorldMap.persons[e.person])throw"No person: "+e.person})})},allIsComplete:function(e){cleverapps.metha.compound(e,[function(e){var t=MethaHelper.createDialogue("Final");t.on("afterClose",e),new DialogueView(t,{overlay:!0}),t.run()},function(e){new AllDoneWindow,cleverapps.metha.onceNoWindowsListener=e}])},createDialogue:function(e){var t=this.readConfig().dialogues[e];if(t){var n=[],s=[];return t.forEach(function(e){var t={text:"messages:"+e.text,person:{animation:e.animation||cleverapps.styles.WorldMap.personsAnimation,position:e.position||"left",styles:cleverapps.styles.WorldMap.persons[e.person].styles}};e.person2&&(t.person2={animation:e.person2.animation||cleverapps.styles.WorldMap.personsAnimation,position:e.person2.position||"left",styles:cleverapps.styles.WorldMap.persons[e.person2.person].styles}),s.push(t),cleverapps.metha.getType()===Metha.FARM&&(n.push(e.person),
e.person2&&e.person2.person&&n.push(e.person2.person))}),new Dialogue(s,{autoClose:!0,showUp:!0,bundles:n})}}},options={ctor:function(){var e;switch(this._super(cleverapps.Environment.SCENE_METHA),cleverapps.metha.getType()){case Metha.FARM:e=cleverapps.farm;break;case Metha.HOMEFIX:e=cleverapps.home}switch(this.map=new WorldMap(e),this.map.setPositionRound(this.scene.width/2,this.scene.height/2),this.map.setLocalZOrder(-1),this.scene.addChild(this.map),this.addPlayButton(),cleverapps.metha.getType()){case Metha.FARM:this.controller=new FarmController(this.map);break;case Metha.HOMEFIX:this.controller=new HomeController(this.map),this.addTasksIcon(),this.map.animateNewTask=this.createListener(this.animateNewTask.bind(this)),this.createFinger()}-1!==[Metha.FARM,Metha.HOMEFIX].indexOf(cleverapps.metha.getType())&&this.runAction(new cc.RepeatForever(new cc.Sequence(new cc.DelayTime(5),new cc.CallFunc(function(){cleverapps.audio.playSound(bundles.main.urls.city_loop_effect)}),
new cc.DelayTime(5))))},getRefreshSceneActionOnChangeSize:function(){return function(e){cleverapps.metha.withSimpleMain()?cleverapps.scenes.replaceScene(new NoMainMethaScene,e):cleverapps.metha.gotoMainScene(e)}},onExit:function(){this._super(),this.controller.clear()},addPlayButton:function(){this.playButton=new PlayButtonView({isSmall:"wordsoup"===cleverapps.config.name,hard:"heroes"!==cleverapps.config.name}),this.scene.addChild(this.playButton)},addTasksIcon:function(){this.tasksIcon=new HomeTasksIcon(this.scene),this.scene.addChild(this.tasksIcon)},setFinger:function(){var e=cleverapps.home.getFurnitureToUpgrade()?this.tasksIcon.hideHandler.originalPosition:this.playButton.hideHandler.originalPosition;this.finger.setPositionRound(e)},createFinger:function(){var e=this.finger=new FingerView({control:"homefix_finger"});this.scene.addChild(e,1),cleverapps.styles.MethaScene.finger.scale&&e.setScale(cleverapps.styles.MethaScene.finger.scale),e.standardLoop(),
cleverapps.metha.registerControl("finger_position_update",this.tasksIcon.createListener(function(){this.setFinger()}.bind(this)))},animateNewTask:function(e){var t=new NewTaskAnimation(e,this);this.scene.addChild(t),t.setPositionRound(cleverapps.styles.MethaScene.newTask)},displayIntro:function(e){this.controller.displayIntro(e)},getBackgroundStyles:function(){}},MethaScene=MainScene.extend(options),NoMainMethaScene=cleverapps.FixedWidthScene.extend(options);MethaScene.BUNDLES=NoMainMethaScene.BUNDLES=function(){var e=["homefix","world_map","dialogues","main"];switch(cleverapps.metha.getType()){case Metha.FARM:e.push("farm_windows");break;case Metha.HOMEFIX:e.push("homefix_windows")}for(var t=0;bundles["metha_top_layer_"+t];t++)e.push("metha_top_layer_"+t);for(var n=0;bundles["metha_bottom_layer_"+n];n++)e.push("metha_bottom_layer_"+n);return e},cleverapps.styles.MethaScene={newTask:{x:{align:"right",dx:-50},y:{align:"top",dy:-50}}};var MethaSimpleMainScene=MainScene.extend({
ctor:function(){this._super(),this.addPersons(),this.addPlayButton()},addPersons:function(){var e=cleverapps.styles.MethaSimpleMainScene.persons;if(e)for(var t in e){var n=e[t],s=new cleverapps.Spine(n.json);s.setAnimation(0,"animation",!0),s.setPositionRound(n),this.scene.addChild(s)}},getBackgroundStyles:function(){return cleverapps.styles.MethaSimpleMainScene.background},addPlayButton:function(){var e=new PlayButtonView({styles:cleverapps.styles.MethaSimpleMainScene.PlayButton});this.scene.addChild(e),e.addFingerTip()}});MethaSimpleMainScene.BUNDLES=["metha_simple_main","main"],cleverapps.styles.MethaSimpleMainScene={PlayButton:{width:300,height:100,x:{align:"center"},y:{align:"bottom",dy:150},text:{paddingX:20},button:{button_png:bundles.buttons.frames.green_button_png,button_on_png:bundles.buttons.frames.green_button_on_png,x:{align:"center"},y:{align:"center"}}},background:{background:bundles.metha_simple_main.urls.background}};var PlayButtonView=cc.Node.extend({ctor:function(e){
this._super(),this.options=e||{},this.styles=this.options.styles?this.options.styles:cleverapps.styles.PlayButtonView,this.isSmall=this.options.isSmall,this.noLevelNumber=cleverapps.metha.getType()===Metha.KNOCKOUT||cleverapps.metha.getType()===Metha.HOSE&&cleverapps.user.isPassedAll(),this.setAnchorPoint2(),this.setContentSize2(this.styles),this.setPositionRound(this.calcPosition()),cleverapps.UI.makeHideable(this,cleverapps.UI.VERTICAL),cleverapps.metha.registerControl("play_button",this),cleverapps.playButton.on("update",this.update.bind(this),this),cleverapps.playButton.on("animatePassLevel",this.animatePassLevel.bind(this),this),this.update()},update:function(){this.styling=this.getStyling(),this.createButton(),this.createAnimation(),this.styles.button||(cleverapps.UI.applyHover(this),cleverapps.UI.onClick(this,function(){cleverapps.playButton.onClick()}))},calcPosition:function(){var e=this.styles;return e.noToolBarPosition&&cleverapps.metha.withSimpleMain()&&(
e=e.noToolBarPosition),e=e.positions?e.positions[cleverapps.wideMode.mode]:e,(e=cc.p(cleverapps.clone(e.x),cleverapps.clone(e.y))).y.dy-=cleverapps.UI.getSceneOffsetY(),e},animatePassLevel:function(){if(this.button&&this.button.stopAllActions(),this.stopAllActions(),this.show(!0),!this.isSmall&&!this.noLevelNumber){var e=new cleverapps.Spine(bundles.main.jsons.play_button_transition_json);this.addChild(e),e.setPositionRound(this.width/2,this.height/2),e.runAction(new cc.Sequence(new cc.DelayTime(.6),new cc.CallFunc(function(){e.setAnimation(0,"animation",!1),e.setCompleteListenerRemove()})))}this.runAction(new cc.Sequence(this.listAnimationActions()))},listAnimationActions:function(){if(this.noLevelNumber)return[new cc.DelayTime(1.1),new cc.CallFunc(this.updateTextAndButton.bind(this)),new cc.CallFunc(this.onPassLevelAnimationFinished.bind(this))];var e=this.scale;return[new cc.DelayTime(1.1),new cc.ScaleTo(.15,1.3*e),new cc.CallFunc(this.updateTextAndButton.bind(this)),
new cc.PlaySound(bundles.main.urls.play_button_effect),new cc.ScaleTo(.2,e),new cc.CallFunc(this.onPassLevelAnimationFinished.bind(this))]},updateTextAndButton:function(){this.styling=this.getStyling(),this.text.setFontSize(this.getFont().size),this.text.setString(this.getTextMsg()),this.text.fitTo(this.styles.width-2*this.styles.text.paddingX,this.styles.height-2*this.styles.text.paddingY),this.animation?this.animation.setAnimation(0,this.styling.animation,!0):(this.button.setBackgroundImage(this.styling.button_png),this.button.setBackgroundImagePressed(this.styling.button_on_png))},onPassLevelAnimationFinished:function(){},addFingerTip:function(){var e=new FingerView({control:"playbutton_finger",showDelay:.5});e.setLocalZOrder(14),this.getParent().fingerTip=e,this.getParent().addChild(e),e.setPositionRound(this.hideHandler.originalPosition),e.delay(5),e.fadeIn(new cc.p(0,0)),e.press(),e.delay(.3),e.unPress(),e.delay(.1),e.press(),e.delay(.3),e.unPress(),e.fadeOut(),e.run({looped:!0})
},createAnimation:function(){if(this.styles.animation){this.animation&&this.animation.removeFromParent();var e=this.animation=new cleverapps.Spine(bundles.main.jsons.play_button_json);e.setAnimation(0,this.styling.animation,!0),this.addChild(e),e.setPositionRound(this.width/2,this.height/2),this.styles.button||(this.text=this.createText(),this.text.setPositionRound(this.width/2,this.height/2),this.addChild(this.text))}},createButton:function(){if(this.styles.button){this.button&&this.button.removeFromParent(),this.text=this.createText();var e={width:this.styles.width,height:this.styles.height,contentOffset:this.styles.button.contentOffset,content:this.text,fitTo:!1,button_png:this.styling.button_png,button_on_png:this.styling.button_on_png,onClicked:function(){cleverapps.playButton.onClick()}},t=this.button=new cleverapps.UI.Button(e);this.addChild(t),t.setPositionRound(this.styles.button)}},getTextMsg:function(){var e=cleverapps.playButton.getLevelNo(),t=this.getDisplayedLevel(),
n=this.noLevelNumber?"messages:Play":"messages:PlayButton.text";return t.isHard()&&!1!==this.options.hard&&(n="messages:message.hardLevel"),t.isTricky()&&(n="messages:message.trickyLevel"),this.isSmall&&(n=e),Messages.getLocalized(n,{levelNo:e})},getDisplayedLevel:function(){return cleverapps.playButton.passedLevel&&cleverapps.playButton.previousLevel?cleverapps.playButton.previousLevel:cleverapps.playButton.currentLevel},getStyling:function(){var e=this.getDisplayedLevel();return this.styles.animation?{animation:e.isHard()&&this.styles.animation.customHard?"hard":"animation"}:e.isHard()?{button_png:this.styles.button.hardLvl&&this.styles.button.hardLvl.button_png||this.styles.button.button_png||bundles.buttons.frames.window_button_png,button_on_png:this.styles.button.hardLvl&&this.styles.button.hardLvl.button_on_png||this.styles.button.button_on_png||bundles.buttons.frames.window_button_on_png}:e.isTricky()?{button_png:bundles.buttons_main.frames.play_button_tricky_png,
button_on_png:bundles.buttons_main.frames.play_button_tricky_on_png}:{button_png:this.styles.button.button_png||bundles.buttons.frames.window_button_png,button_on_png:this.styles.button.button_on_png||bundles.buttons.frames.window_button_on_png}},getFont:function(){if(this.isSmall)return cleverapps.styles.FONTS.SMALL_PLAY_BUTTON_TEXT;var e=this.getDisplayedLevel();return e.isHard()&&cleverapps.styles.FONTS.PLAY_BUTTON_TEXT_HARD?cleverapps.styles.FONTS.PLAY_BUTTON_TEXT_HARD:e.isTricky()&&cleverapps.styles.FONTS.PLAY_BUTTON_TEXT_TRICKY?cleverapps.styles.FONTS.PLAY_BUTTON_TEXT_TRICKY:cleverapps.styles.FONTS.PLAY_BUTTON_TEXT},createText:function(){var e=cleverapps.UI.generateTTFText(this.getTextMsg(),this.getFont());return e.fitTo(this.styles.width-2*this.styles.text.paddingX,this.styles.height-2*this.styles.text.paddingY),e}});cleverapps.overrideFonts(cleverapps.styles.FONTS,{PLAY_BUTTON_TEXT:{size:70,color:cleverapps.styles.COLORS.WHITE,
stroke:cleverapps.styles.DECORATORS.IMAGE_FONT_STROKE},SMALL_PLAY_BUTTON_TEXT:{}}),cleverapps.styles.PlayButtonView={width:300,height:100,x:{align:"center"},y:{align:"bottom",dy:150},text:{paddingX:30,paddingY:0},button:{x:{align:"center"},y:{align:"center"}}};var PlayButton=function(){cleverapps.EventEmitter.call(this),cleverapps.user.on("incLevel",this.onIncLevel.bind(this)),levels.episodes.onResetListener=this.update.bind(this),this.update()};PlayButton.prototype=Object.create(cleverapps.EventEmitter.prototype),(PlayButton.prototype.constructor=PlayButton).prototype.onIncLevel=function(){this.incLevelDisabled||(this.passedLevel=!0,this.update())},PlayButton.prototype.enableIncLevel=function(){delete this.incLevelDisabled},PlayButton.prototype.disableIncLevel=function(){this.incLevelDisabled=!0},PlayButton.prototype.getLevelNo=function(){var e=cleverapps.user.getVirtualDisplayLevel();return this.passedLevel&&e--,e},PlayButton.prototype.update=function(){if(PlayButton.IsAvailable()){
var e=cleverapps.user.getCurrentLevel();this.currentLevel&&this.currentLevel.episodeNo===e.episodeNo&&this.currentLevel.levelNo===e.levelNo||(this.currentLevel&&(this.previousLevel=this.currentLevel),this.currentLevel=new Episode(e.episodeNo,e.levelNo).getLevel(),this.trigger("update"))}},PlayButton.prototype.onClick=function(){cleverapps.forces.isRunningForce()&&cleverapps.forces.closeRunningForce(),cleverapps.metha.display({focus:"PlayButton_scene",action:function(e){cleverapps.metha.wantsToPlay(e)}})},PlayButton.prototype.animatePassLevel=function(){this.passedLevel=!1,this.trigger("animatePassLevel")},PlayButton.IsAvailable=function(){return cleverapps.metha.getType()!==Metha.NONE};var AllDoneWindow=Window.extend({onWindowLoaded:function(){this._super({title:"messages:AllDoneWindow.title",name:"alldonewindow",content:this.getContent(),button:{width:cleverapps.styles.AllDoneWindow.button.width,height:cleverapps.styles.AllDoneWindow.button.height,text:Messages.get("Play"),
onPressed:function(){this.close(),cleverapps.metha.distract({focus:"PlayButton",action:function(e){cleverapps.metha.wantsToPlay(e)}.bind(this)})}.bind(this)}})},getContent:function(){return new cleverapps.Layout([this.getText(),this.getAnimation()],{direction:cleverapps.UI.VERTICAL,margin:cleverapps.styles.AllDoneWindow.margin,padding:cleverapps.styles.AllDoneWindow.padding})},getText:function(){var e=cleverapps.UI.generateTTFText("messages:AllDoneWindow.text",cleverapps.styles.FONTS.WINDOW_TEXT);return e.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER),e.setDimensions(cleverapps.styles.AllDoneWindow.text.width,0),e},getAnimation:function(){var e=cleverapps.styles.AllDoneWindow.animation,t=new cleverapps.Spine(e.json);return t.setAnimation(0,e.animationName,!0),t},listBundles:function(){return["episode_coming_soon"]}});cleverapps.styles.AllDoneWindow={margin:20,padding:{bottom:50},text:{width:550},button:{width:300,height:100},animation:{animationName:"animation",
json:bundles.episode_coming_soon.jsons.spine_0_json}};var WorldMap=MapScrollView.extend({ctor:function(e){this._super();var t,n,s=cc.director.getWinSize();if(this.setContentSize2(s),this.setAnchorPoint2(),n={width:(t=cc.loader.getRes(bundles.world_map.jsons.mapData)).map.width*resolutionScale,height:t.map.height*resolutionScale},this.setContainerSize(n),bundles.world_map.urls.map){var i=new cc.Sprite(bundles.world_map.urls.map);i.setScale(n.width/i.width),i.setPositionRound(this.innerWidth/2,this.innerHeight/2),this.container.addChild(i)}this.addBgs(t),this.buildingViews={},this.setZoom(cleverapps.styles.WorldMap.zoom.unfocused),this.onEnterStart=function(){},this.animateNewTask=function(){}},addBgs:function(e){for(var t=0;t<=30;t++){var n;if(cleverapps.metha.getType()===Metha.FARM?n=bundles.metha_top_layer_0.jsons["map_json"+t]:cleverapps.metha.getType()===Metha.HOMEFIX&&(n=bundles.world_map.jsons["map_json"+t]||bundles.world_map_nodither.jsons["map_json"+t]),n){
var s=new cleverapps.Spine(n,1);if(s.setAnimation(0,"animation",!0),e["map_json"+t]){var i=e["map_json"+t],o=new cc.Node;o.setAnchorPoint2(),o.setContentSize2(i.width*resolutionScale,i.height*resolutionScale),s.setPosition(o.width/2,o.height/2),o.addChild(s),o.setPosition(this.innerWidth/2+i.x*resolutionScale,this.innerHeight/2+i.y*resolutionScale),this.container.addChild(o,i.zOrder)}else s.setPosition(this.innerWidth/2,this.innerHeight/2),this.container.addChild(s)}}},highlight:function(e){e.addHighlight()},unhighlight:function(e){e.removeHighlight()},onEnter:function(){this._super(),cleverapps.config.debugMode&&cc.eventManager.addListener({event:cc.EventListener.KEYBOARD,onKeyPressed:function(e){if(e===cc.KEY.b&&!this.bordered)for(var t in this.bordered=!0,this.buildingViews){this.buildingViews[t].debugBorder();var n=this.buildingViews[t].building.id,s=this.buildingViews[t].building.amountStages();if(cleverapps.home)for(var i=0;i<cleverapps.home.furniture.length;i++)if(
cleverapps.home.furniture[i].id===this.buildingViews[t].building.id){n=i;break}var o=cleverapps.UI.generateImageText(n,cleverapps.styles.FONTS.BIG_TEXT),r=cleverapps.UI.generateOnlyText("Stages: "+s,cleverapps.styles.FONTS.TEXT),a=new cleverapps.Layout([r,o],{direction:cleverapps.UI.VERTICAL,margin:0});this.buildingViews[t].addChild(a,10),a.setPositionRound(this.buildingViews[t].width/2,this.buildingViews[t].height/2),a.replaceParentSamePlace(this.buildingViews[t].parent),this.buildingViews[t].idView=a}}.bind(this),onKeyReleased:function(e){if(e===cc.KEY.b)for(var t in this.bordered=!1,this.buildingViews)this.buildingViews[t].cleanupBorder(),this.buildingViews[t].idView.removeFromParent()}.bind(this)},this),this.onEnterStart()},availableScrollPosition:function(e){var t=this.getContainerSize(),n=t.width-this.width,s=t.height-this.height;return 0<e.x?e.x=0:e.x<-n&&(e.x=-n),0<e.y?e.y=0:e.y<-s&&(e.y=-s),e},scrollTo:function(e,t,n){if(e){t||cleverapps.metha.isFocused()||(console.log(
"Scroll:",e),cleverapps.metha.debugMessage("Trying to scroll without user focus!"));var s=cleverapps.metha.focus,i=this.buildingViews[e.name].getPosition(),o={x:this.width/2-i.x,y:this.height/2-i.y};if(o=this.availableScrollPosition(o),t)this.setContainerPosition({x:o.x,y:o.y}),n&&n();else{var r=this.getContainerPosition();r.x-=o.x,r.y-=o.y;var a=Math.sqrt(r.x*r.x+r.y*r.y)/1300;a=Math.min(.7,Math.max(.3,a)),this.container.stopAllActions(),this.container.runAction(new cc.Spawn(new cc.MoveTo(a,o.x,o.y).easing(new cc.easeInOut(2.5)),new cc.Repeat(new cc.Sequence(new cc.DelayTime(.025),new cc.CallFunc(this.updateChildren.bind(this))),Math.ceil(a/.025))));var c=new Error;this.runAction(new cc.Sequence(new cc.DelayTime(.45*a||.5),new cc.CallFunc(function(){cleverapps.metha.isFocused()&&cleverapps.metha.focus===s||(console.log("Scroll:",e,s,cleverapps.metha.focus),cleverapps.throwAsync("Trying to scroll without user focus! Focus: "+cleverapps.metha.focus+" StartFocus: "+s,c)),n&&n()}.bind(
this))))}}},showBuildings:function(s){var n=[];s.forEach(function(e,t){e.isComplete()&&e.throwaway||n.push(t)}),n.sort(function(e,t){return s[t].y-s[e].y}.bind(this)),n.forEach(function(e){var t=s[e],n=new BuildingView(t,this);this.buildingViews[t.name]=n,this.container.addChild(n)},this)},removeBuilding:function(e){var t=this.buildingViews[e.name];t&&(t.runAction(new cc.RemoveSelf),delete this.buildingViews[e.name])},removeTarget:function(){this.finger&&(this.finger.removeFromParent(),delete this.finger)},addTarget:function(e){this.removeTarget();var t=this.finger=new FingerView({control:"world_map_finger"});t.setLocalZOrder(3e3),this.container.addChild(t),t.fadeIn({x:0,y:0}),t.delay(.1),t.press(),t.delay(.1),t.unPress(),t.delay(.1),t.press(),t.delay(.1),t.unPress(),t.fadeOut(),t.delay(1),t.run({looped:!0});var n=this.buildingViews[e.name].getPosition();t.setPositionRound(n)},findClickedBuilding:function(e){var t;for(var n in this.buildingViews){var s=this.buildingViews[n]
;s.building.canTouch()&&((!t||t.getLocalZOrder()<=s.getLocalZOrder())&&cc.rectContainsPoint(cc.rect(0,0,s.width,s.height),s.convertTouchToNodeSpace(e))&&(t=s))}return t},onTouchBegan:function(e){if(this._super(e))return this.clickedBuilding=this.findClickedBuilding(e),!0},onTouchMoved:function(e){this._super(e),cc.pLength(cc.pSub(e.getStartLocation(),e.getPreviousLocation()))>cleverapps.styles.UI.onClick.ignoreOnTouchMovedThreshold&&delete this.clickedBuilding},onTouchEnded:function(e){this._super(e),this.clickedBuilding&&!this.pinchZooming&&(this.scrollHandler.stopAutoScroll(),this.clickedBuilding.building.onClick()),delete this.clickedBuilding}});cleverapps.styles.WorldMap={personsAnimation:"animation",persons:{},zoom:{base:1,unfocused:.7,minScale:.5}};var MissionGame=function(e){this.mission=e,BaseGame.call(this)};MissionGame.prototype=Object.create(BaseGame.prototype),(MissionGame.prototype.constructor=MissionGame).prototype.finish=function(){
this.running&&0<this.reward&&this.mission.update(this.reward),BaseGame.prototype.finish.apply(this,arguments)};var TreasureSearchWindow=Window.extend({onWindowLoaded:function(e){this.bundle=bundles[e.getWindowBundleName()],this.game=new TreasureSearch(e),this.game.on("open",this.open.bind(this)),this.game.on("prize",this.prize.bind(this)),this.game.on("finish",this.finish.bind(this)),this.generateContent();var t=cleverapps.styles.TreasureSearchWindow,n={title:"messages:TreasureSearchWindow.Title",name:"treasuresearchwindow",content:this.content,closeButton:t.closeButton,styles:cleverapps.overrideStyles(cleverapps.styles.Window,cleverapps.styles.TreasureSearchWindow.window,!0),help:this.onClickHelp.bind(this)};t.button&&(n.button={width:t.button.width,text:Messages.get(t.button.text),onPressed:this.close.bind(this)}),this._super(n),this.controls(),e.isRunning()&&(this.timer=new cleverapps.CountDown(e.getTimeLeft(),{onFinish:function(){this.close()}.bind(this)})),this.game.isFinished(
)&&this.game.finish({silent:!0}),e.needShowStartWindow=!1,cleverapps.audio.playSound(bundles.main.urls.treasure_search_effect)},onExit:function(){this._super(),this.timer&&this.timer.stop()},controls:function(){cc.eventManager.addListener({event:cc.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:!0,onTouchBegan:this.onTouchBegan.bind(this),onTouchEnded:this.onTouchEnded.bind(this)},this.fieldNode),cc.eventManager.addListener({event:cc.EventListener.MOUSE,onMouseMove:this.onMouseMove.bind(this)},this.fieldNode)},calculateIndex:function(e){var t=this.fieldNode.convertTouchToNodeSpace(e),n=cc.rect(0,0,this.fieldNode.width,this.fieldNode.height);if(cc.rectContainsPoint(n,t)){var s=cleverapps.styles.TreasureSearchWindow.game.cell,i=Math.floor(t.x/s.width),o=Math.floor(t.y/s.height);return{row:Math.max(Math.min(o,TreasureSearch.HEIGHT-1),0),col:Math.max(Math.min(i,TreasureSearch.WIDTH-1),0)}}},onTouchBegan:function(e){return!(!this.game.running||this.game.paused)&&void 0!==this.calculateIndex(
e)},onTouchEnded:function(e){if(this.game.running&&!this.game.paused){var t=this.calculateIndex(e);t&&this.onFieldClick(t.col,t.row)}},getPositionInContent:function(e){return this.content.convertToNodeSpace(e.getParent().convertToWorldSpace(e.getPosition()))},processPointer:function(){var e=this.field[this.index.row][this.index.col];this.pointer||this.createPointer(e),this.pointer.setPositionRound(this.getPositionInContent(e)),this.pointer.setVisible(!0),this.pointer.updateState(e)},createPointer:function(e){var t=cleverapps.styles.TreasureSearchWindow;if(t.pointerJson){this.pointer=new cc.Node,this.pointer.setAnchorPoint2(),this.pointer.setContentSize2(e.cover.getContentSize());var n=new cleverapps.Spine(t.pointerJson);this.pointer.addChild(n),n.setPositionRound(this.pointer.width/2,this.pointer.height/2),this.pointer.updateState=function(){n.setAnimation(0,"animation",!1),cleverapps.audio.playSound(this.bundle.urls.shot_sfx)}.bind(this)}else{this.pointer=new cc.Sprite(
e.cover.getSpriteFrame()),this.pointer.setScale(this.fieldNode.scale);var s=new cc.Sprite(this.bundle.frames.cross);s.setPosition(this.pointer.width/2,this.pointer.height/2),this.pointer.addChild(s);var i=new cc.Sprite(this.bundle.frames.hover_bottom);i.setPosition(this.pointer.width/2,this.pointer.height/2),this.pointer.addChild(i,-1),i.runAction(new cc.RepeatForever(new cc.Sequence(new cc.ScaleTo(.7,1.04),new cc.ScaleTo(.8,.95).easing(cc.easeInOut(1))))),this.pointer.updateState=function(e){this.pointer.setSpriteFrame(e.cover.getSpriteFrame())}.bind(this)}this.pointer.setLocalZOrder(21),this.content.addChild(this.pointer)},onMouseMove:function(e){if(this.game.running&&!this.game.paused){var t=this.calculateIndex(e);t&&this.game.hasElement(t.col,t.row)?void 0!==this.index&&100*t.row+t.col===100*this.index.row+this.index.col||(this.index=t,this.processPointer()):(this.pointer&&this.pointer.setVisible(!1),this.index=void 0)}},generateContent:function(){
var e=cleverapps.styles.TreasureSearchWindow.content,t=this.createGame(),n=this.text=cleverapps.UI.generateTTFText("messages:TreasureSearchWindow.text",cleverapps.styles.FONTS.WINDOW_SMALL_TEXT);if(n.setDimensions(t.width*e.text.widthMultiplier[cleverapps.wideMode.mode],0),n.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER),this.content=new cleverapps.Layout([n,t],{direction:cleverapps.UI.VERTICAL,margin:e.margin,padding:e.padding}),e.successAnimation){var s=this.succesAnimation=new cleverapps.Spine(this.bundle.jsons.chest),i=this.content.convertToNodeSpace(this.fieldNode.getParent().convertToWorldSpace(this.fieldNode.getPosition()));s.setPosition(i),s.setVisible(!1),s.setLocalZOrder(22),this.content.addChild(s)}},createGame:function(){var e=cleverapps.styles.TreasureSearchWindow,t=this.fieldNode=this.createField(),n=this.infoNode=this.createGameInfo();return new cleverapps.Layout([t,n],{direction:cleverapps.UI.VERTICAL,margin:e.game.margin})},createField:function(){this.field=[];for(
var e=0;e<TreasureSearch.HEIGHT;e++){for(var t=[],n=0;n<TreasureSearch.WIDTH;n++){var s=this.createCell();t.push(s),this.game.hasElement(n,e)?this.createActiveCellContent(n,e,s):this.createOpenedCellContent(n,e,s,!0)}this.field.push(t)}var i=this.field.map(function(e){return new cleverapps.Layout(e,{direction:cleverapps.UI.HORIZONTAL})}),o=this.fieldNode=new cleverapps.Layout(i,{direction:cleverapps.UI.VERTICAL});if(this.bundle.frames.map){var r=new cc.Sprite(this.bundle.frames.map);r.setPosition(o.width/2,o.height/2),r.setLocalZOrder(-1),o.addChild(r),o.setScale(cleverapps.styles.TreasureSearchWindow.game.field.scale[cleverapps.wideMode.mode])}return o},createCell:function(){var e=new cc.Node;return e.setAnchorPoint2(),e.setContentSize2(cleverapps.styles.TreasureSearchWindow.game.cell),e},createActiveCellContent:function(e,t,n){var s=n.cover=new cc.Sprite(this.bundle.frames["cover_"+(TreasureSearch.WIDTH*t+e)]);s.setPosition(n.width/2,n.height/2),n.addChild(s)},
createOpenedCellContent:function(e,t,n,s){if(this.game.gemWasThere(e,t)){var i=new cc.Sprite(this.bundle.frames.cross);i.setPosition(n.width/2,n.height/2),n.addChild(i),s||(i.setScale(0),i.runAction(new cc.Sequence(new cc.DelayTime(1),new cc.ScaleTo(.4,1).easing(cc.easeBackOut()))))}},onFieldClick:function(e,t){this.game.mission.currency>=this.game.mission.getMinigamePrice()?this.game.hasElement(e,t)&&(this.game.open(e,t),cleverapps.audio.playSound(bundles.main.urls.treasure_search_open_effect)):(this.field[t][e].setScale(1),new TellWindow({type:"notEnoughElements",text:"messages:TreasureSearchWindow.Currency.Text",title:"messages:TreasureSearchWindow.Currency.Title",buttonText:Messages.get("Play"),onPressed:function(){this.close(),cleverapps.metha.distract({focus:"TreasurePlayButtonPressed",action:function(e){cleverapps.metha.wantsToPlay(e,{mission:!0})}})}.bind(this)}))},onClickHelp:function(){var e=cleverapps.styles.TreasureSearchWindow.rulesWindow
;e.animation.json=bundles.treasuresearch.jsons.help,new RulesWindow({name:"ruleswindow",styles:e})},createGameInfo:function(){var e=cleverapps.styles.TreasureSearchWindow.game.infoNode,t=new cc.Node;t.setAnchorPoint2(),t.setContentSize2(e.chest),this.chest=new cleverapps.Spine(this.bundle.jsons.chest),this.chest.setAnimation(0,"idle_"+this.game.mission.result,!0),t.addChild(this.chest),this.chest.setPositionRound(t.width/2,t.height/2+e.chest.offsetY);var n=new cc.Node;n.setAnchorPoint2(),n.setPositionRound(t.width/2,t.height/2),n.setContentSize2(e.tooltip),t.addChild(n),cleverapps.tooltipManager.create(n,{rewards:this.game.getReward(),text:Messages.get("TreasureSearch.prizeTooltip"),position:cleverapps.styles.UI.Tooltip.LOCATION.above});var s=this.amountText=cleverapps.UI.generateImageText(this.game.mission.currency,cleverapps.styles.FONTS.SHOVEL_FONT);s.setPositionRound(e.shovelCount),t.addChild(s);var i=new cc.Sprite(this.bundle.frames.shovel);return i.setPositionRound(e.shovel),
t.addChild(i),cleverapps.tooltipManager.create(i,{text:Messages.get("ShovelsTooltip"),position:cleverapps.styles.UI.Tooltip.LOCATION.below}),t},open:function(e){var t=this.field[e.row][e.col];this.pointer&&this.pointer.setVisible(!1),t.runAction(new cc.Sequence(new cc.CallFunc(function(){var e=this.clouds=new cleverapps.Spine(this.bundle.jsons.clouds);e.setLocalZOrder(21),this.content.addChild(e),e.setCompleteListener(function(){e.runAction(new cc.RemoveSelf)}.bind(this)),e.setAnimation(0,"animation",!1),e.setPosition(this.getPositionInContent(t))}.bind(this)),new cc.DelayTime(.05),new cc.CallFunc(function(){t.cover&&t.cover.setVisible(!1)}))),this.amountText.setString(this.game.mission.currency)},prize:function(e){var t=this.field[e.row][e.col];this.createOpenedCellContent(e.col,e.row,t),this.runAction(new cc.Spawn(new cc.Sequence(new cc.DelayTime(.5),new cc.CallFunc(function(){this.succesAnimation&&(this.succesAnimation.setCompleteListener(function(){
this.succesAnimation.setCompleteListener(function(){}),this.succesAnimation.setVisible(!1)}.bind(this)),this.succesAnimation.setAnimation(0,cleverapps.styles.TreasureSearchWindow.content.successAnimation,!1),this.succesAnimation.setVisible(!0)),cleverapps.audio.playSound(bundles.main.urls.treasure_search_found_effect)}.bind(this))),new cc.Sequence(new cc.DelayTime(1.65),new cc.CallFunc(function(){cleverapps.audio.playSound(bundles.main.urls.treasure_search_part_effect),this.chest.setAnimation(0,"animation_"+this.game.mission.result,!1),this.chest.addAnimation(0,"idle_"+this.game.mission.result,!0)}.bind(this)),new cc.DelayTime(1.5),new cc.CallFunc(function(){this.game.isFinished()&&cleverapps.audio.playSound(bundles.main.urls.treasure_search_prize_effect)}.bind(this)))))},finish:function(e){this.runAction(new cc.Sequence(new cc.DelayTime(e&&e.silent?.1:3.6),new cc.CallFunc(function(){this.close()}.bind(this))))},onClose:function(){this.game.checkIfComplete()}})
;TreasureSearchWindow.prototype.listBundles=function(){return["treasuresearch"]},cleverapps.overrideFonts(cleverapps.styles.FONTS,{SHOVEL_FONT:{name:"default",size:40}}),cleverapps.styles.TreasureSearchWindow={content:{margin:10,padding:{x:0,y:45},text:{widthMultiplier:[.8,.9,.9]},successAnimation:"key"},game:{margin:0,cell:{width:116,height:96},field:{scale:[1.2,1.15,1.15]},infoNode:{shovelCount:{x:{align:"center",dx:285},y:{align:"center",dy:12}},shovel:{x:{align:"center",dx:240},y:{align:"center",dy:26}},chest:{width:570,height:285,offsetY:0},tooltip:{width:300,height:180}}},rulesWindow:{prefix:"messages:TreasureSearchWindow.Help.",bundles:["treasuresearch"],animation:{height:630,y:-145},subText:{width:220,left:{x:{align:"left",dx:0},y:{align:"top",dy:-245}},right:{x:{align:"right",dx:10},y:{align:"top",dy:-245}}}},window:{contentOffset:-30,Title:{bg:{adjustToText:{width:50}}},Border:{y:50}}};var TreasureSearch=function(e){MissionGame.call(this,e),this.width=TreasureSearch.WIDTH,
this.height=TreasureSearch.HEIGHT,this.field=e.details&&e.details.field,this.field||this.createField()};TreasureSearch.prototype=Object.create(MissionGame.prototype),(TreasureSearch.prototype.constructor=TreasureSearch).prototype.createField=function(){for(var e=[];e.length<TreasureSearch.GEMS;){var t=cleverapps.Random.random(0,19);-1===e.indexOf(t)&&e.push(t)}this.field=[];for(var n=0;n<TreasureSearch.HEIGHT;n++){this.field[n]=[];for(var s=0;s<TreasureSearch.WIDTH;s++){var i=TreasureSearch.ELEMENT_EMPTY;-1!==e.indexOf(n*TreasureSearch.WIDTH+s)&&(i=TreasureSearch.ELEMENT_GEM),this.field[n][s]=i}}this.mission.details={field:this.field}},TreasureSearch.prototype.open=function(e,t){if(this.hasElement(e,t)){var n=this.field[t][e];this.field[t][e]=TreasureSearch.ELEMENT_GEM===n?TreasureSearch.ELEMENT_FOUND:TreasureSearch.ELEMENT_OPENED,this.mission.updateCurrency(-this.mission.getMinigamePrice(),{field:this.field});var s={row:t,col:e};this.trigger("open",s),this.pause();var i=1e3
;TreasureSearch.ELEMENT_GEM===n&&(this.mission.update(1),this.trigger("prize",{row:t,col:e,score:this.mission.result}),i=3e3),setTimeout(this.resume.bind(this),i),this.isFinished()&&this.finish()}},TreasureSearch.prototype.checkIfComplete=function(){this.isFinished()&&this.mission.isRunning()&&(this.mission.complete(),-1!==["olympics","tripeaks"].indexOf(cleverapps.config.name)&&cleverapps.eventLogger.logEvent(cleverapps.EVENTS.TREASURE_SEARCH_FINISH),new RewardWindow({reward:this.getReward(),mission:this.mission}))},TreasureSearch.prototype.getReward=function(){return this.mission.getPrize()},TreasureSearch.prototype.hasElement=function(e,t){return this.field[t]&&void 0!==this.field[t][e]&&this.field[t][e]!==TreasureSearch.ELEMENT_OPENED&&!this.gemWasThere(e,t)},TreasureSearch.prototype.gemWasThere=function(e,t){return this.field[t]&&void 0!==this.field[t][e]&&this.field[t][e]===TreasureSearch.ELEMENT_FOUND},TreasureSearch.prototype.isFinished=function(){if(
this.mission.result>=TreasureSearch.GEMS)return!0;if(this.field){for(var e=0,t=0,n=0;n<TreasureSearch.WIDTH;n++)for(var s=0;s<TreasureSearch.HEIGHT;s++)this.hasElement(n,s)&&e++,this.gemWasThere(n,s)&&t++;return 0===e||t>=TreasureSearch.GEMS}return!1},TreasureSearch.WIDTH=5,TreasureSearch.HEIGHT=4,TreasureSearch.GEMS=4,TreasureSearch.ELEMENT_EMPTY="e",TreasureSearch.ELEMENT_OPENED="o",TreasureSearch.ELEMENT_FOUND="f",TreasureSearch.ELEMENT_GEM="g",TreasureSearch.ALL_ELEMENT_VALUES=[TreasureSearch.ELEMENT_EMPTY,TreasureSearch.ELEMENT_OPENED,TreasureSearch.ELEMENT_FOUND,TreasureSearch.ELEMENT_GEM];var StickersCollectionWindow=Window.extend({onWindowLoaded:function(e){var t=cleverapps.styles.StickersCollectionWindow;this.game=new StickersCollection(e),this.generateContent();var n={title:"messages:StickersCollectionWindow.Title",name:"stickerscollectionwindow",content:this.content,closeButton:t.closeButton,notCloseByTouchInShadow:!0,styles:cleverapps.overrideStyles(cleverapps.styles.Window
,cleverapps.styles.StickersCollectionWindow.window,!0),help:this.onClickHelp.bind(this)};t.button&&(n.button={width:t.button.width,text:Messages.get(t.button.text),onPressed:this.close.bind(this)}),this._super(n),e.isRunning()&&(this.timer=new cleverapps.CountDown(e.getTimeLeft(),{onFinish:function(){this.close()}.bind(this)})),this.game.isFinished()&&this.game.finish({silent:!0}),e.needShowStartWindow=!1,cleverapps.audio.playSound(bundles.main.urls.stickers_collection_effect)},onExit:function(){this._super(),this.timer&&this.timer.stop()},onClose:function(){this.game.checkIfComplete()},onClickHelp:function(){new MissionRulesWindow(this.game.mission)},generateContent:function(){var e=cleverapps.styles.StickersCollectionWindow,t=this.createBook(),n=cleverapps.UI.generateOnlyText("messages:StickersCollectionWindow.text",cleverapps.styles.FONTS.WINDOW_SMALL_TEXT);n.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER),n.setDimensions(e.book.width,0);var s=e.progressBar,
i=cleverapps.UI.generateOnlyText("messages:MissionRulesWindow.StickersCollection.leftToPrize",cleverapps.styles.FONTS.WINDOW_SMALL_TEXT);i.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER),i.setDimensions(s.size.width,0);var o=Math.min(this.game.mission.result,StickersCollection.GEMS),r=new ScaledProgressBar(bundles.stickers_collection.frames.progress_bar);r.setMinProgressWidth(s.bar.minWidth),r.setPercentage(o/StickersCollection.GEMS*100),r.setDimension(s.size.width-s.bar.paddingX,s.size.height-s.bar.paddingY),r.setPositionRound(s.bar);var a=cleverapps.UI.generateImageText(o+"/"+StickersCollection.GEMS,cleverapps.styles.FONTS.TREASURE_SEARCH_PROGRESS_BAR_TEXT);a.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER),a.setPositionRound(s.text);var c=new cleverapps.Spine(s.gift.json);c.setSkin(s.gift.skin),c.setAnimation(0,"animation",!0),c.setPositionRound({align:"right",dx:c.width+s.gift.offsetX},{align:"center",dy:s.gift.offsetY}),c.setScale(s.gift.scale),cleverapps.tooltipManager.create(c,
{rewards:this.game.getReward(),text:Messages.get("StickersCollectionWindow.prizeTooltip"),position:cleverapps.styles.UI.Tooltip.LOCATION.above,size:e.tooltipSize});var l=cleverapps.UI.createScale9Sprite(bundles.stickers_collection.frames.progress_bar_bg);l.setContentSize2(s.size),l.addChild(r),l.addChild(a),l.addChild(c);var p=new cleverapps.Layout([l,i],{direction:cleverapps.UI.VERTICAL,margin:e.margin,padding:{x:0,y:2*e.margin}});this.content=new cleverapps.Layout([p,n,t],{direction:cleverapps.UI.VERTICAL,margin:e.margin}),this.content.setLocalZOrder(2)},createBook:function(){var e=cleverapps.styles.StickersCollectionWindow,t=new cleverapps.Spine(bundles.stickers_collection.jsons.book,1);t.setAnimation(0,"animation",!1),t.addAnimation(0,"idle",!0),t.setPositionRound({align:"center"},{align:"center"});var n=this.bookNode=new cc.Node;if(n.setAnchorPoint2(),n.setContentSize2(e.book),n.addChild(t),bundles.stickers_collection.jsons.light){var s=new cleverapps.Spine(
bundles.stickers_collection.jsons.light,1);s.setAnimation(0,"animation",!1),s.setPositionRound({align:"center"},{align:"center"}),n.addChild(s)}return this.game.open(),n},listBundles:function(){return["stickers_collection"]}});cleverapps.styles.StickersCollectionWindow={window:{maxTitleSize:{scale:.65}},progressBar:{size:{width:410,height:52},gift:{json:bundles.windows.jsons.present_json,skin:"blue",scale:.9,offsetX:-60,offsetY:25},bar:{paddingX:5,paddingY:10,minWidth:40,x:{align:"left",dx:2},y:{align:"center"}},text:{x:{align:"center"},y:{align:"center"}}},margin:20,book:{width:600,height:400},closeButton:!1,button:{width:160,text:"OK"},tooltipSize:{width:200,height:100}};var StickersCollection=function(e){MissionGame.call(this,e)};StickersCollection.prototype=Object.create(MissionGame.prototype),(StickersCollection.prototype.constructor=StickersCollection).prototype.open=function(){var e=this.mission.currency;this.mission.updateCurrency(-e),this.mission.update(e),this.isFinished(
)&&this.finish()},StickersCollection.prototype.checkIfComplete=function(){this.isFinished()&&this.mission.isRunning()&&(this.mission.complete(),new RewardWindow({reward:this.getReward(),mission:this.mission}))},StickersCollection.prototype.isFinished=function(){return this.mission.result>=StickersCollection.GEMS},StickersCollection.prototype.getReward=function(){return this.mission.getPrize()},StickersCollection.GEMS=25,StickersCollection.GEMS_BY_PLACE={1:5,2:3,3:1};var StickersCollectionLogic=function(e){this.mission=e};StickersCollectionLogic.prototype.isMinigameReadyToFinish=function(){return this.mission.result+this.mission.currency>=StickersCollection.GEMS};var TellWindow=Window.extend({onWindowLoaded:function(e){this.params=e,this.createContent(),e={content:this.content,name:this.getName(),title:this.params.title,button:{width:cleverapps.styles.TellWindow.button.width,text:this.params.buttonText||Messages.get("OK"),onPressed:function(){this.close(),
this.params.onPressed&&this.params.onPressed()}.bind(this)}},cleverapps.styles.TellWindow.window&&(e.styles=cleverapps.overrideStyles(cleverapps.styles.Window,cleverapps.styles.TellWindow.window,!0)),cleverapps.audio.playSound(bundles.main.urls.window_effect),this._super(e)},getName:function(){return"tellwindow"},createContent:function(){var e=cleverapps.styles.TellWindow,t=this.createText(),n=[t];if(e.hero){var s=new HeroView(e.hero);s.setLocalZOrder(1),this.addChild(s)}else{var i=new StoryTeller;i.setLocalZOrder(1),i.setScale(e.char.scale[cleverapps.wideMode.mode]),n.unshift(i)}if(this.content=new cleverapps.Layout(n,{direction:cleverapps.wideMode.mode===cleverapps.WideMode.VERTICAL?cleverapps.UI.VERTICAL:cleverapps.UI.HORIZONTAL,margin:e.margin[cleverapps.wideMode.mode]*resolutionScale,padding:{x:0,y:e.padding.y[cleverapps.wideMode.mode]*resolutionScale}}),i){if(cleverapps.wideMode.mode!==cleverapps.WideMode.VERTICAL){var o=i.height-t.height;0<o&&(t.y+=o/4)}i.y+=e.char.dy}},
createText:function(){var e=cleverapps.styles.TellWindow;e.types&&e.types[this.params.type]&&(e=cleverapps.overrideStyles(e,e.types[this.params.type],!0));var t=cleverapps.UI.generateTTFText(this.params.text,cleverapps.styles.FONTS.WINDOW_TEXT);return t.setDimensions(e.text.width[cleverapps.wideMode.mode]*resolutionScale,0),t.setHorizontalAlignment(e.horizontalAlignment),t.fitTo(void 0,e.text.height[cleverapps.wideMode.mode]*resolutionScale),t},listBundles:function(){return StoryTeller.listBundles()}});cleverapps.styles.TellWindow={width:660,height:350,margin:[40,50,50],horizontalAlignment:cc.TEXT_ALIGNMENT_CENTER,padding:{y:[50,10,10]},char:{scale:[1,1,1],dy:0},text:{width:[600,450,450],height:[270,300,300]},button:{width:260}};var FriendRequestsWindow=Window.extend({onWindowLoaded:function(){var e=new cc.Node;e.setAnchorPoint2(),this.content=e,this.createViews(),this._super({name:"friendrequestswindow",content:e,noBackground:!0,onClose:function(){cleverapps.toolbar.updateItems()}})
;var t=cleverapps.FBLoginOrInvite();t&&this.addChild(t),cleverapps.audio.playSound(bundles.main.urls.window_effect)},createViews:function(){var e=cleverapps.styles.FriendRequestsWindow;this.requestsViews=[],this.requestsIds=[],this.pendingViews=[],this.pendingIds=[];for(var t=[],n=0;n<levels.friendRequests.notProcessed.length;n++){var s=this.createRequestView(levels.friendRequests.notProcessed[n]);s&&t.push(s)}t.forEach(function(e){this.requestsViews.length<FriendRequestsWindow.MAX_SHOW_REQUESTS?(this.content.addChild(e),this.requestsViews.push(e),this.requestsIds.push(e.model.getId())):(this.content.addChild(e),e.setVisible(!1),this.pendingViews.push(e),this.pendingIds.push(e.model.getId()))},this);var i=cleverapps.UI.arrangeWithMargins(this.requestsViews.slice().reverse(),{direction:cleverapps.UI.VERTICAL,margin:e.margin,x:e.width/2,y:e.y});this.content.setContentSize2(e.width,i)},createRequestView:function(e){var o=e.getId(),t=e.getView();if(t)return new t(e,this,function(){
var e=this.getRequestIdViewOrder(o),t=this.requestsViews[0].getPosition();if(!1!==e){for(var n=e-1;0<=n;--n)this.requestsViews[n].isRunningSafe()&&this.requestsViews[n].runAction(new cc.MoveTo(this.getMoveTime(),this.requestsViews[n+1].getPosition()));this.requestsIds.splice(e,1),this.requestsViews.splice(e,1)}if(0===this.requestsViews.length&&0===this.pendingViews.length)this.close();else if(0<this.pendingViews.length){var s=this.pendingViews[0],i=this.pendingIds[0];this.pendingViews.splice(0,1),this.pendingIds.splice(0,1),this.requestsViews.splice(0,0,s),this.requestsIds.splice(0,0,i),s.setVisible(!0),s.setScale(0),s.setPosition(t),s.runAction(new cc.ScaleTo(this.getMoveTime(),1))}}.bind(this))},getRequestIdViewOrder:function(e){for(var t=0;t<this.requestsIds.length;t++)if(this.requestsIds[t]===e)return t;return!1},getMoveTime:function(){return.3}});FriendRequestsWindow.MAX_SHOW_REQUESTS=4,cleverapps.styles.FriendRequestsWindow={width:400,margin:15,y:0}
;var RewardWindow=Window.extend({onWindowLoaded:function(e){this.options=e=e||{},this.reward=e.reward,cleverapps.flags.doubleRewards&&(this.reward=cleverapps.doubleReward(this.reward)),this.styles=cleverapps.styles.RewardWindow,e.styles&&(this.styles=cleverapps.overrideStyles(this.styles,e.styles,!0)),void 0===e.animation&&(e.animation=this.styles.animation.json),this.createContent(),this._super({title:e.title||"messages:RewardWindow.title",name:e.name||"rewardwindow",content:this.content,minWidth:e.minWidth||this.styles.minWidth,minHeight:e.minHeight||this.styles.minHeight,button:{text:Messages.get(e.buttonText||"Claim"),width:this.styles.button.width,height:this.styles.button.height,onPressed:this.onPressed.bind(this)},buttons:this.getButtons(),shareCheckBox:this.getShareOptions(),noBackground:e.noBackground,closeButton:!1,notCloseByTouchInShadow:e.notCloseByTouchInShadow}),this.adjustRewardList(),this.content.y+=cleverapps.styles.RewardWindow.rewards.dy,this.runRewardsListAnimation(
)},adjustRewardList:function(){var e=this.rewardsList.width*this.rewardsList.scale;e>this.window.width&&this.rewardsList.setScale(this.rewardsList.scale*this.window.width/e)},getShareOptions:function(){var e=this.options.rewardName;return!1!==e&&{shareId:"reward",toReplace:{rewardName:Messages.get("RewardWindow."+(e||"default"))}}},createText:function(){var e=this.text=cleverapps.UI.generateTTFText(this.options.text,cleverapps.styles.FONTS.REWARD_WINDOW_TEXT||cleverapps.styles.FONTS.WINDOW_TEXT),t=this.options.textWidth||cleverapps.styles.RewardWindow.textWidth;return void 0!==t&&e.setDimensions(t,0),e.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER),e},addAnimation:function(){var e=this.options.animation;if(e){var t=e.json?e.json:e,n=new cleverapps.Spine(t);return n.setAnimation(0,"animation",!0),n.setPositionRound(this.rewardsList.width/2,this.rewardsList.height/2+this.styles.animation.y),n.setLocalZOrder(-1),this.rewardsList.addChild(n),n}},runRewardsListAnimation:function(){
this.rewardsList.iterateRewards(this.rewardItemAnimation.bind(this))},getContentItems:function(){var e=[];return this.rewardsList=this.createRewardsList(),e.push(this.rewardsList),this.options.text&&(this.text=this.createText(),e.push(this.text)),e},rewardItemAnimation:function(e){e.runAction(new cc.Sequence(new cc.ScaleTo(.2,1.3),new cc.ScaleTo(.2,1)))},createContent:function(){return this.content=new cleverapps.Layout(this.getContentItems(),{direction:cleverapps.UI.VERTICAL,margin:this.styles.margin,padding:this.styles.rewards.padding}),this.animation=this.addAnimation(),this.content},onShow:function(){this._super(),this.runAction(new cc.Sequence(new cc.DelayTime(.1),new cc.CallFunc(function(){this.visible&&cleverapps.audio.playSound(this.options.sound||bundles.main.urls.reward_window_effect)}.bind(this)))),this.animation&&(this.animation.scale=0,this.animation.runAction(new cc.ScaleTo(.5,1)))},createRewardsList:function(){return new RewardsListComponent(this.reward,{
font:cleverapps.styles.FONTS.REWARD_WINDOW_REWARDS_TEXT})},onReceiveReward:function(){},doubleReward:function(){this.reward=cleverapps.doubleReward(this.reward);var e=this.rewardsList.parent,t=this.rewardsList.getPosition();this.rewardsList.removeFromParent(!0),this.rewardsList=this.createRewardsList(),this.rewardsList.setPosition(t),e.addChild(this.rewardsList)},receiveReward:function(){this.reward&&(this.onReceiveReward(),cleverapps.Chest.prototype._receiveReward(this.reward),this.reward=[])},onClose:function(){this.receiveReward(),cleverapps.starChest&&!cleverapps.starChest.locked&&new StarChestWindow,this.options.callback&&this.options.callback()},onPressed:function(){this.close()},selectDoubleStrategy:function(){var e=[];if(cleverapps.social.isLoggedIn()&&(cleverapps.flags.noviral||e.push(RewardWindow.DOUBLE_INVITE),cleverapps.flags.noviral||cleverapps.flags.noshares||e.push(RewardWindow.DOUBLE_SHARE)),cleverapps.rewardedAdsManager.isAvailable(RewardedAdsManager.REWARDED)&&(
e.push(RewardWindow.DOUBLE_AD),e.push(RewardWindow.DOUBLE_AD)),0<e.length)return e[Math.floor(Math.random()*e.length)]},getButtons:function(){return[]},getDoubleButton:function(){if(!levels.user.isBeginner());},getDoubleRewardButtonContent:function(e,t){var n=cleverapps.styles.RewardWindow;this.options&&this.options.styles&&(n=cleverapps.overrideStyles(n,this.options.styles,!0));var s=new cc.Node,i=new cc.Sprite(e);i.setAnchorPoint2(),i.setScale(t),s.addChild(i);var o=cleverapps.UI.generateTTFText("messages:PeriodicBonus.DoubleRewardButton.Text",cleverapps.styles.FONTS.BUTTON_TEXT);return s.addChild(o),s.setContentSize2(i.width*i.scale+n.doubleButton.margin+o.width,i.height),i.setPositionRound(n.doubleButton.icon),o.setPositionRound(n.doubleButton.text),s},doubleRewardByInvite:function(n){var e={message:Messages.get("SettingsWindow.InviteFriends.message"),title:Messages.get("SettingsWindow.InviteFriends.title"),element:this.doubleButton},t=this.createListener(function(e,t){
e===cleverapps.Social.CODE_SUCCEED&&(Buttons.remove(this.doubleButton),this.doubleReward(),cleverapps.eventLogger.logEvent(cleverapps.EVENTS.DAILY_BONUS_DOUBLE+"_"+n))}.bind(this));n===RewardWindow.DOUBLE_INVITE?(cleverapps.history.add("invt",1),cleverapps.social.inviteFriends(e,t)):cleverapps.social.inviteFriendsShare(e,t)},doubleRewardByAd:function(){cleverapps.rewardedAdsManager.isAvailable(RewardedAdsManager.REWARDED)?(Buttons.remove(this.doubleButton),cleverapps.rewardedAdsManager.play(RewardedAdsManager.REWARDED,function(){cleverapps.playSession.inc(cleverapps.EVENTS.REWARDED_DAILY_BONUS),this.doubleReward(),cleverapps.eventLogger.logEvent(cleverapps.EVENTS.DAILY_BONUS_DOUBLE+"_"+RewardWindow.DOUBLE_AD)}.bind(this))):cleverapps.Notification.create("messages:AdsUnavailable")},listBundles:function(e){var t=[],n=e&&e.reward||{};return n.herolevels&&t.push("heroes"),(n.coins||n.wands)&&t.push("episode_0"),n.battlePass&&t.push("battle_pass"),t.push("reward_icons"),t}})
;RewardWindow.DOUBLE_SHARE=0,RewardWindow.DOUBLE_INVITE=1,RewardWindow.DOUBLE_AD=2,RewardWindow.NO_PAYMENTS_MODIFIER=2,cleverapps.styles.RewardWindow={margin:30,animation:{y:0,json:bundles.main.jsons.reward_spine_json},minWidth:600,minHeight:700,text:{x:0,y:150},rewards:{padding:{x:100,y:50},dy:0},button:{width:250,height:100},buttons:{margin:30},doubleButton:{margin:10,width:300,height:100,padding:{x:20,y:0},icon:{scale:.8,x:{align:"left",dx:3},y:{align:"center",dy:3}},text:{x:{align:"right"},y:{align:"center"}}}};var UserStatus=function(){cleverapps.EventEmitter.call(this),cleverapps.environment.isSceneWithPreview()?this.timeouts=[]:this.timeouts=[new UserStatusTimeout(cleverapps.parseInterval("10 seconds"),function(e,t){this.trigger("inactive_very_short",t)}.bind(this)),new UserStatusTimeout(cleverapps.parseInterval("20 seconds"),function(e,t){this.trigger("inactive_short",t)}.bind(this)),new UserStatusTimeout(cleverapps.parseInterval("60 seconds"),function(e,t){this.trigger(
"inactive_long",t)}.bind(this))]};UserStatus.prototype=Object.create(cleverapps.EventEmitter.prototype),(UserStatus.prototype.constructor=UserStatus).prototype.clear=function(){this.timeouts.forEach(function(e){e.clear()})},UserStatus.prototype.reportUserAction=function(){this.trigger("active"),this.timeouts.forEach(function(e){e.reset()})};var UserStatusTimeout=function(e,t){this.time=e,this.callback=t,this.reset()};UserStatusTimeout.prototype.reset=function(){this.clear(),this.hintTimeout=new cleverapps.LongTimeout(function(){this.callback(),this.reset()}.bind(this),this.time)},UserStatusTimeout.prototype.clear=function(){clearTimeout(this.hintTimeout)};var Counter=function(){this.value=0,this.onceZero=void 0,this.afterRunStages=void 0,this.stages=[],this.off=!1,this.onStageActivatedListener=function(){}};Counter.prototype.registerStage=function(t,e){for(var n=0;n<this.stages.length;n++)if(this.stages[n].handler===e)return;cleverapps.config.debugMode&&0<this.stages.filter(function(e
){return e.priority===t}).length&&alert("Multiple stages with same priority: "+t),this.stages.push({priority:t,handler:e}),this.stages.sort(function(e,t){return e.priority-t.priority})},Counter.prototype.runStages=function(){if(0===this.value&&!this.off)for(var e=0;e<this.stages.length;e++)if(this.stages[e].handler(),this.isActive())return void this.onStageActivatedListener()},Counter.prototype.turnOff=function(){this.off=!0},Counter.prototype.isActive=function(){return 0<this.value},Counter.prototype.trigger=function(){this.runStages()},Counter.prototype.inc=function(){this.value++},Counter.prototype.dec=function(){if(this.value--,0===this.value&&!this.off){if(this.onceZero){var e=this.onceZero;this.onceZero=void 0,e()}0!==this.value||this.off||this.runStages(),this.afterRunStages&&(this.afterRunStages(),this.afterRunStages=void 0)}},Counter.prototype.setTimeoutUnblocked=function(e,t){return setTimeout(function(){this.off||e()}.bind(this),t)},Counter.prototype.setTimeout=function(e,t
){return this.inc(),setTimeout(function(){this.off||(e(),this.dec())}.bind(this),t)},cleverapps.GameSaver={gamesData:[],findSave:function(t){return this.gamesData.filter(function(e){return Object.keys(e)[0]===t})[0]},load:function(e){var t=this.findSave(e);return(t=t&&JSON.parse(t[e]))||(t=cleverapps.DataLoader.load(e))&&this.saveInfo(e,t),t},reset:function(){cleverapps.GameSaver.gamesData=[];var e=GameBase.getStoreKey(levels.user.episode,levels.user.level);"merge"===cleverapps.config.type&&(e=GameBase.getStoreKey(0,0)),cleverapps.GameSaver.saveInfo(e,{}),cleverapps.synchronizer.addUpdateTask("games")},saveInfo:function(e,t){var n=this.findSave(e);if(n)this.gamesData[this.gamesData.indexOf(n)][e]=JSON.stringify(t);else{for(;this.gamesData.length>=cleverapps.DataLoader.FIFO_LIMIT;)this.gamesData.shift();var s={};s[e]=JSON.stringify(t),this.gamesData.push(s)}cleverapps.DataLoader.save(e,t,{fifoKey:cleverapps.DataLoaderTypes.GAME_SAVE_FIFO})},removeSave:function(e){var t=this.findSave(e)
;t&&this.gamesData.splice(this.gamesData.indexOf(t),1),cleverapps.DataLoader.remove(e,cleverapps.DataLoaderTypes.GAME_SAVE_FIFO)}};var FakeGame=function(e){if((Game.currentGame=this).counter={isActive:function(){return!0},registerStage:function(){},trigger:function(){},fieldCounter:{registerStage:function(){}},setTimeout:function(){}},this.onChangeOutcomeListeners={},this.levelContent=e,this.level={quick:!0,content:e,getHumanReadableNumber:function(){return cleverapps.humanReadableNumber(e.episodeNo,e.levelNo)},episode:{isBonusRound:function(){return!1},bundleId:function(){return Episode.BundleId(e.episodeNo)}},isHard:function(){return e.hard}.bind(this),isTricky:function(){return e.tricky}.bind(this)},"solitaire"===cleverapps.config.type&&(this.generator=new CardGenerator,this.table={getScreen:function(){return new Screen(0)}}),"match3"===cleverapps.config.type){var t=new Loader;this.field=new Field(t),this.loader=t,this.callsOnFieldReady=[],this.goals=new Goals(e),this.score={
addMoveExplode:function(){},addGoal:function(){}},Match3.counter=this.counter}"merge"===cleverapps.config.type&&cleverapps.extend(this,{tutorial:{isActive:function(){}},orders:{addOrder:function(){},updateOrder:function(){},chooseFreeRecipe:function(){}},gameLevel:{value:0,getLevel:function(){return 1},nextLevelThreshold:function(){return 1e3}},harvested:{canTakeList:function(){}},workers:{findAssigned:function(){},countRegularFree:function(){return 2},countRegularTotal:function(){return 2},isBonusWorkerBuyed:function(){return!1}},energyLottery:{isAvailable:function(){return!1},isReady:function(){return!1}},spawn:function(){return[]},decreasePrizeStageIfNeeded:function(e){return e},storeSave:function(){}}),"board"===cleverapps.config.type&&(this.board=new cleverapps.Board(this,[],[]),this.board.addHint=function(){},this.hintBooster={addHint:function(){}},this.keypad=new Keypad(this,{}),this.current=new cleverapps.Current(this,this.keypad),this.extra=new cleverapps.Extra(
this.levelContent,[])),cleverapps.config.rpg&&(this.enemies=Game.prototype.selectEnemies.call(this))};FakeGame.prototype.getMissionType=function(){},FakeGame.prototype.stop=function(){this.stopped||(this.stopped=!0,"merge"===cleverapps.config.type&&(this.map.stop(),InfoView.Clear()))};var GameBase=function(e,t){cleverapps.EventEmitter.call(this),Game.currentGame=this,cleverapps.user.incProgressCompare(),this.levelContent=e.content,this.level=e,this.options=t||{},this.timer=new GameTimer,this.counter=new Counter,this.boostersBefore=this.options.boostersBefore,this.levelWithCoins=!e.isRegular()||e.isCurrentLevel()||cleverapps.user.isPassedAll()&&cleverapps.metha.getType()===Metha.SIMPLE&&cleverapps.user.checkAvailable(GameBase.LEVEL_WITH_COINS_AVAILABLE),cleverapps.Combo&&cleverapps.Combo.isAvailable()&&(this.combo=new cleverapps.Combo(this));var n=cleverapps.userresult.getStarsForLevel(this.level.episodeNo,this.level.levelNo);if(this.level.isRegular()&&(this.level.isNew(
)||cleverapps.config.results&&3!==n)){var s=cleverapps.missionManager.getRunningMission(Missions.SEMAPHORE_CLASSIC);s&&(this.gameMission=s)}if(this.level.isRegular()&&this.level.isNew()){var i=cleverapps.missionManager.getRunningMission(Missions.SEMAPHORE_BACKGROUND);i&&(this.backgroundMission=i)}if(this.userStatus=new UserStatus,this.rewards={},void 0!==this.gameMission&&this.gameMission.isRunning()&&(this.rewards[GameBase.REWARD_CLOVER]=0),this.backgroundMission&&this.backgroundMission.isRunning()){var o=this.backgroundMission.getLevelReward(),r=o[0];this.level.isHard()&&(r=o[1]),this.level.isTricky()&&(r=o[2]),this.rewards[GameBase.REWARD_BACKGROUND_CLOVER]=r}cleverapps.piggyBank&&cleverapps.piggyBank.isActive()&&!cleverapps.piggyBank.isFull()&&(this.rewards[GameBase.REWARD_PIGGY_BANK]=cleverapps.piggyBank.getAddAmount()),this.level.isRegular()&&this.level.isNew()&&levels.user.expAvailable()&&(this.rewards[GameBase.REWARD_EXP]=this.level.isHard(
)?GameBase.HARD_LEVEL_EXP_PRIZE:GameBase.EXP_PRIZE),-1!==["board","solitaire","differences"].indexOf(cleverapps.config.type)&&(this.level.isCurrentLevel()||this.level.episode.isDailyCup()||this.level.episode.isDailyLevel()||this.level.episode.isBonusWorldLevel()||cleverapps.config.editorMode)&&(this.basicGoldReward=10,this.level.isTricky()&&(this.basicGoldReward=20),this.level.isHard()&&(this.basicGoldReward=30),this.rewards[GameBase.REWARD_GOLD]=this.basicGoldReward),this.level.episode.isBonusRound()&&(this.rewards[GameBase.REWARD_GOLD]=cleverapps.BonusRoundChest.REWARD),this.levelWithTutorial&&this.levelWithTutorial()?cleverapps.Random.seed(this.level.getHumanReadableNumber()-1):cleverapps.Random.randomSeed(),this.onCloverAdded=function(){},this.onGoldRewardAdded=function(){},this.onGameMessage=function(){},this.outcome=GameBase.OUTCOME_UNKNOWN,this.onChangeOutcomeListeners={},this.afterOnChangeOutcomeListeners={},cleverapps.missionManager.getRunningMission(Missions.SEMAPHORE_LANTERN
)&&cleverapps.missionManager.getRunningMission(Missions.SEMAPHORE_LANTERN).logic.lantern.isActive(this.level)&&cleverapps.missionManager.getRunningMission(Missions.SEMAPHORE_LANTERN).logic.lantern.onStart(),this.boostersBefore&&this.boostersBefore.onStart(),cleverapps.competitionStatistics.onGameStarted(this)};GameBase.prototype=Object.create(cleverapps.EventEmitter.prototype),(GameBase.prototype.constructor=GameBase).prototype.getInfo=function(){},GameBase.prototype.getInitialInfo=function(){},GameBase.prototype.storeSave=function(){if(-1!==["match3","board","merge"].indexOf(cleverapps.config.type)&&!cleverapps.isRumble()&&(this.level.isRegular()||this.level.episode.isDailyCup()||this.level.episode.isDailyLevel()||this.level.episode.isBonusWorldLevel())){var e=this.getInfo();console.log("storeSave"),console.log(e),cleverapps.GameSaver.saveInfo(GameBase.getStoreKey(this.level),e),cleverapps.synchronizer.addUpdateTask("games")}},GameBase.prototype.loadSave=function(){
var e=cleverapps.GameSaver.load(GameBase.getStoreKey(this.level));return cleverapps.isRumble()&&(e=void 0),e||this.getInitialInfo()},GameBase.getStoreKey=function(e,t){if("object"==typeof e){var n=e;e=n.episode.episodeNo,t=n.levelNo}return cleverapps.config.prefix+cleverapps.social.getLocalStoragePreffix()+"_level_"+t+"x"+e},GameBase.prototype.getDailyCupStars=function(){return 1},GameBase.prototype.initPool=function(){},GameBase.prototype.stop=function(){this.counter.turnOff(),this.userStatus.clear(),this.combo&&this.combo.stop(),cleverapps.menuBar.stopItems(),this.stopped=!0,this.trigger("stop")},GameBase.prototype.afterChangeOutcome=function(){},GameBase.prototype.setOutcome=function(e){this.outcome===GameBase.OUTCOME_UNKNOWN&&(this.outcome=e,this.runOutcomeListeners())},GameBase.prototype.runOutcomeListeners=function(){cleverapps.values(this.onChangeOutcomeListeners).forEach(function(e){e(this.outcome)}.bind(this)),cleverapps.values(this.afterOnChangeOutcomeListeners).forEach(
function(e){e(this.outcome)}.bind(this)),this.afterChangeOutcome()},GameBase.prototype.win=function(){cleverapps.user.incProgressCompare(300),this.setOutcome(GameBase.OUTCOME_VICTORY)},GameBase.prototype.lose=function(){cleverapps.user.incProgressCompare(10),this.setOutcome(GameBase.OUTCOME_LOST)},GameBase.prototype.giveUp=function(){cleverapps.user.incProgressCompare(10),this.boostersBefore&&this.boostersBefore.onGiveUp(),this.setOutcome(GameBase.OUTCOME_GAVEUP)},GameBase.prototype.showUp=function(e){e()},GameBase.EXP_PRIZE=1,GameBase.HARD_LEVEL_EXP_PRIZE=3,GameBase.REWARD_CLOVER="clover",GameBase.REWARD_BACKGROUND_CLOVER="background_clover",GameBase.REWARD_PIGGY_BANK="piggyBank",GameBase.REWARD_EXP="exp",GameBase.REWARD_GOLD="gold",GameBase.REWARD_BOOSTER="booster",GameBase.OUTCOME_UNKNOWN=void 0,GameBase.OUTCOME_VICTORY=1,GameBase.OUTCOME_LOST=2,GameBase.OUTCOME_GAVEUP=3,GameBase.prototype.stillNoPenalty=function(){return!cleverapps.isRumble()&&(
this.outcome===GameBase.OUTCOME_UNKNOWN&&(!this.level.episode.isBonusRound()&&("board"===cleverapps.config.type||("solitaire"===cleverapps.config.type?(!cleverapps.bet||!cleverapps.bet.isActive())&&this.table.beginCards===this.table.countOfCardsToPlay():!(!this.originalMoves||-1!==this.originalMoves)||this.beginMoves===this.moves))))},GameBase.prototype.canPayReward=function(e){switch(e){case GameBase.REWARD_CLOVER:return void 0!==this.gameMission&&this.gameMission.isRunning();case GameBase.REWARD_BACKGROUND_CLOVER:return void 0!==this.backgroundMission&&this.backgroundMission.isRunning();case GameBase.REWARD_PIGGY_BANK:return cleverapps.piggyBank.isActive();case GameBase.REWARD_EXP:case GameBase.REWARD_GOLD:case GameBase.REWARD_BOOSTER:return!0}},GameBase.prototype.payReward=function(e,t){if(this.canPayReward(e)&&t)switch(e){case GameBase.REWARD_CLOVER:this.gameMission.update(t);break;case GameBase.REWARD_BACKGROUND_CLOVER:this.backgroundMission.updateCurrency(t);break
;case GameBase.REWARD_PIGGY_BANK:cleverapps.piggyBank.addGold(t);break;case GameBase.REWARD_EXP:levels.user.setExp(levels.user.exp+t);break;case GameBase.REWARD_GOLD:levels.user.setGold(levels.user.gold+t);break;case GameBase.REWARD_BOOSTER:cleverapps.boostersCounter.add(this.collectedBoosterCell.type,t)}},GameBase.prototype.getMissionType=function(){if(this.gameMission)return this.gameMission.type},GameBase.prototype.addClover=function(e,t,n){this.getMissionType()===e&&(this.rewards[GameBase.REWARD_CLOVER]=(this.rewards[GameBase.REWARD_CLOVER]||0)+t,n||this.onCloverAdded())},GameBase.prototype.addGoldReward=function(e,t){this.rewards[GameBase.REWARD_GOLD]=(this.rewards[GameBase.REWARD_GOLD]||0)+e,t||this.onGoldRewardAdded()},GameBase.LEVEL_WITH_COINS_AVAILABLE={episode:0,level:7},cleverapps.GameSyncer={getInfo:function(){var e=cleverapps.user.getCurrentLevel(),t=e.episodeNo,n=e.levelNo;"merge"===cleverapps.config.type&&(t=n=0);var s=cleverapps.GameSaver.load(GameBase.getStoreKey(t,n))
;if(s)return 0<Object.keys(s).length&&(s=cleverapps.extend(s,{episode:t,level:n})),s},saveInfo:function(e){if(void 0!==e&&void 0!==e.episode&&void 0!==e.level){var t=e.episode,n=e.level;delete e.episode,delete e.level,cleverapps.GameSaver.saveInfo(GameBase.getStoreKey(t,n),e)}}};var GameSceneBase=cleverapps.FixedWidthScene.extend({ctor:function(e,t){if(cleverapps.config.editorMode&&cleverapps.environment.setScene(cleverapps.Environment.SCENE_GAME),this.game=e,this.level=t,this._super(cleverapps.Environment.SCENE_GAME),levels.cookieJar&&levels.cookieJar.shouldBeVisible()&&levels.cookieJar.setVisible(),this.game.competition&&cleverapps.isKnockoutGame()){var n=this.playersView=new KnockoutPlayersView(this.game.competition,cleverapps.metha.getMainObject().knockoutGame.rumble.getCurrentRound());this.scene.addChild(n)}if(e.combo){var s=new ComboView(e.combo,this.scene);this.scene.addChild(s),e.onChangeOutcomeListeners.comboResetAnimations=e.combo.reset.bind(e.combo)}
"match3"===cleverapps.config.type&&(this.infoPanel=new InfoPanel,this.scene.addChild(this.infoPanel),this.controlsPanel=new ControlsPanel,this.scene.addChild(this.controlsPanel)),e.afterOnChangeOutcomeListeners.gameScene=this.createListener(this.animateChangeOutcome.bind(this)),this.initSceneBg(),cleverapps.history.add("newg",1),e.onChangeOutcomeListeners.misc=this.createListener(function(){cleverapps.audio.fadeOut(),cleverapps.gun&&cleverapps.gun.hide(),this.level.isPassed=this.game.outcome===GameBase.OUTCOME_VICTORY}.bind(this)),cleverapps.exclamation.setGame(this.game),this.boatswain=new Boatswain(t),this.actions=[],this.game.churnActivated=cleverapps.once(function(){(this.game.level.isRegular()||this.game.level.episode.isBonusWorldLevel())&&levels.user.isUniqueStart(this.game.level.episodeNo,this.game.level.levelNo,this.level.content.version)&&cleverapps.eventLogger.logEvent(cleverapps.EVENTS.UNIQUE_START,{hash:this.level.hash})}.bind(this)),cleverapps.environment.levelNo=t.levelNo
,cleverapps.environment.episodeNo=t.episodeNo,this.prepareConfirmExit(),cc.pool.drainAllPools(),this.game.initPool(),cleverapps.lives&&cleverapps.lives.amount>cleverapps.Lives.MAX_REGEN_AMOUNT&&(this.game.moreThenMaxRegenLife=!0),"merge"!==cleverapps.config.type&&this.takeLife(!0),this.customize(),this.groupToggler=new cleverapps.UI.GroupToggler,this.game.rewardGoldView&&(this.rewardGoldView=new RewardGoldView(this,this.infoPanel||this.scene)),this.game.gameMission&&(this.cloversView=new CloversView(this,this.infoPanel||this.scene)),(this.level.isRegular()||this.level.episode.isBonusWorldLevel())&&cleverapps.eventLogger.logEvent(cleverapps.EVENTS.LEVEL_START,{hash:this.level.hash}),void 0!==cleverapps.abTest.group&&cleverapps.eventLogger.logEvent("abtest_"+cleverapps.abTest.group+"_"+cleverapps.EVENTS.LEVEL_START),cleverapps.gun.isAvailable()&&(this.gunView=new GunView(cleverapps.gun,this)),this.game.tournament&&(this.playersView=new TournamentPlayersView(this.game.competition),
this.scene.addChild(this.playersView));var i=new GameMessageView(e);this.scene.addChild(i);var o=cleverapps.exclamation.createView();this.scene.addChild(o,20),o.setPositionRound(this.width/2,this.height/2)},calcHash:function(){return RecursiveHasher(this.level.content,["episodeNo","levelNo","version","hard","paint","extra","gold","bundles"])},introControls:function(){return"panel_info"},_playIntro:function(){this.needDisplayIntro=!1,cleverapps.metha.display({focus:"GameScene.intro",control:this.introControls(),actions:[this.animateSceneBg.bind(this),function(e){this.onChangeSize(),e()}.bind(this),this.displayIntro.bind(this),this.displayDailyLevelWindow.bind(this)]})},initSceneBg:function(){if(!cleverapps.flags.introDisabled){var e=cleverapps.styles.GameScene.startAnimation.scale;this.bgScaleMargin=e;var t=this.background.getScaleX()*e,n=this.background.getScaleY()*e;this.background.setScale(t,n),this.scene.setScale(1/e)}},animateSceneBg:function(e){var t=this.bgScaleMargin||1
;this.game.outcome===GameBase.OUTCOME_UNKNOWN?this.scene.runAction(new cc.ScaleTo(.8,1)):this.scene.runAction(new cc.ScaleTo(.8,1/t)),setTimeout(e,800)},displayIntro:function(e){this.game.showUp(function(){this.game.level.isRegular()&&levels.FPS.run(this.game.level.episodeNo,this.game.level.levelNo),e()}.bind(this))},displayDailyLevelWindow:function(e){this.level.episode.isDailyLevel()?DailyLevelWindow.shown||-1===["olympics","crocword","tripeaks"].indexOf(cleverapps.config.name)?e():(new DailyLevelWindow,DailyLevelWindow.shown=!0,cleverapps.metha.onceNoWindowsListener=e):e()},prepareConfirmExit:function(){this.confirmWindow=void 0,this.game.onChangeOutcomeListeners.confirmexit=function(e){void 0!==this.confirmWindow&&this.confirmWindow.close()}.bind(this)},closeAction:function(){this.backToEditorOrAdmin()||this.game&&void 0===this.confirmWindow&&this.game.outcome===GameBase.OUTCOME_UNKNOWN&&(cleverapps.metha.isFocused()||(this.game.stillNoPenalty()?this.game.giveUp(
):cleverapps.metha.display({focus:"GameSceneCloseAction",action:function(e){this.confirmWindow=new ConfirmExitWindow({onClose:function(){this.game.lose()}.bind(this),onAction:function(){this.confirmWindow=void 0}.bind(this),game:this.game}),cleverapps.metha.onceNoWindowsListener=e}.bind(this)})))},customize:function(){},takeLife:function(e){if(cleverapps.lives&&!cleverapps.tempGoods.checkGoodBuyed(cleverapps.TempGoods.UNLIMITED_LIVES)){if(this.level.episode.isDailyCup()&&!cleverapps.dailyCup.cupWithLives())return;cleverapps.lives.take(e)}},giveLife:function(){if(cleverapps.lives&&!cleverapps.tempGoods.checkGoodBuyed(cleverapps.TempGoods.UNLIMITED_LIVES)){if(this.level.episode.isDailyCup()&&!cleverapps.dailyCup.cupWithLives())return;(this.game.moreThenMaxRegenLife||cleverapps.lives.amount<cleverapps.Lives.MAX_REGEN_AMOUNT)&&cleverapps.lives.give()}},calcAddedStars:function(e){if(this.level.episode.isRegular()&&cleverapps.user.isPassedAll()||this.level.episode.isDailyCup())return e;if(
!this.level.isRegular())return 0;var t=cleverapps.userresult.getStarsForLevel(this.level.episodeNo,this.level.levelNo);return t<=e?e-t:0},beforeWin:function(){cleverapps.placements.run(Placements.AFTER_GAME_FINISH);var e=this.game.outcome;this.giveLife(),this.controlsPanel&&this.controlsPanel.hide(),this.level.isRegular()&&cleverapps.metha.getMainObject().gamePlayed(e,this.game);var t=cleverapps.missionManager.getRunningMission(Missions.SEMAPHORE_LANTERN)&&cleverapps.missionManager.getRunningMission(Missions.SEMAPHORE_LANTERN).logic.lantern;if(e===GameBase.OUTCOME_GAVEUP)t&&t.isActive(this.level)&&t.restoreSavedStreak();else if(e===GameBase.OUTCOME_VICTORY){if(this.game.timer&&cleverapps.eventLogger.logEvent(cleverapps.EVENTS.LEVEL_PASSED_TIME,{hash:this.level.hash,passedTime:this.game.timer.getTime()}),this.level.isRegular()&&this.level.isNew()&&(cleverapps.dailyTasks.addProgress(cleverapps.DailyTask.PASS_LEVELS_IN_ROW),cleverapps.missionManager.dispatchEvent(
Mission.EVENT_PASS_LEVELS_IN_ROW)),t&&t.isActive(this.level)&&t.onWin(),cleverapps.placements.run(Placements.VICTORY),cleverapps.history.add("win",1),this.level.isRegular()||this.level.episode.isBonusWorldLevel()){void 0!==this.game.leftMoves&&cleverapps.eventLogger.logEvent(cleverapps.EVENTS.LEVEL_LEFT_MOVES,{hash:this.level.hash,leftMoves:this.game.leftMoves});var n=!0;"board"===cleverapps.config.type&&this.game.timer&&(n=this.game.timer.getTime()<=cleverapps.parseInterval("5 minutes")),n&&cleverapps.eventLogger.logEvent(cleverapps.EVENTS.LEVEL_FINISH,{hash:this.level.hash}),(this.level.isNew()||this.level.episode.isBonusWorldLevel())&&cleverapps.eventLogger.logEvent(cleverapps.EVENTS.UNIQUE_FINISH,{hash:this.level.hash}),void 0!==cleverapps.abTest.group&&cleverapps.eventLogger.logEvent("abtest_"+cleverapps.abTest.group+"_"+cleverapps.EVENTS.LEVEL_FINISH)}var s=this.level.isCurrentLevel();this.boatswain.level=this.level=cleverapps.extend(cleverapps.clone(this.level),{
isCurrentLevel:function(){return s}}),this.oldLeague=levels.user.league,this.level.isCurrentLevel()&&cleverapps.dailyTasks.addProgress(cleverapps.DailyTask.PASS_LEVEL),this.level.episode.isDailyLevel()&&cleverapps.dailyLevel.onWin(this.level)}else e===GameBase.OUTCOME_LOST&&(cleverapps.dailyTasks.setProgress(cleverapps.DailyTask.PASS_LEVELS_IN_ROW,0),cleverapps.missionManager.dispatchEvent(Mission.EVENT_PASS_LEVELS_IN_ROW,{amount:0}),t&&t.isActive(this.level)&&t.onLose(),this.takeLife(),cleverapps.placements.run(Placements.LOSE),cleverapps.history.add("lose",1))},congratulate:function(e){if(-1!==["riddles","scramble","tripeaks"].indexOf(cleverapps.config.name))if(cleverapps.flags.gameMessagesDisabled)e();else if(this.game.outcome===GameBase.OUTCOME_VICTORY){cleverapps.audio.playSound(bundles.main.urls.congratulate_sfx),cleverapps.windows.onShowShadow({});var t=cleverapps.styles.GameScene.congratulation;if(t.rays){var n=new cleverapps.Spine(bundles.exclamations.jsons.animation,
t.rays.scale);this.scene.addChild(n,20),n.setPositionRound(t.rays),n.runAction(new cc.Sequence(new cc.DelayTime(.7),new cc.CallFunc(function(){n.setAnimation(0,"rays",!1)})))}if(this.game.onGameMessage(e,"messages:VICTORY",!1,{json:bundles.gamemessage.jsons.game_message_victory_json,direction:"riddles"===cleverapps.config.name?GameMessageView.DIRECTION_TOP_TOP:GameMessageView.DIRECTION_TOP_DOWN,delay:2}),"tripeaks"===cleverapps.config.name){var s=VictoryWindowHero.hero=new VictoryWindowHero;s.setLocalZOrder(22),this.addChild(s),s.show()}}else e();else e()},showProperWindow:function(e){if(!cleverapps.flags.victoryWindowDisabled)if(this.game.outcome!==GameBase.OUTCOME_GAVEUP){var t={level:this.level,game:this.game,boatswain:this.boatswain};this.level.episode.isBonusRound()?new BonusRoundWindow(this.game):this.game.outcome===GameBase.OUTCOME_LOST?cleverapps.lives?new LoseWindow(function(t){cleverapps.isRumble()||(this.boatswain.intent=function(e){this.boatswain.REPLAY(e,t)}.bind(this))
}.bind(this),this.game):e():new VictoryWindow(t),cleverapps.metha.onceNoWindowsListener=e}else e()},waitWinLoseAnimations:function(e){e()},animateGoalsComplete:function(e){e()},fireworksAnimation:function(e){cleverapps.isKnockoutGame()||this.game.outcome!==GameBase.OUTCOME_VICTORY||this.scene.addChild(new Fireworks),e()},purgeOldGame:function(e){this.game&&!this.game.stopped&&cleverapps.throwAsync("purgeOldGame active game"),Game.currentGame=void 0,this.game=void 0,"undefined"!=typeof VictoryLoseAnimations&&VictoryLoseAnimations.clear(),e()},saveFinalResults:function(e){if(!this.game){var t="game empty ";Game.currentGame&&Game.currentGame.level&&(t+=" level - "+Game.currentGame.level.levelNo+", episode - "+Game.currentGame.level.episodeNo),cleverapps.ReportStream.debug(t)}this.game.outcome===GameBase.OUTCOME_VICTORY&&("undefined"!=typeof Match3&&this.game instanceof Match3&&this.level.isRegular()&&cleverapps.eventLogger.logEvent(cleverapps.EVENTS.LEVEL_STARS,{hash:this.level.hash,
stars:this.stars}),this.level.episode.isDailyCup()&&this.saveDailyCupProgress()),e()},saveDailyCupProgress:function(){cleverapps.dailyCup.addAmount(this.game.getDailyCupStars()),cleverapps.playSession.set(cleverapps.EVENTS.DAILY_CUP_PLAYERS,!0)},playChangeOutcome:function(){var e=cleverapps.toArray(this.introControls());this.level.episode.isBonusRound()&&this.game.outcome===GameBase.OUTCOME_LOST&&e.push("MenuBarBonusRoundTimerItem"),cleverapps.metha.display({focus:"ChangeOutcome",control:e,filter:function(){return this.wantAnimateChangeOutcome}.bind(this),action:function(e){this.wantAnimateChangeOutcome=!1,cleverapps.metha.compound(e,this.actions)}.bind(this)})},backToEditorOrAdmin:function(e){return cleverapps.config.editorMode?(this.game&&this.game.stop(),e&&e(),this.level.edit(),!0):!!cleverapps.config.adminMode&&(this.game&&this.game.stop(),e&&e(),AdministratorScene.open(),!0)},animateChangeOutcome:function(e){this.wantAnimateChangeOutcome=!0,
cleverapps.config.debugMode&&console.log("OUTCOME: "+e),this.beforeWin(),cleverapps.isKnockoutGame()||e===GameBase.OUTCOME_VICTORY&&this.level.isCurrentLevel()&&levels.user.incLevel(),this.actions.push(this.waitWinLoseAnimations.bind(this)),this.actions.push(this.animateGoalsComplete.bind(this)),this.actions.push(this.fireworksAnimation.bind(this)),this.actions.push(this.saveFinalResults.bind(this)),this.actions.push(this.animateSceneBg.bind(this)),this.actions.push(this.congratulate.bind(this)),this.actions.push(this.showProperWindow.bind(this)),e===GameBase.OUTCOME_VICTORY?this.afterWin():this.actions.push(this.purgeOldGame.bind(this)),this.actions.push(function(){cleverapps.metha.distract({focus:"boatswain",control:this.introControls(),action:function(e){this.backToEditorOrAdmin(e)||this.boatswain.intent(e)}.bind(this)})}.bind(this)),cleverapps.metha.display({focus:"empty",action:function(e){e()}})},afterWin:function(){if(this.actions.push(function(e){for(var t in this.game.rewards
)this.game.payReward(t,this.game.rewards[t]);e()}.bind(this)),this.actions.push(this.purgeOldGame.bind(this)),this.level.isRegular()&&levels.user.checkAvailable(BeatFriendWindow.AVAILABLE)&&this.level.isNew()){var t=this.level.players.filter(function(e){return cleverapps.friends.getById(e)});0<t.length&&this.actions.push(function(e){new BeatFriendWindow(t[0],this.level),cleverapps.metha.onceNoWindowsListener=e}.bind(this))}cc.sys.isNative&&!cleverapps.flags.norest&&levels.user.checkAvailable(RateWindow.AVAILABLE)&&!RateWindow.hadRated()&&this.actions.push(function(e){new RateWindow,cleverapps.metha.onceNoWindowsListener=e}),this.oldLeague===levels.user.league||cleverapps.flags.norest||(this.actions.push(function(e){new NewLeagueWindow(this.level),cleverapps.metha.onceNoWindowsListener=e}.bind(this)),this.actions.push(function(e){new LeadersWindow,cleverapps.metha.onceNoWindowsListener=e}));var n=this.game.backgroundMission;if(n&&n.isMinigameReadyToFinish()&&this.actions.push(function(e
){new n.nudgeWindow(n),cleverapps.metha.onceNoWindowsListener=e}),cleverapps.missionManager.dispatchEvent(Mission.EVENT_LEVEL_FINISH,{level:this.level}),cleverapps.config.results&&this.level.isRegular()&&levels.user.checkAvailable(ChampionWindow.AVAILABLE)&&this.level.isChampion()&&(cleverapps.dailyTasks.addProgress(cleverapps.DailyTask.LEVEL_CHAMPION),this.actions.push(function(e){new ChampionWindow(this.level),cleverapps.metha.onceNoWindowsListener=e}.bind(this))),"undefined"!=typeof match3&&!1!==match3.heroes.readyToOpen()){var s=match3.heroes.readyToOpen();match3.heroes.setLevel(s,1),this.actions.push(function(e){cleverapps.Plot.onFirstHeroesOpen(e,{color:s})})}this.actions.push(function(e){cleverapps.starChest&&!cleverapps.starChest.locked?(new StarChestWindow,cleverapps.metha.onceNoWindowsListener=e):e()})},onChangeSize:function(e){this._super(e),this.game&&this.game.combo&&this.game.combo.onChangeSize&&this.game.combo.onChangeSize()},getBackgroundStyles:function(){if(!this.level
)throw new Error("Level is undefined in getBackgroundStyles "+cleverapps.gameSceneLogs.join(" "));var e=GameSceneBase.ChooseStyling(this.level);return e.background=bundles[e.bundle].urls.background,e.animation=bundles[e.bundle].jsons.background_spine,cleverapps.skins.getSlot("gameSceneBg")||e},getAudioStyles:function(){var e=GameSceneBase.ChooseStyling(this.level);return{res:cleverapps.skins.getSlot("gameAudio")||e.music,delay:cleverapps.styles.GameScene.sound.delay}}});GameSceneBase.ChooseStyling=function(e){if(bundles[e.episode.bundleId()]&&bundles[e.episode.bundleId()].urls.background)return{bundle:e.episode.bundleId()};if(cleverapps.environment.isEditorScene()&&cleverapps.styles.GameScene.STYLING.editor)return cleverapps.styles.GameScene.STYLING.editor;var t=cleverapps.styles.GameScene.STYLING,n=t.regular[e.getHumanReadableNumber()%t.regular.length];if(e.episode.isBonusRound()?n=t.bonus:e.isHard()||cleverapps.isRumble()&&cleverapps.metha.getMainObject(
).knockoutGame.rumble.getCurrentRound().isLast()?n=t.hard:e.isTricky()&&(n=t.tricky),n=cleverapps.clone(n),e.episode.isBonusWorldLevel()){var s=cleverapps.missionManager.getRunningMission(Missions.SEMAPHORE_BONUS_WORLD);s&&(n.bundle=s.bonusWorld.backgroundBundleId(),n.music=bundles[n.bundle].urls.music,n.skin=void 0)}return-1!==["wordheaps","spades","mergeriddles","mergeheroes"].indexOf(cleverapps.config.name)&&(n.bundle="simple_background_"+cleverapps.simple.getCurrent()),n},GameSceneBase.BUNDLES=function(e,t){var s=["game","heroes","dialogues_minimal"];if(t&&(s=s.concat(t.content.bundles||[t.content.bundleName]||[])).push(GameSceneBase.ChooseStyling(t).bundle),"match3"===cleverapps.config.type&&t.content.cellSkins&&cleverapps.values(t.content.cellSkins).forEach(function(e){if(bundles[e]){var t=e.substring(0,e.indexOf("_reskin")),n=s.indexOf(t);s.splice(n,0<n?1:0,e)}}),"stacks"===cleverapps.config.subtype&&s.push("extra_"+cleverapps.settings.language),e&&cleverapps.config.rpg)for(
var n in e.enemies){var i=e.enemies[n];s.push("enemy"+i)}return bundles.exclamations&&s.push("exclamations"),bundles["letters_"+cleverapps.settings.language]&&s.push("letters_"+cleverapps.settings.language),s},cleverapps.styles.GameScene={actor:void 0,startAnimation:{scale:1.05},sound:{delay:1},debugLevelNo:{x:{align:"right",dx:-100},y:{align:"bottom",dy:100}},congratulation:{}},cleverapps.styles.GameScene.STYLING={bonus:{bundle:"game_background_bonus",music:bundles.game.urls.background_music_game,pattern:-1!==["wordsoup","olympics","crocword"].indexOf(cleverapps.config.name)},hard:{bundle:"game_background_hard",animation:bundles.game.jsons.game_bg_clouds_json,skin:"gameBackground_hard",music:bundles.game.urls.background_music_hard,pattern:-1!==["differences","olympics","wordsoup"].indexOf(cleverapps.config.name)},regular:[{bundle:"game_background",animation:bundles.game.jsons.game_bg_clouds_json,skin:"gameBackground",music:bundles.game.urls.background_music_game,pattern:-1!==[
"differences","olympics","wordsoup"].indexOf(cleverapps.config.name)}]},function(){if(bundles.editor&&bundles.editor.urls.background&&(cleverapps.styles.GameScene.STYLING.editor={bundle:"editor"}),"crocword"===cleverapps.config.name)cleverapps.styles.GameScene.STYLING.regular[0].bundle="loading_scene_backgrounds";else for(var e=cleverapps.styles.GameScene.STYLING.regular[0],t=2;bundles["game_background_"+t];t++)cleverapps.styles.GameScene.STYLING.regular.push({bundle:"game_background_"+t,skin:"gameBackground"+t,music:e.music,animation:e.animation,pattern:e.pattern})}();var GameMessageView=cc.Node.extend({ctor:function(e){this._super(),(this.game=e).onGameMessage=this.createListener(this.show.bind(this)),this.setLocalZOrder(21)},show:function(e,t,n,s){if(cleverapps.flags.gameMessagesDisabled)e();else{s=s||{};var i=cc.director.getRunningScene().scene,o=this.createBg();this.addChild(o);var r=this.createText(t);if(o.addChild(r),r.fitTo(.9*i.width),n){var a=this.createTitle(n);o.addChild(a)
}var c=s.direction||GameMessageView.DIRECTION_TOP_DOWN,l=cc.p(i.width/2,i.height+o.height/2+cleverapps.UI.getSceneOffsetY()),p=cc.p(i.width/2,i.height/2),d=cc.p(i.width/2,-o.height/2-cleverapps.UI.getSceneOffsetY());c===GameMessageView.DIRECTION_TOP_TOP&&(d=l);var u=cleverapps.styles.GameMessageView,h=s.json||bundles.gamemessage.jsons.game_message_json;if(h){var g=new cleverapps.Spine(h,u.char.scale);this.addChild(g,1),g.setPositionRound(u.char),g.y-=cleverapps.UI.getSceneOffsetY();var v="idle";"stacks"===cleverapps.config.subtype&&(this.game.level.isHard()&&(v="idle_hard"),this.game.level.isTricky()&&(v="idle_tricky"),this.game.level.episode.isBonusRound()&&(v="idle_bonus_round")),g.setAnimation(0,v,!1),cleverapps.UI.makeHideable(g,cleverapps.UI.VERTICAL),g.hide(!0),g.show(!1,0,{easing:!0,duration:.3})}o.setPositionRound(l),o.setVisible(!1),o.runAction(new cc.Sequence(new cc.DelayTime(this.getDelayTime()),new cc.CallFunc(function(){o.setVisible(!0),cleverapps.audio.playSound(
bundles.game.urls.game_message_effect)}),new cc.MoveTo(.5,p).easing(cc.easeBackOut(1)),new cc.DelayTime(s.delay||1.2),new cc.CallFunc(function(){g&&g.hide(!1,0,{easing:!0,duration:.3}),cleverapps.audio.playSound(bundles.game.urls.game_message_effect)}),new cc.MoveTo(.5,d).easing(cc.easeBackIn(1)),new cc.RemoveSelf,new cc.CallFunc(e)))}},getBackgroundImage:function(){var e=bundles.gamemessage.frames.gamemessage_bg_png;return cleverapps.isRumble()&&cleverapps.metha.getMainObject().knockoutGame.rumble.getCurrentRound().isLast()&&(e=bundles.gamemessage.frames.gamemessage_bg_hard_png),this.game.level.isHard()&&bundles.gamemessage.frames.gamemessage_bg_hard_png&&(e=bundles.gamemessage.frames.gamemessage_bg_hard_png),this.game.level.isTricky()&&bundles.gamemessage.frames.tricky_level_msg_bg&&(e=bundles.gamemessage.frames.tricky_level_msg_bg),this.game.level.episode.isBonusRound()&&bundles.gamemessage.frames.bonus_round_level_msg_bg&&(e=bundles.gamemessage.frames.bonus_round_level_msg_bg),e},
createText:function(e){e=Messages.has(e)?Messages.get(e):e;var t=cleverapps.styles.FONTS.GAME_MESSAGE_TEXT;this.game.level.isHard()&&cleverapps.styles.FONTS.GAME_MESSAGE_HARD_TEXT&&(t=cleverapps.styles.FONTS.GAME_MESSAGE_HARD_TEXT),this.game.level.isTricky()&&(t=cleverapps.styles.FONTS.GAME_MESSAGE_TRICKY_TEXT),this.game.level.episode.isBonusRound()&&cleverapps.styles.FONTS.GAME_MESSAGE_BONUS_ROUND_TEXT&&(t=cleverapps.styles.FONTS.GAME_MESSAGE_BONUS_ROUND_TEXT);var n=cleverapps.UI.generateTTFText(e.toUpperCase(),t);return n.setPositionRound(cleverapps.styles.GameMessageView.text),n.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER),n},createTitle:function(e){var t,n=cleverapps.styles.GameMessageView,s=bundles.gamemessage.frames.title_bg_png,i=cleverapps.styles.FONTS.GAME_MESSAGE_TITLE_TEXT;this.game.level.isHard()&&(s=bundles.gamemessage.frames.title_bg_hard_png,i=cleverapps.styles.FONTS.GAME_MESSAGE_TITLE_TEXT_HARD||i),this.game.level.isTricky()&&(
s=bundles.gamemessage.frames.title_bg_tricky_png,i=cleverapps.styles.FONTS.GAME_MESSAGE_TITLE_TEXT_TRICKY||i),n.title.bg.width?(t=new cc.Scale9Sprite(s)).setContentSize2(n.title.bg):t=new cc.Sprite(s),e=Messages.has(e)?Messages.get(e):e;var o=cleverapps.UI.generateTTFText(e.toUpperCase(),i);return o.fitTo(n.title.width),t.addChild(o),o.setPositionRound(n.title),t.setPositionRound(n.title.bg),t},createBg:function(){var e,t=cleverapps.styles.GameMessageView,n=cleverapps.UI.getSceneSize();if(t.pattern){for(var s=new cc.Sprite(this.getBackgroundImage()).width,i=[],o=0;o<Math.ceil(n.width/(s+t.pattern.margin))+10;o++)i.push(new cc.Sprite(this.getBackgroundImage()));e=new cleverapps.Layout(i,{direction:cleverapps.UI.HORIZONTAL,margin:t.pattern.margin})}else(e=new cc.Scale9Sprite(this.getBackgroundImage())).setContentSize2(1.2*n.width,e.height);return e},getDelayTime:function(){return.2}});GameMessageView.DIRECTION_TOP_DOWN=0,GameMessageView.DIRECTION_TOP_TOP=1,
cleverapps.styles.GameMessageView={text:{x:{align:"center"},y:{align:"center"}},title:{width:200,bg:{x:{align:"center"},y:{align:"center",dy:110}},x:{align:"center"},y:{align:"center"}}},cleverapps.overrideFonts(cleverapps.styles.FONTS,{GAME_MESSAGE_TEXT:{size:60,color:cleverapps.styles.COLORS.WHITE,stroke:{color:new cc.Color(145,56,188,255),size:1}},GAME_MESSAGE_TITLE_TEXT:{size:30,color:cleverapps.styles.COLORS.WHITE,shadow:cleverapps.styles.DECORATORS.IMAGE_FONT_SHADOW,stroke:cleverapps.styles.DECORATORS.IMAGE_FONT_STROKE}});var GameTimer=function(e){this.start=Date.now(),this.game=e};GameTimer.prototype.setStartTime=function(e){this.start=e},GameTimer.prototype.getStartTime=function(){return this.start},GameTimer.prototype.getTime=function(){return Date.now()-this.start},cleverapps.DailyTask=function(e,t,n,s){this.type=e,this.goal=t,this.level=s,this.progress=0,this.data=n||{},this.onUpdateListener=function(){}},cleverapps.DailyTask.prototype.getSaveInfo=function(){return{
type:this.type,progress:this.progress,collected:this.collected,goal:this.goal,data:this.data}},cleverapps.DailyTask.prototype.addProgress=function(e,t){if("object"==typeof e&&(t=e),"number"!=typeof e&&(e=1),0<e)return this.setProgress(this.progress+e,t)},cleverapps.DailyTask.prototype.setProgress=function(e,t){"object"==typeof e&&(t=e),"number"!=typeof e&&(e=1),this.isFinished()||this.type===cleverapps.DailyTask.USE_BOOSTER&&this.data.booster!==t.booster||this.type===cleverapps.DailyTask.COLLECT_COLOR_CELLS&&this.data.color!==t.color||this.type===cleverapps.DailyTask.COLLECT_SPECIAL_CELLS&&this.data.cell_code!==t.cell_code||this.type===cleverapps.DailyTask.GUESS_WORDS_WITH_LETTER&&this.data.letter!==t.letter||this.type===cleverapps.DailyTask.COLLECT_CARDS_BY_VALUE&&this.data.cardValue!==t.cardValue||this.type===cleverapps.DailyTask.COLLECT_CARDS_BY_SUIT&&this.data.cardSuit!==t.cardSuit||this.type===cleverapps.DailyTask.COLLECT_HERO_CELLS&&this.data.color!==t.color||e!==this.progress&&(
this.progress=Math.min(e,this.goal),this.onUpdateListener(),this.save(),this.isFinished()&&(cleverapps.playSession.inc(cleverapps.EVENTS.SESSION_DAILY_TASK_FINISH),cleverapps.history.add("d"+this.level,1),this.type===cleverapps.DailyTask.LIKE_PAGE&&cleverapps.serverFlags.setFlag(cleverapps.ServerFlags.PAGE_LIKED)))},cleverapps.DailyTask.prototype.isFinished=function(){return this.progress>=this.goal},cleverapps.DailyTask.prototype.getLevel=function(){return this.level},cleverapps.DailyTask.prototype.run=function(){var e=function(){cleverapps.metha.distract({focus:"DailyTaskRunLevel",action:function(e){cleverapps.metha.wantsToPlay(e,{dailyTask:!0})}})};switch(this.type){case cleverapps.DailyTask.LOGIN_FACEBOOK:cleverapps.social.checkConnection(this.setProgress.bind(this,1));break;case cleverapps.DailyTask.LIKE_PAGE:cleverapps.social.joinGroup?cleverapps.social.joinGroup(function(e){e===cleverapps.Social.CODE_SUCCEED&&(cc.sys.openURL(cleverapps.bySource(cleverapps.config.helpURL)),
this.setProgress(1))}.bind(this)):(cc.sys.openURL(cleverapps.bySource(cleverapps.config.helpURL)),this.setProgress(1));break;case cleverapps.DailyTask.SHARE:var t=cleverapps.ShareBonus.cycleShareData("share");cleverapps.social.shareDialog(t,function(e){e===cleverapps.Social.CODE_SUCCEED&&(cleverapps.history.add("share",1),this.setProgress(1))}.bind(this));break;case cleverapps.DailyTask.INVITE_FRIENDS:cleverapps.history.add("invt",1),cleverapps.social.inviteFriends({message:Messages.get("SettingsWindow.InviteFriends.message"),title:Messages.get("SettingsWindow.InviteFriends.title")},function(e,t){e===cleverapps.Social.CODE_SUCCEED&&this.addProgress(1)}.bind(this));break;case cleverapps.DailyTask.SEND_FRIEND_HELP:levels.friendRequests.existRequestTypes(levels.FriendRequest.SENT_HELP_REQUESTS)&&new FriendRequestsWindow;break;case cleverapps.DailyTask.SPEND_COINS:e();break;case cleverapps.DailyTask.WATCH_ADS:cleverapps.rewardedAdsManager.play(RewardedAdsManager.REWARDED);break
;case cleverapps.DailyTask.TOURNAMENT_WIN:var n=cleverapps.missionManager.getRunningMission(Missions.SEMAPHORE_BACKGROUND);("olympics"===cleverapps.config.name||n&&n.tournament)&&e();break;case cleverapps.DailyTask.RECEIVE_PERIODIC_BONUS:cleverapps.periodicBonus.openWindow();break;case cleverapps.DailyTask.PLAY_BONUS_ROUND:cleverapps.metha.distract({focus:"DailyTaskRunBonusRound",action:function(e){cleverapps.bonusRoundChest.locked?cleverapps.Notification.create("messages:BonusRound.ClosedText"):cleverapps.bonusRoundChest.open(e)}});break;default:e()}},cleverapps.DailyTask.prototype.collect=function(){this.isFinished()&&!this.collected&&(this.collected=!0,this.save(),this.onUpdateListener(),cleverapps.missionManager.dispatchEvent(Mission.EVENT_COMPLETE_DAILY_TASK))},cleverapps.DailyTask.prototype.expire=function(){this.isFinished()||(this.expired=!0,this.onUpdateListener())},cleverapps.DailyTask.prototype.givePrize=function(){this.isFinished()&&new DailyTaskRewardWindow(this)},
cleverapps.DailyTask.prototype.save=function(){cleverapps.dailyTasks.save()},cleverapps.DailyTask.prototype.getTitle=function(){var e={};return cleverapps.DailyTask.USE_BOOSTER===this.type&&(e.booster=Messages.get("Boosters."+this.data.booster+".Title")),cleverapps.DailyTask.COLLECT_COLOR_CELLS===this.type&&(e.color=Messages.get("ColorCell."+this.data.color+".Title")),cleverapps.DailyTask.COLLECT_SPECIAL_CELLS===this.type&&(e.elements=Messages.get("DailyTask.14.Element."+this.data.cell_code)),cleverapps.DailyTask.GUESS_WORDS_WITH_LETTER===this.type&&this.data.letter&&(e.letter=this.data.letter.toUpperCase()),cleverapps.DailyTask.COLLECT_HERO_CELLS===this.type&&(e.heroes=Messages.get("DailyTask.24."+this.data.color)),cleverapps.DailyTask.COLLECT_CARDS_BY_VALUE===this.type&&(e.cards=Messages.get("DailyTask.25."+this.data.cardValue)),cleverapps.DailyTask.COLLECT_CARDS_BY_SUIT===this.type&&(e.cards=Messages.get("DailyTask.26."+this.data.cardSuit)),{
text:"messages:DailyTask."+this.type+".Title",replace:e}},cleverapps.DailyTask.getIcon=function(e,t){if(cleverapps.DailyTask.COLLECT_SPECIAL_CELLS===e)switch(t.cell_code){case FishCell.GOAL_ID:return new cc.Sprite(bundles.fish_cell.frames.cell_fish);case FlowerCell.GOAL_ID:return new cc.Sprite(bundles.flower_cell.frames.flower_cell_3);case NutCell.GOAL_ID:return new cc.Sprite(bundles.nut.frames.nut_cell_1);case Mark.GOAL_ID:return new cc.Sprite(bundles.game_mark.frames.mark_goal);case MouseCell.GOAL_ID:return new cc.Sprite(bundles.dailytasks.frames.daily_task_cell_mouse_png);case IceTile.GOAL_ID:return new cc.Sprite(bundles.dailytasks.frames.daily_task_cell_ice_png);case DragonCell.GOAL_ID:return new cc.Sprite(bundles.dailytasks.frames.daily_task_cell_dragon_png);case CookieManCell.GOAL_ID:return new cc.Sprite(bundles.dailytasks.frames.daily_task_cell_cookieman_png);case CakeCell.GOAL_ID:return new cc.Sprite(bundles.dailytasks.frames.daily_task_cell_cake_png)
;case MuffinGoalCell.GOAL_ID:return new cc.Sprite(bundles.dailytasks.frames.daily_task_cell_muffin_png);case WaffleCell.GOAL_ID:return new cc.Sprite(bundles.dailytasks.frames.daily_task_cell_waffles_png);case LollipopCell.GOAL_ID:return new cc.Sprite(bundles.dailytasks.frames.daily_task_cell_lollipop_png);case ColorCookieManCell.GOAL_ID:return new cc.Sprite(bundles.dailytasks.frames.daily_task_cell_colorcookieman_png);case TruffleCell.GOAL_ID:return new cc.Sprite(bundles.dailytasks.frames.daily_task_cell_truffle_png);case DogCell.GOAL_ID:return new cc.Sprite(bundles.dailytasks.frames.daily_task_cell_dog_png)}var n="daily_task_icon_"+e;if(cleverapps.DailyTask.USE_BOOSTER===e&&(n+="_"+t.booster),cleverapps.DailyTask.COLLECT_COLOR_CELLS===e&&(n+="_"+t.color),cleverapps.DailyTask.COLLECT_HERO_CELLS===e&&(n+="_"+t.color),cleverapps.DailyTask.GUESS_WORDS_WITH_LETTER===e){var s=new CharView(t.letter.toUpperCase());return"scramble"===cleverapps.config.name&&s.setScale(.8),s}if(
cleverapps.DailyTask.COLLECT_CARDS_BY_VALUE===e)switch(t.cardValue){case"t":return new cc.Sprite(bundles.dailytasks.frames.daily_task_icon_t);case"j":return new cc.Sprite(bundles.dailytasks.frames.daily_task_icon_j);case"q":return new cc.Sprite(bundles.dailytasks.frames.daily_task_icon_q);case"k":return new cc.Sprite(bundles.dailytasks.frames.daily_task_icon_k);case"a":return new cc.Sprite(bundles.dailytasks.frames.daily_task_icon_a)}if(cleverapps.DailyTask.COLLECT_CARDS_BY_SUIT===e)switch(t.cardSuit){case"c":return new cc.Sprite(bundles.dailytasks.frames.daily_task_icon_c);case"d":return new cc.Sprite(bundles.dailytasks.frames.daily_task_icon_d);case"h":return new cc.Sprite(bundles.dailytasks.frames.daily_task_icon_h);case"s":return new cc.Sprite(bundles.dailytasks.frames.daily_task_icon_s)}return n+="_png",new cc.Sprite(bundles.dailytasks.frames[n])},cleverapps.DailyTask.prototype.getIcon=function(){return cleverapps.DailyTask.getIcon(this.type,this.data)},
cleverapps.DailyTask.Create=function(e){var t=new cleverapps.DailyTask(e.type,e.goal,e.data,cleverapps.DailyTask.LEVEL[e.level]);return t.progress=0<e.progress?e.progress:0,t.collected=e.collected,t},cleverapps.DailyTask.LOGIN_FACEBOOK=0,cleverapps.DailyTask.LIKE_PAGE=1,cleverapps.DailyTask.SHARE=2,cleverapps.DailyTask.INVITE_FRIENDS=3,cleverapps.DailyTask.PASS_LEVEL=4,cleverapps.DailyTask.COLLECT_STARS=5,cleverapps.DailyTask.SEND_FRIEND_HELP=6,cleverapps.DailyTask.WATCH_ADS=7,cleverapps.DailyTask.USE_MULTI_COLOR_CELL=8,cleverapps.DailyTask.USE_BOOSTER=9,cleverapps.DailyTask.COLLECT_COLOR_CELLS=10,cleverapps.DailyTask.PASS_LEVELS_IN_ROW=11,cleverapps.DailyTask.LEVEL_CHAMPION=12,cleverapps.DailyTask.SPEND_COINS=13,cleverapps.DailyTask.COLLECT_SPECIAL_CELLS=14,cleverapps.DailyTask.GUESS_EXTRA_WORDS=15,cleverapps.DailyTask.GUESS_WORDS_WITH_LETTER=16,cleverapps.DailyTask.USE_HINTS=17,cleverapps.DailyTask.TOURNAMENT_WIN=18,cleverapps.DailyTask.FINISH_EPISODE=19,
cleverapps.DailyTask.RECEIVE_PERIODIC_BONUS=20,cleverapps.DailyTask.BEAT_FRIEND=22,cleverapps.DailyTask.PLAY_BONUS_ROUND=23,cleverapps.DailyTask.COLLECT_HERO_CELLS=24,cleverapps.DailyTask.COLLECT_CARDS_BY_VALUE=25,cleverapps.DailyTask.COLLECT_CARDS_BY_SUIT=26,cleverapps.DailyTask.COLLECT_JOKERS_USING_COMBO=27,cleverapps.DailyTask.LEVEL=["low","mid","hard"],cleverapps.DailyTasks=function(e){this.onChangeStateListener=function(){},cleverapps.config.debugMode&&(cleverapps.DailyTasks.DURATION="60 seconds"),this.tasks=[],e?(this.whenStart=-1,this.order=0,this.save()):this.load()},cleverapps.DailyTasks.prototype.getInfo=function(){return{whenStart:this.whenStart,order:this.order,tasks:this.tasks.map(function(e){return e.getSaveInfo()})}},cleverapps.DailyTasks.prototype.processFinishState=function(){clearTimeout(this.finishTimeout);var e=this.getTimeLeft();0<e?this.finishTimeout=new cleverapps.LongTimeout(this.processFinishState.bind(this),e):this.onChangeStateListener()},
cleverapps.DailyTasks.prototype.load=function(e){var t=e||cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.DAILY_TASKS)||{};this.whenStart=void 0!==t.whenStart?t.whenStart:-1,this.order=void 0!==t.order?t.order:0,this.whenStart>Date.now()&&(this.whenStart=Date.now()),t.tasks&&t.tasks.length===cleverapps.DailyTasks.ACTIVE_TASKS&&(this.tasks=t.tasks.map(function(e,t){return e.level=t,cleverapps.DailyTask.Create(e)})),this.processFinishState()},cleverapps.DailyTasks.prototype.save=function(e){cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.DAILY_TASKS,this.getInfo()),this.onChangeStateListener(),!1!==e&&this.updateServer()},cleverapps.DailyTasks.UPDATE_SERVER_INTERVAL="1 minute",cleverapps.DailyTasks.prototype.updateServer=cleverapps.timeredThrottle(cleverapps.parseInterval(cleverapps.DailyTasks.UPDATE_SERVER_INTERVAL),function(){cleverapps.synchronizer.addUpdateTask("dailytasks")}),cleverapps.DailyTasks.prototype.collect=function(e){e.collect(),this.sendActivity()},
cleverapps.DailyTasks.prototype.collectFinishedTasks=function(e){var t=this.getNotCollectedTasks(),n=cleverapps.once(this.sendActivity);this.tasks=[],e&&this.openWindow(),t.forEach(function(e){e.givePrize(),n()},this),this.save()},cleverapps.DailyTasks.prototype.processResults=function(){this.isRunning()?0===this.tasks.length&&this.startNew():0===this.tasks.length?this.startNew():this.getActiveTasks().forEach(function(e){e.expire()})},cleverapps.DailyTasks.prototype.startNew=function(){this.provider||(this.provider=new cleverapps.DailyTasksProvider),this.tasks=this.provider.generateTasks(this.order),this.startGeneratedTasks()},cleverapps.DailyTasks.prototype.startGeneratedTasks=function(){this.order++,this.whenStart=Date.now(),this.save(),this.processFinishState(),cleverapps.eventLogger.logEvent(cleverapps.EVENTS.DAILY_TASKS_START)},cleverapps.DailyTasks.prototype.sendActivity=function(){cleverapps.social.sendActivity&&cleverapps.social.sendActivity(
cleverapps.Social.ACTIVITY.DAILY_TASK,{userName:cleverapps.friends.getPlayer().name})},cleverapps.DailyTasks.prototype.getNotCollectedTasks=function(){return this.tasks.filter(function(e){return e.isFinished()&&!e.collected})},cleverapps.DailyTasks.prototype.getActiveTasks=function(){return this.tasks.filter(function(e){return!e.isFinished()})},cleverapps.DailyTasks.prototype.getTaskByType=function(t){var n;return this.getActiveTasks().forEach(function(e){e.type===t&&(n=e)}),n},cleverapps.DailyTasks.prototype.addProgress=function(e,t,n){var s=this.getTaskByType(e);s&&s.addProgress(t,n)},cleverapps.DailyTasks.prototype.setProgress=function(e,t,n){var s=this.getTaskByType(e);s&&s.setProgress(t,n)},cleverapps.DailyTasks.prototype.getTimeLeft=function(){return this.whenStart+cleverapps.parseInterval(cleverapps.DailyTasks.DURATION)-Date.now()},cleverapps.DailyTasks.prototype.isRunning=function(){return 0<this.getTimeLeft()},cleverapps.DailyTasks.prototype.getTasks=function(){
return this.tasks},cleverapps.DailyTasks.prototype.onDiscoverWord=function(e){this.processDiscoverWordWithLetter(e)},cleverapps.DailyTasks.prototype.onDiscoverExtraWord=function(e){this.addProgress(cleverapps.DailyTask.GUESS_EXTRA_WORDS),this.processDiscoverWordWithLetter(e)},cleverapps.DailyTasks.prototype.processDiscoverWordWithLetter=function(e){cleverapps.unique(e.split("")).forEach(function(e){cleverapps.dailyTasks.addProgress(cleverapps.DailyTask.GUESS_WORDS_WITH_LETTER,1,{letter:e})})},cleverapps.DailyTasks.prototype.processOpenCard=function(e,t){this.addProgress(cleverapps.DailyTask.COLLECT_CARDS_BY_VALUE,1,{cardValue:Card.VALUES[e.value]}),this.addProgress(cleverapps.DailyTask.COLLECT_CARDS_BY_SUIT,1,{cardSuit:e.suit}),t instanceof Wildcard&&this.addProgress(cleverapps.DailyTask.USE_HINTS)},cleverapps.DailyTasks.ACTIVE_TASKS=3,cleverapps.DailyTasks.DURATION="1 day",cleverapps.DailyTasksProvider=function(){this.tasks=[];var e=cleverapps.social.isLoggedIn.bind(cleverapps.social)
,t=function(e){return levels.user.getProgress()>=e},n=function(){cleverapps.friends.listFriends().length},s=cleverapps.User.calcSource();if(this.register(cleverapps.DailyTask.LOGIN_FACEBOOK,{low:1,active:function(){return!cleverapps.flags.nologin&&!e()&&"facebook"===cleverapps.social.getCode()}}),cleverapps.ShareBonus.IsRewardAvailable()&&(this.register(cleverapps.DailyTask.LIKE_PAGE,{low:1,active:function(){return!cleverapps.flags.nocommunity&&!cleverapps.serverFlags.hasFlag(cleverapps.ServerFlags.PAGE_LIKED)}}),this.register(cleverapps.DailyTask.INVITE_FRIENDS,{mid:1,active:e}),"android"!==s&&"amazon"!==s&&this.register(cleverapps.DailyTask.SHARE,{low:1,active:e})),this.register(cleverapps.DailyTask.SEND_FRIEND_HELP,{low:1,active:function(){return!cleverapps.flags.noviral&&levels.friendRequests.existRequestTypes(levels.FriendRequest.SENT_HELP_REQUESTS)}}),this.register(cleverapps.DailyTask.WATCH_ADS,{low:cleverapps.flags.reduceAds?10:2,mid:cleverapps.flags.reduceAds?20:10,
hard:cleverapps.flags.reduceAds?60:30,active:function(){var e=cleverapps.toolbar.getItem(ToolbarItem.REWARDED_VIDEO);return!cleverapps.flags.noads&&levels.user.checkAvailable(RewardedAdsManager.AVAILABLE)&&RewardedAdsManager.IsEnabled()&&e&&e.isAvailable()}}),this.register(cleverapps.DailyTask.SPEND_COINS,{mid:500,hard:1500}),"board"===cleverapps.config.type){this.register(cleverapps.DailyTask.PASS_LEVEL,{low:1,mid:5,hard:10}),this.register(cleverapps.DailyTask.GUESS_EXTRA_WORDS,{low:2,mid:10,hard:30}),"stacks"===cleverapps.config.subtype?this.register(cleverapps.DailyTask.USE_HINTS,{low:1,mid:3,hard:5}):this.register(cleverapps.DailyTask.USE_HINTS,{low:2,mid:10,hard:25}),cleverapps.metha.getType()===Metha.HOSE&&this.register(cleverapps.DailyTask.FINISH_EPISODE,{mid:1,hard:3,active:function(){return levels.user.level<5&&!levels.user.isPassedAll()}}),this.register(cleverapps.DailyTask.TOURNAMENT_WIN,{low:1,mid:2,hard:8,active:function(){var e=cleverapps.missionManager.getRunningMission(
Missions.SEMAPHORE_BACKGROUND);return cleverapps.isKnockoutGame()||e&&e.tournament}}),this.register(cleverapps.DailyTask.RECEIVE_PERIODIC_BONUS,{low:1,mid:1}),this.register(cleverapps.DailyTask.BEAT_FRIEND,{mid:1,active:n}),this.register(cleverapps.DailyTask.PLAY_BONUS_ROUND,{low:1,active:function(){return cleverapps.bonusRoundChest&&!cleverapps.bonusRoundChest.locked}});var i=["t","a","o","i","n","s","h","r"],o=["d","l","c","u","m","w","g","y","p"];cleverapps.settings.language===cc.sys.LANGUAGE_RUSSIAN?(i=["","","","","","","",""],o=["","","","","","","","",""]):cleverapps.settings.language===cc.sys.LANGUAGE_JAPANESE&&(i=["","","","","","","",""],o=["","","","","","","","",""]),i.forEach(function(e){this.register(cleverapps.DailyTask.GUESS_WORDS_WITH_LETTER,{low:3,mid:15,letter:e})}.bind(this)),o.forEach(function(e){this.register(cleverapps.DailyTask.GUESS_WORDS_WITH_LETTER,{low:5,mid:15,letter:e})}.bind(this))
}else"solitaire"===cleverapps.config.type?(this.register(cleverapps.DailyTask.PASS_LEVEL,{low:1,mid:5,hard:10}),this.register(cleverapps.DailyTask.USE_HINTS,{low:2,mid:10,hard:25}),Card.VALUES.slice(8).forEach(function(e){this.register(cleverapps.DailyTask.COLLECT_CARDS_BY_VALUE,{low:5,mid:10,hard:15,cardValue:e})}.bind(this)),Card.SUITS.forEach(function(e){this.register(cleverapps.DailyTask.COLLECT_CARDS_BY_SUIT,{low:10,mid:25,hard:50,cardSuit:e})}.bind(this)),this.register(cleverapps.DailyTask.COLLECT_JOKERS_USING_COMBO,{low:5,mid:10,hard:15})):"differences"===cleverapps.config.type?(this.register(cleverapps.DailyTask.PASS_LEVEL,{low:1,mid:5,hard:10}),this.register(cleverapps.DailyTask.USE_HINTS,{low:2,mid:10,hard:25}),this.register(cleverapps.DailyTask.RECEIVE_PERIODIC_BONUS,{low:1,mid:1})):"match3"===cleverapps.config.type&&(this.register(cleverapps.DailyTask.PASS_LEVEL,{low:2,mid:10,hard:25}),this.register(cleverapps.DailyTask.COLLECT_STARS,{low:3,mid:20,hard:50}),this.register(
cleverapps.DailyTask.USE_MULTI_COLOR_CELL,{low:3,mid:10,hard:30}),this.register(cleverapps.DailyTask.USE_BOOSTER,{low:2,mid:5,hard:10,booster:CellBooster.ID}),this.register(cleverapps.DailyTask.USE_BOOSTER,{low:2,mid:4,hard:8,booster:LineBooster.ID}),this.register(cleverapps.DailyTask.USE_BOOSTER,{mid:3,hard:7,booster:ColorBooster.ID}),this.register(cleverapps.DailyTask.COLLECT_COLOR_CELLS,{low:50,mid:500,color:"a"}),this.register(cleverapps.DailyTask.COLLECT_COLOR_CELLS,{low:50,mid:500,color:"b"}),this.register(cleverapps.DailyTask.COLLECT_COLOR_CELLS,{low:50,mid:500,color:"c"}),this.register(cleverapps.DailyTask.COLLECT_COLOR_CELLS,{low:50,mid:500,color:"d"}),this.register(cleverapps.DailyTask.COLLECT_COLOR_CELLS,{low:50,mid:500,color:"e"}),this.register(cleverapps.DailyTask.COLLECT_COLOR_CELLS,{low:50,mid:500,color:"w"}),this.register(cleverapps.DailyTask.PASS_LEVELS_IN_ROW,{mid:5,hard:10}),this.register(cleverapps.DailyTask.LEVEL_CHAMPION,{mid:1,hard:3,active:n}),this.register(
cleverapps.DailyTask.COLLECT_SPECIAL_CELLS,{mid:20,hard:50,cell_code:FishCell.GOAL_ID,active:t.bind(this,16)}),this.register(cleverapps.DailyTask.COLLECT_SPECIAL_CELLS,{low:10,mid:50,hard:150,cell_code:FlowerCell.GOAL_ID,active:t.bind(this,23)}),this.register(cleverapps.DailyTask.COLLECT_SPECIAL_CELLS,{low:20,mid:100,hard:300,cell_code:NutCell.GOAL_ID,active:t.bind(this,31)}),this.register(cleverapps.DailyTask.COLLECT_SPECIAL_CELLS,{low:20,mid:100,hard:300,cell_code:Mark.GOAL_ID,active:t.bind(this,76)}),this.register(cleverapps.DailyTask.COLLECT_SPECIAL_CELLS,{mid:5,hard:15,cell_code:MouseCell.GOAL_ID,active:t.bind(this,91)}),this.register(cleverapps.DailyTask.COLLECT_SPECIAL_CELLS,{low:30,mid:150,hard:500,cell_code:IceTile.GOAL_ID,active:t.bind(this,151)}),this.register(cleverapps.DailyTask.COLLECT_SPECIAL_CELLS,{mid:5,hard:15,cell_code:DragonCell.GOAL_ID,active:t.bind(this,181)}),this.register(cleverapps.DailyTask.COLLECT_SPECIAL_CELLS,{mid:20,hard:50,cell_code:CookieManCell.GOAL_ID,
active:t.bind(this,196)}),this.register(cleverapps.DailyTask.COLLECT_SPECIAL_CELLS,{mid:50,hard:150,cell_code:CakeCell.GOAL_ID,active:t.bind(this,376)}),this.register(cleverapps.DailyTask.COLLECT_SPECIAL_CELLS,{low:20,mid:100,hard:300,cell_code:MuffinGoalCell.GOAL_ID,active:t.bind(this,406)}),this.register(cleverapps.DailyTask.COLLECT_SPECIAL_CELLS,{low:20,mid:100,hard:300,cell_code:WaffleCell.GOAL_ID,active:t.bind(this,526)}),this.register(cleverapps.DailyTask.COLLECT_SPECIAL_CELLS,{low:20,mid:100,hard:300,cell_code:LollipopCell.GOAL_ID,active:t.bind(this,616)}),this.register(cleverapps.DailyTask.COLLECT_SPECIAL_CELLS,{mid:5,hard:15,cell_code:DogCell.GOAL_ID,active:t.bind(this,706)}),this.register(cleverapps.DailyTask.COLLECT_SPECIAL_CELLS,{low:10,mid:50,hard:150,cell_code:TruffleCell.GOAL_ID,active:t.bind(this,736)}),this.register(cleverapps.DailyTask.COLLECT_SPECIAL_CELLS,{low:20,mid:100,hard:300,cell_code:ColorCookieManCell.GOAL_ID,active:t.bind(this,766)}),this.register(
cleverapps.DailyTask.COLLECT_HERO_CELLS,{low:5,mid:25,hard:75,color:"a"}),this.register(cleverapps.DailyTask.COLLECT_HERO_CELLS,{low:5,mid:25,hard:75,color:"b"}),this.register(cleverapps.DailyTask.COLLECT_HERO_CELLS,{low:5,mid:25,hard:75,color:"c"}),this.register(cleverapps.DailyTask.COLLECT_HERO_CELLS,{low:5,mid:25,hard:75,color:"d"}),this.register(cleverapps.DailyTask.COLLECT_HERO_CELLS,{low:5,mid:25,hard:75,color:"e"}),this.register(cleverapps.DailyTask.COLLECT_HERO_CELLS,{low:5,mid:25,hard:75,color:"w"}),cleverapps.DailyTasksProvider.TASKS_BY_ORDER={0:{low:cleverapps.DailyTask.USE_MULTI_COLOR_CELL,mid:cleverapps.DailyTask.USE_BOOSTER,hard:cleverapps.DailyTask.PASS_LEVELS_IN_ROW}})},cleverapps.DailyTasksProvider.prototype.register=function(e,t){var n=new cleverapps.DailyTaskDefinition(e,t);this.tasks.push(n)},cleverapps.DailyTasksProvider.prototype.getActiveTasksList=function(){return this.tasks.filter(function(t){try{return"function"==typeof t.active?t.active():!1!==t.active}catch(
e){throw cleverapps.ReportStream.debug("DailyTasksProvider type = "+t.type+" "+e.message),e}})},cleverapps.DailyTasksProvider.prototype.generateTasks=function(s){var t,n,e,i=this.getActiveTasksList(),o=function(e){var t=e.map(function(e){return e.type});t=cleverapps.unique(t),cleverapps.Random.seed(s);var n=cleverapps.Random.choose(t);return 0<=t.indexOf(cleverapps.DailyTask.LOGIN_FACEBOOK)&&cleverapps.Random.nextDouble()<.3&&(n=cleverapps.DailyTask.LOGIN_FACEBOOK),void 0!==cleverapps.DailyTasksProvider.CHOOSE_TYPE&&-1!==t.indexOf(cleverapps.DailyTasksProvider.CHOOSE_TYPE)&&(n=cleverapps.DailyTasksProvider.CHOOSE_TYPE),e=e.filter(function(e){return e.type===n}),cleverapps.Random.choose(e)};if(void 0!==cleverapps.DailyTasksProvider.TASKS_BY_ORDER[s])t=i.filter(function(e){return e.type===cleverapps.DailyTasksProvider.TASKS_BY_ORDER[s].low})[0].createTask("low"),n=i.filter(function(e){return e.type===cleverapps.DailyTasksProvider.TASKS_BY_ORDER[s].mid})[0].createTask("mid"),e=i.filter(
function(e){return e.type===cleverapps.DailyTasksProvider.TASKS_BY_ORDER[s].hard})[0].createTask("hard");else{var r=i.filter(function(e){return e.low});t=o(r).createTask("low");var a=i.filter(function(e){return e.mid&&e.type!==t.type});n=o(a).createTask("mid"),e=o(i.filter(function(e){return e.hard&&e.type!==t.type&&e.type!==n.type})).createTask("hard")}return[t,n,e]},cleverapps.DailyTasksProvider.TASKS_BY_ORDER={},cleverapps.DailyTasksProvider.CHOOSE_TYPE=void 0,cleverapps.DailyTaskDefinition=function(e,t){t=t||{},this.type=e,this.active=t.active,this.low=t.low,this.mid=t.mid,this.hard=t.hard,this.data=t},cleverapps.DailyTaskDefinition.prototype.createTask=function(e){var t=this.data[e],n={color:this.data.color,booster:this.data.booster,cell_code:this.data.cell_code,letter:this.data.letter,cardValue:this.data.cardValue,cardSuit:this.data.cardSuit};return new cleverapps.DailyTask(this.type,t,n,e)};var DailyTasksWindow=Window.extend({onWindowLoaded:function(){this.createContent()
;var e=cleverapps.overrideStyles(cleverapps.styles.Window,cleverapps.styles.DailyTasksWindow,!0);this._super({name:"dailytaskswindow",title:cleverapps.dailyTasks.isRunning()?"messages:DailyTasksWindow.title":"messages:DailyTasksWindow.finished.title",content:this.content,styles:e}),this.content.baseScale=this.content.scale,cleverapps.eventLogger.logEvent(cleverapps.EVENTS.DAILY_TASKS_OPEN_WINDOW),cleverapps.playSession.set(cleverapps.EVENTS.SESSION_DAILY_TASK_OPEN_WINDOW,!0),cleverapps.audio.playSound(bundles.main.urls.window_effect)},createContent:function(){cleverapps.dailyTasks.processResults();var e=[];e.push(this.createBottom()),e.push(this.createTasks());var t=cleverapps.styles.DailyTasksWindow.content,n=new cleverapps.Layout(e,{direction:cleverapps.UI.VERTICAL,y:t.offsetY,margin:t.margin,padding:t.padding});this.content?this.content.innerContent&&this.content.innerContent.removeFromParent():(this.content=new cc.Node,this.content.setContentSize2(n.getContentSize())),
this.window&&this.setTitle(Messages.get(cleverapps.dailyTasks.isRunning()?"messages:DailyTasksWindow.title":"messages:DailyTasksWindow.finished.title")),this.content.innerContent=n,this.content.addChild(n),n.setAnchorPoint2(.5,1),n.setPositionRound(0,this.content.height/2)},createBottom:function(){var e,t=new cc.Node;return t.setAnchorPoint2(),t.setContentSize2(cleverapps.styles.DailyTasksWindow.content.bottom),e=cleverapps.dailyTasks.isRunning()?this.createTimer():this.createRefreshButton(),t.addChild(e),e.setPosition(t.width/2,t.height/2),t.setCascadeOpacityEnabled(!0),e.setCascadeOpacityEnabled(!0),this.bottomContent=t},createTimer:function(){var e=cleverapps.styles.DailyTasksWindow.timer,t=cleverapps.dailyTasks.getTimeLeft(),n=this.countDown=new cleverapps.CountDown(t,{onFinish:function(){this.createContent()}.bind(this)}),s={font:cleverapps.styles.FONTS.DAILY_TASK_TIMER_TEXT||e.timerFont,timerPosition:e.timerPosition};bundles.main.frames.missions_item_bg_png&&(
s.background_content=cleverapps.UI.createScale9Sprite(bundles.main.frames.daily_task_timer_bg_png||e.bg),s.background_content.setContentSize2(e.width,e.height));var i=new cleverapps.CountDownView(n,s),o=cleverapps.UI.generateTTFText("messages:DailyTasksWindow.TimeToRefresh",e.font);o.fitTo(e.text.width);var r=[o,i];if(e.direction===cleverapps.UI.VERTICAL&&r.reverse(),i.setCascadeOpacityEnabled(!0),bundles.main.frames.daily_task_timer_icon_png){var a=new cc.Sprite(bundles.main.frames.daily_task_timer_icon_png);i.addChild(a),a.setPositionRound(e.icon),a.setScale(e.icon.scale||1)}return this.timer=new cleverapps.Layout(r,{direction:e.direction,margin:e.margin}),i.y+=e.dy,i.setCascadeOpacityEnabled(this.timer),this.timer},createTasks:function(){var s=[],i=cleverapps.dailyTasks.tasks;i.forEach(function(e,t){"function"!=typeof e.getLevel&&(cleverapps.ReportStream.debug(["task get level is not a function","tasks - "+JSON.stringify(cleverapps.dailyTasks.getInfo()),
"current task type - "+typeof e,"keys of tasks "+Object.keys(i),"level "+t]),cleverapps.ReportStream.debug(["task "+e]));var n=new DailyTaskView(e,this.close.bind(this));s.push(n)},this),this.taskViews=cleverapps.clone(s);var e=cleverapps.styles.DailyTasksWindow.tasks,t=new cleverapps.Layout(s.reverse(),{direction:cleverapps.UI.VERTICAL,margin:e.margin}),n=new ccui.Layout;n.setAnchorPoint2(),n.setContentSize2(t.width+e.crop.dx,t.height+e.crop.dy),n.setClippingEnabled(!0),n.addChild(t),t.setPositionRound(n.width/2,n.height/2);var o=new cc.Node;return o.setAnchorPoint2(),o.setContentSize2(t.getContentSize()),n.setPositionRound(o.width/2,o.height/2),o.addChild(n),o},createRefreshButton:function(){var e=cleverapps.styles.DailyTasksWindow;return new cleverapps.UI.Button({width:e.button.width,height:e.button.height,text:Messages.get("DailyTasksWindow.Refresh"),font:cleverapps.styles.FONTS.BUTTON_TEXT,padding:{x:e.button.paddingX},onClicked:this.refresh.bind(this)})},hideOneTask:function(e,t,
n){e.runAction(new cc.Sequence(new cc.DelayTime(t),new cc.Spawn(new cc.MoveBy(.5,cc.p(-e.width,0)).easing(cc.easeBackIn()),new cc.Sequence(new cc.DelayTime(.25),new cc.FadeOut(.25))),new cc.CallFunc(n)))},showOneTask:function(e,t,n){e.setVisible(!1),e.setScale(0),e.setOpacity(0),e.runAction(new cc.Sequence(new cc.DelayTime(t),new cc.CallFunc(function(){e.setVisible(!0),e.onShowAnimation()}),new cc.Spawn(new cc.ScaleTo(.5,1).easing(cc.easeBackOut()),new cc.FadeIn(.25)),new cc.CallFunc(n)))},hideTasks:function(e){var t=0,n=function(){++t===this.taskViews.length&&e()}.bind(this);this.taskViews.forEach(function(e,t){this.hideOneTask(e,.3*t,n)},this)},showTasks:function(e){var t=0,n=function(){++t===this.taskViews.length&&e()}.bind(this);this.taskViews.forEach(function(e,t){this.showOneTask(e,.3*t,n)},this)},refresh:function(){0===cleverapps.dailyTasks.getNotCollectedTasks().length?(this.bottomContent.runAction(new cc.ScaleTo(.2,0)),this.hideTasks(function(){cleverapps.dailyTasks.startNew()
,this.createContent(),this.bottomContent.setVisible(!1),this.showTasks(function(){this.bottomContent.setVisible(!0),this.bottomContent.setOpacity(0),this.bottomContent.runAction(new cc.FadeIn(.3))}.bind(this))}.bind(this))):(cleverapps.dailyTasks.isRunning()||cleverapps.dailyTasks.collectFinishedTasks(),this.createContent())},close:function(){cleverapps.dailyTasks.isRunning()||cleverapps.dailyTasks.collectFinishedTasks(),this._super()}});DailyTasksWindow.prototype.listBundles=function(){return"match3"===cleverapps.config.type?["game","heroes","dailytasks"]:["dailytasks"]},cleverapps.styles.DailyTasksWindow={button:{width:350,height:100,paddingX:10},tasks:{margin:20,crop:{dx:0,dy:150}},content:{margin:30,bottom:{width:500,height:100},padding:{x:-40,y:0}},timer:{direction:cleverapps.UI.HORIZONTAL,bg:bundles.main.frames.missions_item_bg_png,width:240,height:70,margin:10,timerPosition:{x:0,y:0},font:cleverapps.styles.FONTS.WINDOW_TEXT,timerFont:cleverapps.styles.FONTS.TEXT,dy:0,text:{
width:450}},contentOffset:-60};var DailyTaskView=cc.Node.extend({ctor:function(e,t){this._super(),this.task=e;var n=cleverapps.styles.DailyTaskView;this.setContentSize2(n.width,n.height),this.setAnchorPoint2(),this.setLocalZOrder(n.localZOrder["level_"+e.getLevel()].zOrder),this.addBackground(),this.addTitle(),this.addPresent(),this.addIcon(),-1!==["scramble","differences","wordsoup","tripeaks","wordheaps","magicwords"].indexOf(cleverapps.config.name)?this.addProgressBar():(this.addProgressCounter(),this.addBackgroundTop()),this.addCheckMark(),this.addRewardButton(t),this.addPlayButton(t),this.setCascadeOpacityEnabled(!0)},onShowAnimation:function(){var e=this.icon.getScale();this.icon.setScale(.7*e);var t=this.playButton.getScale();this.playButton.setScale(.7*t);var n=this.rewardButton.getScale();this.rewardButton.setScale(.7*n),this.icon.runAction(new cc.Sequence(new cc.ScaleTo(.5,1.2*e),new cc.ScaleTo(.4,e).easing(cc.easeBackOut()))),this.playButton.runAction(new cc.Sequence(
new cc.ScaleTo(.5,1.2*t),new cc.ScaleTo(.4,t).easing(cc.easeBackOut()))),this.rewardButton.runAction(new cc.Sequence(new cc.ScaleTo(.5,1.2*n),new cc.ScaleTo(.4,n).easing(cc.easeBackOut())))},onEnterTransitionDidFinish:function(){this._super(),this.task.onUpdateListener=this.createListener(this.onUpdate.bind(this)),this.onUpdate()},getBackgroundImage:function(){if(bundles.dailytasks.frames.daily_task_bg_png)return bundles.dailytasks.frames.daily_task_bg_png;var e=this.task.getLevel();return"low"===e?bundles.dailytasks.frames.missions_easy_bg_png:"mid"===e?bundles.dailytasks.frames.missions_medium_bg_png:"hard"===e?bundles.dailytasks.frames.missions_hard_bg_png:void 0},addBackground:function(){var e=this.background=cleverapps.UI.createScale9Sprite(this.getBackgroundImage());e.setContentSize2(this.getContentSize()),e.setPositionRound(this.width/2,this.height/2),this.addChild(e)},addRewardButton:function(){var e=cleverapps.styles.DailyTaskView,t=cleverapps.UI.generateOnlyText(
"messages:DailyTaskView.Get",cleverapps.styles.FONTS.DAILY_TASK_BUTTON_TEXT),n=this.rewardButton=new cleverapps.UI.Button({width:e.button.width,height:e.button.height,button_png:e.button_png,button_on_png:e.button_on_png,content:t,onClicked:function(){new DailyTaskRewardWindow(this.task)}.bind(this)});n.setPositionRound(e.button.x,e.button.y),this.addChild(n),n.setScale(e.button.scale),n.baseScale=n.scale,n.setCascadeOpacityEnabled(!0),n.setLocalZOrder(1)},addPlayButton:function(e){var t=cleverapps.styles.DailyTaskView;t=t.playButton?t.playButton:t.button;var n=cleverapps.UI.generateOnlyText("messages:DailyTaskView.Go",cleverapps.styles.FONTS.DAILY_TASK_BUTTON_TEXT),s=this.playButton=new cleverapps.UI.Button({width:t.width,height:t.height,button_png:t.button_png,button_on_png:t.button_on_png,content:n,onClicked:function(){e(),this.task.run()}.bind(this)});this.addChild(s),s.setPositionRound(t.x,t.y),s.setScale(t.scale),s.baseScale=s.scale,s.setCascadeOpacityEnabled(!0),
s.setLocalZOrder(1)},addProgressBar:function(){var e=cleverapps.styles.DailyTaskView.progressBar;this.progressBar=new ScaledProgressBar(bundles.dailytasks.frames.daily_task_bar_png),this.progressBar.setDimension(e.width,e.height),this.progressBar.setPercentage(0),this.progressBar.setMinProgressWidth(e.minWidth);var t=new cc.Scale9Sprite(bundles.dailytasks.frames.daily_task_bar_bg_png);t.setContentSize2(e.width+e.bg.padding.x,e.height+e.bg.padding.y),t.addChild(this.progressBar),t.setCascadeOpacityEnabled(!0),this.progressBar.setPositionRound(e.offsetX,e.offsetY),this.progressBarText=cleverapps.UI.generateImageText(this.task.progress+"/"+this.task.goal,cleverapps.styles.FONTS.DAILY_TASK_PROGRESS_FONT),t.addChild(this.progressBarText),this.progressBarText.setPositionRound(e.text),this.addChild(t),t.setPositionRound(e)},addProgressCounter:function(){var e=cleverapps.styles.DailyTaskView,t=cleverapps.styles.FONTS.DAILY_TASK_PROGRESS_FONT||e.progress.font;100<=this.task.progress&&(
t=cleverapps.styles.FONTS.DAILY_TASK_PROGRESS_SMALL_FONT||e.progress.fontSmall);var n=this.progressCounter=cleverapps.UI.generateImageText(this.task.progress+" / "+this.task.goal,t);n.setAnchorPoint2(),n.setPosition(e.progress.x,e.progress.y),this.addChild(n)},addTitle:function(){var e=cleverapps.styles.DailyTaskView,t=this.task.getTitle(),n=this.title=cleverapps.UI.generateOnlyText(t.text,cleverapps.styles.FONTS.DAILY_TASK_FONT||e.title.font,t.replace);n.setAnchorPoint2(),n.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER),n.setDimensions(e.title.width,0),n.setPosition(e.title.x,e.title.y),e.title.height&&n.fitTo(void 0,e.title.height),this.addChild(n,1)},addCheckMark:function(){var e=cleverapps.styles.DailyTaskView,t=this.check=new cc.Sprite(bundles.dailytasks.frames.daily_task_mark_png||bundles.main.frames.goal_done_sign||bundles.game.frames.goal_done_sign);t.setPositionRound(e.check.x,this.height/2),t.visible=!1,this.addChild(t)},addPresent:function(){
var e=cleverapps.styles.DailyTaskView.present,t=this.present=new cleverapps.Spine(e.animation.skeleton);e.animation.skin&&t.setSkin(e.animation.skin["level_"+this.task.getLevel()]),t.setScale(e.animation.scale),t.setPositionRound(e.x,e.y),t.visible=!1,this.addChild(t)},addIcon:function(){var e=cleverapps.styles.DailyTaskView,t=this.icon=new cc.Node;t.setAnchorPoint2();var n=this.task.getIcon();if(bundles.dailytasks.frames.daily_task_icon_bg_png){var s=new cc.Sprite(bundles.dailytasks.frames.daily_task_icon_bg_png);t.addChild(s),t.setContentSize2(s.getContentSize()),s.setPositionRound(t.width/2,t.height/2),n.width>.7*s.width&&(n.scale=.7*s.width/n.width)}else t.setContentSize2(n.getContentSize());if(bundles.dailytasks.frames.missions_frame_white_png){var i=this.iconFrame=new cc.Sprite(bundles.dailytasks.frames.missions_frame_white_png);i.setPositionRound(t.width/2,t.height/2),t.addChild(i)}n.setPositionRound(t.width/2,t.height/2),t.addChild(n),t.setCascadeOpacityEnabled(!0),
this.addChild(t),t.setPositionRound(e.icon.x,e.icon.y)},addBackgroundTop:function(){var e=cleverapps.styles.DailyTaskView.bg_top,t=cleverapps.UI.createScale9Sprite(e["level_"+this.task.getLevel()]);t.setContentSize2(e.width,e.height),this.addChild(t),t.setPositionRound(e);var n=cleverapps.UI.generateOnlyText("messages:DailyTaskView.level."+this.task.getLevel(),cleverapps.styles.FONTS.DAILY_TASKS_LEVEL_TEXT);n.setAnchorPoint2(),n.fitTo(t.width-cleverapps.styles.UI.Button.contentPadding),t.addChild(n),n.setPositionRound(t.width/2,e.title.y)},updateProgress:function(){this.progressCounter&&(this.progressCounter.visible=!this.task.isFinished(),this.progressCounter.setString(this.task.progress+" / "+this.task.goal),this.task.expired&&this.progressCounter.setPositionY(this.height/2),this.task.expired&&!this.task.isFinished()&&this.progressCounter.setColor(cleverapps.styles.COLORS.EXPIRED_TASK_FONT_COLOR||cleverapps.styles.COLORS.DARK_RED||cleverapps.styles.COLORS.COLOR_RED)),
this.progressBar&&(this.progressBar.setPercentage(this.task.progress/this.task.goal*100),this.progressBarText.setString(this.task.progress+"/"+this.task.goal))},onUpdate:function(){var e=cleverapps.styles.DailyTaskView;this.playButton.setVisible(!this.task.collected&&!this.task.expired&&!this.task.isFinished()),this.rewardButton.setVisible(!this.task.collected&&!this.task.expired&&this.task.isFinished()),this.iconFrame&&this.iconFrame.setSpriteFrame(new cc.Sprite(this.task.isFinished()?bundles.dailytasks.frames.missions_frame_green_png:bundles.dailytasks.frames.missions_frame_white_png).getSpriteFrame()),this.check&&(this.check.visible=this.task.isFinished()&&this.task.collected),this.updateProgress(),this.task.isFinished()&&!this.task.collected?this.present.setAnimation(0,e.present.animation.animation["level_"+this.task.getLevel()]||e.present.animation.animation,e.present.animation.loop):this.present.visible=!1}});cleverapps.styles.DailyTaskView={width:700,height:180,icon:{x:90,y:94},
title:{x:340,y:100,width:300,height:140,font:cleverapps.styles.FONTS.WINDOW_SMALL_TEXT},bg_top:{level_low:bundles.dailytasks.frames.daily_task_missions_easy_top_png,level_mid:bundles.dailytasks.frames.daily_task_missions_medium_top_png,level_hard:bundles.dailytasks.frames.daily_task_missions_hard_top_png,width:180,height:46,x:{align:"center"},y:{align:"bottom",dy:-8},title:{y:23}},localZOrder:{level_low:{zOrder:1},level_mid:{zOrder:2},level_hard:{zOrder:3}},progress:{x:580,y:120,font:cleverapps.styles.FONTS.WINDOW_TEXT,fontSmall:cleverapps.styles.FONTS.WINDOW_SMALL_TEXT},check:{x:580},present:{x:580,y:120,animation:{skeleton:bundles.windows.jsons.present_json,skin:{level_low:"blue",level_mid:"pink",level_hard:"green"},scale:1,animation:"animation",loop:!0}},button:{width:210,height:100,scale:.7,x:580,y:58}};var DailyTaskRewardWindow=RewardWindow.extend({ctor:function(e){this.task=e,this.reward=this.getReward(),this._super({reward:this.reward})},onWindowLoaded:function(e){this._super({
reward:this.reward,title:"messages:DailyTaskRewardWindow.title",name:"dailytaskrewardwindow",text:"messages:DailyTaskRewardWindow.text",animation:cleverapps.styles.DailyTaskRewardWindow.animation,rewardName:"dailyTasks"})},getReward:function(){var e=RewardsConfig.DailyTask,t=cleverapps.Random.choose(e[this.task.getLevel()]);return e.prepareByRich&&(t=cleverapps.user.prepareRewardByRich(t)),cleverapps.clone(t,!0)},onReceiveReward:function(){cleverapps.eventLogger.logEvent(cleverapps.EVENTS.DAILY_TASK_REWARD+this.task.getLevel()),cleverapps.playSession.inc(cleverapps.EVENTS.SESSION_DAILY_TASK_REWARD),cleverapps.dailyTasks.collect(this.task)},receiveReward:function(){this.task.isFinished()&&!this.task.collected&&(this.onReceiveReward(),cleverapps.Chest.prototype._receiveReward(this.reward))}});cleverapps.styles.DailyTaskRewardWindow={animation:{json:bundles.main.jsons.reward_spine_json}};var BattlePass=function(e){((this.mission=e).battlePass=this).load(e.details),
this.onBoughtPremium=function(){}};BattlePass.prototype.save=function(){this.mission.details=this.getInfo(),this.mission.update(0,this.getInfo())},BattlePass.prototype.load=function(e){this.boughtPremium=e.boughtPremium||!1,this.lastChanceUsed=e.lastChanceUsed||!1,this.currentTask=this.createTask(e.currentTask),this.levelsToReward=e.levelsToReward||[],this.levelsToPremReward=e.levelsToPremReward||[],this.lastShownTask=this.createTask(e.lastShownTask||e.currentTask)},BattlePass.prototype.getInfo=function(){return{boughtPremium:this.boughtPremium,lastChanceUsed:this.lastChanceUsed,levelsToReward:this.levelsToReward,levelsToPremReward:this.levelsToPremReward,lastShownTask:{level:this.lastShownTask.level,progress:this.lastShownTask.progress},currentTask:{level:this.currentTask.level,progress:this.currentTask.progress}}},BattlePass.prototype.updateLastShownTask=function(e){this.lastShownTask=this.createTask(e),this.save()},BattlePass.prototype.updateState=function(){(0===this.getTimeLeft(
)&&!this.hasAnyReward()&&!this.hasLastChance()||this.tasksCompleted()&&!this.anyRewardsLeft())&&this.mission.complete()},BattlePass.prototype.currentLevel=function(){return this.currentTask.level},BattlePass.prototype.goNextLevel=function(){var e=this.currentLevel();this.levelsToReward.push(e),this.levelsToPremReward.push(e);var t=this.createTask({level:e+1});t.type===this.currentTask.type&&(t.progress=Math.max(0,this.currentTask.progress-this.currentTask.goal)),this.currentTask=t,cleverapps.eventLogger.logEvent(cleverapps.EVENTS.BATTLE_PASS_FINISH_TASK+"_"+e)},BattlePass.prototype.takeLevelReward=function(e,t){if(this.hasReward(e,t)){var n=BattlePass.getLevels(),s=t?n[e].premiumReward:n[e].reward;if(s.unit){var i=cleverapps.toArray(s.unit).reduce(function(e,t){return e+t.amount},0);if(Game.currentGame.map.countEmptySlots()<i)return void Game.currentGame.onHintMessage("messages:Spawn.nospace",!0)}return t?this.levelsToPremReward.splice(this.levelsToPremReward.indexOf(e),1
):this.levelsToReward.splice(this.levelsToReward.indexOf(e),1),this.save(),cleverapps.eventLogger.logEvent((t?cleverapps.EVENTS.BATTLE_PASS_RECEIVED_PREMIUM:cleverapps.EVENTS.BATTLE_PASS_RECEIVED)+"_"+e),s}},BattlePass.prototype.takeAllRemainingRewards=function(){var t={},n=BattlePass.getLevels();return this.levelsToReward.forEach(function(e){Product.AddUpRewards(n[e].reward,t)}),this.levelsToReward=[],this.boughtPremium&&(this.levelsToPremReward.forEach(function(e){Product.AddUpRewards(n[e].premiumReward,t)}),this.levelsToPremReward=[]),Product.UnlimitedToHours(t),0<Object.keys(t).length?t:void 0},BattlePass.prototype.hasReward=function(e,t){return t?-1!==this.levelsToPremReward.indexOf(e):-1!==this.levelsToReward.indexOf(e)},BattlePass.prototype.hasAnyReward=function(){return 0<this.levelsToPremReward.length&&this.boughtPremium||0<this.levelsToReward.length},BattlePass.prototype.setPremium=function(){this.boughtPremium=!0,this.onBoughtPremium(),this.save(),
cleverapps.eventLogger.logEvent(cleverapps.EVENTS.BATTLE_PASS_BOUGHT)},BattlePass.prototype.tasksCompleted=function(){return this.currentTask.level>=BattlePass.getLevels().length},BattlePass.prototype.anyRewardsLeft=function(){return 0!==this.levelsToReward.length||0!==this.levelsToPremReward.length},BattlePass.prototype.countAvailableRewards=function(){var e=this.levelsToReward.length;return this.hasPremium()&&(e+=this.levelsToPremReward.length),e},BattlePass.prototype.getTimeLeft=function(){return this.mission.isRunning()?this.mission.getTimeLeft():0},BattlePass.prototype.createTask=function(e){var t=(e=e||{}).level||0,n=BattlePass.getLevels()[t]||{};return n=n.task||{},{level:t,progress:e.progress||0,goal:n.goal||0,type:n.type}},BattlePass.prototype.createFinishedTask=function(){var e=BattlePass.getLevels();return this.createTask({level:e.length-1,progress:e[e.length-1].task.goal})},BattlePass.prototype.setTaskProgress=function(e){this.currentTask.progress="number"==typeof e?e:1},
BattlePass.prototype.addTaskProgress=function(e){this.currentTask.progress+="number"==typeof e?e:1},BattlePass.prototype.isTaskFinished=function(){return this.currentTask.progress>=this.currentTask.goal},BattlePass.prototype.getCurrentTask=function(){return this.createTask(this.currentTask)},BattlePass.prototype.getLastShownTask=function(){return this.createTask(this.lastShownTask)},BattlePass.prototype.getMaxLevel=function(){return BattlePass.getLevels().length-1},BattlePass.prototype.hasPremium=function(){return this.boughtPremium},BattlePass.prototype.hasLastChance=function(){return!this.lastChanceUsed&&!this.tasksCompleted()&&0===this.getTimeLeft()&&!this.hasAnyReward()},BattlePass.prototype.useLastChance=function(){this.lastChanceUsed=!0,this.save()};var BattlePassMissionLogic=function(e){this.mission=e,this.battlePass=new BattlePass(this.mission),this.showNewRewards=!1,this.updateDisplayState()};BattlePassMissionLogic.prototype.receiveReward=function(){
return this.battlePass.takeAllRemainingRewards()},BattlePassMissionLogic.prototype.wantsToActOnFinish=function(){return 0<this.battlePass.countAvailableRewards()},BattlePassMissionLogic.prototype.processEvent=function(e,t){var n=this.mission,s=n.battlePass;if((t.lastChance||n.isRunning())&&s.getCurrentTask().type===e){var i=s.hasAnyReward();for(e===Mission.EVENT_PASS_LEVELS_IN_ROW&&0===t.amount?s.setTaskProgress(t.amount):s.addTaskProgress(t.amount);!s.tasksCompleted()&&s.isTaskFinished();)s.goNextLevel();s.save(),!i&&s.hasAnyReward()&&(cleverapps.sideBar.resetByClassName(MissionIcon),this.showNewRewards=!0),this.updateDisplayState()}},BattlePassMissionLogic.prototype.updateDisplayState=function(){this.lastCompleted||(this.battlePass.tasksCompleted()||0===this.battlePass.getTimeLeft())&&(this.lastCompleted=!0,this.showCompleted=!0)},BattlePassMissionLogic.prototype.displayOnFreeFocus=function(){return this.showNewRewards||this.showCompleted},
BattlePassMissionLogic.prototype.setDisplayed=function(){this.showNewRewards=!1,this.showCompleted=!1},BattlePass.getLevels=function(){return[{level:0,task:{type:Mission.EVENT_COLLECT_COLOR_CELLS,goal:900},reward:{unlimitedLives:"2 hour"},premiumReward:{unlimitedLives:"24 hour"}},{level:1,task:{type:Mission.EVENT_LEVEL_FINISH,goal:4},reward:{gold:75},premiumReward:{gold:1e3}},{level:2,task:{type:Mission.EVENT_COLLECT_HERO_CELLS,goal:50},reward:{unlimitedLives:"6 hour"},premiumReward:{boosters:{0:5}}},{level:3,task:{type:Mission.EVENT_USE_MULTI_COLOR_CELL,goal:1},reward:{gold:100},premiumReward:{unlimitedLives:"48 hour"}},{level:4,task:{type:Mission.EVENT_COMPLETE_DAILY_TASK,goal:3},reward:{unlimitedLives:"12 hour"},premiumReward:{boosters:{1:5}}},{level:5,task:{type:Mission.EVENT_COLLECT_COLOR_CELLS,goal:2e3},reward:{gold:200},premiumReward:{gold:2e3}},{level:6,task:{type:Mission.EVENT_PLAY_DAILYCUP,goal:5},reward:{boosters:{2:1}},premiumReward:{boosters:{2:5}}},{level:7,task:{
type:Mission.EVENT_LEVEL_FINISH,goal:8},reward:{gold:300},premiumReward:{unlimitedLives:"72 hour"}},{level:8,task:{type:Mission.EVENT_COLLECT_HERO_CELLS,goal:150},reward:{unlimitedLives:"24 hour"},premiumReward:{boosters:{0:10}}},{level:9,task:{type:Mission.EVENT_COLLECT_CLOVER,goal:35},reward:{gold:600},premiumReward:{gold:4e3}},{level:10,task:{type:Mission.EVENT_COLLECT_STARS,goal:20},reward:{boosters:{2:3}},premiumReward:{boosters:{1:10}}},{level:11,task:{type:Mission.EVENT_USE_MULTI_COLOR_CELL,goal:4},reward:{gold:1e3},premiumReward:{unlimitedLives:"120 hour"}},{level:12,task:{type:Mission.EVENT_WIN_DAILYCUP,goal:1},reward:{unlimitedLives:"48 hour"},premiumReward:{boosters:{2:10}}},{level:13,task:{type:Mission.EVENT_PASS_LEVELS_IN_ROW,goal:5},reward:{gold:1500},premiumReward:{gold:8e3}}]};var BattlePassRewardIcon=cc.Node.extend({ctor:function(e,t,n){switch(this._super(),this.options=n=n||{},void 0===n.prefix&&(n.prefix="x"),e){case"gold":case"rubies":this.initWithSprite(
bundles.reward_icons.frames.reward_gold_png,n.prefix+t);break;case"exp":this.initWithSprite(bundles.reward_icons.frames.reward_exp_png,n.prefix+t);break;case"battlePass":this.initWithSprite(bundles.battle_pass.frames.ticket,"messages:BattlePassProduct.Title");break;case"coins":this.initWithSprite(bundles.reward_icons.frames.reward_coin_png,n.prefix+t);break;case"lives":case"energy":this.initWithSprite(bundles.reward_icons.frames.reward_energy_png,n.prefix+t);break;case"unlimitedLives":this.initWithSprite(bundles.reward_icons.frames.life_unlim,Product.FormatUnlimitedLives(t).title);break;case"boosters":var s=Object.keys(t)[0];this.initWithSprite(RewardsHelper.ICONS[s],n.prefix+t[s]);break;case"wands":this.initWithSprite(bundles.reward_icons.frames.reward_wand_png,n.prefix+t);break;case"worker":t=Product.FormatUnlimitedLives(t),this.initWithSprite(bundles.reward_icons.frames.reward_worker_png,t.title,{amount:t.amount});break;case"unit":this.initWithUnit(t,n.prefix)}},
initWithSprite:function(e,t,n){this.initWithNode(new cc.Sprite(e),t,n)},initWithUnit:function(e,t){var n=UnitView.getUnitImage(e);n&&(n.clearTrack&&n.clearTrack(0),this.initWithNode(n,t+e.amount))},initWithNode:function(e,t,n){var s=this.options,i=cleverapps.styles.BattlePassRewardIcon;this.setContentSize2(i.icon),this.icon=e,cleverapps.UI.fitToBox(e,i.icon),e.setAnchorPoint2(),e.setPositionRound(i.icon),this.addChild(e);var o=s.font||cleverapps.styles.FONTS.BATTLEPASS_REWARD_TEXT;cleverapps.UI.ImageFont.IsApplicable(o,t)?(this.text=cleverapps.UI.generateImageText(t,o,n),this.text.setPositionRound(i.text)):(this.text=cleverapps.UI.generateOnlyText(t,o,n),this.text.setPositionRound(i.regularText)),this.text.setAnchorPoint2(),this.text.setLocalZOrder(1),this.addChild(this.text)},setDiscolor:function(e){e?(this.icon.setOpacity(120),this.icon.setColor(new cc.Color(0,150,255,255))):(this.icon.setOpacity(255),this.icon.setColor(new cc.Color(255,255,255,255)))},setAttention:function(e){
var t=cleverapps.styles.BattlePassRewardIcon.attention;if(this.attention&&(this.attention.removeFromParent(),delete this.attention),e){var n=this.attention=new cc.Sprite(e);n.setAnchorPoint2(),n.setPositionRound(t),n.setScale(t.scale),this.addChild(n)}},setShining:function(e){var t=cleverapps.styles.BattlePassRewardIcon.shining;if(this.shining&&(this.shining.removeFromParent(),delete this.shining),e){var n=this.shining=new cleverapps.Spine(bundles.battle_pass.jsons.shining_json,t.scale);n.setAnimation(0,"animation",!0),n.setAnchorPoint2(),n.setPositionRound(t),n.setLocalZOrder(-1),this.addChild(n)}},setFlying:function(e,t){var n=cleverapps.styles.BattlePassRewardIcon.flying;this.flyingAction&&(this.stopAction(this.flyingAction),delete this.flyingAction),e&&(this.flyingAction=this.runAction(new cc.Sequence(new cc.DelayTime(1.5*Math.random()),new cc.CallFunc(function(){this.flyingAction=this.runAction(new cc.RepeatForever(new cc.Sequence(new cc.CallFunc(function(){this.icon.runAction(
new cc.Sequence(new cc.MoveBy(3,0,n.offsetY),new cc.CallFunc(function(){Math.random()<.7/t.countAvailableRewards()&&this.icon.runAction(new cc.Sequence(new cc.RotateBy(.25,10),new cc.RotateBy(.25,-10),new cc.RotateBy(.25,10),new cc.RotateBy(.25,-10)))},this),new cc.MoveBy(1.5,0,-n.offsetY)))},this),new cc.DelayTime(4.5))))},this))))}});BattlePassRewardIcon.createIconsFromRewardsList=function(e,t){var n=[];for(var s in e){var i=e[s];if("unit"===s){i=cleverapps.toArray(i);for(var o=0;o<i.length;++o)n.push(new BattlePassRewardIcon(s,i[o],t))}else n.push(new BattlePassRewardIcon(s,i,t))}return n},cleverapps.overrideFonts(cleverapps.styles.FONTS,{BATTLEPASS_REWARD_TEXT:{size:40,color:cleverapps.styles.COLORS.WHITE,stroke:cleverapps.styles.DECORATORS.IMAGE_FONT_STROKE}}),cleverapps.styles.BattlePassRewardIcon={icon:{x:{align:"center",dx:0},y:{align:"bottom",dy:10},width:180,height:180,maxScale:1.7},text:{x:{align:"right",dx:0},y:{align:"bottom",dy:10}},regularText:{x:{align:"right",dx:0},y:{
align:"bottom",dy:-2}},attention:{x:{align:"right",dx:0},y:{align:"bottom",dy:85},scale:.8},shining:{x:{align:"center",dx:-3},y:{align:"center",dy:5},scale:.7},flying:{offsetY:8}};var BattlePassTask=cc.Node.extend({ctor:function(e,t){this._super(),this.level=e,this.battlePass=t;var n=cleverapps.styles.BattlePassTasks;this.setContentSize2(n),this.setAnchorPoint2();var s=this.rewards=BattlePassRewardIcon.createIconsFromRewardsList(e.reward),i=new cleverapps.Layout(s,{direction:cleverapps.UI.HORIZONTAL});i.setAnchorPoint2(),i.setPositionRound(n.rewards),this.addChild(i);var o=this.premiumRewards=BattlePassRewardIcon.createIconsFromRewardsList(e.premiumReward),r=new cleverapps.Layout(o,{direction:cleverapps.UI.HORIZONTAL});r.setAnchorPoint2(),r.setPositionRound(n.premiumRewards),this.addChild(r);var a=this.arrow=new cc.Sprite(bundles.battle_pass.frames.progress_arrows);a.setAnchorPoint2(),a.setPositionRound(n.arrows),this.addChild(a)},claimReward:function(e){var t=this.battlePass,
n=t.takeLevelReward(this.level.level,e);n&&new RewardWindow({reward:n,callback:function(){t.hasLastChance()||(0===t.getTimeLeft()?t.hasAnyReward():t.anyRewardsLeft())||cleverapps.windows.currentWindow().close()}})},updateState:function(e){this.updateRewardsState(e,!1,this.rewards),this.updateRewardsState(e,!0,this.premiumRewards)},calcRewardsState:function(e,t){var n=this.battlePass,s=this.level.level,i={};return t&&!n.hasPremium()?i.needsPremium=!0:(s<e.level||s===e.level&&e.goal===e.progress)&&(n.hasReward(s,t)?i.available=!0:i.claimed=!0),i},updateRewardsState:function(e,t,n){var s=this.calcRewardsState(e,t);n.forEach(function(e){s.needsPremium?this.applyNeedPremiumState(e):s.available?this.applyAvailableState(e,t):s.claimed?this.applyClaimedState(e):this.applyUnavailableState(e)},this)},applyNeedPremiumState:function(e){var t=cleverapps.styles.BattlePassTasks;cc.eventManager.removeListeners(e),e.setDiscolor(!0),e.setAttention(void 0),e.setShining(!1),e.setFlying(!1),
cleverapps.tooltipManager.create(e,{text:"messages:BattlePassWindow.needPremiumToolTip",position:cleverapps.styles.UI.Tooltip.LOCATION.above,swallowTouches:!1,ignoreOnTouchMoved:!0,ignoreOnTouchMovedThreshold:t.ignoreOnTouchMovedThreshold})},applyAvailableState:function(e,t){cc.eventManager.removeListeners(e),e.setDiscolor(!1),e.setAttention(bundles.battle_pass.frames.attention_exclamation_large_png||bundles.mergeui.frames.attention_exclamation),e.setShining(!0),e.setFlying(!0,this.battlePass),cleverapps.UI.onClick(e,this.claimReward.bind(this,t),{noThrottle:!0,ignoreOnTouchMoved:!0,swallowTouches:!1,useInteractiveScale:!0})},applyClaimedState:function(e){cc.eventManager.removeListeners(e),e.setDiscolor(!0),e.setAttention(bundles.battle_pass.frames.attention_ok_png||bundles.mergeui.frames.attention_ok),e.setShining(!1),e.setFlying(!1)},applyUnavailableState:function(e){var t=cleverapps.styles.BattlePassTasks;cc.eventManager.removeListeners(e),e.setDiscolor(!1),e.setAttention(void 0),
e.setShining(!1),e.setFlying(!1),cleverapps.tooltipManager.create(e,{text:"messages:BattlePassWindow.moreStarsToolTip",position:cleverapps.styles.UI.Tooltip.LOCATION.above,swallowTouches:!1,ignoreOnTouchMoved:!0,ignoreOnTouchMovedThreshold:t.ignoreOnTouchMovedThreshold})},getArrowNode:function(){return this.arrow},appearAnimation:function(e){this.level.level===e.level&&(this.rewards.forEach(function(e){this.appearRewardAnimation(e,!1)},this),this.battlePass.hasPremium()&&this.premiumRewards.forEach(function(e){this.appearRewardAnimation(e,!0)},this))},appearRewardAnimation:function(e,t){this.applyAvailableState(e,t),e.runAction(new cc.Sequence(new cc.ScaleTo(.2,1.2),new cc.ScaleTo(.2,1)))},showFinger:function(e,t){var n,s=this.battlePass;if((this.fingerAction&&(this.stopAction(this.fingerAction),delete this.fingerAction),t)&&(s.hasPremium()&&this.calcRewardsState(e,!0).available?n=this.premiumRewards[0]:this.calcRewardsState(e,!1).available&&(n=this.rewards[0]),n)
)return this.fingerAction=this.runAction(new cc.Sequence(new cc.DelayTime(2),new cc.CallFunc(function(){this.fingerAction=this.runAction(new cc.RepeatForever(new cc.Sequence(new cc.CallFunc(FingerView.showFingerOnce.bind(null,n)),new cc.DelayTime(2.5))))},this))),!0}});cleverapps.styles.BattlePassTasks={width:220,height:500,rewards:{x:{align:"center",dx:0},y:{align:"bottom",dy:305}},premiumRewards:{x:{align:"center",dx:0},y:{align:"bottom",dy:0}},arrows:{x:{align:"center",dx:0},y:{align:"center",dy:-5}},ignoreOnTouchMovedThreshold:10};var BattlePassProgress=cc.Node.extend({ctor:function(t){this._super(),this.battlePass=t;var e=cleverapps.styles.BattlePassProgress;this.setContentSize2(e.width,e.height);var n=this.tasks=BattlePass.getLevels().map(function(e){return new BattlePassTask(e,t)}),s=new cleverapps.Layout(n,{direction:cleverapps.UI.HORIZONTAL,padding:e.padding}),i=this.progressBar=new ScaledProgressBar({progress:bundles.battle_pass.frames.progress_bar,
background:bundles.battle_pass.frames.progress_substrate,padding:e.progressBar.padding});i.setDimension(s.width-2*e.padding.x+e.progressBar.padding.left+e.progressBar.padding.right-s.children[0].width/2,e.progressBar.height),i.setAnchorPoint2(0,.5),i.setPositionRound(e.progressBar),i.setLocalZOrder(-1),i.setMinProgressWidth(e.progressBar.minWidth),s.addChild(i);var o=this.createProgressAmount();if(o.setAnchorPoint2(),s.addChild(o),"merge"===cleverapps.config.type)o.setPositionRound(e.amount);else{var r=this.calcProgressPercentage(this.battlePass.getLastShownTask()),a=e.amount.offsetX,c=Math.min(Math.max(s.width*r/100,o.width/2+a),s.width-o.width/2-a);o.setPositionRound(c,e.amount.y)}this.addLine(e.line.height,e.line.first),this.addLine(e.line.height,e.line.second);var l=this.progressScroll=new cleverapps.UI.ScrollView(s,{childrenVisibility:cleverapps.UI.ScrollView.CHILDREN_VISIBILITY_NONE,direction:cleverapps.UI.ScrollView.DIR_HORIZONTAL,scrollBarEnabled:!1});l.setContentSize2(
this.width,this.height),l.scrollToDefault(),l.setAnchorPoint2(),l.setPositionRound(e.scroll),this.addChild(l)},addLine:function(e,t){var n=cleverapps.UI.createScale9Sprite(bundles.battle_pass.frames.progress_lines);n.setAnchorPoint2(),n.setPositionRound(t),n.setContentSize2(this.width,e),n.setLocalZOrder(-1),this.addChild(n)},createProgressAmount:function(){var e=cleverapps.styles.BattlePassProgress.amount,t=new cc.Node;t.setAnchorPoint2();var n=cleverapps.UI.generateOnlyText("messages:BattlePassWindow.progress",cleverapps.styles.FONTS.BATTLEPASS_PROGRESS_TEXT);n.setAnchorPoint2(1,.5),n.setPositionRound(e.text),t.addChild(n);var s=new cc.Sprite(bundles.battle_pass.frames.progress_star);s.setAnchorPoint2(),s.setPositionRound(e.star),t.addChild(s);var i=this.progressAmount=cleverapps.UI.generateImageText("0/0",cleverapps.styles.FONTS.BATTLEPASS_PROGRESS_IMAGE_TEXT);return i.setAnchorPoint2(0,.5),i.setPositionRound(e.value),t.addChild(i),cleverapps.UI.wrap(t),t},
calcProgressPercentage:function(e){var t=BattlePass.getLevels().length,n=.5/t,s=(1-n)/(t-1);return 0===e.level?e.progress/e.goal*n*100:e.level>=t?100:100*(n+s*(e.level-1)+s*e.progress/e.goal)},updateState:function(){var e=this.battlePass,t=e.getLastShownTask(),n=e.tasksCompleted()?e.createFinishedTask():e.getCurrentTask();this.progressBar.setPercentage(this.calcProgressPercentage(t)),this.progressAmount.runAction(new BattlePassProgress.ProgressFromTo(0,t,t)),this.tasks.forEach(function(e){e.updateState(t)});var s=this.tasks[this.tasks.length-1],i=this.tasks[Math.max(0,t.level-3)],o=this.progressScroll;o.scrollTo(s);var r=[];r.push(new cc.DelayTime(.4)),o.isNodeVisible(i)||(r.push(new cc.CallFunc(o.scrollToMakeNodeVisible.bind(o,i,.8,void 0,{easing:cc.easeBackInOut()}))),r.push(new cc.DelayTime(.6))),t.level<n.level||t.progress<n.progress?r.push(new cc.CallFunc(this.updateProgress.bind(this,t,n))):r.push(new cc.CallFunc(this.afterProgressUpdated.bind(this,n))),this.runAction(
new cc.Sequence(r))},updateProgress:function(e,t){var n=this.battlePass,s=this.progressBar,i=this.progressAmount,o=t;if(e.level<t.level&&(o=n.createTask({level:e.level,progress:e.goal})),n.updateLastShownTask(o),s.runAction(new ScaledProgressBar.ProgressTo(.8,this.calcProgressPercentage(o)).easing(cc.easeCubicActionOut())),i.runAction(new BattlePassProgress.ProgressFromTo(.8,e,o)),o.progress===o.goal&&(i.runAction(new cc.Sequence(new cc.DelayTime(.8),new cc.ScaleTo(.2,1.2),new cc.ScaleTo(.2,1))),this.runAction(new cc.Sequence(new cc.DelayTime(1),new cc.CallFunc(function(){this.tasks.forEach(function(e){e.appearAnimation(o)}),"merge"===cleverapps.config.type&&Game.currentGame.addReward("energy",BattlePass.getLevels()[o.level].energy,this.tasks[o.level].getArrowNode(),{beginScale:.8,withoutDelta:!0})}.bind(this)))),o.level<n.getMaxLevel()))return e=n.createTask({level:o.level+1}),n.updateLastShownTask(e),void this.runAction(new cc.Sequence(new cc.DelayTime(.8+.4),new cc.CallFunc(
this.updateProgress.bind(this,e,t))));this.afterProgressUpdated(t)},afterProgressUpdated:function(e){for(var t=!0,n=this.tasks.length-1;0<=n;--n){this.tasks[n].showFinger(e,t)&&(t=!1)}}});BattlePassProgress.ProgressFromTo=cc.ProgressFromTo.extend({update:function(e){if(this.target instanceof cleverapps.UI.ImageFont){e=this._computeEaseTime(e);var t=this._from,n=this._to,s=Math.round(t.progress+(n.progress-t.progress)*e),i=Math.round(t.goal+(n.goal-t.goal)*e);this.target.setString(s+" / "+i)}}}),cleverapps.styles.BattlePassProgress={width:1750,height:700,padding:{x:40,y:0},scroll:{x:{align:"center",dx:0},y:{align:"center",dy:0}},progressBar:{x:{align:"left",dx:30},y:{align:"center",dy:-6},height:108,minWidth:49,padding:{top:31,bottom:29,left:28,right:28}},amount:{x:{align:"center",dx:0},y:{align:"center",dy:-6},text:{x:-40,y:-3},star:{x:0,y:0},value:{x:40,y:0}},line:{first:{x:{align:"center",dx:35},y:{align:"center",dy:103}},second:{x:{align:"center",dx:35},y:{align:"center",dy:-201}},
height:90}};var BattlePassWindow=Window.extend({onWindowLoaded:function(e){this.mission=e;var t=cleverapps.styles.BattlePassWindow;this._super({name:"battlepasswindow",title:"match3"===cleverapps.config.type&&"messages:BattlePassWindow.title",content:this.createContent(),closeButton:!0,adjustToContent:"merge"===cleverapps.config.type,contentOffsetY:t.contentOffsetY,extraWidth:t.extraWidth,extraHeight:t.extraHeight,foreground:bundles.windows.frames.window_foreground_png}),cleverapps.metha.showControlsWhileFocused(BattlePassWindow.CONTROLS)},onShow:function(){var e=this.mission;e.logic.setDisplayed(),this.progress.updateState(),this.buyTicketButton&&(e.isRunning()||e.battlePass.anyRewardsLeft()||this.buyTicketButton.disable())},onClose:function(){var e=this.mission,t=e.battlePass;t.hasLastChance()?new BattlePassLastChanceWindow(e):t.updateState()},createContent:function(){var e=cleverapps.styles.BattlePassWindow,t=this.content=new cc.Node;if(t.setAnchorPoint2(),t.setContentSize2(e),
"riddles"===cleverapps.config.name){var n=cleverapps.UI.createScale9Sprite(bundles.battle_pass.frames.window_foreground_png,cleverapps.UI.Scale9Rect.TwoPixelXY);n.setContentSize2(e.foreground),t.addChild(n),n.setLocalZOrder(1),n.setPositionRound(e.foreground)}var s=cleverapps.UI.createScale9Sprite(bundles.battle_pass.frames.progress_gradient);s.setAnchorPoint2(),s.setPositionRound(e.gradient),s.setContentSize2(e.gradient),t.addChild(s);var i=this.createTimer();i.setAnchorPoint2(),i.setPositionRound(e.timer),t.addChild(i);var o=this.createDescription();o.setAnchorPoint2(),o.setPositionRound(e.description),t.addChild(o);var r=this.ticket=this.createTicket();r.setAnchorPoint2(),r.setPositionRound(e.ticket),t.addChild(r);var a=this.progress=new BattlePassProgress(this.mission.battlePass);return a.setAnchorPoint2(),a.setPositionRound(e.progress),t.addChild(a),t},createTimer:function(){var e,t=cleverapps.styles.BattlePassWindow.timer,n=this.mission;if(n.getTimeLeft()){
e=cleverapps.UI.generateOnlyText("messages:BattlePassWindow.timer",cleverapps.styles.FONTS.BATTLEPASS_TITLE_TEXT);var s=new cc.Scale9Sprite(bundles.battle_pass.frames.timer_substrate);s.setAnchorPoint2(),s.setContentSize2(t);var i=new cleverapps.CountDownView(new cleverapps.CountDown(n.getTimeLeft(),{onFinish:this.close.bind(this)}),{font:cleverapps.styles.FONTS.BATTLEPASS_TIMER_TEXT});i.setAnchorPoint2(),i.setPositionRound(t.countdown),i.fitTo(t.countdown.width,0),s.addChild(i);var o=new cc.Sprite(bundles.battle_pass.frames.timer_icon);o.setAnchorPoint2(),o.setPositionRound(t.icon),o.setScale(t.icon.scale),s.addChild(o)}else e=cleverapps.UI.generateOnlyText("messages:BattlePassWindow.finished",cleverapps.styles.FONTS.BATTLEPASS_TITLE_TEXT);return new cleverapps.Layout([e,s],{direction:cleverapps.UI.HORIZONTAL,margin:t.margin})},createTicket:function(){var e=cleverapps.styles.BattlePassWindow.ticket,t=cleverapps.UI.createScale9Sprite(bundles.battle_pass.frames.ticket_background,
cleverapps.UI.Scale9Rect.TwoPixelXY);if(t.setContentSize2(e.width,t.height),this.mission.battlePass.hasPremium()){(s=cleverapps.UI.generateOnlyText("messages:BattlePassWindow.ticket.hint.active",cleverapps.styles.FONTS.BATTLEPASS_TICKET_TEXT)).fitTo(e.text.width),(i=new cleverapps.Spine(bundles.battle_pass.jsons.ticket_json)).setAnimation(0,"animation",!0);var n=new cleverapps.Layout([s,i],{direction:cleverapps.UI.HORIZONTAL,margin:e.active.margin});n.setPositionRound(e.active),t.addChild(n)}else{var s,i;(s=cleverapps.UI.generateOnlyText("messages:BattlePassWindow.ticket.hint",cleverapps.styles.FONTS.BATTLEPASS_TICKET_SMALL_TEXT)).setAnchorPoint2(1,.5),s.setPositionRound(e.text),s.fitTo(e.text.width),t.addChild(s),(i=new cleverapps.Spine(bundles.battle_pass.jsons.ticket_json)).setAnimation(0,"animation",!0),i.setAnchorPoint2(),i.setPositionRound(e.icon),t.addChild(i);var o=cleverapps.UI.Button.Images.button_blue;"riddles"===cleverapps.config.name&&(
o=cleverapps.UI.Button.Images.small_button_green);var r=this.buyTicketButton=new UseGoldButton({button_images:o,price:BattlePassWindow.TICKET.price,onClicked:this.buyTicket.bind(this),font:cleverapps.styles.FONTS.BATTLEPASS_BUTTON_TEXT,image:bundles.reward_icons.frames.gold_medium_png||bundles.reward_icons.frames.gold_small_png,eventName:"battle_pass_ruby"},e.button);r.setAnchorPoint2(),r.setPositionRound(e.button),t.addChild(r)}return t},createDescription:function(){var e=cleverapps.styles.BattlePassWindow.description,t=cleverapps.UI.createScale9Sprite(bundles.battle_pass.frames.description_background,cleverapps.UI.Scale9Rect.TwoPixelXY);t.setContentSize2(e);var n=new cc.Sprite(bundles.battle_pass.frames.build_task_icon);n.setAnchorPoint2(),n.setPositionRound(e.icon),t.addChild(n);var s=new cc.Sprite(bundles.battle_pass.frames.shining);s.setAnchorPoint2(),s.setPositionRound(e.shining),s.setScale(e.shining.scale),s.setLocalZOrder(-1),n.addChild(s);var i=cleverapps.UI.generateOnlyText(
"messages:BattlePassWindow.description",cleverapps.styles.FONTS.BATTLEPASS_DESCRIPTION_TEXT);i.setAnchorPoint2(),i.setPositionRound(e.text),i.setDimensions(e.text.width,0),i.fitToHeight(e.text.height),i.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER),t.addChild(i);var o=new cleverapps.UI.Button({button_png:bundles.battle_pass.frames.guide_button_png,button_on_png:bundles.battle_pass.frames.guide_button_on_png,onClicked:function(){new BattlePassRulesWindow}});return o.setAnchorPoint2(),o.setPositionRound(e.button),t.addChild(o),t},listBundles:function(){return["battle_pass"]},buyTicket:function(){this.mission.battlePass.setPremium(),new RewardWindow({reward:{battlePass:!0}}),this.ticket.removeFromParent(),this.ticket=this.createTicket(),this.ticket.setAnchorPoint2(),this.ticket.setPositionRound(cleverapps.styles.BattlePassWindow.ticket),this.content.addChild(this.ticket)}});BattlePassWindow.TICKET={price:750},BattlePassWindow.CONTROLS=["MenuBarGoldItem","MenuBarLivesItem"],
cleverapps.overrideFonts(cleverapps.styles.FONTS,{BATTLEPASS_TITLE_TEXT:{size:50,color:cleverapps.styles.COLORS.COLOR_WINDOW_TEXT},BATTLEPASS_TIMER_TEXT:{size:45,color:cleverapps.styles.COLORS.WHITE},BATTLEPASS_PROGRESS_TEXT:{size:38,color:cleverapps.styles.COLORS.WHITE},BATTLEPASS_PROGRESS_IMAGE_TEXT:{size:42,color:cleverapps.styles.COLORS.WHITE},BATTLEPASS_TICKET_TEXT:{size:45,color:cleverapps.styles.COLORS.COLOR_WINDOW_TEXT},BATTLEPASS_TICKET_SMALL_TEXT:{size:30,color:cleverapps.styles.COLORS.COLOR_WINDOW_TEXT},BATTLEPASS_BUTTON_TEXT:{size:60,color:cleverapps.styles.COLORS.WHITE},BATTLEPASS_DESCRIPTION_TEXT:{size:50,color:cleverapps.styles.COLORS.COLOR_WINDOW_TEXT}}),cleverapps.styles.BattlePassWindow={width:1800,height:1070,timer:{x:{align:"center",dx:0},y:{align:"top",dy:-50},width:250,height:66,margin:40,countdown:{x:{align:"center",dx:17},y:{align:"center",dy:0},width:180},icon:{x:{align:"left",dx:-35},y:{align:"center",dy:0},scale:.6}},gradient:{x:{align:"center",dx:0},y:{
align:"top",dy:-65},width:1750,height:650},progress:{x:{align:"center",dx:0},y:{align:"top",dy:-35}},ticket:{x:{align:"center",dx:0},y:{align:"top",dy:-605},width:1752,active:{margin:20,x:{align:"center"},y:{align:"center",dy:-36}},text:{x:{align:"right",dx:-545},y:{align:"center",dy:-37},width:1100},icon:{x:{align:"right",dx:-355},y:{align:"center",dy:-30}},button:{x:{align:"right",dx:-60},y:{align:"center",dy:-34},width:280,height:105}},description:{x:{align:"center",dx:0},y:{align:"top",dy:-775},height:235,width:1650,icon:{x:{align:"left",dx:65},y:{align:"center",dy:0}},shining:{x:{align:"center",dx:0},y:{align:"center",dy:0},scale:1.1},text:{x:{align:"center",dx:55},y:{align:"center",dy:0},width:1100,height:120},button:{x:{align:"right",dx:-45},y:{align:"center",dy:0},width:280,height:105}}};var BattlePassLastChanceWindow=Window.extend({onWindowLoaded:function(e,t){this.mission=e,this.closeCallback=t,this.price=this.calcPrice(),e.battlePass.useLastChance(),this._super({
name:"battlepasslastchancewindow",title:"messages:BattlePassLastChanceWindow.title",content:this.createContent(),buttons:this.createButtons(),closeButton:!0})},onClose:function(){this.mission.battlePass.updateState()},createContent:function(){var e=cleverapps.styles.BattlePassLastChanceWindow,t=cleverapps.UI.generateOnlyText("messages:BattlePassLastChanceWindow.upperText",cleverapps.styles.FONTS.DARK_TEXT);t.setAnchorPoint2(),t.setDimensions(e.texts.width,0),t.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER);var n=this.createRewards();n.setScale(1.3);var s=cleverapps.UI.generateOnlyText("messages:BattlePassLastChanceWindow.lowerText",cleverapps.styles.FONTS.DARK_TEXT);s.setAnchorPoint2(),s.setDimensions(e.texts.width,0),s.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER);var i=new cleverapps.Layout([s,n,t],{direction:cleverapps.UI.VERTICAL,margin:e.margin,padding:e.padding}),o=this.createOfferBadge();return o.setAnchorPoint2(),o.setPositionRound(e.offerBadge),i.addChild(o),i},
createRewards:function(){var e=cleverapps.styles.BattlePassLastChanceWindow.rewards,t=this.mission.battlePass,n=BattlePass.getLevels()[t.getCurrentTask().level],s=BattlePassRewardIcon.createIconsFromRewardsList(n.reward).map(function(e){return this.createReward(e,!1)},this);return t.hasPremium()&&s.push.apply(s,BattlePassRewardIcon.createIconsFromRewardsList(n.premiumReward).map(function(e){return this.createReward(e,!0)},this)),new cleverapps.Layout(s,{direction:cleverapps.UI.HORIZONTAL,margin:e.margin})},createOfferBadge:function(){var e=cleverapps.styles.BattlePassLastChanceWindow.offerBadge,t=new cc.Sprite(bundles.battle_pass.frames.offer_badge);t.setRotation(e.rotation);var n=Messages.get("BattlePassLastChanceWindow.badgeText").replace(/ /g,"\n"),s=cleverapps.UI.generateOnlyText(n,cleverapps.styles.FONTS.LIGHT_TEXT);return s.setPositionRound(e.text),s.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER),s.fitTo(e.text.width,e.text.height),s.setLineHeight(Math.floor(1.1*s.getFontSize()
)),t.addChild(s),t},createButtons:function(){var e=cleverapps.styles.BattlePassLastChanceWindow.buttons;return[new UseGoldButton({button_images:cleverapps.UI.Button.Images.button_blue,price:this.price,onClicked:this.buyReward.bind(this),font:cleverapps.styles.FONTS.BATTLEPASS_BUTTON_TEXT,image:bundles.reward_icons.frames.gold_small_png,eventName:"battle_pass_last_chance_ruby"},e)]},createReward:function(e,t){var n=cleverapps.styles.BattlePassLastChanceWindow.rewards,s=cleverapps.UI.createScale9Sprite(bundles.battle_pass.frames.icon_background);if(s.setAnchorPoint2(),s.setContentSize2(n.background),e.setAnchorPoint2(),e.setPositionRound(n.icon),s.addChild(e),t){var i=new cc.Sprite(bundles.battle_pass.frames.icon_ribbon);i.setAnchorPoint2(),i.setPositionRound(n.ribbon),s.addChild(i);var o=Messages.get("BattlePassRewardIcon.ribbonText").replace(/ /g,"\n"),r=cleverapps.UI.generateOnlyText(o,cleverapps.styles.FONTS.LIGHT_TEXT);r.setPositionRound(n.text),r.setHorizontalAlignment(
cc.TEXT_ALIGNMENT_CENTER),r.fitTo(n.text.width,n.text.height),r.setLineHeight(Math.floor(1.2*r.getFontSize())),r.setRotation(n.text.rotation),i.addChild(r);var a=new cleverapps.Spine(bundles.battle_pass.jsons.ticket_json);a.setAnimation(0,"animation",!0),a.clearTrack(0),a.setAnchorPoint2(),a.setPositionRound(n.ticket),s.addChild(a)}return s},calcPrice:function(){return 100},buyReward:function(){var e=this.mission,t=e.battlePass.getCurrentTask(),n=BattlePass.getLevels()[t.level];e.logic.processEvent(n.task.type,{amount:t.goal-t.progress,lastChance:!0}),this.close(),new BattlePassWindow(e)},listBundles:function(){return["battle_pass"]}});cleverapps.styles.BattlePassLastChanceWindow={margin:40,padding:{x:20,top:30,bottom:100},texts:{width:800},buttons:{width:300,height:110},offerBadge:{x:{align:"right",dx:105},y:{align:"bottom",dy:-155},rotation:15,text:{x:{align:"center",dx:0},y:{align:"center",dy:-8},width:160,height:160}},rewards:{margin:30,background:{width:320,height:320},icon:{x:{
align:"center",dx:0},y:{align:"center",dy:10}},ribbon:{x:{align:"left",dx:1},y:{align:"top",dy:4}},text:{x:{align:"center",dx:-24},y:{align:"center",dy:24},width:104,height:74,rotation:-45},ticket:{x:{align:"right",dx:79},y:{align:"bottom",dy:-70}}}};var Race=function(e){((this.mission=e).race=this).load(e.details),this.onPremBuy=function(){},this.onBreakFinishLine=function(){},this.isFinished()&&e.complete()};Race.prototype.complete=function(){this.completeShown=!0},Race.prototype.processBots=function(){var e=this.mission.getResults(),s={};if(e.forEach(function(e){for(var t in this.players)if(this.players[t].botId===e.id){var n=e.amount-this.players[t].currentStage();0<n&&(this.players[t].addProgress(n,!0),s[t]=n)}},this),cleverapps.config.debugMode)if(console.log("# Race update",(new Date).toTimeString()),Object.keys(s).length)for(var t in s)console.log("bot "+t+" gained "+s[t]);else console.log("no bots updated");0<Object.keys(s).length&&this.save()},Race.prototype.save=function(){
var e=this.getPlayer().currentStage()-this.mission.result;this.mission.isRunning()&&this.mission.update(e,this.getInfo())},Race.prototype.getInfo=function(){var e={};for(var t in this.players)e[t]=this.players[t].getInfo();return{players:e,nextEmptyPlace:this.nextEmptyPlace,boughtPremium:this.boughtPremium,receivedRewards:this.receivedRewards}},Race.prototype.load=function(e){this.boughtPremium=e.boughtPremium||!1,this.nextEmptyPlace=e.nextEmptyPlace||0,this.receivedRewards=e.receivedRewards||[],this.createPlayers(e&&e.players),e.players||setTimeout(function(){this.save()}.bind(this),0)},Race.prototype.setPremium=function(){this.boughtPremium=!0,this.justBoughtPrem=!0,this.save(),this.onPremBuy()},Race.prototype.isRewardReceived=function(e){return-1!==this.receivedRewards.indexOf(e)},Race.prototype.getActiveRewards=function(e){e=void 0===e?this.getPlayer().shownStage:e;var t=[];for(var n in Race.REWARDS){var s=Race.REWARDS[n];if(s.stage>e)break;this.isRewardReceived(s.stage
)||s.premium&&!this.boughtPremium||t.push(s)}return t},Race.prototype.collectRewards=function(e){var t={};return e.forEach(function(e){Product.AddUpRewards({gold:e.gold},t),this.receivedRewards.push(e.stage),cleverapps.eventLogger.logEvent(cleverapps.EVENTS.RACE_FREE_REWARD+"_"+e.stage)},this),0<Object.keys(t).length?(this.save(),t):void 0},Race.prototype.getFinishReward=function(){switch(this.getPlayer().place){case 0:return{gold:500};case 1:return{gold:300};case 2:return{gold:100};default:return}},Race.prototype.getRacers=function(){return this.players},Race.prototype.getPlayer=function(){return this.players[Race.PLAYER_ID]},Race.prototype.addRacerProgress=function(e,t){e=void 0===e?Race.PLAYER_ID:e,t=t||1,this.players[e].addProgress(t),this.isFinished()&&this.mission.complete()},Race.prototype.createPlayers=function(e){for(var t in e=e||this.generatePlayersData(),this.players={},e)this.players[t]=new BalloonRacer(this,e[t],parseInt(t)===Race.PLAYER_ID)},
Race.prototype.generatePlayersData=function(){for(var e={},t=["blue","violet","red","green"],n=this.getBotsData(),s=0;s<Race.PLAYERS_NUMB;s++){var i=void 0,o="player",r={avatar:cleverapps.friends.getPlayer().avatar,id:levels.user.id};if(s!==Race.PLAYER_ID){o=cleverapps.Random.choose(t),t.splice(t.indexOf(o),1);var a=n[0];n.splice(0,1),i=a.id,r=a.avatar.avatar}e[s]={stage:0,skin:o,botId:i,avatarData:r}}return e},Race.prototype.getBotsData=function(){for(var e=this.mission.getResults(),t=[];t.length<Race.PLAYERS_NUMB-1;){var n=cleverapps.Random.choose(e);n.player||-1!==t.indexOf(n)||t.push(n)}return t},Race.prototype.isFinished=function(){return this.getPlayer().currentStage()>=Race.STAGES},Race.prototype.balloonsOnFinish=function(){var e=0;for(var t in this.players)this.players[t].shownStage>=Race.STAGES&&e++;return e},Race.prototype.stageHasReward=function(t){var e=Race.REWARDS.filter(function(e){return e.stage===t})[0];return e&&(!e.premium||this.boughtPremium)},
Race.prototype.justStarted=function(){return 0===this.getPlayer().shownStage&&!this.boughtPremium&&!this.startWasShown},Race.prototype.showedStart=function(){this.startWasShown=!0},Race.prototype.transforedPrem=function(){delete this.justBoughtPrem},Race.prototype.getPremDialogue=function(){for(var e in Race.DIALOGUES_DATA){var t=Race.DIALOGUES_DATA[e];if(t.premium)return this.prepareDialogue(t)}},Race.prototype.getStageDialogue=function(e){for(var t in Race.DIALOGUES_DATA){var n=Race.DIALOGUES_DATA[t];if(n.stage===e){if(!n.noPremium)return n;if(!this.boughtPremium)return n}}},Race.prototype.getActiveDialogue=function(e){var t=this.getStageDialogue(e);if(t)return this.prepareDialogue(t)},Race.prototype.prepareDialogue=function(e){return{dialogue:e.data.map(function(e){return{text:Messages.get(e.text),person:e.person}})}},Race.prototype.calcPlayerStepDelta=function(){var e=this.getPlayer();if(0===e.getStagesDelta())return 0;for(var t=e.shownStage;t<e.currentStage()&&(t++,
!this.getStageDialogue(t)&&!this.stageHasReward(t)););return t-e.shownStage},Race.prototype.getCurrentPlayerPlace=function(){if(void 0!==this.getPlayer().place)return this.getPlayer().place;var e=cleverapps.values(this.players);return e.sort(function(e,t){return t.currentStage()-e.currentStage()}),e.indexOf(this.getPlayer())},Race.PLAYER_ID=2,Race.PLAYERS_NUMB=5,Race.STAGES=50,Race.PREM_BOOST=.1;var BalloonRacer=function(e,t,n){this.isPlayer=n,this.race=e,this.stage=t.stage,this.place=t.place,this.botId=t.botId,this.avatarData=t.avatarData,this.skin=t.skin,n&&e.boughtPremium&&(this.skin="zeppelin"),this.setShownStage(this.currentStage()),this.onSkinChange=function(){}};BalloonRacer.prototype.addProgress=function(e,t){if(this.stage<Race.STAGES){this.isPlayer&&(cleverapps.playSession.inc(cleverapps.EVENTS[this.race.boughtPremium?"RACE_LEVELS_PASSED_PREM":"RACE_LEVELS_PASSED"],1),this.race.boughtPremium&&(e+=e*Race.PREM_BOOST));var n=Math.round(10*(this.stage+e))/10;this.stage=Math.min(n,
Race.STAGES),this.calcFinishPlace(),t||this.race.save()}},BalloonRacer.prototype.getInfo=function(){return{stage:this.stage,skin:this.skin,place:this.place,botId:this.botId,avatarData:this.avatarData}},BalloonRacer.prototype.getStagesDelta=function(){return this.currentStage()-this.shownStage},BalloonRacer.prototype.setPremSkin=function(e){this.skin="zeppelin",this.onSkinChange(e)},BalloonRacer.prototype.setShownStage=function(e){this.shownStage=e},BalloonRacer.prototype.hasFinished=function(){return this.currentStage()>=Race.STAGES},BalloonRacer.prototype.currentStage=function(){return Math.floor(this.stage)},BalloonRacer.prototype.calcFinishPlace=function(){return this.hasFinished()&&void 0===this.place&&(this.place=this.race.nextEmptyPlace,this.race.nextEmptyPlace++,this.race.save(),this.isPlayer&&cleverapps.eventLogger.logEvent(cleverapps.EVENTS.RACE_FINISH_PLACE+"_"+this.place)),this.place};var RaceMissionLogic=function(e){this.mission=e,this.race=new Race(this.mission)}
;RaceMissionLogic.prototype.onChangeResults=function(){this.race.processBots()},RaceMissionLogic.prototype.wantsToActOnFinish=function(){return 7<=this.race.getPlayer().currentStage()&&!this.race.completeShown},RaceMissionLogic.prototype.receiveReward=function(){},RaceMissionLogic.prototype.hasIntent=function(){return this.race.startedPlaying},RaceMissionLogic.prototype.setIntent=function(){this.race.startedPlaying=!0},RaceMissionLogic.prototype.skipNext=function(){return!this.mission.isRunning()},RaceMissionLogic.prototype.willUseIntent=function(e){switch(delete this.race.startedPlaying,cleverapps.Plot.decideNext(e)){case Boatswain.NEXT_INTENT:return!0;case Boatswain.EXIT_INTENT:return!this.mission.isRunning()||!e.isCurrentLevel();default:return!1}},RaceMissionLogic.prototype.processEvent=function(e,t){e===Mission.EVENT_LEVEL_FINISH&&this.race.startedPlaying&&this.race.addRacerProgress()},RaceMissionLogic.IsAvailable=function(){return!!cleverapps.payments.isAvailable()&&-1!==[
"wordsoup"].indexOf(cleverapps.config.name)},cleverapps.styles.RaceDialogues={grandFather:cleverapps.overrideStyles(cleverapps.styles.DialogueView.persons.default,{animation:"animation",position:"right",styles:{json:bundles.race.jsons.gradfather,title:"messages:person1"}},!0),hero:cleverapps.overrideStyles(cleverapps.styles.DialogueView.persons.default,{animation:"talk",styles:{json:bundles.hero.jsons.hero_json,title:"messages:person0"}},!0)},Race.DIALOGUES_DATA=[{premium:!0,data:[{text:"messages:Race.dialogue.prem_stage_9.0",person:cleverapps.styles.RaceDialogues.grandFather},{text:"messages:Race.dialogue.prem_stage_9.1",person:cleverapps.styles.RaceDialogues.hero}]},{stage:0,data:[{text:"messages:Race.dialogue.stage_0.0",person:cleverapps.styles.RaceDialogues.grandFather},{text:"messages:Race.dialogue.stage_0.1",person:cleverapps.styles.RaceDialogues.hero},{text:"messages:Race.dialogue.stage_0.2",person:cleverapps.styles.RaceDialogues.grandFather}]},{stage:7,data:[{
text:"messages:Race.dialogue.stage_7.0",person:cleverapps.styles.RaceDialogues.grandFather},{text:"messages:Race.dialogue.stage_7.1",person:cleverapps.styles.RaceDialogues.hero}]},{stage:9,noPremium:!0,data:[{text:"messages:Race.dialogue.free_stage_9.0",person:cleverapps.styles.RaceDialogues.grandFather},{text:"messages:Race.dialogue.free_stage_9.1",person:cleverapps.styles.RaceDialogues.hero}]},{stage:16,noPremium:!0,data:[{text:"messages:Race.dialogue.free_stage_16.0",person:cleverapps.styles.RaceDialogues.grandFather},{text:"messages:Race.dialogue.free_stage_16.1",person:cleverapps.styles.RaceDialogues.hero}]},{stage:50,data:[{text:"messages:Race.dialogue.stage_50.0",person:cleverapps.styles.RaceDialogues.grandFather},{text:"messages:Race.dialogue.stage_50.1",person:cleverapps.styles.RaceDialogues.hero}]}],Race.REWARDS=[{stage:7,gold:100},{stage:9,gold:500,premium:!0},{stage:13,gold:120},{stage:16,gold:650,premium:!0},{stage:18,gold:145},{stage:23,gold:800,premium:!0},{stage:25,
gold:170},{stage:30,gold:950,premium:!0},{stage:32,gold:200},{stage:37,gold:1200,premium:!0},{stage:39,gold:225},{stage:44,gold:1600,premium:!0},{stage:46,gold:250},{stage:50,gold:1800,premium:!0}];var RaceScene=cleverapps.FixedWidthScene.extend({ctor:function(e){this._super(cleverapps.Environment.SCENE_RACE),this.race=e.race,this.mission=e,this.createScroll(),this.createSideBg(),this.createPlayers(),this.createRewards(),this.addPlayButton(),this.addProductIcon(),this.addFlags(),this.addPodium(),this.addFinishLine(),this.addFanCounter(),this.scrollToBalloon(),this.needProgressShow=!0,this.race.onBreakFinishLine=this.createListener(this.breakFinishLine.bind(this)),this.race.onPremBuy=this.createListener(function(){this.needProgressShow=!0}.bind(this))},getRefreshSceneActionOnChangeSize:function(){return function(e){cleverapps.scenes.replaceScene(new RaceScene(this.mission),e)}.bind(this)},addFanCounter:function(){var e=this.fanCounter=new RaceFunView(this.race);this.scene.addChild(e),
e.setPositionRound(cleverapps.styles.RaceScene.fanCounter),cleverapps.UI.makeHideable(e,cleverapps.UI.VERTICAL),cleverapps.metha.registerControl("fan_counter",e)},createScroll:function(){var e=new cc.Node;e.setAnchorPoint2(),e.setContentSize2(this.width,cleverapps.styles.RaceScene.scroll.totalHeight);var t=new cleverapps.Spine(bundles.race.jsons.bg);t.setAnimation(0,"animation",!0),t.setPositionRound(e.width/2,e.height/2),e.addChild(t);var n=this.scroll=new cleverapps.UI.ScrollView(e,{scrollBarEnabled:!1});n.setContentSize2(cc.director.getWinSize()),n.setAnchorPoint(0,0),this.scene.addChild(n),n.y-=cleverapps.UI.getSceneOffsetY()},createSideBg:function(){var e=function(){var e=new cc.Node;e.setAnchorPoint2(),e.setContentSize2(cleverapps.styles.RaceScene.scroll.sideBgWidth[cleverapps.wideMode.mode]*resolutionScale,this.scroll.innerHeight),this.scroll.addChild(e,1);var t=e.animation=new cleverapps.Spine(bundles.race.jsons.trees);return t.setPosition(e.width/2,e.height/2),e.addChild(t),e
}.bind(this),t=cleverapps.wideMode.mode===cleverapps.WideMode.VERTICAL?"mobile_":"web_",n=e();n.animation.setAnimation(0,t+"left",!0),n.setPosition(n.width/2,this.scroll.innerHeight/2);var s=e();s.animation.setAnimation(0,t+"right",!0),s.setPosition(this.scroll.width-n.width/2,this.scroll.innerHeight/2)},createRewards:function(){var e={width:this.scroll.width,height:this.scroll.innerHeight+cleverapps.styles.RaceScene.activeZone.yPadding};this.rewards=new RaceRewardsNode(this.race,e),this.rewards.setPositionRound(this.scroll.innerWidth/2,this.scroll.innerHeight/2),this.scroll.addChild(this.rewards,2)},createPlayers:function(){var e=cleverapps.styles.RaceScene.activeZone,t={width:Math.max(e.balloonsNode.minWidth,Math.min(e.balloonsNode.maxWidth,.7*this.scroll.width)),height:this.scroll.innerHeight+e.yPadding};this.balloonsNode=new BalloonsNode(this.race,t),this.balloonsNode.setPositionRound(this.scroll.width/2,this.scroll.innerHeight/2),this.scroll.addChild(this.balloonsNode,3)},
addPlayButton:function(){if(this.mission.isRunning()){var e=cleverapps.styles.RaceScene.playButton,t=new cleverapps.UI.Button({width:e.width,height:e.height,text:Messages.get("Play"),onClicked:function(){cleverapps.metha.display({focus:"BalloonsPlayButton",control:["toolbar","sidebar"],action:function(e){this.race.mission.logic.setIntent(),cleverapps.metha.wantsToPlay(e)}.bind(this)})}.bind(this)});this.scene.addChild(t),t.setPositionRound(e),cleverapps.UI.makeHideable(t,cleverapps.UI.VERTICAL),cleverapps.metha.registerControl("race_playButton",t)}},addProductIcon:function(){var e=new cleverapps.Spine(bundles.race.jsons.product_icon);e.setAnimation(0,"animation",!0);var t=new cc.Node;t.setAnchorPoint2(),t.setContentSize2(cleverapps.styles.RaceScene.productIcon),e.setPositionRound(t.width/2,t.height/2),t.addChild(e),this.scene.addChild(t),t.setPositionRound(cleverapps.styles.RaceScene.productIcon),cleverapps.UI.makeHideable(t),cleverapps.UI.applyHover(t),cleverapps.UI.onClick(t,
function(){cleverapps.metha.display({focus:"RacePremWindow",action:function(e){new RaceBuyWindow(this.race),cleverapps.metha.onceNoWindowsListener=e}.bind(this)})}.bind(this)),cleverapps.metha.registerControl("race_productIcon",t)},addFlags:function(){var s=cleverapps.styles.RaceScene.flags;["start_left","start_right","finish_left","finish_right"].forEach(function(e){e=e.split("_");var t=new cleverapps.Spine(bundles.race.jsons.flag);t.setAnimation(0,"animation",!0),t.setSkin(e[0]),t.setScale(s.scale[cleverapps.wideMode.mode]),"left"===e[1]&&t.setScaleX(-t.scaleX),this.scroll.addChild(t,"start"===e[0]?2:1);var n=s["xOffset_"+e[0]][cleverapps.wideMode.mode]*resolutionScale;t.setPosition({x:"left"===e[1]?n:this.scroll.width-n,y:s[e[0]+"Y"]})}.bind(this))},scrollToBalloon:function(e,t){e=void 0!==e?e:0,t=t||this.balloonsNode.balloons[Race.PLAYER_ID],this.scroll.scrollTo(t.y+t.height-this.scroll.height/2,e)},showProgress:function(){this.needProgressShow=!1,this.balloonsNode.moveBots(),
cleverapps.metha.display({focus:"RaceProgress",control:["fan_counter"],actions:[function(e){this.race.justStarted()?this.showStart(e):e()}.bind(this),this.playerProgress.bind(this),function(e){this.mission.isRunning()||this.race.completeShown?e():this.complete(e)}.bind(this)]})},playerProgress:function(e){cleverapps.metha.compound(e,this.createPlayerCycle())},createPlayerCycle:function(e){e=e||[];var t=this.race.calcPlayerStepDelta(),n=this.race.getPlayer();n.setShownStage(n.shownStage+t);var s=n.shownStage;return e=e.concat([function(e){this.playerFlight(e,s,t)}.bind(this),function(e){this.rewards.giveRewards(e,s)}.bind(this),function(e){this.race.justBoughtPrem?this.premTransform(e):this.intermediateDialogue(e,s,t)}.bind(this),function(e){0<t&&16===s?this.suggestPremium(e):e()}.bind(this)]),0<t&&(e=this.createPlayerCycle(e)),e},playerFlight:function(e,t,n){if(0!==n){var s=this.balloonsNode.movePlayerBalloon(e,n,t);this.scroll.scrollTo(s.targetY-this.scroll.height/2,s.time),
this.rewards.animatePremiumChests(t,n),this.fanCounter.updateAmount(n)}else e()},breakFinishLine:function(e){1===this.race.balloonsOnFinish()&&this.runAction(new cc.Sequence(new cc.DelayTime(e),new cc.CallFunc(function(){this.finishLine.setAnimation(0,"finish",!1),this.finishLine.addAnimation(0,"finish_idle",!0)}.bind(this))))},complete:function(e){cleverapps.metha.compound(e,[function(e){this.race.complete(),e()}.bind(this),function(e){new RaceFinishWindow(this.race),cleverapps.metha.onceNoWindowsListener=e}.bind(this),function(e){var t=this.race.getFinishReward();t?(new RewardWindow({reward:t}),cleverapps.metha.onceNoWindowsListener=e):e()}.bind(this),function(e){this.suggestPremium(e)}.bind(this)])},showStart:function(e){cleverapps.metha.compound(e,[function(e){var t=this.race.getActiveDialogue(0);this.showDialogue(t.dialogue,e)}.bind(this),function(e){new RaceStartWindow(this.race),cleverapps.metha.onceNoWindowsListener=e}.bind(this),function(e){this.race.showedStart(),e()}.bind(
this)])},premTransform:function(e){cleverapps.metha.compound(e,[function(e){var t=this.race.getPremDialogue();this.showDialogue(t.dialogue,e)}.bind(this),function(e){this.race.getPlayer().setPremSkin(e)}.bind(this),function(e){this.race.transforedPrem(),e()}.bind(this)])},intermediateDialogue:function(e,t,n){var s=this.race.getActiveDialogue(t);s&&(0<n||this.race.justBoughtPrem)?this.showDialogue(s.dialogue,e):e()},suggestPremium:function(e){this.race.boughtPremium?e():(new RaceBuyWindow(this.race),cleverapps.metha.onceNoWindowsListener=e)},showDialogue:function(e,t){t=t||function(){};var n=new Dialogue(e,{showUp:!0,autoClose:!0});n.on("afterClose",t),new DialogueView(n,{overlay:!0}),n.run()},addFinishLine:function(){var e=cleverapps.styles.RaceScene.finishLine,t=this.finishLine=new cleverapps.Spine(bundles.race.jsons.finish_line);t.setAnimation(0,0<this.race.balloonsOnFinish()?"finish_idle":"idle",!0),t.setScale(e.scale[cleverapps.wideMode.mode]),this.scroll.addChild(t),
t.setPositionRound(this.scroll.width/2,this.scroll.innerHeight+e.yOffset)},addPodium:function(){var n=cleverapps.styles.RaceScene.podium;[new cc.Sprite(bundles.race.frames.first),new cc.Sprite(bundles.race.frames.second),new cc.Sprite(bundles.race.frames.third)].forEach(function(e,t){e.setScale(n.scale[cleverapps.wideMode.mode]),this.scroll.addChild(e),e.setPositionRound({x:this.scroll.width/2+n.xOffset[t]*resolutionScale*e.scale,y:this.scroll.innerHeight+n.yOffset[t]*resolutionScale})},this)},getAudioStyles:function(){return cleverapps.styles.RaceScene.sound}});RaceScene.BUNDLES=["race","dialogues_minimal"],cleverapps.styles.RaceScene={scroll:{totalHeight:5764,sideBgWidth:[70,200,200]},flags:{scale:[.7,1,1],startY:350,finishY:5340,xOffset_start:[60,300,300],xOffset_finish:[60,380,380]},activeZone:{yPadding:-800,balloonsNode:{minWidth:500,maxWidth:1050}},playButton:{width:200,height:110,x:{align:"center"},y:{align:"bottom",dy:100}},productIcon:{width:170,height:170,x:{align:"left",
dx:40},y:{align:"top",dy:-200}},podium:{scale:[.7,1,1],xOffset:[0,-250,250],yOffset:[-250,-300,-300]},finishLine:{scale:[.62,1,1],yOffset:-470},fanCounter:{x:{align:"right",dx:-30},y:{align:"bottom",dy:110}},sound:{res:bundles.race.urls.race_bg_music,delay:.5}};var RaceRewardsNode=cc.Node.extend({ctor:function(e,t){this._super(),this.race=e,this.views={},this.setAnchorPoint2(),this.setContentSize2(t),Race.REWARDS.forEach(function(e){this.createReward(e)},this)},createReward:function(e){var t=e.stage,n=cleverapps.styles.RaceRewardsNode.rewards,s=new cc.Node;s.setAnchorPoint2(),s.setContentSize2(n.width,n[e.premium?"premHeight":"height"]),s.setScale(n.scale[cleverapps.wideMode.mode]),s.baseScale=s.getScale(),s.reward=e,this.addChild(s);var i=n.offsetX[cleverapps.wideMode.mode]*resolutionScale;s.setPositionRound({x:e.premium?i:this.width-i,y:n.baseY+this.height/Race.STAGES*t});var o=s.animation=new cleverapps.Spine(bundles.race.jsons.chest);o.grade=e.premium?"gold_":"free_",
o.setPositionRound(s.width/2,s.height/2),s.addChild(o);var r=o.grade+"idle";r+=this.race.isRewardReceived(t)?"_open":"",o.setAnimation(0,r,!0),this.views[t]=s,this.race.isRewardReceived(t)||(cleverapps.UI.applyHover(s),cleverapps.UI.onClick(s,this.chestPressed.bind(this,e)))},chestPressed:function(t){this.race.isRewardReceived(t.stage)||cleverapps.metha.display({focus:"RaceChestWindow",action:function(e){new RaceChestWindow(t,this.race),cleverapps.metha.onceNoWindowsListener=e}.bind(this)})},setRewardsCollected:function(i,o){i.forEach(function(e,t){var n=e.stage;cleverapps.UI.removeHover(this.views[n]);var s=this.views[n].animation;s.setAnimation(0,s.grade+"unlock",!1),s.runAction(new cc.Sequence(new cc.DelayTime(cleverapps.styles.RaceRewardsNode.delay[s.grade+"sfx"]),new cc.CallFunc(function(){cleverapps.audio.playSound(bundles.race.urls[s.grade+"chest_sfx"])}))),s.setCompleteListener(function(){s.setCompleteListener(function(){}),s.addAnimation(0,s.grade+"idle_open",!0),
t===i.length-1&&o()})},this)},animatePremiumChests:function(e,t){if(!this.race.boughtPremium){var n=e-t,s=function(e){var t=this.views[e].animation;t.setAnimation(0,t.grade+"ready",!1),t.addAnimation(0,t.grade+"idle",!1)};for(var i in this.views)i<=e&&n<i&&this.views[i].reward.premium&&this.views[i].runAction(new cc.Sequence(new cc.DelayTime(Balloon.getFlyTime(i-n)-.1),new cc.CallFunc(s.bind(this,i))))}},giveRewards:function(e,t){var n=this.race.getActiveRewards(t);n.length?cleverapps.metha.compound(e,[function(e){this.setRewardsCollected(n,e)}.bind(this),function(e){new RewardWindow({reward:this.race.collectRewards(n)}),cleverapps.metha.onceNoWindowsListener=e}.bind(this)]):e()}});cleverapps.styles.RaceRewardsNode={delay:{free_sfx:.85,gold_sfx:.515},rewards:{width:150,premHeight:250,height:170,baseY:-120,offsetX:[90,220,220],scale:[.65,1,1]}};var BalloonsNode=cc.Node.extend({ctor:function(e,t){this._super(),this.race=e,this.setAnchorPoint2(),this.setContentSize2(t),
this.createBalloons()},createBalloons:function(){this.balloons={};var e=this.race.getRacers(),t=this.height/Race.STAGES,n=this.width/Object.keys(e).length,s=Math.min(1,this.width/(cleverapps.styles.Balloon.width*Object.keys(e).length));for(var i in e){var o=new Balloon(e[i]);o.setScale(s);var r={x:n/2+n*i,y:t*e[i].shownStage};o.setPositionRound(r),this.addChild(o,1),this.balloons[i]=o}},moveBots:function(){for(var e in this.balloons){var t=this.balloons[e],n=t.player.getStagesDelta();n&&!t.player.isPlayer&&(t.player.setShownStage(t.player.currentStage()),this.moveBalloon(t,n,t.player.currentStage()))}},movePlayerBalloon:function(e,t,n){var s=this.balloons[Race.PLAYER_ID],i=this.moveBalloon(s,t,n);return s.runAction(new cc.Sequence(new cc.DelayTime(i.time),new cc.CallFunc(e))),{time:i.time,targetY:i.target.y+s.height}},moveBalloon:function(e,t,n){var s=Balloon.getFlyTime(t);e.setLocalZOrder(e.getLocalZOrder()+10);var i={x:e.x,y:e.y+this.height/Race.STAGES*t};return e.flyTo(s,i),
n>=Race.STAGES&&this.race.onBreakFinishLine(s),{time:s,target:i}}}),Balloon=cc.Node.extend({ctor:function(e){this._super(),this.player=e;var t=cleverapps.styles.Balloon;this.setAnchorPoint2(),this.setContentSize2(t);var n=this.animation=new cleverapps.Spine(bundles.race.jsons.balloon);n.setSkin(e.skin),n.setPositionRound(this.width/2,this.height/2),this.addChild(n),n.runAction(new cc.Sequence(new cc.DelayTime(.1*cleverapps.Random.random(0,8)),new cc.CallFunc(n.setAnimation.bind(n,0,this.getAnimationName("idle"),!0)))),this.addAvatar(),this.player.onSkinChange=this.createListener(this.transform.bind(this))},addAvatar:function(){var e=cleverapps.styles.Balloon.avatar,t=new cleverapps.UI.Avatar(this.player.avatarData);this.addChild(t),t.setScale(e.scale),t.setPositionRound(e)},flyTo:function(e,t){this.player.isPlayer&&(this.animateFan(),this.playSound()),this.animation.setAnimation(0,this.getAnimationName("fly"),!0),this.runAction(new cc.Sequence(new cc.MoveTo(e,t).easing(cc.easeInOut(2))
,new cc.CallFunc(this.animation.setAnimation.bind(this.animation,0,this.getAnimationName("idle"),!0))))},playSound:function(){cleverapps.audio.playSound(bundles.race.urls.fly_sfx)},animateFan:function(){this.fan||(this.fan=new cleverapps.Spine(bundles.race.jsons.fan),this.addChild(this.fan),this.fan.setPositionRound(this.width/2,cleverapps.styles.Balloon.fan.offsetY*this.scale),this.fan.setCompleteListener(function(){this.fan.setVisible(!1)}.bind(this))),this.fan.setVisible(!0),this.fan.setAnimation(0,"animation3",!1)},transform:function(e){this.player.isPlayer&&(this.animation.setSkin(this.player.skin),this.animation.setAnimation(0,"transition",!1),this.animation.setCompleteListener(function(){this.animation.setCompleteListener(function(){}),this.animation.setAnimation(0,this.getAnimationName("idle"),!0),e()}.bind(this)))},getAnimationName:function(e){return this.player.isPlayer&&this.player.race.boughtPremium?"prem_"+e:e}});Balloon.getFlyTime=function(e){
return Balloon.FLY_EASING_TIME+Balloon.FLYTHROUGH_TIME*e},Balloon.FLYTHROUGH_TIME=.3,Balloon.FLY_EASING_TIME=.4,cleverapps.styles.Balloon={width:160,height:400,fan:{offsetY:-200},avatar:{scale:.7,x:{align:"center"},y:{align:"center",dy:40}}};var RaceFunView=cc.Node.extend({ctor:function(e){this._super(),this.race=e,this.setAnchorPoint2(),this.setContentSize2(cleverapps.styles.RaceFunView),this.addBg(),this.addIcon(),this.addText(),cleverapps.UI.applyHover(this),cleverapps.UI.onClick(this,this.onClick.bind(this))},onClick:function(){cleverapps.metha.display({focus:"RaceRulesWindow",action:function(e){new RulesWindow({name:"ruleswindow",styles:cleverapps.styles.RaceFunView.rulesWindow}),cleverapps.metha.onceNoWindowsListener=e}})},addBg:function(){var e=cleverapps.UI.createScale9Sprite(bundles.menubar.frames.menubar_bg_png);e.setContentSize2(this.getContentSize()),e.setPositionRound(this.width/2,this.height/2),this.addChild(e)},addIcon:function(){var e=new cc.Sprite(
bundles.race.frames.fan_count);this.addChild(e),e.setPositionRound(cleverapps.styles.RaceFunView.icon)},addText:function(){this.counter=cleverapps.UI.generateImageText(this.race.getPlayer().getStagesDelta(),cleverapps.styles.FONTS.MENUBAR_TEXT),this.addChild(this.counter),this.counter.setPositionRound(cleverapps.styles.RaceFunView.counter)},updateAmount:function(t){if(0!==t){var n=parseInt(this.counter.getString()),e=Balloon.getFlyTime(t)/t,s=function(){this.counter.runAction(new cc.Sequence(new cc.DelayTime(e),new cc.CallFunc(function(){t--;var e=Math.max(0,--n);this.counter.setString(e),0<t&&s()}.bind(this))))}.bind(this);s()}}});cleverapps.styles.RaceFunView={width:180,height:90,icon:{x:{align:"left",dx:10},y:{align:"center"}},counter:{x:{align:"center",dx:35},y:{align:"center"}},rulesWindow:{prefix:"messages:Race.rules.",animation:{json:bundles.race.jsons.rules,name:"animation",height:700},subText:{width:220,left:{x:{align:"left",dx:25},y:{align:"right",dy:-250}},right:{x:{
align:"right",dx:-10},y:{align:"right",dy:-250}}}}};var RaceStartWindow=Window.extend({onWindowLoaded:function(e){this.race=e,this.product=Product.Create("raceKey"),this._super({name:"startracewindow",title:"messages:RaceStartWindow.title",content:this.getContent(),styles:cleverapps.overrideStyles(cleverapps.styles.Window,cleverapps.styles.RaceStartWindow.Window,!0)})},getContent:function(){var e=[!1,!0].map(function(e){return this.createCard(e)},this);return new cleverapps.Layout(e,{direction:cleverapps.UI.HORIZONTAL,margin:cleverapps.styles.RaceStartWindow.margin})},createCard:function(e){var t=cleverapps.styles.RaceStartWindow.card,n=e?"prem_":"",s=cleverapps.UI.createScale9Sprite(bundles.race.frames[n+"card_bg"]);s.setContentSize2(t);var i=new cleverapps.Layout([this.createCardButton(e),this.createCardDescription(n),this.createCardTitle(n),this.createCardIcon(n)],{direction:cleverapps.UI.VERTICAL,margin:t.margin});return s.addChild(i),i.setPositionRound(s.width/2,s.height/2),e&&(
this.addBadge(s),this.addPrice(s)),cleverapps.UI.onClick(s,this.onPress.bind(this,e)),cleverapps.UI.applyHover(s),s},createCardIcon:function(e){var t=cleverapps.styles.RaceStartWindow.card.icon,n=new cc.Node;n.setAnchorPoint2(),n.setContentSize2(t);var s=new cleverapps.Spine(bundles.race.jsons.card_icon_json);return s.setAnimation(0,e+"animation",!0),n.addChild(s),s.setPositionRound(n.width/2,n.height/2),n},createCardTitle:function(e){var t=cleverapps.styles.RaceStartWindow.card.title,n=cleverapps.UI.createScale9Sprite(bundles.race.frames[e+"card_title_bg"]);n.setContentSize2(t);var s="messages:RaceStartWindow."+e+"card.title",i=cleverapps.styles.FONTS[e.toUpperCase()+"RACE_CARD_TITLE_TEXT"],o=cleverapps.UI.generateTTFText(s,i);return n.addChild(o),o.setPositionRound(n.width/2,n.height/2),o.fitTo(.9*n.width),n},createCardDescription:function(n){var s=cleverapps.styles.RaceStartWindow.card.description,e=cleverapps.UI.createScale9Sprite(bundles.race.frames.card_text_bg)
;e.setContentSize2(s);var t=[3,2,1].map(function(e){var t=cleverapps.UI.generateTTFText("messages:RaceStartWindow."+n+"card.text"+e,cleverapps.styles.FONTS.RACE_CARD_DESCRIPTION_TEXT);return t.setDimensions(s.textWidth,0),t.setHorizontalAlignment(cc.TEXT_ALIGNMENT_LEFT),t}),i=new cleverapps.Layout(t,{direction:cleverapps.UI.VERTICAL,margin:s.margin});return e.addChild(i),i.setPositionRound(e.width/2,e.height/2),e},createCardButton:function(e){var t=cleverapps.styles.RaceStartWindow.card.button;return new cleverapps.UI.Button({button_png:e?bundles.buttons_main.frames.small_green_button:bundles.buttons_main.frames.small_blue_button,button_on_png:e?bundles.buttons_main.frames.small_green_button_on:bundles.buttons_main.frames.small_blue_button_on,width:t.width,height:t.height,maxWidth:t.maxWidth,padding:t.padding,text:"messages:RaceStartWindow."+(e?"premButton":"freeButton"),onClicked:this.onPress.bind(this,e)})},addBadge:function(e){var t=cleverapps.styles.RaceStartWindow.card.badge,
n=new cc.Sprite(bundles.race.frames.badge),s=Messages.get("RaceBuyWindow.price")+"\n"+this.product.getCurrentPrice(),i=cleverapps.UI.generateTTFText(s,cleverapps.styles.FONTS.TILE_SHOP_BADGE_TEXT);i.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER),i.fitTo(80),n.addChild(i),i.setPositionRound(n.width/2,n.height/2),i.setRotation(t.rotation),e.addChild(n),n.setPositionRound(t)},addPrice:function(e){var t,n=cleverapps.styles.RaceStartWindow.card.price;t=cleverapps.payments.calcLoadedPrice?cleverapps.payments.calcLoadedPrice(this.product.oldPrice):Product.CURRENCY+" "+this.product.oldPrice;var s=cleverapps.UI.generateTTFText("messages:RaceStartWindow.priceText",cleverapps.styles.FONTS.WINDOW_SMALL_TEXT,{price:t});s.fitTo(n.width),e.addChild(s),s.setPositionRound(n)},onPress:function(e){e&&!this.race.boughtPremium?this.product.buy(function(){this.race.setPremium(),cleverapps.eventLogger.logEvent(cleverapps.EVENTS.RACE_BUY_PREM+"_"+this.race.getPlayer().currentStage()),this.runAction(
new cc.CallFunc(function(){this.close()}.bind(this)))}.bind(this)):this.close()}});cleverapps.overrideStyles(cleverapps.styles.DECORATORS,{RACE_PREM_STROKE:{color:new cc.color(124,11,2),size:1},RACE_PREM_SHADOW:{color:new cc.color(124,11,2),direction:cc.size(0,-2),blur:1}}),cleverapps.overrideFonts(cleverapps.styles.FONTS,{RACE_CARD_TITLE_TEXT:{size:45,color:cleverapps.styles.COLORS.WHITE,stroke:{color:new cc.color(32,38,102),size:1},shadow:{color:new cc.color(32,38,102),direction:cc.size(0,-2),blur:1}},PREM_RACE_CARD_TITLE_TEXT:{size:45,color:cleverapps.styles.COLORS.WHITE,stroke:cleverapps.styles.DECORATORS.RACE_PREM_STROKE,shadow:cleverapps.styles.DECORATORS.RACE_PREM_SHADOW},RACE_CARD_DESCRIPTION_TEXT:{size:18,color:cleverapps.styles.COLORS.COLOR_BROWN}}),cleverapps.styles.RaceStartWindow={margin:5,card:{width:325,height:600,margin:8,title:{width:310,height:65},icon:{width:150,height:150},description:{width:285,height:200,textWidth:265,margin:10},button:{width:150,maxWidth:150,
height:75,padding:{x:20}},badge:{rotation:-12,x:{align:"right",dx:20},y:{align:"bottom",dy:-15}},price:{width:135,x:{align:"center",dx:0},y:{align:"bottom",dy:20}}},Window:{contentOffset:-65,Border:{x:35,y:140}}};var RaceBuyWindow=Window.extend({onWindowLoaded:function(e){this.race=e,this._super({title:{text:this.race.boughtPremium||this.race.mission.isRunning()?"messages:RaceBuyWindow.title":"messages:RaceBuyWindow.title2",font:cleverapps.styles.FONTS.RACE_BUY_TITLE_TEXT},name:"racebuywindow",content:this.createContent(),styles:cleverapps.overrideStyles(cleverapps.styles.Window,cleverapps.styles.RaceBuyWindow.Window,!0)}),this.addButton()},createContent:function(){var e=cleverapps.styles.RaceBuyWindow,t=new cc.Node;t.setAnchorPoint2(),t.setContentSize2(e.content);var n=new cleverapps.Spine(bundles.race.jsons.buy_window_json);n.setAnimation(0,"animation",!0),n.setPositionRound(t.width/2,t.height/2),t.addChild(n);var s=this.createText();t.addChild(s),s.setPositionRound(e.text)
;var i=this.createSubTitle();return t.addChild(i),i.setPositionRound(e.subTitle),t},createText:function(){var i=cleverapps.styles.RaceBuyWindow.text,e=[3,2,1].map(function(e){return t=Messages.get("RaceBuyWindow.text"+e),n=new cc.Sprite(bundles.race.frames.small_key),(s=cleverapps.UI.generateTTFText(t,cleverapps.styles.FONTS.RACE_DESCRIPTION_TEXT)).setHorizontalAlignment(cc.TEXT_ALIGNMENT_LEFT),s.setDimensions(i.width,0),new cleverapps.Layout([n,s],{direction:cleverapps.UI.HORIZONTAL,margin:i.margin});var t,n,s});return new cleverapps.Layout(e,{direction:cleverapps.UI.VERTICAL,margin:i.linesMargin})},createSubTitle:function(){var e=cleverapps.styles.RaceBuyWindow.subTitle,t=cleverapps.UI.generateTTFText("messages:RaceBuyWindow.subTitle",cleverapps.styles.FONTS.RACE_SUBTITLE_TEXT),n=new cc.Sprite(bundles.menubar.frames.coin_png);return n.setScale(e.scale),new cleverapps.Layout([t,n],{direction:cleverapps.UI.HORIZONTAL,margin:e.margin})},addButton:function(){
var e=cleverapps.styles.RaceBuyWindow.button,t=Product.Create("raceKey"),n=new cleverapps.UI.Button({button_png:bundles.buttons.frames.green_button_png,button_on_png:bundles.buttons.frames.green_button_on_png,text:Messages.get(this.race.boughtPremium?"OK":"GetIt"),width:e.width,onClicked:this.onPressed.bind(this,t)});if(this.window.addChild(n),n.setPositionRound(e),!this.race.boughtPremium){var s=cleverapps.UI.generateTTFText(Messages.get("RaceBuyWindow.price")+" "+t.getCurrentPrice(),cleverapps.styles.FONTS.RACE_PRICE_TEXT);this.window.addChild(s),s.setPositionRound(n.x,n.y+e.priceOffset)}},onPressed:function(e){this.race.boughtPremium?this.close():e.buy(function(){this.race.setPremium(),cleverapps.eventLogger.logEvent(cleverapps.EVENTS.RACE_BUY_PREM+"_"+this.race.getPlayer().currentStage()),this.runAction(new cc.CallFunc(function(){this.close()}.bind(this)))}.bind(this))}});cleverapps.overrideFonts(cleverapps.styles.FONTS,{RACE_DESCRIPTION_TEXT:{size:17,
color:cleverapps.styles.COLORS.COLOR_BROWN},RACE_SUBTITLE_TEXT:{size:20,color:cleverapps.styles.COLORS.WHITE,stroke:cleverapps.styles.DECORATORS.RACE_PREM_STROKE},RACE_PRICE_TEXT:{size:19,color:cleverapps.styles.COLORS.WHITE},RACE_BUY_TITLE_TEXT:{size:50,color:cleverapps.styles.COLORS.WHITE,stroke:cleverapps.styles.DECORATORS.RACE_PREM_STROKE,shadow:cleverapps.styles.DECORATORS.RACE_PREM_SHADOW}}),cleverapps.styles.RaceBuyWindow={button:{width:190,height:80,priceOffset:-75,x:{align:"center"},y:{align:"bottom",dy:-120}},content:{width:550,height:650},text:{width:250,margin:5,linesMargin:10,x:{align:"center"},y:{align:"center",dy:-188}},subTitle:{width:200,scale:.43,margin:5,x:{align:"center"},y:{align:"center",dy:-60}},Window:{noBackground:!0,Title:{bg:!1,offset:115},maxTitleSize:{scale:.8}}};var RaceChestWindow=Window.extend({onWindowLoaded:function(e,t){this.race=t,this.premium=void 0!==e.premium&&!t.boughtPremium,this.reward=e,this._super({title:"messages:RaceChestWindow.title",
name:"racechestwindow",content:this.getContent(),button:this.getButton()})},getButton:function(){var e=cleverapps.styles.RaceChestWindow.button;return{text:this.premium?Messages.get("RaceChestWindow.button"):Messages.get("OK"),width:e.width,onPressed:function(){this.close(),this.premium&&new RaceBuyWindow(this.race)}.bind(this)}},getContent:function(){var e=new RewardsListComponent(this.reward),t=cleverapps.styles.RaceChestWindow.content,n=this.premium?"messages:RaceChestWindow.textPremium":"messages:RaceChestWindow.text",s=cleverapps.UI.generateTTFText(n,cleverapps.styles.FONTS.WINDOW_TEXT);return s.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER),s.setDimensions(t.textWidth,0),new cleverapps.Layout([s,e],{direction:cleverapps.UI.VERTICAL,margin:t.margin,padding:t.padding})},listBundles:function(){return["tile_shop"]}});cleverapps.styles.RaceChestWindow={content:{margin:10,textWidth:450,padding:{x:0,y:30}},button:{width:150}};var RaceFinishWindow=Window.extend({
onWindowLoaded:function(e){this.race=e,this._super({title:"messages:RaceFinishWindow.title",name:"racefinishwindow",content:this.getContent(),button:this.getButton()}),this.addChild(new Fireworks),cleverapps.audio.playSound(bundles.race.urls.finish_win_sfx)},getContent:function(){var e=cleverapps.styles.RaceFinishWindow,t=this.race.getCurrentPlayerPlace(),n=new cleverapps.Spine(bundles.race.jsons.finish_win);n.setSkin((this.race.boughtPremium?"b":"a")+t),n.setAnimation(0,"start",!1),n.addAnimation(0,"idle",!0);var s=new cc.Node;s.setAnchorPoint2(),s.setContentSize2(e.animation),s.addChild(n),n.setPositionRound(s.width/2,s.height/2);var i=Messages.get(t<3?"RaceFinishWindow.rewarded_text":"RaceFinishWindow.text"),o=cleverapps.UI.generateTTFText(i,cleverapps.styles.FONTS.WINDOW_TEXT);return o.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER),o.setDimensions(e.text.width,0),new cleverapps.Layout([o,s],{direction:cleverapps.UI.VERTICAL,margin:e.margin,padding:e.padding})},getButton:function(
){var e=cleverapps.styles.RaceFinishWindow.button;return{text:Messages.get("OK"),width:e.width,onPressed:function(){this.close()}.bind(this)}}});cleverapps.styles.RaceFinishWindow={margin:15,padding:{x:0,y:20},animation:{width:500,height:400},text:{width:450},button:{width:130}};var RaffleWindow=Window.extend({onWindowLoaded:function(e){this.mission=e,this.mission||(this.teaser=!0),this.createContent(),this._super({content:this.content,title:"messages:RaffleWindow.title",name:"rafflewindow",button:this.createButton(),help:function(){new RaffleRulesWindow}})},createButton:function(){return{width:cleverapps.styles.RaffleWindow.button.width,height:cleverapps.styles.RaffleWindow.button.height,text:Messages.get(this.teaser?"OK":"Play"),onPressed:function(){this.close(),this.teaser||cleverapps.metha.distract({focus:"RafflePlayButtonPressed",action:function(e){cleverapps.metha.wantsToPlay(e)}})}.bind(this)}},createContent:function(){this.content=new cleverapps.Layout([this.createAnnotation(),
this.createTickets(),this.createDescription()],{direction:cleverapps.UI.VERTICAL,margin:cleverapps.styles.RaffleWindow.margin,padding:cleverapps.styles.RaffleWindow.padding})},createDescription:function(){var e=cleverapps.styles.RaffleWindow.description,t=cleverapps.UI.generateTTFText("messages:RaffleWindow.subTitle",cleverapps.styles.FONTS.WINDOW_TEXT);t.setDimensions(e.subTitleWidth,0),t.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER);var n=cleverapps.UI.generateTTFText("messages:RaffleWindow.description",cleverapps.styles.FONTS.WINDOW_SMALL_TEXT);return n.setDimensions(e.descriptionWidth,0),n.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER),new cleverapps.Layout([n,t],{direction:cleverapps.UI.VERTICAL,margin:e.margin})},createTickets:function(){var e=cleverapps.styles.RaffleWindow.tickets,t=new cc.Node;t.setAnchorPoint2(),t.setContentSize2(e.animation);var n=new cleverapps.Spine(bundles.raffle_window.jsons.tickets_json);return n.setAnimation(0,RaffleMissionLogic.getAnimationName(),
!0),t.addChild(n),n.setPositionRound(t.width/2,t.height/2),new cleverapps.Layout([this.teaser?this.createTeaser():this.createBar(),t],{direction:cleverapps.UI.VERTICAL})},createTeaser:function(){var e=cleverapps.styles.RaffleWindow.description,t=cleverapps.UI.generateTTFText("messages:RaffleWindow.teaser",cleverapps.styles.FONTS.WINDOW_TEXT);return t.setDimensions(e.subTitleWidth,0),t.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER),t},createBar:function(){var e=cleverapps.styles.RaffleWindow.tickets.bar,t=cleverapps.UI.createScale9Sprite(bundles.raffle_window.frames.progress_bar_bg);t.setContentSize2(e.width,t.height);var n=new ScaledProgressBar(bundles.raffle_window.frames.progress_bar);n.setPercentage(this.mission.raffle.currentTicketProgress()/RaffleMissionLogic.LVLS_PER_TICKET*100),n.setDimension(t.width,e.height),t.addChild(n),n.setPositionRound(e.offsetX,e.offsetY);var s=this.mission.raffle.currentTicketProgress()+"/"+RaffleMissionLogic.LVLS_PER_TICKET,
i=cleverapps.UI.generateTTFText(s,cleverapps.styles.FONTS.WHITE_TEXT);t.addChild(i),i.setPositionRound(t.width/2,t.height/2+e.countOffset);var o=new cc.Sprite(bundles.raffle_window.frames.tickets);t.addChild(o),o.setPositionRound(e.icon);var r=cleverapps.UI.generateTTFText(this.mission.raffle.currentTickets(),cleverapps.styles.FONTS.SMALL_WHITE_TEXT);return r.fitTo(e.amount.width),o.addChild(r),r.setPositionRound(e.amount),t},createAnnotation:function(){var e=cleverapps.UI.generateTTFText("messages:RaffleWindow.annotation",cleverapps.styles.FONTS.WINDOW_SMALL_TEXT);return e.setDimensions(cleverapps.styles.RaffleWindow.annotationWidth,0),e.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER),e},listBundles:function(){return["raffle_window"]}});cleverapps.styles.RaffleWindow={margin:20,annotationWidth:630,padding:{x:0,y:30},button:{width:190,height:110},description:{subTitleWidth:550,descriptionWidth:630,margin:10},tickets:{animation:{width:350,height:300},bar:{width:500,height:45,offsetX:3,
offsetY:5,countOffset:-3,amount:{width:40,x:{align:"center",dx:27},y:{align:"bottom",dy:11}},icon:{x:{align:"right",dx:35},y:{align:"center",dy:10}}}}};var RaffleRulesWindow=RulesWindow.extend({onWindowLoaded:function(){var e=cleverapps.styles.RaffleRulesWindow;e.animation.name=RaffleMissionLogic.getAnimationName(),this._super({name:"rafflexuleswindow",styles:e})},listBundles:function(){return["raffle_window"]}});cleverapps.styles.RaffleRulesWindow={prefix:"messages:RaffleRulesWindow.",animation:{json:bundles.raffle_window.jsons.tickets_rules_json,height:700},subText:{left:{x:{align:"left",dx:35},y:{align:"top",dy:-265}},bottom:{y:{align:"center",dy:-350}}}};var RaffleMissionLogic=function(e){((this.mission=e).raffle=this).load()};RaffleMissionLogic.prototype.load=function(){this.lvlsPassed=this.mission.details.lvlsPassed,void 0===this.lvlsPassed&&(this.lvlsPassed=0)},RaffleMissionLogic.prototype.addProgress=function(){var e=this.currentTickets();if(this.lvlsPassed++,
e!==this.currentTickets()){var t=cleverapps.eventManager.getFeatureEvent("raffle").options;cleverapps.eventLogger.logEvent(cleverapps.EVENTS.RAFFLE_RESULT_UPDATE,{raffleName:t&&t.raffleName?t.raffleName:"default",userId:cleverapps.user.id,amount:this.currentTickets()})}this.save()},RaffleMissionLogic.prototype.save=function(){this.mission.update(0,{lvlsPassed:this.lvlsPassed})},RaffleMissionLogic.prototype.currentTicketProgress=function(){return this.lvlsPassed%RaffleMissionLogic.LVLS_PER_TICKET},RaffleMissionLogic.prototype.processEvent=function(e,t){e===Mission.EVENT_LEVEL_FINISH&&this.levelRewarded(t.level)&&this.addProgress()},RaffleMissionLogic.prototype.levelRewarded=function(e){return e.isRegular()&&e.isNew()||e.episode.isDailyCup()},RaffleMissionLogic.prototype.needVictoryShow=function(e){return this.levelRewarded(e)&&this.justReceivedTicket()},RaffleMissionLogic.prototype.justReceivedTicket=function(){return 0===this.currentTicketProgress()&&0<this.lvlsPassed},
RaffleMissionLogic.prototype.currentTickets=function(){return Math.floor(this.lvlsPassed/RaffleMissionLogic.LVLS_PER_TICKET)},RaffleMissionLogic.getAnimationName=function(){var e="animation_ok";return-1!==["web_vk","mobile_vk"].indexOf(cleverapps.User.calcSource())?e="animation_vk":-1!==["web_mm","mobile_mm"].indexOf(cleverapps.User.calcSource())&&(e="animation_mm"),e},RaffleMissionLogic.IsAvailable=function(){return-1!==["web_vk","mobile_vk"].indexOf(cleverapps.User.calcSource())?-1!==["crocword","heroes"].indexOf(cleverapps.config.name):-1!==["mobile_mm","web_mm","mobile_ok","web_ok"].indexOf(cleverapps.User.calcSource())&&-1!==["wordsoup","crocword","heroes","riddles"].indexOf(cleverapps.config.name)},RaffleMissionLogic.LVLS_PER_TICKET=15;var DailyCupPlayButton=cc.Node.extend({ctor:function(e){this._super(),this.options=e;var t=cleverapps.styles.DailyCupPlayButton;this.button=this.createButton(),this.addChild(this.button),this.setAnchorPoint2(),this.setContentSize2(
this.button.getContentSize()),this.button.setPositionRound(this.width/2,this.height/2),this.options.parent.addChild(this),this.setPositionRound(t)},createButton:function(){var e=cleverapps.styles.DailyCupPlayButton;return new cleverapps.UI.Button({text:Messages.get("Play"),font:cleverapps.styles.FONTS.DAILY_CUP_PLAY_BUTTON_TEXT||cleverapps.styles.FONTS.BIG_BUTTON_TEXT,onClicked:this.options.onClicked,width:e.width,height:e.height,button_png:e.button_png,button_on_png:e.button_on_png,padding:{x:e.titlePaddingX}})},enable:function(){this.button.enable()},disable:function(){this.button.disable()},setTitle:function(e){var t=cleverapps.styles.DailyCupPlayButton;this.button.text.setString(Messages.get(e)),this.button.text.fitTo(this.button.width-2*t.titlePaddingX)}});cleverapps.styles.DailyCupPlayButton={x:{align:"center"},y:{align:"bottom",dy:120},width:300,height:125,titlePaddingX:20};var DailyCupScene=cleverapps.FixedWidthScene.extend({ctor:function(){this._super(
cleverapps.Environment.SCENE_DAILY_CUP),this.mainContainer=new cc.Node,this.mainContainer.setAnchorPoint2(),this.mainContainer.setContentSize(this.scene.getContentSize()),this.mainContainer.setPositionRound(this.scene.width/2,this.scene.height/2),cleverapps.UI.makeHideable(this.mainContainer,cleverapps.UI.SCALE_ANIMATION),cleverapps.metha.registerControl("dailyCupMainContainer",this.mainContainer),this.scene.addChild(this.mainContainer),this.table=new DailyCupTable(cleverapps.dailyCup,cleverapps.styles.DailyCupTable,cleverapps.DailyCupRow,this.mainContainer),this.createTableBg(),this.createTitleBg(),this.createTitle(),this.createPlayButton(),this.createHelpButton(),this.createLeadersButton(),cleverapps.playSession.set(cleverapps.EVENTS.DAILY_CUP_DAU,!0),this.onNoConnectionInfo(),cleverapps.dailyCup.onNoConnectionListener=this.createListener(this.onNoConnectionInfo.bind(this)),cleverapps.dailyCup.isActive()||this.onChangeActivation(),
cleverapps.dailyCup.onActivationListener=this.createListener(this.onChangeActivation.bind(this)),this.updateState(),cleverapps.dailyCup.updateListeners.scene=this.createListener(this.updateState.bind(this)),cleverapps.environment.episodeNo=DailyCup.EPISODE_ID,cleverapps.placements.run(Placements.INTERMEDIATE)},getRefreshSceneActionOnChangeSize:function(){return function(e){cleverapps.scenes.replaceScene(new DailyCupScene,e)}},getBackgroundStyles:function(){return cleverapps.styles.DailyCupScene.background},createTableBg:function(){var e=this.getStyles().tableBg;if(e){var t=this.tableBg=cleverapps.UI.createScale9Sprite(bundles.main.frames.table_bg_png||bundles.daily_cup.frames.table_bg_png||bundles.windows.frames.window_bg_png,cleverapps.UI.Scale9Rect.TwoPixelXY);if(t.setContentSize(e.width*this.table.tableView.scaleX,e.height),this.mainContainer.addChild(t),t.setPositionRound(this.mainContainer.width/2+e.x,this.mainContainer.height/2+e.y),e.stitches&&new StitchesComponent(t,e.stitches)
,e.innerBg){var n=new cc.Scale9Sprite(bundles.main.frames.window_inner_bg_png);n.setContentSize2(e.innerBg.width*this.table.tableView.scaleX,e.innerBg.height),this.mainContainer.addChild(n),n.setPositionRound(e.innerBg)}}},createLeadersButton:function(){var e=this.getStyles().leadersButton,t=new cc.Sprite(bundles.daily_cup.frames.daily_cup_leaders_icon_png);this.scene.addChild(t),t.setPositionRound(e),t.setLocalZOrder(1),t.baseScale=t.scale=e.scale,cleverapps.UI.applyHover(t),cleverapps.UI.onClick(t,function(){cleverapps.metha.display({focus:"DailyCupLeadersWindow",action:function(e){new DailyCupLeadersWindow,cleverapps.metha.onceNoWindowsListener=e}})}),cleverapps.UI.makeHideable(t,cleverapps.UI.VERTICAL),cleverapps.metha.registerControl("leadersButton",t)},onChangeActivation:function(){if(cleverapps.dailyCup.isActive()){this.loading&&(this.loading.removeFromParent(!0),this.loading=void 0);var e=this.table?.7:0;this.table=new DailyCupTable(cleverapps.dailyCup,
cleverapps.styles.DailyCupTable,cleverapps.DailyCupRow,this.mainContainer),this.table.runStartAnimation(e)}else this.table.runFinishAnimation(),this.loading=WaitWindow.prototype.showLoading.call(this),this.mainContainer.addChild(this.loading),this.loading.setPositionRound(this.mainContainer.width/2,this.mainContainer.height/2)},onNoConnectionInfo:function(){if(cleverapps.dailyCup.noConnection){var e=this.getStyles().noConnectionInfo;this.noConnectionInfo=cleverapps.UI.createScale9Sprite(e.bg.image),this.noConnectionInfo.setContentSize2(e.bg.width,e.bg.height);var t=cleverapps.UI.generateTTFText("messages:InternetConnectionError",cleverapps.styles.FONTS.WHITE_TEXT);t.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER),t.setVerticalAlignment(cc.VERTICAL_TEXT_ALIGNMENT_CENTER),t.setPositionRound(this.noConnectionInfo.width/2,this.noConnectionInfo.height/2),t.setDimensions(this.noConnectionInfo.width,this.noConnectionInfo.height),this.noConnectionInfo.addChild(t),this.mainContainer.addChild(
this.noConnectionInfo,1),this.noConnectionInfo.setPositionRound(e)}else this.noConnectionInfo&&(this.noConnectionInfo.removeFromParent(!0),delete this.noConnectionInfo)},updateState:function(){cleverapps.dailyCup.stillCanPlay()?(this.createTimer(),this.removeText(),this.playButton.enable(),this.playButton.setTitle("Play")):(this.createText(),this.removeTimer(),cleverapps.dailyCup.isFinished()?(this.playButton.setTitle("Next"),this.playButton.enable()):(this.playButton.setTitle("Play"),this.playButton.disable()))},createHelpButton:function(){var e=this.getStyles().helpButton,t=new cleverapps.UI.Button({button_png:bundles.buttons_main.frames.help_button_png,button_on_png:bundles.buttons_main.frames.help_button_on_png,onClicked:function(){cleverapps.metha.display({focus:"DailyCupRulesWindow",action:function(e){new DailyCupRulesWindow,cleverapps.metha.onceNoWindowsListener=e}})}});this.scene.addChild(t),t.setPositionRound(e),cleverapps.UI.makeHideable(t,cleverapps.UI.VERTICAL),
cleverapps.metha.registerControl("helpButton",t)},createTitleBg:function(){var e=this.getStyles().titleBg;if(e){var t=bundles.daily_cup.frames.daily_cup_titleBg||bundles.main.frames.window_title_bg_png;if(e.useRibbonTitle&&(t=bundles.main.frames.ribbon),this.titleBg=cleverapps.UI.createScale9Sprite(t,cleverapps.UI.Scale9Rect.TwoPixelXY),e.width&&this.titleBg.setContentSize2(e.width*this.table.tableView.scaleX,e.height),e.scale&&this.titleBg.setScale(e.scale),this.mainContainer.addChild(this.titleBg),this.titleBg.setPositionRound(e),bundles.daily_cup.frames.dailycup_title_icon){var n=new cc.Sprite(bundles.daily_cup.frames.dailycup_title_icon);this.titleBg.addChild(n,e.icon.zOrder||0),n.setPositionRound(e.icon)}}},createTitle:function(){var e=this.getStyles(),t=this.title=cleverapps.UI.generateTTFText("messages:DailyCup.title",cleverapps.styles.FONTS.DAILY_TOURNAMENT_TITLE_TEXT);t.setLocalZOrder(1),this.titleBg?this.titleBg.addChild(t):this.mainContainer.addChild(t),
t.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER),t.setPositionRound(e.title),t.fitTo(e.title.width);var n=e.title.width/t.width,s=e.title.height/t.height,i=Math.min(n,s);i<1&&t.setScale(i)},removeTimer:function(){this.timer&&(this.timer.removeFromParent(),delete this.timer)},createTimer:function(){if(this.removeTimer(),cleverapps.dailyCup.timeout){var e=cleverapps.dailyCup.timeout.getTimeLeft(),t=this.getStyles().timer,n={font:cleverapps.styles.FONTS.DAILY_CUP_TIMER_TEXT,timerPosition:t.timerPosition,regularFontTimerPosition:t.regularFontTimerPosition};if(t.timerBg){var s=cleverapps.UI.createScale9Sprite(t.timerBg.image);s.setContentSize2(t.timerBg),n.background_content=s}this.timer=new cleverapps.CountDownView(new cleverapps.CountDown(e),n),this.mainContainer.addChild(this.timer),this.timer.setPositionRound(t)}},removeText:function(){this.textNode&&(this.textNode.removeFromParent(),delete this.textNode)},createText:function(){if(!this.textNode){var e=this.getStyles(),
t=cleverapps.UI.generateOnlyText("messages:DailyCup.finished",cleverapps.styles.FONTS.DAILY_CUP_TIMER_TEXT);if(this.textNode=new cc.Node,this.textNode.setAnchorPoint2(),this.mainContainer.addChild(this.textNode),this.textNode.setContentSize2(t.getContentSize()),this.textNode.setPositionRound(e.timer),this.textNode.addChild(t),t.setVerticalAlignment(cc.VERTICAL_TEXT_ALIGNMENT_CENTER),t.setPositionRound(this.textNode.width/2,this.textNode.height/2),e.timer.timerBg){var n=cleverapps.UI.createScale9Sprite(e.timer.timerBg.image);n.setContentSize2(t.width+e.textBg.offsetWidth,t.height+e.textBg.offsetHeight),this.textNode.addChild(n),n.setLocalZOrder(-1),n.setPositionRound(this.textNode.width/2,this.textNode.height/2)}}},createPlayButton:function(){this.playButton=new DailyCupPlayButton({parent:this.scene,onClicked:this.onPlayClicked.bind(this)}),cleverapps.UI.makeHideable(this.playButton,cleverapps.UI.VERTICAL),cleverapps.metha.registerControl("playButton",this.playButton)},
onPlayClicked:function(){cleverapps.dailyCup.stillCanPlay()?cleverapps.dailyCup.noConnection?cleverapps.Notification.create("messages:InternetConnectionError"):cleverapps.metha.display({focus:"PlayDailyCup",action:function(e){cleverapps.dailyCup.wantsToPlay(e)}}):cleverapps.dailyCup.isFinished()&&cleverapps.dailyCup.restart()},getStyles:function(){return cleverapps.styles.DailyCupScene},displayIntro:function(e){cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.DAILY_CUP_RULES)?e():(new DailyCupRulesWindow(function(){cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.DAILY_CUP_RULES,!0)}),cleverapps.metha.onceNoWindowsListener=e)}});DailyCupScene.BUNDLES=function(){return["daily_cup","main","windows"]},cleverapps.styles.DailyCupTable={x:{align:"center",dx:0},y:{align:"center",dy:-40},table:{height:700,width:500,bg:bundles.daily_cup.frames.daily_cup_table_bg,padding:5}},cleverapps.overrideFonts(cleverapps.styles.FONTS,{DAILY_CUP_TIMER_TEXT:{name:"default",size:40,
stroke:cleverapps.styles.DECORATORS.IMAGE_FONT_STROKE}}),cleverapps.styles.DailyCupScene={background:{background:bundles.daily_cup.urls.bg},title:{x:{align:"center",dx:0},y:{align:"center",dy:15},width:520,height:100},titleBg:{x:{align:"center",dx:0},y:{align:"top",dy:-90}},noConnectionInfo:{x:{align:"center",dx:0},y:{align:"center",dy:0},bg:{width:480,height:120,image:bundles.main.frames.timer_bg_png}},timer:{x:{align:"center",dx:0},y:{align:"top",dy:-275},timerBg:{width:220,height:50,image:bundles.main.frames.timer_bg_png},timerPosition:{x:0,y:0}},textBg:{offsetWidth:40,offsetHeight:20},helpButton:{x:{align:"center",dx:-210},y:{align:"bottom",dy:160}},leadersButton:{x:{align:"center",dx:230},y:{align:"bottom",dy:60},scale:.4}};var DailyCupLeadersWindow=Window.extend({onWindowLoaded:function(){var e=cleverapps.styles.DailyCupLeadersWindow;this.content=new cc.Node,this.content.setAnchorPoint(.5,.5),this.content.setContentSize(e.width,e.height),this._super({
title:"messages:DailyCupLeadersWindow.Title",name:"dailycupleaderswindow",content:this.content}),cleverapps.dailyCupLeadersWindowTable.getResults("cache")?this.leadersOnLoad(cleverapps.dailyCupLeadersWindowTable.getResults("cache")[0]):(this.loading=new LeadersLoading,this.loading.setPosition(this.content.width/2,this.content.height/2),this.content.addChild(this.loading),cleverapps.RestClient.get("/dailycup/leaders/"+cleverapps.user.id,{},this.createListener(this.leadersOnLoad.bind(this)),function(){cleverapps.Notification.create("messages:LeadersLoadFailed")})),cleverapps.audio.playSound(bundles.main.urls.window_effect)},leadersOnLoad:function(e){this.loading&&(this.loading.remove(),cleverapps.dailyCupLeadersWindowTable.updateResults("cache",[e]));for(var t=cleverapps.styles.DailyCupLeadersWindow,n=e.leaders,s=!1,i=0;i<n.length;i++)if(n[i].id===cleverapps.user.id){s=!0,n[i].player=!0;break}if(!s){var o={id:cleverapps.user.id,firstPlace:e.playerResult.firstPlace,
secondPlace:e.playerResult.secondPlace,thirdPlace:e.playerResult.thirdPlace,player:!0,avatar:cleverapps.friends.getPlayer().avatar,text:cleverapps.friends.getPlayer().name,notInTop:!0};n.push(o)}n.forEach(function(e,t){e.place=t+1});var r=this.table=cleverapps.dailyCupLeadersWindowTable.createTableView({id:"dailyCupLeadersWindow",data:n,rowConstructor:cleverapps.DailyCupLeadersRow});r.setPositionRound(t.tablePosition),this.content.addChild(r)}});cleverapps.styles.DailyCupLeadersWindow={width:600,height:770,tablePosition:{x:{align:"center"},y:{align:"center",dy:-50}}};var DailyCupTable=function(e,t,n,s){this.parent=s,this.dailyCup=e,this.id=this.dailyCup.id,this.styles=t,this.rowConstructor=n,this.createTable()};DailyCupTable.prototype.createTable=function(){this.tableView&&this.tableView.removeFromParent(),this.tableView=this.dailyCup.table.createTableView({id:this.dailyCup.type,data:this.dailyCup.players,rowConstructor:this.rowConstructor,options:{styles:{
height:this.styles.table.height,bg:this.styles.table.bg}}}),this.adjustSize(),this.parent.addChild(this.tableView),this.tableView.setPositionRound(this.styles),this.tableView.setLocalZOrder(1),this.dailyCup.updateListeners.scoreboard=this.tableView.createListener(function(e,t){t&&this.parent.isRunningSafe()&&(t!==this.id?(this.id=t,this.dailyCup.table.resetResults(this.dailyCup.type),this.createTable()):this.updateResults())}.bind(this)),this.dailyCup.onPlayerInfoChanged=this.tableView.createListener(function(){this.dailyCup.table.resetResults(this.dailyCup.type),this.createTable()}.bind(this))},DailyCupTable.prototype.adjustSize=function(){var e=this.styles.table.padding||0,t=cleverapps.UI.getSceneSize().width/(this.tableView.getContentSize().width+2*e);t<1&&this.tableView.setScale(t)},DailyCupTable.prototype.updateResults=function(){this.tableView.updateResults(this.dailyCup.players)?this.dailyCup.table.updateResults(this.dailyCup.type,this.dailyCup.players):(
this.dailyCup.table.resetResults(this.dailyCup.type),this.createTable())},DailyCupTable.prototype.runFinishAnimation=function(){if(!this.inFinishAnimation){this.inFinishAnimation=!0,this.tableView.stopAllActions();var e=this.tableView.getScale();this.tableView.runAction(new cc.Sequence(new cc.ScaleTo(.2,1.1*e).easing(cc.easeIn(2)),new cc.ScaleTo(.3,0),new cc.RemoveSelf))}},DailyCupTable.prototype.runStartAnimation=function(e){this.tableView.stopAllActions();var t=this.tableView.getScale();this.tableView.setScale(0),this.tableView.runAction(new cc.Sequence(new cc.DelayTime(e||0),new cc.ScaleTo(.3,1.1*t).easing(cc.easeOut(2)),new cc.ScaleTo(.2,t)))};var DailyCup=function(e){(this.type=e,this.data=DailyCupsConfig[e],this.debugInfo={},cleverapps.config.debugMode&&(DailyCup.RELOAD_INTERVAL="5 seconds"),this.updateListeners={},this.onNoConnectionListener=function(){},this.onActivationListener=function(){},this.onPlayerInfoChanged=function(){},this.reset(),this.load(),this.reload(),
setInterval(this.reload.bind(this),cleverapps.parseInterval(DailyCup.RELOAD_INTERVAL)),this.runLocalTimeout(),this.table=new cleverapps.Table,cleverapps.friends.playerInfoChangedListeners["dailyCup_"+e]=this.playerInfoChanged.bind(this),this.finished)&&(void 0===this.calcRewardPlace()&&this.data.autoRestart&&this.restart())};DailyCup.prototype.reset=function(){this.deactivate(),this.setNoConnection(!1),this.stars=0,this.level=0,this.timeFinish=void 0,this.finished=!1},DailyCup.prototype.setNoConnection=function(e){this.noConnection!==e&&(this.noConnection=e,this.onNoConnectionListener())},DailyCup.prototype.getTimeLeft=function(){if(this.timeFinish){var e=this.timeFinish-Date.now();return e<0?0:e}},DailyCup.prototype.runLocalTimeout=function(){clearTimeout(this.timeout),void 0!==this.getTimeLeft()&&(this.timeout=new cleverapps.LongTimeout(function(){this.runUpdateListeners()}.bind(this),this.getTimeLeft()))},DailyCup.prototype.load=function(){var e=cleverapps.DataLoader.load(
cleverapps.DataLoaderTypes[this.data.storageKey]);e&&(this.activate(e.id),this.stars=e.stars,this.level=e.level,this.finished=e.finished,this.timeFinish=e.timeFinish,this.players=e.players,e.timeLeft&&(this.timeFinish=Date.now()+e.timeLeft)),this.players=this.players||[],this.finished&&0===this.players.length&&(this.finished=!1),this.debugInfo.loadTime=Date.now(),this.preparePlayersData()},DailyCup.prototype.getInfo=function(){return{id:this.id,stars:this.stars,level:this.level,finished:this.finished,timeFinish:this.timeFinish}},DailyCup.prototype.updateInfo=function(e,t){this.activate(e.id),this.stars=e.stars,this.level=e.level,this.timeFinish=void 0,this.finished=!1,this.debugInfo.updateInfoTime=Date.now(),this.save(t)},DailyCup.prototype.save=function(e){var t=this.getInfo();t.players=this.players,cleverapps.DataLoader.save(cleverapps.DataLoaderTypes[this.data.storageKey],t),!e&&this.data.serverTaskName&&cleverapps.synchronizer.addUpdateTask(this.data.serverTaskName)},
DailyCup.prototype.createEpisode=function(){var e=Episode.LevelChooseAlgorithm({start:5,seed:1e3*(this.id||0)+(this.level||0)});return new Episode(e.episodeNo,e.levelNo,{type:Episode.Types.DAILYCUP})},DailyCup.prototype.getPlayerInfo=function(){return{id:cleverapps.user.id,amount:this.stars,player:!0,avatar:this.getPlayerAvatar(),text:cleverapps.friends.getPlayer().name}},DailyCup.prototype.getPlayerAvatar=function(){return{avatar:cleverapps.friends.getPlayer().avatar,id:cleverapps.user.id}},DailyCup.prototype.playerInfoChanged=function(e){for(var t=0;t<this.players.length;t++)if(this.players[t].id===e){var n=this.getPlayerInfo();return this.players[t].id=n.id,this.players[t].avatar=n.avatar,this.players[t].text=n.text,this.save(),void this.onPlayerInfoChanged()}},DailyCup.prototype.addDebugPlayers=function(){if(cleverapps.config.debugMode&&DailyCup.DEBUG_PLAYERS_AMOUNT){for(var e=0;this.players.length<DailyCup.DEBUG_PLAYERS_AMOUNT;)this.players.push({id:"10000"+e,
amount:cleverapps.Random.random(10,30)*e,avatar:this.getPlayerAvatar(),text:"Player_"+e}),e++;this.players.sort(function(e,t){return t.amount-e.amount})}},DailyCup.prototype.preparePlayersData=function(){for(var e=void 0,t=0;t<this.players.length;t++)this.players[t].id===cleverapps.user.id&&(this.players[t].amount=this.stars,this.players[t].player=!0,this.players[t].avatar=this.getPlayerAvatar(),e=t);if(void 0===e){var n=this.getPlayerInfo();e=this.players.length,this.players.push(n)}for(this.addDebugPlayers();0<e&&this.players[e-1].amount<this.players[e].amount;){var s=this.players[e-1];this.players[e-1]=this.players[e],this.players[e]=s,e--}this.players[e].notInTop=e>=DailyCup.TOP_LIMIT,this.players.forEach(function(e,t){e.place=t+1})},DailyCup.prototype.stillCanPlay=function(){return this.isActive()&&0<this.getTimeLeft()},DailyCup.prototype.isFinished=function(){return this.finished},DailyCup.prototype.isActive=function(){return 0!==this.id},DailyCup.prototype.activate=function(e){
this.id!==e&&(this.id=e,this.onActivationListener())},DailyCup.prototype.deactivate=function(){0!==this.id&&(this.id=0,this.onActivationListener())},DailyCup.prototype.calcRewardPlace=function(){if(this.isFinished())for(var e=0;e<this.players.length&&e<this.data.rewards.length;e++)if(this.players[e].player){if(0===this.players[e].amount)return;return e}},DailyCup.prototype.giveReward=function(){var n=this.calcRewardPlace(),s=this.id;0===n&&cleverapps.missionManager.dispatchEvent(Mission.EVENT_WIN_DAILYCUP),cleverapps.metha.display({focus:"DailyCupRewards",actions:[function(e){this.data.victoryWindow?(new this.data.victoryWindow(n),cleverapps.metha.onceNoWindowsListener=e):e()}.bind(this),function(e){this.restart();var t=this.data.rewards[n];this.type!==DailyCup.TYPE_WEEKLY&&RewardsConfig.DailyCup.prepareByRich&&(t=cleverapps.user.prepareRewardByRich(t)),new DailyCupRewardWindow({reward:t,place:n+1,id:s,type:this.type}),cleverapps.metha.onceNoWindowsListener=e}.bind(this)]})},
DailyCup.prototype.restart=function(){this.reset(),this.save(),this.runUpdateListeners(),this.reload()},DailyCup.prototype.markFinished=function(){if(!this.finished){this.finished=!0,this.debugInfo.markFinishedTime=Date.now(),cleverapps.dailyCupLeadersWindowTable.resetResults("cache"),this.save(),this.runUpdateListeners();var e=this.calcRewardPlace();void 0===e||cleverapps.metha.isFocused()||this.giveReward(),void 0===e&&this.data.autoRestart&&this.restart()}},DailyCup.prototype.onRespond=function(){this.reloading=!1},DailyCup.prototype.onSuccess=function(e){if(!e)return console.log("Empty result"),void this.onFailure();var t=this.id;if(this.setNoConnection(!1),this.onRespond(),this.timeFinish=Date.now()+e.time,this.players=e.players,this.id!==e.id&&(this.stars=0,this.level=0),this.preparePlayersData(),this.id!==e.id&&(this.table.resetResults(this.type),cleverapps.dailyCupLeadersWindowTable.resetResults("cache"),this.activate(e.id)),this.save(!0),this.debugInfo.onSuccessTime=Date.now()
,this.debugInfo.onSuccessPlayersLenght=this.players.length,this.debugInfo.onSuccessData=JSON.stringify(e),this.debugInfo.onSuccessThisId=t,e.time<=0){this.calcRewardPlace();this.markFinished()}else this.runLocalTimeout();this.runUpdateListeners()},DailyCup.prototype.onFailure=function(){this.setNoConnection(!0),this.onRespond(),console.error("can't update DailyCup of type "+this.type)},DailyCup.prototype.reload=function(){DailyCup.IsAvailable(this.type)&&(this.reloading||this.isFinished()||(this.type!==DailyCup.TYPE_WEEKLY||cleverapps.scenes.isLoaderScene()||cleverapps.environment.isMainScene())&&(this.type!==DailyCup.TYPE_DAILY||cleverapps.environment.isDailyCupScene()||cleverapps.environment.isMainScene())&&(this.reloading=!0,cleverapps.RestClient.get("/dailycup/get/"+this.id+"/"+this.type,{},this.onSuccess.bind(this),this.onFailure.bind(this))))},DailyCup.prototype.runUpdateListeners=function(){cleverapps.sideBar.resetByClassName(DailyCupIcon),cleverapps.values(this.updateListeners
).forEach(function(e){e(this.players,this.id)}.bind(this))},DailyCup.prototype.addAmount=function(e){if(this.stillCanPlay()){this.type===DailyCup.TYPE_DAILY&&0===this.stars&&cleverapps.missionManager.dispatchEvent(Mission.EVENT_PLAY_DAILYCUP),e=void 0===e?0:e,this.level++,this.stars+=e,this.save();var t=this.id?this.id:-1;cleverapps.RestClient.post("/dailycup/update/"+cleverapps.user.id+"/"+this.type,{id:t,stars:this.stars},function(){},function(){console.log("couldn't update progress")}),this.preparePlayersData()}},DailyCup.prototype.cupWithLives=function(){return cleverapps.lives&&"board"!==cleverapps.config.type},DailyCup.prototype.wantsToPlay=function(e){if(this.cupWithLives()&&cleverapps.lives.isEmpty())return new LivesShopWindow,void(cleverapps.metha.onceNoWindowsListener=e);var t=this.createEpisode().getLevel();BoostersBefore.isAvailable()&&LevelStartWindow.isAvailable(t.episode.episodeNo,t.levelNo)?(cleverapps.metha.showControlsWhileFocused("MenuBarGoldItem"),
new LevelStartWindow({level:t}),cleverapps.metha.onceNoWindowsListener=e):t.play(e)},DailyCup.IsAvailable=function(e,t){return(e!==DailyCup.TYPE_WEEKLY||cleverapps.metha.getType()===Metha.KNOCKOUT)&&levels.user.checkAvailable(DailyCupsConfig[e].available,t)},DailyCup.TOP_LIMIT=25,DailyCup.RELOAD_INTERVAL="1 minute",DailyCup.TYPE_DAILY=0,DailyCup.TYPE_WEEKLY=1;var DailyCupsConfig={};DailyCupsConfig[DailyCup.TYPE_DAILY]={available:{episode:5,level:0,registered:"7 days",differences:{disabled:!0}},serverTaskName:"userdailycup",rewards:RewardsConfig.DailyCup.places,leadersWindow:DailyCupLeadersWindow,storageKey:"DAILY_CUP"},RewardsConfig.WeeklyCup&&(DailyCupsConfig[DailyCup.TYPE_WEEKLY]={available:{episode:0,level:0,projectName:["olympics","differences"]},serverTaskName:"userweeklycup",rewards:RewardsConfig.WeeklyCup.places,storageKey:"WEEKLY_CUP",victoryWindow:"undefined"!=typeof WeeklyCupVictoryWindow&&WeeklyCupVictoryWindow,autoRestart:!0});var DailyCupRewardWindow=RewardWindow.extend({
onWindowLoaded:function(e){this.place=e.place,this.id=e.id,this._super({title:e.type===DailyCup.TYPE_WEEKLY?"messages:WeeklyCupTable.title":"messages:DailyCup.title",name:"dailycuprewardwindow",text:"messages:DailyCup.reward",reward:e.reward,rewardName:"dailyCup"})},onReceiveReward:function(){cleverapps.eventLogger.logEvent(cleverapps.EVENTS.DAILY_CUP_REWARD+"_"+this.place+"_"+this.id)}}),DailyCupRulesWindow=RulesWindow.extend({onWindowLoaded:function(e){this.callback=e,this._super({name:"dailycupruleswindow",styles:cleverapps.styles.DailyCupRulesWindow})},onClose:function(){this.callback&&this.callback()}});cleverapps.styles.DailyCupRulesWindow={prefix:"messages:DailyCupRulesWindow.",animation:{json:bundles.daily_cup.jsons.daily_cup_json,name:"animation"},subText:{width:200,left:{x:{align:"left",dx:40},y:{align:"top",dy:-250}},right:{x:{align:"right",dx:45},y:{align:"top",dy:-215}},bottom:{x:{align:"center",dx:5},y:{align:"center",dy:-320}}}};var Subscription=function(){this.load(),
this.onChangeStateListeners={icon:Subscription.updateIcon},cleverapps.config.debugMode&&(Subscription.RELOAD_INTERVAL="1 minute",Subscription.REWARD_INTERVAL="20 minutes",Subscription.BUY_TRIAL_INTERVAL="10 seconds"),"ios"===cleverapps.User.calcSource()&&(Subscription.AVAILABLE={episode:0,level:1}),this.reload(),this.haveTmpId()&&this.runOnBuyReloads()};Subscription.updateIcon=function(){cleverapps.sideBar.resetByClassName(SubscriptionIcon)},Subscription.calcSource=function(){var e=cleverapps.User.calcSource();return"mobile_ok"===e&&(e="web_ok"),e},Subscription.prototype.load=function(){var e=cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.SUBSCRIPTION),t=Subscription.calcSource();e&&e[t]?(this.id=e[t].id,this.lastRewardTime=e[t].lastRewardTime||0,this.lastReloadTime=e[t].lastReloadTime||0,this.trialBoughtTime=e[t].trialBoughtTime||0,this.tokens=e[t].tokens||{}):(this.id=0,this.lastRewardTime=0,this.lastReloadTime=0,this.trialBoughtTime=0,this.tokens={})},
Subscription.prototype.getInfo=function(){var e={},t=Subscription.calcSource();return e[t]={id:this.id,lastRewardTime:this.lastRewardTime,lastReloadTime:this.lastReloadTime,trialBoughtTime:this.trialBoughtTime},0<Object.keys(this.tokens).length&&(e[t].tokens=this.tokens),e},Subscription.prototype.updateInfo=function(e,t){var n=Subscription.calcSource();e[n]&&(this.id=e[n].id,this.lastRewardTime=e[n].lastRewardTime||0,this.lastReloadTime=e[n].lastReloadTime||0,this.trialBoughtTime=e[n].trialBoughtTime||0,this.tokens=cleverapps.override({},e[n].tokens||{},this.tokens),this.save(t))},Subscription.prototype.save=function(e){cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.SUBSCRIPTION,this.getInfo()),e||cleverapps.synchronizer.addUpdateTask("subscription")},Subscription.prototype.getLeftTime=function(){if(this.isActive()){if(!this.lastRewardTime)return 0;var e=Date.now();return"daily"===Subscription.REWARD_INTERVAL?Math.max(cleverapps.extractDateFromDateTime(this.lastRewardTime
)+cleverapps.parseInterval("1 day")-e,0):Math.max(this.lastRewardTime+cleverapps.parseInterval(Subscription.REWARD_INTERVAL)-e,0)}},Subscription.prototype.reload=function(){var e=Subscription.calcSource();cleverapps.isLocalhost()||this.isDebugNoPayments()||-1===["facebook","web_ok","mobile_ok","android","ios"].indexOf(e)||-1!==["android","ios"].indexOf(e)&&0===Object.keys(this.tokens).length||!this.haveTmpId()&&this.lastReloadTime+cleverapps.parseInterval(Subscription.RELOAD_INTERVAL)>Date.now()||this.getAsync(function(e,t){if(!e){t=t||{};var n=this.isActive();this.id=t.id,this.lastReloadTime=Date.now(),this.save(),cleverapps.values(this.onChangeStateListeners).forEach(cleverapps.callFunc),n&&!this.isActive()&&cleverapps.eventLogger.logEvent(cleverapps.EVENTS.SUBSCRIPTION_CANCELLED)}}.bind(this))},Subscription.prototype.getAsync=function(t){var e=Subscription.calcSource();if(-1!==["facebook","web_ok","mobile_ok","android","ios"].indexOf(e))if(levels.user.haveTmpId()&&-1!==["facebook",
"web_ok","mobile_ok"].indexOf(e))t(cleverapps.Social.CODE_FAILED);else{var n={source:e,tokens:this.tokens,id:this.id};cleverapps.RestClient.post("/subscriptions/get/"+levels.user.id,n,function(e){e&&!e.id&&(e={}),t(cleverapps.Social.CODE_SUCCEED,e)},function(){t(cleverapps.Social.CODE_FAILED)})}},Subscription.prototype.haveTmpId=function(){return this.id&&2<=this.id.length&&"__"===this.id.substr(0,2)},Subscription.prototype.onBuySubscription=function(e){cleverapps.history.add("sbcrb",1),this.id=cleverapps.user.generateTmpId();var t=Subscription.calcSource();(-1!==["facebook","android","ios"].indexOf(t)||this.isDebugNoPayments())&&(this.lastRewardTime=0),this.lastReloadTime=0,e.trial&&(this.trialBoughtTime=Date.now()),this.save(),this.runOnBuyReloads()},Subscription.prototype.runOnBuyReloads=function(){["5 seconds","15 seconds","30 seconds","1 minute","3 minutes","5 minutes","10 minutes"].forEach(function(e){setTimeout(function(){cleverapps.subscription.reload()},
cleverapps.parseInterval(e))})},Subscription.prototype.addPurchaseTokens=function(e,t){Array.isArray(e)||(e=[e]);var r=!1;e.forEach(function(e){var t=e.name,n=e.purchaseToken,s=e.productId,i=e.packageName,o=this.tokens[t]||{};t&&n&&s&&i&&(o.purchaseToken!==n||o.productId!==s||o.packageName!==i)&&(this.tokens[t]={productId:s,packageName:i,purchaseToken:n},r=!0)}.bind(this)),r&&(t&&!this.isActive()&&(this.lastReloadTime=0,this.reload()),this.save())},Subscription.prototype.isRewardReady=function(){return!!this.isActive()&&0===this.getLeftTime()},Subscription.prototype.getReward=function(){return!!this.isRewardReady()&&(this.lastRewardTime=Date.now(),this.save(),cleverapps.values(this.onChangeStateListeners).forEach(cleverapps.callFunc),!0)},Subscription.prototype.isActive=function(){return this.id},Subscription.prototype.calcReward=function(){var e=cleverapps.clone(RewardsConfig.Subscription,!0);return cleverapps.user.setRandomBoostersReward(e)},
Subscription.prototype.reactivate=function(e){!this.isActive()||cleverapps.isLocalhost()||this.isDebugNoPayments()||0===this.id.indexOf("__")||cleverapps.payments.reactivateSubscription&&cleverapps.payments.reactivateSubscription(this.id,e)},Subscription.prototype.canBuyTrial=function(){return!(!cleverapps.isLocalhost()&&-1===["580731438762","577203420866","585959187481","576593702177","8593874"].indexOf(cleverapps.user.id))||this.trialBoughtTime+cleverapps.parseInterval(Subscription.BUY_TRIAL_INTERVAL)<Date.now()},Subscription.prototype.isDebugNoPayments=function(){return cleverapps.isStaging()&&-1!==Subscription.SOCIAL_PAYMENT_NOT_FREE_ON_STAGING.indexOf(cleverapps.User.calcSource())&&this.toolDebugWithoutPayment},Subscription.prototype.cancel=function(e){if(this.isActive())return cleverapps.isLocalhost()||this.isDebugNoPayments()?(delete this.id,this.save(),void cleverapps.values(this.onChangeStateListeners).forEach(cleverapps.callFunc)):void(0!==this.id.indexOf("__"
)&&cleverapps.payments.cancelSubscription&&cleverapps.payments.cancelSubscription(this.id,e))},Subscription.IsAvailable=function(){return!!cleverapps.subscription&&(!!cleverapps.subscription.isActive()||!("ios"===cleverapps.User.calcSource()&&!cleverapps.payments.isProductsExists(["subsWeek","subsMonth"]))&&cleverapps.user.checkAvailable(Subscription.AVAILABLE))},Subscription.IsModelAvailable=function(){var e=[];switch(cleverapps.User.calcSource()){case"web_ok":case"mobile_ok":e=Subscription.MODEL_AVAILABLE_OK;break;case"facebook":e=Subscription.MODEL_AVAILABLE_FACEBOOK;break;case"android":e=Subscription.MODEL_AVAILABLE_ANDROID;break;case"ios":e=Subscription.MODEL_AVAILABLE_IOS}return config&&config.debugMode&&(cleverapps.OK.isAppropriate()||cleverapps.MobileOK.isAppropriate()||cleverapps.FakeFacebook.isAppropriate())&&(e=Subscription.MODEL_AVAILABLE_OK.concat(Subscription.MODEL_AVAILABLE_FACEBOOK)),-1!==e.indexOf(cleverapps.config.name)},Subscription.MODEL_AVAILABLE_OK=["heroes",
"riddles","wordsoup","crocword","tripeaks","runes","olympics","scramble","differences","magicwords"],Subscription.MODEL_AVAILABLE_FACEBOOK=["heroes","riddles","wordsoup","crocword","tripeaks","scramble","magicwords"],Subscription.MODEL_AVAILABLE_ANDROID=["heroes","riddles","wordsoup","crocword","tripeaks","olympics","scramble"],Subscription.MODEL_AVAILABLE_IOS=["crocword","wordsoup","tripeaks"],Subscription.AVAILABLE={episode:3,level:0},Subscription.REWARD_INTERVAL="daily",Subscription.RELOAD_INTERVAL="1 hour",Subscription.BUY_TRIAL_INTERVAL="3 day",Subscription.SOCIAL_PAYMENT_NOT_FREE_ON_STAGING=["mobile_ok","web_ok"];var SubscriptionWindow=Window.extend({onWindowLoaded:function(){this.weekProduct=Product.Create("subsWeek"),this.monthProduct=Product.Create("subsMonth"),this.buySubscription=function(e){if(cleverapps.subscription.isActive())return cleverapps.Notification.create("messages:Product.PurchaseCancelled"),void this.close();var t=function(){
cleverapps.subscription.onBuySubscription(e),this.close()}.bind(this);cleverapps.subscription.isDebugNoPayments()?t():e.buy(t)}.bind(this),this.onClaimClicked=function(){this.close()}.bind(this);var e={name:"SubscriptionWindow",content:this.createContent(),styles:this.windowStyles};"olympics"===cleverapps.config.name&&(e.windowBg=bundles.windows.frames.window_gold_bg_png),cleverapps.styles.SubscriptionWindow.window.Title&&(e.title={text:"messages:SubscriptionWindow.Title",font:cleverapps.styles.FONTS.SUBSCRIPTION_WINDOW_TITLE_TEXT||cleverapps.styles.FONTS.WINDOW_TITLE_TEXT}),this._super(e),cleverapps.audio.playSound(bundles.main.urls.window_effect),cleverapps.subscription.isActive()||cleverapps.eventLogger.logEvent(cleverapps.EVENTS.SUBSCRIPTION_WINDOW_OPEN),Lottery.addText(this)},onClose:function(){cleverapps.subscription.isRewardReady()&&new SubscriptionRewardWindow},onShow:function(){var e=cleverapps.styles.SubscriptionWindow;e.animation.person.open?(
this.personAnimation.setAnimation(0,e.animation.person.open,!1),this.personAnimation.setCompleteListener(function(){this.personAnimation.setAnimation(0,e.animation.person.idle,!0)}.bind(this))):this.personAnimation.setAnimation(0,e.animation.person.idle,!0),this.prizesView.onShow&&this.prizesView.onShow()},createContent:function(){var e=cleverapps.styles.SubscriptionWindow;this.windowStyles=cleverapps.overrideStyles(cleverapps.styles.Window,cleverapps.styles.SubscriptionWindow.window,!0),this.personAnimation=new cleverapps.Spine(bundles.subscription_window.jsons.subscription_json||e.animation.person.json,e.animation.person.scale),this.personAnimationNode=new cc.Node,this.personAnimationNode.setLocalZOrder(e.animation.person.zOrder),this.personAnimationNode.addChild(this.personAnimation),"match3"===cleverapps.config.type?this.prizesView=new SubscriptionPrize(this):this.prizesView=new GoldBasedPrize(this);var t=cleverapps.subscription.isActive(),
n=t&&cleverapps.subscription.isRewardReady(),s=t&&!n,i=[];if("ios"===cleverapps.User.calcSource()){var o=new Terms;if(i.push(o),o.width>.9*this.prizesView.width&&o.setScale(.9*this.prizesView.width/o.width),!cleverapps.subscription.isActive()){var r=new Restore;i.push(r),r.setScale(o.getScale())}}i.push(new SubscriptionButtons({isActive:t,prizesLayoutWidth:this.prizesView.width,monthProduct:this.monthProduct,weekProduct:this.weekProduct,buySubscription:this.buySubscription,onClaimClicked:this.onClaimClicked})),i.push(new SubscriptionInfo({isRewardReady:n,isTimerActive:s,availableTextWidth:this.prizesView.width,close:this.close.bind(this)})),i.push(this.prizesView),(e.window.noBackground||"scramble"===cleverapps.config.name)&&(this.personAnimationNode.setAnchorPoint2(),this.personAnimationNode.setContentSize(e.animation.person.size),this.personAnimation.setPositionRound(e.animation.person.position),i.push(this.personAnimationNode)),
e.animation.person.offset&&this.personAnimation.setPositionRound(e.animation.person.offset[cleverapps.wideMode.mode]),e.animation.person.scales&&this.personAnimation.setScale(e.animation.person.scales[cleverapps.wideMode.mode]);var a=new cleverapps.Layout(i,{direction:cleverapps.UI.VERTICAL,padding:e.contentPadding,margin:e.contentItemsMargin});return a.setLocalZOrder(5),e.window.noBackground||"scramble"===cleverapps.config.name||("tripeaks"===cleverapps.config.name?(this.addChild(this.personAnimationNode),this.personAnimationNode.setPositionRound(e.animation.person.position[cleverapps.wideMode.mode])):(a.addChild(this.personAnimationNode),this.personAnimationNode.setPositionRound(e.animation.person.position))),a}});SubscriptionWindow.prototype.listBundles=function(){return["reward_icons","subscription_window"]},cleverapps.styles.SubscriptionWindow={contentItemsMargin:15,contentPadding:{x:64,y:140,isTop:!0},animation:{person:{position:{x:{align:"left",dx:344},y:{align:"top",dy:-142}},
json:bundles.subscription_window.jsons.subscription_window_star_json,open:"open",idle:"idle",scale:1,zOrder:0}},window:{Border:{x:0,y:30},Title:{}}};var SubscriptionRewardWindow=RewardWindow.extend({ctor:function(){this._super({reward:cleverapps.subscription.calcReward()})},onWindowLoaded:function(e){this._super({title:"messages:SubscriptionRewardWindow.title",name:"subscriptionrewardwindow",text:"messages:MiniGameRewardWindow.text",reward:e.reward,rewardName:"subscription"})},onReceiveReward:function(){cleverapps.eventLogger.logEvent(cleverapps.EVENTS.SUBSCRIPTION_REWARD)},receiveReward:function(){cleverapps.subscription.getReward()&&(this.onReceiveReward(),cleverapps.Chest.prototype._receiveReward(this.reward))}}),SubscriptionBonus=cc.Node.extend({ctor:function(){this._super(),this.setAnchorPoint2();var e=cleverapps.styles.SubscriptionBonus,t=new cc.Sprite(bundles.subscription_window.frames.subscription_badge_png);if(this.addChild(t),this.setContentSize2(t.getContentSize()),
this.setScale(e.scale),t.setPositionRound(this.width/2,this.height/2),e.backgroundAnimation){var n=new cleverapps.Spine(e.backgroundAnimation.json,e.backgroundAnimation.scale);n.setPositionRound(t.width/2,t.height/2),t.addChild(n,-1),n.setAnimation(0,e.backgroundAnimation.name,!0)}var s=new cc.Sprite(bundles.subscription_window.frames.subscription_plus_png);if(this.addChild(s),s.setPositionRound(e.plus),!e.description){var i=cleverapps.UI.generateTTFText("messages:UnlimitedLives.ThreeHours",cleverapps.styles.FONTS.WHITE_TEXT);this.addChild(i),i.setPositionRound(e.text),i.fitTo(e.text.width),i.setRotation(e.text.rotation)}this.setPositionRound(e)},getDescription:function(){var e=cleverapps.styles.SubscriptionBonus;if(e.description){var t=cleverapps.UI.generateTTFText("messages:UnlimitedLives.ThreeHoursShort",cleverapps.styles.FONTS.SUBSCRIPTION_WINDOW_GOLD_COIN_TEXT),n=new cc.Sprite(e.description.icon);return n.setScale(e.description.scale),n.setPositionRound(e.description),[n,t]}
return[]}});cleverapps.styles.SubscriptionBonus={x:{align:"center",dx:260},y:{align:"center",dy:-135},scale:1,plus:{x:{align:"center",dx:-74},y:{align:"center",dy:18}},text:{x:{align:"center",dx:-10},y:{align:"center",dy:-30},rotation:20,width:100}};var SubscriptionButtons=cleverapps.Layout.extend({ctor:function(e){var r=cleverapps.styles.SubscriptionButtons,a=cleverapps.User.calcSource();if(e.isActive)u=[new cleverapps.UI.Button({content:cleverapps.UI.generateTTFText("messages:OK",cleverapps.styles.FONTS.SUBSCRIPTION_BUTTON_TEXT),button_png:r.buttonOk.button_png,button_on_png:r.buttonOk.button_on_png,width:r.buttonWidth,maxWidth:r.buttonWidth,height:r.buttonHeight,onClicked:e.onClaimClicked})];else{var t=e.monthProduct.getCurrentPrice();"ios"===a&&(t=Messages.get("SubscriptionWindow.iosMonthButton",{price:e.monthProduct.getCurrentPrice()}));var n=new cleverapps.UI.Button({content:new ProductPriceView(e.monthProduct,{text:t,
font:cleverapps.styles.FONTS.SUBSCRIPTION_BUY_BUTTON_TEXT||cleverapps.styles.FONTS.SUBSCRIPTION_BUTTON_TEXT}),button_png:r.buttonPay.button_png,button_on_png:r.buttonPay.button_on_png,width:r.buttonWidth,maxWidth:r.buttonWidth,height:r.buttonHeight,contentPadding:1,contentOffset:r.contentOffset,onClicked:function(){e.buySubscription(e.monthProduct)}});if(Lottery.addIcon(n,"subscription"),n.lotteryIcon&&n.lotteryIcon.setScale(.7),cleverapps.subscription.canBuyTrial()){var s=Messages.get("ios"===a?"SubscriptionWindow.iosWeekButton":"SubscriptionWindow.Free",{price:e.weekProduct.getCurrentPrice()}),i=new cleverapps.UI.Button({content:new ProductPriceView(e.weekProduct,{text:s,font:cleverapps.styles.FONTS.SUBSCRIPTION_BUTTON_TEXT}),button_png:r.buttonTryFree.button_png,button_on_png:r.buttonTryFree.button_on_png,width:r.buttonWidth,maxWidth:r.buttonWidth,height:r.buttonHeight,contentPadding:1,onClicked:function(){e.buySubscription(e.weekProduct)}}),
o="messages:SubscriptionWindow.OneDayAdditional";0===e.weekProduct.trial.indexOf("3 day")&&(o="messages:SubscriptionWindow.ThreeDaysAdditional"),"ios"===a&&(o=Messages.get("SubscriptionWindow.iOSThreeDaysAdditional",{price:e.weekProduct.getCurrentPrice()}));var c=cleverapps.UI.generateTTFText(o,cleverapps.styles.FONTS.SUBSCRIPTION_BUTTON_ADDITIONAL_TEXT);c.setDimensions(r.buttonWidth,0);var l=cleverapps.UI.generateTTFText("ios"===a?"":"messages:SubscriptionWindow.MonthlyAdditional",cleverapps.styles.FONTS.SUBSCRIPTION_BUTTON_ADDITIONAL_TEXT);l.setDimensions(r.buttonWidth,0);var p=Math.max(l.getContentSize().height,c.getContentSize().height);c.setDimensions(r.buttonWidth,p),l.setDimensions(r.buttonWidth,p);var d=function(e,t,n){t.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER),t.setVerticalAlignment(cc.VERTICAL_TEXT_ALIGNMENT_CENTER);var s=[t,n];if("ios"===a){var i="subsWeek"===e.itemId?"messages:SubscriptionWindow.weekButtonTitle":"messages:SubscriptionWindow.monthButtonTitle",
o=cleverapps.UI.generateTTFText(i,cleverapps.styles.FONTS.SUBSCRIPTION_MAIN_TEXT);o.setDimensions(r.buttonWidth,0),o.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER),s.push(o)}return new cleverapps.Layout(s,{direction:cleverapps.UI.VERTICAL,margin:r.contentObjectsMargin})},u=[d(e.weekProduct,c,i),d(e.monthProduct,l,n)],h=r.buttonsMargin||Math.max(4*r.contentObjectsMargin,e.prizesLayoutWidth-2*r.buttonWidth)}else var u=[n]}this._super(u,{direction:cleverapps.UI.HORIZONTAL,margin:h})}});cleverapps.styles.SubscriptionButtons={height:100,contentObjectsMargin:7,buttonWidth:270,buttonHeight:100,buttonTryFree:{button_png:bundles.buttons.frames.green_button_png,button_on_png:bundles.buttons.frames.green_button_on_png},buttonPay:{button_png:bundles.buttons_main.frames.blue_button_png,button_on_png:bundles.buttons_main.frames.blue_button_on_png},buttonOk:{button_png:bundles.buttons.frames.window_button_png,button_on_png:bundles.buttons.frames.window_button_on_png}}
;var SubscriptionPrize=cc.Node.extend({ctor:function(){this._super();var e=cleverapps.styles.SubscriptionPrize,t=new cc.Node;t.setContentSize2(e.prizesLayout.size.width,e.prizesLayout.size.height),t.setAnchorPoint(0,0);var n=cleverapps.UI.generateTTFText("messages:SubscriptionWindow.AnimationMainText",cleverapps.styles.FONTS.SUBSCRIPTION_OFFERS_MAIN_TEXT);n.setDimensions(e.animation.everyDayTextWidth,0),n.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER),t.addChild(n),n.setAnchorPoint2(),n.setPositionRound(e.prizesLayout.everyDayTextPosition);var s=[cleverapps.UI.generateTTFText("messages:SubscriptionWindow.AnimationLeftText",cleverapps.styles.FONTS.SUBSCRIPTION_OFFERS_TEXT)];s.push(cleverapps.UI.generateTTFText("messages:SubscriptionWindow.AnimationLeftMiddleText",cleverapps.styles.FONTS.SUBSCRIPTION_OFFERS_TEXT));var i=[cleverapps.UI.generateTTFText("messages:SubscriptionWindow.AnimationRightText",cleverapps.styles.FONTS.SUBSCRIPTION_OFFERS_TEXT)];i.push(cleverapps.UI.generateTTFText(
"messages:SubscriptionWindow.UnlimitedLivesTwoHourText",cleverapps.styles.FONTS.SUBSCRIPTION_OFFERS_TEXT));for(var o=[s,i],r=[],a=0;a<o.length;a++){for(var c=[],l=0;l<o[a].length;l++){var p=o[a][l];e.prizesLayout.fitTo&&p.fitTo(e.prizesLayout.fitTo),p.setDimensions(e.animation.oneBoosterTextWidth,0),p.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER),c.push(new cleverapps.Layout([p],{direction:cleverapps.UI.VERTICAL,margin:e.contentObjectsMargin}))}r.push(new cleverapps.Layout(c,{direction:cleverapps.UI.HORIZONTAL,margin:3*e.contentObjectsMargin})),t.addChild(r[a]),r[a].setAnchorPoint2()}r[0].setPositionRound(e.prizesLayout.topBoostersPrizeTextPosition),r[1].setPositionRound(e.prizesLayout.bottomBoostersPrizeTextPosition),this.boostersAnimation=new cleverapps.Spine(e.animation.boosters.json,e.animation.boosters.scale),this.boostersAnimationNode=new cc.Node,this.boostersAnimationNode.addChild(this.boostersAnimation),this.boostersAnimationNode.setContentSize2(e.animation.boosters.width,
e.animation.boosters.height),this.boostersAnimationNode.setAnchorPoint2(),t.addChild(this.boostersAnimationNode),this.boostersAnimationNode.setPositionRound(e.prizesLayout.boostersPrizeAnimationPosition),this.boostersAnimationNode.setLocalZOrder(-1);var d=cleverapps.UI.createScale9Sprite(e.animation.background.image,cleverapps.UI.Scale9Rect.TwoPixelXY);d.setContentSize(t.width,t.height),d.setAnchorPoint(0,0),d.addChild(t),this.setAnchorPoint(.5,.5),this.addChild(d),this.setContentSize(d.getContentSize())},onShow:function(){var e=cleverapps.styles.SubscriptionPrize;this.boostersAnimation.setAnimation(0,e.animation.boosters.open,!1),this.boostersAnimation.setCompleteListener(function(){this.boostersAnimation.setAnimation(0,e.animation.boosters.idle,!0)}.bind(this))}});cleverapps.styles.SubscriptionPrize={contentObjectsMargin:7,animation:{background:{image:bundles.subscription_window.frames.premium_bg},oneBoosterTextWidth:154,everyDayTextWidth:350,boosters:{
json:bundles.subscription_window.jsons.subscription_window_boosters_json,open:"open",idle:"idle",scale:1,width:529,height:148}},prizesLayout:{size:{width:550,height:520},boostersPrizeAnimationPosition:{x:{align:"center",dx:90},y:{align:"center",dy:30}},everyDayTextPosition:{x:{align:"center"},y:{align:"top",dy:-20}},topBoostersPrizeTextPosition:{x:{align:"center"},y:{align:"top",dy:-110}},bottomBoostersPrizeTextPosition:{x:{align:"center"},y:{align:"bottom",dy:155}},fitTo:273}};var SubscriptionInfo=cleverapps.Layout.extend({ctor:function(e){var t=cleverapps.styles.SubscriptionInfo,n={text:"messages:SubscriptionWindow.MainText",font:cleverapps.styles.FONTS.SUBSCRIPTION_MAIN_TEXT};e.isRewardReady&&(n={text:"messages:SubscriptionWindow.RewardIsReadyText",font:cleverapps.styles.FONTS.SUBSCRIPTION_REWARD_READY_TEXT}),e.isTimerActive&&(n={text:"messages:SubscriptionWindow.RewardTimerText",font:cleverapps.styles.FONTS.SUBSCRIPTION_REWARD_READY_TEXT});var s=cleverapps.UI.generateTTFText(n.text
,n.font),i=[s];if(e.isTimerActive){var o=cleverapps.UI.createScale9Sprite(bundles.main.frames.timer_bg_png);o.setContentSize2(t.timer),i.push(new cleverapps.CountDownView(new cleverapps.CountDown(cleverapps.subscription.getLeftTime(),{onFinish:function(){e.close()}}),{background_content:o,font:cleverapps.styles.FONTS.SUBSCRIPTION_TIMER_TEXT,timerPosition:{x:0,y:t.timer.textYShift}}))}else s.setDimensions(e.availableTextWidth,0),s.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER);t.direction===cleverapps.UI.VERTICAL&&i.reverse(),this._super(i,{direction:t.direction,margin:3*t.contentObjectsMargin})}});cleverapps.overrideFonts(cleverapps.styles.FONTS,{SUBSCRIPTION_TIMER_TEXT:{size:36,color:cleverapps.styles.COLORS.WHITE,stroke:cleverapps.styles.DECORATORS.IMAGE_FONT_STROKE}}),cleverapps.styles.SubscriptionInfo={contentObjectsMargin:7,direction:cleverapps.UI.HORIZONTAL,timer:{width:210,height:50,textYShift:-3}};var GoldBasedPrize=cc.Node.extend({ctor:function(e){this._super(),this.window=e
;var t=cleverapps.styles.GoldBasedPrize;if(this.setAnchorPoint2(),this.setContentSize2(t),"stacks"!==cleverapps.config.subtype){var n=this.createGoldBlock();this.addChild(n)}var s,i=[];s=-1!==["differences","scramble","tripeaks","wordheaps"].indexOf(cleverapps.config.name)?this.createRewardsGrid():this.createGold(),i.push(s);var o=cleverapps.UI.generateOnlyText("messages:SubscriptionWindow.AnimationMainText",cleverapps.styles.FONTS.SUBSCRIPTION_WINDOW_GOLD_OFFER_TEXT);o.fitTo(t.everyDayText.width,0),o.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER),i.push(o);var r=new cleverapps.Layout(i,{direction:cleverapps.UI.VERTICAL,margin:t.everyDayText.margin});r.setPositionRound(t.position);var a=this.bg=cleverapps.UI.createScale9Sprite(bundles.subscription_window.frames.subscription_ribbon_png||bundles.main.frames.ribbon,cleverapps.UI.Scale9Rect.TwoPixelXY);a.setAnchorPoint2(0,0),a.setContentSize2(t.goldRibbonBg),a.addChild(r),t.goldRibbonBg.dx&&(a.x+=t.goldRibbonBg.dx),this.addChild(a),
this.bonus&&this.addChild(this.bonus)},createGold:function(){var e=cleverapps.styles.GoldBasedPrize,t=cleverapps.UI.generateImageText(cleverapps.subscription.calcReward().gold,cleverapps.styles.FONTS.SUBSCRIPTION_WINDOW_GOLD_COIN_TEXT),n=new cc.Sprite(bundles.reward_icons.frames.gold_small_png);n.setScale(e.goldAmount.icon.scale);var s=[n,t];return-1!==["olympics"].indexOf(cleverapps.config.name)&&(this.bonus=new SubscriptionBonus,this.bonus.getDescription().forEach(function(e){s.push(e)})),new cleverapps.Layout(s,{direction:cleverapps.UI.HORIZONTAL,margin:e.goldAmount.margin})},createRewardsGrid:function(){var i=cleverapps.styles.GoldBasedPrize,e=RewardsHelper.getDisplayData(cleverapps.subscription.calcReward(),{itemsPrefix:"x"}),t=cleverapps.values(e).map(function(e){return function(e,t){var n=new cc.Sprite(e);cleverapps.UI.fitToBox(n,i.prizes.icon),n.setPositionY(n.getPositionY()+i.prizes.icon.dy);var s=cleverapps.UI.generateTTFText(t,
cleverapps.styles.FONTS.SUBSCRIPTION_WINDOW_GOLD_COIN_TEXT);return new cleverapps.Layout([n,s],{direction:cleverapps.UI.HORIZONTAL,margin:i.prizes.margin})}(e.img,e.txt)}),n=[],s=2;"scramble"===cleverapps.config.name&&(s=4);var o=new cleverapps.Layout(t.splice(0,s),{direction:cleverapps.UI.HORIZONTAL,margin:i.prizes.marginCol});if(n.push(o),0<t.length){var r=new cleverapps.Layout(t,{direction:cleverapps.UI.HORIZONTAL,margin:i.prizes.marginCol});n.push(r)}return i.prizes.boostersBelow&&n.reverse(),new cleverapps.Layout(n,{direction:cleverapps.UI.VERTICAL,margin:i.prizes.marginRow})},createGoldBlock:function(){var e=cleverapps.styles.GoldBasedPrize,t=new cc.Node;t.setAnchorPoint2();var n=new cc.Sprite(bundles.subscription_window.frames.prize_icon);t.setContentSize2(n.getContentSize());var s=new cleverapps.Spine(bundles.main.jsons.reward_spine_json,e.gold.backgroundAnimation.scale);return s.setPositionRound(e.gold.backgroundAnimation.position),t.addChild(s,-1),s.setAnimation(0,"animation"
,!0),n.setPositionRound(t.width/2,t.height/2),t.addChild(n),t.setPositionRound(e.gold.position),t}});cleverapps.styles.GoldBasedPrize={width:600,height:500,gold:{animation:!1,backgroundAnimation:{scale:.7,position:{x:{align:"center"},y:{align:"center"}}},margin:0,position:{x:{align:"right",dx:0},y:{align:"top",dy:-70}}},goldRibbonBg:{scaleY:1.4,height:204,width:766},goldAmount:{icon:{scale:1.5},margin:10},position:{x:500,y:100},everyDayText:{margin:-4,width:400}};var BonusWorld=function(e,t){this.mission=e,(this.mission.bonusWorld=this).type=t,this.config=BonusWorldConfig[this.type],this.bundle=bundles[this.config.bundle],cleverapps.EventEmitter.call(this)};BonusWorld.prototype=Object.create(cleverapps.EventEmitter.prototype),(BonusWorld.prototype.constructor=BonusWorld).prototype.backgroundBundleId=function(){return cleverapps.isInstant()&&bundles[this.config.bundle+"_background_instant"]?this.config.bundle+"_background_instant":this.config.bundle+"_background"},
BonusWorld.prototype.isFinished=function(){return this.mission.result===Episode.LEVELS_PER_EPISODE||!this.mission.isRunning()},BonusWorld.prototype.finish=function(e){this.mission.complete(),cleverapps.metha.compound(e,[function(e){new TellWindow({text:"messages:"+this.config.localizationPrefix+".BonusWorldFinishWindow.Text",title:"messages:"+this.config.localizationPrefix+".BonusWorldFinishWindow.Title",buttonText:Messages.get("OK")}),cleverapps.metha.onceNoWindowsListener=e}.bind(this),function(e){cleverapps.metha.gotoMainScene(e)}])},BonusWorld.prototype.onLevelPassed=function(e){this.isCurrentLevel(e)&&(cleverapps.eventLogger.logEvent(cleverapps.EVENTS.BONUS_WORLD_LEVEL+"_"+this.type+"_"+this.getProgress()),cleverapps.playSession.set(cleverapps.EVENTS.BONUS_WORLD_LEVEL_DAU,!0),this.mission.update(1),this.levelPassed=!0)},BonusWorld.prototype.animateChangeProgress=function(){this.levelPassed=!1,this.trigger("changeProgress")},BonusWorld.prototype.getProgress=function(){
return this.mission.result},BonusWorld.prototype.isCurrentLevel=function(e){return e.levelNo===this.getProgress()},BonusWorld.prototype.getAvailableReward=function(){for(var e=0;e<RewardsConfig.BonusWorld.length;e++)if(this.getProgress()>=RewardsConfig.BonusWorld[e].level&&!this.isRewardReceived(RewardsConfig.BonusWorld[e]))return RewardsConfig.BonusWorld[e]},BonusWorld.prototype.isRewardReceived=function(e){return(this.mission.details.receivedRewards||{})[e.level]},BonusWorld.prototype.giveReward=function(e){var n=this.getAvailableReward();n?cleverapps.metha.compound(e,[function(e){this.trigger("giveReward",n,e)}.bind(this),function(e){new RewardWindow({reward:n.reward}),cleverapps.metha.onceNoWindowsListener=e},function(e){var t=this.mission.details.receivedRewards||{};t[n.level]=!0,this.mission.update(0,cleverapps.extend(this.mission.details,{receivedRewards:t})),e()}.bind(this)]):e()};var BonusWorldLevel=function(e,t){this.bonusWorld=e,this.levelNo=t,this.type=this.calcType(),
this.bonusWorld.on("changeProgress",this.onChangeProgress.bind(this)),cleverapps.EventEmitter.call(this)};BonusWorldLevel.prototype=Object.create(cleverapps.EventEmitter.prototype),(BonusWorldLevel.prototype.constructor=BonusWorldLevel).prototype.calcType=function(){var e=this.bonusWorld.getProgress();return this.bonusWorld.levelPassed&&e--,this.levelNo<e?BonusWorldLevel.TYPE_PASSED:e===this.levelNo?BonusWorldLevel.TYPE_CURRENT:BonusWorldLevel.TYPE_NOT_PASSED},BonusWorldLevel.prototype.setType=function(e){this.type=e,this.trigger("changeType")},BonusWorldLevel.prototype.onChangeProgress=function(){this.bonusWorld.getProgress()!==this.levelNo&&this.bonusWorld.getProgress()-1!==this.levelNo||this.setType(this.calcType())},BonusWorldLevel.prototype.onClick=function(){new Episode(BonusWorldConfig[this.bonusWorld.type].episode,this.levelNo,{type:Episode.Types.BONUS_WORLD}).getLevel().onPressed()},BonusWorldLevel.TYPE_PASSED=0,BonusWorldLevel.TYPE_CURRENT=1,BonusWorldLevel.TYPE_NOT_PASSED=2
;var BonusWorldMissionLogic=function(e,t){this.mission=e;var n=cleverapps.eventManager.getFeatureEvent("bonusworld").options.bonusWorldType;this.bonusWorld=new BonusWorld(e,n),this.mission.iconForce.text="messages:"+this.bonusWorld.config.localizationPrefix+".BonusWorld.Force",t&&(this.clearSavedGames(),cleverapps.forces.clearForce(Forces.BONUS_WORLD.id))};BonusWorldMissionLogic.prototype.hasIntent=function(){return!0},BonusWorldMissionLogic.prototype.willUseIntent=function(e){return e.episode.isBonusWorldLevel()},BonusWorldMissionLogic.prototype.processEvent=function(e,t){e===Mission.EVENT_LEVEL_FINISH&&t.level.episode.isBonusWorldLevel()&&this.bonusWorld.onLevelPassed(t.level)},BonusWorldMissionLogic.prototype.clearSavedGames=function(){for(var e=0;e<Episode.LEVELS_PER_EPISODE;e++)cleverapps.GameSaver.removeSave(GameBase.getStoreKey({episode:{episodeNo:BonusWorldConfig[this.bonusWorld.type].episode},levelNo:e}))},BonusWorld.TYPE_VALENTINES="valentines",BonusWorld.TYPE_EASTER="easter"
,BonusWorld.TYPE_SUMMER="summer";var BonusWorldConfig={};BonusWorldConfig[BonusWorld.TYPE_VALENTINES]={bundle:"bonus_world_valentines",episode:"bonus_world_valentines",sideBarJson:bundles.sidebar.jsons.bonus_world_valentines_icon_json,localizationPrefix:"Valentines"},BonusWorldConfig[BonusWorld.TYPE_EASTER]={bundle:"bonus_world_easter",episode:"bonus_world_easter",sideBarJson:bundles.sidebar.jsons.bonus_world_easter_icon_json,localizationPrefix:"Easter"},BonusWorldConfig[BonusWorld.TYPE_SUMMER]={bundle:"bonus_world_summer",episode:"bonus_world_summer",sideBarJson:bundles.sidebar.jsons.bonus_world_summer_icon_json,localizationPrefix:"Summer"};var BonusWorldLockedIcon=function(){this.featureEvent=cleverapps.eventManager.getNextFeatureEvent(Missions[Mission.TYPE_BONUS_WORLD].feature),SideBarIcon.call(this,{})};BonusWorldLockedIcon.prototype=Object.create(SideBarIcon.prototype),(BonusWorldLockedIcon.prototype.constructor=BonusWorldLockedIcon).prototype.resetState=function(){if(
this.available=!1,-1!==cleverapps.missionManager.getProjectAvailableTypes().indexOf(Mission.TYPE_BONUS_WORLD)&&cleverapps.user.checkAvailable(Missions[Mission.TYPE_BONUS_WORLD].available,{future:!0})){var e=Missions[Mission.TYPE_BONUS_WORLD].feature;if(-1===cleverapps.eventManager.listCurrentFeatures().indexOf(e)&&this.featureEvent){var t=this.featureEvent.getTimeBeforeStart();t>BonusWorldLockedIcon.TIME_BEFORE_EVENT||(this.available=!0,t<=0?(this.setLeftTime(0),this.setLocked(!1)):(this.setAnimation(BonusWorldConfig[this.featureEvent.options.bonusWorldType].sideBarJson),this.setLocked(!0),this.setAttention(!1),this.setLeftTime(t)))}}},BonusWorldLockedIcon.prototype.onPressed=function(){this.removeFromSideBar(),cleverapps.metha.display({focus:"reloadMainScene",action:function(e){cleverapps.metha.gotoMainScene(e)}})},BonusWorldLockedIcon.prototype.getLockedTip=function(){return Messages.get("IconLocked.TipTimer")},BonusWorldLockedIcon.TIME_BEFORE_EVENT=cleverapps.parseInterval("7 days")
;var BonusWorldScene=cleverapps.FixedWidthScene.extend({ctor:function(e){this.bonusWorld=e.bonusWorld,this._super(cleverapps.Environment.SCENE_BONUS_WORLD);for(var t=0;t<Episode.LEVELS_PER_EPISODE;t++)new BonusWorldLevelView(new BonusWorldLevel(this.bonusWorld,t),this.scene);this.scene.addChild(new BonusWorldRewardsView(this.bonusWorld)),cleverapps.environment.episodeNo=this.bonusWorld.config.episode,cleverapps.playSession.set(cleverapps.EVENTS.BONUS_WORLD_DAU,!0)},onExit:function(){this._super(),this.bonusWorld.purge()},getBackgroundStyles:function(){return{background:bundles[this.bonusWorld.backgroundBundleId()].urls.background,animation:bundles[this.bonusWorld.backgroundBundleId()].jsons.background_spine}},getAudioStyles:function(){return{res:bundles[this.bonusWorld.backgroundBundleId()].urls.music,delay:1}}});BonusWorldScene.BUNDLES=function(e){var t=[BonusWorldConfig[e.bonusWorld.type].bundle];return t.push(e.bonusWorld.backgroundBundleId()),t}
;var BonusWorldLevelView=cc.Node.extend({ctor:function(e,t){this._super(),this.level=e,this.styles=cleverapps.styles.BonusWorldLevelView[this.level.bonusWorld.type],this.setAnchorPoint2(),this.setContentSize2(this.styles),this.setLocalZOrder(Episode.LEVELS_PER_EPISODE-this.level.levelNo),this.createBg(),this.createText(),this.level.type===BonusWorldLevel.TYPE_CURRENT&&this.createIndicator(),t.addChild(this),this.setPositionRound(this.styles.levels[this.level.levelNo]),this.onChangeType(),this.registerTarget(this.styles,"targetLevel"+this.level.levelNo),this.level.on("changeType",this.createListener(this.animateChangeType.bind(this)))},createTooltip:function(){cleverapps.tooltipManager.create(this,{text:this.level.type===BonusWorldLevel.TYPE_NOT_PASSED?"messages:BonusWorldNotPassedLevelTooltip":"messages:BonusWorldPassedLevelTooltip",position:3<=this.level.levelNo?cleverapps.styles.UI.Tooltip.LOCATION.below:cleverapps.styles.UI.Tooltip.LOCATION.above})},createFinger:function(){
this.finger=new FingerView({control:"bonus_world_finger"}),this.finger.setLocalZOrder(20),this.getParent().addChild(this.finger),this.finger.setPositionRound(this.styles.levels[this.level.levelNo]),this.finger.delay(5),this.finger.fadeIn({x:0,y:0}),this.finger.press(),this.finger.delay(.3),this.finger.unPress(),this.finger.delay(.1),this.finger.press(),this.finger.delay(.3),this.finger.unPress(),this.finger.fadeOut(),this.finger.run({looped:!0})},createBg:function(){var e=this.level.bonusWorld.bundle.jsons.level_json,t=1;this.styles.levels[this.level.levelNo].scaleX&&(e=this.level.bonusWorld.bundle.jsons.level_2_json,t=this.styles.levels[this.level.levelNo].scaleX),this.bg=new cleverapps.Spine(e),this.addChild(this.bg),this.bg.setPositionRound(this.width/2,this.height/2),this.styles.skins&&this.bg.setSkin("skin_"+this.level.levelNo%this.styles.skins),this.bg.setScaleX(t);var n="current";this.level.type===BonusWorldLevel.TYPE_PASSED&&(n="passed"),
this.level.type===BonusWorldLevel.TYPE_NOT_PASSED&&(n="not_passed"),this.bg.setAnimation(0,n,!0)},createIndicator:function(){if(this.styles.indicator){var e=this.indicator=new cleverapps.Spine(this.level.bonusWorld.bundle.jsons.level_indicator);this.addChild(e),e.setPositionRound(this.width/2,this.height/2),e.setAnimation(0,this.getIndicatorAnimation("idle"),!0)}},createText:function(){this.styles.skinNumbers?this.level.type!==BonusWorldLevel.TYPE_PASSED&&this.bg.setSkin(""+this.level.levelNo):(this.text=cleverapps.UI.generateImageText(this.level.levelNo+1,cleverapps.styles.FONTS.BONUS_WORLD_LEVEL_TEXT),this.addChild(this.text),this.text.setPositionRound(this.styles.text))},onChangeType:function(){this.onClickListener&&(cc.eventManager.removeListener(this.onClickListener),delete this.onClickListener),cleverapps.UI.removeHover(this),cleverapps.tooltipManager.remove(this),this.finger&&this.finger.removeFromParent(),this.level.type===BonusWorldLevel.TYPE_PASSED&&this.createTooltip(),
this.level.type===BonusWorldLevel.TYPE_CURRENT&&(cleverapps.UI.applyHover(this),this.onClickListener=cleverapps.UI.onClick(this,this.onClick.bind(this)),this.createFinger()),this.level.type===BonusWorldLevel.TYPE_NOT_PASSED&&this.createTooltip()},animateChangeType:function(){this.styles.indicator?this.animateIndicatorChange():(this.level.type===BonusWorldLevel.TYPE_CURRENT&&this.bg.setAnimationAndIdleAfter("np-c","current"),this.level.type===BonusWorldLevel.TYPE_PASSED&&(this.bg.setAnimationAndIdleAfter("c-p","passed"),this.runAction(new cc.Sequence(new cc.DelayTime(1),new cc.PlaySound(this.level.bonusWorld.bundle.urls.pass_level_effect))))),this.onChangeType()},animateIndicatorChange:function(){if(this.level.type===BonusWorldLevel.TYPE_CURRENT){var e=this.styles["targetLevel"+(this.level.levelNo-1)],t=cc.p(this.width/2,this.height/2),n=this.indicator=e.indicator;delete e.indicator,n.replaceParentSamePlace(this),n.setAnimation(0,this.getIndicatorAnimation("animation"),!1),
cleverapps.audio.playSound(this.level.bonusWorld.bundle.urls.jump_sfx),this.bg.setAnimation(0,"np-c",!1),n.runAction(new cc.Sequence(new cc.JumpTo(this.styles.delay,t,this.styles.jumpHeight,1),new cc.CallFunc(function(){n.setAnimation(0,this.getIndicatorAnimation("idle"),!0),this.bg.setAnimation(0,"current",!0)}.bind(this))))}if(this.level.type===BonusWorldLevel.TYPE_PASSED&&(this.bg.setAnimationAndIdleAfter("c-p","passed"),this.level.levelNo===Episode.LEVELS_PER_EPISODE-1)){var s=cleverapps.styles.BonusWorldRewardsView[this.level.bonusWorld.type].finalPrizeTarget;this.indicator.replaceParentSamePlace(s),this.indicator.setAnimationAndIdleAfter("animation","idle_static");t=cc.p(s.width/2+this.styles.finalPrizePos.x,s.height/2+this.styles.finalPrizePos.y);this.indicator.runAction(new cc.JumpTo(this.styles.delay,t,this.styles.jumpHeight,1)),cleverapps.audio.playSound(this.level.bonusWorld.bundle.urls.jump_sfx)}},getIndicatorAnimation:function(e){return e+(
this.styles.levels[this.level.levelNo].invertIndicator?"_invert":"")},onClick:function(){this.level.onClick()}});cleverapps.overrideFonts(cleverapps.styles.FONTS,{BONUS_WORLD_LEVEL_TEXT:{name:"default",size:40}}),cleverapps.styles.BonusWorldLevelView={},cleverapps.styles.BonusWorldLevelView[BonusWorld.TYPE_VALENTINES]={width:130,height:100,text:{x:{align:"center"},y:{align:"center"}},levels:[{x:{align:"center",dx:-84},y:{align:"center",dy:-550}},{x:{align:"center",dx:53},y:{align:"center",dy:-600},scaleX:1},{x:{align:"center",dx:220},y:{align:"center",dy:-550},scaleX:-1},{x:{align:"center",dx:100},y:{align:"center",dy:-350}},{x:{align:"center",dx:-30},y:{align:"center",dy:-307},scaleX:-1},{x:{align:"center",dx:-190},y:{align:"center",dy:-300},scaleX:-1},{x:{align:"center",dx:-245},y:{align:"center",dy:-210}},{x:{align:"center",dx:-205},y:{align:"center",dy:-90},scaleX:-1},{x:{align:"center",dx:60},y:{align:"center",dy:-47},scaleX:1},{x:{align:"center",dx:210},y:{align:"center",dy:-10}}
,{x:{align:"center",dx:200},y:{align:"center",dy:110},scaleX:-1},{x:{align:"center",dx:30},y:{align:"center",dy:135}},{x:{align:"center",dx:-130},y:{align:"center",dy:159},scaleX:-1},{x:{align:"center",dx:-190},y:{align:"center",dy:280},scaleX:1},{x:{align:"center",dx:-80},y:{align:"center",dy:370},scaleX:1}]},cleverapps.styles.BonusWorldLevelView[BonusWorld.TYPE_EASTER]={width:130,height:160,skins:3,text:{x:{align:"center"},y:{align:"center",dy:10}},levels:[{x:{align:"center",dx:-149},y:{align:"center",dy:-490}},{x:{align:"center",dx:12},y:{align:"center",dy:-515}},{x:{align:"center",dx:159},y:{align:"center",dy:-470}},{x:{align:"center",dx:97},y:{align:"center",dy:-314}},{x:{align:"center",dx:-48},y:{align:"center",dy:-320}},{x:{align:"center",dx:-194},y:{align:"center",dy:-305}},{x:{align:"center",dx:-256},y:{align:"center",dy:-198}},{x:{align:"center",dx:-253},y:{align:"center",dy:-68}},{x:{align:"center",dx:-113},y:{align:"center",dy:10}},{x:{align:"center",dx:54},y:{
align:"center",dy:-19}},{x:{align:"center",dx:190},y:{align:"center",dy:7}},{x:{align:"center",dx:99},y:{align:"center",dy:102}},{x:{align:"center",dx:-29},y:{align:"center",dy:149}},{x:{align:"center",dx:-148},y:{align:"center",dy:241}},{x:{align:"center",dx:-125},y:{align:"center",dy:363}}]},cleverapps.styles.BonusWorldLevelView[BonusWorld.TYPE_SUMMER]={width:75,height:105,skinNumbers:!0,indicator:!0,jumpHeight:60,delay:.99,text:{x:{align:"center"},y:{align:"center"}},finalPrizePos:{x:-10,y:50},levels:[{x:{align:"center",dx:-224},y:{align:"center",dy:-551}},{x:{align:"center",dx:-115},y:{align:"center",dy:-445}},{x:{align:"center",dx:-41},y:{align:"center",dy:-347}},{x:{align:"center",dx:89},y:{align:"center",dy:-298}},{x:{align:"center",dx:211},y:{align:"center",dy:-252}},{x:{align:"center",dx:273},y:{align:"center",dy:-175}},{invertIndicator:!0,x:{align:"center",dx:179},y:{align:"center",dy:-119}},{invertIndicator:!0,x:{align:"center",dx:43},y:{align:"center",dy:-81}},{
invertIndicator:!0,x:{align:"center",dx:-95},y:{align:"center",dy:-67}},{invertIndicator:!0,x:{align:"center",dx:-225},y:{align:"center",dy:-31}},{x:{align:"center",dx:-132},y:{align:"center",dy:47}},{x:{align:"center",dx:-31},y:{align:"center",dy:104}},{x:{align:"center",dx:74},y:{align:"center",dy:140}},{invertIndicator:!0,x:{align:"center",dx:17},y:{align:"center",dy:206}},{invertIndicator:!0,x:{align:"center",dx:-74},y:{align:"center",dy:255}}]},"riddles"===cleverapps.config.name&&(cleverapps.styles.BonusWorldLevelView[BonusWorld.TYPE_SUMMER]={width:85,height:85,skinNumbers:!0,indicator:!0,jumpHeight:50,delay:.4,finalPrizePos:{x:0,y:0},text:{x:{align:"center"},y:{align:"center"}},levels:[{x:{align:"center",dx:38},y:{align:"center",dy:-523},invertIndicator:!0},{x:{align:"center",dx:-56},y:{align:"center",dy:-488},invertIndicator:!0},{x:{align:"center",dx:-138},y:{align:"center",dy:-437},invertIndicator:!0},{x:{align:"center",dx:-211},y:{align:"center",dy:-363},invertIndicator:!0},{
x:{align:"center",dx:-262},y:{align:"center",dy:-275},invertIndicator:!0},{x:{align:"center",dx:-198},y:{align:"center",dy:-193}},{x:{align:"center",dx:-87},y:{align:"center",dy:-170}},{x:{align:"center",dx:35},y:{align:"center",dy:-150}},{x:{align:"center",dx:268},y:{align:"center",dy:-70}},{x:{align:"center",dx:220},y:{align:"center",dy:14},invertIndicator:!0},{x:{align:"center",dx:141},y:{align:"center",dy:84},invertIndicator:!0},{x:{align:"center",dx:73},y:{align:"center",dy:164},invertIndicator:!0},{x:{align:"center",dx:-36},y:{align:"center",dy:201},invertIndicator:!0},{x:{align:"center",dx:-115},y:{align:"center",dy:259},invertIndicator:!0},{x:{align:"center",dx:-174},y:{align:"center",dy:337},invertIndicator:!0}]}),"scramble"===cleverapps.config.name&&(cleverapps.styles.BonusWorldLevelView[BonusWorld.TYPE_SUMMER]={skins:2,width:80,height:70,text:{x:{align:"center",dx:2},y:{align:"center",dy:2}},levels:[{x:{align:"center",dx:-50},y:{align:"center",dy:-455}},{x:{align:"center",
dx:41},y:{align:"center",dy:-389}},{x:{align:"center",dx:145},y:{align:"center",dy:-345}},{x:{align:"center",dx:58},y:{align:"center",dy:-245}},{x:{align:"center",dx:-75},y:{align:"center",dy:-230}},{x:{align:"center",dx:-176},y:{align:"center",dy:-177}},{x:{align:"center",dx:-154},y:{align:"center",dy:-82}},{x:{align:"center",dx:-32},y:{align:"center",dy:-63}},{x:{align:"center",dx:190},y:{align:"center",dy:29}},{x:{align:"center",dx:59},y:{align:"center",dy:80}},{x:{align:"center",dx:-68},y:{align:"center",dy:92}},{x:{align:"center",dx:-164},y:{align:"center",dy:163}},{x:{align:"center",dx:-46},y:{align:"center",dy:202}},{x:{align:"center",dx:70},y:{align:"center",dy:247}},{x:{align:"center",dx:186},y:{align:"center",dy:283}}]});var BonusWorldRewardsView=cc.Node.extend({ctor:function(e){this._super(),this.bonusWorld=e,this.setAnchorPoint2(),this.styles=cleverapps.styles.BonusWorldRewardsView[this.bonusWorld.type],this.setPositionRound({x:{align:"center"},y:{align:"center"}}),
this.rewards=RewardsConfig.BonusWorld.map(function(e,t){var n=this.bonusWorld.isRewardReceived(e),s=new cc.Node;this.addChild(s),s.setAnchorPoint2(),s.setContentSize2(this.styles.prize),s.setPositionRound(this.styles.prizes[t]),n||(cleverapps.tooltipManager.create(s,{rewards:e.reward,text:"messages:"+this.bonusWorld.config.localizationPrefix+".BonusWorld.RewardTooltip",position:t<1?cleverapps.styles.UI.Tooltip.LOCATION.above:cleverapps.styles.UI.Tooltip.LOCATION.below}),cleverapps.UI.applyHover(s));var i=new cleverapps.Spine(this.bonusWorld.bundle.jsons.chest_json);return s.addChild(i),i.setAnimation(0,n?"idle_open":"idle",!0),i.setSkin("skin_"+t),i.setPositionRound(s.width/2,s.height/2),s.animation=i,t===RewardsConfig.BonusWorld.length-1&&s.registerTarget(this.styles,"finalPrizeTarget"),s},this),this.bonusWorld.on("giveReward",this.giveReward.bind(this))},giveReward:function(e,t){var n=this.rewards[RewardsConfig.BonusWorld.indexOf(e)];cleverapps.UI.removeHover(n),
cleverapps.tooltipManager.remove(n),cleverapps.audio.playSound(this.bonusWorld.bundle.urls.prize_sfx);var s=n.animation;s.setAnimation(0,"open",!1),s.setCompleteListener(function(){s.setAnimation(0,"idle_open",!0),s.setCompleteListener(function(){}),t()}.bind(this))}});cleverapps.styles.BonusWorldRewardsView={},cleverapps.styles.BonusWorldRewardsView[BonusWorld.TYPE_VALENTINES]={prize:{width:150,height:150},prizes:[{x:{align:"center",dx:220},y:{align:"center",dy:-430}},{x:{align:"center",dx:-71},y:{align:"center",dy:-60}},{x:{align:"center",dx:19},y:{align:"center",dy:441}}]},cleverapps.styles.BonusWorldRewardsView[BonusWorld.TYPE_EASTER]={prize:{width:150,height:150},prizes:[{x:{align:"center",dx:245},y:{align:"center",dy:-349}},{x:{align:"center",dx:-245},y:{align:"center",dy:85}},{x:{align:"center",dx:19},y:{align:"center",dy:476}}]},cleverapps.styles.BonusWorldRewardsView[BonusWorld.TYPE_SUMMER]={prize:{width:150,height:150},prizes:[{x:{align:"center",dx:144},y:{align:"center",
dy:-422}},{x:{align:"center",dx:203},y:{align:"center",dy:33}},{x:{align:"center",dx:22},y:{align:"center",dy:422}}]},"riddles"===cleverapps.config.name&&(cleverapps.styles.BonusWorldRewardsView[BonusWorld.TYPE_SUMMER]={prize:{width:90,height:90},prizes:[{x:{align:"center",dx:-251},y:{align:"center",dy:-467}},{x:{align:"center",dx:140},y:{align:"center",dy:-91}},{x:{align:"center",dx:-40},y:{align:"center",dy:373}}]}),"scramble"===cleverapps.config.name&&(cleverapps.styles.BonusWorldRewardsView[BonusWorld.TYPE_SUMMER]={prize:{width:110,height:110},prizes:[{x:{align:"center",dx:180},y:{align:"center",dy:-241}},{x:{align:"center",dx:98},y:{align:"center",dy:-41}},{x:{align:"center",dx:-10},y:{align:"center",dy:384}}]});var SlotMachine=function(e){cleverapps.EventEmitter.call(this),this.mission=e,(this.mission.slotMachine=this).reels=[];for(var t=0;t<SlotMachine.REELS_AMOUNT;t++)this.reels.push(new SlotMachineReel(SlotMachine.SYMBOLS)),this.reels[t].setCurrentByType(
cleverapps.Random.choose(SlotMachine.SYMBOLS).type)};SlotMachine.prototype=Object.create(cleverapps.EventEmitter.prototype),(SlotMachine.prototype.constructor=SlotMachine).prototype.isForceAvailable=function(){return!cleverapps.forces.isShown(Forces.SLOT_MACHINE.id)},SlotMachine.prototype.showForce=function(){this.trigger("showForce")},SlotMachine.prototype.spin=function(e){var s=this.calcPayline();this.trigger("spin"),cleverapps.metha.compound(e,[function(n){n=cleverapps.wait(this.reels.length,n),this.reels.forEach(function(e,t){setTimeout(function(){this.reels[t].spin(s[t],n)}.bind(this),t*SlotMachine.REEL_SPIN_DELAY)},this)}.bind(this),function(e){setTimeout(e,500)},this.giveReward.bind(this)])},SlotMachine.prototype.calcPayline=function(){return cleverapps.config.debugMode&&SlotMachine.PREDEFINED_PAYLINE?SlotMachine.PREDEFINED_PAYLINE:[cleverapps.Random.choose(SlotMachine.SYMBOLS).type,cleverapps.Random.choose(SlotMachine.SYMBOLS).type,cleverapps.Random.choose(SlotMachine.SYMBOLS
).type]},SlotMachine.prototype.giveReward=function(e){var t,n=this.reels.map(function(e){return e.getCurrent()});if(n.every(function(e){return e.type===n[0].type}))t=n[0].reward;else{var s=n.reduce(function(e,t){return e+(t.gold||0)},0);0<s&&(t={gold:s})}t?(this.trigger("giveReward",t,e),setTimeout(cleverapps.Chest.prototype._receiveReward.bind(null,t),2e3)):e()},SlotMachine.REELS_AMOUNT=3,SlotMachine.REEL_SPIN_DELAY=300,SlotMachine.COIN_SYMBOL={type:"coin",icon:bundles.slot_machine.frames.coin_png,reward:{gold:500},gold:50},SlotMachine.COINS_SYMBOL={type:"coins",icon:bundles.slot_machine.frames.coins_png,reward:{gold:2500},gold:250},SlotMachine.SYMBOLS=[SlotMachine.COINS_SYMBOL,{type:"booster_1",icon:bundles.slot_machine.frames.booster_13_png,reward:{boosters:{13:10}}},SlotMachine.COIN_SYMBOL,{type:"booster_2",icon:bundles.slot_machine.frames.booster_14_png,reward:{boosters:{14:10}}},SlotMachine.COINS_SYMBOL,{type:"booster_3",icon:bundles.slot_machine.frames.booster_15_png,reward:{
boosters:{15:10}}},SlotMachine.COIN_SYMBOL];var SlotMachineReel=function(e){cleverapps.EventEmitter.call(this),this.symbols=e.map(function(e,t){return new SlotMachineSymbol(this,e,t)},this),this.current=0};SlotMachineReel.prototype=Object.create(cleverapps.EventEmitter.prototype),(SlotMachineReel.prototype.constructor=SlotMachineReel).prototype.setCurrentByType=function(t){this.current=this.symbols.filter(function(e){return e.type===t})[0].index;for(var e=0;e<this.symbols.length;e++)this.symbols[e].move()},SlotMachineReel.prototype.getCurrent=function(){return this.symbols[this.current]},SlotMachineReel.prototype.spin=function(e,t){this.minSpinsAmount=cleverapps.Random.random(20,25),this._spinOneDegree(0,e,t)},SlotMachineReel.prototype._spinOneDegree=function(e,t,n){e++,this.current=(this.current-1+this.symbols.length)%this.symbols.length;for(var s=e>=this.minSpinsAmount&&this.symbols[this.current].type===t,i=0;i<this.symbols.length;i++)this.symbols[i].spin(s);setTimeout(function(){
s?n():this._spinOneDegree(e,t,n)}.bind(this),SlotMachineReel.ONE_DEGREE_DURATION)},SlotMachineReel.ONE_DEGREE_DURATION=50;var SlotMachineSymbol=function(e,t,n){cleverapps.EventEmitter.call(this),cleverapps.extend(this,t),this.reel=e,this.index=n};SlotMachineSymbol.prototype=Object.create(cleverapps.EventEmitter.prototype),(SlotMachineSymbol.prototype.constructor=SlotMachineSymbol).prototype.move=function(){this.trigger("move")},SlotMachineSymbol.prototype.spin=function(e){this.trigger("spin",e)};var SlotMachineMissionLogic=function(e){this.mission=e,this.slotMachine=new SlotMachine(e)},SlotMachineButton=cleverapps.UI.Button.extend({ctor:function(e){this.slotMachine=e;var t=cleverapps.styles.SlotMachineButton;this._super({spine:bundles.slot_machine.jsons.button_json,button_animation:"idle",width:t.width,height:t.height,text:"Spin",font:cleverapps.styles.FONTS.SLOT_MACHINE_BUTTON_TEXT,contentOffset:t.contentOffset,onClicked:this.onClicked.bind(this)}),this.setScale(.5),
this.baseScale=this.scale,this.setPositionRound(t),this.slotMachine.on("showForce",this.createListener(this.showForce.bind(this)))},showForce:function(){cleverapps.metha.display({focus:"SlotMachineForce",action:function(e){cleverapps.forces.create(this,Forces.SLOT_MACHINE),cleverapps.forces.onceForceClosed=e}.bind(this)})},onClicked:function(){var t=cleverapps.styles.SlotMachineButton;cleverapps.forces.isRunningForce()&&cleverapps.forces.closeRunningForce(),cleverapps.metha.display({focus:"SlotMachine",control:"MenuBarGoldItem",action:function(e){this.slotMachine.spin(e),this.background.setAnimationAndIdleAfter("press","idle"),this.text.runAction(new cc.Sequence(new cc.MoveBy(.2,0,t.moveByY),new cc.DelayTime(.4),new cc.MoveBy(.2,0,-t.moveByY))),cleverapps.audio.playSound(bundles.slot_machine.urls.button_click_effect)}.bind(this)})}});cleverapps.overrideFonts(cleverapps.styles.FONTS,{SLOT_MACHINE_BUTTON_TEXT:{size:70,color:cleverapps.styles.COLORS.WHITE,stroke:{size:2,
color:new cc.Color(21,70,126,255)},shadow:{color:new cc.Color(70,70,70,70),direction:cc.size(2,-4),blur:1}}}),cleverapps.styles.SlotMachineButton={x:{align:"center"},y:{align:"center",dy:-200},contentOffset:{x:0,y:28},moveByY:-30,width:400,height:250};var SlotMachineReelView=ccui.Layout.extend({ctor:function(e){this._super(),this.reel=e,this.setClippingEnabled(!0);var t=cleverapps.styles.SlotMachineReelView;this.setContentSize2(t),this.reel.symbols.forEach(function(e){this.addChild(new SlotMachineSymbolView(e))}.bind(this))}});cleverapps.styles.SlotMachineReelView={width:140,height:286};var SlotMachineSymbolView=cc.Node.extend({ctor:function(e){this._super(),this.symbol=e,this.reel=this.symbol.reel;var t=cleverapps.styles.SlotMachineSymbolView;this.setContentSize2(t),this.setAnchorPoint2();var n=new cc.Sprite(e.icon);this.addChild(n),n.setPositionRound(this.width/2,this.height/2),e.on("move",this.createListener(this.move.bind(this))),e.on("spin",this.createListener(
this.spinOneDegree.bind(this))),this.setPositionRound(this.calcPosition())},move:function(){this.setPositionRound(this.calcPosition())},spinOneDegree:function(e){var t=cleverapps.styles.SlotMachineSymbolView,n=this.calcPosition();e?this.runAction(new cc.Sequence(new cc.MoveBy(SlotMachineReel.ONE_DEGREE_DURATION/1e3,0,-t.height-t.height/2).easing(cc.easeBackInOut(.6)),new cc.PlaySound(bundles.slot_machine.urls.spin_stop_effect,{throttle:0}),new cc.MoveBy(.1,0,t.height/2+t.height/8),new cc.MoveBy(.1,0,-t.height/8).easing(cc.easeIn(2)),new cc.CallFunc(function(){this.setPositionRound(n)}.bind(this)))):this.runAction(new cc.Sequence(new cc.MoveBy(SlotMachineReel.ONE_DEGREE_DURATION/1e3,0,-t.height),new cc.CallFunc(function(){this.setPositionRound(n)}.bind(this)))),cleverapps.audio.playSound(bundles.slot_machine.urls.spin_effect,{throttle:25})},calcPosition:function(){var e=cleverapps.styles.SlotMachineSymbolView,t=((this.reel.getCurrent().index+1
)%this.reel.symbols.length-this.symbol.index+this.reel.symbols.length)%this.reel.symbols.length,n=cleverapps.styles.SlotMachineReelView.height/2-(e.height/2+e.height);return cc.p(this.width/2,e.height/2+t*e.height+n)}});cleverapps.styles.SlotMachineSymbolView={width:150,height:150,lastAnimation:{}};var SlotMachineScene=cleverapps.FixedWidthScene.extend({ctor:function(e){this._super(cleverapps.Environment.SCENE_SLOT_MACHINE),this.slotMachine=e.slotMachine,this.background.addChild(new SlotMachineButton(this.slotMachine)),this.background.addChild(new SlotMachineView(this.slotMachine,this))},onExit:function(){this._super(),this.slotMachine.purge()},getBackgroundStyles:function(){return{background:bundles.slot_machine.urls.background}}});SlotMachineScene.BUNDLES=function(){return["slot_machine"]};var SlotMachineView=cc.Node.extend({ctor:function(e,t){this._super(),this.setAnchorPoint2(),this.slotMachine=e,this.scene=t;var n=cleverapps.styles.SlotMachineView,s=this.slotMachine.reels.map(
function(e){return new SlotMachineReelView(e)},this),i=new cleverapps.Layout(s,{direction:cleverapps.UI.HORIZONTAL,margin:n.margin});this.addChild(i),this.setContentSize2(i.getContentSize()),i.setPositionRound(this.width/2,this.height/2),this.setScale(.5),this.setPositionRound(n);var o=new cc.Sprite(bundles.slot_machine.frames.arrow_png);this.addChild(o),o.setPositionRound(n.arrow),this.slotMachine.on("giveReward",this.createListener(this.giveReward.bind(this))),this.slotMachine.on("spin",this.createListener(this.onSpin.bind(this)))},giveReward:function(e,t){var n;e.boosters?(n=new cleverapps.Spine(bundles.slot_machine.jsons.reward_json),this.addChild(n),n.setPositionRound(this.width/2,this.height/2),n.setSkin("booster_"+Object.keys(e.boosters)[0]),n.setAnimation(0,"show_up",!1)):(n=new cleverapps.Spine(bundles.slot_machine.jsons.reward_gold_json),this.addChild(n),n.setPositionRound(this.width/2,this.height/2),n.setAnimation(0,"animation2",!1),cleverapps.audio.playSound(
bundles.slot_machine.urls.coins_reward_effect)),n.setCompleteListenerRemove(this.showRewards.bind(this,e,t))},createReward:function(e,t){var n=cleverapps.styles.SlotMachineView,s=cleverapps.UI.generateImageText(e,cleverapps.styles.FONTS.SLOT_MACHINE_REWARD_TEXT),i=new cc.Sprite(t);return i.setScale(.7),new cleverapps.Layout([i,s],{margin:n.rewards.textMargin,direction:cleverapps.UI.HORIZONTAL})},showRewards:function(e,t){var n=cleverapps.styles.SlotMachineView,s=[];for(var i in e)if("boosters"===i)for(var o in e[i])s.push(this.createReward("x"+e[i][o],RewardsHelper.ICONS[o]));else s.push(this.createReward(e[i],RewardsHelper.ICONS[i]));this.rewardsBlock=new cleverapps.Layout(s,{margin:n.rewards.margin,direction:cleverapps.UI.HORIZONTAL}),this.rewardsBlock.setCascadeOpacityEnabledRecursively(!0),this.addChild(this.rewardsBlock),this.rewardsBlock.setPositionRound(n.rewards),this.rewardsBlock.setScale(.5),this.rewardsBlock.setOpacity(0),this.rewardsBlock.runAction(new cc.Sequence(
new cc.Spawn(new cc.ScaleTo(.3,1).easing(cc.easeBackInOut(1)),new cc.FadeIn(.3)),new cc.PlaySound(bundles.slot_machine.urls.reward_window_effect),new cc.CallFunc(t)))},onSpin:function(){this.rewardsBlock&&(this.rewardsBlock.runAction(new cc.Sequence(new cc.FadeOut(.3),new cc.RemoveSelf)),delete this.rewardsBlock)}});cleverapps.overrideFonts(cleverapps.styles.FONTS,{SLOT_MACHINE_REWARD_TEXT:{size:50,color:cleverapps.styles.COLORS.WHITE,stroke:cleverapps.styles.DECORATORS.IMAGE_FONT_STROKE}}),cleverapps.styles.SlotMachineView={x:{align:"center"},y:{align:"center",dy:55},arrow:{x:{align:"center",dx:-239},y:{align:"center",dy:0}},rewards:{textMargin:4,margin:5,x:{align:"center"},y:{align:"center",dy:231}},margin:10};var PurchaseRewardWindow=RewardWindow.extend({onWindowLoaded:function(e){this._super({title:"messages:PurchaseRewardWindow.title",name:"purchaserewardwindow",reward:e.reward,callback:e.callback,buttonText:"messages:OK",rewardName:!1})},receiveReward:function(){this.reward&&(
this.onReceiveReward(),cleverapps.Chest.prototype._receiveReward(this.reward,!0),this.reward=[])},selectDoubleStrategy:function(){}});WINDOW_ANIMATIONS={default:{open:function(e){var t=this.window.scale;this.window.setScale(.8*t),this.window.runAction(new cc.Sequence(new cc.ScaleTo(.3,t).easing(cc.easeBackOut()),new cc.CallFunc(e)))},close:function(e){e()}},fallIn:{open:function(e){var t=this.window.scale;this.window.setScale(3.2*t),this.runForAllChildren(function(e){e.setCascadeOpacityEnabled(!0)}),this.window.setOpacity(30),this.window.runAction(new cc.Sequence(new cc.Spawn(new cc.ScaleTo(.5,t).easing(cc.easeIn(1.5)),new cc.FadeIn(.5).easing(cc.easeIn(2))),new cc.CallFunc(e)))},close:function(e){e()}},fromLeft:{open:function(e){var t=this.window.basePosition;this.window.setPositionX(-t.x),this.window.runAction(new cc.Sequence(new cc.MoveTo(.3,t.x,t.y).easing(cc.easeBackOut()),new cc.CallFunc(e)))},close:function(e){this.window.runAction(new cc.Sequence(new cc.MoveTo(.3,-this.window.x
,this.window.y).easing(cc.easeBackIn()),new cc.CallFunc(e)))}},fromBelow:{open:function(e){var t=this.window.basePosition;this.window.setPositionY(0),this.window.runAction(new cc.Sequence(new cc.MoveTo(.3,t.x,t.y).easing(cc.easeBackOut()),new cc.CallFunc(e)))},close:function(e){this.window.runAction(new cc.Sequence(new cc.MoveTo(.4,this.window.x,0).easing(cc.easeBackIn()),new cc.CallFunc(e)))}},fromLeftToRight:{open:function(e){var t=this.window.basePosition;this.window.setPositionX(-this.window.width/2),this.window.runAction(new cc.Sequence(new cc.MoveTo(.3,t.x,t.y).easing(cc.easeBackOut()),new cc.CallFunc(e)))},close:function(e){this.window.runAction(new cc.Sequence(new cc.MoveTo(.3,this.width+this.window.width/2,this.window.y).easing(cc.easeBackIn()),new cc.CallFunc(e)))}},bezierCircle:{open:function(e){var t=cc.p(this.window.basePosition.x,this.window.basePosition.y),n=cc.p(t.x+.2*this.width,this.height-this.window.height/2),s=cc.p(t.x+.35*this.width,t.y-this.window.height/6),
i=this.window.scale;this.window.setScale(.3*i),this.window.setPosition(n);this.window.runAction(new cc.Sequence(new cc.Spawn(new cc.BezierTo(.25,[n,s,t]),new cc.ScaleTo(.25,i).easing(cc.easeIn(3))),new cc.CallFunc(e)))},close:function(e){var t=cc.p(this.window.basePosition.x,this.window.basePosition.y),n=cc.p(t.x-.2*this.width,this.height-this.window.height/2),s=cc.p(t.x-.35*this.width,t.y-this.window.height/2);this.window.setPosition(t);this.window.runAction(new cc.Sequence(new cc.Spawn(new cc.BezierTo(.25,[t,s,n]),new cc.ScaleTo(.25,.3).easing(cc.easeOut(.33))),new cc.CallFunc(e)))}},instant:{open:function(e){e()},close:function(e){e()}},force:{open:function(e){e()},close:function(e){this.dialogue.close(e)}}},AVAILABLE_MOVE_ANIMATIONS={default:function(e,t,n){var s=e.scale,i=e.x,o=e.y,r=-t.col*cleverapps.styles.BaseCellView.CELL_SIZE_PX*.16,a=t.row*cleverapps.styles.BaseCellView.CELL_SIZE_PX*.16;0===t.row&&(a-=.075*cleverapps.styles.BaseCellView.CELL_SIZE_PX),e.runAction(
new cc.RepeatForever(new cc.Sequence(new cc.Repeat(new cc.Sequence(new cc.Spawn(new cc.ScaleTo(.35,1.1*s),new cc.MoveTo(.35,i-r,o-a).easing(cc.easeIn(3.5))),new cc.Spawn(new cc.ScaleTo(.35,s),new cc.MoveTo(.35,i,o).easing(cc.easeOut(3.5)))),3),new cc.DelayTime(3))))},homescapes:function(e,t,n){var s=e.getScaleX(),i=e.getScaleY(),o=e.x,r=e.y,a=e.getRotation();if(e.cell.x===n.start.x&&e.cell.y===n.start.y){var c=n.dir.col*cleverapps.styles.BaseCellView.CELL_SIZE_PX*.2,l=-n.dir.row*cleverapps.styles.BaseCellView.CELL_SIZE_PX*.2;e.setLocalZOrder(10),e.runAction(new cc.RepeatForever(new cc.Sequence(new cc.Spawn(new cc.Sequence(new cc.MoveBy(.45,c,l),new cc.MoveBy(.2,-.3*c,-.3*l),new cc.MoveBy(.2,.3*c,.3*l),new cc.MoveTo(.4,o,r).easing(cc.easeOut(1))),new cc.Sequence(new cc.ScaleTo(.45,1.1*s,1.1*i),new cc.DelayTime(.4),new cc.ScaleTo(.4,s,i).easing(cc.easeOut(1)))),new cc.DelayTime(.5))))}else e.runAction(new cc.RepeatForever(new cc.Sequence(new cc.DelayTime(.1),new cc.Spawn(new cc.Sequence(
new cc.ScaleTo(.35,1.1*s,1.1*i),new cc.DelayTime(.35),new cc.ScaleTo(.35,s,i)),new cc.Sequence(new cc.RotateTo(.35,a-5).easing(cc.easeIn(2)),new cc.RotateTo(.175,a+5),new cc.RotateTo(.175,a-5),new cc.RotateTo(.35,a))),new cc.DelayTime(.6))))}},WRONG_MOVE_ANIMATIONS={default:function(e,t){var n=cleverapps.styles.BaseCellView.wrongMove.move,s=function(e){return 0<e?1:e<0?-1:0},i=n*s(t.x-e.cell.x),o=n*s(e.cell.y-t.y),r=.9,a=1.1;e.cell.x===t.x&&(r=1.1,a=.9),Game.counter.setTimeout(function(){}.bind(e),100),e.runAction(new cc.Spawn(new cc.Sequence(new cc.Spawn(new cc.ScaleTo(.1,r,a),new cc.MoveBy(.1,new cc.p(i,o))),new cc.Spawn(new cc.ScaleTo(.1,1,1),new cc.MoveBy(.1,new cc.p(-i,-o)))),new cc.CallFunc(e.squeeze.bind(e,1))))}},BOARD_GUN_ANIMATIONS={default:function(e,t){t()},explosion:function(e,t){cleverapps.audio.playSound(bundles.game.urls.gun_bombing_effect),this.runAction(new cc.Sequence(new cc.DelayTime(1.3),new cc.CallFunc(t)));var n=new cleverapps.Spine(bundles.game.jsons.gun_json,5)
;this.addChild(n),n.setPositionRound(this.grid.getPosition()),n.replaceParentSamePlace(cc.director.getRunningScene().scene),n.setCompleteListenerRemove(),n.setAnimation(0,"animation",!1),n.setTimeScale(.5)},byLetter:function(e,t){cleverapps.audio.playSound(bundles.game.urls.gun_bombing_effect),this.runAction(new cc.Sequence(new cc.DelayTime(0),new cc.CallFunc(t))),e.forEach(function(e){var t=this.placeholders[e.row][e.column],n=new cleverapps.Spine(bundles.game.jsons.gun_json);this.letterGrid.addChild(n),n.setAnimation(0,"animation",!1),n.setPositionRound(t.getPosition()),n.setLocalZOrder(-1)}.bind(this))}};var ComicsPlayer=function(e,t){this.stages=e,this.animation=t,this.stage=-1};ComicsPlayer.prototype.onChangeStage=function(){(void 0===this.dialogueStages||this.dialogueStages<1)&&(this.next(),this.dialogueStages=this.comics.dialogueStages||1),this.dialogueStages--},ComicsPlayer.prototype.next=function(){this.stage++,this.stage>=this.stages.length||(
this.comics=this.stages[this.stage],this.runAnimation())},ComicsPlayer.prototype.completeShowAnimation=function(){this.inAnimation&&this.comics.idleAnimation&&(this.animation.setCompleteListener(function(){}),this.inAnimation=!1,this.animation.setAnimation(0,this.comics.idleAnimation,!0))},ComicsPlayer.prototype.runAnimation=function(){this.comics.showAnimation?(this.inAnimation=!0,this.animation.setAnimation(0,this.comics.showAnimation,!1),this.animation.setCompleteListener(this.animation.createListener(this.completeShowAnimation.bind(this)))):(this.inAnimation=!1,this.animation.setAnimation(0,this.comics.idleAnimation,!0))};var ComicsScene=cleverapps.FixedWidthScene.extend({ctor:function(e,t){this._super(cleverapps.Environment.SCENE_COMICS),this.createBg(),this.addFilmEffect();var n=this.dialogue=new Dialogue(e.dialogue,{autoClose:!0,autoScroll:3}),s=new ComicsPlayer(e.stages,this.createAnimation(e));n.on("afterClose",t),n.on("changedStage",s.onChangeStage.bind(s)),this.runAction(
new cc.Sequence(new cc.DelayTime(0),new cc.callFunc(function(){this.createDialogueView(n),n.run()}.bind(this))))},onChangeSize:function(e){this._super(e),this.bg&&this.bg.setScale(this.bg.baseScale/this.scene.scale),this.animationNode.setScale(1/this.scene.scale)},addFilmEffect:function(){var e=cleverapps.styles.ComicsScene,t={scale:1,silent:!0,noControls:!0};e.createFilmEffect&&(t=cleverapps.extend(t,e.createFilmEffect)),this.runAsync(function(){this.createFilmEffect(t)}.bind(this))},createAnimation:function(e){var t=this.animationNode=new cc.Node;t.setAnchorPoint2(),t.setContentSize(this.scene.getContentSize()),t.setPositionRound(this.scene.width/2,this.scene.height/2),this.scene.addChild(t);var n=this.animation=new cleverapps.Spine(e.json);return t.addChild(n),n.setPositionRound(t.width/2,t.height/2),n},createDialogueView:function(e){var t={overlay:!0,shadow:!1,styles:cleverapps.overrideStyles(cleverapps.styles.DialogueView,cleverapps.styles.ComicsScene.dialogue,!0)}
;"runes"===cleverapps.config.name&&(t.inner=!0),this.dialogueView=new DialogueView(e,t)},createBg:function(){var e=cleverapps.styles.ComicsScene;if(e.bg){var t=this.bg=new cc.Sprite(e.bg.image);this.scene.addChild(t),t.setPositionRound(this.scene.width/2,this.scene.height/2),this.bg.baseScale=Math.max(this.width/t.width,this.height/t.height),t.setScale(this.bg.baseScale),t.setLocalZOrder(-10)}}});ComicsScene.BUNDLES=function(e){var t=["dialogues"];return e.bundles&&(t=t.concat(e.bundles)),t},ComicsScene.showComics=function(e,t){cleverapps.scenes.replaceScene(new ComicsScene(t,e))},cleverapps.styles.ComicsScene={dialogue:{offsetY:150}};var KeyboardController=function(){this.keyPressed={},cc.eventManager.addListener(cc.EventListener.create({event:cc.EventListener.KEYBOARD,onKeyPressed:this.onKeyPressedHandler.bind(this),onKeyReleased:this.onKeyReleasedHandler.bind(this)}),2)};KeyboardController.prototype.RETURN_THROTTLE=250,KeyboardController.prototype.THROTTLE_KEYS=[cc.KEY.escape,
cc.KEY.back],KeyboardController.prototype.KEYS=[cc.KEY.ctrl,cc.KEY.shift],cleverapps.config.debugMode&&KeyboardController.prototype.KEYS.push(cc.KEY.s,cc.KEY.d,cc.KEY.r,cc.KEY.j,cc.KEY.a,cc.KEY.Delete,cc.KEY.c),KeyboardController.prototype.isPressed=function(e){return this.keyPressed[e]},KeyboardController.prototype.onKeyPressedHandler=function(e){-1!==this.KEYS.indexOf(e)&&(this.keyPressed[e]=!0)},KeyboardController.prototype.onKeyReleasedHandler=function(e){-1!==this.KEYS.indexOf(e)?this.keyPressed[e]=!1:-1!==this.THROTTLE_KEYS.indexOf(e)&&this.returnAction()},KeyboardController.prototype.returnAction=cleverapps.throttle(KeyboardController.prototype.RETURN_THROTTLE,function(){if(window.debug)window.debug.cleanupBorder(),window.debug=void 0;else if(0<cleverapps.windows.list.length){var e=cleverapps.windows.list[cleverapps.windows.list.length-1];e.closeByBackButton&&e.closeByBackButton()}else{var t=cc.director.getRunningScene();t&&t.closeAction()}});var LanternWindow=Window.extend({
onWindowLoaded:function(e,t){var n=this.getStyles();this.mission=e,this.options=t||{},this._super({name:"lanternwindow",title:"messages:LanternWindow.Title",content:this.getContent(),button:{width:n.button.width,height:n.button.height,text:Messages.get("OK"),onPressed:this.close.bind(this)},styles:cleverapps.overrideStyles(cleverapps.styles.Window,cleverapps.styles.LanternWindow.window,!0)}),this.onStart()},getStyles:function(){return cleverapps.styles.LanternWindow},onStart:function(){this.mission.isRunning()&&this.addTimer();var e=this.getStyles(),t=this.animation=new cleverapps.Spine(bundles.lantern.jsons.lantern_game_json,e.animation.scale);this.picture.addChild(t),t.setPositionRound(this.picture.width/2+e.animation.x,this.picture.height/2+e.animation.y),t.setAnimation(0,"idle_"+this.mission.logic.lantern.getCurrentStreak(),!0)},getContent:function(){var e=this.getStyles(),t=this.picture=new cc.Node;t.setContentSize(e.bg.width,e.bg.height),t.setAnchorPoint(0,0);var n=new cc.Sprite(
bundles.lantern_window.frames.lantern_bg_png);n.setScale(e.bg.scale),n.setAnchorPoint(0,0),t.addChild(n);var s=this.createBonuses();s.setAnchorPoint(0,0),t.addChild(s),s.setPositionRound(e.bonuses);var i=this.createText();return i.setAnchorPoint(0,0),this.content=new cleverapps.Layout([i,t],{margin:e.margin,direction:cleverapps.UI.VERTICAL}),this.content},createBonuses:function(){var p=this.getStyles(),d=cleverapps.values(Lantern.BONUS_TYPES).sort(function(e,t){return LanternWindow.BONUSES_ORDER[e]-LanternWindow.BONUSES_ORDER[t]}),u=Lantern.BONUSES_BY_SERIA[this.mission.logic.lantern.getCurrentStreak()]||{},h=[];return d.forEach(function(e,t){var n=u[e],s=new cc.Scale9Sprite(n?p.bonuses.bonusBg.on:p.bonuses.bonusBg.off);s.setContentSize2(p.bonuses.bonusBg);var i=new cc.Sprite(p.bonuses.images[e].image);if(i.setScale(p.bonuses.images[e].scale),s.addChild(i),(s.icon=i).setPositionRound(s.width/2,s.height/2),n){var o=cleverapps.UI.generateTTFText("x"+u[e],
cleverapps.styles.FONTS.LANTERN_WINDOW_AMOUNT_TEXT);if(s.addChild(o),o.setPositionRound(p.bonuses.amount),bundles.lantern_window.frames.amountBg){var r=cleverapps.UI.createScale9Sprite(bundles.lantern_window.frames.amountBg,cleverapps.UI.Scale9Rect.TwoPixelXY);r.setContentSize2(p.bonuses.amount.bg),o.addChild(r,-1),r.setPositionRound(p.bonuses.amount.bg)}}else i.setColor(new cc.Color(120,120,120,255));if(h.push(s),t<d.length-1){var a=new cc.Sprite(p.bonuses.arrow.image);if(a.setLocalZOrder(1),h.push(a),p.flashingArrows){var c=cleverapps.styles.COLORS.WHITE,l=cleverapps.styles.COLORS.COLOR_DARK_GRAY;n?u[d[t+1]]||a.runAction(new cc.RepeatForever(new cc.Sequence(new cc.TintTo(.9,l.r,l.g,l.b),new cc.DelayTime(.1),new cc.TintTo(.9,c.r,c.g,c.b),new cc.DelayTime(.1)))):a.setColor(l)}}}.bind(this)),new cleverapps.Layout(h,{direction:cleverapps.UI.HORIZONTAL,margin:p.bonuses.margin})},createText:function(){var e=this.getStyles(),t=cleverapps.UI.generateTTFText("messages:LanternWindow.text",
e.text.font);return t.setDimensions(e.text.width,0),t.fitTo(void 0,e.text.height),t.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER),t},addTimer:function(){var e=this.getStyles(),t=new cc.Scale9Sprite(e.timer.bg.image);t.setContentSize2(e.timer.bg);var n={background_content:t,font:cleverapps.styles.FONTS.LANTERN_TIMER_FONT||cleverapps.styles.FONTS.WINDOW_TEXT},s=new cleverapps.CountDownView(new cleverapps.CountDown(this.mission.getTimeLeft(),{onFinish:this.close.bind(this)}),n);this.picture.addChild(s),s.setPositionRound(e.timer)},listBundles:function(){return["windows","lantern_window","lantern"]}});LanternWindow.BONUSES_ORDER={heroes:0,moves:1,multicolor:2},cleverapps.overrideFonts(cleverapps.styles.FONTS,{LANTERN_WINDOW_TEXT:{size:33,color:new cc.Color(130,70,40,255)},LANTERN_WINDOW_AMOUNT_TEXT:{size:45,color:cleverapps.styles.COLORS.WHITE,stroke:{size:2,color:cleverapps.styles.COLORS.BLACK}}}),cleverapps.styles.LanternWindow={margin:30,bg:{scale:2,width:612,height:532},timer:{x:{
align:"center"},y:{align:"top",dy:15},bg:{image:bundles.main.frames.tournamentstory_bg,width:215,height:65}},text:{height:400,width:600,font:cleverapps.styles.FONTS.LANTERN_WINDOW_TEXT},button:{width:220,height:110},animation:{x:0,y:20,scale:1},bonuses:{x:{align:"center"},y:{align:"bottom",dy:5},bonusBg:{width:180,height:180,on:bundles.lantern_window.frames.bonus_bg_on_png,off:bundles.lantern_window.frames.bonus_bg_off_png},arrow:{image:bundles.lantern_window.frames.lantern_arrow_png},offsetY:5,margin:-23,amount:{x:{align:"right",dx:-28},y:{align:"bottom",dy:17}},images:{heroes:{image:bundles.reward_icons.frames.heroes_png,scale:1},moves:{image:bundles.reward_icons.frames.moves_png,scale:1},multicolor:{image:bundles.reward_icons.frames.multicolor_png,scale:1}}},window:{Border:{y:170}}};var WardrobeWindow=Window.extend({onWindowLoaded:function(e){this.mission=e,this.wardrobeBundle=bundles[cleverapps.skins.getBundle()||e.feature];var t=cleverapps.styles.WardrobeWindow,
n=cleverapps.environment.isGameScene(),s=cleverapps.overrideStyles(cleverapps.styles.Window,{HelpButton:t.HelpButton,bandButton:!0},!0);this._super({name:"wardrobewindow",content:this.generateContent(),styles:s,help:function(){this.close(),new WardrobeRulesWindow(e)}.bind(this),button:{width:t.button.width,height:t.button.height,button_png:t.button.button_png,button_on_png:t.button.button_on_png,text:n?Messages.get("OK"):Messages.get("Play"),onPressed:function(){cleverapps.eventLogger.logEvent(cleverapps.styles.WardrobeWindow.eventName+"_play"+(n?"_ongame":"")),this.close(),cleverapps.metha.distract({focus:"WardrobePlayButtonPressed",action:function(e){cleverapps.metha.wantsToPlay(e)}})}.bind(this)}})},generateUpperBanner:function(e){var t=cleverapps.styles.WardrobeWindow.banner;this.banner=new cc.Sprite(cleverapps.skins.getSlot("wardrobeWindowBanner"));var n=new ccui.Layout;n.setAnchorPoint2(),n.setPositionRound(t.position.x+e.width/2,e.height+t.position.y),n.setContentSize2(
this.banner.width,2*this.banner.height),n.setClippingEnabled(!0),e.addChild(n),this.banner.setPositionRound(n.width/2,this.banner.height/2),n.addChild(this.banner),this.refreshPerson()},refreshPerson:function(){var e=cleverapps.styles.WardrobeWindow.person;this.banner.removeAllChildren();var t=new cc.Node;t.setAnchorPoint2(),t.setContentSize2(e.width,e.height),this.person=new cleverapps.Spine(e.json,e.scale),this.person.setAnimation(0,"idle",!0),t.addChild(this.person),this.person.setPositionRound(t.width/2,t.height/2),this.banner.addChild(t),t.setPositionRound(this.banner.width/2+e.position.x,this.banner.height/2+e.position.y)},refreshStagesScroll:function(){var e=cleverapps.styles.WardrobeWindow.stages;this.stages.removeAllChildren();for(var t=[],n=0;n<WardrobeWindow.stages.length;n++)t.push(this.generateStageContent(n));var s=new cleverapps.Layout(t,{direction:cleverapps.UI.VERTICAL,margin:e.margin});this.stagesScroll=new cleverapps.UI.ScrollView(s,{
childrenVisibility:cleverapps.UI.ScrollView.CHILDREN_VISIBILITY_LINEAR}),this.stagesScroll.setContentSize2(e.width,e.height-2*e.padding),this.stagesScroll.setPositionRound(this.stages.width/2,this.stages.height/2),this.stages.addChild(this.stagesScroll);var i=this.mission.logic.getCurrentStage().stage;i>=t.length&&(i=t.length-1),this.needScroll=t[i]},addTimer:function(){var e=this.mission.finishTime()-Date.now();if(!(e<=0)){var t=new cleverapps.CountDown(e,{onFinish:this.close.bind(this)}),n=cleverapps.styles.WardrobeWindow.timer,s={font:n.font,timerPosition:{x:0,y:n.offsetY},regularFontTimerPosition:{x:0,y:n.regularFont.offsetY}};if(n.bg){var i=cleverapps.UI.createScale9Sprite(n.bg.image);i.setContentSize2(n.bg.width,n.bg.height),s.background_content=i}var o=new cleverapps.CountDownView(t,s);this.banner.addChild(o),o.setPositionRound(n.position)}},generateContent:function(){var e=cleverapps.styles.WardrobeWindow,t=new cc.Node;t.setContentSize2(e.width,e.height),t.setAnchorPoint2(),
this.generateUpperBanner(t),this.stages=new cc.Scale9Sprite(e.stages.bg),this.stages.setContentSize2(e.stages.width,e.stages.height);var n=cleverapps.UI.generateOnlyText("messages:WardrobeDescText",cleverapps.styles.FONTS.WINDOW_TEXT);n.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER),n.setDimensions(t.width,0),n.fitTo(void 0,e.text.height);var s=new cleverapps.Layout([n,this.stages],{direction:cleverapps.UI.VERTICAL,margin:e.content.margin});return s.setPositionRound(t.width/2+e.content.position.x,t.height/2+e.content.position.y),t.addChild(s),e.zOrder&&t.setLocalZOrder(e.zOrder),this.refreshStagesScroll(),this.addTimer(),t},scrollToNeedStage:function(e){if(!1!==this.needScroll){var t=this.mission.logic.getCurrentStage().stage;t<WardrobeWindow.stages.length-1&&this.stagesScroll.runAction(new cc.Sequence(new cc.DelayTime(e),new cc.CallFunc(function(){this.stagesScroll.scrollTo(this.needScroll,.5*(WardrobeWindow.stages.length-1-t)),this.needScroll=!1}.bind(this))))}},onShow:function(){
this._super(),this.scrollToNeedStage(.2)},buyDecoration:function(e,t,n){levels.user.takeGold(t)&&(this.close(),this.mission.update(n),cleverapps.eventLogger.logEvent("buy_"+cleverapps.styles.WardrobeWindow.eventName+"_"+(e+1),{amount:t}),cleverapps.eventLogger.logEvent("buy_"+cleverapps.styles.WardrobeWindow.eventName+"_amount_"+(e+1)),this.mission.logic.stageToShow=e+1)},generateStageContent:function(e){var t=cleverapps.styles.WardrobeWindow.stages.stage,n=this.mission.logic.getCurrentStage(),s=0,i=!1,o=!1;n.stage>e?(s=WardrobeWindow.stages[e],i=!0):n.stage==e&&(s=n.progress,o=!0);var r=new cc.Scale9Sprite(t.bg);r.setContentSize2(t.width,t.height),r.setAnchorPoint2();var a=new cc.Node;a.setAnchorPoint2(),a.setContentSize2(r.getContentSize()),a.setPositionRound(r.width/2,r.height/2),a.setCascadeOpacityEnabled(!0),r.addChild(a);var c=new cc.Sprite(this.wardrobeBundle.frames["stage"+(e+1)+"_icon"]);if(c.setPositionRound(t.icon.position.x,t.icon.position.y+a.height/2),c.setScale(
t.icon.scale),a.addChild(c),i&&t.icon.passedMark){var l=new cc.Sprite(t.icon.passedMark.icon);l.setPositionRound(c.x+t.icon.passedMark.position.x,c.y+t.icon.passedMark.position.y),l.setScale(t.icon.passedMark.scale),a.addChild(l)}if(!o){var p=cleverapps.UI.generateOnlyText(i?"messages:WardrobeCompleteText":"messages:WardrobeStageTaskText",cleverapps.styles.FONTS.WINDOW_TEXT,{amount:WardrobeWindow.stages[e]});p.fitTo(t.text.width,0),p.setPositionRound(t.text.position.x,t.text.position.y+a.height/2),p.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER),a.addChild(p)}if(o){var d=new cc.Scale9Sprite(t.progress.bg);d.setContentSize2(t.progress.width,t.progress.height),d.setAnchorPoint2(),this.progressBar=new ScaledProgressBar(t.progress.line),this.progressBar.setDimension(d.width-2*t.progress.padding.x,d.height-2*t.progress.padding.y),this.progressBar.setPositionRound(t.progress.padding.x,t.progress.padding.y),this.progressBar.setPercentage(s/WardrobeWindow.stages[e]*100),d.addChild(
this.progressBar);var u=cleverapps.UI.generateOnlyText("messages:WardrobeCurrentText",cleverapps.styles.FONTS.WINDOW_SMALL_TEXT);u.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER),u.fitTo(d.width);var h=cleverapps.UI.generateImageText(s+"/"+WardrobeWindow.stages[e],cleverapps.styles.FONTS.WINDOW_SMALL_TEXT);h.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER);var g=new cleverapps.Layout([h,d,u],{direction:cleverapps.UI.VERTICAL,margin:t.currentDesc.margin});g.setPositionRound(t.currentDesc.position.x,t.currentDesc.position.y+a.height/2),a.addChild(g);var v=new cc.Sprite(bundles.menubar.frames.coin_png);v.setScale(t.button.coin.scale);var m=cleverapps.UI.generateImageText(WardrobeWindow.prices[e],cleverapps.styles.FONTS.WARDROBE_BUY_BUTTON_TEXT||cleverapps.styles.FONTS.BUTTON_SMALL_TEXT),f=new cleverapps.Layout([m,v],{direction:cleverapps.UI.HORIZONTAL,margin:t.button.margin}),_=new cleverapps.UI.Button({content:f,width:t.button.width,height:t.button.height,padding:t.button.padding,
onClicked:function(){this.buyDecoration(e,WardrobeWindow.prices[e],WardrobeWindow.stages[e]-s)}.bind(this),button_png:t.button.button_png,button_on_png:t.button.button_on_png}),y=cleverapps.UI.generateOnlyText("messages:WardrobeBuyText",cleverapps.styles.FONTS.WINDOW_SMALL_TEXT);y.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER),y.setDimensions(t.buttonContainer.width,0),y.fitTo(void 0,t.buttonContainer.height);var w=new cleverapps.Layout([y,_],{direction:cleverapps.UI.VERTICAL,margin:t.buttonContainer.margin});w.setPositionRound(t.buttonContainer.position.x,t.buttonContainer.position.y+a.height/2),a.addChild(w)}var b=WardrobeWindow.prizes[e+1];if(b&&!i){var T=new cc.Node;T.setAnchorPoint2(),T.setPositionRound(t.present.x,t.present.y),T.setContentSize2(t.present.width,t.present.height);var S=new cleverapps.Spine(t.present.animation.json,t.present.scale);S.setAnimation(0,t.present.animation.animation,!0),t.present.animation.skin&&S.setSkin(t.present.animation.skin),b.skin&&S.setSkin(
b.skin),T.addChild(S),S.setPositionRound(T.width/2,T.height/2),cleverapps.tooltipManager.create(T,{rewards:b.prize,text:"messages:WardrobePrizeRewardTitle",position:cleverapps.styles.UI.Tooltip.LOCATION.above}),a.addChild(T,t.present.zOrder?t.present.zOrder:-1)}return i||o||p.setOpacity(80),r}});WardrobeWindow.prototype.listBundles=function(){return["wardrobe_window"]},WardrobeWindow.stages=[1,2,3,4,5,5,5,5,5,5,5,5],WardrobeWindow.prices=[100,150,300,350,650,1e3,1250,1500,2e3,2500,3e3,3500],WardrobeWindow.prizes={4:{prize:{gold:100},skin:"pink"},8:{prize:{gold:300},skin:"blue"},12:{prize:{gold:500},skin:"green"}},cleverapps.styles.WardrobeWindow={eventName:"wardrobe",HelpButton:{x:{align:"left",dx:64},y:{align:"bottom",dy:64}},CloseButton:{},timer:{font:cleverapps.styles.FONTS.SMALL_WHITE_TEXT,offsetY:-2,regularFont:{offsetY:-2},position:{x:{align:"center",dx:0},y:{align:"bottom",dy:4}},bg:{width:180,height:50,image:bundles.wardrobe_window.frames.progress_bg}},person:{
json:bundles.hero.jsons.hero_json,scale:.65,width:200,height:200,position:{x:-80,y:44}},banner:{position:{x:0,y:130}},stages:{bg:bundles.wardrobe_window.frames.window_table_bg,width:596,height:506,padding:14,margin:14,stage:{bg:bundles.main.frames.row_player_png,width:566,height:150,present:{x:160,y:97,iconDelta:20,width:100,height:100,scale:.55,animation:{json:bundles.windows.jsons.present_json,animation:"animation"}},currentDesc:{margin:6,position:{x:270,y:0}},buttonContainer:{width:140,height:60,position:{x:470,y:0},margin:2},button:{width:160,height:74,button_png:bundles.buttons_main.frames.small_green_button,button_on_png:bundles.buttons_main.frames.small_green_button_on,margin:4,coin:{scale:.46}},progress:{width:200,height:28,padding:{x:2,y:2},bg:bundles.wardrobe_window.frames.progress_bg,line:bundles.wardrobe_window.frames.progress_fill},text:{width:330,position:{x:360,y:0}},icon:{scale:.8,position:{x:80,y:0},passedMark:{icon:bundles.main.frames.goal_done_sign,scale:1,position:{
x:60,y:-26}}}}},width:520,height:800,content:{margin:30,position:{x:0,y:-40}},text:{height:180},button:{button_png:bundles.buttons_main.frames.red_button,button_on_png:bundles.buttons_main.frames.red_button_on,width:250,height:100}};var WardrobeReceiveWindow=Window.extend({onWindowLoaded:function(e){this.mission=e;var t=cleverapps.styles.WardrobeReceiveWindow;this._super({name:"wardrobereceivewindow",content:this.generateContent(),closeButton:!1,button:{width:t.button.width,height:t.button.height,text:Messages.get("OK"),onPressed:this.close.bind(this)}})},onShow:function(){this.runAction(new cc.Sequence(new cc.DelayTime(.1),new cc.CallFunc(function(){this.visible&&cleverapps.audio.playSound(bundles.main.urls.reward_window_effect)}.bind(this))))},personAnimation:function(){var e=cleverapps.styles.WardrobeReceiveWindow;this.person.setAnimation(0,e.person.actionAnimation,!1),this.person.setCompleteListener(function(){this.person.setCompleteListener(function(){}),this.person.setAnimation(0
,"idle",!0),this.personNode.runAction(new cc.Sequence(new cc.DelayTime(5),new cc.CallFunc(this.personAnimation.bind(this))))}.bind(this))},generateContent:function(){var e=cleverapps.styles.WardrobeReceiveWindow,t=new cc.Node;t.setContentSize2(e.width,e.height),t.setAnchorPoint2(),this.personNode=new cc.Node,this.personNode.setContentSize2(e.personNode.width,e.personNode.height),this.personNode.setAnchorPoint2(),this.person=new cleverapps.Spine(e.person.json,e.person.scale),this.personNode.addChild(this.person),this.person.setPositionRound(e.person.position);var n=cleverapps.UI.generateTTFText("messages:WardrobeRecieveText",cleverapps.styles.FONTS.WINDOW_TEXT);n.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER),n.setDimensions(t.width,0);var s=new cleverapps.Layout([this.personNode,n],{direction:cleverapps.UI.VERTICAL,margin:e.content.margin});return s.setPositionRound(t.width/2+e.content.position.x,t.height/2+e.content.position.y),t.addChild(s),this.personAnimation(),t}})
;WardrobeReceiveWindow.prototype.listBundles=function(){return["wardrobe_window"]},cleverapps.styles.WardrobeReceiveWindow={width:520,height:500,personNode:{width:300,height:500},person:{json:bundles.hero.jsons.hero_json,actionAnimation:"idle_jump",scale:.9,position:{x:{align:"center"},y:{align:"center"}}},content:{margin:50,position:{x:0,y:90}},button:{width:250,height:100}};var WardrobeRulesWindow=Window.extend({onWindowLoaded:function(e){this.mission=e,this.wardrobeBundle=bundles[cleverapps.skins.getBundle()||e.feature];var t=cleverapps.styles.WardrobeRulesWindow;this._super({name:"wardroberuleswindow",content:this.generateContent(),button:{width:t.button.width,height:t.button.height,text:Messages.get("OK")}})},scrollToStage:function(e){var t=0;0<e&&((t=this.stageNodes[this.skin-1].x-this.stagesLayout.width/2)<0&&(t=0),t>this.stagesList.width-this.stagesLayout.width&&(t=this.stagesList.width-this.stagesLayout.width));this.stagesList.runAction(new cc.MoveTo(.3,{x:-t,
y:this.stagesList.y}))},updateSkin:function(){void 0===this.skin?this.skin=0:(0!==this.skin&&this.stageNodes[this.skin-1].setOpacity(100),this.skin=(this.skin+1)%(WardrobeWindow.stages.length+1),0!==this.skin&&this.stageNodes[this.skin-1].setOpacity(255)),this.person.setSkin("skin_"+this.skin);var e=cleverapps.styles.WardrobeRulesWindow.states[this.skin];e.mirror?this.personNode.setScaleX(-1):this.personNode.setScaleX(1),this.scrollToStage(this.skin),e.animation&&(this.person.setAnimation(0,e.animation,!1),this.person.setCompleteListener(function(){this.person.setAnimation(0,"idle",!0)}.bind(this))),e.sound&&cleverapps.audio.playSound(e.sound),this.person.runAction(new cc.Sequence(new cc.DelayTime(e.time),new cc.CallFunc(function(){this.updateSkin()}.bind(this))))},onClose:function(){new WardrobeWindow(this.mission)},generateContent:function(){var e=cleverapps.styles.WardrobeRulesWindow,t=new cc.Node;t.setContentSize2(e.width,e.height),t.setAnchorPoint2()
;var n=this.personNode=new cc.Node;n.setAnchorPoint2(),n.setContentSize(e.person.width,e.person.height),this.person=new cleverapps.Spine(e.person.json,e.person.scale),this.person.setAnimation(0,"idle",!0),n.addChild(this.person),this.person.setPositionRound(e.person.position),this.stageNodes=[];for(var s=0;s<WardrobeWindow.stages.length;s++){var i=new cc.Sprite(this.wardrobeBundle.frames["stage"+(s+1)+"_icon"]);i.setScale(e.icon.scale),i.setOpacity(100),this.stageNodes.push(i)}this.stagesList=new cleverapps.Layout(this.stageNodes,{direction:cleverapps.UI.HORIZONTAL,margin:e.icon.margin}),this.stagesLayout=new ccui.Layout,this.stagesLayout.addChild(this.stagesList),this.stagesLayout.setClippingEnabled(!0),this.stagesLayout.setContentSize2(e.icons.width,e.icons.height),this.stagesLayout.setAnchorPoint2(),this.stagesList.setAnchorPoint2(0,.5),this.stagesList.setPositionRound(0,this.stagesLayout.height/2),this.updateSkin();var o=cleverapps.UI.generateTTFText("messages:WardrobeRulesText",
cleverapps.styles.FONTS.WINDOW_SMALL_TEXT);o.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER),o.setDimensions(t.width,0),o.fitTo(void 0,e.text.height);var r=new cleverapps.Layout([o,this.stagesLayout,n],{direction:cleverapps.UI.VERTICAL,margin:e.content.margin});return r.setPositionRound(t.width/2+e.content.position.x,t.height/2+e.content.position.y),t.addChild(r),t}});WardrobeRulesWindow.prototype.listBundles=function(){return["wardrobe_window"]},cleverapps.styles.WardrobeRulesWindow={width:520,height:780,icons:{width:500,height:110},icon:{scale:.55,margin:15},person:{json:bundles.hero.jsons.hero_json,scale:1,width:200,height:260,position:{x:{align:"center"},y:{align:"center"}}},text:{height:260},content:{margin:30,position:{x:0,y:-40}},button:{width:250,height:100},states:[{time:1,mirror:!1},{time:1,mirror:!1},{animation:"idle_jump",time:2,mirror:!1},{time:1,mirror:!0},{animation:"idle_jump",time:2,mirror:!0},{time:1,mirror:!1},{animation:"idle_jump",time:2,mirror:!1},{time:1,
mirror:!0},{animation:"idle_jump",time:2,mirror:!0},{time:1,mirror:!1},{animation:"idle_jump",time:2,mirror:!1},{time:1,mirror:!0},{animation:"idle_jump",time:5,mirror:!0}]};var Favorite=function(e){this.mission=e,this.productId=Favorite.CalcFavorite(),this.product=Product.Create(this.productId),this.product.favorite=!0};Favorite.prototype.getReward=function(){return RewardsConfig.Favorite[this.productId]},Favorite.prototype.isPackProduct=function(){return-1!==Favorite.PACK_PRODUCTS.indexOf(this.productId)},Favorite.CalcFavorite=function(){return cleverapps.paymentsHistory.calcFavoriteProduct(Favorite.ListProducts())},Favorite.ListProducts=function(){return"match3"===cleverapps.config.type||-1!==["scramble","tripeaks"].indexOf(cleverapps.config.name)?Favorite.PACK_PRODUCTS.concat(Favorite.COIN_PRODUCTS):Favorite.COIN_PRODUCTS},Favorite.IsAvailable=function(){return void 0!==Favorite.CalcFavorite()},Favorite.PACK_PRODUCTS=["jamPack","tastyPack","honeyPack","epicPack","sweetPack"],
Favorite.COIN_PRODUCTS=["gold1800","gold3800","gold6000","gold25000"];var BoostersSale=function(e){this.mission=e,this.reward=void 0,this.onRewardListener=function(){}};BoostersSale.prototype.listProducts=function(){var e=this.mission.productsExpensive;switch(cleverapps.paymentsHistory.classify()){case cleverapps.PaymentsHistory.PAYER_NONE:case cleverapps.PaymentsHistory.PAYER_WEAK:e=this.mission.productsCheap}return e},BoostersSale.prototype.onUpdate=function(){this.mission.result===BoostersSale.PURCHASES_LIMIT&&(this.reward=this.mission.prize,this.onRewardListener(),this.mission.complete())},BoostersSale.PURCHASES_LIMIT=5;var EnergyFeast=function(e,t){this.mission=e,t&&Game.currentGame.pixelsPlanner.restart()},WardRobeMissionLogic=function(e){this.mission=e,this.refreshSkin(this.mission)};WardRobeMissionLogic.prototype.refreshSkin=function(){var t=void 0;["valentines","xmas","memorial"].forEach(function(e){-1!==cleverapps.eventManager.listCurrentFeatures().indexOf(e)&&(t=e)})
;var e=t?"wardrobe_"+t:"wardrobe",n=t?bundles[t].jsons.hero_json:bundles.hero.jsons.hero_json,s="skin_"+this.getCurrentStage(this.mission).stage;cleverapps.Spine.updateSkin(e,n,s),cleverapps.user.trigger("heroSkinUpdated",s)},WardRobeMissionLogic.prototype.onUpdate=function(){this.refreshSkin(this.mission)},WardRobeMissionLogic.prototype.skipNext=function(){return this.mission.isRunning()&&this.stageToShow},WardRobeMissionLogic.prototype.getCurrentStage=function(){for(var e=0,t=this.mission.result;t>=WardrobeWindow.stages[e];)t-=WardrobeWindow.stages[e],e++;return e===WardrobeWindow.stages.length?{stage:e,finished:!0}:{stage:e,progress:t}},WardRobeMissionLogic.prototype.getProgressForStage=function(e){var t=0;return WardrobeWindow.stages.slice(0,e).forEach(function(e){t+=e}),t},WardRobeMissionLogic.prototype.runReceiveDialogue=function(e){for(var t=[],n="WardrobeDialogue.stage"+(this.getCurrentStage().stage-1)+".text",s=0;Messages.has(n+s);s++)t.push({text:Messages.get(n+s)});if(
t.length){var i=new Dialogue(t,{showUp:!0}),o=function(){i.stage>=i.data.length-1&&i.close()};i.on("afterClose",e),i.on("buttonClicked",o),i.on("screenClicked",function(){i.typing||o()}),new DialogueView(i,{overlay:!0}),i.run()}else e()},WardRobeMissionLogic.prototype.givePrize=function(e,t){var n=WardrobeWindow.prizes[e];if(n){var s=cleverapps.styles.FONTS.WINDOW_TITLE_TEXT;cleverapps.styles.FONTS.SMALL_TITLE_TEXT&&cleverapps.eventManager.isActive("valentines")&&(s=cleverapps.styles.FONTS.SMALL_TITLE_TEXT),new RewardWindow({title:{text:"messages:WardrobePrizeRewardTitle",font:s},callback:t,reward:n.prize})}else t()},WardRobeMissionLogic.prototype.processEvent=function(e,t){if(e===Mission.EVENT_LEVEL_FINISH&&this.mission.isRunning()&&(t.level.isRegular()&&t.level.isNew()||t.level.episode.isDailyCup())){var n=this.getCurrentStage().stage;this.mission.update(1);var s=this.getCurrentStage().stage;s!==n&&(this.stageToShow=s)}},WardRobeMissionLogic.IsAvailable=function(){return-1!==[
"wordsoup","crocword","scramble"].indexOf(cleverapps.config.name)};var LanternMissionLogic=function(e){this.mission=e,this.lantern=new Lantern(e)};LanternMissionLogic.prototype.giveBonus=function(e,t){this.lantern.isActive(t)&&0<this.lantern.getCurrentStreak()?cleverapps.metha.compound(e,[function(e){new LanternView(this.lantern).show(),Game.counter.setTimeout(e,1e3*cleverapps.styles.LanternView.show.delay)}.bind(this),function(e){this.lantern.giveBonus(e)}.bind(this)]):e()},LanternMissionLogic.IsAvailable=function(){return levels.user.checkAvailable(LanternMissionLogic.AVAILABLE)},LanternMissionLogic.AVAILABLE={adventure:{debugMode:!0}},Mission.EVENT_LEVEL_FINISH=0,Mission.EVENT_COLLECT_COLOR_CELLS=1,Mission.EVENT_COLLECT_HERO_CELLS=2,Mission.EVENT_USE_MULTI_COLOR_CELL=3,Mission.EVENT_COMPLETE_DAILY_TASK=4,Mission.EVENT_PLAY_DAILYCUP=5,Mission.EVENT_COLLECT_CLOVER=6,Mission.EVENT_COLLECT_STARS=7,Mission.EVENT_WIN_DAILYCUP=8,Mission.EVENT_PASS_LEVELS_IN_ROW=9,
Mission.EVENT_UNIT_BUILT=10,Mission.TYPE_COMBO=0,Mission.TYPE_COLLECT_MARK=1,Mission.TYPE_BURN_NEARBY=2,Mission.TYPE_LETTER=3,Mission.TYPE_TREASURE_SEARCH=7,Mission.TYPE_LANTERN=9,Mission.TYPE_WARDROBE=10,Mission.TYPE_FAVORITE_SALE=11,Mission.TYPE_LIVES_SALE=12,Mission.TYPE_BOOSTERS_SALE=13,Mission.TYPE_COINS_SALE=14,Mission.TYPE_BATTLEPASS=15,Mission.TYPE_RACE=16,Mission.TYPE_RAFFLE=17,Mission.TYPE_STICKERS_COLLECTION=18,Mission.TYPE_BONUS_WORLD=19,Mission.TYPE_ENERGY_FEAST=20,Mission.TYPE_SLOT_MACHINE=21;var Missions={SEMAPHORE_CLASSIC:1,SEMAPHORE_BACKGROUND:2,SEMAPHORE_LANTERN:4,SEMAPHORE_WARDROBE:8,SEMAPHORE_SALE:16,SEMAPHORE_BATTLEPASS:32,SEMAPHORE_RAFFLE:64,SEMAPHORE_BONUS_WORLD:128,SEMAPHORE_SLOT_MACHINE:256,SEMAPHORE_MERGE_EVENTS:512,initialize:function(){var e={available:{episode:1,level:11,social:!0},view:MissionWindow,duration:"1 day",semaphore:Missions.SEMAPHORE_CLASSIC,cooldown:"1 minute",startWindow:MissionRulesWindow,prize:RewardsConfig.Tournament.places,autoComplete:!0}
;Missions[Mission.TYPE_COMBO]=cleverapps.extend({},e,{available:{episode:2,level:7,social:!0},name:"MagicTournament",icon:bundles.main.frames.clover_png,gameIcon:bundles.game.frames.clover_png,competition:{step:[5,20],amount:[20,30]},bundle:"magic_tournament",sideBarJson:bundles.sidebar.jsons.tournament_magic_icon_json,finishView:MissionWindow}),Missions[Mission.TYPE_COLLECT_MARK]=cleverapps.extend({},e,{available:{episode:1,level:12,social:!0},name:"RoseTournament",icon:bundles.main.frames.rose_png,gameIcon:bundles.game.frames.rose_png,competition:{step:[10,40],amount:[20,30]},bundle:"rose_tournament",sideBarJson:bundles.sidebar.jsons.tournament_rose_icon_json,finishView:MissionWindow,lockedTip:function(e){return Messages.get("UnlockOnLevel",{level:cleverapps.humanReadableNumber(e.episode,e.level)})}}),Missions[Mission.TYPE_BURN_NEARBY]=cleverapps.extend({},e,{available:{episode:2,level:3,social:!0},name:"TulpanTournament",icon:bundles.main.frames.tulpan_png,
gameIcon:bundles.game.frames.tulpan_png,competition:{step:[3,10],amount:[20,30]},bundle:"tulpan_tournament",sideBarJson:bundles.sidebar.jsons.tournament_tulpan_icon_json,finishView:MissionWindow}),Missions[Mission.TYPE_LETTER]=cleverapps.extend({},e,{name:"LetterTournament",icon:bundles.main.frames.mission_letter_png,gameIcon:bundles.game.frames.mission_letter_png,competition:{step:[2,6],amount:[20,30]},cooldown:"2 days",sideBarJson:bundles.sidebar.jsons.mission_letter_icon_json,finishView:MissionWindow,bundle:"letter_tournament",STAR_TYPES_AMOUNT:2}),Missions[Mission.TYPE_TREASURE_SEARCH]=cleverapps.extend({},e,{available:{episode:2,level:7,social:!1},name:"TreasureSearch",view:TreasureSearchWindow,icon:bundles.game.frames.shovel,minigame:{price:1},prize:RewardsConfig.TreasureSearch,startWindow:TreasureSearchWindow,nudgeWindow:TreasureSearchWindow,duration:"3 days",semaphore:Missions.SEMAPHORE_BACKGROUND,cooldown:"3 days",bundle:"treasuresearch",
sideBarJson:bundles.sidebar.jsons.treasure_search_icon_json}),Missions[Mission.TYPE_STICKERS_COLLECTION]=cleverapps.extend({},e,{available:{episode:2,level:7,social:!0},name:"StickersCollection",view:StickersCollectionWindow,minigame:{price:1},prize:RewardsConfig.StickersCollection,startWindow:StickersCollectionWindow,nudgeWindow:StickersCollectionWindow,duration:"3 days",semaphore:Missions.SEMAPHORE_BACKGROUND,cooldown:"3 days",bundle:"stickers_collection",sideBarJson:bundles.sidebar.jsons.stickers_collection_icon_json,logic:StickersCollectionLogic,startCurrency:0,tournament:!0}),Missions[Mission.TYPE_LANTERN]=cleverapps.extend({},e,{available:{episode:4,level:3,social:!1},name:"Lantern",view:LanternWindow,duration:"2 day",semaphore:Missions.SEMAPHORE_LANTERN,cooldown:"5 days",startWindow:LanternWindow,sideBarJson:bundles.sidebar.jsons.lantern_icon_json,iconForce:Forces.LANTERN,logic:LanternMissionLogic,prize:void 0}),Missions[Mission.TYPE_WARDROBE]=cleverapps.extend({},e,{available:{
episode:1,level:11,social:!1},name:"Wardrobe",view:WardrobeWindow,semaphore:Missions.SEMAPHORE_WARDROBE,startWindow:WardrobeRulesWindow,logic:WardRobeMissionLogic,sideBarJson:bundles.sidebar.jsons.wardrobe_icon_json,feature:"wardrobe"}),Missions[Mission.TYPE_RACE]=cleverapps.extend({},e,{name:"Race",view:RaceScene,semaphore:Missions.SEMAPHORE_BATTLEPASS,startWindow:void 0,finishView:RaceScene,logic:RaceMissionLogic,sideBarJson:bundles.sidebar.jsons.race_icon_json,iconForce:Forces.RACE,feature:"race",cooldown:"8 days",competition:{amount:[4,4],superBots:[1,2],superBotsForce:CompetitionAlgorithm.BOT_SUPER_FORCE,minBotForce:5},available:{episode:2,level:1}}),Missions[Mission.TYPE_FAVORITE_SALE]=cleverapps.extend({},e,{priority:5,name:"FavoriteSale",view:FavoriteSaleWindow,semaphore:Missions.SEMAPHORE_SALE,startWindow:FavoriteSaleWindow,logic:Favorite,sideBarJson:bundles.sidebar.jsons.lives_sale_icon_json,prize:RewardsConfig.Sale,feature:"favorite"}),
Missions[Mission.TYPE_LIVES_SALE]=cleverapps.extend({},e,{name:"LivesSale",view:BoostersSaleWindow,semaphore:Missions.SEMAPHORE_SALE,startWindow:BoostersSaleWindow,logic:BoostersSale,sideBarJson:bundles.sidebar.jsons.lives_sale_icon_json,prize:RewardsConfig.Sale,feature:"lives",productsCheap:["unlimitedLives05","lives074","exp1"],productsExpensive:["unlimitedLives2","lives3","exp4"],available:{episode:1,level:1}}),-1!==["tripeaks","scramble"].indexOf(cleverapps.config.name)&&(Missions[Mission.TYPE_FAVORITE_SALE].sideBarJson=bundles.sidebar.jsons.favorite_sale_icon_json),"match3"!==cleverapps.config.type&&(Missions[Mission.TYPE_LIVES_SALE].productsCheap=cleverapps.substract(Missions[Mission.TYPE_LIVES_SALE].productsCheap,["exp1"]),Missions[Mission.TYPE_LIVES_SALE].productsExpensive=cleverapps.substract(Missions[Mission.TYPE_LIVES_SALE].productsExpensive,["exp4"])),Missions[Mission.TYPE_BOOSTERS_SALE]=cleverapps.extend({},e,{name:"BoostersSale",view:BoostersSaleWindow,
semaphore:Missions.SEMAPHORE_SALE,startWindow:BoostersSaleWindow,sideBarJson:bundles.sidebar.jsons.boosters_sale_icon_json,logic:BoostersSale,prize:RewardsConfig.Sale,feature:"boosters",productsCheap:["cellPack05","linePack074","colorPack10"],productsExpensive:["cellPack2","linePack3","colorPack4"],available:{episode:1,level:1}}),"stacks"===cleverapps.config.subtype&&(Missions[Mission.TYPE_BOOSTERS_SALE].productsCheap=["hintBoosterBeforePack3","eyePack2","highlightPack1"],Missions[Mission.TYPE_BOOSTERS_SALE].productsExpensive=["hintBoosterBeforePack3","eyePack2","highlightPack1"]),Missions[Mission.TYPE_COINS_SALE]=cleverapps.extend({},e,{name:"CoinsSale",view:BoostersSaleWindow,semaphore:Missions.SEMAPHORE_SALE,startWindow:BoostersSaleWindow,sideBarJson:bundles.sidebar.jsons.coins_sale_icon_json,logic:BoostersSale,prize:RewardsConfig.Sale,feature:"coins",productsCheap:["gold500sale","gold1800sale"],productsExpensive:["gold500sale","gold1800sale"],available:{episode:1,level:1}}),
Missions[Mission.TYPE_RAFFLE]=cleverapps.extend({},e,{name:"Raffle",view:RaffleWindow,semaphore:Missions.SEMAPHORE_RAFFLE,startWindow:RaffleWindow,sideBarJson:bundles.sidebar.jsons.raffle_icon_json,logic:RaffleMissionLogic,finishView:void 0,prize:void 0,feature:"raffle",available:{episode:2,level:0}}),Missions[Mission.TYPE_BONUS_WORLD]=cleverapps.extend({},e,{name:"BonusWorld",startWindow:void 0,view:BonusWorldScene,semaphore:Missions.SEMAPHORE_BONUS_WORLD,available:{episode:1,level:14},logic:BonusWorldMissionLogic,sideBarJson:function(e){return BonusWorldConfig[e.bonusWorld.type].sideBarJson},feature:"bonusworld",oncePerEvent:!cleverapps.config.debugMode,iconForce:Forces.BONUS_WORLD}),void 0!==EnergyFeastMissionWindow&&(Missions[Mission.TYPE_ENERGY_FEAST]=cleverapps.extend({},e,{available:{level:5},name:"EnergyFeast",duration:"3 day",cooldown:"1 month",semaphore:Missions.SEMAPHORE_MERGE_EVENTS,icon:bundles.reward_icons.frames.reward_energy_png,
gameIcon:bundles.reward_icons.frames.reward_energy_png,competition:{step:[3,3,3,5,5,5,10,10,15,20,25],amount:[20,30],noPlayerEpisodeCoef:!0,botAheadPlayerCoef:.5,botAheadPlayerBigDifferenceCoef:.2,bigDistanceLength:100},logic:EnergyFeast,bundle:"energy_feast",sideBarJson:bundles.sidebar.jsons.energy_feast_icon_json,view:EnergyFeastMissionWindow,startWindow:EnergyFeastMissionWindow,finishView:void 0,autoComplete:!1})),Missions[Mission.TYPE_BATTLEPASS]=cleverapps.extend({},e,{name:"BattlePass",semaphore:Missions.SEMAPHORE_BATTLEPASS,view:BattlePassWindow,startWindow:BattlePassWindow,finishView:void 0,logic:BattlePassMissionLogic,sideBarJson:bundles.sidebar.jsons.battlepass_icon_json,cooldown:"1 month",duration:"7 days",available:{level:7},autoComplete:!1}),"merge"===cleverapps.config.type&&cleverapps.override(Missions[Mission.TYPE_BATTLEPASS],{semaphore:Missions.SEMAPHORE_MERGE_EVENTS}),Missions[Mission.TYPE_SLOT_MACHINE]=cleverapps.extend({},e,{name:"SlotMachine",startWindow:void 0,
view:SlotMachineScene,semaphore:Missions.SEMAPHORE_SLOT_MACHINE,available:{episode:1,level:14},logic:SlotMachineMissionLogic,sideBarJson:bundles.sidebar.jsons.slot_machine_json,feature:"slotmachine",iconForce:Forces.SLOT_MACHINE_ICON}),"olympics"===cleverapps.config.name&&cleverapps.override(Missions[Mission.TYPE_LIVES_SALE],{productsCheap:["unlimitedLives05","lives074","gold1"],productsExpensive:["unlimitedLives2","lives3","gold4"],sideBarJson:bundles.sidebar.jsons.lives_sale_json}),"match3"===cleverapps.config.type&&(Missions[Mission.TYPE_BONUS_WORLD].available={episode:5,level:10})}},CurrentEpisodeLabel=cc.Node.extend({ctor:function(e,t){this._super(),this.episode=e,this.createContent(),this.setAnchorPoint2(),this.setPositionRound({x:{align:"center"},y:{align:"center"}}),this.setLocalZOrder(1)},createContent:function(){this.bg=this.createBg();var e=this.label=new cc.Node;e.setAnchorPoint2(),e.setContentSize2(this.bg.getContentSize()),e.addChild(this.bg),e.setPositionRound(
cleverapps.styles.CurrentEpisodeLabel.label.alignment),this.addLabelText(),this.setContentSize2(e.getContentSize()),this.addChild(this.label)},createBg:function(){var e,t=cleverapps.styles.CurrentEpisodeLabel.background;if(t.json){(e=new cc.Node).setAnchorPoint2(),e.setContentSize2(t);var n=this.bgAnimation=new cleverapps.Spine(t.json);n.setAnimation(0,"idle",!1),n.setPosition(e.width/2,e.height/2),e.addChild(n)}else e=cleverapps.UI.createScale9Sprite(t.image,cleverapps.UI.Scale9Rect.TwoPixelXY),t.width&&e.setContentSize2(t);return e.setPosition(e.width/2,e.height/2),e},addLabelText:function(){var e=cleverapps.styles.CurrentEpisodeLabel.label.islandText,t=this.labelText=cleverapps.UI.generateTTFText("messages:StartEpisodeWindow.Title"+this.episode.episodeNo,e.font);t.fitTo(this.bg.width+e.padding),t.setPositionRound(e.alignment),this.label.addChild(t)},addLevelsLabel:function(){var e=cleverapps.styles.CurrentEpisodeLabel.label.levelsText;if(e){var t=this.episode.levels.filter(function(
e){return e.type===Episode.LEVEL_TYPE_PASSED}).length,n=this.episode.levels.length,s=cleverapps.UI.generateTTFText(t+"/"+n,e.font);s.setPositionRound(e.alignment),this.label.addChild(s)}}});cleverapps.MiniGame=function(e){cleverapps.config.debugMode&&(cleverapps.MiniGame.TIMEOUT="60 seconds"),cleverapps.DailyChest.call(this,{isNewUser:e,serverTaskName:"bonuses",interval:cleverapps.parseInterval(cleverapps.MiniGame.TIMEOUT)}),this.closedText="messages:MiniGame.ClosedText"},cleverapps.MiniGame.prototype=Object.create(cleverapps.DailyChest.prototype),cleverapps.MiniGame.prototype.constructor=cleverapps.MiniGame,cleverapps.MiniGame.prototype.initializeForNewUser=function(){this.locked=!1,this.setWhenUnlock(Date.now())},cleverapps.MiniGame.TIMEOUT="1 day",cleverapps.MiniGame.prototype.resetUnlockCountdown=function(){cleverapps.DailyChest.prototype.resetUnlockCountdown.call(this),cleverapps.localPushes.sendPush(cleverapps.LocalPushes.TYPES.MINI_GAME,this.when-Date.now())},
cleverapps.MiniGame.prototype.refreshItems=function(){},cleverapps.MiniGame.prototype.isAvailable=function(){return!!levels.user.checkAvailable(cleverapps.MiniGame.AVAILABLE)&&!this.locked},cleverapps.MiniGame.prototype.getReward=function(){cleverapps.history.add("drwrd",1);var e=cleverapps.Random.choose(RewardsConfig.MiniGame);return levels.user.isBeginner()&&RewardsConfig.MiniGameBeginner&&(e=cleverapps.Random.choose(RewardsConfig.MiniGameBeginner)),levels.user.isNovice()&&RewardsConfig.MiniGameNovice&&(e=cleverapps.Random.choose(RewardsConfig.MiniGameNovice)),e.betGold&&delete e.betGold,e=cleverapps.user.prepareRewardByRich(e)},cleverapps.MiniGame.prototype.openWindow=function(e){if(cleverapps.periodicBonus.locked)cleverapps.Notification.create(cleverapps.periodicBonus.closedText),e&&e();else{var t=cleverapps.clone(cleverapps.periodicBonus.getReward(),!0);new MiniGameWindow(t),e&&(cleverapps.metha.onceNoWindowsListener=e)}},cleverapps.MiniGame.AVAILABLE={episode:1,level:1,
registered:"1 hour"};var MiniGameWindow=Window.extend({onWindowLoaded:function(e){this.reward=e;var i=cleverapps.styles.MiniGameWindow,o=this.content=new cc.Node;o.setAnchorPoint(.5,.5),o.setContentSize2(i.width,i.height),this.createText(),this.boxes=[],i.boxes.reverse().forEach(function(e,t){var n=new cc.Node;n.setAnchorPoint(.5,.5),n.setContentSize2(i.box),n.setPositionRound(o.width/2+e.x,o.height/2+e.y),n.setScale(i.box.scale),n.baseScale=i.box.scale;var s=n.animation=new cleverapps.Spine(i.animation.json);n.addChild(s),e.skin&&s.setSkin(e.skin),s.setPositionRound(n.width/2-i.box.offsetX,n.height/2-i.box.offsetY),s.setAnimation(0,e.name||"animation",!0),o.addChild(n),this.onMouseOver&&(n.onMouseOver=this.onMouseOver.bind(this,n)),this.onMouseOut&&(n.onMouseOut=this.onMouseOut.bind(this,n)),cleverapps.UI.applyHover(n),cleverapps.UI.onClick(n,this.onPressed.bind(this,n),{noThrottle:i.noThrottle}),this.boxes.push(n)},this);var t=cleverapps.overrideStyles(cleverapps.styles.Window,
cleverapps.styles.MiniGameWindow.window,!0);this._super({title:this.getTitle(),name:"minigamewindow",content:o,closeButton:!1,notCloseByTouchInShadow:!0,styles:t,shareCheckBox:this.getShareOptions(),buttons:this.getButtons()}),cleverapps.audio.playSound(bundles.main.urls.window_effect)},getTitle:function(){return"messages:MiniGameWindow.Title"},createText:function(){var e=cleverapps.styles.MiniGameWindow,t=cleverapps.UI.generateTTFText("messages:MiniGameWindow.Text",cleverapps.styles.FONTS.WINDOW_TEXT);t.setPositionRound(this.content.width/2+e.text.x,this.content.height/2+e.text.y),this.content.addChild(t),this.text=t},getShareOptions:function(){},onShow:function(){this.showUpAnimation(),this.isOpened||this.setCustomCursor()},onHide:function(){this.boxes&&this.boxes.forEach(function(e){e.stopAllActions()}),this.text&&this.text.stopAllActions(),this.hint&&(this.hint.removeFromParent(),delete this.hint),this.setDefaultCursor()},close:function(){this.hint&&this.hint.close(),this._super()
},onClose:function(){this.setDefaultCursor()},showUpAnimation:function(){var e=this.boxes,n=e.map(function(e){return e.getPosition()}),s=[[2,0,1],[0,2,1],[1,0,2]];this.text.scale=0,e.forEach(function(e,t){e.runAction(new cc.Sequence(new cc.DelayTime(.5),new cc.MoveTo(.3,n[s[0][t]]),new cc.DelayTime(.1),new cc.CallFunc(function(){0===t&&cleverapps.audio.playSound(bundles.main.urls.daily_game_mix_effect)}),new cc.MoveTo(.3,n[s[1][t]]),new cc.DelayTime(.1),new cc.CallFunc(function(){0===t&&cleverapps.audio.playSound(bundles.main.urls.daily_game_mix_effect)}),new cc.MoveTo(.3,n[s[2][t]]),new cc.DelayTime(.1),new cc.CallFunc(function(){0===t&&cleverapps.audio.playSound(bundles.main.urls.daily_game_mix_effect)}),new cc.MoveTo(.3,n[t]),new cc.DelayTime(.3),new cc.CallFunc(function(){0===t&&this.text.runAction(new cc.ScaleTo(1,1).easing(cc.easeBackOut()))}.bind(this))))},this)},setDefaultCursor:function(){!cc.sys.isNative&&cleverapps.styles.MiniGameWindow.customCursor&&(
cc._canvas.style.cursor="default",this.onMouseMoveListener&&(cc.eventManager.removeListener(this.onMouseMoveListener),delete this.onMouseMoveListener,this.cursor&&(this.cursor.removeFromParent(!0),delete this.cursor)))},setCustomCursor:function(){!cc.sys.isNative&&cleverapps.styles.MiniGameWindow.customCursor&&"mouse"in cc.sys.capabilities&&(this.onMouseMoveListener=cc.eventManager.addListener({event:cc.EventListener.MOUSE,onMouseMove:function(e){return this.cursor||(cc._canvas.style.cursor="none",this.cursor=new cc.Sprite(bundles.daily_minigame_window.frames.daily_game_cursor_png),this.cursor.setAnchorPoint2(0,1),this.cursor.setLocalZOrder(10),this.window.addChild(this.cursor)),this.cursor.setPositionRound(this.window.convertToNodeSpace(e.getLocation())),!0}.bind(this)},this.window))},onPressed:function(e){new MiniGameRewardWindow(this.reward),this.close()},getButtons:function(){var e=cleverapps.styles.MiniGameWindow;if(!e.button)return[];var t=this.okButton=new cleverapps.UI.Button({
text:Messages.get("OK"),font:cleverapps.styles.FONTS.BUTTON_TEXT,width:e.button.width,height:e.button.height,onClicked:function(){this.close(),this.receiveReward()}.bind(this)});return t.setVisible(!1),[t]}});MiniGameWindow.prototype.listBundles=function(){return["reward_icons","daily_minigame_window"]},cleverapps.styles.MiniGameWindow={width:500,height:300,text:{x:0,y:-200},box:{width:150,height:150,scale:1,offsetX:0,offsetY:0},boxes:[{x:-180,y:-50,skin:"green",name:"animation"},{x:0,y:50,skin:"blue",name:"animation"},{x:180,y:-50,skin:"pink",name:"animation"}],animation:{json:bundles.windows.jsons.present_json},window:{decors:{}},noThrottle:!1};var MiniGameRewardWindow=RewardWindow.extend({ctor:function(e){this._super({reward:e})},onWindowLoaded:function(e){this._super({title:"messages:MiniGameRewardWindow.title",name:"minigamerewardwindow",buttonText:"OK",reward:e.reward,text:"messages:MiniGameRewardWindow.text",rewardName:"miniGame"})},onReceiveReward:function(){
cleverapps.eventLogger.logEvent(cleverapps.EVENTS.DAILY_BONUS)},receiveReward:function(){cleverapps.periodicBonus.locked||(cleverapps.periodicBonus.open(),this.onReceiveReward(),cleverapps.dailyTasks.addProgress(cleverapps.DailyTask.RECEIVE_PERIODIC_BONUS),cleverapps.Chest.prototype._receiveReward(this.reward))},getButtons:function(){var e=this.getDoubleButton();return e?[e]:[]}});cleverapps.styles.MiniGameRewardWindow={padding:{x:200,y:0}},cleverapps.UI.Tooltip=cc.Node.extend({ctor:function(e,t){this._super();var n=cleverapps.styles.UI.Tooltip,s=t.size||n.SIZE.medium;if(t.rewards?this.setContentSize2(s.width+n.rewards.extraWidth,s.height+n.rewards.extraHeight):this.setContentSize2(s),this.setAnchorPoint2(),this.bg=new cc.Scale9Sprite(bundles.tooltip.frames.tooltip_bg_png),this.addChild(this.bg),this.bg.setPositionRound(this.width/2,this.height/2),this.bg.setContentSize2(this.getContentSize()),void 0===t.arrow&&(t.arrow=t.position===n.LOCATION.below?n.ARROW.top:n.ARROW.bottom),
this.drawArrow(t.arrow),t.content){this.content=t.content,this.bg.addChild(this.content);var i=Math.min(this.width/(this.content.width*this.content.scaleX+n.content.padding),this.height/(this.content.height*this.content.scaleY+n.content.padding));i<1&&this.content.setScale(this.content.scaleX*i,this.content.scaleY*i),this.content.setPositionRound(this.width/2,this.height/2+n.content.offset.y)}else{var o=cleverapps.UI.generateOnlyText(t.text,cleverapps.styles.FONTS.TOOLTIP_TEXT);o.fitTo(this.width-n.content.padding);var r=o;if(t.rewards){var a=new TooltipRewardsView(t.rewards);r=new cleverapps.Layout([a,o],{direction:cleverapps.UI.VERTICAL,margin:n.rewards.margin})}r.setPositionRound(this.width/2,this.height/2+n.content.offset.y),this.bg.addChild(r)}t.control?cleverapps.metha.registerControl(t.control,function(e){e?this.show():this.hide()}.bind(this)):this.show(),this.target=e},hide:function(){this.stopAllActions();var e=.2*this.scale;this.runAction(new cc.Sequence(new cc.ScaleTo(e,0),
new cc.CallFunc(function(){this.content&&this.content.removeFromParent()}.bind(this)),new cc.RemoveSelf))},show:function(){this.stopAllActions(),this.setScale(.2),this.runAction(new cc.Sequence(new cc.CallFunc(function(){this.x-this.width/2<0&&(this.bg.x+=this.width/2-this.x+cleverapps.styles.UI.Tooltip.bgPadding),this.x+this.width/2>cc.director.getRunningScene().width&&(this.bg.x-=this.width/2-cc.director.getRunningScene().width+this.x+cleverapps.styles.UI.Tooltip.bgPadding)}.bind(this)),new cc.ScaleTo(.1,1))),this.runAction(new cc.Sequence(new cc.DelayTime(4),new cc.CallFunc(function(){this.hide()}.bind(this))))},drawArrow:function(e){var t=e===cleverapps.styles.UI.Tooltip.ARROW.bottom?new cc.Scale9Sprite(bundles.tooltip.frames.tooltip_shadow_arrow_png):new cc.Scale9Sprite(bundles.tooltip.frames.tooltip_arrow_png);this.addChild(t),t.setRotation(e.rotation),t.setPositionRound(e)}}),cleverapps.styles.UI.Tooltip={content:{padding:20,offset:{y:-4}},bgPadding:10,rewards:{extraWidth:0,
extraHeight:110,margin:10},SIZE:{short:{width:360,height:100},medium:{width:480,height:100},long:{width:600,height:100}},LOCATION:{above:{x:{align:"center",dx:0},y:{align:"top",dy:60},rewards:{x:{align:"center",dx:0},y:{align:"top",dy:120}}},below:{x:{align:"center",dx:0},y:{align:"bottom",dy:-72},rewards:{x:{align:"center",dx:0},y:{align:"bottom",dy:-142}}}},ARROW:{top:{x:{align:"center",dx:0},y:{align:"top",dy:20},rotation:180},bottom:{x:{align:"center",dx:0},y:{align:"bottom",dy:-16},rotation:0},left:{x:{align:"left",dx:-22},y:{align:"center",dy:0},rotation:90},right:{x:{align:"right",dx:22},y:{align:"center",dy:0},rotation:-90}}};var TooltipManager=function(){this.active=void 0;var e=cc._EventListenerTouchOneByOne.create();if(e.onTouchBegan=function(){this.onClick()}.bind(this),cc.eventManager.addListener(e,-1),"mouse"in cc.sys.capabilities){var t=cc._EventListenerMouse.create();t.onMouseScroll=function(){this.onClick()}.bind(this),cc.eventManager.addListener(t,-1)}}
;TooltipManager.prototype.create=function(n,s){n.tooltipListener&&this.remove(n),n.tooltipListener=cleverapps.UI.onClick(n,function(e){if(n.isDisplayed()){if(cleverapps.forces.isRunningForce()&&cleverapps.forces.closeRunningForce(),s.clickableArea){var t=s.clickableArea.convertToNodeSpace(n.convertToWorldSpace(e));cc.rectContainsPoint(cc.rect(0,0,s.clickableArea.width,s.clickableArea.height),t)&&cleverapps.tooltipManager.onClick(n,s)}else cleverapps.tooltipManager.onClick(n,s);s.hideHandler&&s.hideHandler.postponeHiding(4e3)}},{noThrottle:!0,swallowTouches:s.swallowTouches,ignoreOnTouchMoved:s.ignoreOnTouchMoved,ignoreOnTouchMovedThreshold:s.ignoreOnTouchMovedThreshold,useInteractiveScale:s.useInteractiveScale})},TooltipManager.prototype.remove=function(e){e.tooltipListener&&(cc.eventManager.removeListener(e.tooltipListener),delete e.tooltipListener)},TooltipManager.prototype.onClick=cleverapps.accumulate(0,function(e,t){if(e||this.active){var n=this.active&&this.active.target,
s=e&&n!==e;this.hide(),s&&this.show(e,t||{})}}),TooltipManager.prototype.show=function(e,t){var n=new cleverapps.UI.Tooltip(e,t);e.addChild(n),n.setPositionRound(t.rewards?t.position.rewards:t.position),n.replaceParentSamePlace(cc.director.getRunningScene()),n.registerCleanupCallback(function(){this.active===n&&delete this.active}.bind(this)),this.active=n},TooltipManager.prototype.hide=function(){this.active&&this.active.hide()};var TooltipRewardsView=cleverapps.Layout.extend({ctor:function(e){var o=cleverapps.styles.TooltipRewardsView,t=[];for(key in e.boosters)t.push({text:e.boosters[key],icon:o.boosters.icons[key]});e.unlimitedLives&&t.push({text:Product.FormatUnlimitedLives(e.unlimitedLives,!0).title,icon:bundles.reward_icons.frames.life_unlim_small,scale:o.unlimitedLives.scale,toReplace:{amount:e.unlimitedLives.amount}}),e.gold&&t.push({text:e.gold,icon:bundles.reward_icons.frames.gold_small_png,iconDy:o.goldIconDy}),e.exp&&t.push({text:e.exp,
icon:bundles.reward_icons.frames.reward_exp_png}),e.stars&&t.push({text:e.stars,icon:bundles.reward_icons.frames.stars_png});var n=t.map(function(e){var t=cleverapps.UI.generateTTFText(e.text,cleverapps.styles.FONTS.TOOLTIP_FONT,e.toReplace);o.textHeight&&t.fitTo(void 0,o.textHeight);var n=new cc.Sprite(e.icon);if(e.iconDy){var s=new cc.Node;s.setAnchorPoint2(),s.setContentSize2(n.getContentSize()),s.addChild(n),n.setPositionRound(s.width/2,s.height/2+e.iconDy),n=s}n.setScale(o.iconHeight/n.height*(e.scale?e.scale:1));var i=new cleverapps.Layout([t,n],{direction:cleverapps.UI.VERTICAL,margin:o.textMargin});return i.setAnchorPoint2(.5,1),i});this._super(n,{direction:cleverapps.UI.HORIZONTAL,margin:o.margin,align:o.align})}});cleverapps.styles.TooltipRewardsView={iconHeight:60,margin:30,textMargin:0,unlimitedLives:{scale:.95}};var Exclamation=function(){this.onShowListener=function(e){},this.onHideListener=function(){}};Exclamation.prototype.show=function(e,t){
this.enabled&&this.onShowListener(e,t)},Exclamation.prototype.setGame=function(e){this.game=e,this.game.onChangeOutcomeListeners.exclamation=this.disable.bind(this),this.enabled=!0},Exclamation.prototype.disable=function(){this.enabled=!1,delete this.game,this.onHideListener()},Exclamation.prototype.createView=function(){return-1!==["heroes","runes","mergeheroes"].indexOf(cleverapps.config.name)?new EXCLAMATIONS.heroes:-1!==["board","solitaire","differences"].indexOf(cleverapps.config.type)?new EXCLAMATIONS.words:-1!==["adventure"].indexOf(cleverapps.config.name)?new EXCLAMATIONS.actor:new EXCLAMATIONS.base},Exclamation.prototype.getCongratulations=function(){return-1!==["heroes","runes","mergeheroes"].indexOf(cleverapps.config.name)?["wow","super","yay","yeah","ohyeah","oh"]:Messages.get("congratulations")};var EXCLAMATIONS={base:cc.Node.extend({ctor:function(){this._super();var e=this.getStyles();this.setAnchorPoint2(),this.setContentSize2(e),e.scale&&this.setScale(
e.scale[cleverapps.wideMode.mode]),cleverapps.exclamation.onShowListener=this.createListener(cleverapps.throttle(1e3,this.showMessage.bind(this))),cleverapps.exclamation.onHideListener=this.createListener(this.hideMessage.bind(this))},showMessage:function(e,t){var n=bundles.game.urls.keep_going_effect,s="keep_going_letsgo",i=cleverapps.styles.FONTS.MESSAGE_TEXT_NORMAL;switch(t){case FieldView.MESSAGE_WARNING:s="5_moves_left",n=bundles.game.urls.five_moves_effect,i=cleverapps.styles.FONTS.MESSAGE_TEXT_WARNING;break;case FieldView.MESSAGE_CONGRATS:s="you_win",n=bundles.main.urls.beat_friend_effect,i=cleverapps.styles.FONTS.MESSAGE_TEXT_CONGRATS}this.runActions(e,i,n,s)},hideMessage:function(){this.setVisible(!1)},runActions:function(e,t,n,s){this.createAnimation(s),this.createMsg(e,t),this.playSound(n)},playSound:function(e){if(e){var t=this.getStyles().sound?this.getStyles().sound.delay:0;this.runAction(new cc.Sequence(new cc.DelayTime(t),new cc.CallFunc(function(){
cleverapps.audio.playSound(e)})))}},createMsg:function(e,t){var n=this.createText(e,t);n.opacity=0,n.runAction(new cc.Sequence(new cc.DelayTime(.2),new cc.FadeIn(.2),new cc.Spawn(new cc.MoveBy(.1,0,-2),new cc.ScaleTo(.1,1,.9)),new cc.ScaleTo(.25,1,1),new cc.DelayTime(.3),new cc.FadeOut(.2),new cc.RemoveSelf))},createText:function(e,t){var n=cleverapps.UI.LabelTTF.GetLocalizedText(e),s=cleverapps.UI.generateTTFText(e,t);return-1!==n.indexOf(" ")?s.setDimensions(this.width,0):s.fitTo(this.width),s.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER),s.setPositionRound(this.width/2,this.height/2),this.addChild(s),s},createAnimation:function(e){this.animation||(this.animation=new cleverapps.Spine(bundles.exclamations.jsons.animation),this.animation.setPositionRound(this.width/2,this.height/2),this.addChild(this.animation)),this.animation.setAnimation(0,e,!1)},getStyles:function(){return cleverapps.styles.Exclamations.base}})};EXCLAMATIONS.heroes=EXCLAMATIONS.base.extend({getStyles:function(){
return cleverapps.styles.Exclamations.heroes},showMessage:function(e,t){var n=this.getStyles(),s="messages:message.YouWin"===e?res.sound_win_effect:bundles.game.urls.keep_going_effect,i=cleverapps.styles.FONTS.CONGRATS_MESSAGE_FONT,o=n[e];o?i.color=o.color:t===FieldView.MESSAGE_WARNING?i.color=n.warning.color:i.color=n.default.color;var r="lets_go";-1!==cleverapps.exclamation.getCongratulations().indexOf(e)?(s=bundles.game.urls[e+"_effect"],e="messages:message."+(r=e)):"messages:message.KeepGoing"===e?s=bundles.game.urls.go_on_effect:"messages:message.Shuffle"===e&&(r="shuffle",s=bundles.game.urls.shuffle_effect),this.runActions(e,i,s,r)},createMsg:function(e,t){var n=this.createText(e,t);n.setRotation(10);n.setScale(.1),n.setVisible(!1),n.runAction(new cc.Sequence(new cc.DelayTime(.2),new cc.Show,new cc.ScaleTo(.3,1).easing(cc.easeInOut(3)),new cc.DelayTime(.55),new cc.ScaleTo(.3,.1),new cc.RemoveSelf))}}),EXCLAMATIONS.words=EXCLAMATIONS.base.extend({getStyles:function(){
return cleverapps.styles.Exclamations.base},showMessage:function(e){this.runActions(e,void 0,void 0,"animation")},createMsg:function(e){e=Messages.getLocalized(e);var t=this.splitTextToLines(e).map(this.createLine.bind(this)),n=new cleverapps.Layout(t.reverse(),{direction:cleverapps.UI.VERTICAL,margin:t.length&&t[0].height/10||0});n.setCascadeOpacityEnabled(!0),n.setOpacity(0),n.setScale(0),n.setPositionRound(this.width/2,this.height/2),this.addChild(n);var s=1,i=cc.director.getRunningScene();n.width>i.scene.width&&(s=i.scene.width/(1.2*n.width)),this.setVisible(!0),this.stopAllActions(),this.runAction(new cc.Sequence(new cc.DelayTime(1.4),new cc.Hide)),n.runAction(new cc.Spawn(new cc.FadeIn(.25),new cc.Sequence(new cc.ScaleTo(.2,1.4*s,1.4*s),new cc.ScaleTo(.2,.8*s,.8*s),new cc.ScaleTo(1,s,s)),new cc.Sequence(new cc.DelayTime(1.2),new cc.FadeOut(.2),new cc.RemoveSelf)))},createLine:function(e){var t=new cc.Node;t.setAnchorPoint(.5,.5);for(var n=0,s=0,i=this.splitLineToBlocks(e),
o=0;o<i.length;o++){var r=cleverapps.UI.generateOnlyText(i[o],cleverapps.styles.FONTS.CONGRATE_TEXT);t.addChild(r);var a=Math.abs(o-i.length/2),c=1-.2/i.length*a,l=.2+.6/i.length*a;r.setPosition(n+r.width*c/2,r.height/2),n+=r.width*c,s=Math.max(s,r.height),r.setScale(0),r.runAction(new cc.Sequence(new cc.ScaleTo(l,1.36),new cc.ScaleTo(.13,c)))}return t.setContentSize(n,s),t.setCascadeOpacityEnabled(!0),t},splitTextToLines:function(e){if(!e)return[];var t=e.indexOf(" ");if(e.length<=16||-1===t)return[e];var n=e.substr(0,16).lastIndexOf(" ");-1===n&&(n=t);var s=[e.substr(0,n)];return s=s.concat(e.substr(n+1).trim())},splitLineToBlocks:function(e){var t=e.split("");return t.length<=6?t:t.slice(0,3).concat([t.slice(3,t.length-3).join("")]).concat(t.slice(t.length-3,t.length))}}),EXCLAMATIONS.actor=EXCLAMATIONS.words.extend({getStyles:function(){return cleverapps.styles.Exclamations.actor},showMessage:function(e){var t=bundles.exclamations.urls.exclamation_alert_effect;if(
-1!==cleverapps.exclamation.getCongratulations().indexOf(e)){var n=cleverapps.Random.mathChoose(this.getStyles().actorActions);t=n.sound,cc.director.getRunningScene().actor.animate(n.animation,{noSFX:!0})}else"messages:message.YouWin"===e?t=bundles.exclamations.urls.exclamation_win_effect:"messages:message.Shuffle"===e&&(t=bundles.exclamations.urls.exclamation_shuffle_effect);this.runActions(e,void 0,t,"animation")}}),cleverapps.overrideColors(cleverapps.styles.COLORS,{CONGRATS_RED:new cc.Color(255,35,60,255),CONGRATS_LIGHT_GREEN:new cc.Color(182,248,68,255),CONGRATS_BLUE:new cc.Color(0,177,249,255),CONGRATS_ORANGE:new cc.Color(233,117,38,255),CONGRATS_PURPLE:new cc.Color(194,11,227,255),CONGRATS_GREEN:new cc.Color(0,209,121,255),CONGRATS_DARK_RED:new cc.Color(241,15,51,255)}),cleverapps.styles.Exclamations={base:{width:600,height:200}},cleverapps.styles.Exclamations.heroes=cleverapps.overrideStyles(cleverapps.styles.Exclamations.base,{width:760,scale:[.8,1,1],sound:{delay:.6},
default:{color:cleverapps.styles.COLORS.CONGRATS_BLUE},warning:{color:cleverapps.styles.COLORS.CONGRATS_DARK_RED},yeah:{color:cleverapps.styles.COLORS.CONGRATS_RED},super:{color:cleverapps.styles.COLORS.CONGRATS_LIGHT_GREEN},yay:{color:cleverapps.styles.COLORS.CONGRATS_BLUE},lets_go:{color:cleverapps.styles.COLORS.CONGRATS_ORANGE},ohyeah:{color:cleverapps.styles.COLORS.CONGRATS_PURPLE},oh:{color:cleverapps.styles.COLORS.CONGRATS_GREEN},wow:{color:cleverapps.styles.COLORS.CONGRATS_DARK_RED}},!0),cleverapps.styles.Exclamations.actor=cleverapps.overrideStyles(cleverapps.styles.Exclamations.base,{actorActions:[{animation:Actor.ANIMATIONS.ATTACK1,sound:bundles.game.urls.sc_welldone},{animation:Actor.ANIMATIONS.ATTACK2,sound:bundles.game.urls.sc_welldone2},{animation:Actor.ANIMATIONS.ATTACK3,sound:bundles.game.urls.sc_welldone3}]},!0);var ComboBarView=cc.Node.extend({ctor:function(e){this._super(),this.combo=e;var t=cleverapps.styles.ComboBarView;this.setPositionRound(
t.positions[cleverapps.wideMode.mode]),this.setContentSize(t),this.setAnchorPoint2(),this.setScale(t.scale[cleverapps.wideMode.mode]),this.initSlots(),this.progressPoints=new Array(cleverapps.Combo.COMBO_LEVEL_WITH_PRIZE),cleverapps.UI.makeHideable(this,cleverapps.UI.HORIZONTAL),cleverapps.metha.registerControl("comboBar",this),this.registerTarget(t),cleverapps.tooltipManager.create(this,{text:Messages.get("StreakTooltip"),position:cleverapps.styles.UI.Tooltip.LOCATION.below,size:cleverapps.styles.UI.Tooltip.SIZE.long})},initSlots:function(){var e=cleverapps.styles.ComboBarView,t=new cc.Node;t.setPositionRound(e.row),this.progressSlots=[];for(var n=0;n<cleverapps.Combo.COMBO_LEVEL_WITH_PRIZE;n++){var s=new cc.Sprite(0===n?bundles.game.frames.combo_notch1:bundles.game.frames.combo_notch2);s.setPosition(n*e.slot.offset,0),t.addChild(s),this.progressSlots.push(s)}var i=cleverapps.UI.createSprite(bundles.game.frames.combo_back_png);i.setPosition(this.width/2,this.height/2),
i.setContentSize(e),i.setLocalZOrder(-1),i.addChild(t),this.addChild(i),this.goalSlot=new cc.Node,this.goalSlot.setPosition(this.width+e.goal.offsetX,e.goal.offsetY),this.updateGoal(),this.addChild(this.goalSlot)},onChangeLevel:function(e){e&&(this.progressPoints[this.combo.level-1]=e),this.progressSlots.forEach(function(e,t){e.innerView&&t>=this.combo.level&&(e.innerView.runAction(new cc.Sequence(new cc.ScaleTo(.1,0),new cc.RemoveSelf)),e.innerView=void 0),void 0===e.innerView&&t<this.combo.level&&this.drawProgressPoint(e,t)}.bind(this))},drawProgressPoint:function(e,t){var n=cleverapps.styles.ComboBarView.progressImages[this.progressPoints[t]];e.innerView=cleverapps.UI.createSprite(0===t?bundles.game.frames.combo_point1:bundles.game.frames.combo_point2);var s=cleverapps.UI.createSprite(n);s.setPosition(e.innerView.width/2,e.innerView.height/2),e.innerView.addChild(s),e.innerView.setPosition(e.width/2,e.height/2),e.innerView.setScale(0),e.addChild(e.innerView),e.innerView.runAction(
new cc.ScaleTo(.2,1)),s.runAction(new cc.Sequence(new cc.DelayTime(.2),new cc.ScaleTo(.2,1.4).easing(cc.easeBackOut()),new cc.ScaleTo(.1,1)));var i=new cleverapps.Spine(bundles.game.jsons.combo_light_json);i.setAnimation(0,"animation",!1),i.setPositionRound(this.goalView.width/2,this.goalView.height/2),i.setCompleteListenerRemove(),this.goalView.addChild(i),this.goalView.runAction(new cc.Sequence(new cc.ScaleTo(.15,1.2),new cc.ScaleTo(.1,.9),new cc.ScaleTo(.1,1.1),new cc.ScaleTo(.1,1)))},updateGoal:function(){switch(this.goalView&&(this.goalView.removeFromParent(),this.goalView=void 0),this.combo.currentGoal){case 0:var e=cleverapps.cardSkins.getSelectedSkin().combo;break;case 1:e=cleverapps.cardSkins.getSelectedSkin().combo2;break;default:e=bundles.game.frames.combo_goal_png}this.goalView=cleverapps.UI.createSprite(e),this.goalSlot.addChild(this.goalView),this.goalView.setScale(0),this.goalView.runAction(new cc.Sequence(new cc.DelayTime(.2),new cc.ScaleTo(.3,1)))},reward:function(e,t
){var n=cleverapps.styles.ComboBarView.bonus,s=CardView.GetView(e);this.goalView&&(this.goalView.visible=!1),this.addChild(s),s.setPosition(this.width+n.offsetX,n.offsetY),s.setScale(n.scale),s.setRotation(n.rotation),s.runAction(new cc.Sequence(new cc.Spawn(new cc.ScaleTo(.3,1).easing(cc.easeInOut(3)),new cc.RotateTo(.3,0)),new cc.CallFunc(function(){t(),cleverapps.audio.playSound(bundles.game.urls.collected_effect)})))}});cleverapps.styles.ComboBarView={width:308,height:98,scale:[1,.9,1],positions:[{x:{align:"right",dx:-20},y:{align:"top",dy:-124}},{x:{align:"right",dx:-20},y:{align:"top",dy:-134}},{x:{align:"right",dx:-20},y:{align:"top",dy:-134}}],goal:{offsetX:-46,offsetY:50},row:{x:{align:"left",dx:40},y:{align:"center"}},slot:{offset:50},bonus:{offsetX:-46,offsetY:40,rotation:18,scale:.42}};var ComboView=cc.Node.extend({ctor:function(e,t){this._super(),this.combo=e,this.setAnchorPoint2(),"solitaire"===cleverapps.config.type?(this.comboBarView=new ComboBarView(this.combo),
t.addChild(this.comboBarView),this.combo.on("updateGoal",function(){this.comboBarView.updateGoal()}.bind(this))):(this.border=new cleverapps.Spine(bundles.combo_background.jsons.combo_background_json),this.border.setCascadeOpacityEnabled(!0),this.addChild(this.border),this.particles=new cleverapps.Spine(bundles.combo_background.jsons.combo_background_particles_json),this.addChild(this.particles)),this.updateSize=cleverapps.accumulate(10,this.updateSize.bind(this)),this.updateSize(),this.onChangeLevel(),this.combo.on("changeSize",this.updateSize.bind(this)),this.combo.on("changeLevel",this.onChangeLevel.bind(this)),this.combo.on("stopAlarm",this.stopAlarm.bind(this)),this.combo.on("runAlarm",this.runAlarm.bind(this)),this.combo.on("reward",this.reward.bind(this)),this.combo.on("runLater",this.runLater.bind(this))},runLater:function(e,t){this.runAction(new cc.Sequence(new cc.DelayTime(e),new cc.CallFunc(t)))},updateSize:function(){var e=cleverapps.UI.getSceneSize();this.setContentSize(
e.width,e.height+2*cleverapps.UI.getSceneOffsetY());var t=this.parent;this.setPositionRound(t.width/2,t.height/2),this.border&&(this.border.setScaleX(this.width/this.border.width/t.scale),this.border.setScaleY(this.height/this.border.height/t.scale),this.border.setPositionRound(this.width/2,this.height/2),this.particles.setPositionRound(this.width/2,this.height/2))},stopAlarm:function(){this.border&&(this.border.stopAllActions(),this.border.runAction(new cc.FadeTo(.3,255)))},reward:function(e,t){this.comboBarView&&this.comboBarView.reward(e,t)},runAlarm:function(){this.border&&(this.border.stopAllActions(),this.border.runAction(new cc.RepeatForever(new cc.Sequence(new cc.FadeTo(.5,170),new cc.FadeTo(.5,255)))))},onChangeLevel:function(e){if(this.border)if(this.combo.level<=1)this.border.visible=!1,this.particles.visible=!1;else{this.border.visible=!0,this.particles.visible=!0;var t=Math.min(this.combo.level,cleverapps.Combo.COMBO_LEVEL_WITH_PRIZE)-1;this.border.setAnimation(0,"c"+t,!1)
,this.border.addAnimation(0,"c"+t+"_idle",!0),this.particles.setAnimation(0,"c"+t,!1),this.particles.addAnimation(0,"c"+t+"_idle",!0)}this.comboBarView&&this.comboBarView.onChangeLevel(e)}}),SceneDecors={add:function(e,t){if(t)return this.createDecors(e,t)},createDecors:function(n,e){return e.map(function(e){var t;return e.json?(t=new cleverapps.Spine(e.json)).setAnimation(0,e.animation,!0):t=new cc.Sprite(e.image),n.addChild(t),e.scale&&(e.scale.x?t.setScale(e.scale.x,e.scale.y):t.setScale(e.scale)),void 0!==e.zOrder&&t.setLocalZOrder(e.zOrder),t.setPositionRound(e),t})}};cleverapps.styles.SceneDecors={},cleverapps.SkinManager=function(){this.active=void 0,this.defaultSlots=cleverapps.SkinManager.SKINS.default.slots},cleverapps.SkinManager.prototype.getSlot=function(e,t){if(this.active&&this.active.slots[e]){var n=this.active.slots[e](t);if(void 0!==n)return n}return this.defaultSlots[e]&&this.defaultSlots[e](t)},cleverapps.SkinManager.prototype.update=function(){this.active=void 0,
cleverapps.eventManager&&cleverapps.eventManager.listCurrentFeatures().forEach(function(e){cleverapps.SkinManager.SKINS[e]&&(this.active=cleverapps.SkinManager.SKINS[e])},this)},cleverapps.SkinManager.prototype.getBundle=function(){if(this.active)return this.active.bundle},cleverapps.SkinManager.SKINS={default:{localization:{},slots:{windowDecors:function(e){return e.decors},windowBg:function(e){return e.image},spine:function(e){return e.json},menuBarItem:function(e){},sceneControlButton:function(e){},episodeView:function(e){},episodeViewTitle:function(e){},iconBg:function(e){return e.image},gameAudio:function(){},sceneBg:function(){},gameSceneBg:function(){},missionIcon:function(e){return cleverapps.environment.isGameScene()&&Missions[e.type].gameIcon?Missions[e.type].gameIcon:Missions[e.type].icon},missionStar:function(e){return bundles.game.frames["mission_star"+e.type+"_png"]},missionWindowHero:function(){return cleverapps.styles.MissionWindow.heroTitleAnimation},
tulpanScale:function(){return cleverapps.styles.TulpanCellView.scale},removeMissions:function(){},toolbarDecors:function(){return[]},localization:function(){return cleverapps.SkinManager.SKINS.default.localization},windowTitle:function(e){return e.image},battlePassTaskIcon:function(e){},missionMarkIcon:function(e){return cleverapps.environment.isGameScene()&&Missions[e.type].gameIcon?Missions[e.type].gameIcon:Missions[e.type].icon},missionWindowTitleFont:function(){return cleverapps.styles.FONTS.MISSION_WINDOW_TITLE_TEXT||cleverapps.styles.MissionWindow.titleFont},wardrobeWindowBanner:function(){return bundles.wardrobe_window.frames.window_bg},cardMarkSpine:function(e){return e.json}}}},cleverapps.SkinManager.SKINS.xmas={bundle:"xmas",localization:{tripeaks:{"Missions.LetterTournament.Title":"Xmas.Missions.LetterTournament.Title","MissionRulesWindow.LetterTournament.text2":"Xmas.MissionRulesWindow.LetterTournament.text2",
"MissionRulesWindow.LetterTournament.text3":"Xmas.MissionRulesWindow.LetterTournament.text3","AddMovesWindow.missionGiveUp.LetterTournament":"Xmas.AddMovesWindow.missionGiveUp.LetterTournament","AddMovesWindow.mission.LetterTournament":"Xmas.AddMovesWindow.mission.LetterTournament",CloversTooltip:"Xmas.CloversTooltip"},wordsoup:{"Missions.LetterTournament.Title":"Xmas.Missions.LetterTournament.Title","MissionRulesWindow.LetterTournament.text2":"Xmas.MissionRulesWindow.LetterTournament.text2","MissionRulesWindow.LetterTournament.text3":"Xmas.MissionRulesWindow.LetterTournament.text3","WardrobeDialogue.stage0.text0":"Xmas.WardrobeDialogue.stage0.text0","WardrobeDialogue.stage1.text0":"Xmas.WardrobeDialogue.stage1.text0","WardrobeDialogue.stage2.text0":"Xmas.WardrobeDialogue.stage2.text0","WardrobeDialogue.stage3.text0":"Xmas.WardrobeDialogue.stage3.text0","WardrobeDialogue.stage4.text0":"Xmas.WardrobeDialogue.stage4.text0",
"WardrobeDialogue.stage5.text0":"Xmas.WardrobeDialogue.stage5.text0","WardrobeDialogue.stage6.text0":"Xmas.WardrobeDialogue.stage6.text0","WardrobeDialogue.stage7.text0":"Xmas.WardrobeDialogue.stage7.text0","WardrobeDialogue.stage8.text0":"Xmas.WardrobeDialogue.stage8.text0","WardrobeDialogue.stage9.text0":"Xmas.WardrobeDialogue.stage9.text0","WardrobeDialogue.stage10.text0":"Xmas.WardrobeDialogue.stage10.text0","WardrobeDialogue.stage11.text0":"Xmas.WardrobeDialogue.stage11.text0",WardrobeDescText:"Xmas.WardrobeDescText",WardrobeRulesText:"Xmas.WardrobeRulesText",WardrobePrizeRewardTitle:"Xmas.WardrobePrizeRewardTitle","Missions.LetterTournament.Rules1":"Xmas.Missions.LetterTournament.Rules1"},scramble:{"Missions.LetterTournament.Title":"Xmas.Missions.LetterTournament.Title","MissionRulesWindow.LetterTournament.text2":"Xmas.MissionRulesWindow.LetterTournament.text2","MissionRulesWindow.LetterTournament.text3":"Xmas.MissionRulesWindow.LetterTournament.text3"}},slots:{
windowDecors:function(e){var t=e.decors&&cleverapps.clone(e.decors,!0)||{};return t.leaves_left=!1,t.leaves_right=!1,t.xmas_window_1=!0,t.xmas_window_2=!0,"crocword"===cleverapps.config.name&&(e.window instanceof VictoryWindow||(t.xmas_decor_horizontal=!0),t.xmas_decor_right_top=!0,t.xmas_decor_left_top=!0,t.xmas_decor_vertical_right=!0,t.xmas_decor_vertical_left=!0),-1!==["scramble"].indexOf(cleverapps.config.name)&&("victorywindow"!==e.window.name&&(t.xmas_decor_left_top=!0,t.xmas_decor_right_top=!0),"leaderswindow"!==e.window.name&&(t.xmas_decor_bottom=!0)),-1!==["tripeaks"].indexOf(cleverapps.config.name)&&(t.xmas_decor_left_top=!0,t.xmas_decor_center_top=!0,t.xmas_decor_right_top=!0,"leaderswindow"!==e.window.name&&(t.xmas_decor_bottom=!0)),"riddles"===cleverapps.config.name&&e.level&&e.level.isHard()&&(t.xmas_window_1=!1,t.xmas_window_2=!1),t},windowBg:function(e){return"riddles"===cleverapps.config.name&&e.level&&e.level.isHard(
)?e.image:bundles.xmas.frames.window_bg_png?bundles.xmas.frames.window_bg_png:void 0},hero:function(e){if(bundles.xmas.jsons[e.color+"_hero_spine_json"])return bundles.xmas.jsons[e.color+"_hero_spine_json"]},spine:function(e){var t={};return-1!==["heroes","riddles"].indexOf(cleverapps.config.name)&&(t[bundles.heroes.jsons.A_hero_spine_json]=bundles.xmas.jsons.A_hero_spine_json,t[bundles.heroes.jsons.B_hero_spine_json]=bundles.xmas.jsons.B_hero_spine_json,t[bundles.heroes.jsons.C_hero_spine_json]=bundles.xmas.jsons.C_hero_spine_json,t[bundles.heroes.jsons.D_hero_spine_json]=bundles.xmas.jsons.D_hero_spine_json,t[bundles.heroes.jsons.E_hero_spine_json]=bundles.xmas.jsons.E_hero_spine_json,t[bundles.heroes.jsons.W_hero_spine_json]=bundles.xmas.jsons.W_hero_spine_json),"board"===cleverapps.config.type&&(t[bundles.hero.jsons.hero_json]=bundles.xmas.jsons.hero_json),-1!==["tripeaks"].indexOf(cleverapps.config.name)&&(
t[bundles.letter_tournament.jsons.mission_window_json]=bundles.xmas.jsons.xmas_mission_window_json),-1!==["scramble"].indexOf(cleverapps.config.name)&&(t[bundles.letter_tournament.jsons.mission_window_json]=bundles.xmas.jsons.mission_window_json,cleverapps.styles.MissionWindow.heroTitleAnimation=cleverapps.styles.xmasNewStyles.heroTitleAnimation),-1!==["wordsoup","tripeaks","scramble"].indexOf(cleverapps.config.name)&&(t[bundles.sidebar.jsons.mission_letter_icon_json]=bundles.sidebar.jsons.xmas_letter_json,t[bundles.sidebar.jsons.wardrobe_icon_json]=bundles.xmas.jsons.wardrobe_sidebar_icon_json),t[e.json]?t[e.json]:e.json},menuBarItem:function(e){return-1!==["crocword","scramble","tripeaks"].indexOf(cleverapps.config.name)?cleverapps.styles.SceneDecors.menuBarItemXmas:"undefined"!=typeof LivesView&&e.target instanceof LivesView?cleverapps.styles.SceneDecors.livesViewXmas:cleverapps.styles.SceneDecors.menuBarItemXmas},sceneControlButton:function(e){
return cleverapps.styles.SceneDecors.sceneControlButtonXmas},progressViewDecor:function(e){return cleverapps.styles.SceneDecors.progressViewDecor},episodeView:function(e){return cleverapps.styles.SceneDecors.episodeViewXmas},iconBg:function(e){if(bundles.xmas.frames.icon_bg_png)return bundles.xmas.frames.icon_bg_png},gameAudio:function(){if("wordsoup"===cleverapps.config.name)return bundles.xmas.urls.background_music_game},sceneBg:function(){if("wordsoup"===cleverapps.config.name)return{pattern:bundles.xmas.urls.pattern_bg_main_png}},gameSceneBg:function(e){if("wordsoup"===cleverapps.config.name)return{pattern:bundles.xmas.urls.pattern_bg_main_png}},missionIcon:function(e){if(-1!==["wordsoup","tripeaks","scramble"].indexOf(cleverapps.config.name)&&e.type===Mission.TYPE_LETTER)return bundles.xmas.frames.mission_letter_png},missionStar:function(e){return-1!==["wordsoup","scramble"].indexOf(cleverapps.config.name)?bundles.xmas.frames["mission_star"+e.type+"_png"]:-1!==["tripeaks"
].indexOf(cleverapps.config.name)?bundles.xmas.frames.mission_letter_png:void 0},missionRulesWindow:function(e){if(-1!==["wordsoup","tripeaks","scramble"].indexOf(cleverapps.config.name)&&e.type===Mission.TYPE_LETTER)return bundles.xmas.jsons.letter_rules_json},wardrobeWindowBanner:function(){return bundles.xmas.frames.window_banner},cardMarkSpine:function(e){return-1!==["tripeaks"].indexOf(cleverapps.config.name)&&"mission"===e.type?bundles.xmas.jsons.xmas_marks_json:e.json},localization:function(){if(cleverapps.SkinManager.SKINS.xmas.localization[cleverapps.config.name])return cleverapps.SkinManager.SKINS.xmas.localization[cleverapps.config.name]}}},cleverapps.SkinManager.SKINS.valentines={bundle:"valentines",localization:{heroes:{"Missions.TulpanTournament.Title":"Valentine.Missions.TulpanTournament.Title","Missions.TulpanTournament.Rules1":"Valentine.Missions.TulpanTournament.Rules1",
"Missions.TulpanTournament.AnimationMainTextWin":"Valentine.Missions.TulpanTournament.AnimationMainTextWin","Missions.TulpanTournament.AnimationMainTextLose":"Valentine.Missions.TulpanTournament.AnimationMainTextLose","Missions.TulpanTournament.AnimationMainTextInfo0":"Valentine.Missions.TulpanTournament.AnimationMainTextInfo0","Missions.TulpanTournament.AnimationMainTextInfo1":"Valentine.Missions.TulpanTournament.AnimationMainTextInfo1"},riddles:{"Missions.TulpanTournament.Title":"Valentine.Missions.TulpanTournament.Title","Missions.TulpanTournament.Rules1":"Valentine.Missions.TulpanTournament.Rules1","Missions.TulpanTournament.AnimationMainTextWin":"Valentine.Missions.TulpanTournament.AnimationMainTextWin","Missions.TulpanTournament.AnimationMainTextLose":"Valentine.Missions.TulpanTournament.AnimationMainTextLose","Missions.TulpanTournament.AnimationMainTextInfo0":"Valentine.Missions.TulpanTournament.AnimationMainTextInfo0",
"Missions.TulpanTournament.AnimationMainTextInfo1":"Valentine.Missions.TulpanTournament.AnimationMainTextInfo1","AddMovesWindow.mission.TulpanTournament":"Valentine.AddMovesWindow.mission.TulpanTournament","AddMovesWindow.missionGiveUp.TulpanTournament":"Valentine.AddMovesWindow.missionGiveUp.TulpanTournament"},scramble:{"Missions.LetterTournament.Title":"Valentine.Missions.LetterTournament.Title","MissionRulesWindow.LetterTournament.text2":"Valentine.MissionRulesWindow.LetterTournament.text2","MissionRulesWindow.LetterTournament.text3":"Valentine.MissionRulesWindow.LetterTournament.text3"},wordsoup:{"Missions.LetterTournament.Title":"Valentine.Missions.LetterTournament.Title","Missions.LetterTournament.Rules1":"Valentine.Missions.LetterTournament.Rules1","MissionRulesWindow.LetterTournament.text2":"Valentine.MissionRulesWindow.LetterTournament.text2","MissionRulesWindow.LetterTournament.text3":"Valentine.MissionRulesWindow.LetterTournament.text3"},crocword:{
"Missions.LetterTournament.Title":"Valentine.Missions.LetterTournament.Title","Missions.LetterTournament.Rules1":"Valentine.Missions.LetterTournament.Rules1","MissionRulesWindow.LetterTournament.text2":"Valentine.MissionRulesWindow.LetterTournament.text2","MissionRulesWindow.LetterTournament.text3":"Valentine.MissionRulesWindow.LetterTournament.text3"}},slots:{removeMissions:function(){if("riddles"===cleverapps.config.name||"heroes"===cleverapps.config.name)return[Mission.TYPE_COLLECT_MARK,Mission.TYPE_COMBO]},menuBarItem:function(e){return"crocword"===cleverapps.config.name?"BonusRoundTimerItem"===e.target.item.getName()?cleverapps.styles.SceneDecors.menuBarBonusRoundTimerItemValentines:cleverapps.styles.SceneDecors.menuBarItemValentines:-1!==["wordsoup","riddles","heroes","scramble"].indexOf(cleverapps.config.name)?cleverapps.styles.SceneDecors.menuBarItemValentines:void 0},sceneControlButton:function(e){if(-1!==["crocword","wordsoup","riddles","scramble"].indexOf(
cleverapps.config.name))return cleverapps.styles.SceneDecors.sceneControlButtonValentines},progressViewDecor:function(e){if(-1!==["scramble"].indexOf(cleverapps.config.name))return cleverapps.styles.SceneDecors.progressViewDecorValentines},missionWindowDecors:function(){return cleverapps.styles.SceneDecors.missionWindowValentines},episodeView:function(e){if(-1!==["crocword","wordsoup"].indexOf(cleverapps.config.name))return cleverapps.styles.SceneDecors.episodeViewValentines},episodeViewTitle:function(e){if(-1!==["wordsoup"].indexOf(cleverapps.config.name))return cleverapps.styles.SceneDecors.episodeViewTitleValentines},iconBg:function(e){if(-1!==["crocword","heroes","riddles"].indexOf(cleverapps.config.name))return bundles.valentines.frames.valentines_icon_bg_png},toolbarDecors:function(e){if(-1!==["crocword","wordsoup","heroes","riddles"].indexOf(cleverapps.config.name))return cleverapps.styles.SceneDecors.toolbarViewValentines},windowDecors:function(e){
var t=e.decors&&cleverapps.clone(e.decors,!0)||{};return-1!==["wordsoup","crocword","heroes","riddles"].indexOf(cleverapps.config.name)&&(e.window instanceof LeadersWindow||(t.valentines_decor_right=!0,t.valentines_decor_right2=!0),t.valentines_decor_left=!0,t.valentines_decor_left2=!0,-1!==["heroes","wordsoup","riddles","crocword"].indexOf(cleverapps.config.name)&&(t.valentines_decor_hearts=!0,t.valentines_decor_top_1=!0,t.valentines_decor_top_2=!0,t.valentines_decor_top_3=!0,t.valentines_decor_heart_top_1=!0,t.valentines_decor_heart_top_2=!0,t.valentines_decor_heart_top_3=!0,t.valentines_decor_heart_top_4=!0,t.gears_animation=!1,t.gears=!1,t.star=!1,t.present=!1,t.leaves_left=!1,t.leaves_right=!1)),-1!==["scramble"].indexOf(cleverapps.config.name)&&(t.valentines_decor_bottom=!0,t.valentines_decor_top=!0,e.window instanceof LeadersWindow&&(t.valentines_decor_bottom=!1),e.window instanceof MissionWindow&&(t.valentines_decor_top=!1),e.window instanceof ExtraWindow&&(
t.valentines_decor_top=!1),e.window instanceof VictoryWindow&&(t.valentines_decor_top=!1)),t},missionIcon:function(e){return-1!==["crocword","wordsoup","scramble"].indexOf(cleverapps.config.name)&&e.type===Mission.TYPE_LETTER?bundles.valentines.frames.mission_icon_png:-1!==["riddles","heroes"].indexOf(cleverapps.config.name)&&e.type===Mission.TYPE_BURN_NEARBY?bundles.valentines.frames.mission_icon_png:void 0},missionStar:function(e){if(-1!==["crocword","wordsoup","scramble"].indexOf(cleverapps.config.name))return bundles.valentines.frames["mission_star"+e.type+"_png"]},missionRulesWindow:function(e){if(-1!==["crocword","wordsoup","scramble"].indexOf(cleverapps.config.name)&&e.type===Mission.TYPE_LETTER)return bundles.valentines.jsons.letter_rules_json},missionWindowHero:function(){if(-1!==["scramble"].indexOf(cleverapps.config.name))return cleverapps.styles.Valentines.heroTitleAnimation},spine:function(e){var t={};return-1!==["heroes","riddles"].indexOf(cleverapps.config.name)&&(
t[bundles.tulpan_tournament.jsons.json]=bundles.valentines.jsons.json,t[bundles.main.jsons.tournament_tulpan_icon_json]=bundles.valentines.jsons.icon_json),"board"===cleverapps.config.type&&(t[bundles.hero.jsons.hero_json]=bundles.valentines.jsons.hero_json),-1!==["scramble"].indexOf(cleverapps.config.name)&&(t[bundles.letter_tournament.jsons.mission_window_json]=bundles.valentines.jsons.mission_window_json),-1!==["crocword","wordsoup","scramble"].indexOf(cleverapps.config.name)&&(t[bundles.sidebar.jsons.mission_letter_icon_json]=bundles.sidebar.jsons.valentine_letter_json),-1!==["crocword","wordsoup"].indexOf(cleverapps.config.name)&&e.type===Mission.TYPE_WARDROBE&&(t[bundles.sidebar.jsons.wardrobe_icon_json]=bundles.sidebar.jsons.wardrobe_valentine_icon_json),t[e.json]?t[e.json]:e.json},localization:function(){if(cleverapps.SkinManager.SKINS.valentines.localization[cleverapps.config.name])return cleverapps.SkinManager.SKINS.valentines.localization[cleverapps.config.name]},
gameSceneBg:function(e){if("wordsoup"===cleverapps.config.name)return{pattern:bundles.valentines.urls.valentines_pattern_bg_png}},gameAudio:function(){},windowTitle:function(e){if("heroes"===cleverapps.config.name)return bundles.valentines.frames.valentines_window_title_bg_png},missionWindowTitleFont:function(){return cleverapps.styles.FONTS.VALENTINE_MISSION_WINDOW_TITLE_TEXT},battlePassTaskIcon:function(e){if(e.taskType===Mission.EVENT_COLLECT_CLOVER&&-1!==["riddles","heroes"].indexOf(cleverapps.config.name))return bundles.valentines.frames.mission_icon_png},wardrobeWindowBanner:function(){return bundles.valentines.frames.wardrobe_window_banner}}},cleverapps.overrideFonts(cleverapps.styles.FONTS,{VALENTINE_MISSION_WINDOW_TITLE_TEXT:{size:80,color:cleverapps.styles.COLORS.WHITE,shadow:{direction:cc.size(0,-5),blur:1,color:new cc.Color(106,2,88,255)}}}),cleverapps.SkinManager.SKINS.easter={bundle:"easter",localization:{heroes:{
"Missions.TulpanTournament.Title":"Easter.Missions.TulpanTournament.Title","Missions.TulpanTournament.Rules1":"Easter.Missions.TulpanTournament.Rules1","Missions.TulpanTournament.AnimationMainTextWin":"Easter.Missions.TulpanTournament.AnimationMainTextWin","Missions.TulpanTournament.AnimationMainTextLose":"Easter.Missions.TulpanTournament.AnimationMainTextLose","Missions.TulpanTournament.AnimationMainTextInfo0":"Easter.Missions.TulpanTournament.AnimationMainTextInfo0","Missions.TulpanTournament.AnimationMainTextInfo1":"Easter.Missions.TulpanTournament.AnimationMainTextInfo1","AddMovesWindow.mission.TulpanTournament":"Easter.AddMovesWindow.mission.TulpanTournament","AddMovesWindow.missionGiveUp.TulpanTournament":"Easter.AddMovesWindow.missionGiveUp.TulpanTournament"},riddles:{"Missions.RoseTournament.Title":"Easter.Missions.RoseTournament.Title","Missions.RoseTournament.Rules1":"Easter.Missions.RoseTournament.Rules1",
"Missions.RoseTournament.AnimationMainTextWin":"Easter.Missions.RoseTournament.AnimationMainTextWin","Missions.RoseTournament.AnimationMainTextLose":"Easter.Missions.RoseTournament.AnimationMainTextLose","Missions.RoseTournament.AnimationMainTextInfo0":"Easter.Missions.RoseTournament.AnimationMainTextInfo0","Missions.RoseTournament.AnimationMainTextInfo1":"Easter.Missions.RoseTournament.AnimationMainTextInfo1","AddMovesWindow.mission.TulpanTournament":"Easter.AddMovesWindow.mission.RoseTournament","AddMovesWindow.missionGiveUp.RoseTournament":"Easter.AddMovesWindow.missionGiveUp.RoseTournament","AddMovesWindow.mission.RoseTournament":"Easter.AddMovesWindow.mission.RoseTournament"},wordsoup:{"Missions.LetterTournament.Title":"Easter.Missions.LetterTournament.Title","Missions.LetterTournament.Rules1":"Easter.Missions.LetterTournament.Rules1","MissionRulesWindow.LetterTournament.text2":"Easter.MissionRulesWindow.LetterTournament.text2",
"MissionRulesWindow.LetterTournament.text3":"Easter.MissionRulesWindow.LetterTournament.text3"},scramble:{"Missions.LetterTournament.Title":"Easter.Missions.LetterTournament.Title","MissionRulesWindow.LetterTournament.text2":"Easter.MissionRulesWindow.LetterTournament.text2","MissionRulesWindow.LetterTournament.text3":"Easter.MissionRulesWindow.LetterTournament.text3"},crocword:{"Missions.LetterTournament.Title":"Easter.Missions.LetterTournament.Title","Missions.LetterTournament.Rules1":"Easter.Missions.LetterTournament.Rules1","MissionRulesWindow.LetterTournament.text2":"Easter.MissionRulesWindow.LetterTournament.text2","MissionRulesWindow.LetterTournament.text3":"Easter.MissionRulesWindow.LetterTournament.text3"}},slots:{windowDecors:function(e){var t=e.decors&&cleverapps.clone(e.decors,!0)||{};return"wordsoup"===cleverapps.config.name&&(e.window instanceof LeadersWindow||(t.window_bottom_right_corner_2=!0,t.window_bottom_right_corner_1=!0,t.window_bottom_left_corner_2=!0,
t.window_bottom_left_corner_1=!0)),"riddles"===cleverapps.config.name&&(t.window_bottom_right=!0,t.window_bottom_left=!0),"scramble"===cleverapps.config.name&&(t.easter_decor_top=!0,t.easter_decor_bottom=!0,e.window instanceof TellWindow&&(t.easter_decor_bottom=!1),e.window instanceof MissionWindow&&(t.easter_decor_top=!1),e.window instanceof ExtraWindow&&(t.easter_decor_top=!1),e.window instanceof VictoryWindow&&(t.easter_decor_top=!1),e.window instanceof BoostersSaleWindow&&(t.easter_decor_bottom=!1)),t},menuBarItem:function(){return cleverapps.styles.SceneDecors.menuBarItemEaster},episodeView:function(){return cleverapps.styles.SceneDecors.episodeViewEaster},toolbarDecors:function(){return cleverapps.styles.SceneDecors.toolbarViewEaster},progressViewDecor:function(){return cleverapps.styles.SceneDecors.progressViewDecorEaster},sceneControlButton:function(e){if(e.target.options.logic===MenuControlButton)return cleverapps.styles.SceneDecors.sceneControlButtonEaster},
missionWindowDecors:function(){return cleverapps.styles.SceneDecors.missionWindowEaster},tulpanScale:function(){if("heroes"===cleverapps.config.name)return.9},missionIcon:function(e){return-1!==["crocword","wordsoup","scramble"].indexOf(cleverapps.config.name)&&e.type===Mission.TYPE_LETTER?bundles.easter.frames.letter_mission_icon:-1!==["heroes"].indexOf(cleverapps.config.name)&&e.type===Mission.TYPE_BURN_NEARBY?bundles.easter.frames.tulpan_png:-1!==["riddles"].indexOf(cleverapps.config.name)&&e.type===Mission.TYPE_COLLECT_MARK?bundles.easter.frames.rose_png:void 0},missionStar:function(e){if(-1!==["crocword","wordsoup","scramble"].indexOf(cleverapps.config.name))return bundles.easter.frames["mission_star"+e.type+"_png"]},missionMarkIcon:function(){return bundles.easter.frames["rose_"+(Math.random()<.5?1:2)]},missionRulesWindow:function(e){if(-1!==["crocword","wordsoup","scramble"].indexOf(cleverapps.config.name)&&e.type===Mission.TYPE_LETTER
)return bundles.easter.jsons.letter_rules_json},removeMissions:function(){return"riddles"===cleverapps.config.name?[Mission.TYPE_COMBO,Mission.TYPE_BURN_NEARBY]:"heroes"===cleverapps.config.name?[Mission.TYPE_COLLECT_MARK,Mission.TYPE_COMBO]:void 0},gameSceneBg:function(){if("wordsoup"===cleverapps.config.name)return{pattern:bundles.easter.urls.pattern_bg}},spine:function(e){var t={};return-1!==["riddles"].indexOf(cleverapps.config.name)&&(t[bundles.rose_tournament.jsons.json]=bundles.easter.jsons.rose_tournament_json,t[bundles.main.jsons.tournament_rose_icon_json]=bundles.easter.jsons.tournament_rose_icon_json),-1!==["heroes"].indexOf(cleverapps.config.name)&&(t[bundles.tulpan_tournament.jsons.json]=bundles.easter.jsons.tulpan_tournament_json,t[bundles.main.jsons.tournament_tulpan_icon_json]=bundles.easter.jsons.tournament_tulpan_icon_json),-1!==["scramble"].indexOf(cleverapps.config.name)&&(
t[bundles.letter_tournament.jsons.mission_window_json]=bundles.easter.jsons.mission_window_json),"board"===cleverapps.config.type&&(t[bundles.sidebar.jsons.mission_letter_icon_json]=bundles.sidebar.jsons.easter_letter_json),t[e.json]},localization:function(){if(cleverapps.SkinManager.SKINS.easter.localization[cleverapps.config.name])return cleverapps.SkinManager.SKINS.easter.localization[cleverapps.config.name]}}},cleverapps.SkinManager.SKINS.memorial={bundle:"memorial",localization:{heroes:{"Missions.TulpanTournament.Title":"Memorial.Missions.TulpanTournament.Title","Missions.TulpanTournament.Rules1":"Memorial.Missions.TulpanTournament.Rules1","Missions.TulpanTournament.AnimationMainTextWin":"Memorial.Missions.TulpanTournament.AnimationMainTextWin","Missions.TulpanTournament.AnimationMainTextLose":"Memorial.Missions.TulpanTournament.AnimationMainTextLose","Missions.TulpanTournament.AnimationMainTextInfo0":"Memorial.Missions.TulpanTournament.AnimationMainTextInfo0",
"Missions.TulpanTournament.AnimationMainTextInfo1":"Memorial.Missions.TulpanTournament.AnimationMainTextInfo1","AddMovesWindow.mission.TulpanTournament":"Memorial.AddMovesWindow.mission.TulpanTournament","AddMovesWindow.missionGiveUp.TulpanTournament":"Memorial.AddMovesWindow.missionGiveUp.TulpanTournament","BoostersSaleWindow.title":"Memorial.BoostersSaleWindow.title"},wordsoup:{"Missions.LetterTournament.Title":"Memorial.Missions.LetterTournament.Title","Missions.LetterTournament.Rules1":"Memorial.Missions.LetterTournament.Rules1","MissionRulesWindow.LetterTournament.text2":"Memorial.MissionRulesWindow.LetterTournament.text2","MissionRulesWindow.LetterTournament.text3":"Memorial.MissionRulesWindow.LetterTournament.text3","Race.force":"Memorial.Race.force","Race.dialogue.stage_0.0":"Memorial.Race.dialogue.stage_0.0","Race.dialogue.stage_0.1":"Memorial.Race.dialogue.stage_0.1","Race.dialogue.stage_0.2":"Memorial.Race.dialogue.stage_0.2",
"Race.dialogue.stage_7.0":"Memorial.Race.dialogue.stage_7.0","Race.dialogue.stage_7.1":"Memorial.Race.dialogue.stage_7.1","Race.dialogue.stage_50.0":"Memorial.Race.dialogue.stage_50.0","Race.dialogue.stage_50.1":"Memorial.Race.dialogue.stage_50.1","BoostersSaleWindow.title":"Memorial.BoostersSaleWindow.title"},crocword:{"Missions.LetterTournament.Title":"Memorial.Missions.LetterTournament.Title","Missions.LetterTournament.Rules1":"Memorial.Missions.LetterTournament.Rules1","MissionRulesWindow.LetterTournament.text2":"Memorial.MissionRulesWindow.LetterTournament.text2","MissionRulesWindow.LetterTournament.text3":"Memorial.MissionRulesWindow.LetterTournament.text3",WardrobeDescText:"Memorial.WardrobeDescText",WardrobeRulesText:"Memorial.WardrobeRulesText",WardrobePrizeRewardTitle:"Memorial.WardrobePrizeRewardTitle","WardrobeDialogue.stage0.text0":"Memorial.WardrobeDialogue.stage0.text0","WardrobeDialogue.stage1.text0":"Memorial.WardrobeDialogue.stage1.text0",
"WardrobeDialogue.stage2.text0":"Memorial.WardrobeDialogue.stage2.text0","WardrobeDialogue.stage3.text0":"Memorial.WardrobeDialogue.stage3.text0","WardrobeDialogue.stage4.text0":"Memorial.WardrobeDialogue.stage4.text0","WardrobeDialogue.stage5.text0":"Memorial.WardrobeDialogue.stage5.text0","WardrobeDialogue.stage6.text0":"Memorial.WardrobeDialogue.stage6.text0","WardrobeDialogue.stage7.text0":"Memorial.WardrobeDialogue.stage7.text0","WardrobeDialogue.stage8.text0":"Memorial.WardrobeDialogue.stage8.text0","WardrobeDialogue.stage9.text0":"Memorial.WardrobeDialogue.stage9.text0","WardrobeDialogue.stage10.text0":"Memorial.WardrobeDialogue.stage10.text0","WardrobeDialogue.stage11.text0":"Memorial.WardrobeDialogue.stage11.text0","BoostersSaleWindow.title":"Memorial.BoostersSaleWindow.title"},scramble:{"Missions.LetterTournament.Title":"Memorial.Missions.LetterTournament.Title","MissionRulesWindow.LetterTournament.text2":"Memorial.MissionRulesWindow.LetterTournament.text2",
"MissionRulesWindow.LetterTournament.text3":"Memorial.MissionRulesWindow.LetterTournament.text3"},riddles:{"Missions.TulpanTournament.Title":"Memorial.Missions.TulpanTournament.Title","Missions.TulpanTournament.Rules1":"Memorial.Missions.TulpanTournament.Rules1","Missions.TulpanTournament.AnimationMainTextWin":"Memorial.Missions.TulpanTournament.AnimationMainTextWin","Missions.TulpanTournament.AnimationMainTextLose":"Memorial.Missions.TulpanTournament.AnimationMainTextLose","Missions.TulpanTournament.AnimationMainTextInfo0":"Memorial.Missions.TulpanTournament.AnimationMainTextInfo0","Missions.TulpanTournament.AnimationMainTextInfo1":"Memorial.Missions.TulpanTournament.AnimationMainTextInfo1","AddMovesWindow.mission.TulpanTournament":"Memorial.AddMovesWindow.mission.TulpanTournament","AddMovesWindow.missionGiveUp.TulpanTournament":"Memorial.AddMovesWindow.missionGiveUp.TulpanTournament","BoostersSaleWindow.title":"Memorial.BoostersSaleWindow.title"}},slots:{spine:function(e){var t={}
;return-1!==["heroes","riddles"].indexOf(cleverapps.config.name)&&(t[bundles.tulpan_tournament.jsons.json]=bundles.memorial.jsons.json,t[bundles.sidebar.jsons.tournament_tulpan_icon_json]=bundles.memorial.jsons.icon_json),-1!==["crocword","scramble"].indexOf(cleverapps.config.name)&&(t[bundles.hero.jsons.hero_json]=bundles.memorial.jsons.hero_json),-1!==["crocword","wordsoup","scramble"].indexOf(cleverapps.config.name)&&(t[bundles.sidebar.jsons.mission_letter_icon_json]=bundles.sidebar.jsons.memorial_letter_json),-1!==["scramble"].indexOf(cleverapps.config.name)&&(t[bundles.letter_tournament.jsons.mission_window_json]=bundles.memorial.jsons.mission_window_json),t[e.json]?t[e.json]:e.json},toolbarDecors:function(e){if(-1!==["heroes","riddles","wordsoup","crocword"].indexOf(cleverapps.config.name))return cleverapps.styles.SceneDecors.toolbarViewMemorial},windowDecors:function(e){if(-1!==["heroes","riddles","wordsoup","crocword","scramble"].indexOf(cleverapps.config.name)){
var t=e.decors&&cleverapps.clone(e.decors,!0)||{};return t.memorial_decor_top=!0,t.memorial_decor_bottom_left=!0,t.memorial_decor_bottom_right=!0,e.window instanceof LeadersWindow&&(t.memorial_decor_bottom_right=!1),e.window instanceof FavoriteSaleWindow&&(t.memorial_decor_bottom_left=!1,t.memorial_decor_bottom_right=!1),e.window instanceof SubscriptionWindow&&-1!==["crocword","wordsoup"].indexOf(cleverapps.config.name)&&(t.memorial_decor_top=!1,t.memorial_decor_bottom_left=!1,t.memorial_decor_bottom_right=!1),e.window instanceof WardrobeWindow&&(t.memorial_decor_top=!1),e.window instanceof WardrobeRulesWindow&&(t.memorial_decor_top=!1),e.window instanceof WardrobeReceiveWindow&&(t.memorial_decor_top=!1),t.leaves_right=!1,t.gears=!1,t.gears_animation=!1,"scramble"===cleverapps.config.name&&(e.window instanceof LeadersWindow&&(t.memorial_decor_bottom_left=!1),e.window instanceof SubscriptionWindow&&(t.memorial_decor_bottom_left=!1),e.window instanceof VictoryWindow&&(
t.memorial_decor_top=!1,t.memorial_decor_bottom_left=!1),e.window instanceof TreasureSearchWindow&&(t.memorial_decor_bottom_left=!1),e.window instanceof TellWindow&&(t.memorial_decor_bottom_left=!1)),"wordsoup"===cleverapps.config.name&&e.window instanceof HomeTasksWindow&&(t.memorial_decor_bottom_left=!1,t.memorial_decor_bottom_right=!1),t}return e.decors},menuBarItem:function(e){if(e.target.item&&"GoldItem"===e.target.item.getName())return cleverapps.styles.SceneDecors.menuBarItemMemorial},sceneControlButton:function(e){if(e.target.options.logic===MenuControlButton)return cleverapps.styles.SceneDecors.sceneControlButtonMemorial},progressViewDecor:function(){return cleverapps.styles.SceneDecors.progressViewMemorial},missionIcon:function(e){return-1!==["heroes","riddles"].indexOf(cleverapps.config.name)&&e.type===Mission.TYPE_BURN_NEARBY?bundles.memorial.frames.mission_icon_png:-1!==["wordsoup","crocword","scramble"].indexOf(cleverapps.config.name
)&&e.type===Mission.TYPE_LETTER?bundles.memorial.frames.mission_icon_png:void 0},missionStar:function(e){if(-1!==["wordsoup","crocword","scramble"].indexOf(cleverapps.config.name))return bundles.memorial.frames["mission_star"+e.type+"_png"]},missionRulesWindow:function(e){if(-1!==["wordsoup","crocword","scramble"].indexOf(cleverapps.config.name)&&e.type===Mission.TYPE_LETTER)return bundles.memorial.jsons.letter_rules_json},missionWindowDecors:function(){return cleverapps.styles.SceneDecors.missionWindowMemorial},removeMissions:function(){if(-1!==["heroes","riddles"].indexOf(cleverapps.config.name))return[Mission.TYPE_COLLECT_MARK,Mission.TYPE_COMBO]},wardrobeWindowBanner:function(){return bundles.memorial.frames.wardrobe_window_banner},localization:function(){if(cleverapps.SkinManager.SKINS.memorial.localization[cleverapps.config.name])return cleverapps.SkinManager.SKINS.memorial.localization[cleverapps.config.name]}}},cleverapps.SkinManager.SKINS.halloween={bundle:"halloween",
localization:{heroes:{"BoostersSaleWindow.title":"Halloween.BoostersSaleWindow.title"},scramble:{"BoostersSaleWindow.title":"Halloween.BoostersSaleWindow.title","Missions.LetterTournament.Title":"Halloween.Missions.LetterTournament.Title","Missions.LetterTournament.Rules1":"Halloween.Missions.LetterTournament.Rules1","MissionRulesWindow.LetterTournament.text2":"Halloween.MissionRulesWindow.LetterTournament.text2","MissionRulesWindow.LetterTournament.text3":"Halloween.MissionRulesWindow.LetterTournament.text3"},wordsoup:{"BoostersSaleWindow.title":"Halloween.BoostersSaleWindow.title"},tripeaks:{"BoostersSaleWindow.title":"Halloween.BoostersSaleWindow.title",CloversTooltip:"Halloween.CloversTooltip","Missions.LetterTournament.Title":"Halloween.Missions.LetterTournament.Title","MissionRulesWindow.LetterTournament.text2":"Halloween.MissionRulesWindow.LetterTournament.text2","MissionRulesWindow.LetterTournament.text3":"Halloween.MissionRulesWindow.LetterTournament.text3",
"AddMovesWindow.missionGiveUp.LetterTournament":"Halloween.AddMovesWindow.missionGiveUp.LetterTournament","AddMovesWindow.mission.LetterTournament":"Halloween.AddMovesWindow.mission.LetterTournament"},differences:{"BoostersSaleWindow.title":"Halloween.BoostersSaleWindow.title"},riddles:{"BoostersSaleWindow.title":"Halloween.BoostersSaleWindow.title"}},slots:{windowDecors:function(e){var t={};return-1!==["wordsoup"].indexOf(cleverapps.config.name)&&-1!==[VictoryWindow].indexOf(e.window.constructor)?t.web_bottom=!0:(t.web_top=!0,t.web_bottom=!0,t.pumpkin_animation=!0),-1!==["wordsoup"].indexOf(cleverapps.config.name)&&-1!==[ExtraWindow].indexOf(e.window.constructor)&&(t.web_top=!1),-1!==[MiniGameWindow].indexOf(e.window.constructor)&&(t.web_top=!1,t.web_bottom=!1),-1!==["olympics","differences"].indexOf(cleverapps.config.name)&&-1!==[KnockoutWindow].indexOf(e.window.constructor)&&(t.pumpkin_animation=!1),-1!==[PiggyBankWindow,MissionRulesWindow,DailyTasksWindow,LeadersWindow].indexOf(
e.window.constructor)&&(t.forest=!0,t.roots_top_left=!0,t.roots_top_right=!0,t.owls_animation=!0,t.pumpkin_animation=!1,t.web_top=!1),-1!==[MissionRulesWindow].indexOf(e.window.constructor)&&cleverapps.wideMode.mode!==cleverapps.WideMode.VERTICAL&&(t.forest=!1,t.owls_animation=!1),-1!==[RestartWindow,LevelStartWindow,LoseWindow,SettingsWindow].indexOf(e.window.constructor)&&(t.pumpkins=!0,t.candle_animation=!0,t.pumpkin_animation=!1,t.web_top=!1),"undefined"!=typeof QuestWindow&&e.window.constructor===QuestWindow&&(t.pumpkin_animation=!1),"undefined"!=typeof BuildingStartWindow&&e.window.constructor===BuildingStartWindow&&(t.web_top=!1),-1!==[RulesWindow].indexOf(e.window.constructor)&&(t.pumpkin_animation=!1),"differences"===cleverapps.config.name&&-1!==[MissionWindow].indexOf(e.window.constructor)&&(t.pumpkin_animation=!1),"tripeaks"===cleverapps.config.name&&(-1!==[MissionWindow].indexOf(e.window.constructor)&&(t.web_top=!1),-1!==[VictoryWindow].indexOf(e.window.constructor)&&(
t.web_top=!1,t.pumpkin_animation=!1),e.window instanceof RulesWindow&&(t.pumpkin_animation=!1)),"scramble"===cleverapps.config.name&&(-1!==[BackgroundsWindow].indexOf(e.window.constructor)&&(t.web_bottom=!1),e.window instanceof RulesWindow&&(t.pumpkin_animation=!1),-1!==[DailyCupLeadersWindow,CryptexWindow,BackgroundsWindow,VictoryWindow].indexOf(e.window.constructor)&&(t.pumpkin_animation=!1),-1!==[DailyTasksWindow,LevelStartWindow,SettingsWindow].indexOf(e.window.constructor)&&(t.pumpkin_animation=!0)),t},localization:function(){if(cleverapps.SkinManager.SKINS.halloween.localization[cleverapps.config.name])return cleverapps.SkinManager.SKINS.halloween.localization[cleverapps.config.name]},missionIcon:function(e){if(-1!==["scramble","tripeaks"].indexOf(cleverapps.config.name)&&e.type===Mission.TYPE_LETTER)return bundles.halloween.frames.mission_letter_png},missionStar:function(e){return-1!==["scramble"].indexOf(cleverapps.config.name
)?bundles.halloween.frames["mission_star_"+e.type+"_png"]:-1!==["tripeaks"].indexOf(cleverapps.config.name)?bundles.halloween.frames.mission_letter_png:void 0},missionRulesWindow:function(e){if(-1!==["tripeaks","scramble"].indexOf(cleverapps.config.name)&&e.type===Mission.TYPE_LETTER)return bundles.halloween.jsons.letter_rules_json},spine:function(e){var t={};return-1!==["scramble","tripeaks"].indexOf(cleverapps.config.name)&&(t[bundles.letter_tournament.jsons.mission_window_json]=bundles.halloween.jsons.halloween_mission_window_json,t[bundles.sidebar.jsons.mission_letter_icon_json]=bundles.sidebar.jsons.halloween_letter_json),t[e.json]},cardMarkSpine:function(e){return-1!==["tripeaks"].indexOf(cleverapps.config.name)&&"mission"===e.type?bundles.halloween.jsons.halloween_marks_json:e.json}}},cleverapps.SkinManager.SKINS.black_friday={bundle:"black_friday",slots:{windowDecors:function(e){var t=e.decors&&cleverapps.clone(e.decors,!0)||{};return"scramble"===cleverapps.config.name&&-1!==[
FavoriteSaleWindow,BoostersSaleWindow].indexOf(e.window.constructor)&&(t.black_friday_balloon=!0,t.black_friday_label=!0),t}}};var NoConnectionWindow=Window.extend({onWindowLoaded:function(){var e=cleverapps.styles.NoConnectionWindow;this._super({title:"messages:NoConnectionWindow.title",name:"noconnectionwindow",content:this.getContent(),button:{width:e.button.width,height:e.button.height,text:Messages.get("OK"),onPressed:function(){this.close()}.bind(this)}})},getContent:function(){var e=cleverapps.styles.NoConnectionWindow,t=new cc.Node;t.setAnchorPoint2(),t.setContentSize2(e.animation);var n=new cleverapps.Spine(bundles.main.jsons.no_connection_json,1);t.addChild(n),n.setPositionRound(t.width/2,t.height/2),n.setAnimation(0,"animation",!0);var s=cleverapps.UI.generateTTFText("messages:RestartWindow.AnErrorOccured",cleverapps.styles.FONTS.WINDOW_SMALL_TEXT);return s.setDimensions(e.text.width,0),s.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER),new cleverapps.Layout([s,t],{
direction:cleverapps.UI.VERTICAL,margin:e.margin})}});cleverapps.styles.NoConnectionWindow={width:500,height:800,margin:30,animation:{width:400,height:400},text:{width:480},button:{width:200,height:100}},cleverapps.UI.ZoomHandler=function(e){this.target=e,cc.eventManager.addListener({event:cc.EventListener.MOUSE,onMouseScroll:this.handleMouseScroll.bind(this)},this.target),cc.sys.isMobile&&cc.sys.capabilities.touches&&this.enablePinchZoom()},cleverapps.UI.ZoomHandler.prototype.handleMouseScroll=function(e){if(cleverapps.metha.isControlEnabled()&&!this._zoomRunning){var t=e._scrollY;0!==t&&(t=0<t?.1:-.1,this.zoomTo(this.target.zoom+t,0))}},cleverapps.UI.ZoomHandler.prototype.normalizeZoom=function(e){return Math.min(Math.max(e,.8),2)},cleverapps.UI.ZoomHandler.prototype.setZoom=function(e,t){this.target.zoom=t?e:this.normalizeZoom(e),this.target.centerNode.setScale(this.target.zoom),this.target.updateVisibility(),this.target.calcBorders(),this.target.scrollHandler.afterContainerScale()}
,cleverapps.UI.ZoomHandler.prototype.zoomTo=function(e,t){this._targetZoom=this.normalizeZoom(e),this._startZoom=this.target.zoom,this._elapsedTime=0,this._zoomDuration=t,this._zoomRunning=!0},cleverapps.UI.ZoomHandler.prototype.processZoom=function(e){this._zoomRunning&&(this._elapsedTime<this._zoomDuration?(this.setZoom(this._startZoom+(this._targetZoom-this._startZoom)*(this._elapsedTime/this._zoomDuration),!0),this._elapsedTime+=e):(this._zoomRunning=!1,this.setZoom(this._targetZoom)))},cleverapps.UI.ZoomHandler.prototype.enablePinchZoom=function(){var i=0,o=function(e,t){return e=e.getLocationInView(),t=t.getLocationInView(),Math.abs(e.x-t.x)+Math.abs(e.y-t.y)},e=function(e){var t=r._claimedTouches;return 1===t.length?i=o(t[0],e):1<t.length&&(i=o(t[0],t[1])),!0}.bind(this),t=function(e,t){if(2<=r._claimedTouches.length){this.pinchZooming=!0;var n=o(r._claimedTouches[0],r._claimedTouches[1]),s=i-n;3<Math.abs(s)&&(i=n,this.zoomTo(this.target.zoom-85e-5*s,0)),t.stopPropagation()}
}.bind(this),n=function(){r._claimedTouches.length<2&&(this.pinchZooming=!1)}.bind(this),r=cc.eventManager.addListener({event:cc.EventListener.TOUCH_ONE_BY_ONE,onTouchBegan:e,onTouchMoved:t,onTouchCancelled:n,onTouchEnded:n},this.target)};var BaseBoosterBefore=function(e){cleverapps.EventEmitter.call(this),this.id=e,this.price=cleverapps.config.prices.boosters[e][1],this.state=BaseBoosterBefore.ACTIVE_STATE,this.bonusState=BaseBoosterBefore.BONUS_EMPTY_STATE,this.isAvailable()||(this.state=BaseBoosterBefore.DISABLED_STATE)};BaseBoosterBefore.prototype=Object.create(cleverapps.EventEmitter.prototype),(BaseBoosterBefore.prototype.constructor=BaseBoosterBefore).prototype.onStart=function(){this.state===BaseBoosterBefore.USE_STATE&&cleverapps.boostersCounter.use(this.id)},BaseBoosterBefore.prototype.onGiveUp=function(){this.state===BaseBoosterBefore.USE_STATE&&(cleverapps.boostersCounter.add(this.id,1),this.state=BaseBoosterBefore.ACTIVE_STATE)},
BaseBoosterBefore.prototype.isActivated=function(){return this.state===BaseBoosterBefore.USE_STATE},BaseBoosterBefore.prototype.isBonusActivated=function(){return this.bonusState===BaseBoosterBefore.BONUS_LANTERN_STATE},BaseBoosterBefore.prototype.getActivatedStates=function(){var e=[];return this.isActivated()&&e.push(this.state),this.isBonusActivated()&&e.push(this.bonusState),e},BaseBoosterBefore.prototype.getAmount=function(){return cleverapps.boostersCounter.getAmount(this.id)},BaseBoosterBefore.prototype.setState=function(e){this.state=e,this.trigger("update")},BaseBoosterBefore.prototype.setBonusState=function(e){this.bonusState=e,this.trigger("update")},BaseBoosterBefore.prototype.use=function(){if(this.state===BaseBoosterBefore.ACTIVE_STATE)if(0<this.getAmount())this.setState(BaseBoosterBefore.USE_STATE);else if(cleverapps.user.canTakeGold(this.price)){levels.user.takeGold(this.price),cleverapps.boostersCounter.add(this.id,1)
;var e=BoostersBefore.instance&&BoostersBefore.instance.level;cleverapps.eventLogger.logEvent(cleverapps.EVENTS.HINT_USED,{hash:e.hash,amount:this.price}),cleverapps.eventLogger.logEvent(cleverapps.EVENTS.BOOSTERS_BOUGHT,{amount:1}),cleverapps.eventLogger.logEvent(cleverapps.EVENTS.BOOSTERS_BOUGHT_ITEM,{id:this.id,amount:1}),cleverapps.audio.playSound(bundles.main.urls.shop_buy_effect),this.setState(BaseBoosterBefore.USE_STATE)}else cleverapps.flags.nopayments?cleverapps.Notification.create("messages:NotEnoughCoins"):new HardCurrencyShopWindow},BaseBoosterBefore.prototype.unuse=function(){this.state===BaseBoosterBefore.USE_STATE&&this.setState(BaseBoosterBefore.ACTIVE_STATE)},BaseBoosterBefore.prototype.onClick=function(){this.state===BaseBoosterBefore.USE_STATE?this.unuse():(this.use(),cleverapps.forces.isRunningForce()&&cleverapps.forces.closeRunningForce())},BaseBoosterBefore.prototype.isAvailable=function(){return cleverapps.user.checkAvailable(
BoostersBeforeConfig[this.id].available)},BaseBoosterBefore.prototype.isDisabled=function(){return this.state===BaseBoosterBefore.DISABLED_STATE||this.state===BaseBoosterBefore.UPCOMING_STATE},BaseBoosterBefore.prototype.showTutorialStep=function(e){this.isForceAvailable()?(cleverapps.boostersCounter.canUse(this.id)||cleverapps.boostersCounter.add(this.id,1),this.trigger("showForce",e)):e()},BaseBoosterBefore.prototype.isForceAvailable=function(){return this.isAvailable()&&!cleverapps.forces.isShown(this.force.id)},BaseBoosterBefore.ACTIVE_STATE=0,BaseBoosterBefore.USE_STATE=1,BaseBoosterBefore.DISABLED_STATE=4,BaseBoosterBefore.UPCOMING_STATE=7,BaseBoosterBefore.BONUS_LANTERN_STATE=2,BaseBoosterBefore.BONUS_EMPTY_STATE=6;var ComboBooster=function(){BaseBoosterBefore.call(this,BoostersBefore.TYPE_COMBO),this.force=Forces.FIRST_BOOSTERS_BEFORE};ComboBooster.prototype=Object.create(BaseBoosterBefore.prototype),(ComboBooster.prototype.constructor=ComboBooster
).prototype.giveBonus=function(){var e=this.getActivatedStates().length*ComboBooster.COMBOS_AMOUNT,t=ComboBooster.COMBOS_TIMEOUTS.slice(0,e),n=Game.currentGame.field.addRandomCombo(e,{boosterBefore:!0,timeouts:t});n<e&&cleverapps.eventLogger.logEvent(cleverapps.EVENTS.BOOSTER_COMBO_NO_PLACE,{amount:e-n}),n<=e-ComboBooster.COMBOS_AMOUNT&&this.onGiveUp()},ComboBooster.COMBOS_AMOUNT=5,ComboBooster.COMBOS_TIMEOUTS=[0,120,250,360,500,620,750,860,1e3,1100];var DiceBooster=function(){BaseBoosterBefore.call(this,BoostersBefore.TYPE_DICE),this.force=Forces.SECOND_BOOSTERS_BEFORE};DiceBooster.prototype=Object.create(BaseBoosterBefore.prototype),(DiceBooster.prototype.constructor=DiceBooster).prototype.giveBonus=function(){Game.currentGame.dice.roll(),Game.currentGame.dice.reward(),this.number=Game.currentGame.dice.number},DiceBooster.prototype.getBonusDuration=function(){return DiceBooster.BONUS_DURATION+.2*(this.number||6)},DiceBooster.BONUS_DURATION=2.6;var MagnetBooster=function(){
BaseBoosterBefore.call(this,BoostersBefore.TYPE_MAGNET),this.force=Forces.FIRST_BOOSTERS_BEFORE};MagnetBooster.prototype=Object.create(BaseBoosterBefore.prototype),(MagnetBooster.prototype.constructor=MagnetBooster).prototype.giveBonus=function(){var e=Game.currentGame.table.getScreen(),t=cleverapps.Random.shuffle(e.cardsThatCanBeReplacedWithBoosters());if(0!==t.length){var n=t.filter(function(e){return e.isOpen()}),s=0<n.length?n[0]:t[0],i=cleverapps.extend(s.toJSON(),{marks:["magnet"]}),o=CardFactory.Create(i);o.setOwner(s.owner),o.deep=s.deep,o.screenZOrder=s.screenZOrder,e.replaceCard(s,o),e.trigger("replaceCardWithAnother",s,o),s.isOpen()&&o.flip();var r=o.marks[0];r.hide(),e.trigger("demonstrateBoosterBefore",o,function(){r.show(!0)})}else this.onGiveUp()},MagnetBooster.prototype.getBonusDuration=function(){return MagnetBooster.BONUS_DURATION},MagnetBooster.BONUS_DURATION=2.2;var MovesBooster=function(e){BaseBoosterBefore.call(this,BoostersBefore.TYPE_MOVES),
this.force=Forces.SECOND_BOOSTERS_BEFORE,e&&0===e.episodeNo&&e.levelNo<=2&&(this.state=BaseBoosterBefore.DISABLED_STATE)};MovesBooster.prototype=Object.create(BaseBoosterBefore.prototype),(MovesBooster.prototype.constructor=MovesBooster).prototype.giveBonus=function(){var e=0;this.isActivated()&&(e+=MovesBooster.BOUGHT_MOVES_AMOUNT),this.isBonusActivated()&&(e+=MovesBooster.BONUS_MOVES_AMOUNT),Game.currentGame.setMoves(Game.currentGame.moves+e,{animate:!0,boosterBefore:!0}),Game.currentGame.beginMoves+=e},MovesBooster.BONUS_MOVES_AMOUNT=3,MovesBooster.BOUGHT_MOVES_AMOUNT=5;var MultiColorBooster=function(){BaseBoosterBefore.call(this,BoostersBefore.TYPE_MULTICOLOR),this.force=Forces.THIRD_BOOSTERS_BEFORE};MultiColorBooster.prototype=Object.create(BaseBoosterBefore.prototype),(MultiColorBooster.prototype.constructor=MultiColorBooster).prototype.giveBonus=function(){var e=this.getActivatedStates().length,t=Game.currentGame.field.addRandomMulticolor(e,{boosterBefore:!0});t<e&&(
cleverapps.eventLogger.logEvent(cleverapps.EVENTS.BOOSTER_MULTICOLOR_NO_PLACE,{amount:e-t}),this.onGiveUp())};var TwoJokersBooster=function(){BaseBoosterBefore.call(this,BoostersBefore.TYPE_TWO_JOKERS),this.force=Forces.THIRD_BOOSTERS_BEFORE};TwoJokersBooster.prototype=Object.create(BaseBoosterBefore.prototype),(TwoJokersBooster.prototype.constructor=TwoJokersBooster).prototype.giveBonus=function(){var s=Game.currentGame.table.getScreen(),e=function(e,t){if(e){var n=CardFactory.Create({feature:"wild",x:e.getPositionX(),y:e.getPositionY(),rotation:e.getRotation(),screenZOrder:e.screenZOrder});n.setOwner(e.owner),n.deep=e.deep,s.insertBeforeCard(e,n),s.trigger("insertCard",n,t?-2*cleverapps.styles.CardView.width:2*cleverapps.styles.CardView.width)}},t=s.cardsWithPossibilityOfPlacingUnderThem();e(t.filter(function(e){return e.getPositionX()<0}).pop(),!0),e(t.filter(function(e){return 0<=e.getPositionX()}).pop(),!1)},TwoJokersBooster.prototype.getBonusDuration=function(){
return TwoJokersBooster.BONUS_DURATION},TwoJokersBooster.BONUS_DURATION=1.6;var HighlightBooster=function(){BaseBoosterBefore.call(this,BoostersBefore.TYPE_HIGHLIGHT),this.force=Forces.FIRST_BOOSTERS_BEFORE};HighlightBooster.prototype=Object.create(BaseBoosterBefore.prototype),(HighlightBooster.prototype.constructor=HighlightBooster).prototype.giveBonus=function(){Game.currentGame.currentHighlighter.enable()};var EyeBooster=function(){BaseBoosterBefore.call(this,BoostersBefore.TYPE_EYE),this.force=Forces.SECOND_BOOSTERS_BEFORE};EyeBooster.prototype=Object.create(BaseBoosterBefore.prototype),(EyeBooster.prototype.constructor=EyeBooster).prototype.giveBonus=function(){this.trigger("giveBonus")},EyeBooster.prototype.getBonusDuration=function(){return 5};var MagnifierBooster=function(){BaseBoosterBefore.call(this,BoostersBefore.TYPE_HINT),this.force=Forces.THIRD_BOOSTERS_BEFORE};MagnifierBooster.prototype=Object.create(BaseBoosterBefore.prototype),(
MagnifierBooster.prototype.constructor=MagnifierBooster).prototype.giveBonus=function(){Game.currentGame.keypad.addMagnifiers(MagnifierBooster.AMOUNT),Game.currentGame.keypad.magnifiersShowUp()},MagnifierBooster.AMOUNT=5;var BoostersBefore=function(e){var t=(BoostersBefore.instance=this).level=e.level;"solitaire"===cleverapps.config.type?(this.list=[new MagnetBooster,new DiceBooster,new TwoJokersBooster],cleverapps.boostersCounter.onChangeListeners.BoostersBefore=function(){this.list.forEach(function(e){e.onChangeAmountListener()})}.bind(this)):"stacks"===cleverapps.config.subtype?this.list=[new HighlightBooster,new EyeBooster,new MagnifierBooster]:this.list=[new ComboBooster,new MovesBooster(t),new MultiColorBooster];var n=Lantern.GetStreak(this.level);if(0<n){this.lantern=Lantern.Get();for(var s=0;s<n;s++)this.list[s].setBonusState(BaseBoosterBefore.BONUS_LANTERN_STATE)}for(s=0;s<this.list.length;s++)if(!this.list[s].isAvailable()){this.list[s].setState(
BaseBoosterBefore.UPCOMING_STATE);break}};BoostersBefore.prototype.onStart=function(){this.list.forEach(function(e){e.onStart()})},BoostersBefore.prototype.onGiveUp=function(){cleverapps.lives&&this.list.forEach(function(e){e.onGiveUp()})},BoostersBefore.prototype.giveBonus=function(e){var t=this.list.filter(function(e){return 0<e.getActivatedStates().length});"match3"===cleverapps.config.type&&t.reverse();var n=t.map(function(n){return n.getActivatedStates().forEach(function(e){cleverapps.eventLogger.logEvent(cleverapps.EVENTS.BOOSTERS_EXECUTE+"_"+n.id+"_"+e)}),function(e){n.giveBonus();var t=cleverapps.styles.BoostersBefore.duration;n.getBonusDuration&&(t=n.getBonusDuration()),0===t?e():Game.currentGame.counter.setTimeout(e,1e3*t)}});cleverapps.metha.compound(e,n)},BoostersBefore.prototype.showTutorialStep=function(){var e=this.list.map(function(t){return function(e){t.showTutorialStep(e)}});cleverapps.metha.compound(function(){},e)},
BoostersBefore.prototype.getActivatedBooster=function(t){var e=this.list.filter(function(e){return e instanceof t})[0];return e&&e.isActivated()?e:void 0},BoostersBefore.GetAppropriateTypes=function(){return"solitaire"===cleverapps.config.type?[BoostersBefore.TYPE_MAGNET,BoostersBefore.TYPE_DICE,BoostersBefore.TYPE_TWO_JOKERS]:"stacks"===cleverapps.config.subtype?[BoostersBefore.TYPE_HIGHLIGHT,BoostersBefore.TYPE_EYE,BoostersBefore.TYPE_HINT]:[BoostersBefore.TYPE_COMBO,BoostersBefore.TYPE_MOVES,BoostersBefore.TYPE_MULTICOLOR]},BoostersBefore.isAvailable=function(e){return cleverapps.user.checkAvailable(BoostersBefore.AVAILABLE,e)},BoostersBefore.AVAILABLE={episode:0,level:4,projectName:["riddles","heroes","tripeaks","scramble","adventure","runes"]},cleverapps.styles.BoostersBefore={duration:.3},BoostersBefore.TYPE_COMBO=5,BoostersBefore.TYPE_MOVES=6,BoostersBefore.TYPE_MULTICOLOR=7,BoostersBefore.TYPE_MAGNET=10,BoostersBefore.TYPE_DICE=11,BoostersBefore.TYPE_TWO_JOKERS=12,
BoostersBefore.TYPE_HIGHLIGHT=13,BoostersBefore.TYPE_EYE=14,BoostersBefore.TYPE_HINT=15;var BoostersBeforeConfig={};BoostersBeforeConfig[BoostersBefore.TYPE_COMBO]={icon:bundles.reward_icons.frames.heroes_png,available:{episode:0,level:13}},BoostersBeforeConfig[BoostersBefore.TYPE_MOVES]={icon:bundles.reward_icons.frames.moves_png,available:{episode:1,level:3}},BoostersBeforeConfig[BoostersBefore.TYPE_MULTICOLOR]={icon:bundles.reward_icons.frames.multicolor_png,available:{episode:1,level:7}},BoostersBeforeConfig[BoostersBefore.TYPE_MAGNET]={icon:bundles.reward_icons.frames.magnet_png,available:{episode:0,level:14}},BoostersBeforeConfig[BoostersBefore.TYPE_DICE]={icon:bundles.reward_icons.frames.dice_png,available:{episode:1,level:3}},BoostersBeforeConfig[BoostersBefore.TYPE_TWO_JOKERS]={icon:bundles.reward_icons.frames.joker_png,available:{episode:1,level:7}},BoostersBeforeConfig[BoostersBefore.TYPE_HIGHLIGHT]={icon:bundles.reward_icons.frames.highlight,available:{episode:0,level:10}},
BoostersBeforeConfig[BoostersBefore.TYPE_EYE]={icon:bundles.reward_icons.frames.eye,available:{episode:1,level:3}},BoostersBeforeConfig[BoostersBefore.TYPE_HINT]={icon:bundles.reward_icons.frames.hint,available:{episode:1,level:7}};var BoosterBeforeAmountView=cc.Node.extend({ctor:function(e){this._super(),this.setAnchorPoint(.5,.5),this.setCascadeOpacityEnabled(!0),this.booster=e,this.bg=new cc.Sprite(bundles.boosters_before.frames.booster_before_purple_button_png),this.addChild(this.bg),this.booster.isDisabled()&&this.booster.getAmount()>cleverapps.BoostersCounter.INIT_AMOUNT&&cleverapps.UI.convertToGrayScale(this.bg),this.amount=cleverapps.UI.generateImageText("",cleverapps.styles.FONTS.BOOSTER_BEFORE_AMOUNT_TEXT),this.addChild(this.amount),this.icon=new cc.Sprite(bundles.boosters_before.frames.booster_before_plus_icon_png),this.addChild(this.icon),this.update()},showActivated:function(){this.amount.visible=!1,this.icon.visible=!0,this.icon.setSpriteFrame(
bundles.boosters_before.frames.booster_before_check_icon_png),this.bg.setSpriteFrame(bundles.boosters_before.frames.booster_before_green_button_png)},showAmount:function(){var e=cleverapps.styles.BoosterBeforeAmountView;this.amount.visible=!1,this.icon.visible=!1,this.icon.setSpriteFrame(bundles.boosters_before.frames.booster_before_plus_icon_png),this.bg.setSpriteFrame(bundles.boosters_before.frames.booster_before_purple_button_png),0<this.booster.getAmount()?(this.amount.visible=!0,this.amount.setString(this.booster.getAmount()),this.amount.fitTo(e.amount.width)):this.icon.visible=!0},update:function(){this.booster.isActivated()?this.showActivated():this.showAmount(),this.visible=!this.booster.isDisabled()||this.booster.getAmount()>cleverapps.BoostersCounter.INIT_AMOUNT;var e=cleverapps.styles.BoosterBeforeAmountView;this.setContentSize2(Math.max(this.bg.width*this.bg.scale,this.amount.width*this.amount.scale),Math.max(this.bg.height*this.bg.scale,this.amount.height*this.amount.scale
)),this.amount.setPositionRound(e.amount),this.bg.setPositionRound(this.width/2,this.height/2),this.icon.setPositionRound(e.icon)}});cleverapps.styles.BoosterBeforeAmountView={amount:{x:{align:"center",dx:0},y:{align:"center",dy:4},width:55},icon:{x:{align:"center"},y:{align:"center"}}};var BoosterBeforeBonusView=cc.Sprite.extend({ctor:function(e){this._super(bundles.boosters_before.frames.booster_before_green_button_png),this.booster=e,this.icon=new cc.Sprite(bundles.boosters_before.frames.booster_before_lantern_icon_png),this.icon.setPositionRound(this.width/2,this.height/2),this.addChild(this.icon)},lanternAnimation:function(){this.scale=0,this.runAction(new cc.Sequence(new cc.DelayTime(1.1),new cc.ScaleTo(.2,1,1)))}}),BoosterBeforeView=cc.Scale9Sprite.extend({ctor:function(e,t){var n=cleverapps.styles.BoosterBeforeView;this._super(bundles.boosters_before.frames.booster_before_bg_png),this.setContentSize2(n),this.booster=e;var s=n.icon[e.id]?n.icon[e.id].dy:n.icon.dy,
i=this.icon=new cc.Sprite(this.getIconImage());if(i.scale=i.baseScale=1,i.setPositionRound(this.width/2,this.height/2+s),this.addChild(i),this.textAvailable=cleverapps.UI.generateTTFText(Messages.get("UnlockOnLevel",{level:cleverapps.humanReadableNumber(BoostersBeforeConfig[this.booster.id].available.episode,BoostersBeforeConfig[this.booster.id].available.level)}),cleverapps.styles.FONTS.BOOSTERS_BEFORE_UNLOCK||cleverapps.styles.FONTS.WINDOW_SMALL_TEXT),this.addChild(this.textAvailable,1),this.textAvailable.setPositionRound(n.textAvailable),this.textAvailable.fitTo(n.textAvailable.width),n.textAvailable.bg){var o=bundles.boosters_before.frames.booster_before_level_bg;t.isHard()&&bundles.boosters_before.frames.booster_before_level_bg_hard&&(o=bundles.boosters_before.frames.booster_before_level_bg_hard),t.isTricky()&&bundles.boosters_before.frames.booster_before_level_bg_tricky&&(o=bundles.boosters_before.frames.booster_before_level_bg_tricky),this.textAvailableBg=new cc.Scale9Sprite(o),
this.addChild(this.textAvailableBg),this.textAvailableBg.setContentSize2(n.textAvailable.bg),this.textAvailableBg.setPositionRound(n.textAvailable.bg)}if(e.state===BaseBoosterBefore.UPCOMING_STATE&&(cleverapps.UI.convertToGrayScale(i),void 0!==cleverapps.styles.BoosterBeforeView.disabled[e.id]&&(i.opacity*=cleverapps.styles.BoosterBeforeView.disabled[e.id].opacity)),e.bonusState===BaseBoosterBefore.BONUS_LANTERN_STATE){var r=new BoosterBeforeBonusView(e);r.setPositionRound(n.bonus),this.addChild(r),r.lanternAnimation()}-1===[BaseBoosterBefore.UPCOMING_STATE,BaseBoosterBefore.DISABLED_STATE].indexOf(e.state)&&(this.amount=new BoosterBeforeAmountView(e),this.amount.setPositionRound(n.amount),this.addChild(this.amount));var a=cleverapps.overrideStyles(cleverapps.styles.CoinsPriceView,n.price.styles,!0);if(this.price=new CoinsPriceView(e.price,{styles:a,font:cleverapps.styles.FONTS.BOOSTER_BEFORE_COINS_PRICE_TEXT}),this.price.setPositionRound(n.price),this.addChild(this.price),e.on(
"update",this.createListener(this.update.bind(this))),e.on("showForce",this.createListener(this.showForce.bind(this))),this.update(),e.isAvailable())cleverapps.UI.applyHover(this),cleverapps.UI.onClick(this,this.onClick.bind(this));else BoostersBeforeConfig[e.id].available;this.booster.onChangeAmountListener=this.createListener(this.update.bind(this))},onClick:function(){var e=this.booster.isActivated()?bundles.main.urls.booster_before_cancel_effect:bundles.main.urls.booster_before_selection_effect;cleverapps.audio.playSound(e),this.booster.onClick(),this.icon.stopAllActions(),this.icon.setScale(.95*this.icon.baseScale),this.icon.runAction(new cc.ScaleTo(.15,this.icon.baseScale).easing(cc.easeBackInOut()))},update:function(){var e=bundles.boosters_before.frames.booster_before_bg_png;this.booster.isDisabled()?e=bundles.boosters_before.frames.booster_before_bg_off_png:this.booster.isActivated()&&(e=bundles.boosters_before.frames.booster_before_bg_on_png),this.setSpriteFrame(
cc.spriteFrameCache.getSpriteFrame(e)),this.icon.setSpriteFrame(this.getIconImage()),cleverapps.UI.convertToGrayScale(this.icon,this.booster.state!==BaseBoosterBefore.UPCOMING_STATE),this.textAvailable.setVisible(this.booster.state===BaseBoosterBefore.UPCOMING_STATE),this.textAvailableBg&&this.textAvailableBg.setVisible(this.booster.state===BaseBoosterBefore.UPCOMING_STATE),this.amount&&this.amount.update(),this.price.visible=this.booster.state===BaseBoosterBefore.ACTIVE_STATE&&this.booster.getAmount()<=0,this.booster.state===BaseBoosterBefore.USE_STATE&&Messages.has("BoosterBeforeUse_"+this.booster.id)&&cleverapps.Notification.create("messages:BoosterBeforeUse_"+this.booster.id,{image:new cc.Sprite(BoostersBeforeConfig[this.booster.id].icon)})},getIconImage:function(){return this.booster.state===BaseBoosterBefore.DISABLED_STATE?bundles.boosters_before.frames.booster_before_lock_png:BoostersBeforeConfig[this.booster.id].icon},showForce:function(e){var t=this.booster.force
;cleverapps.forces.isAvailable(this,t)?(cleverapps.forces.create(this,t),cleverapps.forces.onceForceClosed=e,this.update()):e()}});cleverapps.styles.BoosterBeforeView={width:186,height:186,bonus:{x:{align:"left",dx:0},y:{align:"bottom",dy:-18}},amount:{x:{align:"right",dx:18},y:{align:"bottom",dy:-18}},price:{x:{align:"center",dx:0},y:{align:"top",dy:5},styles:{icon:{scale:.6},bg:{image:bundles.boosters_before.frames.booster_before_price_bg_png,padding:{x:20,y:8},dx:4,dy:-2},margin:3}},textAvailable:{x:{align:"center"},y:{align:"top",dy:40},width:250},disabled:{},icon:{dy:0}},cleverapps.styles.BoosterBeforeView.disabled[BoostersBefore.TYPE_DICE]={opacity:.8};var BoostersBeforeComponent=function(t){var e=cleverapps.styles.BoostersBeforeComponent,n=cleverapps.UI.generateTTFText("messages:BoostersBeforeComponent.Title",cleverapps.styles.FONTS.BOOSTERS_BEFORE_TEXT||cleverapps.styles.FONTS.WINDOW_BIG_TEXT),s=t.list.map(function(e){return new BoosterBeforeView(e,t.level)}.bind(this)),
i=new cleverapps.Layout(s,{margin:e.margin,direction:cleverapps.UI.HORIZONTAL});s.forEach(function(e,t){e.setVisible(!1),e.runAction(new cc.Sequence(new cc.DelayTime(.2+.2*t),new cc.CallFunc(function(){cleverapps.audio.playSound(bundles.boosters_before.urls.appear_sfx,{throttle:0}),e.setScale(.5),e.setVisible(!0)}),new cc.ScaleTo(.4,1,1).easing(cc.easeBackOut(2))))});var o=new cleverapps.Layout([i,n],{margin:e.contentMargin||e.margin,direction:cleverapps.UI.VERTICAL});if(o.height+=2*e.margin,t.lantern){var r=new LanternView(t.lantern,o);o.runAction(new cc.Sequence(new cc.DelayTime(.3),new cc.CallFunc(function(){r.show()}),new cc.DelayTime(.2),new cc.CallFunc(function(){r.replaceParentSamePlace(cleverapps.windows.currentWindow()),r.setLocalZOrder(20)}),new cc.DelayTime(.6),new cc.CallFunc(function(){t.lantern.onGiveBonusListener()}.bind(this))))}return o};cleverapps.styles.BoostersBeforeComponent={margin:15};var BoostersBeforeHelper={animateAppear:function(e,t,n){if(n=cleverapps.once(
n||function(){}),e&&e.parent&&t.target&&t.target.parent){var s=t.target,i=cc.director.getRunningScene();e.setPosition(e.getParent().convertToNodeSpace(s.getParent().convertToWorldSpace(s.getPosition()))),e.replaceParentSamePlace(i),e.setLocalZOrder(10),e.setScale(2),e.runAction(new cc.Sequence(new cc.ScaleTo(.5,t.scale).easing(cc.easeBackOut()),new cc.CallFunc(function(){cleverapps.audio.playSound(bundles.main.urls.collect_coins_effect),!1!==t.remove&&e.parent&&e.removeFromParent(!0)}))),e.runAction(new cc.Sequence(new cc.DelayTime(.3),new cc.CallFunc(n))),BoostersBeforeHelper.animateStars(e)}else n()},animateStars:function(e){var t=new cleverapps.Spine(bundles.game.jsons.boosters_before_json);t.setAnimation(0,"animation",!1),t.setPositionRound(e.x,e.y),e.parent.addChild(t),t.setLocalZOrder(e.getLocalZOrder()-1),t.setTimeScale(1.3),t.runAction(new cc.Sequence(new cc.DelayTime(1.3),new cc.RemoveSelf))}},EyeBoosterView=cc.Node.extend({ctor:function(e,t){this._super(),this.booster=e,
this.boardView=t,this.board=this.boardView.board,this.setAnchorPoint2(),this.booster.on("giveBonus",this.giveBonus.bind(this)),cleverapps.wideMode.mode===cleverapps.WideMode.VERTICAL&&(EyeBoosterView.ANIMATION_TIME_SCALE=.6,EyeBoosterView.SINGLE_PASS_TIME=2.25)},giveBonus:function(){this.boardView.toggleElements(!1);var e=cc.director.getRunningScene().scene,t=new cleverapps.Spine(bundles.game.jsons.eye_booster_json);e.addChild(t),t.setLocalZOrder(110),t.setPositionRound(e.width/2,e.height/2),t.setAnimation(0,"show",!1),t.setCompleteListener(function(){t.setAnimation(0,"activate",!1),t.setCompleteListenerRemove(),t.setTimeScale(EyeBoosterView.ANIMATION_TIME_SCALE);var i=[];this.boardView.placeholders.forEach(function(e,s){e.forEach(function(e,t){if(!this.board.foundWordsSet[this.board.words[s]]){var n=this.boardView.createLetter(this.board.words[s][t].toUpperCase());this.boardView.letterGrid.addChild(n),n.setPositionRound(e.x,e.y+cleverapps.styles.BoardView.Letter.paddingBottom),i.push(
n)}}.bind(this))}.bind(this)),i.sort(function(e,t){return e.x-t.x}),this.audio=cleverapps.audio.playSound(bundles.game.urls.eye_booster_effect,{loop:!0}),this.runPass(i,0)}.bind(this)),cleverapps.audio.playSound(bundles.game.urls.eye_booster_start_effect)},runPass:function(e,i){if(i===EyeBoosterView.PASSES_COUNT)return cleverapps.audio.stopSound(this.audio),void this.onAllPassesFinished(e);var t=cleverapps.styles.EyeBoosterView,o=t.MIN_OPACITY_OFFSET,r=t.MAX_OPACITY_OFFSET,a=e[0].x-o,c=e[e.length-1].x+o,l=c-a,p=cleverapps.wait(e.length,this.runPass.bind(this,e,i+1));e.forEach(function(e){var t,n=((t=i%2==0?e.x:c-e.x)-o-a)/l*EyeBoosterView.SINGLE_PASS_TIME,s=(t-r-a)/l*EyeBoosterView.SINGLE_PASS_TIME-n;e.setOpacity(0),e.runAction(new cc.Sequence(new cc.DelayTime(n),new cc.FadeIn(s),new cc.FadeOut(s),new cc.CallFunc(p)))})},onAllPassesFinished:function(e){e.forEach(function(e){e.removeFromParent()}),this.boardView.showUpAnimation(void 0,{onlyElements:!0})}})
;EyeBoosterView.ANIMATION_TIME_SCALE=.8,EyeBoosterView.SINGLE_PASS_TIME=1.8,EyeBoosterView.PASSES_COUNT=2,cleverapps.styles.EyeBoosterView={MIN_OPACITY_OFFSET:300,MAX_OPACITY_OFFSET:100};var Rocket=cc.Node.extend({ctor:function(e,t,n){this._super(),this.startCell=e,this.targetCell=t,this.addChild(n.rocket),this.setVisible(!1);var s=0;n.startDX&&(s+=n.startDX),cleverapps.styles.Rocket.startDX&&(s+=cleverapps.styles.Rocket.startDX);var i=0;n.startDY&&(i+=n.startDY),cleverapps.styles.Rocket.startDY&&(i+=cleverapps.styles.Rocket.startDY),this.setPositionRound(BaseCellView.alignInTheGrid(e.x,e.y)),this.setPosition(this.getPosition().x+s,this.getPosition().y+i),this.aim(n)},aim:function(e){this.targetPos=BaseCellView.alignInTheGrid(this.targetCell.x,this.targetCell.y),this.prevPos=this.getPosition(),this.scheduleUpdate(),this.animateFly(e)},animateFly:function(e){var t=cleverapps.styles.Rocket,n=this.getPosition(),s=BaseCellView.alignInTheGrid(this.targetCell.x,this.targetCell.y),i=cc.p(n.x,
Math.max(n.y,s.y)+t.flyUp),o=cc.p(s.x,i.y),r=this.targetCell.y-this.startCell.y;if(this.targetCell.y>this.startCell.y&&Math.abs(this.targetCell.x-this.startCell.x)<=1){var a=Math.abs(r)*cleverapps.styles.BaseCellView.CELL_SIZE_PX;this.startCell.x<Field.SIZE/2?o.x+=a:o.x-=a}else if(this.startCell.x===this.targetCell.x&&this.startCell.y>this.targetCell.y){a=Math.abs(r)*cleverapps.styles.BaseCellView.CELL_SIZE_PX;i.y-=a/2,this.startCell.x<Field.SIZE/2?i.x+=a/2:i.x-=a/2,o=cc.p(i.x,s.y+cleverapps.styles.BaseCellView.CELL_SIZE_PX)}this.runAction(new cc.Sequence(new cc.DelayTime(e.delay),new cc.CallFunc(function(){this.setVisible(!0),e.onLaunch()}.bind(this)),new cc.BezierTo(e.duration,[i,o,s]).easing(cc.easeIn(1)),new cc.CallFunc(function(){this.unscheduleUpdate(),e.onArrive(function(){this.runAction(new cc.RemoveSelf)}.bind(this))}.bind(this))))},update:function(e){this._super(e),this.setRotation(180*Math.atan2(this.x-this.prevPos.x,this.y-this.prevPos.y)/Math.PI),
this.prevPos=this.getPosition()}});cleverapps.styles.Rocket={flyUp:150};var ViewReader={calcGrowType:function(e){return e.getGround(Iso.UP_LEFT)!==Map2d.TILE_GREEN_LEVEL_2&&e.getGround(Iso.UP_RIGHT)!==Map2d.TILE_GREEN_LEVEL_2?bundles.tiles.frames.grow12_corner:e.getGround(Iso.UP_LEFT)===Map2d.TILE_GREEN_LEVEL_2&&e.getGround(Iso.UP_RIGHT)===Map2d.TILE_GREEN_LEVEL_2?bundles.tiles.frames.grow12_both:e.getGround(Iso.UP_LEFT)===Map2d.TILE_GREEN_LEVEL_2?bundles.tiles.frames.grow12_left:bundles.tiles.frames.grow12_right},calcBorderTypeUp:function(e){return e.getGround(Iso.UP_ABOVE)===Map2d.TILE_GREEN_LEVEL_2&&e.getGround(Iso.UP_LEFT)!==Map2d.TILE_GREEN_LEVEL_2&&e.getGround(Iso.UP_RIGHT)!==Map2d.TILE_GREEN_LEVEL_2?bundles.tiles.frames.level2_up_corner:e.getGround(Iso.UP_LEFT)===Map2d.TILE_GREEN_LEVEL_2&&e.getGround(Iso.UP_RIGHT)===Map2d.TILE_GREEN_LEVEL_2?bundles.tiles.frames.level2_up_both:e.isWater(Iso.UP_LEFT)&&e.isWater(Iso.UP_RIGHT)&&e.getGround(Iso.UP_ABOVE
)===Map2d.TILE_GREEN_LEVEL_1?bundles.tiles.frames.level1_up_corner:e.getGround(Iso.UP_LEFT)===Map2d.TILE_GREEN_LEVEL_1&&e.getGround(Iso.UP_RIGHT)===Map2d.TILE_GREEN_LEVEL_1?bundles.tiles.frames.level1_up_both:void 0},calcBorderTypeDown:function(e){return e.getGround(Iso.DOWN_RIGHT)===Map2d.TILE_GREEN_LEVEL_2&&e.getGround(Iso.DOWN_LEFT)===Map2d.TILE_GREEN_LEVEL_2||e.getGround(Iso.DOWN_RIGHT)===Map2d.TILE_GREEN_LEVEL_1&&e.getGround(Iso.DOWN_LEFT)===Map2d.TILE_GREEN_LEVEL_1?bundles.tiles.frames.level1_down_both:e.isWater(Iso.DOWN_LEFT)&&e.isWater(Iso.DOWN_RIGHT)&&e.isGround(Iso.DOWN_BELOW)?bundles.tiles.frames.level1_down_corner:e.getGround(Iso.DOWN_LEFT)===Map2d.TILE_GREEN_LEVEL_2?bundles.tiles.frames.level1_down_left_only:e.getGround(Iso.DOWN_LEFT)===Map2d.TILE_GREEN_LEVEL_1?bundles.tiles.frames.level1_down_left_only:e.getGround(Iso.DOWN_RIGHT)===Map2d.TILE_GREEN_LEVEL_2?bundles.tiles.frames.level1_down_right_only:e.getGround(Iso.DOWN_RIGHT
)===Map2d.TILE_GREEN_LEVEL_1?bundles.tiles.frames.level1_down_right_only:void 0},calcBorderTypeLeft:function(e){return e.getGround(Iso.DOWN_LEFT)===Map2d.TILE_GREEN_LEVEL_2&&e.getGround(Iso.UP_LEFT)===Map2d.TILE_GREEN_LEVEL_2?e.getGround(Iso.UP_ABOVE)!==Map2d.TILE_GREEN_LEVEL_2?bundles.tiles.frames.level2_left_inner_last:bundles.tiles.frames.level2_left_inner:e.getGround(Iso.DOWN_LEFT)===Map2d.TILE_GREEN_LEVEL_1&&e.getGround(Iso.UP_LEFT)===Map2d.TILE_GREEN_LEVEL_1?e.getGround(Iso.UP_ABOVE)!==Map2d.TILE_GREEN_LEVEL_1?bundles.tiles.frames.level1_left_inner_last:bundles.tiles.frames.level1_left_inner:e.getGround(Iso.UP_LEFT)===Map2d.TILE_GREEN_LEVEL_2?e.isWater(Iso.UP_ABOVE)?bundles.tiles.frames.level2_up_left_only_last:bundles.tiles.frames.level2_up_left_only:e.getGround(Iso.UP_LEFT)===Map2d.TILE_GREEN_LEVEL_1?e.getGround(Iso.UP_ABOVE)!==Map2d.TILE_GREEN_LEVEL_1?bundles.tiles.frames.level1_up_left_only_last:bundles.tiles.frames.level1_up_left_only:e.isWater(Iso.DOWN_LEFT)&&e.isWater(
Iso.UP_LEFT)&&e.isGround(Iso.HORIZONTAL_LEFT)?bundles.tiles.frames.level1_left_corner:void 0},calcBorderTypeRight:function(e){return e.getGround(Iso.DOWN_RIGHT)===Map2d.TILE_GREEN_LEVEL_2&&e.getGround(Iso.UP_RIGHT)===Map2d.TILE_GREEN_LEVEL_2?e.getGround(Iso.UP_ABOVE)!==Map2d.TILE_GREEN_LEVEL_2?bundles.tiles.frames.level2_right_inner_last:bundles.tiles.frames.level2_right_inner:e.getGround(Iso.DOWN_RIGHT)===Map2d.TILE_GREEN_LEVEL_1&&e.getGround(Iso.UP_RIGHT)===Map2d.TILE_GREEN_LEVEL_1?e.getGround(Iso.UP_ABOVE)!==Map2d.TILE_GREEN_LEVEL_1?bundles.tiles.frames.level1_right_inner_last:bundles.tiles.frames.level1_right_inner:e.getGround(Iso.UP_RIGHT)===Map2d.TILE_GREEN_LEVEL_2?e.isWater(Iso.UP_ABOVE)?bundles.tiles.frames.level2_up_right_only_last:bundles.tiles.frames.level2_up_right_only:e.getGround(Iso.UP_RIGHT)===Map2d.TILE_GREEN_LEVEL_1?e.isWater(Iso.UP_ABOVE)?bundles.tiles.frames.level1_up_right_only_last:bundles.tiles.frames.level1_up_right_only:e.isWater(Iso.DOWN_RIGHT)&&e.isWater(
Iso.UP_RIGHT)&&e.isGround(Iso.HORIZONTAL_RIGHT)?bundles.tiles.frames.level1_right_corner:void 0},unlockBorders:function(){ViewReader.lockedBorders=[]},frameBorderLocksCache:{},getFrameBorderLocks:function(e){if(ViewReader.frameBorderLocksCache[e])return ViewReader.frameBorderLocksCache[e];var t=[],n=cleverapps.styles.ViewReader.borderLocks;return-1!==n.upBoth.indexOf(e)?(t.push(ViewReader.UP_LEFT_LOCK),t.push(ViewReader.UP_RIGHT_LOCK)):-1!==n.upLeft.indexOf(e)?t.push(ViewReader.UP_LEFT_LOCK):-1!==n.upLeft.indexOf(e)&&t.push(ViewReader.UP_RIGHT_LOCK),ViewReader.frameBorderLocksCache[e]=t},lockBorders:function(e){var t=ViewReader.getFrameBorderLocks(e);return 0===t.length?e:0<cleverapps.intersect(t,ViewReader.lockedBorders).length?void 0:(ViewReader.lockedBorders=ViewReader.lockedBorders.concat(t),e)},calcBorderType:function(e){ViewReader.unlockBorders();var t=ViewReader.calcBorderTypeUp(e),n=ViewReader.calcBorderTypeDown(e),s=ViewReader.calcBorderTypeLeft(e);return[t,
ViewReader.calcBorderTypeRight(e),s,n].map(function(e){return ViewReader.lockBorders(e)}).filter(function(e){return void 0!==e})},createTopYAnchorElement:function(e){if(e.height<=cleverapps.styles.Map2dView.cell.height)return e;var t=new cc.Node;return t.setContentSize(cleverapps.styles.Map2dView.cell.width,cleverapps.styles.Map2dView.cell.height),t.setAnchorPoint2(),e.setAnchorPoint2(.5,1),e.setPositionRound(t.width/2,t.height+1),t.addChild(e),t},hasView:function(e,t){return e===Map2d.TILE_BORDER&&0<ViewReader.calcBorderType(t).length||-1!==[Map2d.TILE_GROW,Map2d.TILE_WATER,Map2d.TILE_GREEN_LEVEL_1,Map2d.TILE_GREEN_LEVEL_2].indexOf(e)},parse:function(e,t){switch(e){case Map2d.TILE_GROW:return[ViewReader.createTopYAnchorElement(new cc.Sprite(ViewReader.calcGrowType(t)))];case Map2d.TILE_WATER:return[new cc.Sprite(bundles.tiles.frames.water)];case Map2d.TILE_BORDER:return ViewReader.calcBorderType(t).map(function(e){return ViewReader.createTopYAnchorElement(new cc.Sprite(e))})
;case Map2d.TILE_GREEN_LEVEL_1:case Map2d.TILE_GREEN_LEVEL_2:var n=(t.pointer.x+t.pointer.y)%2;return[new cc.Sprite(n?bundles.tiles.frames.green_ground_1:bundles.tiles.frames.green_ground_2)]}return[]},UP_LEFT_LOCK:0,UP_RIGHT_LOCK:1};cleverapps.styles.ViewReader={borderLocks:{upBoth:[bundles.tiles.frames.level1_up_corner,bundles.tiles.frames.level1_up_both,bundles.tiles.frames.level2_up_corner,bundles.tiles.frames.level2_up_both,bundles.tiles.frames.level1_up_right_only,bundles.tiles.frames.level1_up_left_only,bundles.tiles.frames.level2_up_right_only,bundles.tiles.frames.level2_up_left_only],upLeft:[bundles.tiles.frames.level1_up_left_only_last,bundles.tiles.frames.level2_up_left_only_last,bundles.tiles.frames.level1_left_inner,bundles.tiles.frames.level1_left_inner_last,bundles.tiles.frames.level2_left_inner,bundles.tiles.frames.level2_left_inner_last],upRight:[bundles.tiles.frames.level1_up_right_only_last,bundles.tiles.frames.level2_up_right_only_last,
bundles.tiles.frames.level1_right_inner,bundles.tiles.frames.level1_right_inner_last,bundles.tiles.frames.level2_right_inner,bundles.tiles.frames.level2_right_inner_last]}};var Map2d=function(e,t){cleverapps.EventEmitter.call(this),t=t||{},this.visibleBox=t.visibleBox||Map2d.VISIBLE_BOX,this.waterBorder=void 0!==t.waterBorder?t.waterBorder:Map2d.WATER_BORDER,this.regions=t.regions||{},this.decorators=new Map2dDecorators(t.decorators||[]),this.visibleBox.cutLeft||this.visibleBox.cutRight||(this.visibleBox.cutLeft=this.visibleBox.cutRight=(1-this.visibleBox.width)/2),e=e.map(function(e){return"string"==typeof e&&(e=e.split("").map(cleverapps.castType)),e}),this.width=e[0].length,this.height=e.length;var n=this.map(e,function(e){return e===Map2d.TILE_WATER?Map2d.TILE_WATER:void 0}),s=this.map(e,function(e){return e===Map2d.TILE_WATER?Map2d.TILE_BORDER:void 0}),i=this.map(e,function(e){return e===Map2d.TILE_WATER?void 0:e}),o=this.map(e,function(){}),r=this.map(e,function(){})
;this.layers=[n,s,i,o,r],this.onAdd=function(){},this.onAnimationsAdd=function(){},this.onMove=function(){},this.onFogOpen=function(){},this.onCenterTo=function(e,t,n){},this.onAddTarget=function(e,t){},this.onDiscoverView=function(){},this.onZoomTo=function(e,t){},this.pointer={x:0,y:0},this.constructGrowth()};Map2d.prototype=Object.create(cleverapps.EventEmitter.prototype),(Map2d.prototype.constructor=Map2d).TILE_WATER=0,Map2d.TILE_GREEN_LEVEL_1=1,Map2d.TILE_GREEN_LEVEL_2=2,Map2d.TILE_GROW=10,Map2d.TILE_BORDER=11,Map2d.LAYER_WATER=0,Map2d.LAYER_BORDERS=1,Map2d.LAYER_GROUND=2,Map2d.LAYER_UNITS=3,Map2d.LAYER_FOG=4;var Iso={SAME:{x:0,y:0},UP_LEFT:{y:-1,x:0},UP_RIGHT:{y:0,x:1},UP_ABOVE:{y:-1,x:1},DOWN_LEFT:{y:0,x:-1},DOWN_RIGHT:{y:1,x:0},DOWN_BELOW:{y:1,x:-1},HORIZONTAL_LEFT:{y:-1,x:-1},HORIZONTAL_RIGHT:{y:1,x:1}},ISO_NEIGHBORS=[Iso.DOWN_LEFT,Iso.DOWN_RIGHT,Iso.UP_LEFT,Iso.UP_RIGHT];Map2d.prototype.getView=function(){return this.onDiscoverView()},Map2d.prototype.stop=function(){
this.listAvailableUnits().forEach(function(e){e.clear()}),this.trigger("stop")},Map2d.prototype.setPointer=function(e,t){this.pointer.x=e,this.pointer.y=t},Map2d.prototype.isHiddenCorner=function(e,t){var n=this.width+this.height;return e+t<=n/2-n*(.5-this.visibleBox.cutLeft)-this.waterBorder||e+t>=n/2+n*(.5-this.visibleBox.cutRight)+this.waterBorder||e-t>=this.width-1-n*(1-this.visibleBox.height)/2+this.waterBorder||e-t<=1-this.height+n*(1-this.visibleBox.height)/2-this.waterBorder},Map2d.prototype.map=function(e,s){return e.map(function(e,n){return e.map(function(e,t){if(!this.isHiddenCorner(t,n))return s(e)},this)},this)},Map2d.prototype.getGround=function(e){return this.layers[Map2d.LAYER_GROUND][this.pointer.y+e.y]&&this.layers[Map2d.LAYER_GROUND][this.pointer.y+e.y][this.pointer.x+e.x]},Map2d.prototype.setValue=function(e,t,n){this.layers[e][this.pointer.y+t.y][this.pointer.x+t.x]=n,this.trigger("setValue",e,this.pointer.x+t.x,this.pointer.y+t.y)},Map2d.prototype.add=function(e,t
,n,s){this.layers[e][n][t]=s},Map2d.prototype.getFog=function(e,t){return this.layers[Map2d.LAYER_FOG][t]&&this.layers[Map2d.LAYER_FOG][t][e]},Map2d.prototype.remove=function(e,t,n){this.layers[e][n][t]=void 0},Map2d.prototype.isWater=function(e){return this.layers[Map2d.LAYER_WATER][this.pointer.y+e.y]&&this.layers[Map2d.LAYER_WATER][this.pointer.y+e.y][this.pointer.x+e.x]===Map2d.TILE_WATER},Map2d.prototype.isGround=function(e,t){return"object"==typeof e&&e.direction&&(t=this.pointer.y+e.y,e=this.pointer.x+e.x),this.layers[Map2d.LAYER_GROUND][t]&&-1!==[Map2d.TILE_GREEN_LEVEL_1,Map2d.TILE_GREEN_LEVEL_2].indexOf(this.layers[Map2d.LAYER_GROUND][t][e])},Map2d.prototype.getUnit=function(e,t){return this.layers[Map2d.LAYER_UNITS][t]&&this.layers[Map2d.LAYER_UNITS][t][e]},Map2d.prototype.getUnitWithHead=function(e,t){var n=this.getUnit(e,t);return n&&n.head?n.head:n},Map2d.prototype.bfs=function(e,t,n){var s=ISO_NEIGHBORS,i=[{x:e,y:t}],o={};o[e+t*this.getWidth()]=!0;for(var r=0;r<i.length;
)for(var a=i[r++],c=0;c<s.length;c++){var l=a.x+s[c].x,p=a.y+s[c].y;o[l+p*this.getWidth()]||this.isGround(l,p)&&!this.getFog(l,p)&&this.getUnit(l,p)&&this.getUnit(l,p).isMergeable(n)&&(o[l+p*this.getWidth()]=!0,i.push({x:l,y:p}))}return i},Map2d.prototype.setScreenRect=function(e){this.screenRect=e},Map2d.prototype.getScreenCenterCell=function(){if(this.screenRect)return cc.isoRectGetCenter(this.screenRect)},Map2d.prototype.getMapCenterCell=function(){return cc.p(Math.round(this.width/2),Math.round(this.height/2))},Map2d.prototype.listAvailableGrounds=function(){for(var n=[],e=function(e,t){this.isGround(e,t)&&!this.getFog(e,t)&&n.push(cc.p(e,t))}.bind(this),t=0;t<this.getHeight();t++)for(var s=0;s<this.getWidth();s++)e(s,t);return n},Map2d.prototype.listAvailableUnits=function(s){var i=[];s=cleverapps.toArray(s||{});return this.listAvailableGrounds().forEach(function(e){var t,n=this.getUnit(e.x,e.y);n&&((t=n)&&s.some(function(e){return!(
void 0!==e.code&&e.code!==t.code||void 0!==e.stage&&e.stage!==t.stage)}))&&i.push(n)},this),i},Map2d.prototype.listUnitsFromPointByCircle=function(e,t){var n=[{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],s=[],i=function(e,t){var n=this.getUnit(e,t);n&&this.isGround(e,t)&&!this.getFog(e,t)&&s.push(n)}.bind(this);i(e,t);for(var o=1;o<10;++o){t+=1;for(var r=0;r<4;++r)for(var a=0;a<o;++a)i(e,t),e+=n[r].x,t+=n[r].y}return s},Map2d.prototype.isEmpty=function(e,t){return this.isGround(e,t)&&!this.getUnit(e,t)&&!this.getFog(e,t)},Map2d.prototype.countEmptySlots=function(){for(var e=0,t=0;t<this.getHeight();t++)for(var n=0;n<this.getWidth();n++)this.isEmpty(n,t)&&e++;return e},Map2d.prototype.findEmptySlot=function(e,t,i,n,s){var o=ISO_NEIGHBORS,r=function(e,t){for(var n=0;n<o.length;n++){var s=this.getUnit(e+o[n].x,t+o[n].y);if(s&&i.isMergeable(s)&&!this.getFog(e+o[n].x,t+o[n].y))return!0}}.bind(this);i&&!i.getData().unmergeable||(r=function(){return!0}),cleverapps.Random.shuffle(o);for(var a,
c,l,p=!0,d=n&&void 0!==n.radius?n.radius:Map2d.RADIUS_FULL,u=0;u<100&&(p||!a)&&(u<=d||!a);u++){for(var h=!1,g=0;g<=u;g++)for(var v=0;v<2;v++){var m=g;if(0<v){if(0===g)continue;m=-g}for(var f=0;f<o.length;f++){var _=e+(0===o[f].x?m:o[f].x*u),y=t+(0===o[f].y?m:o[f].y*u),w=!1;p&&(w=this.isScreenCell(_,y),h=h||w);var b=r(_,y);if(!(s&&0<s.filter(function(e){return e.x===_&&e.y===y}).length)&&this.isEmpty(_,y)){var T=cc.p(_,y);if(a=a||T,w&&(c=c||T,b))return T;b&&(l=l||T)}}}p=h}return c||l||a},Map2d.prototype.isScreenCell=function(e,t){return cc.isoRectContainsPoint(this.screenRect,e,t)},Map2d.prototype.constructGrowth=function(e,t){if(void 0!==e)this.setPointer(e,t),this.getGround(Iso.SAME)===Map2d.TILE_GREEN_LEVEL_2&&(this.getGround(Iso.DOWN_LEFT)===Map2d.TILE_GREEN_LEVEL_1&&this.setValue(Map2d.LAYER_GROUND,Iso.DOWN_LEFT,Map2d.TILE_GROW),this.getGround(Iso.DOWN_RIGHT)===Map2d.TILE_GREEN_LEVEL_1&&this.setValue(Map2d.LAYER_GROUND,Iso.DOWN_RIGHT,Map2d.TILE_GROW),this.getGround(Iso.DOWN_BELOW
)===Map2d.TILE_GREEN_LEVEL_1&&this.setValue(Map2d.LAYER_GROUND,Iso.DOWN_BELOW,Map2d.TILE_GROW));else for(t=0;t<this.getHeight();t++)for(e=0;e<this.getWidth();e++)this.constructGrowth(e,t)},Map2d.prototype.getWidth=function(){return this.width},Map2d.prototype.getHeight=function(){return this.height},Map2d.prototype.setDragging=function(e){this.dragging=e,this.trigger("changeDragging",e)},Map2d.prototype.showMergeBonus=function(e){this.trigger("showMergeBonus",e)},Map2d.prototype.findPath=function(e,t){var s=[{x:e.x,y:e.y,vertical:!0}],i={};i[e.x+e.y*this.getWidth()]=!0;for(var n=0,o=function(e){for(var t=[];e;)t.push(cc.p(e.x,e.y)),e=e.prevStep;return t.reverse()};n<s.length;){var r=s[n++];if(cc.pointEqualToPoint(r,t))return o(r);(r.vertical?[Iso.DOWN_RIGHT,Iso.UP_LEFT,Iso.UP_RIGHT,Iso.DOWN_LEFT]:[Iso.UP_RIGHT,Iso.DOWN_LEFT,Iso.DOWN_RIGHT,Iso.UP_LEFT]).forEach(function(e){var t=r.x+e.x,n=r.y+e.y;this.isGround(t,n)&&!i[t+n*this.getWidth()]&&void 0===this.getUnit(t,n)&&(
i[t+n*this.getWidth()]=!0,s.push({x:t,y:n,vertical:0===e.x,prevStep:r}))}.bind(this))}},Object.keys(Iso).forEach(function(e){Iso[e].direction=!0}),Map2d.RADIUS_SMALL=3,Map2d.RADIUS_BIG=5,Map2d.RADIUS_FULL=9,Map2d.VISIBLE_BOX={width:.5,height:.5},Map2d.WATER_BORDER=10;var Map2dView=cc.Node.extend({ctor:function(r){this._super(),(this.map2d=r).onDiscoverView=function(){return this}.bind(this);var e=r.visibleBox,t=r.getWidth()+r.getHeight(),n=t*cleverapps.styles.Map2dView.cell.width/2,s=t*cleverapps.styles.Map2dView.cell.height/2;this.cutLeft=n*e.cutLeft,this.cutRight=n*e.cutRight,this.cutTop=s*(1-e.height)/2,this.setContentSize2(n-this.cutLeft-this.cutRight,s-2*this.cutTop),this.setAnchorPoint2();var o=this.layersViews=new Map2dLayersView(r);this.addChild(o),r.layers.forEach(function(e,i){e.forEach(function(e,s){e.forEach(function(e,t){r.setPointer(t,s);var n=o.getCell(i,t,s);this.createView(e,n,r)},this)},this)},this),r.decorators.createViews();var i=this.animations=new cc.Node;if(
i.setContentSize(this.getContentSize()),i.setPositionRound(this.width/2,this.height/2),i.setAnchorPoint2(),this.addChild(i,1),r.onAdd=function(e,t,n,s){this.createView(s,this.getCell(e,t,n),r)}.bind(this),r.onAnimationsAdd=function(e){this.createView(e,this.animations,r)}.bind(this),cleverapps.config.debugMode&&cleverapps.UI.onClick(this,function(e){var t=this.getCellByCoordinates(e);if(t){r.setPointer(t.x,t.y);var n=r.getFog(t.x,t.y);console.log(t,n?n.fogBlock.id:r.isWater(Iso.SAME)?"water":"ground"+r.getGround(Iso.SAME),r.getUnit(t.x,t.y))}}.bind(this),{swallowTouches:!1,ignoreOnTouchMoved:!0}),!cleverapps.environment.isSceneWithPreview()){var a,c,l,p,d,u,h=cleverapps.throttle(cleverapps.UI.DRAG_THROTTLE,function(e){p.onDragMove(e)}),g=function(e){var t=this.convertTouchToNodeSpace(e),n=this.getCellByCoordinates(t);if(n)for(var s=[{x:-1,y:1},{x:-1,y:0},{x:0,y:1},{x:0,y:0}],i=0;i<s.length;i++){var o=r.getUnitWithHead(n.x+s[i].x,n.y+s[i].y);if(o&&o.checkTouchInside(e))return o}}.bind(
this),v=!1;this.clickListener=cc.eventManager.addListener({event:cc.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:!1,onTouchBegan:function(e){if(v=!1,!this.isDisplayed())return!1;var t=g(e);if(!t){var n=this.convertTouchToNodeSpace(e),s=this.getCellByCoordinates(n);s&&(t=r.getFog(s.x,s.y))}return!!t&&(t.onTouchBeginEvent&&t.onTouchBeginEvent()?!(v=!0):(a=!1,c=t,l=e.getLocation(),!0))}.bind(this),onTouchMoved:function(e){var t=e.getLocation();!a&&Math.abs(t.x-l.x)+Math.abs(t.y-l.y)>cleverapps.styles.UI.onClick.ignoreOnTouchMovedThreshold&&(a=!0)},onTouchEnded:function(e){a||c.onClickEvent()}},this);var m,f,_=!1;this.dragListener=cc.eventManager.addListener({event:cc.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:!0,onTouchBegan:function(e){if(_=!1,v)return _=!(v=!1);if(u&&(p.onDragEnd(),u=void 0),!this.isDisplayed())return!1;var t=g(e);return!(!t||!t.isMoveable())&&(u=!1,p=t,d=e.getLocation(),m=e.getID(),f=e,!0)}.bind(this),onTouchMoved:function(e){if(!_&&e.getID()===m){
var t=e.getLocation();if(!u&&Math.abs(t.x-d.x)+Math.abs(t.y-d.y)>cleverapps.styles.UI.onClick.ignoreOnTouchMovedThreshold){if(!p.onDragStart())return;u=!0}u&&h({touch:e})}},onTouchEnded:function(e){_||e.getID()!==m||u&&(p.onDragMove({touch:e}),p.onDragEnd(),u=void 0)},setEnabled:function(e){this.isEnabled()&&!e&&u&&f&&this.onTouchEnded(f),cc.EventListener.prototype.setEnabled.call(this,e)}},this),r.on("stop",this.stop.bind(this),this),cleverapps.metha.registerControl("map2d",this.toggleControls.bind(this))}cleverapps.UI.onClick(this,function(){InfoView.CloseInfo()},{swallowTouches:!1,ignoreOnTouchMoved:!0}),this.setVisibleRect(cc.rectScale(cc.rect(0,0,this.width,this.height),2)),this.addChild=function(){throw"Map2d.addChild is blocked after creations - map has many cell children"},r.on("showMergeBonus",this.showMergeBonus.bind(this),this)},stop:function(){this.toggleControls(!1)},toggleControls:function(e){this.clickListener.setEnabled(e),this.dragListener.setEnabled(e)},
getStableLayers:function(){return[Map2d.LAYER_WATER,Map2d.LAYER_BORDERS,Map2d.LAYER_GROUND,Map2d.LAYER_UNITS,Map2d.LAYER_FOG]},showMergeBonus:function(e){var t=cleverapps.styles.Map2dView.mergeBonus,n=cc.getCenter(e.map(function(e){return this.getCell(Map2d.LAYER_UNITS,e.x,e.y)},this)),s=new cleverapps.Spine(bundles.merge.jsons.bonus_shining_json);s.setAnchorPoint2(),s.setPositionRound(n.x+t.x,n.y+t.y),s.setAnimation(0,"animation",!1),s.setCompleteListenerRemove(),this.animations.addChild(s)}});Map2dView.prototype.setVisibleRect=function(e){var t=this.screenRectToIso(e);cc.rectEqualToRect(t,this.map2d.screenRect)||(this.map2d.setScreenRect(t),this.layersViews.setVisibleIsoRect(t))},Map2dView.prototype.screenRectToIso=function(e){var t=this.getCellByCoordinates(e),n=Math.round(e.width/cleverapps.styles.Map2dView.cell.width),s=Math.round(e.height/cleverapps.styles.Map2dView.cell.height);return cc.rect(t.x,t.y,n,s)},Map2dView.prototype.getCellByCoordinates=function(e){
var t=this.alignInIsometricGrid(0,0),n=Map2dView.ScreenToIso(e.x-t.x,e.y-t.y);return cc.p(Math.round(n.x),Math.round(n.y))},Map2dView.ScreenToIso=function(e,t){var n=e/cleverapps.styles.Map2dView.cell.width,s=t/cleverapps.styles.Map2dView.cell.height;return{x:n+s,y:n-s}},Map2dView.IsoToScreen=function(e,t){var n=(e-t)/2;return{x:(e+t)/2*cleverapps.styles.Map2dView.cell.width,y:n*cleverapps.styles.Map2dView.cell.height}},Map2dView.prototype.getCell=function(e,t,n){return this.layersViews.getCell(e,t,n)},Map2dView.prototype.hasView=function(e,t,n){var s=this.map2d.layers[e][n]&&this.map2d.layers[e][n][t];return this.map2d.setPointer(t,n),s instanceof FogTile||s instanceof Highlight||s instanceof Unit&&!this.map2d.getFog(s.x,s.y)&&!s.isMultiCellBody()||ViewReader.hasView(s,this.map2d)||this.map2d.decorators.hasView(e,t,n)},Map2dView.prototype.createView=function(n,s,e){var t=[];n instanceof FogTile?t.push(new FogTileView(n)):n instanceof Highlight?t.push(new HighlightView(n)
):n instanceof Unit?e.getFog(n.x,n.y)||n.isMultiCellBody()||t.push(new UnitView(n)):t=ViewReader.parse(n,e),t.forEach(function(e){try{s.addChild(e)}catch(e){var t="object"!=typeof n?n:{x:n&&n.x,y:n&&n.y,type:n&&n.type,fogBlockId:n&&n.fogBlock&&n.fogBlock.id};throw new Error("Map2dView.createView - cell undefined for object - "+JSON.stringify(t)+" stack "+JSON.stringify(e.stack))}})},Map2dView.prototype.alignInIsometricGrid=function(e,t){var n=e+t+1,s=e-t+this.map2d.getHeight();return cc.p(n*cleverapps.styles.Map2dView.cell.width/2-this.cutLeft,s*cleverapps.styles.Map2dView.cell.height/2-this.cutTop)},cleverapps.overrideFonts(cleverapps.styles.FONTS,{MERGE_BONUS_TEXT:{size:45,color:cleverapps.styles.COLORS.COLOR_RED,stroke:{color:cleverapps.styles.COLORS.WHITE,size:2}}}),cleverapps.styles.Map2dView={cell:{width:174,height:100},mergeBonus:{x:0,y:30}};var Map2dCellView=cc.Node.extend({ctor:function(e,t,n){this._super(),this.map2d=e.map2d,this.mapView=e,this.cell=t,this.layerId=n,
this.setCascadeOpacityEnabled(!0);var s=e.alignInIsometricGrid(t.x,t.y);this.setPositionRound(s.x,s.y)},setVisible:function(e){this._visible!==e&&(cc.Node.prototype.setVisible.apply(this,arguments),this.parent.setVisibleDirty&&this.parent.setVisibleDirty())},_createRenderCmd:function(){return cc._renderType===cc.game.RENDER_TYPE_WEBGL?new Map2dCellView.WebGLRenderCmd(this):this._super()}});Map2dCellView.WebGLRenderCmd=function(e){this._rootCtor(e)},Map2dCellView.WebGLRenderCmd.prototype=Object.create(cc.Node.WebGLRenderCmd.prototype),Map2dCellView.WebGLRenderCmd.prototype.constructor=Map2dCellView.WebGLRenderCmd,Map2dCellView.WebGLRenderCmd.prototype.transform=function(e,t){if(this._transform||(this._transform={a:1,b:0,c:0,d:1,tx:this._node._position.x,ty:this._node._position.y},this._worldTransform={a:1,b:0,c:0,d:1,tx:0,ty:0}),e){var n=e._worldTransform,s=this._worldTransform;s.a=n.a,s.b=n.b,s.c=n.c,s.d=n.d,s.tx=this._transform.tx*n.a+n.tx,s.ty=this._transform.ty*n.d+n.ty}
this._cacheDirty=!0};var Map2dDecorator=function(e){cleverapps.extend(this,e)};Map2dDecorator.prototype.getLayerId=function(){var e=Game.currentGame.map;return void 0!==e.layers[Map2d.LAYER_GROUND][this.y][this.x]?Map2d.LAYER_GROUND:void 0!==e.layers[Map2d.LAYER_BORDERS][this.y][this.x]?Map2d.LAYER_BORDERS:Map2d.LAYER_WATER};var Map2dDecorators=function(e){this.decorators=[],(e||[]).forEach(function(e){bundles.map_decorators.frames[e.code]?this.decorators.push(new Map2dDecorator(e)):console.log("No frame for decorator '"+e.code+"' at x: "+e.x+", y: "+e.y)},this)};Map2dDecorators.prototype.createViews=function(){this.decorators.forEach(this.createView.bind(this))},Map2dDecorators.prototype.hasView=function(e,t,n){return this.occupied||(this.occupied={},this.decorators.forEach(function(e){this.occupied[e.getLayerId()+"_"+e.x+"_"+e.y]=!0},this)),this.occupied[e+"_"+t+"_"+n]},Map2dDecorators.prototype.createView=function(e){var t=Game.currentGame.map,n=t.getView();t.setPointer(e.x,e.y)
;var s=e.getLayerId(),i=n.getCell(s,e.x,e.y),o=new(this.getViewClass())(e);return o.setLocalZOrder(1),i.addChild(o),o},Map2dDecorators.prototype.getViewClass=function(){return Map2dDecoratorView};var Map2dDecoratorView=cc.Sprite.extend({ctor:function(e){var t=bundles.map_decorators.frames[e.code];this._super(t);var n=((this.decorator=e).dx||0)*resolutionScale,s=(e.dy||0)*resolutionScale;this.setPositionRound({x:{align:"center",dx:n},y:{align:"center",dy:s}}),this.setRotation(e.rotation||0)}});cc.isoRectGetCenter=function(e){return cc.p(Math.round(e.x+e.width/2+e.height/2),Math.round(e.y+e.width/2-e.height/2))},cc.isoRectContainsPoint=function(e,t,n){var s=t-e.x,i=n-e.y,o=(s+i)/2,r=(s-i)/2;return 0<=o&&o<=e.width&&0<=r&&r<=e.height},cc.isoRectMove=function(e,t,n,s,i){return t=t||0,n=n||0,cc.rect(e.x-n+t,e.y+n+t,e.width+(s||0),e.height+(i||0))},cc.isoRectGetLines=function(e){var t,n,s={};for(t=0;t<=e.height;t+=.5)n=e.x+Math.floor(t),s[e.y-Math.ceil(t)-n]={startX:n,endX:n+e.width}
;return s},cc.isoRectIterate=function(e,t,n){var s,i,o,r,a,c=cc.isoRectGetLines(e),l={};for(a in n&&n.skipRect&&(l=cc.isoRectGetLines(n.skipRect)),c){o=c[i=parseInt(a)],r=l[i];try{for(s=o.startX;s<=o.endX;)r&&r.startX<=s&&s<=r.endX?s=r.endX+1:(t(s,i+s),s++)}catch(e){throw new Error("Error cc.isoRectIterate code - "+a+" - lines - "+JSON.stringify(c)+" stack - "+JSON.stringify(e.stack))}}};var Map2dLayerView=cc.Node.extend({ctor:function(o,e){this.map2d=o,this.layerIds=cleverapps.toArray(e);var r=o.onDiscoverView();this._super(),this.setContentSize2(r.getContentSize()),this.setAnchorPoint2(),this.setPositionRound(r.width/2,r.height/2),this.cells={};var a=r.getStableLayers(),c=[];this.layerIds.forEach(function(i){this.cells[i]=o.layers[i].map(function(e,s){return e.map(function(e,t){if(r.hasView(i,t,s)||-1===a.indexOf(i)||i===Map2d.LAYER_UNITS&&o.isGround(t,s)){var n=new Map2dCellView(r,cc.p(t,s),i);return c.push(n),n}})})},this),c=c.sort(function(e,t){
return e.y!==t.y?t.y-e.y:e.x!==t.x?t.x-e.x:e.layerId-t.layerId});var t=this.tree=new Map2dCellTree({map2d:this.map2d,nodes:c,size:this.getContentSize()});t.setPositionRound(this.width/2,this.height/2),this.addChild(t),this.visibleRect=r.screenRectToIso(cc.rectScale(cc.rect(0,0,this.width,this.height),2))},getCell:function(e,t,n){return this.cells[e][n]&&this.cells[e][n][t]},setVisibleIsoRect:function(e){var t=function(s){var i;return function(e,t){for(i=0;i<this.layerIds.length;i++){var n=this.getCell(this.layerIds[i],e,t);n&&n.setVisible(s)}}.bind(this)}.bind(this),n=this.visibleRect;n&&cc.isoRectIterate(n,t(!1),{skipRect:e}),cc.isoRectIterate(e,t(!0),{skipRect:n}),this.tree.visitVisibleDirty(),this.visibleRect=e}}),Map2dLayersView=cc.Node.extend({ctor:function(s){var e=(this.map2d=s).onDiscoverView();this._super(),this.setContentSize2(e.getContentSize()),this.setAnchorPoint2(),this.setPositionRound(e.width/2,e.height/2),this.layersViews=Map2dLayersView.LAYERS.map(function(e,t){
var n=new Map2dLayerView(s,e);return this.addChild(n),n},this);var t=cc.eventManager.addCustomListener(cc.Director.EVENT_AFTER_UPDATE,this.afterUpdate.bind(this));this.registerCleanupCallback(function(){cc.eventManager.removeListener(t)})},getCell:function(e,t,n){var s=e;return Map2d.LAYER_FOG===e&&(s=Map2d.LAYER_UNITS),this.layersViews[s].getCell(e,t,n)},setVisibleIsoRect:function(e){e=cc.isoRectMove(e,-1,3,3,4),cc.rectEqualToRect(this.visibleRect,e)||(this.visibleRectDirty=e)},afterUpdate:function(){if(this.visibleRectDirty){var n=this.visibleRect=this.visibleRectDirty;delete this.visibleRectDirty,this.layersViews.forEach(function(e,t){e.setVisibleIsoRect(n)})}}});Map2dLayersView.LAYERS=[[Map2d.LAYER_WATER],[Map2d.LAYER_BORDERS],[Map2d.LAYER_GROUND],[Map2d.LAYER_UNITS,Map2d.LAYER_FOG]];var Map2dCellTree=cc.Node.extend({ctor:function(e){this.size=e.size;this.map2d=e.map2d,this._super(),this.setContentSize2(e.size),this.setAnchorPoint2();var t=this.nodes=e.nodes;if(
t.length<=Map2dCellTree.THRESHOLD)this.makeLeaves();else{var n=Math.round(t.length/2);[t.slice(0,n),t.slice(n)].forEach(function(e){var t=new Map2dCellTree({size:this.size,nodes:e,map2d:this.map2d});t.setPositionRound(this.width/2,this.height/2),this.addChild(t)},this)}},makeLeaves:function(){this.nodes.forEach(function(e){this.addChild(e)},this)},setVisibleDirty:function(){this.visibleDirty||(this.visibleDirty=!0,this.parent.setVisibleDirty&&this.parent.setVisibleDirty())},visitVisibleDirty:function(){if(this.visibleDirty){for(var e=this.visibleDirty=!1,t=0;t<this.children.length;t++){var n=this.children[t];n.visitVisibleDirty&&n.visitVisibleDirty(),e=e||n._visible}this.setVisible(e)}},_createRenderCmd:function(){return cc._renderType===cc.game.RENDER_TYPE_WEBGL?new Map2dCellTree.WebGLRenderCmd(this):this._super()}});Map2dCellTree.THRESHOLD=8,Map2dCellTree.WebGLRenderCmd=function(e){this._rootCtor(e)},Map2dCellTree.WebGLRenderCmd.prototype=Object.create(
cc.Node.WebGLRenderCmd.prototype),Map2dCellTree.WebGLRenderCmd.prototype.constructor=Map2dCellTree.WebGLRenderCmd,Map2dCellTree.WebGLRenderCmd.prototype.transform=function(e,t){this._transform||(this._transform={a:1,b:0,c:0,d:1,tx:0,ty:0},this._worldTransform={a:1,b:0,c:0,d:1,tx:0,ty:0}),e&&(this._worldTransform=e._worldTransform),this._cacheDirty=!0};var GitButtons=function(e){cleverapps.EventEmitter.call(this),this.status=GitButtons.NO_CHANGES,this.folder=e};GitButtons.prototype=Object.create(cleverapps.EventEmitter.prototype),(GitButtons.prototype.constructor=GitButtons).prototype.setStatus=function(e){this.status!==e&&(this.status=e,this.trigger("statusChanged",this.status))},GitButtons.prototype.revert=function(){this.status!==GitButtons.CAN_PUSH&&this.status!==GitButtons.PUSH_ERROR||this.checkStatus(function(){this.status!==GitButtons.CAN_PUSH&&this.status!==GitButtons.PUSH_ERROR||cleverapps.metha.display({focus:"GitInfoWindow",action:function(e){new GitInfoWindow({
status:this.gitStatus,action:"revert",callback:function(t){var e="Are you sure to revert all local changes?";void 0!==t&&(e="Are you sure to revert file: "+t+"?"),window.confirm(e)&&(this.setStatus(GitButtons.RUNNING_COMMAND),cleverapps.RestClient.post("/gitcommands/revert",{folder:this.folder,status:this.gitStatus,file:t},function(e){"ok"===e?(this.setStatus(GitButtons.NO_CHANGES),this.checkStatus(),cleverapps.administrator&&cleverapps.administrator.log.createEntry({type:AdminLog.GIT_REVERT,data:t||this.gitStatus})):(alert("Revert error: "+JSON.stringify(e)),this.setStatus(GitButtons.REVERT_ERROR))}.bind(this),function(){this.setStatus(GitButtons.REVERT_ERROR)}.bind(this),{timeout:3e4}))}.bind(this)}),cleverapps.metha.onceNoWindowsListener=e}.bind(this)})}.bind(this),!0)},GitButtons.prototype.push=function(){this.status!==GitButtons.NEED_PUSH&&this.status!==GitButtons.CAN_PUSH||this.checkStatus(function(){
this.status!==GitButtons.NEED_PUSH&&this.status!==GitButtons.CAN_PUSH||cleverapps.metha.display({focus:"GitInfoWindow",action:function(e){new GitInfoWindow({status:this.gitStatus,action:"push",callback:function(t){var e="";if("need push"!==this.gitStatus&&(e=window.prompt("Enter commit comment:","")),null!=e){var n="user: "+cleverapps.friends.getPlayer().name;""!==e&&(n=n+'\ncomment: "'+e+'"'),this.setStatus(GitButtons.RUNNING_COMMAND),cleverapps.RestClient.post("/gitcommands/push",{folder:this.folder,status:this.gitStatus,file:t,comment:n},function(e){"ok"===e?(this.setStatus(GitButtons.NO_CHANGES),this.checkStatus(),cleverapps.administrator&&cleverapps.administrator.log.createEntry({type:AdminLog.GIT_PUSH,data:t||this.gitStatus})):(alert("Push error: "+JSON.stringify(e)),this.setStatus(GitButtons.PUSH_ERROR))}.bind(this),function(){this.setStatus(GitButtons.PUSH_ERROR)}.bind(this),{timeout:3e4})}}.bind(this)}),cleverapps.metha.onceNoWindowsListener=e}.bind(this)})}.bind(this),!0)},
GitButtons.prototype.checkStatus=function(t,e){this.status!==GitButtons.RUNNING_COMMAND&&(e&&this.setStatus(GitButtons.RUNNING_COMMAND),t=t||function(){},cleverapps.RestClient.get("/gitcommands/status?folder="+this.folder,{},function(e){this.gitStatus=e,"need push"===this.gitStatus?this.setStatus(GitButtons.NEED_PUSH):0<this.gitStatus.newFiles.length||0<this.gitStatus.changedFiles.length?this.setStatus(GitButtons.CAN_PUSH):this.setStatus(GitButtons.NO_CHANGES),t()}.bind(this),function(){this.setStatus(GitButtons.STATUS_ERROR),t()}.bind(this)))},GitButtons.NO_CHANGES=0,GitButtons.CAN_PUSH=1,GitButtons.NEED_PUSH=2,GitButtons.RUNNING_COMMAND=3,GitButtons.PUSH_ERROR=4,GitButtons.REVERT_ERROR=5,GitButtons.STATUS_ERROR=6;var GitButtonsView=cc.Node.extend({ctor:function(e){this._super(),this.setAnchorPoint2(),this.gitButtons=e;var t=cleverapps.styles.GitButtonsView;this.pushButton=this.createButton(bundles.git.frames.push_icon,e.push.bind(e)),this.revertButton=this.createButton(
bundles.git.frames.revert_icon,e.revert.bind(e));var n=new cleverapps.Layout([this.pushButton,this.revertButton],{direction:cleverapps.UI.HORIZONTAL,margin:t.margin});this.addChild(n),this.setContentSize2(n.getContentSize()),n.setPositionRound(this.width/2,this.height/2),e.checkStatus(),e.on("statusChanged",this.drawStatus.bind(this),this),this.drawStatus(),this.setPositionRound(t.position),this.pushButton.setCascadeOpacityEnabled(!0),this.pushButton.setCascadeColorEnabled(!0),this.revertButton.setCascadeOpacityEnabled(!0),this.revertButton.setCascadeColorEnabled(!0)},createButton:function(e,t){var n=cleverapps.styles.GitButtonsView;return new cleverapps.UI.Button({button_png:bundles.git.frames.regular_button,button_on_png:bundles.git.frames.regular_button_on,button_off_png:bundles.git.frames.regular_button,content:new cc.Sprite(e),fitTo:!1,contentOffset:{y:0},width:n.button.width,height:n.button.height,onClicked:t})},setButtonState:function(e,t){switch(t){
case GitButtonsView.ENABLE_BUTTON:e.enable(),e.setColor(new cc.Color(255,255,255,255)),e.setOpacity(255);break;case GitButtonsView.DISABLE_BUTTON:e.disable(),e.setColor(new cc.Color(255,255,255,255)),e.setOpacity(100);break;case GitButtonsView.ERROR_BUTTON:e.disable(),e.setColor(new cc.Color(255,0,0,255)),e.setOpacity(255)}},drawStatus:function(){switch(this.pushButton.setVisible(!0),this.revertButton.setVisible(!0),this.loading&&(this.loading.removeFromParent(),this.loading=void 0),this.gitButtons.status){case GitButtons.NEED_PUSH:this.setButtonState(this.pushButton,GitButtonsView.ENABLE_BUTTON),this.setButtonState(this.revertButton,GitButtonsView.DISABLE_BUTTON);break;case GitButtons.CAN_PUSH:this.setButtonState(this.pushButton,GitButtonsView.ENABLE_BUTTON),this.setButtonState(this.revertButton,GitButtonsView.ENABLE_BUTTON);break;case GitButtons.NO_CHANGES:this.setButtonState(this.pushButton,GitButtonsView.DISABLE_BUTTON),this.setButtonState(this.revertButton,
GitButtonsView.DISABLE_BUTTON);break;case GitButtons.RUNNING_COMMAND:this.setButtonState(this.pushButton,GitButtonsView.DISABLE_BUTTON),this.setButtonState(this.revertButton,GitButtonsView.DISABLE_BUTTON),this.pushButton.setVisible(!1),this.revertButton.setVisible(!1),this.loading=new cc.Sprite(bundles.git.frames.loading),this.loading.runAction(new cc.RepeatForever(new cc.RotateBy(5,360))),this.loading.setPositionRound(this.width/2,this.height/2),this.addChild(this.loading);break;case GitButtons.PUSH_ERROR:this.setButtonState(this.pushButton,GitButtonsView.ERROR_BUTTON),this.setButtonState(this.revertButton,GitButtonsView.ENABLE_BUTTON);break;case GitButtons.STATUS_ERROR:case GitButtons.REVERT_ERROR:this.setButtonState(this.pushButton,GitButtonsView.ERROR_BUTTON),this.setButtonState(this.revertButton,GitButtonsView.ERROR_BUTTON)}}});GitButtonsView.ENABLE_BUTTON=0,GitButtonsView.DISABLE_BUTTON=1,GitButtonsView.ERROR_BUTTON=2,cleverapps.styles.GitButtonsView={button:{width:60,height:60},
margin:10,position:{x:{align:"left",dx:10},y:{align:"top",dy:-70}}};var GitInfoWindow=Window.extend({onWindowLoaded:function(e){this.options=e,this._super({noBackground:!0,closeButton:!1,noTitleBg:!0,name:"GitInfoWindow",title:{text:"push"===e.action?"Push local changes?":"Revert local changes?",font:cleverapps.styles.FONTS.GIT_INFO_TITLE_TEXT},content:this.getContent(),buttons:this.getButtons()})},getButtons:function(){var e=cleverapps.styles.GitInfoWindow.button;return[new cleverapps.UI.Button({button_png:bundles.git.frames.regular_button,button_on_png:bundles.git.frames.regular_button_on,font:cleverapps.styles.FONTS.GIT_INFO_BUTTON_TEXT,text:"push"===this.options.action?"push all":"revert all",width:e.width,height:e.height,onClicked:function(){this.options.callback(),this.close()}.bind(this)}),new cleverapps.UI.Button({button_png:bundles.git.frames.regular_button,button_on_png:bundles.git.frames.regular_button_on,font:cleverapps.styles.FONTS.GIT_INFO_BUTTON_TEXT,text:"cancel",
width:e.width,height:e.height,onClicked:this.close.bind(this)})]},generateFileLine:function(e){var t=cleverapps.styles.GitInfoWindow,n=cleverapps.UI.generateTTFText(e,cleverapps.styles.FONTS.GIT_INFO_TEXT),s=new cleverapps.UI.Button({button_png:bundles.git.frames.regular_button,button_on_png:bundles.git.frames.regular_button_on,text:"push"===this.options.action?"push":"revert",font:cleverapps.styles.FONTS.GIT_INFO_BUTTON_TEXT,onClicked:function(){this.options.callback(e),this.close()}.bind(this),width:t.lineButton.width,height:t.lineButton.height}),i=t.scroll.width-s.width-t.lineMargin;return n.fitTo(i),new cleverapps.Layout([n,s],{direction:cleverapps.UI.HORIZONTAL,margin:t.scroll.width-n.width-s.width})},getContent:function(){var e,t=cleverapps.styles.GitInfoWindow,n=[];if("need push"===this.options.status){var s=cleverapps.UI.generateTTFText("Push already commited changes!",cleverapps.styles.FONTS.GIT_INFO_TEXT);s.setDimensions(t.scroll.width,0),s.setHorizontalAlignment(
cc.TEXT_ALIGNMENT_CENTER),n.push(s)}else{if(0<this.options.status.newFiles.length)for(n.push(cleverapps.UI.generateTTFText("New files:",cleverapps.styles.FONTS.GIT_INFO_TEXT)),e=0;e<this.options.status.newFiles.length;e++)n.push(this.generateFileLine(this.options.status.newFiles[e]));if(0<this.options.status.changedFiles.length)for(n.push(cleverapps.UI.generateTTFText("Changed files:",cleverapps.styles.FONTS.GIT_INFO_TEXT)),e=0;e<this.options.status.changedFiles.length;e++)n.push(this.generateFileLine(this.options.status.changedFiles[e]))}var i=new cleverapps.Layout(n.reverse(),{direction:cleverapps.UI.VERTICAL,margin:t.margin}),o=t.scroll.height;i.height<o&&(o=i.height);var r=cleverapps.UI.createScale9Sprite(bundles.git.frames.scroll_bg,cleverapps.UI.Scale9Rect.TwoPixelXY);r.setContentSize2(t.scroll.width+2*t.scroll.bgPadding,o+2*t.scroll.bgPadding);var a=new cleverapps.UI.ScrollView(i);a.setContentSize2(t.scroll.width,o),a.setPositionRound(r.width/2,r.height/2),r.addChild(a)
;var c=cleverapps.UI.createScale9Sprite(bundles.git.frames.scroll_content_bg);c.setContentSize2(t.width,r.height+2*t.padding),r.setPositionRound(c.width/2,c.height/2),c.addChild(r);var l=new cleverapps.UI.Button({button_png:bundles.git.frames.delete_button,button_on_png:bundles.git.frames.delete_button,onClicked:this.close.bind(this)});return l.setPositionRound(t.closeButton),c.addChild(l),c}});GitInfoWindow.prototype.editorWindow=!0,cleverapps.styles.COLORS=cleverapps.overrideColors(cleverapps.styles.COLORS,{GIT_TEXT_COLOR:new cc.Color(89,144,221,255)}),cleverapps.overrideFonts(cleverapps.styles.FONTS,{GIT_INFO_BUTTON_TEXT:{size:30,color:cleverapps.styles.COLORS.WHITE},GIT_INFO_TEXT:{size:25,color:cleverapps.styles.COLORS.GIT_TEXT_COLOR},GIT_INFO_TITLE_TEXT:{size:35,color:cleverapps.styles.COLORS.GIT_TEXT_COLOR}}),cleverapps.styles.GitInfoWindow={button:{width:150,height:70},scroll:{width:450,height:500,bgPadding:10},closeButton:{x:{align:"right",dx:20},y:{align:"top",dy:20}},
width:600,padding:150,margin:20,lineMargin:20,lineButton:{width:100,height:44}};var UseGoldButton=cleverapps.UI.Button.extend({ctor:function(e,t){this.price=e.price,this.filterHandler=e.filter||function(){return!0},this.clickHandler=e.onClicked,this.eventName=e.eventName,this._super({styles:t,content:this.createContent(e,t),onClicked:this.onClick.bind(this),button_images:e.button_images||cleverapps.UI.Button.Images.button_blue})},createContent:function(e,t){var n=[];if(this.price){var s=new cc.Sprite(e.image||bundles.reward_icons.frames.reward_gold_png),i=cleverapps.UI.generateImageText(this.price,e.font||cleverapps.styles.FONTS.BUTTON_TEXT);n.push(s),n.push(i)}else i=cleverapps.UI.generateOnlyText("messages:UseGoldButton.free",e.font||cleverapps.styles.FONTS.BUTTON_TEXT),n.push(i);return new cleverapps.Layout(n,{direction:cleverapps.UI.HORIZONTAL,margin:t.margin})},onClick:function(){this.filterHandler()&&cleverapps.user.takeGold(this.price)&&(cleverapps.toArray(this.eventName||[]
).forEach(function(e){cleverapps.eventLogger.logEvent(e,{amount:this.price})},this),this.clickHandler())}});cleverapps.ServerFlags=function(){var e=cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.SERVER_FLAGS);this.flags=e||[]},cleverapps.ServerFlags.prototype.reset=function(){this.flags=[],this.save()},cleverapps.ServerFlags.prototype.hasFlag=function(e){return 0<=this.flags.indexOf(e)},cleverapps.ServerFlags.prototype.setFlag=function(e){this.hasFlag(e)||(this.flags.push(e),this.save())},cleverapps.ServerFlags.prototype.getInfo=function(){return this.flags},cleverapps.ServerFlags.prototype.updateInfo=function(e,t){this.flags=e,this.save(t)},cleverapps.ServerFlags.prototype.save=function(e){cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.SERVER_FLAGS,this.flags),e||cleverapps.synchronizer.addUpdateTask("serverflags")},cleverapps.ServerFlags.PAGE_LIKED=2,cleverapps.ServerFlags.PAYER=3;var levels={reset:function(){levels.episodes.reset(),levels.episodes.setCurrentEpisode(
levels.user.episode),levels.tutorial&&levels.tutorial.stop(),cleverapps.social.isLoggedIn()?cleverapps.SocialManager.onLogin():cleverapps.synchronizer.syncWhenReady()},initUser:function(){var e=!1===cleverapps.DataLoader.haveSavedData();return e&&(console.log("Creating new user"),cleverapps.synchronizer.reset()),cleverapps.user=levels.user=new levels.User(e),e},initialize:function(){cleverapps.rewardedAdsManager.init(),cleverapps.LocalizationManager.run(),cleverapps.localPushes.init(),levels.progress.init(),cleverapps.isLevels()&&levels.episodes.setCurrentEpisode(cleverapps.user.episode),UIScrollBarFix(),cleverapps.eventLogger.logEvent(cleverapps.EVENTS.APP_INITIALIZE),cleverapps.Shaders.initialize(),cleverapps.wideMode.refresh(),cleverapps.config.debugMode&&(-1===["spades","mergeriddles","mergeheroes"].indexOf(cleverapps.config.name)&&(cleverapps.administrator=new Administrator,cleverapps.administrator.run()),cleverapps.taskManager=new TaskManager),cleverapps.flags.update(),
cleverapps.placements=new Placements,cc.renderer.assignedZStep=1e-5},User:function(e){this.onLevelStatusChanged=function(e,t){},cleverapps.User.call(this,e)}};levels.User.prototype=Object.create(cleverapps.User.prototype),levels.User.prototype.constructor=levels.User,levels.User.prototype.getProgress=function(){return cleverapps.humanReadableNumber(this.episode,this.level)-1},levels.User.prototype.loadData=function(e){cleverapps.User.prototype.loadData.call(this,e),this.episode=e.episode,this.level=e.level,this.league=this.calcLeague(),this.progress=e.progress||0,e.uniqueStartEvent&&(this.uniqueStartEvent=e.uniqueStartEvent),this.calcRating(),this.calcExp()},levels.User.prototype.calcRating=function(){var e=this.calcLeague();this.league!==e&&(this.league=e,this.onLeagueChangeListener()),this.save()},levels.User.prototype.calcExp=function(){void 0===this.exp&&this.setExp(this.getProgress())},levels.User.prototype.isUniqueStart=function(e,t,n){var s=e+"_"+t+"_"+n
;return this.uniqueStartEvent!==s&&(this.uniqueStartEvent=s,this.save(!1),!0)},levels.User.prototype.getPassAllProgress=function(){return this.progress},levels.User.prototype.isCurrentLevel=function(e,t){if(cleverapps.metha.getType()!==Metha.HOSE)return!0;var n=this.getCurrentLevel();return n.levelNo===e&&n.episodeNo===t},levels.User.prototype.isPassedLevel=function(e,t){return this.episode>t||this.episode===t&&this.level>e},levels.User.prototype.getHumanReadableNumber=function(){return cleverapps.humanReadableNumber(this.episode,this.level)},levels.User.prototype.checkAvailable=function(e,t){e=e||{},t=t||[];var n=cc.game.config.projectName;if(e[n])return this.checkAvailable(e[n],t);if(cleverapps.config.subtype&&e[cleverapps.config.subtype])return this.checkAvailable(e[cleverapps.config.subtype],t);var s=cleverapps.User.calcSource();if(e[s])return this.checkAvailable(e[s],t);if(!cleverapps.config.debugMode&&e.registered&&this.registered+cleverapps.parseInterval(e.registered)>Date.now()
)return!1;if(cleverapps.flags.nosocial&&e.social)return!1;if(e.disabled)return!1;if(e.debugMode&&!cleverapps.config.debugMode)return!1;if(e.level=e.level||0,e.episode=e.episode||0,e.projectName&&(Array.isArray(e.projectName)||(e.projectName=[e.projectName]),-1===e.projectName.indexOf(n)))return!1;if(e.source&&(Array.isArray(e.source)||(e.source=[e.source]),-1===e.source.indexOf(s)))return!1;if(e.language&&cleverapps.settings.language!==e.language)return!1;if(e.payments&&cleverapps.flags.nopayments)return!1;if(t.ignoreProgress)return!0;var i=this.episode,o=this.level;return t.future&&("merge"===cleverapps.config.type?o++:i++),i>e.episode||o>=e.level&&i===e.episode},levels.User.prototype.sendLevelPassedEvents=function(){var e=[1,3,5],n=this.getDaysSinceRegistration(),s=this.getHumanReadableNumber();[50,100,200].forEach(function(t){t+1===s&&e.forEach(function(e){n<e&&cleverapps.eventLogger.logEvent(cleverapps.EVENTS.LEVEL_PASS_EVENT+"_"+t+"_"+e)},this)},this)},
levels.User.prototype.isPassedAll=function(){return this.episode>=levels.episodes.getAmountEpisodes()},levels.User.prototype.incLevel=function(){if(this.isPassedAll())return this.progress++,this.trigger("incLevel"),void this.save();var e=this.level,t=this.episode;levels.episodes.currentLevel=void 0,this.level++,this.level===Episode.LEVELS_PER_EPISODE&&(this.level=0,this.incEpisode()),this.trigger("incLevel"),this.calcRating(),this.save(),this.sendLevelPassedEvents(),this.onLevelStatusChanged(t,e),this.onLevelStatusChanged(this.episode,this.level),cleverapps.eventLogger.logEvent(cleverapps.EVENTS.ACHIEVED_LEVEL),cleverapps.User.reportRetention&&cleverapps.User.reportRetention()},levels.User.prototype.incEpisode=function(){this.episode++,this.calcRating(),this.save(),cleverapps.eventLogger.logEvent(cleverapps.EVENTS.LEVEL_UP),cleverapps.dailyTasks.addProgress(cleverapps.DailyTask.FINISH_EPISODE)},levels.User.prototype.getPhysicalLevel=function(){return this.getHumanReadableNumber()},
levels.User.prototype.getCurrentLevel=function(){return this.isPassedAll()?Episode.LevelChooseAlgorithm({start:5,seed:this.progress}):{episodeNo:this.episode,levelNo:this.level}},levels.User.prototype.getVirtualLevel=function(){return this.getHumanReadableNumber()+this.progress},levels.User.prototype.getVirtualDisplayLevel=function(){var e=this.getVirtualLevel(),t=cleverapps.metha.getMainObject();return t.takenLevelsAmount&&(e-=t.takenLevelsAmount()),e},levels.User.prototype.setId=function(e){this.reportChannel&&this.reportChannel(),this.id=e,delete this.idfa,this.save(!1)},levels.User.prototype.getSaveInfo=function(){var e=cleverapps.User.prototype.getSaveInfo.call(this);return cleverapps.extend(e,{episode:this.episode,level:this.level,uniqueStartEvent:this.uniqueStartEvent,progress:this.progress})},levels.User.prototype.initializeNewPlayer=function(){cleverapps.User.prototype.initializeNewPlayer.call(this),this.episode=0,this.level=0,this.progress=0},
levels.User.GOLD_FB_CONNECT_REWARD=100;var VersionChecker=function(){this.serverVersion=cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.SERVER_VERSION,{raw:!0}),this.clientVersion=void 0};VersionChecker.prototype.check=function(){cleverapps.RestClient.get("/",{},function(e){this.serverVersion=e,cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.SERVER_VERSION,e,{raw:!0})}.bind(this),function(){console.log("Error getting server version in VersionChecker!")}.bind(this))},VersionChecker.prototype.needUpdate=function(){return!!this.serverVersion&&parseInt(cleverapps.config.version)<parseInt(this.serverVersion)},VersionChecker.prototype.isNewClientVersionAvailable=function(){return this.clientVersion&&this.clientVersion!==cleverapps.config.version},VersionChecker.prototype.isClientVersionActual=function(){return this.clientVersion&&this.clientVersion===cleverapps.config.version},VersionChecker.prototype.loadClientVersion=function(t){if(t=t||function(){},
cc.sys.isNative||cleverapps.isLocalhost()||-1!==["instant","plinga","huzcom"].indexOf(cleverapps.User.calcSource()))return this.clientVersion=cleverapps.config.version,void t();var e=cleverapps.config.deployment+window.location.pathname,n=e.lastIndexOf("/");e=e.substr(0,n+1)+"version.json";var s=function(e){console.log("loaded current client version - "+e.version),this.clientVersion=e.version,t()}.bind(this);cleverapps.RestClient.get(e,{},s,function(){console.log("error loading client version from path - "+e),t()})},levels.FPS={run:function(e,t){levels.FPS.fpsInterval||(levels.FPS.episode=e,levels.FPS.level=t,levels.FPS.fpsStatistics=[],levels.FPS.fpsTotalFrames=cc.director.getTotalFrames(),levels.FPS.fpsInterval=setInterval(function(){if(levels.FPS.fpsStatistics.length<levels.FPS.FPS_STATISTICS_MAX_LENGTH){var e=cc.director.getTotalFrames(),t=Math.round(1e3*(e-levels.FPS.fpsTotalFrames)/levels.FPS.FPS_STATISTICS_INTERVAL);60<t&&(t=60),levels.FPS.fpsStatistics.push(t),
levels.FPS.fpsTotalFrames=e}else levels.FPS.stop()},levels.FPS.FPS_STATISTICS_INTERVAL))},stop:function(){if(levels.FPS.fpsInterval&&(clearInterval(levels.FPS.fpsInterval),levels.FPS.fpsInterval=!1),levels.FPS.fpsStatistics&&levels.FPS.fpsStatistics.length){levels.FPS.fpsStatistics.sort();var e=levels.FPS.fpsStatistics[Math.floor(levels.FPS.fpsStatistics.length*levels.FPS.FPS_STATISTICS_PERCENT_VALUE)];console.log("SAVE FPS: "+e),cc.sys.os!==cc.sys.OS_IOS&&void 0===cleverapps.settings.fpsMode&&(e<=levels.FPS.FPS_SWITCH_TO_LOW?(console.log("Auto switch to low fps mode!"),cleverapps.settings.setFpsMode(cleverapps.Settings.FPS_MODE_LOW)):(console.log("Auto switch to high fps mode!"),cleverapps.settings.setFpsMode(cleverapps.Settings.FPS_MODE_HIGH))),cleverapps.eventLogger.logEvent(cleverapps.EVENTS.LEVEL_FPS,{episode:levels.FPS.episode,level:levels.FPS.level,fps:e}),levels.FPS.fpsStatistics=!1}}},levels.FPS.FPS_STATISTICS_MAX_LENGTH=15,levels.FPS.FPS_STATISTICS_PERCENT_VALUE=.1,
levels.FPS.FPS_STATISTICS_INTERVAL=500,levels.FPS.FPS_SWITCH_TO_LOW=40;var NewVersionWindow=Window.extend({onWindowLoaded:function(){var e=cleverapps.styles.NewVersionWindow,t=cleverapps.UI.generateTTFText("messages:NewVersionWindow.text1",cleverapps.styles.FONTS.NEW_VERSION_WINDOW_TEXT||cleverapps.styles.FONTS.WINDOW_TEXT,{version:cleverapps.versionChecker.serverVersion,title:Messages.get(cleverapps.config.title)});t.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER),t.setDimensions(e.dimensions),t.setAnchorPoint2();var n=cleverapps.UI.generateTTFText("messages:NewVersionWindow.text2",cleverapps.styles.FONTS.NEW_VERSION_WINDOW_TEXT||cleverapps.styles.FONTS.WINDOW_TEXT);n.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER),n.setDimensions(e.dimensions),n.setAnchorPoint2();var s=new cleverapps.Layout([n,t],{direction:cleverapps.UI.VERTICAL,padding:e.padding,margin:e.margin});s.setAnchorPoint2(),this._super({title:"messages:NewVersionWindow.Title",name:"newversionwindow",content:s,button:{
text:Messages.get("OK"),width:cleverapps.styles.NewVersionWindow.button.width,height:cleverapps.styles.NewVersionWindow.button.height,onPressed:function(){var e=cleverapps.config[levels.user.source]||cleverapps.config.facebook;cc.sys.openURL(e.url)},width:s.width/2},closeButton:!1})},close:function(){}});cleverapps.styles.NewVersionWindow={dimensions:{width:550,height:0},padding:{x:0,y:50},button:{},margin:40},"horizontal"===cleverapps.config.orientation&&cleverapps.increaseStylesByKoef(cleverapps.styles.RestartWindow,1.4);var WaitWindow=Window.extend({onWindowLoaded:function(){var e=this.showLoading();e.setCascadeOpacityEnabled(!0),e.setOpacity(0),e.setVisible(!1);var t=cleverapps.styles.WaitWindow;this._super({name:"waitwindow",noBackground:!0,content:e,closeButton:!1,styles:t,notCloseByTouchInShadow:!0}),e.runAction(new cc.Sequence(new cc.DelayTime(t.delay),new cc.CallFunc(function(){e.setVisible(!0)}),new cc.FadeTo(.3,255)))},showLoading:function(){var e=new cc.Node;if(
cleverapps.styles.WaitWindow.text){var t=cleverapps.UI.generateOnlyText(Messages.get("Loading")||"Loading",cleverapps.styles.FONTS.WAIT_WINDOW_TEXT);t.setPositionRound(cleverapps.styles.WaitWindow.text),e.addChild(t,1)}var n=new cleverapps.Spine(bundles.main.jsons.wait_json);return e.addChild(n),n.setAnimation(0,"idle",!0),e},closeByBackButton:function(){},popUpAnimation:function(){},closeAnimation:function(e){e()}});cleverapps.overrideFonts(cleverapps.styles.FONTS,{WAIT_WINDOW_TEXT:{size:25,color:cleverapps.styles.COLORS.WHITE,stroke:cleverapps.styles.DECORATORS.WINDOW_WHITE_TEXT_STROKE,shadow:cleverapps.styles.DECORATORS.WHITE_TEXT_SHADOW}}),cleverapps.styles.WaitWindow=cleverapps.overrideStyles(cleverapps.styles.Window,{delay:.2,text:{x:0,y:0}},!0);var StartEpisodeWindow=Window.extend({onWindowLoaded:function(e){this.episode=e,this._super({title:"messages:StartEpisodeWindow.Title"+levels.episodes.currentEpisode,name:"startepisodewindow",content:this.getContent(),closeButton:!1,
button:{width:cleverapps.styles.StartEpisodeWindow.button.width,height:cleverapps.styles.StartEpisodeWindow.button.height,text:Messages.get("OK"),onPressed:this.close.bind(this)}}),cleverapps.audio.playSound(bundles.main.urls.window_effect)},getContent:function(){var e=cleverapps.styles.StartEpisodeWindow,t=new cleverapps.Spine(bundles.main.jsons.yellow_hi_spine_json);t.setAnimation(0,"animation",!0);var n=new cc.Node;n.setAnchorPoint2(),n.setContentSize2(e.animation),n.addChild(t),t.setPositionRound(n.width/2,n.height/2);var s=cleverapps.UI.generateTTFText("messages:StartEpisodeWindow.Text"+this.episode.episodeNo,cleverapps.styles.FONTS.WINDOW_TEXT);s.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER);var i,o,r,a=[n,s];return cleverapps.wideMode.mode===cleverapps.WideMode.VERTICAL?(r=e.phoneMargin,i=cleverapps.UI.VERTICAL,o=e.text.phoneWidth,a.reverse()):(r=e.margin,i=cleverapps.UI.HORIZONTAL,o=e.text.width),s.setDimensions(o,0),new cleverapps.Layout(a,{direction:i,margin:r,
padding:e.padding})}});cleverapps.styles.StartEpisodeWindow={animation:{width:300,height:300},phoneMargin:20,margin:40,text:{phoneWidth:600,width:400},padding:{x:0,y:40},button:{width:250,height:100}};var StuckPlayerView=cc.Node.extend({ctor:function(e){this._super();var t=cleverapps.styles.StuckPlayerView,n=new cleverapps.UI.Avatar(e);this.addChild(n);var s=cleverapps.humanReadableNumber(e.episode,e.level),i=cleverapps.UI.generateTTFText("messages:StuckWindow.player.text",cleverapps.styles.FONTS.WINDOW_SMALL_TEXT,{level:s});i.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER),i.setDimensions(t.text.width,0),i.y=t.text.y,this.addChild(i),cleverapps.UI.wrap(this)}});cleverapps.styles.StuckPlayerView={text:{width:195,y:-120}};var StuckWindow=Window.extend({onWindowLoaded:function(e){var t,n=cleverapps.styles.StuckWindow;bundles.stuck_window.jsons.send_help_spine_json&&(t=new cleverapps.Spine(bundles.stuck_window.jsons.send_help_spine_json)).setAnimation(0,"animation",!0);var s=new cc.Node
;e.forEach(function(e){s.addChild(new StuckPlayerView(e))}),cleverapps.UI.arrangeWithMargins(s.children,{direction:cleverapps.UI.HORIZONTAL,margin:n.players.margin}),cleverapps.UI.wrap(s),s.setAnchorPoint2();var i=cleverapps.UI.generateTTFText("messages:StuckWindow.text",cleverapps.styles.FONTS.WINDOW_TEXT);i.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER),i.setDimensions(n.text.width,0);var o=new cc.Node;o.addChild(s),o.addChild(i),t&&o.addChild(t),cleverapps.UI.arrangeWithMargins(o.children,{margin:n.margin}),cleverapps.UI.wrap(o),o.setAnchorPoint2(),o=cleverapps.UI.wrapWithPadding(o,n.padding),this._super({title:"messages:StuckWindow.title",name:"stuckwindow",minWidth:n.minWidth,content:o,button:{width:n.button.width,height:n.button.height,content:cleverapps.UI.generateTTFText("messages:StuckWindow.button.text",cleverapps.styles.FONTS.BUTTON_TEXT),onPressed:function(){levels.progress.sendStuckFriendsHelp(e,function(){this.closed||this.close()}.bind(this))}.bind(this)}}),
cleverapps.audio.playSound(bundles.main.urls.window_effect)},listBundles:function(){return["stuck_window"]},load:function(e,t,n){e=cleverapps.wait(2,e),this._super(e,t,n),cleverapps.UI.Avatar.preload(n,cleverapps.waitNoMore(5e3,e))}});StuckWindow.displayIfNeeded=function(){var t=levels.progress.getStuckFriends();0<t.length&&!cleverapps.flags.noviral&&cleverapps.metha.display({focus:"StuckWindow",action:function(e){new StuckWindow(t),cleverapps.metha.onceNoWindowsListener=e}})},cleverapps.styles.StuckWindow={minWidth:600,margin:50,padding:{x:0,y:60},players:{margin:60},text:{width:650},button:{width:380,height:110}};var FinishEpisodeWindow=Window.extend({onWindowLoaded:function(e){var t=cleverapps.overrideStyles(cleverapps.clone(cleverapps.styles.Window,!0),cleverapps.styles.FinishEpisodeWindow);this.episode=e.episode;var n=this.content=new cc.Node,s="messages:FinishEpisodeWindow.Text"+this.episode.episodeNo;Messages.has(s)||(s="messages:FinishEpisodeWindow.Text")
;var i=this.text=cleverapps.UI.generateTTFText(s,cleverapps.styles.FinishEpisodeWindow.font);if(i.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER),i.setDimensions(t.width,0),n.addChild(i),t.animation){var o=new cleverapps.Spine(t.animation.json);o.setAnimation(0,"animation",!0),n.setLocalZOrder(10),n.addChild(o)}else if(t.image){var r=this.findProperBundle(this.episode),a=new cc.Sprite(bundles[r].urls.episode_finish_image);n.addChild(a),a.setPosition(n.width/2,t.image.y)}if(cleverapps.UI.arrangeWithMargins(n.children,{margin:t.margin,x:t.width/2,y:t.padding.y}),t.text.bg){var c=new cc.Scale9Sprite(t.text.bg.image);c.setContentSize2(i.width+2*t.text.bg.padding.x,i.height+2*t.text.bg.padding.y),this.content.addChild(c),c.setPositionRound(i.getPosition()),c.setLocalZOrder(i.getLocalZOrder()-1)}cleverapps.UI.wrap(n),n.setAnchorPoint2(),this._super({title:"messages:FinishEpisodeWindow.Title",name:"finishepisodewindow",content:n,closeButton:!0,noBackground:t.noBackground,button:{
width:t.Button.width,height:t.Button.height,text:Messages.get("OK"),onPressed:this.close.bind(this),bottomPadding:t.BottomButton.bottomPadding},buttons:this.getButtons(),shareCheckBox:this.getShareOptions(),styles:t})},onShow:function(){this.runAction(new cc.Sequence(new cc.DelayTime(.1),new cc.CallFunc(function(){this.visible&&cleverapps.audio.playSound(bundles.main.urls.congratulate_sfx||bundles.game.urls.win_effect)}.bind(this))))},getButtons:function(){var e=[],t=ShareBonusButton.create(this.getShareOptions());return t&&e.push(t),e},getShareOptions:function(){return{shareBonus:cleverapps.ShareBonus.SHARES.finishEpisode,shareId:cleverapps.ShareBonus.SHARES.finishEpisode.id,toReplace:{episodeTitle:this.episode.getBundle().title||this.episode.episodeNo+1}}},findProperBundle:function(e){if(!cleverapps.styles.FinishEpisodeWindow.animation){for(var t=[],n=0;n<10;n++){var s="finish_episode_"+n,i=s+"_"+cleverapps.settings.language;if(bundles[i])t.push(i);else{if(!bundles[s])break;t.push(s)
}}return t[e.episodeNo%t.length]}},listBundles:function(e){var t=["finish_episode_window"],n=this.findProperBundle(e.episode);return n&&t.push(n),t}});cleverapps.styles.FinishEpisodeWindow={width:600,height:740,text:{y:165,Dimensions:{y:300}},margin:80,padding:{y:50},image:{y:500,width:700},Button:{width:280,height:110},font:cleverapps.styles.FONTS.WINDOW_TEXT};var HelpFromFriendsWindow=Window.extend({onWindowLoaded:function(e,t){var n=this.styles=cleverapps.styles.HelpFromFriendsWindow;n[e.type]&&(n=cleverapps.overrideStyles(cleverapps.clone(n,!0),n[e.type]));var s=n.height,i=n.width,o=new cc.Node;o.setAnchorPoint(.5,.5);var r=new cc.Node;e.buy?r.setContentSize2(n.container.buy):r.setContentSize2(n.container);var a=new cleverapps.Spine(bundles.help_from_friends.jsons.help_from_friends_json);a.setSkin(cc.game.config.projectName),a.setAnimation(0,e.type,!0),r.addChild(a),e.buy?a.setPositionRound(n.animation.buy):a.setPositionRound(n.animation),o.addChild(r),o.setContentSize2(i,s)
;var c=cleverapps.UI.generateTTFText("messages:helpFromFriends."+e.type+".text",n.text.font,{amount:e.amount});c.setDimensions(i,0),c.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER),c.setVerticalAlignment(cc.VERTICAL_TEXT_ALIGNMENT_CENTER),o.addChild(c);var l=cleverapps.UI.arrangeWithMargins([c,r],{direction:cleverapps.UI.VERTICAL,margin:n.margin.y,x:n.width/2,y:n.margin.bottom});o.setContentSize2(n.width,l+n.margin.top);var p,d=e.amount,u=function(){cleverapps.audio.playSound(bundles.main.urls.shop_buy_effect),this.closeAnimationCallbacks.push(function(){t(p,e)}),this.close(),e.event&&cleverapps.eventLogger.logEvent(e.event)}.bind(this);if(e.buy){var h=n.animation.buy.person,g=new cleverapps.Spine(h.json,h.scale);g.setAnimation(0,h.animation,!0),r.addChild(g),g.setPositionRound(h),p=new cleverapps.UI.Button({width:n.button.buy.width,height:n.button.buy.height,content:this.getBuyButtonContent(e.price),onClicked:function(){levels.user.takeGold(e.price)&&u()}})}else p=new BonusButton({
styles:n.button,reward:d,rewardIcon:e.icon,text:"messages:helpFromFriends."+e.type+".Button.text",onClick:function(){if(e.request)cleverapps.social.inviteRandomFriends(u,"helpInviteFriends");else if(e.video){if(!cleverapps.rewardedAdsManager.isAvailable())return void cleverapps.Notification.create("messages:AdsUnavailable");cleverapps.rewardedAdsManager.play(RewardedAdsManager.REWARDED,this.createListener(u))}}.bind(this)});this._super({title:"messages:helpFromFriends."+e.type+".title",name:"helpfromfriendswindow",content:o}),p.setPositionRound(this.window.width/2,p.height/2+n.button.Margin.y),this.window.addChild(p);var v=bundles.help_from_friends.urls["window_effect_"+e.type]||bundles.main.urls.window_effect;cleverapps.audio.playSound(v)},getBuyButtonContent:function(e){var t=cleverapps.styles.HelpFromFriendsWindow.button.buy,n=new cc.Node;n.setAnchorPoint(.5,.5);var s=new cc.Sprite(bundles.menubar.frames.coin_png);s.setScale(t.coin.scale),n.addChild(s)
;e=cleverapps.UI.generateTTFText(e,cleverapps.styles.FONTS.BUTTON_TEXT);return n.addChild(e),cleverapps.UI.arrangeWithMargins(n.getChildren(),{direction:cleverapps.UI.HORIZONTAL,margin:t.buyMargin}),cleverapps.UI.wrap(n),n}});HelpFromFriendsWindow.isAvailable=function(e){if(!cleverapps.user.checkAvailable(HelpFromFriendsWindow.AVAILABLE))return!1;if(e.buy&&!levels.user.canTakeGold(e.price))return!1;if(e.video&&!cleverapps.rewardedAdsManager.isAvailable(RewardedAdsManager.REWARDED))return!1;var t=HelpFromFriendsWindow.load()[e.storageKey||e.type]||0;return Date.now()-t>cleverapps.parseInterval(e.interval)},HelpFromFriendsWindow.chooseMovesHelp=function(){var e=.12;if(config.debugMode&&(e=5),Math.random()>e)return!1;var t=[HelpFromFriendsWindow.TYPES.addmoves,HelpFromFriendsWindow.TYPES.addmovesvideo].filter(function(e){return HelpFromFriendsWindow.isAvailable(e)});return 0!==t.length&&cleverapps.Random.choose(t)},HelpFromFriendsWindow.showIfCanMoves=function(t){
var n=HelpFromFriendsWindow.chooseMovesHelp();n&&cleverapps.metha.display({focus:"HelpFromFriendsWindow.moves",action:function(e){HelpFromFriendsWindow.create(n,t),cleverapps.metha.onceNoWindowsListener=e}})},HelpFromFriendsWindow.showIfCan=function(e,t){HelpFromFriendsWindow.isAvailable(e)&&HelpFromFriendsWindow.create(e,t)},HelpFromFriendsWindow.create=function(t,n){var e=HelpFromFriendsWindow.load();e[t.storageKey||t.type]=Date.now(),cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.HELP_FROM_FRIENDS,e),config.debugMode&&(HelpFromFriendsWindow.TYPES.addmoves.interval="1 minute",HelpFromFriendsWindow.TYPES.addlivesvideo.interval="1 minute",HelpFromFriendsWindow.TYPES.addcoinsvideo.interval="1 minute"),cleverapps.flags.reduceAds&&t.amountReduced&&(t.amount=t.amountReduced),cleverapps.eventLogger.logEvent(t.show),new HelpFromFriendsWindow(t,function(e){n&&n(e,t),t.success.forEach(function(e){cleverapps.eventLogger.logEvent(e)})})},HelpFromFriendsWindow.load=function(){
return cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.HELP_FROM_FRIENDS)||{}},HelpFromFriendsWindow.TYPES={showhint:{type:"showhint",interval:"1 day",amount:1,request:!0,icon:!1,success:[cleverapps.EVENTS.HINT_FOR_INVITE_SUCCESS],show:cleverapps.EVENTS.HINT_FOR_INVITE_SHOW},addmoves:{type:"addmoves",storageKey:"addmoves",interval:"1 hour",amount:3,buy:!0,price:50,icon:"#main-moves_icon.png",success:[cleverapps.EVENTS.MOVES_FOR_BUY_SUCCESS],show:cleverapps.EVENTS.MOVES_FOR_BUY_SHOW},addmovesvideo:{type:"addmovesvideo",storageKey:"addmoves",interval:"1 hour",amount:3,video:!0,icon:"#main-moves_icon.png",success:[cleverapps.EVENTS.MOVES_FOR_VIDEO_SUCCESS,cleverapps.EVENTS.REWARDED_ADD_MOVES],show:cleverapps.EVENTS.MOVES_FOR_VIDEO_SHOW},addlivesvideo:{type:"addlivesvideo",interval:"30 minutes",amount:1,video:!0,icon:bundles.help_from_friends.frames.add_lives_icon,success:[cleverapps.EVENTS.LIVES_FOR_VIDEO_SUCCESS,cleverapps.EVENTS.REWARDED_ADD_LIVES],
show:cleverapps.EVENTS.LIVES_FOR_VIDEO_SHOW},addcoinsvideo:{type:"addcoinsvideo",interval:"30 minutes",amount:30,amountReduced:10,video:!0,success:[cleverapps.EVENTS.COINS_FOR_VIDEO_SUCCESS,cleverapps.EVENTS.REWARDED_ADD_COINS],show:cleverapps.EVENTS.COINS_FOR_VIDEO_SHOW}},HelpFromFriendsWindow.ADD_MOVES_CLEAR_INTERVAL="30 minutes",HelpFromFriendsWindow.AVAILABLE={episode:0,level:9},"merge"===cleverapps.config.type&&(HelpFromFriendsWindow.AVAILABLE={disabled:!0}),HelpFromFriendsWindow.prototype.listBundles=function(){var e=["help_from_friends"];return-1!==["adventure","runes"].indexOf(cleverapps.config.name)&&e.push("dialogues"),e},cleverapps.styles.HelpFromFriendsWindow={text:{font:cleverapps.styles.FONTS.WINDOW_TEXT,y:110,dimension:{y:150}},container:{width:200,height:180,buy:{width:200,height:280}},animation:{buy:{x:240,y:110,person:{x:-60,y:110,scale:.8,json:bundles.dialogues.jsons.default_json,animation:"animation"}},x:100,y:80},width:620,y:70,margin:{bottom:70,y:30,top:60},
button:{width:320,height:120,buy:{width:260,height:100,buyMargin:20,coin:{scale:1}},Text:{font:cleverapps.styles.FONTS.BUTTON_TEXT,offsetX:0,offsetY:18},RewardText:{font:cleverapps.styles.FONTS.SHARE_BUTTON_REWARD_TEXT,offsetX:-18,offsetY:-24},RewardCoins:{scale:.5,offsetX:20,offsetY:-24},Margin:{y:50}}};var BeatFriendView=cc.Node.extend({ctor:function(e){this._super(),this.setAnchorPoint(.5,.5);var t=new cleverapps.UI.Avatar(e);this.addChild(t),this.avatar=t,this.setContentSize(t.width*t.scale,t.height*t.scale),t.setPositionRound(this.width/2,t.height/2);var n=new cc.Sprite(bundles.main.frames.levelstart_cup_1);n.setPositionRound(this.avatar.width+cleverapps.styles.BeatFriendView.Cup.Margin.x,this.avatar.y),n.setLocalZOrder(1),this.addChild(n),this.cup=n}});cleverapps.styles.BeatFriendView={Cup:{Margin:{x:10}}};var BeatFriendWindow=Window.extend({onWindowLoaded:function(e,t){this.friendId=e,this.friend=cleverapps.friends.getById(e),this.level=t,
cleverapps.social.sendActivity&&cleverapps.social.sendActivity(cleverapps.Social.ACTIVITY.PASSED_FRIEND,{userName:cleverapps.friends.getPlayer().name,friendName:this.friend.name});var n=cleverapps.styles.BeatFriendWindow,s=new cc.Node;s.setAnchorPoint(.5,.5),s.setContentSize(n.width,n.height),this.content=s;var i=cleverapps.UI.generateTTFText("messages:LevelFriendBeatWindow.text",cleverapps.styles.FONTS.WINDOW_TEXT,{friendName:this.friend.name});i.setDimensions(n.Text.width,0),i.setPositionRound(s.width/2,s.height-i.height/2+n.Text.Margin.y),i.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER),this.content.addChild(i);var o=new cc.Sprite(bundles.beatfriendwindow.frames.beat_friend_bg_png);o.setScale(n.bg.scale),o.setPositionRound(s.width/2+n.bg.offsetX,o.height*o.scale/2+n.bg.offsetY),s.addChild(o),this.bg=o,this.addAvatars(),this._super({title:"messages:LevelFriendBeatWindow.title",name:"beatfriendwindow",content:s,buttons:this.listButtons()}),cleverapps.audio.playSound(
bundles.main.urls.window_effect),this.customize()},customize:function(){},addAvatars:function(){var e=this.content,t=new BeatFriendView(cleverapps.friends.getById(this.friendId)),n=new BeatFriendView(cleverapps.friends.getPlayer());e.addChild(t),e.addChild(n);var s=cleverapps.styles.BeatFriendWindow;t.setPositionRound(e.width/2+s.Animation.Friend.Margin.x,this.bg.y+s.Animation.Friend.Margin.y),t.originalPosition=t.getPosition(),n.setPositionRound(e.width/2+s.Animation.User.Margin.x,this.bg.y+s.Animation.User.Margin.y),n.originalPosition=n.getPosition(),this.friend=t,this.user=n},onShow:function(){var r=this.user;r.stopAllActions(),r.setPositionRound(this.user.originalPosition),r.scale=1,r.cup.opacity=0,r.cup.scale=0;var e=cleverapps.styles.BeatFriendWindow.Animation;[cc.pRound(e.User.MoveBy[0].x,e.User.MoveBy[0].y),cc.pRound(e.User.MoveBy[1].x,e.User.MoveBy[1].y),cc.pRound(e.User.MoveBy[2].x,e.User.MoveBy[2].y)].forEach(function(e,t){r.runAction(new cc.Sequence(new cc.DelayTime(
.4*t*1.5+.2),new cc.CallFunc(function(e,t){var n=r.getPosition(),s=cc.pRound(n.x+e.x,n.y+e.y),i=cc.pRound((n.x+2*s.x)/3,(n.y+2*s.y)/3+e.x*(t?1.2:2)),o=cc.pRound((n.x+i.x)/2,(n.y+i.y)/2);r.runAction(new cc.Spawn(new cc.BezierTo(1.5*(t?.5:.4),[o,i,s])))}.bind(this,e,2===t))))}),r.runAction(new cc.Sequence(new cc.DelayTime(1.2*1.5+.2),new cc.ScaleTo(.3*1.5,1.4).easing(cc.easeBackOut()),new cc.CallFunc(function(){r.runAction(new cc.RepeatForever(new cc.Sequence(new cc.ScaleTo(.5,1.45),new cc.ScaleTo(.5,1.4))))}))),r.cup.runAction(new cc.Sequence(new cc.DelayTime(2.3),new cc.Spawn(new cc.ScaleTo(.3*1.5,1).easing(cc.easeBackOut()),new cc.FadeIn(.3*1.5))));var t=void 0===BeatFriendWindow.SOUND_DELAY?2.3:BeatFriendWindow.SOUND_DELAY;this.runAction(new cc.Sequence(new cc.DelayTime(t),new cc.CallFunc(function(){cleverapps.audio.playSound(bundles.main.urls.beat_friend_effect)})));var n=this.friend;n.stopAllActions(),n.setPositionRound(n.originalPosition),n.scale=1.4,n.cup.visible=!1,n.runAction(
new cc.Sequence(new cc.DelayTime(1.7),new cc.Spawn(new cc.ScaleTo(.3*1.5,1),new cc.MoveBy(.3*1.5,cc.pRound(e.Friend.MoveBy.x,e.Friend.MoveBy.y)))))},onHide:function(){this.user&&(this.user.stopAllActions(),this.user.cup&&this.user.cup.stopAllActions()),this.friend&&this.friend.stopAllActions()},listButtons:function(){if(this.level.isRegular()){var e=ShareBonusButton.create({shareBonus:cleverapps.ShareBonus.SHARES.beatFriend,toReplace:{levelNo:levels.user.getProgress(),friendId:this.friendId},callback:function(){this.close()}.bind(this)});if(e)return[e]}var t=cleverapps.styles.BeatFriendWindow;return[new BottomButton(this,{width:t.Button.width,height:t.Button.height,text:Messages.get("OK"),onPressed:this.close.bind(this)})]}});BeatFriendWindow.prototype.listBundles=function(){return["beatfriendwindow"]},BeatFriendWindow.AVAILABLE={episode:0,level:5},cleverapps.styles.BeatFriendWindow={width:600,height:600,bg:{offsetX:0,offsetY:80,scale:2},Button:{width:280,height:110,Margin:{x:26}},
Animation:{User:{MoveBy:{0:{x:25,y:10},1:{x:35,y:10},2:{x:230,y:20}},Margin:{x:-200,y:-50}},Friend:{MoveBy:{x:-40,y:-20},Margin:{x:-50,y:-40}}},Text:{Margin:{y:-80},width:500},share:{}};var FinisherWindow=Window.extend({onWindowLoaded:function(){var e=this.generateContent();this._super({title:"messages:FinisherWindow.title",name:"finisherwindow",content:e,button:{width:cleverapps.styles.FinisherWindow.Button.width,height:cleverapps.styles.FinisherWindow.Button.height,text:Messages.get("FinisherWindow.Button.text"),onPressed:function(){cc.sys.openURL(cleverapps.bySource(cleverapps.config.helpURL))}}}),cleverapps.audio.playSound(bundles.game.urls.win_effect),this.addChild(new Fireworks)},generateContent:function(){var e=cleverapps.styles.FinisherWindow,t=new cc.Node;t.setAnchorPoint(.5,.5),this.content=t;var n=function(e){var t={android:bundles.store_links.urls.android_png,ios:bundles.store_links.urls.ios_png,amazon:bundles.store_links.urls.amazon_png}[e],
n=cleverapps.config[e]&&cleverapps.config[e].url;if(n&&t){var s=new cc.Sprite(t);return cleverapps.UI.applyHover(s),cleverapps.UI.onClick(s,function(){cc.sys.openURL(n)}),s}};this.addText("messages:FinisherWindow.GroupText");var s=cleverapps.User.calcSource();if(cc.sys.isNative||cleverapps.isInstant()||-1!==["mobile_ok","web_ok","mobile_vk","web_vk","web_mm","mobile_mm"].indexOf(s)){var i=n(s);i&&this.addButtons([i]),this.addText("messages:FinisherWindow.AllAndStoreText")}else{var o=["android","ios","amazon"].map(n).filter(function(e){return void 0!==e});0<o.length&&(this.addButtons(o.slice(0,2)),this.addText("messages:FinisherWindow.StoreText")),this.addText("messages:FinisherWindow.AllPassedText")}return cleverapps.UI.arrangeWithMargins(t.getChildren(),{direction:cleverapps.UI.VERTICAL,margin:e.Text.margin,y:e.bottomPadding.y}),cleverapps.UI.wrap(t),t=cleverapps.UI.wrapWithPadding(t,e.padding)},addText:function(e){var t=cleverapps.styles.FinisherWindow.Text,
n=cleverapps.UI.generateTTFText(e,t.font);n.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER),n.setDimensions(t.width,0),this.content.addChild(n)},addButtons:function(e){var t=cleverapps.styles.FinisherWindow,n=new cc.Node;e.forEach(function(e){n.addChild(e)}),cleverapps.UI.arrangeWithMargins(n.getChildren(),{direction:cleverapps.UI.HORIZONTAL,margin:t.margin}),cleverapps.UI.wrap(n),n=cleverapps.UI.wrapWithPadding(n,{x:0,y:10}),this.content.addChild(n)}});FinisherWindow.prototype.listBundles=function(){return["store_links"]},cleverapps.styles.FinisherWindow={bottomPadding:{y:0},padding:{x:0,y:10},GroupInfo:{width:450,heigth:70},Text:{font:cleverapps.styles.FONTS.SMALL_TEXT_BROWN,paddingTop:10,paddingBottom:10,width:550,margin:10},Button:{width:460,height:100},paddingTop:25,paddingBottom:50,width:500,margin:30},CustomSyncers.extractors.result=function(e){if(cleverapps.config.results){var t=[];if(e)t.push(e);else for(var n=cleverapps.user.episode;0<=n;n--)if(
!cleverapps.userresult.isEmpty(n)){var s=cleverapps.userresult.getEpisodeInfo(n);s.episodeNo=n,t.push(s)}return 0<t.length?t.map(function(e){return{episode:e.episodeNo,scores:JSON.stringify(UserResult.ParseLib.objToArray(e.scores)),stars:JSON.stringify(UserResult.ParseLib.objToNumber(e.stars))}}):void 0}},CustomSyncers.importerData.result=function(e){cleverapps.config.results&&e.forEach(function(e){var t=e.episode,n=UserResult.ParseLib.parseScores(e.scores),s=UserResult.ParseLib.parseStars(e.stars);Object.keys(n).forEach(function(e){s.hasOwnProperty(e)&&cleverapps.userresult.updateLevel(t,e,n[e],s[e],{force:!0,skipUpdate:!0})})})},levels.GameHints=function(){var e=cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.LEVEL_HINTS);this.usedHints="number"==typeof e?e:0},levels.GameHints.prototype.reset=function(){this.isCurrentLevel()&&(this.usedHints=0,this.save())},levels.GameHints.prototype.isCurrentLevel=function(){return Game.currentGame&&Game.currentGame.level.isCurrentLevel()},
levels.GameHints.prototype.addHint=function(){this.isCurrentLevel()&&(this.usedHints++,this.save())},levels.GameHints.prototype.save=function(){cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.LEVEL_HINTS,this.usedHints)};var Lantern=function(e){this.mission=e,this.onGiveBonusListener=function(){},this.load()};Lantern.prototype.isActive=function(e){return e?e.isCurrentLevel():levels.user.isCurrentLevel(cleverapps.environment.levelNo,cleverapps.environment.episodeNo)},Lantern.getMaxStreak=function(){return 3},Lantern.prototype.giveBonus=function(i){var o=this.getCurrentStreak();cleverapps.audio.playSound(bundles.game.urls.lanterngivebonus_effect),Game.currentGame.counter.setTimeout(function(){var e=Lantern.BONUSES_BY_SERIA[o];for(var t in e){if(t===Lantern.BONUS_TYPES.HEROES){var n=Game.currentGame.field.addRandomCombo(e[t]);n<e[t]&&cleverapps.eventLogger.logEvent(cleverapps.EVENTS.LANTERN_COMBO_NO_PLACE,{amount:e[t]-n})}if(t===Lantern.BONUS_TYPES.MULTICOLOR){
var s=Game.currentGame.field.addRandomMulticolor(e[t]);s<e[t]&&cleverapps.eventLogger.logEvent(cleverapps.EVENTS.LANTERN_MULTICOLOR_NO_PLACE,{amount:e[t]-s})}t===Lantern.BONUS_TYPES.MOVES&&(Game.currentGame.setMoves(Game.currentGame.moves+e[t],{animate:!0}),Game.currentGame.beginMoves+=e[t])}i()}.bind(this),1e3*cleverapps.styles.Lantern.duration),this.onGiveBonusListener()},Lantern.prototype.save=function(){this.mission.result=0,this.mission.update(this.streak)},Lantern.prototype.load=function(){this.streak=this.mission.result,this.savedStreak=this.streak,this.beforeShownProgress=this.streak},Lantern.prototype.getCurrentStreak=function(){return this.savedStreak},Lantern.prototype.restoreSavedStreak=function(){this.streak=this.savedStreak,this.save()},Lantern.prototype.onStart=function(){this.savedStreak=this.streak,this.streak=0,this.save()},Lantern.prototype.onWin=function(){this.streak=Math.min(this.savedStreak+1,Lantern.getMaxStreak()),this.savedStreak=this.streak,this.save()},
Lantern.prototype.onLose=function(){this.streak=0,this.savedStreak=0,this.beforeShownProgress=0,this.save()},Lantern.Get=function(){return cleverapps.missionManager.getRunningMission(Missions.SEMAPHORE_LANTERN)&&cleverapps.missionManager.getRunningMission(Missions.SEMAPHORE_LANTERN).logic.lantern},Lantern.IsActive=function(e){var t=Lantern.Get();return t&&t.isActive(e)},Lantern.GetStreak=function(e){var t=Lantern.Get();return t&&t.isActive(e)&&0<t.streak?t.streak:0},Lantern.BONUS_TYPES={},Lantern.BONUS_TYPES.HEROES="heroes",Lantern.BONUS_TYPES.MULTICOLOR="multicolor",Lantern.BONUS_TYPES.MOVES="moves",Lantern.BONUSES_BY_SERIA={1:{heroes:5},2:{heroes:5,moves:3},3:{heroes:5,moves:3,multicolor:1}},cleverapps.styles.Lantern={duration:.4};var LanternView=cc.Node.extend({ctor:function(e,t){this._super(),this.lantern=e,this.setAnchorPoint2(),this.setLocalZOrder(2),this.styles=cleverapps.styles.LanternView,this.animation=new cleverapps.Spine(bundles.lantern.jsons.lantern_game_json),
this.addChild(this.animation),this.setContentSize2(this.animation.getContentSize()),this.animation.setPositionRound(this.width/2,this.height/2),(t=t||cc.director.getRunningScene().fieldView).addChild(this),this.lantern.onGiveBonusListener=this.createListener(this.hide.bind(this))},show:function(){this.animation.setAnimation(0,"idle_"+this.lantern.getCurrentStreak(),!0);var e=this.getParent().convertToNodeSpace(cc.p(-this.width,0));e.x||(e.x=0),e.y=this.styles.show.y;var t=1/this.parent.scale,n=this.styles.offset.x*(t<1?t:1),s=this.styles.offset.y*(t<1?t:1),i=cc.p(this.parent.width/2+n,this.parent.height/2+s);this.setPositionRound(e),"heroes"===cleverapps.config.name?this.runAction(new cc.MoveTo(.5,i)):(this.setRotation(45),this.runAction(new cc.Spawn(new cc.MoveTo(.5,i),new cc.RotateTo(.5,0)))),cleverapps.audio.playSound(bundles.game.urls.lanternshow_effect)},hide:function(){var t=this.getParent().convertToNodeSpace(cc.p(-this.width,0));t.y=this.styles.hide.y,
this.animation.setCompleteListener(function(){this.animation.setAnimation(0,"idle_"+this.lantern.getCurrentStreak(),!0);var e=new cc.Spawn(new cc.MoveTo(.5,t),new cc.RotateTo(.4,-45));"heroes"===cleverapps.config.name&&(e=new cc.MoveTo(.5,t)),this.runAction(new cc.Sequence(e,new cc.RemoveSelf))}.bind(this)),this.animation.setAnimation(0,"out_"+this.lantern.getCurrentStreak(),!1),cleverapps.audio.playSound(bundles.game.urls.lanternhide_effect)},listNodeBundles:function(){return["lantern"]}});cleverapps.styles.LanternView={offset:{x:0,y:150},show:{y:100,delay:1},hide:{y:1e3}};var FriendSorter=function(){this.data=cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.SORTER),this.data||(this.data={}),cleverapps.config.debugMode&&(FriendSorter.PRIVACY_INTERVAL="1 minute"),this.update()};FriendSorter.PRIVACY_INTERVAL="1 day",FriendSorter.prototype.update=function(){var e={},t=Date.now(),n=!1;for(var s in this.data)this.data[s]+cleverapps.parseInterval(FriendSorter.PRIVACY_INTERVAL
)>t?e[s]=this.data[s]:n=!0;n&&(this.data=e,this.save())},FriendSorter.prototype.save=function(){cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.SORTER,this.data)},FriendSorter.isActivePlayer=function(e){return 1<=e.episode||6<=e.level},FriendSorter.prototype.canUse=function(e){return void 0===this.data[e]},FriendSorter.prototype.markUsed=function(e){e.forEach(function(e){this.data[e]=Date.now()},this),this.save()},FriendSorter.prototype.listActiveFriends=function(){return levels.progress.data?levels.progress.data.filter(FriendSorter.isActivePlayer).map(function(e){return cleverapps.friends.getById(e.id)}).filter(function(e){return e}):cleverapps.friends.listFriends()},FriendSorter.prototype.listInactiveFriends=function(){var e=cleverapps.invitalbleFriends.listFriends();if(levels.progress.data){var t=levels.progress.data.filter(function(e){return!FriendSorter.isActivePlayer(e)});e=e.concat(t.map(function(e){return cleverapps.friends.getById(e.id)})).filter(function(e){return e})}
return this.update(),e=e.filter(function(e){return e&&void 0===this.data[e.id]},this)};var SelectFriendWindow=Window.extend({onWindowLoaded:function(e,t){var n=new cc.Node;n.setAnchorPoint(.5,.5),this.content=n,this.type=e,cleverapps.config.debugMode&&(SelectFriendWindow.PROCESS_PERIOD="300 second");var s=cleverapps.friends.listFriends().concat(cleverapps.invitalbleFriends.listFriends());s.length?this.generateFriendsContent(s,t):this.generateNoFriendsContent();var i=cleverapps.overrideStyles(cleverapps.styles.Window,cleverapps.styles.SelectFriendWindow.window,!0);this._super({title:SelectFriendWindow.ByType[this.type].title,name:"selectfriendwindow"+e,content:n,styles:i}),cleverapps.audio.playSound(bundles.main.urls.window_effect)},addCheck:function(e,t){var n=new cc.Sprite(bundles.main.frames.select_friend_checkbox_selected);t&&cleverapps.UI.convertToGrayScale(n),n.setPosition(e.width/2,e.height/2),e.check=n,e.addChild(n)},checkElementByFriendId:function(e,t){
var n=this.selectedElements.friends.indexOf(e);-1!==n?(this.selectedElements.data[e].checked=!1,this.selectedElements.data[e].check.removeFromParent(),this.selectedElements.data[e]=void 0,this.selectedElements.friends.splice(n,1)):(this.addCheck(t),t.checked=!0,this.selectedElements.data[e]=t,this.selectedElements.friends.push(e),this.selectedElements.friends.length>SelectFriendWindow.MAX_SELECTED&&this.checkElementByFriendId(this.selectedElements.friends[0])),this.updateSelectedContent()},generateCheckbox:function(n,s){var e=cleverapps.styles.SelectFriendWindow.withFriends.friendContainer.checkBox;if(!this.processTimeData)for(var t in this.processTimeData=cleverapps.DataLoader.load(SelectFriendWindow.ByType[this.type].dataLoaderType()),this.processTimeData||(this.processTimeData={}),this.processTimeData)this.processTimeData[t]<Date.now()-cleverapps.parseInterval(SelectFriendWindow.PROCESS_PERIOD)&&(this.processTimeData[t]=void 0);var i=function(){cc.eventManager.addListener({
event:cc.EventListener.TOUCH_ONE_BY_ONE,onTouchBegan:function(e){var t=s.convertTouchToNodeSpace(e);return!!cc.rectContainsPoint(cc.rect(0,0,s.width,s.height),t)&&(t=this.friendsContainer.convertTouchToNodeSpace(e),cc.rectContainsPoint(cc.rect(0,0,this.friendsContainer.width,this.friendsContainer.height),t))}.bind(this),onTouchEnded:function(e){var t=s.convertTouchToNodeSpace(e);if(!cc.rectContainsPoint(cc.rect(0,0,s.width,s.height),t))return!1;t=this.friendsContainer.convertTouchToNodeSpace(e),cc.rectContainsPoint(cc.rect(0,0,this.friendsContainer.width,this.friendsContainer.height),t)&&this.checkElementByFriendId(n.id,o)}.bind(this)},s),s.onMouseOver=function(){s.bg&&s.bg.setColor(cleverapps.styles.COLORS.HOVER),o.setScale(1.1)},s.onMouseOut=function(){s.bg&&s.bg.setColor(cleverapps.styles.COLORS.WHITE),o.setScale(1)},cleverapps.UI.applyHover(s)}.bind(this),o=this.generateCheckBoxBg();if(o.setPositionRound(e.x,s.height/2+cleverapps.styles.SelectFriendWindow.Avatar.y),s.fullData={
checkBox:o,id:n.id},s.addChild(o),this.processTimeData&&this.processTimeData[n.id]&&this.processTimeData[n.id]>Date.now()-cleverapps.parseInterval(SelectFriendWindow.PROCESS_PERIOD)){var r={showHours:!0,font:cleverapps.styles.FONTS.WINDOW_SMALL_TEXT,imageFont:!1};console.log("disabled",s);var a=this.processTimeData[n.id]+cleverapps.parseInterval(SelectFriendWindow.PROCESS_PERIOD)-Date.now(),c=new cleverapps.CountDownView(new cleverapps.CountDown(a),r),l=function(){c.refresh(),c.removeFromParent(),s.name.setVisible(!0),s.avatar.setOpacity(255),o.setOpacity(255),s.coinsIcon&&s.coinsIcon.setOpacity(255),o.check.removeFromParent(),s.notActive=!1,i()}.bind(this);return c.onEnter=function(){cleverapps.CountDownView.prototype.onEnter.call(this),c.countDown.onFinish=c.createListener(l)},c.setPosition(s.width/2,e.timer.y),s.addChild(c),s.name.setVisible(!1),this.addCheck(o,!0),o.setOpacity(150),s.avatar.setOpacity(120),s.notActive=!0,void(s.coinsIcon&&s.coinsIcon.setOpacity(150))}s.notActive=!1
,i()},generateCheckBoxBg:function(){var e=new cc.Sprite(bundles.main.frames.select_friend_checkbox);return e.setAnchorPoint(.5,.5),e.setCascadeOpacityEnabled(!0),e},generateFriendContent:function(e,t){var n=cleverapps.styles.SelectFriendWindow.withFriends.friendContainer,s=new cc.Node;if(s.setAnchorPoint(.5,.5),s.setContentSize(n.width,n.height),bundles.select_friend_window.frames.friend_bg_png){var i=cleverapps.UI.createScale9Sprite(bundles.select_friend_window.frames.friend_bg_png);i.setAnchorPoint(.5,.5),i.setContentSize(n.width,n.height),i.setPosition(s.width/2,s.height/2),s.addChild(i),s.bg=i}var o=new cleverapps.UI.Avatar(e);o.setPositionRound(cleverapps.styles.SelectFriendWindow.Avatar.x,s.height/2+cleverapps.styles.SelectFriendWindow.Avatar.y),o.setAnchorPoint2(),(s.avatar=o).setCascadeOpacityEnabled(!0),s.addChild(o);var r=cleverapps.UI.generateTTFText(e.name,cleverapps.styles.FONTS.WINDOW_SMALL_TEXT);return r.setDimensions(n.Name.width,n.Name.height),r.setHorizontalAlignment(
cc.TEXT_ALIGNMENT_CENTER),r.setVerticalAlignment(cc.VERTICAL_TEXT_ALIGNMENT_TOP),s.addChild(r),r.setPositionRound(s.width/2,n.Name.y),s.name=r,this.generateCheckbox(e,s),s},getButtonContent:function(){var e=new cc.Node;e.setAnchorPoint2();var t=cleverapps.UI.generateTTFText(SelectFriendWindow.ByType[this.type].button,cleverapps.styles.FONTS.BUTTON_TEXT);return e.buttonText=t,e.addChild(t),e.setContentSize(t.width,t.height),t.setPositionRound({align:"center"},{align:"center"}),e},generateFriendsContent:function(e,n){this.selectedElements={friends:[],data:{}};var t=cleverapps.styles.SelectFriendWindow.withFriends;this.content.setContentSize(t.width,t.height);var s=new cleverapps.UI.Button({content:this.getButtonContent(),width:t.Button.width,height:t.Button.height,font:cleverapps.styles.FONTS.BUTTON_TEXT,onClicked:function(){this.selectedElements.friends.length&&(this.close(),n(this.selectedElements.friends,function(){if(this.processTimeData){for(
var e=0;e<this.selectedElements.friends.length;e++)this.processTimeData[this.selectedElements.friends[e]]=Date.now();cleverapps.DataLoader.save(SelectFriendWindow.ByType[this.type].dataLoaderType(),this.processTimeData)}}.bind(this)))}.bind(this),clickThrottle:cleverapps.UI.SOCIAL_CLICK_THROTTLE});s.setPositionRound(this.content.width/2+t.Button.x,t.Button.y),this.button=s,this.content.addChild(s);var i=new cc.Node;i.setAnchorPoint(0,.5),i.setPositionRound(t.SelectedBlock.x,t.SelectedBlock.y);var o=this.generateCheckBoxBg();o.setAnchorPoint(0,.5),o.setPositionRound(0,o.height/2),i.addChild(o);var r=cleverapps.UI.generateTTFText("messages:Selected",cleverapps.styles.FONTS.WINDOW_TEXT);r.setPositionRound(o.width+t.SelectedBlock.margin.x,o.y+r.height/2),r.setAnchorPoint(0,.5),i.addChild(r);var a=cleverapps.UI.generateTTFText("",cleverapps.styles.FONTS.WINDOW_TEXT);a.setAnchorPoint(.5,.5),this.selectedAmountText=a,i.addChild(a),this.updateSelectedContent(),a.setPositionRound(r.x+r.width/2,
o.y-a.height/2),i.setContentSize(o.width+r.width+t.SelectedBlock.margin.x,o.height),this.content.addChild(i),i.onMouseOver=function(){o.setScale(1.1)},i.onMouseOut=function(){o.setScale(1)},cleverapps.UI.applyHover(i),cleverapps.UI.onClick(i,function(e){this.switchSelectAll(o)}.bind(this));var c=new cc.Node;this.friendContainers=e.map(function(e,t){return{container:this.generateFriendContent(e,n),order:t}},this),levels.friendSorter.update(),this.friendContainers.sort(function(e,t){return e.container.notActive!==t.container.notActive?e.container.notActive?1:-1:levels.friendSorter.canUse(e.container.fullData.id)!==levels.friendSorter.canUse(t.container.fullData.id)?levels.friendSorter.canUse(e.container.fullData.id)?-1:1:e.order-t.order}),this.friendContainers.length>SelectFriendWindow.MAX_ROWS_AMOUNT*SelectFriendWindow.IN_ROW&&(this.friendContainers=this.friendContainers.slice(0,SelectFriendWindow.MAX_ROWS_AMOUNT*SelectFriendWindow.IN_ROW));for(var l=0;l<this.friendContainers.length;l++
)c.addChild(this.friendContainers[l].container),this.friendContainers[l].container.setPositionRound(l%SelectFriendWindow.IN_ROW*(t.friendContainer.margin+t.friendContainer.width)+t.friendContainer.width/2,c.height-Math.floor(l/SelectFriendWindow.IN_ROW)*(t.friendContainer.margin+t.friendContainer.height)-t.friendContainer.height/2);c=cleverapps.UI.wrap(c),this.friendsContainer=new cleverapps.UI.ScrollView(c),this.friendsContainer.setContentSize(c.width+cleverapps.styles.SelectFriendWindow.scroll.margin.mx[0],t.friendsContainer.height),this.friendsContainer.setAnchorPoint(.5,0),this.friendsContainer.setPositionRound(this.content.width/2,t.friendsContainer.y),cc.sys.isNative||this.switchSelectAll(o),this.content.addChild(this.friendsContainer)},switchSelectAll:function(e){if(e.selected){e.selected=!1,e.check.removeFromParent();for(var t=this.selectedElements.friends.length-1;0<=t;t--)this.checkElementByFriendId(this.selectedElements.friends[t])}else{var n=!1;for(
t=0;t<this.friendContainers.length;t++){var s=this.friendContainers[t].container,i=s.fullData;this.selectedElements.friends.length<SelectFriendWindow.MAX_SELECTED&&!s.notActive&&!i.checkBox.checked&&(this.checkElementByFriendId(i.id,i.checkBox),n=!0)}n&&(e.selected=!0,this.addCheck(e))}},updateSelectedContent:function(){this.selectedAmountText.setString(this.selectedElements.friends.length+"/"+SelectFriendWindow.MAX_SELECTED),this.selectedElements.friends.length?this.button.enable():this.button.disable()},generateNoFriendsContent:function(){var e=cleverapps.styles.SelectFriendWindow.noFriends;this.content.setContentSize(e.width,e.height);var t=cleverapps.UI.generateTTFText(SelectFriendWindow.ByType[this.type].noFriends,cleverapps.styles.FONTS.WINDOW_TEXT);t.setPositionRound(this.content.width/2,e.Text.y),t.setDimensions(e.Text.width,e.Text.height),t.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER),this.content.addChild(t);var n=new cleverapps.UI.Button({text:Messages.get(
"SettingsWindow.InviteFriends"),width:e.Button.width,height:e.Button.height,font:cleverapps.styles.FONTS.BUTTON_TEXT,onClicked:function(){cleverapps.social.inviteFriendsWindow(function(){this.close()}.bind(this))}.bind(this)});n.setPositionRound(this.content.width/2,e.Button.y),this.content.addChild(n)}});SelectFriendWindow.ByType={askLives:{title:"messages:SelectFriendWindow.askLives.title",button:"messages:Ask",noFriends:"messages:SelectFriendWindow.askLives.noFriendsText",dataLoaderType:function(){return cleverapps.DataLoaderTypes.ASKED_LIVES}},askStars:{title:"messages:SelectFriendWindow.askStars.title",button:"messages:Ask",noFriends:"messages:SelectFriendWindow.askStars.noFriendsText",dataLoaderType:function(){return cleverapps.DataLoaderTypes.ASKED_STARS}}},SelectFriendWindow.PROCESS_PERIOD="1 day",SelectFriendWindow.MAX_SELECTED=10,SelectFriendWindow.MAX_ROWS_AMOUNT=10,SelectFriendWindow.IN_ROW=3,cleverapps.styles.SelectFriendWindow={Avatar:{x:140,y:20},scroll:{margin:{mx:[30]}
},withFriends:{width:670,height:750,friendsContainer:{height:580,y:100},friendContainer:{height:180,width:210,margin:20,Name:{width:200,height:40,y:24},checkBox:{x:42,timer:{y:24,height:20}}},Button:{width:300,height:120,y:0,x:190,margin:10},SelectedBlock:{y:0,x:0,margin:{x:20}}},noFriends:{width:550,height:500,Text:{y:250,width:550,height:400},Button:{width:450,height:120,y:0}}},levels.FriendRequests=function(){this.load(),this.lastServerReload=0,this.onNewListener=function(){},this.onChangeListener=function(){},cleverapps.flags.noviral&&this.deleteFakeRequests(),this.serverReload(),FakeRequestSender.sendIfNeed(this),setInterval(function(){this.serverReload(),FakeRequestSender.sendIfNeed(this)}.bind(this),cleverapps.parseInterval("1 minute"))},levels.FriendRequests.prototype.load=function(){var e=cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.FRIEND_REQUESTS);if(e){this.notProcessed=[];var t=this.listAvailableTypes();e.notProcessed=e.notProcessed.filter(function(e){
return-1!==t.indexOf(e.type)});for(var n=0;n<e.notProcessed.length;n++)this.notProcessed.push(levels.FriendRequest.createFriendRequest(e.notProcessed[n]));this.processedIds=e.processedIds}else this.notProcessed=[],this.processedIds=[]},levels.FriendRequests.prototype.save=function(){for(var e=[],t=0;t<this.notProcessed.length;t++)e.push(this.notProcessed[t].getData());cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.FRIEND_REQUESTS,{notProcessed:e,processedIds:this.processedIds})},levels.FriendRequests.prototype.idInNotProcessed=function(e){for(var t=0;t<this.notProcessed.length;t++)if(this.notProcessed[t].getId()===e)return!0;return!1},levels.FriendRequests.prototype.lastNotProcessedId=function(){for(var e=this.notProcessed.length-1;0<=e;e--)if(this.notProcessed[e].canView())return this.notProcessed[e].id;return!1},levels.FriendRequests.prototype.existNotProcessed=function(){for(var e=0;e<this.notProcessed.length;e++)if(this.notProcessed[e].canView())return!0;return!1},
levels.FriendRequests.prototype.existRequestFrom=function(e){for(var t=0;t<this.notProcessed.length;t++)if(this.notProcessed[t].canView()&&this.notProcessed[t].from===e)return!0;return!1},levels.FriendRequests.prototype.existRequestTypes=function(e){for(var t=0;t<this.notProcessed.length;t++)if(0<=e.indexOf(this.notProcessed[t].type))return!0;return!1},levels.FriendRequests.prototype.processById=function(e){for(var t=!1,n=!1,s=0;s<this.notProcessed.length;s++)if(this.notProcessed[s].getId()===e){this.notProcessed[s].onServer()&&(n=!0),this.notProcessed.splice(s,1),t=!0;break}n&&(this.processedIds.push(e),this.deleteOnServerById(e)),t&&this.onChangeListener(),this.save()},levels.FriendRequests.prototype.onServerLoad=function(e){var t=[],n=!1,s=this.listAvailableTypes();Array.isArray(e)||(cleverapps.ReportStream.debug("FriendRequests.onServerLoad data type is - "+typeof e),e=[]),e=e.filter(function(e){return-1!==s.indexOf(e.type)});for(var i=0;i<e.length;i++)0<=this.processedIds.indexOf(
e[i].id)?(this.deleteOnServerById(e[i].id),t.push(e[i].id)):this.idInNotProcessed(e[i].id)||(this.notProcessed.push(levels.FriendRequest.createFriendRequest({id:e[i].id,from:e[i].fromUserId,type:e[i].type})),n=!0);this.processedIds=t,this.save(),n&&(this.onNewListener(),this.onChangeListener())},levels.FriendRequests.prototype.sendServerRequest=function(e,t){cleverapps.RestClient.post("/friendrequests/create/"+cleverapps.user.id+"/a",{toUserId:e,type:t})},levels.FriendRequests.prototype.deleteOnServerById=function(e){cleverapps.RestClient.post("/friendrequests/delete/"+cleverapps.user.id+"/a",{id:e})},levels.FriendRequests.prototype.serverReload=function(){this.lastServerReload<Date.now()-cleverapps.parseInterval(levels.FriendRequests.RELOAD_INTERVAL)&&cleverapps.synchronizer.synced&&(this.lastServerReload=Date.now(),cleverapps.RestClient.get("/friendrequests/getmy/"+cleverapps.user.id+"/a",{},this.onServerLoad.bind(this)))},levels.FriendRequests.prototype.deleteFakeRequests=function(
){var e=this.notProcessed.filter(function(e){return!e.fake});e.length!==this.notProcessed.length&&(this.notProcessed=e,this.onChangeListener(),this.save())},levels.FriendRequests.prototype.listAvailableTypes=function(){var e=[levels.FriendRequest.TYPE_STUCK_HELP_COINS,levels.FriendRequest.TYPE_BOUNTY_READY];return"undefined"==typeof match3&&(e=e.concat([levels.FriendRequest.TYPE_SENT_COINS,levels.FriendRequest.TYPE_ASK_COINS,levels.FriendRequest.TYPE_SENT_HELP_COINS,levels.FriendRequest.TYPE_ASK_HELP_COINS])),cleverapps.lives&&(e=e.concat([levels.FriendRequest.TYPE_SENT_HELP_LIVE,levels.FriendRequest.TYPE_ASK_HELP_LIVE,levels.FriendRequest.TYPE_SENT_LIVE,levels.FriendRequest.TYPE_ASK_LIVE])),cleverapps.starChest&&(e=e.concat([levels.FriendRequest.TYPE_SENT_HELP_STAR,levels.FriendRequest.TYPE_ASK_HELP_STAR,levels.FriendRequest.TYPE_SENT_STAR,levels.FriendRequest.TYPE_ASK_STAR])),e},levels.FriendRequests.RELOAD_INTERVAL="10 minutes",levels.FriendRequest=function(e){this.id=e.id,
this.from=e.from,this.type=e.type,this.fake=e.fake,this.onRemoveListener=function(){}},levels.FriendRequest.prototype.getId=function(){return this.id},levels.FriendRequest.prototype.getView=function(){if(this.canView())return levels.FriendRequestView},levels.FriendRequest.prototype.canView=function(){return levels.FriendRequest.REQUEST_TYPES[this.type]},levels.FriendRequest.prototype.isFake=function(){return!0===this.fake},levels.FriendRequest.prototype.onServer=function(){return!this.isFake()},levels.FriendRequest.prototype.getData=function(){return{id:this.id,from:this.from,type:this.type,fake:this.fake}},levels.FriendRequest.prototype.process=function(){var e=levels.FriendRequest.REQUEST_TYPES[this.type];if(!e.checkProcess||e.checkProcess()){var t=function(){e.createNewRequestId&&levels.friendRequests.sendServerRequest(this.from,e.createNewRequestId),e.onProcess&&e.onProcess(this),this.remove(),0<=levels.FriendRequest.SENT_HELP_REQUESTS.indexOf(this.type
)&&cleverapps.dailyTasks.addProgress(cleverapps.DailyTask.SEND_FRIEND_HELP)}.bind(this);e.fbRequest?cleverapps.social.sendRequest(this.from,e.fbRequest,t):t()}},levels.FriendRequest.prototype.canRemove=function(){return this.type!==levels.FriendRequest.TYPE_BOUNTY_READY||0===cleverapps.bountyManager.listPrizes().length},levels.FriendRequest.prototype.remove=function(){this.canRemove()&&(levels.friendRequests.processById(this.getId()),this.onRemoveListener())},levels.FriendRequest.prototype.cancel=function(){levels.friendRequests.processById(this.getId()),this.onRemoveListener()},levels.FriendRequest.createFriendRequest=function(e){return new levels.FriendRequest(e)},levels.FriendRequest.addLiveProcess=function(e){e.animateCollect(cleverapps.styles.MenuBar.LivesItem.target,function(){cleverapps.lives.setAmount(cleverapps.lives.amount+1)})},levels.FriendRequest.checkAddLiveProcess=function(){return!0},levels.FriendRequest.addStarProcess=function(e){cleverapps.starChest.addStars(1),
cleverapps.starChest.locked||cleverapps.metha.display({focus:"StarChestFriendRequest",action:function(e){new StarChestWindow,cleverapps.metha.onceNoWindowsListener=e}})},levels.FriendRequest.addCoinsProcess=function(e,t){t=t||levels.FriendRequest.HELP_COINS_AMOUNT,e.animateCollect(cleverapps.styles.MenuBar.GoldItem.target,function(){cleverapps.user.setGold(cleverapps.user.gold+t)})},levels.FriendRequest.addCoinsStuckProcess=function(e){levels.FriendRequest.addCoinsProcess(e,levels.FriendRequest.STUCK_COINS_AMOUNT)},levels.FriendRequest.TYPE_ASK_LIVE=0,levels.FriendRequest.TYPE_SENT_LIVE=1,levels.FriendRequest.TYPE_ASK_STAR=2,levels.FriendRequest.TYPE_SENT_STAR=3,levels.FriendRequest.TYPE_ASK_HELP_LIVE=4,levels.FriendRequest.TYPE_SENT_HELP_LIVE=5,levels.FriendRequest.TYPE_ASK_HELP_STAR=6,levels.FriendRequest.TYPE_SENT_HELP_STAR=7,levels.FriendRequest.TYPE_BOUNTY_READY=8,levels.FriendRequest.TYPE_ASK_HELP_COINS=9,levels.FriendRequest.TYPE_SENT_HELP_COINS=10,
levels.FriendRequest.TYPE_ASK_COINS=12,levels.FriendRequest.TYPE_SENT_COINS=13,levels.FriendRequest.TYPE_STUCK_HELP_COINS=14,levels.FriendRequest.SENT_HELP_REQUESTS=[levels.FriendRequest.TYPE_ASK_LIVE,levels.FriendRequest.TYPE_ASK_HELP_LIVE,levels.FriendRequest.TYPE_ASK_STAR,levels.FriendRequest.TYPE_ASK_HELP_STAR,levels.FriendRequest.TYPE_ASK_COINS,levels.FriendRequest.TYPE_ASK_HELP_COINS,levels.FriendRequest.TYPE_STUCK_HELP_COINS],levels.FriendRequest.HELP_COINS_AMOUNT=10,levels.FriendRequest.STUCK_COINS_AMOUNT=50,levels.FriendRequest.REQUEST_TYPES={},levels.FriendRequest.REQUEST_TYPES[levels.FriendRequest.TYPE_ASK_LIVE]={image:bundles.request_center.frames.send_life_icon,button_png:bundles.buttons_main.frames.small_blue_button,button_on_png:bundles.buttons_main.frames.small_blue_button_on,button_text:"Send",text:"AskLiveRequest",fbRequest:"sendLiveRequest",createNewRequestId:levels.FriendRequest.TYPE_SENT_LIVE},
levels.FriendRequest.REQUEST_TYPES[levels.FriendRequest.TYPE_SENT_LIVE]={image:bundles.request_center.frames.accept_life_icon,text:"SendLiveRequest",fbRequest:"thanksForLiveRequest",onProcess:levels.FriendRequest.addLiveProcess,checkProcess:levels.FriendRequest.checkAddLiveProcess},levels.FriendRequest.REQUEST_TYPES[levels.FriendRequest.TYPE_ASK_STAR]={image:bundles.request_center.frames.send_star_icon,button_png:bundles.buttons_main.frames.small_blue_button,button_on_png:bundles.buttons_main.frames.small_blue_button_on,button_text:"Send",text:"AskStarRequest",fbRequest:"sendStarRequest",createNewRequestId:levels.FriendRequest.TYPE_SENT_STAR},levels.FriendRequest.REQUEST_TYPES[levels.FriendRequest.TYPE_SENT_STAR]={image:bundles.request_center.frames.accept_star_icon,text:"SendStarRequest",fbRequest:"thanksForStarRequest",onProcess:levels.FriendRequest.addStarProcess},levels.FriendRequest.REQUEST_TYPES[levels.FriendRequest.TYPE_ASK_HELP_LIVE]={
image:bundles.request_center.frames.send_life_icon,button_png:bundles.buttons_main.frames.small_blue_button,button_on_png:bundles.buttons_main.frames.small_blue_button_on,button_text:"Send",text:"AskHelpRequest",fbRequest:"sentHelpRequest",createNewRequestId:levels.FriendRequest.TYPE_SENT_HELP_LIVE},levels.FriendRequest.REQUEST_TYPES[levels.FriendRequest.TYPE_SENT_HELP_LIVE]={image:bundles.request_center.frames.accept_life_icon,text:"SentHelpRequest",fbRequest:"thanksForHelpRequest",onProcess:levels.FriendRequest.addLiveProcess,checkProcess:levels.FriendRequest.checkAddLiveProcess},levels.FriendRequest.REQUEST_TYPES[levels.FriendRequest.TYPE_ASK_HELP_STAR]={image:bundles.request_center.frames.send_star_icon,button_png:bundles.buttons_main.frames.small_blue_button,button_on_png:bundles.buttons_main.frames.small_blue_button_on,button_text:"Send",text:"AskHelpRequest",fbRequest:"sentHelpRequest",createNewRequestId:levels.FriendRequest.TYPE_SENT_HELP_STAR},
levels.FriendRequest.REQUEST_TYPES[levels.FriendRequest.TYPE_SENT_HELP_STAR]={image:bundles.request_center.frames.accept_star_icon,text:"SentHelpRequest",fbRequest:"thanksForHelpRequest",onProcess:levels.FriendRequest.addStarProcess},levels.FriendRequest.REQUEST_TYPES[levels.FriendRequest.TYPE_BOUNTY_READY]={avatar:bundles.request_center.frames.bounty_ready_icon,text:"BountyRequest",button_text:"Collect",onProcess:BountyManager.openWindow},levels.FriendRequest.REQUEST_TYPES[levels.FriendRequest.TYPE_ASK_HELP_COINS]={image:bundles.request_center.frames.send_coins_icon,button_png:bundles.buttons_main.frames.small_blue_button,button_on_png:bundles.buttons_main.frames.small_blue_button_on,button_text:"Send",text:"AskHelpRequest",fbRequest:"sentHelpRequest",createNewRequestId:levels.FriendRequest.TYPE_SENT_HELP_COINS},levels.FriendRequest.REQUEST_TYPES[levels.FriendRequest.TYPE_SENT_HELP_COINS]={image:bundles.request_center.frames.accept_coins_icon,text:"SentHelpRequest",
fbRequest:"thanksForHelpRequest",onProcess:levels.FriendRequest.addCoinsProcess},levels.FriendRequest.REQUEST_TYPES[levels.FriendRequest.TYPE_ASK_COINS]={image:bundles.request_center.frames.send_coins_icon,button_png:bundles.buttons_main.frames.small_blue_button,button_on_png:bundles.buttons_main.frames.small_blue_button_on,button_text:"Send",text:"AskCoinsRequest",fbRequest:"sendCoinsRequest",createNewRequestId:levels.FriendRequest.TYPE_SENT_COINS},levels.FriendRequest.REQUEST_TYPES[levels.FriendRequest.TYPE_SENT_COINS]={image:bundles.request_center.frames.accept_coins_icon,text:"SendCoinsRequest",fbRequest:"thanksForCoinsRequest",onProcess:levels.FriendRequest.addCoinsProcess},levels.FriendRequest.REQUEST_TYPES[levels.FriendRequest.TYPE_STUCK_HELP_COINS]={image:bundles.request_center.frames.accept_stuck_coins_icon,text:"SendStuckHelpRequest",onProcess:levels.FriendRequest.addCoinsStuckProcess},levels.FriendRequest.SYSTEM_ID=-1,levels.FriendRequestView=cc.Node.extend({ctor:function(e,
t,n){this._super(),this.setContentSize(cleverapps.styles.FriendRequestView.width,cleverapps.styles.FriendRequestView.height),this.setAnchorPoint2(),this.model=e,this.onRemove=n,this.createBackground(),this.createFromContent(),this.createRequestContent(),this.createRequestImage(),this.createCancelContent(),this.createProcessContent(),cleverapps.UI.onClick(this,function(){t.showAutoHide&&t.showAutoHide()||this.process()}.bind(this))},onEnter:function(){this._super(),this.model.onRemoveListener=this.createListener(this.removeAnimation.bind(this)),this.model.animateCollect=this.createListener(this.animateCollect.bind(this))},animateCollect:function(e,t){cleverapps.history.add("reqclt",1),WindowHelper.animateCollect(this.image,{scale:.8,target:e},t)},createFromContent:function(){var e,t=levels.FriendRequest.REQUEST_TYPES[this.model.type],n=void 0;if(cleverapps.social instanceof cleverapps.BaseFB&&(n=this.model.from),t.avatar)e=new cleverapps.UI.Avatar(cc.spriteFrameCache.getSpriteFrame(
t.avatar),n);else{var s=cleverapps.friends.getById(this.model.from);e=s?new cleverapps.UI.Avatar(s):new cleverapps.UI.Avatar("https://scontent.xx.fbcdn.net/v/",n)}var i=cleverapps.styles.FriendRequestView.Avatar;e.setPositionRound(e.width/2+i.Margin.x,this.height/2+i.Margin.y),e.setAnchorPoint2(),this.addChild(e)},createBackground:function(){var e=cleverapps.UI.createScale9Sprite(bundles.main.frames.wood_bg,cleverapps.UI.Scale9Rect.TwoPixelXY);e.setContentSize2(this.width,this.height),e.setPosition(this.width/2,this.height/2),this.addChild(e)},getRequestText:function(){var e=levels.FriendRequest.REQUEST_TYPES[this.model.type];return Messages.get(e.text)},createRequestContent:function(){var e=this.getRequestText();if(e){var t=cleverapps.styles.FriendRequestView.Request;(e=cleverapps.UI.generateTTFText(e,t.font)).setPositionRound(this.width/2+t.x,this.height/2+t.y),e.setDimensions(t.width,0),e.fitTo(void 0,t.height),e.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER),
e.setVerticalAlignment(cc.TEXT_ALIGNMENT_CENTER),this.addChild(e)}},getRequestImage:function(){var e=levels.FriendRequest.REQUEST_TYPES[this.model.type];return!!e.image&&new cc.Sprite(e.image)},createRequestImage:function(){var e=this.getRequestImage();e&&(e.setPosition(cleverapps.styles.FriendRequestView.Icon.x,this.height/2+cleverapps.styles.FriendRequestView.Icon.y),this.addChild(e),this.image=e)},getProcessButtonStyle:function(){var e=levels.FriendRequest.REQUEST_TYPES[this.model.type];return{button_png:e.button_png||bundles.buttons_main.frames.small_green_button,button_on_png:e.button_on_png||bundles.buttons_main.frames.small_green_button_on,text:Messages.get(e.button_text?e.button_text:"Accept"),font:cleverapps.styles.FriendRequestView.processButton.font}},createProcessContent:function(){var e=this.getProcessButtonStyle(),t=cleverapps.styles.FriendRequestView.processButton,n=new cc.Node;n.setPosition(t.width/2,t.height/2);var s=cleverapps.UI.generateTTFText(e.text,e.font)
;s.fitTo(.9*t.width),s.setPosition(0,t.text.y),n.addChild(s);var i=new cleverapps.UI.Button({button_png:e.button_png,button_on_png:e.button_on_png,content:n,onClicked:this.process.bind(this),width:t.width,height:t.height});levels.FriendRequest.REQUEST_TYPES[this.model.type].image?i.setPositionRound(this.width-i.width/2-cleverapps.styles.FriendRequestView.processButton.x,this.height/2+cleverapps.styles.FriendRequestView.processButton.y):i.setPositionRound(this.width-i.width/2-cleverapps.styles.FriendRequestView.processButton.noImage.x,this.height/2+cleverapps.styles.FriendRequestView.processButton.noImage.y),this.addChild(i)},createCancelContent:function(){var e=levels.FriendRequest.REQUEST_TYPES[this.model.type],t=cleverapps.styles.FriendRequestView.close;if(!e.noCancel){var n=new cleverapps.UI.Button({button_png:bundles.buttons_main.frames.close_small||bundles.buttons_main.frames.window_close_png,
button_on_png:bundles.buttons_main.frames.close_small_on||bundles.buttons_main.frames.window_close_on_png,onClicked:this.cancel.bind(this)});n.setPositionRound(this.width-n.width/2+t.x,this.height-n.height/2+t.y),n.baseScale=t.scale,n.scale=t.scale,this.addChild(n)}},cancel:function(){this.model.cancel()},process:function(){this.model.process()},removeAnimation:function(){this.runAction(new cc.Sequence(new cc.ScaleTo(.3,0),new cc.CallFunc(this.onRemove),new cc.RemoveSelf))},showAnimation:function(e){this.setScale(0),this.runAction(new cc.Sequence(new cc.DelayTime(e),new cc.ScaleTo(.3,1)))}}),cleverapps.styles.FriendRequestView={width:480,height:166,close:{x:10,y:10,scale:.75},processButton:{width:170,height:60,font:cleverapps.styles.FONTS.BUTTON_SMALL_TEXT,x:20,y:-35,noImage:{x:90,y:-35},text:{y:0}},Request:{x:66,y:28,width:270,height:80,font:cleverapps.styles.FONTS.WINDOW_SMALL_TEXT},Icon:{x:216,y:-30},Avatar:{Margin:{x:25,y:0}}};var FakeRequestSender={load:function(){
cleverapps.config.debugMode&&(FakeRequestSender.REQUEST_PERIOD="1 minute");var e=cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.FAKE_REQUESTS);return e||(e={lastLoadTime:0}),e},save:function(e){e.lastLoadTime=Date.now(),cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.FAKE_REQUESTS,e)},sendIfNeed:function(e){if(0!==cleverapps.friends.listIds().length&&"merge"!==cleverapps.config.type&&!cleverapps.flags.noviral){var t=FakeRequestSender.load(),n=Math.floor((Date.now()-t.lastLoadTime)/cleverapps.parseInterval(FakeRequestSender.REQUEST_PERIOD));if(!(n<=0)){var s=e.notProcessed.filter(function(e){return e.isFake()});n>FakeRequestSender.MAX_REQUESTS-s.length&&(n=FakeRequestSender.MAX_REQUESTS-s.length);var i=!1,o=levels.friendSorter.listActiveFriends();cleverapps.Random.shuffle(o),10<o.length&&(o=o.slice(0,10));for(var r=0;r<o.length&&0<n;r++){var a=o[r];if(!e.existRequestFrom(a.id)){var c=cleverapps.Random.mathChoose(this.listFakeRequestsTypes(e));n--,i=!0,e.notProcessed.push(
levels.FriendRequest.createFriendRequest({id:"__"+Math.floor(1e15*Math.random()),from:a.id,type:c,fake:!0}))}}i&&(e.onNewListener(),FakeRequestSender.save(t),e.save())}}},listFakeRequestsTypes:function(e){var t=[levels.FriendRequest.TYPE_ASK_HELP_LIVE,levels.FriendRequest.TYPE_ASK_HELP_STAR,levels.FriendRequest.TYPE_ASK_HELP_COINS],n=e.listAvailableTypes();return t.filter(function(e){return-1!==n.indexOf(e)})},MAX_REQUESTS:2,REQUEST_PERIOD:"12 hours"},UserResult=function(){this.scores={},this.stars={};var e=cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.RESULT_FIFO);if(e)for(var t=0;t<e.length;t++){var n=e[t].match(/\d+$/);if(n){var s=parseInt(n[0],10);this.loadEpisode(s)}}};UserResult.prototype.isActive=function(e){return!cleverapps.config.editorMode&&(cleverapps.config.results&&HoseEpisode.isFreshEpisode(e))},UserResult.prototype.isEmpty=function(e){return!this.scores[e]||0===Object.keys(this.scores[e]).length},UserResult.prototype.getEpisodeInfo=function(e){return{
scores:this.scores[e]||{},stars:this.stars[e]||{}}},UserResult.prototype.getStarsForLevel=function(e,t){return this.isEmpty(e)?0:this.stars[e][t]||0},UserResult.prototype.getScoresForLevel=function(e,t){return this.isEmpty(e)?0:this.scores[e][t]||0},UserResult.prototype.updateLevel=function(e,t,n,s,i){if(i=i||{},this.isActive(e)){this.scores[e]=this.scores[e]||{},this.stars[e]=this.stars[e]||{};var o=!1;(!this.scores[e][t]||this.scores[e][t]<n)&&(o=!0,this.scores[e][t]=n),(!this.stars[e][t]||this.stars[e][t]<s)&&(o=!0,this.stars[e][t]=s,levels.episodes.episodes&&levels.episodes.episodes[e]&&levels.episodes.episodes[e].levels[t].improveStars(s)),o&&this.saveEpisode(e,i)}},UserResult.ParseLib={parseScores:function(e){var t=JSON.parse(e);return Array.isArray(t)?UserResult.ParseLib.objFromArray(t):t},parseStars:function(e){var t=JSON.parse(e);return"number"==typeof t?UserResult.ParseLib.objFromNumber(t):t},objFromArray:function(e){var n={};return e.forEach(function(e,t){n[t]=e}),n},
objFromNumber:function(e){for(var t={},n=0;n<Episode.LEVELS_PER_EPISODE;n++)t[n]=e%4,e=Math.floor(e/4);return t},objToArray:function(e){for(var t=[],n=0;n<Episode.LEVELS_PER_EPISODE;n++)void 0===e[n]?t.push(0):t.push(e[n]);return t},objToNumber:function(e){for(var t=0,n=1,s=0;s<Episode.LEVELS_PER_EPISODE;s++)void 0!==e[s]&&(t+=n*e[s]),n*=4;return t}},UserResult.GetStoreKey=function(e){return cleverapps.config.prefix+cleverapps.social.getLocalStoragePreffix()+"_result_"+e},UserResult.prototype.saveEpisode=function(e,t){if(t&&t.force);else if(!this.isActive(e))return;var n={scores:this.scores[e],stars:this.stars[e]};cleverapps.DataLoader.save(UserResult.GetStoreKey(e),n,{fifoKey:cleverapps.DataLoaderTypes.RESULT_FIFO,limit:Episode.FRESH_EPISODES}),(!t||t&&!t.skipUpdate)&&cleverapps.synchronizer.addUpdateTask("result")},UserResult.prototype.loadEpisode=function(e,t){if(this.scores[e]={},this.stars[e]={},this.isActive(e)){var n=cleverapps.DataLoader.load(UserResult.GetStoreKey(e));n&&(
this.scores[e]=n.scores,this.stars[e]=n.stars)}},UserResult.prototype.reset=function(e){this.scores[e]={},this.stars[e]={},this.saveEpisode(e,{force:!0})};var Results=function(e){this.data=void 0,this.lastUpdateTime=0,this.episode=e,this.isActive()&&this.load(),this.reload(),this.setReloadTimeout()};Results.prototype.setReloadTimeout=function(){clearTimeout(this.reloadTimeout),this.reloadTimeout=new cleverapps.LongTimeout(function(){this.reload(),this.setReloadTimeout()}.bind(this),1.01*this.calcCacheTime())},Results.prototype.destructor=function(){clearTimeout(this.reloadTimeout)},Results.prototype.isActive=function(){return cleverapps.config.results&&this.episode.isFreshEpisode()},Results.prototype.botResults=function(e){var t=this.episode.getLevelContent(e).score;return[{id:"bot3",avatar:bundles.main.frames.bot_avatar_3,name:"Donuter",score:10*Math.round(.7*t/10)},{id:"bot2",avatar:bundles.main.frames.bot_avatar_2,name:"Lemon Ice",score:10*Math.round(.8*t/10)},{id:"bot1",
avatar:bundles.main.frames.bot_avatar_1,name:"Creamer",score:10*Math.round(1*t/10)}]},Results.prototype.listFriendResults=function(e){if(cleverapps.isLocalhost()){var n=this.episode.getLevelContent(e).score;return cleverapps.friends.listFriends().map(function(e,t){return{id:e.id,avatar:e.avatar,name:e.name,score:Math.round(1*n/10)*(8-t)}})}var s=[];return this.data&&this.data[e]&&this.data[e].forEach(function(e){var t=cleverapps.friends.getById(e.id);t&&s.push({id:e.id,avatar:t.avatar,name:t.name,score:e.score})},this),s},Results.prototype.listTop4=function(e,t){var n=t?[]:this.botResults(e);(n=n.concat(this.listFriendResults(e))).sort(function(e,t){return t.score-e.score});var s=void 0;return cleverapps.userresult.isActive(this.episode.episodeNo)&&(s={id:levels.user.id,avatar:cleverapps.friends.getPlayer().avatar,name:cleverapps.friends.getPlayer().name,score:cleverapps.userresult.getScoresForLevel(this.episode.episodeNo,e)}),n=n.slice(0,s?3:4),s&&(s.player=!0,n.push(s)),n.sort(
function(e,t){return e.score!==t.score?t.score-e.score:e.id===levels.user.id?-1:t.id===levels.user.id?1:0}),n},Results.GetStoreKey=function(e){return cleverapps.config.prefix+cleverapps.social.getLocalStoragePreffix()+"_results_"+e},Results.prototype.reset=function(){this.data=void 0,this.lastUpdateTime=0,this.save(!0)},Results.prototype.save=function(e){!0!==e&&(this.lastUpdateTime=Date.now());var t={data:this.data,when:this.lastUpdateTime};cleverapps.DataLoader.save(Results.GetStoreKey(this.episode.episodeNo),t,{fifoKey:cleverapps.DataLoaderTypes.RESULTS_FIFO,limit:Episode.FRESH_EPISODES}),this.setReloadTimeout()},Results.prototype.load=function(){var e=cleverapps.DataLoader.load(Results.GetStoreKey(this.episode.episodeNo));e&&(this.data=e.data,this.lastUpdateTime=e.when)},Results.prototype.calcCacheTime=function(){return this.episode.episodeNo===levels.user.episode?cleverapps.parseInterval(Results.CACHE_CURRENT_INTERVAL):cleverapps.parseInterval(Results.CACHE_NEAR_INTERVAL)},
Results.prototype.whenFriendListUpdated=function(){if(void 0!==this.data){for(var e in this.data)this.data[e]=this.data[e].filter(function(e){return void 0!==cleverapps.friends.getById(e.id)});this.reload(!0)}else this.reload()},Results.prototype.reload=function(e){this.isActive()&&(void 0!==this.data?(e||this.lastUpdateTime+this.calcCacheTime()<Date.now())&&this.getFromServer():this.getFromServer())},Results.prototype.getFromServer=function(){if(cleverapps.friends.haveData()&&!this.loading){this.loading=!0;var e=function(e){this.loading=!1,this.data={},e.forEach(function(e){var t=e.userId,n=UserResult.ParseLib.parseScores(e.scores);for(var s in n){var i=n[s];void 0===this.data[s]&&(this.data[s]=[]),this.data[s].push({id:t,score:i})}},this),this.episode.isFreshEpisode()&&this.save()}.bind(this),t=cleverapps.friends.listIds();t.length&&(t.join(","),cleverapps.RestClient.get("/results/"+this.episode.episodeNo+"/"+t,{},e,function(e){console.log("Failure loading friends results: ",e)}))}},
Results.CACHE_NEAR_INTERVAL="3 days",Results.CACHE_CURRENT_INTERVAL="1 hour";var Progress=function(){this.data=void 0,this.lastUpdateTime=[0,0],this.load(),this.onUpdated=function(){}};Progress.prototype.init=function(){this.reload(!0),setInterval(this.reload.bind(this),cleverapps.parseInterval(Progress.CHECK_INTERVAL))},Progress.TYPE_NEAR=0,Progress.TYPE_FAR=1,Progress.FILTER_FRIENDS=2,Progress.RESET=3,Progress.CHECK_INTERVAL="12 hours",Progress.CACHE_INTERVAL=["1 day","3 day"],Progress.STUCK_INTERVAL="5 day",Progress.STUCK_HELP_INTERVAL="14 days",Progress.prototype.reset=function(){this.lastUpdateTime=[0,0],this.data=void 0,this.save(Progress.RESET)},Progress.prototype.listByEpisode=function(t){return this.data?this.data.filter(function(e){return e.episode===t}):[]},Progress.getType=function(e){return 1<Math.abs(e.episode-levels.user.episode)?Progress.TYPE_FAR:Progress.TYPE_NEAR},Progress.prototype.listIds=function(e){var t=(this.data?this.data.filter(function(e){
return Progress.getType(e)===Progress.TYPE_FAR}):[]).map(function(e){return e.id}),n=cleverapps.friends.listIds();return e===Progress.TYPE_NEAR?n.filter(function(e){return-1===t.indexOf(e)}):n.filter(function(e){return-1!==t.indexOf(e)})},Progress.GetStoreKey=function(){return cleverapps.config.prefix+cleverapps.social.getLocalStoragePreffix()+"_progress"},Progress.prototype.save=function(e){e!==Progress.FILTER_FRIENDS&&e!==Progress.RESET&&(this.lastUpdateTime[e]=Date.now());var t={data:this.data,last:this.lastUpdateTime};cleverapps.DataLoader.save(Progress.GetStoreKey(),t),this.onUpdated()},Progress.prototype.load=function(){var e=cleverapps.DataLoader.load(Progress.GetStoreKey());e&&(this.data=e.data,this.lastUpdateTime=e.last||[0,0])},Progress.prototype.whenFriendListUpdated=function(){if(this.data){var t=cleverapps.friends.listIds();this.data=this.data.filter(function(e){return-1!==t.indexOf(e.id)}),this.save(Progress.FILTER_FRIENDS),this.reload(!0)}else this.reload()},
Progress.prototype.reload=function(e){if(!this.data)return this.getFromServer(Progress.TYPE_NEAR),void this.getFromServer(Progress.TYPE_FAR);(e||this.lastUpdateTime[Progress.TYPE_NEAR]+cleverapps.parseInterval(Progress.CACHE_INTERVAL[Progress.TYPE_NEAR])<Date.now())&&this.getFromServer(Progress.TYPE_NEAR),this.lastUpdateTime[Progress.TYPE_FAR]+cleverapps.parseInterval(Progress.CACHE_INTERVAL[Progress.TYPE_FAR])<Date.now()&&this.getFromServer(Progress.TYPE_FAR)},Progress.prototype.getLeaders=function(){var e=[];if(!this.data)return e;for(var t=0;t<this.data.length;t++)cleverapps.friends.getById(this.data[t].id)&&e.push({id:this.data[t].id,rating:cleverapps.humanReadableNumber(this.data[t].episode,this.data[t].level)+(this.data[t].progress||0),name:cleverapps.friends.getById(this.data[t].id).name,avatar:cleverapps.friends.getById(this.data[t].id).avatar});return e.sort(function(e,t){return t.rating-e.rating}),cleverapps.config.leagues&&e.forEach(function(e){e.league=Progress.getLeague(
e.rating)}),e},Progress.getLeague=function(e){var t=cleverapps.config.leagues;if(!t)return 0;for(var n=0;n<t.length;n++){var s=t[n];if(!1===s||e<=s)return n}return t.length-1},Progress.prototype.getStuckFriendsFake=function(){return cleverapps.friends.listFriends().map(function(e,t){return{id:e.id,name:e.name,avatar:e.avatar,episode:2*(t+1),level:t+3}})},Progress.prototype.getStuckFriends=function(){if(cleverapps.isLocalhost())return this.getStuckFriendsFake();var s=[];if("merge"===cleverapps.config.type)return s;if(!this.data||this.updateInProgress)return s;var i=Date.now();return this.data.forEach(function(e){var t=e.updateTime||i;if(!(e.helpTime&&e.helpTime+cleverapps.parseInterval(Progress.STUCK_HELP_INTERVAL)>i)){var n=cleverapps.friends.getById(e.id);n&&t+cleverapps.parseInterval(Progress.STUCK_INTERVAL)<i&&s.push({id:e.id,name:n.name,avatar:n.avatar,episode:e.episode,level:e.level})}}.bind(this)),s.sort(function(e,t){
return e.episode!==t.episode?t.episode-e.episode:t.level-e.level}),s.slice(0,3)},Progress.prototype.sendStuckFriendsHelp=function(e,t){var n=e.map(function(e){return e.id});cleverapps.social.sendRequest(n,"stuckHelpGold",function(){n.forEach(function(e){cleverapps.friends.inApp(e)&&levels.friendRequests.sendServerRequest(e,levels.FriendRequest.TYPE_STUCK_HELP_COINS)}),this.data.forEach(function(e){-1!==n.indexOf(e.id)&&(e.helpTime=Date.now())}),this.save(Progress.FILTER_FRIENDS),t()}.bind(this))},Progress.prototype.getFromServer=function(n){var s=this.listIds(n);if(0!==s.length){var e=function(e){this.updateInProgress=!1;var t=cleverapps.friends.listIds();this.data||(this.data=[]);var c={};this.data.forEach(function(e){c[e.id]=e}),this.data=this.data.filter(function(e){return-1!==t.indexOf(e.id)&&-1===s.indexOf(e.id)}),e.forEach(function(e){var t=e.id,n=e.episode,s=e.level,i=e.progress;n>=levels.episodes.getAmountEpisodes()&&(n=levels.episodes.getAmountEpisodes()-1,
s=Episode.LEVELS_PER_EPISODE-1);var o=c[e.id],r=Date.now();o&&o.updateTime&&o.episode===n&&o.level===s&&o.progress===i&&(r=o.updateTime);var a={id:t,episode:n,level:s,progress:i,updateTime:r};o&&o.helpTime&&(a.helpTime=o.helpTime),this.data.push(a)},this),this.save(n)}.bind(this),t=s.join(",");this.updateInProgress=!0,cleverapps.RestClient.get("/progress/"+t,{},e,function(e){console.log("Failure loading friends progress: ",e)})}},levels.EpisodesScene=MainScene.extend({ctor:function(){this._super(),this.customize(),new levels.EpisodesController(this.scene),PlayButton.IsAvailable()&&(this.scene.playButton=new PlayButtonView,this.scene.addChild(this.scene.playButton),this.scene.playButton.addFingerTip())},customize:function(){}}),cleverapps.styles.EpisodesScene={},levels.EpisodesScene.BUNDLES=function(){for(var e=[],t=[],n=0;n<cleverapps.styles.PagesView.visiblePages;n++){e.push("episode_"+(levels.user.episode+n));var s="episode_"+(levels.user.episode+n)+"_external";bundles[s]&&(
cc.sys.isNative?t=t.concat(bundles[s].urls):e.push(s))}return t.forEach(function(e){cc.loader.load(e)}),e};var Episode=function(e,t,n){n=n||{},this.episodeNo=e,this.levelNo=t,this.type=n.type?n.type:Episode.TypeValues[e]?e:Episode.Types.REGULAR,this.copyData=n.copyData,this.onLoadListener=function(){},this.onRemoveListener=function(){},this.whenLoadedListeners=[],this.init()};Episode.prototype.isComingSoon=function(){return this.episodeNo===Episodes.getAmountEpisodes()},Episode.prototype.init=function(){this.loaded=!1,this.levelsPerEpisode=bundles[this.bundleId()].levelsAmount,(this.isComingSoon()||void 0!==this.levelNo)&&(this.levelsPerEpisode=1);var e=void 0!==this.levelNo?[this.levelNo]:cleverapps.rangeArray(0,this.levelsPerEpisode-1);this.levels=e.map(function(e){var t=cleverapps.userresult.getStarsForLevel(this.episodeNo,e);return new Level(this,e,t)}.bind(this))},Episode.prototype.getLevel=function(e){return void 0!==this.levelNo&&(e=0),this.levels[e]},
Episode.prototype.isRegular=function(){return this.type===Episode.Types.REGULAR},Episode.prototype.getCurrentLevel=function(){for(var e in this.levels){var t=this.levels[e];if(t.type===Level.TYPE_CURRENT)return t}},Episode.prototype.whenLoaded=function(e,t){this.loaded?e(this):(t||cleverapps.bundleLoader.addBlockWindow(),this.whenLoadedListeners.push(function(){cleverapps.bundleLoader.removeBlockWindow(),e(this)}.bind(this)))},Episode.prototype.isPassed=function(){return levels.user.episode>this.episodeNo},Episode.prototype.isCurrent=function(){return levels.user.episode===this.episodeNo},Episode.prototype.destructor=function(){this.loadTask&&this.loadTask.cancel(),this.loadDataStarted&&cleverapps.bundleLoader.deleteBundle(this.bundleId()),this.onRemoveListener(),this.deleted=!0},Episode.BundleId=function(e,t){t=t||cleverapps.settings.language;var n="episode_"+e;return"board"===cleverapps.config.type&&"en"!==t&&(n+="_"+t),n},Episode.prototype.bundleId=function(){
return this.episodeNo===Episodes.getAmountEpisodes()?"episode_coming_soon":Episode.BundleId(this.episodeNo)},Episode.prototype.finishWait=function(){this.waitCounter--,0===this.waitCounter&&this.onceLoaded()},Episode.prototype.loadData=function(){if(this.loadDataStarted||this.deleted)return cleverapps.NO_ACTION;this.loadDataStarted=!0,this.loadDataInt()},Episode.prototype.loadDataInt=function(){this.waitCounter=1,this.loadTask=new SuccessWait(function(e){cleverapps.bundleLoader.loadBundle(this.bundleId(),e)}.bind(this),this.finishWait.bind(this))},Episode.prototype.onceLoaded=function(){this.loaded=!0,this.onLoadListener&&this.onLoadListener(),this.whenLoadedListeners.forEach(cleverapps.callFunc),this.whenLoadedListeners=[]},Episode.prototype.getHardLevels=function(){return this.getBundle().hard||[]},Episode.prototype.getTrickyLevels=function(){return this.getBundle().tricky||[]},Episode.prototype.getBundle=function(){return bundles[this.bundleId()]},
Episode.prototype.getContent=function(){return this.content||(this.content=cc.loader.getRes(this.getBundle().jsons.levels),this.copyData&&(this.content=JSON.parse(JSON.stringify(this.content)))),this.content},Episode.prototype.getLevels=function(){var e=this.getContent();return Array.isArray(e)?e:e.levels},Episode.prototype.isDebug=function(){return this.getContent().debug},Episode.prototype.getHashes=function(){var n={};return this.getLevels().forEach(function(e,t){cleverapps.extend(n,this.getLevelHashes(t))}.bind(this)),n},Episode.prototype.getLevelHashes=function(s){var i={},o=this.getLevelVersions(s);return Object.keys(o).map(cleverapps.castType).sort().forEach(function(e){var t=o[e],n=Level.CalcHash(t);i[n]={levelNo:s,version:e,hash:n}}),i},Episode.prototype.getLastVersionHashes=function(){return this.levels.map(function(e){var t=this.getLevelContent(e.levelNo);return Level.CalcHash(t)},this)},Episode.prototype.getLevelVersions=function(e){var t=this.getLevels()
;t&&t[e]||cleverapps.ReportStream.debug("No levels for episode "+this.episodeNo+" level "+e);var n=t[e];Array.isArray(n)||(n=[n]);var s={};return n.forEach(function(e,t){var n=e.version||t;s[n]=e}),s},Episode.prototype.getMaxVersion=function(e){var t=0;for(var n in e)t=Math.max(t,parseInt(n));return t},Episode.prototype.getLevelContent=function(e){var t=this.getLevelVersions(e),n=this.getMaxVersion(t);cleverapps.config.editorMode&&void 0!==LevelManager.getInstance().version&&!cleverapps.environment.isMainScene()&&(n=LevelManager.getInstance().version);var s=t[n];return s.episodeNo=this.episodeNo,s.levelNo=e,s.version=n,s},Episode.prototype.isDailyCup=function(){return this.type===Episode.Types.DAILYCUP},Episode.prototype.isBonusRound=function(){return this.type===Episode.Types.BONUSROUNDS},Episode.prototype.isDailyLevel=function(){return this.type===Episode.Types.DAILY_LEVELS},Episode.prototype.isBonusWorldLevel=function(){return this.type===Episode.Types.BONUS_WORLD},
Episode.LevelChooseAlgorithm=function(e){var t=e.start,n=e.finish||levels.episodes.getAmountEpisodes(),s=e.seed,i=t*Episode.LEVELS_PER_EPISODE,o=n*Episode.LEVELS_PER_EPISODE-1,r=cleverapps.Random.random(i,o,s);return{levelNo:r%Episode.LEVELS_PER_EPISODE,episodeNo:Math.floor(r/Episode.LEVELS_PER_EPISODE)}},Episode.LEVELS_PER_EPISODE=15,Episode.Types={REGULAR:"regular",BONUSROUNDS:"bonusrounds",EDITOR:"editor",DAILY_LEVELS:"daily_levels",DAILYCUP:"dailycup",BONUS_WORLD:"bonus_world",ADS:"ads"},Episode.TypeValues=cleverapps.createSet(cleverapps.values(Episode.Types));var HoseEpisode=function(e){Episode.apply(this,arguments),this.onAnimatePass=void 0,this.onAnimateOpen=void 0,this.onExternalLoadListener=function(){}};HoseEpisode.prototype=Object.create(Episode.prototype),(HoseEpisode.prototype.constructor=HoseEpisode).prototype.currentLevelPosition=function(e){var t=cleverapps.styles.LevelView[this.getBundle().levelPositions||"levels_1"];return t&&t[e]},HoseEpisode.prototype.init=function(
){Episode.prototype.init.call(this,arguments),this.externalLoaded=!1,cleverapps.userresult.loadEpisode(this.episodeNo),this.friendsResults=new Results(this),this.updateProgress()},HoseEpisode.prototype.updateProgress=function(){var t=[],s={};this.levels.forEach(function(e,t){e.players.forEach(function(e){s[e]=t})});var e=levels.progress.listByEpisode(this.episodeNo),n=[];e.forEach(function(e){e.level!==s[e.id]&&t.push(e),n.push(e.id)}),t.forEach(function(e){var t=this.levels[s[e.id]];t&&t.removePlayer(e.id);var n=this.levels[e.level];n?n.insertPlayer(e.id):console.log("No level for player: "+e.id+" at "+e.level)},this),Object.keys(s).forEach(function(e){if(-1===n.indexOf(e)){var t=this.levels[s[e]];t&&t.removePlayer(e)}},this)},HoseEpisode.prototype.isFirstNotInShadow=function(){return!!this.isAvailableToPlay()&&cleverapps.user.episode-this.episodeNo==Episode.FRESH_EPISODES-1},HoseEpisode.prototype.destructor=function(){this.externalLoadTask&&this.externalLoadTask.cancel(),
this.friendsResults&&this.friendsResults.destructor(),this.loadDataStarted&&(cleverapps.bundleLoader.deleteBundles(this.listRpgBundles()),cleverapps.bundleLoader.deleteBundle(this.bundleExternalId())),Episode.prototype.destructor.apply(this,arguments)},HoseEpisode.prototype.bundleExternalId=function(){return this.bundleId()+"_external"},HoseEpisode.prototype.listRpgBundles=function(){var n=[];return!cleverapps.config.rpg||"number"!=typeof this.episodeNo||this.episodeNo>=Episodes.getAmountEpisodes()?n:(n.push(this.getIslandBundleId()),"runes"!==cleverapps.config.name||this.isPassed()||!cleverapps.styles.IslandEnemies[this.episodeNo]||cleverapps.styles.IslandEnemies[this.episodeNo].forEach(function(e){var t=cleverapps.Spine.jsonToBundle[e.enemy];t&&bundles[t]&&n.push(t)}),n)},HoseEpisode.WAIT_FOR_EXTERNAL_TIMEOUT=3e3,HoseEpisode.prototype.waitExternal=function(){this.waitExternalTimeout=void 0,this.finishWait()},HoseEpisode.prototype.loadDataInt=function(){this.waitCounter=1,
this.getExternalBundle()&&!this.externalLoaded&&(this.waitCounter++,this.waitExternalTimeout=setTimeout(this.waitExternal.bind(this),Episode.WAIT_FOR_EXTERNAL_TIMEOUT),this.externalLoadTask=new SuccessWait(function(e){cleverapps.bundleLoader.loadBundle(this.bundleExternalId(),e)}.bind(this),this.onceExternalLoaded.bind(this))),this.loadTask=new SuccessWait(function(e){var t=[this.bundleId()].concat(this.listRpgBundles());cleverapps.bundleLoader.loadBundles(t,e)}.bind(this),this.finishWait.bind(this))},HoseEpisode.prototype.onceExternalLoaded=function(){this.externalLoaded=!0,this.loaded&&this.onExternalLoadListener&&this.onExternalLoadListener(),this.waitExternalTimeout&&(clearTimeout(this.waitExternalTimeout),this.finishWait())},HoseEpisode.prototype.onceLoaded=function(){Episode.prototype.onceLoaded.apply(this,arguments),(this.getExternalBundle()&&this.externalLoaded||!this.getExternalBundle())&&this.onExternalLoadListener&&this.onExternalLoadListener()},
HoseEpisode.prototype.getIslandBundleId=function(){return"episode_"+Math.floor(this.episodeNo/10)+"_island"},HoseEpisode.prototype.getIslandBundle=function(){return bundles[this.getIslandBundleId()]},HoseEpisode.prototype.getExternalBundle=function(){if(cleverapps.metha.getType()===Metha.HOSE)return bundles[this.bundleExternalId()]},HoseEpisode.prototype.animatePass=function(e){this.onAnimatePass?this.onAnimatePass(e):e()},HoseEpisode.prototype.animateOpen=function(e){this.onAnimateOpen?this.onAnimateOpen(e):e()},HoseEpisode.isFreshEpisode=function(e){return e>=cleverapps.user.episode-HoseEpisode.FRESH_EPISODES+1&&e<=cleverapps.user.episode},HoseEpisode.prototype.isFreshEpisode=function(){return HoseEpisode.isFreshEpisode(this.episodeNo)},HoseEpisode.prototype.isAvailableToPlay=function(){return!!cleverapps.config.editorMode||(cleverapps.config.results?this.isFreshEpisode():levels.user.episode>=this.episodeNo)},HoseEpisode.FRESH_EPISODES=3;var EpisodesManager={create:function(){switch(
cleverapps.config.name){case"riddles":case"runes":case"adventure":case"crocword":return new HoseEpisodes}return new FakeEpisodes}},Episodes=function(){this.getAmountEpisodes=Episodes.getAmountEpisodes,this.onResetListener=function(){}};Episodes.prototype.reset=function(){delete Episodes.amountEpisodes,this.onResetListener()},Episodes.getAmountEpisodes=function(){return void 0===Episodes.amountEpisodes&&(Episodes.amountEpisodes=Episodes.calcAmountEpisodes()),Episodes.amountEpisodes},Episodes.calcAmountEpisodes=function(){for(var e=0;void 0!==bundles[Episode.BundleId(e)];){var t=bundles[Episode.BundleId(e)];if(!t.jsons||!t.jsons.levels)break;e++}return e};var HoseEpisodes=function(){Episodes.call(this),this.episodes={},this.onAddEpisode=function(e){},levels.user.onLevelStatusChanged=function(e,t){var n=this.episodes[e];n&&n.levels[t].update()}.bind(this);var e={};cc.sys.isNative&&"match3"===cleverapps.config.type&&(e={amount:cleverapps.styles.PagesView.visiblePages+2,
interval:"2 seconds",delay:"2 seconds"}),this.loadEpisodesExecutor=new ExecutorPool(e),cleverapps.config.results&&cleverapps.friends.addFriendsUpdatedListener(function(){for(var e in this.episodes){this.episodes[e].friendsResults.whenFriendListUpdated()}}.bind(this)),cleverapps.friends.addFriendsUpdatedListener(function(){levels.progress.whenFriendListUpdated()}),levels.progress.onUpdated=function(){for(var e in this.episodes){this.episodes[e].updateProgress()}}.bind(this),cleverapps.metha.getType()===Metha.HOSE&&this.reset()};HoseEpisodes.prototype=Object.create(Episodes.prototype),(HoseEpisodes.prototype.constructor=HoseEpisodes).prototype.gamePlayed=function(e,t){},HoseEpisodes.prototype.getActiveEpisode=function(){var e=levels.user.getCurrentLevel(),t=this.episodes[e.episodeNo];return t||(this.addEpisode(e.episodeNo),(t=this.episodes[e.episodeNo]).loadData()),t},HoseEpisodes.prototype.wantsToPlay=function(e,t){var n=this.getActiveEpisode().getLevel(levels.user.getCurrentLevel(
).levelNo);cleverapps.Plot.isPassedAllEpisodes=levels.user.isPassedAll(),((t=t||{}).playNext||t.dailyTask||t.mission||LevelStartWindow.isAvailable(n.episode.episodeNo,n.levelNo))&&BoostersBefore.isAvailable()?cleverapps.metha.compound(e,[function(e){t.playNext?cleverapps.Plot.GameLeave(e,t):e()},function(e){cleverapps.metha.showControlsWhileFocused("MenuBarGoldItem"),new LevelStartWindow({level:n}),cleverapps.metha.onceNoWindowsListener=e}]):(cleverapps.metha.showControlsWhileFocused("mainTableView"),n.play(e))},HoseEpisodes.prototype.reset=function(){for(var e in delete this.currentEpisode,this.episodes)this.removeEpisode(e);this.episodes={},Episodes.prototype.reset.apply(this,arguments)},HoseEpisodes.prototype.addEpisode=function(e){var t=new HoseEpisode(e);this.episodes[e]=t,this.onAddEpisode(t)},HoseEpisodes.prototype.removeEpisode=function(e){this.episodes[e].destructor(),delete this.episodes[e]},HoseEpisodes.prototype.getCurrentEpisode=function(){
return this.episodes[this.currentEpisode]},HoseEpisodes.prototype.loadCurrentEpisode=function(e){var t=[this.getCurrentEpisode()];cleverapps.styles.PagesView.noAutoScroll&&this.episodes[this.currentEpisode+1]&&t.push(this.episodes[this.currentEpisode+1]);var n=cleverapps.wait(t.length,e);t.forEach(function(e){e.whenLoaded(n)})},HoseEpisodes.prototype.range=function(e,t,n){return cleverapps.rangeArray(e+t,e+n).filter(function(e){return 0<=e&&e<=this.getAmountEpisodes()}.bind(this))},HoseEpisodes.prototype.setCurrentEpisode=function(t){void 0===(t=parseInt(t))&&(t=levels.user.episode),t>=this.getAmountEpisodes()&&(t=this.getAmountEpisodes()),this.currentEpisode=t;var e,n,s=Object.keys(this.episodes).map(function(e){return parseInt(e)});if(this.currentEpisode<0)e=s.concat(s.indexOf(this.currentEpisode)<0?[this.currentEpisode]:[]).filter(function(e){return 0<=e||e===t}),n=[t];else{var i=cleverapps.styles.PagesView.visiblePages;e=this.range(t,-1,i+1),n=this.range(t,
cleverapps.styles.PagesView.prevEpisodeShowed?-1:0,i)}cleverapps.substract(s,e).forEach(function(e){this.removeEpisode(e)},this),cleverapps.substract(e,s).forEach(function(e){this.addEpisode(e)},this),n.forEach(function(e){this.loadEpisodesExecutor.execute(function(){return this.episodes[e]?this.episodes[e].loadData():cleverapps.NO_ACTION}.bind(this))},this)},HoseEpisodes.prototype.nextEpisode=function(){this.currentEpisode+cleverapps.styles.PagesView.visiblePages<=this.getAmountEpisodes()&&this.setCurrentEpisode(this.currentEpisode+1)},HoseEpisodes.prototype.prevEpisode=function(){return 0<this.currentEpisode&&(this.setCurrentEpisode(this.currentEpisode-1),!0)};var FakeEpisodes=function(){Episodes.call(this)};FakeEpisodes.prototype=Object.create(Episodes.prototype),(FakeEpisodes.prototype.constructor=FakeEpisodes).prototype.setCurrentEpisode=function(){},FakeEpisodes.prototype.getCurrentEpisode=function(){};var CloudsAnimation=cc.Node.extend({ctor:function(){this._super(),
this.setLocalZOrder(101);var e=this.animation=new cleverapps.Spine(bundles.main.jsons.episode_clouds_spine_json);if(this.addChild(e),this.inUse=!0,cleverapps.styles.EpisodeView.text){var t=cleverapps.UI.generateTTFText("messages:LoadingEpisode",cleverapps.styles.FONTS.EPISODE_CLOUD_TEXT);t.setPositionRound(cleverapps.styles.EpisodeView.text.x,cleverapps.styles.EpisodeView.text.y),t.setDimensions(.5*cleverapps.UI.getSceneSize().width,0),t.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER),this.addChild(t),(this.text=t).setAnchorPoint2()}},startLoadAnimation:function(e){this.animation.setAnimation(0,"idle",!0),this.setVisible(!1),this.runAction(new cc.Sequence(new cc.DelayTime(.1),new cc.CallFunc(function(){this.visible=e.isRunningSafe()&&e.visible,this.text&&this.text.runAction(new cc.FadeIn(.3))}.bind(this))))},finishLoadAnimation:function(e){this.animation.setAnimation(0,"open",!1),this.animation.setCompleteListener(function(){this.finishAnimation(e)}.bind(this)),this.text&&(
this.text.stopAllActions(),this.text.runAction(new cc.FadeOut(.7)))},finishAnimation:function(e){this.inUse&&(this.inUse=!1,cc.pool.putInPool(this),"function"==typeof e&&e())},unuse:function(){this.animation.visible=!1,this.animation.setCompleteListener(function(){}),this.animation.setStartVisibleListener(function(){}),this.removeFromParent()},reuse:function(){this.inUse=!0}});CloudsAnimation.factory=function(){return cc.pool.hasObject(CloudsAnimation)?cc.pool.getFromPool(CloudsAnimation):new CloudsAnimation},levels.EpisodesController=function(n){var e=levels.episodes.currentLevel,t=levels.episodes.getCurrentEpisode();t||(levels.episodes.setCurrentEpisode(levels.user.episode),t=levels.episodes.getCurrentEpisode());var s=t.episodeNo;(cleverapps.user.episode<s||!t.isAvailableToPlay()&&!t.isComingSoon())&&(e=s=void 0),void 0===s&&(s=levels.user.episode),void 0===e&&(e=s===levels.user.episode?levels.user.level:0),levels.episodes.changeEpisodeAnimation&&(s=levels.user.episode-1,
e=Episode.LEVELS_PER_EPISODE-1),levels.episodes.currentEpisode!==s&&levels.episodes.setCurrentEpisode(s);var i=new PagesView({currentLevelPos:levels.episodes.episodes[s].currentLevelPosition(e),disableLevelScroll:levels.episodes.disableLevelScroll,beginPage:s,amountPages:levels.episodes.getAmountEpisodes()+1,swallowTouches:!0});i.setLocalZOrder(-1),cleverapps.styles.EpisodeView.parallaxContainer?n.parallaxContainer.addChild(i):n.addChild(i),cleverapps.styles.EpisodesScene.hidable&&(cleverapps.UI.makeHideable(i),cleverapps.metha.registerControl("mainTableView",i)),n.updateBackgroundScale=function(){i.updateParallaxBackgroundsScale()};var o=function(e){if(i.autoScroll){var t=i.currentPage!==levels.episodes.currentEpisode;i.currentPage=levels.episodes.currentEpisode,i.scrollToCurrentPage(!1,t,e)}};levels.episodes.scrollToCurrentLevel=function(){i.scrollToCurrentLevel(!1)},levels.episodes.scrollToCurrentEpisode=function(e,t,n){i.currentPage=levels.episodes.currentEpisode,
i.scrollToCurrentPage(e,t,n,levels.episodes.currentEpisode)};var r=function(){};for(var a in i.onScrolledToCurrentPage=function(){cleverapps.bundleLoader.clearUnusedResources(),r()},levels.episodes.gotoNextEpisode=function(e,t,n){r=function(){r=function(){},e()},i.autoScroll?(levels.episodes.nextEpisode(),o(t)):i.scrollToCurrentPage(!1,!0,t,void 0!==n?n:levels.episodes.currentEpisode+1)},levels.episodes.gotoPrevEpisode=function(e){i.autoScroll?(levels.episodes.prevEpisode(),o(e)):i.scrollToCurrentPage(!1,!0,e,levels.episodes.currentEpisode-1)},i.onNextPageListener=function(){levels.episodes.nextEpisode(),o()}.bind(this),i.onPrevPageListener=function(){levels.episodes.prevEpisode(),o()}.bind(this),this.addPage=function(e){if(e.isComingSoon()){var t=new ComingSoonEpisodeView(e,n);i.addPage(t)}else if(0<=e.episodeNo){t=new EpisodeView(e,n);i.addPage(t)}},levels.episodes.onAddEpisode=i.createListener(this.addPage),levels.episodes.episodes)this.addPage(levels.episodes.episodes[a])
;this.customize()},levels.EpisodesController.prototype.customize=function(){};var PagesView=PagingScrollView.extend({ctor:function(e){this.options=e;var t=cleverapps.UI.getSceneSize(),n=cleverapps.styles.PagesView;this.currentLevelPos=e.currentLevelPos,this.disableLevelScroll=e.disableLevelScroll;var s="scene"===n.pageWidth?t.width:n.pageWidth,i="scene"===n.pageHeight?t.height:n.pageHeight;this._super({beginPage:e.beginPage,amountPages:e.amountPages,swallowTouches:e.swallowTouches,noWheelScroll:e.noWheelScroll,styles:n,pageWidth:s,pageHeight:i}),this.setAnchorPoint(.5,.5);var o="scene"===n.width?t.width:n.width,r="scene"===n.height?t.height:n.height;this.setContentSize(o,r),this.calcFirstOffset(),this.parallax=new PagesViewParallax(n.parallax,this.container,n.direction),n["3d"]&&this.scheduleUpdate();var a=cleverapps.styles.PagesView.maxWidth;a&&a<o&&this.setScale(o/a)},updateParallaxBackgroundsScale:function(){this.parallax.updateScale()},update:function(e){if(this._super(e),
cleverapps.styles.PagesView["3d"]){var r,a=cleverapps.styles.PagesView["3d"];r=cleverapps.wideMode.mode===cleverapps.WideMode.VERTICAL?a.mobileScales:a.scales,this.getVisiblePages().forEach(function(e){var t=this.height,n=-this.container.y,s=(t-(e.y-n)+this.pageHeight/2)/t,i=(s=s<1?s:1)*r[1]+r[0],o=i;a.horizont&&(o=s*r[1]+(s*(1-a.horizont.scale)+a.horizont.scale)*r[0]),e.setScale(i,o),e.setLocalZOrder(-e.pageNo)}.bind(this))}},scrollToCurrentLevel:function(e){this.autoScroll||!this.currentLevelPos||this.disableLevelScroll&&e||this.scrollToPositionInPage(this.currentLevelPos,e)},showAnimation:function(e,t){if(this.stopAllActions(),e)return this.visible=!0,void this.setScale(1);this.getPages().forEach(function(e){e.setVisible(this.currentPage===e.pageNo)}.bind(this)),this.visible=!0,this.runAction(new cc.Sequence(new cc.DelayTime(t||0),new cc.ScaleTo(.25,1),new cc.CallFunc(function(){this.showCurrentPageOnly()}.bind(this))))},hideAnimation:function(e,t){if(this.stopAllActions(),e
)return this.setScale(0),void(this.visible=!1);this.getPages().forEach(function(e){e.setVisible(this.currentPage===e.pageNo)}.bind(this)),this.runAction(new cc.Sequence(new cc.DelayTime(t||0),new cc.ScaleTo(.15,0),new cc.CallFunc(function(){this.visible=!1}.bind(this))))},onEnter:function(){this._super(),this.customize(),this.scrollToCurrentPage(!0),this.scrollToCurrentLevel(!0)},customize:function(){this.setPosition(this.width/2,this.height/2+30*resolutionScale)}});cleverapps.styles.PagesView={direction:PagingScrollView.DIRECTIONS.Horizontal,height:1200,width:"scene",visiblePages:1,prevEpisodeShowed:!1,pageHeight:1200,pageWidth:"scene","3d":!1,parallax:{speed:[0,.15],zIndex:[-1e3,-999],layers:[1,2,2],bundle:"episodes_spines",width:"scene",height:"scene"}};var EpisodeView=cc.Node.extend({ctor:function(e,t){this._super(),this.episode=e,this.pageNo=e.episodeNo,this.levels=[],this.setAnchorPoint(.5,.5),(this.episode.currentView=this).episodesScene=t;var n=cleverapps.UI.getSceneSize(),
s=cleverapps.styles.EpisodeView.height,i=cleverapps.styles.EpisodeView.offsetEpisodes?-cleverapps.UI.getSceneOffsetY():0;cleverapps.styles.EpisodeView.direction===cleverapps.UI.VERTICAL?(this.setPositionRound(n.width/2,s*(e.episodeNo+.5)+i),this.bgScale=(s+cleverapps.styles.EpisodeView.addPixels)/s):(this.setPosition(n.width*(e.episodeNo+.5),s/2),this.bgScale=(n.width+cleverapps.styles.EpisodeView.addPixels)/n.width),this.isCustomBackground()||this.addDefaultBackground(),e.onLoadListener=this.createListener(this.onLoad.bind(this)),e.getExternalBundle()&&e.externalLoaded&&e.loaded||!e.getExternalBundle()&&e.loaded?this.onExternalLoad():e.onExternalLoadListener=this.createListener(this.onExternalLoad.bind(this)),e.onRemoveListener=this.createListener(this.onDelete.bind(this)),this.setLocalZOrder(-e.episodeNo),this.updateScale()},customize:function(){},updateScale:function(){var e=cleverapps.styles.EpisodeView;if(e.scale)this.setScale(e.scale);else{var t=cleverapps.UI.getSceneSize(
).width/(e.Background.width+e.padding);(t=Math.max(e.minScale,t))<1&&this.setScale(t)}this.baseScale=this.scale},onShow:function(){this.episode.loaded?this.onLoad():this.startLoadAnimation()},onDelete:function(){this.removeLoadAnimation(),this.removeNotOpennedAnimation(),this.removeFromParent()},addBetweenEpisodesFlag:function(){var e=cleverapps.styles.LevelView;if(e.betweenEpisodesFlag&&(e=e.betweenEpisodesFlag)[this.episode.getBundle().levelPositions]){var t=this.episode.bundleId(),n=e[this.episode.getBundle().levelPositions];if(!1!==n[t]){var s=new cleverapps.Spine(e.spine);s.setPositionRound(n[t]?n[t]:n.default),s.setAnimation(0,this.episode.episodeNo<levels.user.episode?e.passed:e.notpassed,!0),this.addChild(s)}}},onLoad:function(){this.addDescription(),this.finishLoadAnimation(),this.levelViews=[],cleverapps.config.rpg||(this.levelViews=this.episode.levels.map(function(e){var t=LevelView;cleverapps.config.editorMode&&(t=LevelViewEditor);var n=new t(e,this);return this.addChild(n)
,n},this)),this.addBetweenEpisodesFlag(),this.addPlayerAvatar(),this.addFingerTip(),this.addTitle(),this.customize(),this.episode.getExternalBundle()&&!this.episode.externalLoaded&&this.addDefaultBackground()},onExternalLoad:function(){this.addSpines(),this.addIsland(),this.addBackground()},addTitle:function(){if("undefined"==typeof match3){var e={episodeNo:this.episode.episodeNo+1},t=cleverapps.styles.EpisodeView.title,n="messages:EpisodeView.Title";if(this.episode.isComingSoon()&&(n="messages:EpisodeView.ComingSoonTitle"),t.bg){var s=cleverapps.UI.createScale9Sprite(t.bg.image);this.addChild(s),s.setPositionRound(t.bg),s.setContentSize2(t.bg)}var i=this.title=cleverapps.UI.generateTTFText(n,cleverapps.styles.FONTS.EPISODE_TITLE_TEXT,e);i.y=t.y,this.addChild(i,1)}},addDescription:function(){if("board"===cleverapps.config.type&&"stacks"!==cleverapps.config.subtype){var e,t=cleverapps.styles.EpisodeView;if(this.episode.isComingSoon())(e=cleverapps.UI.generateTTFText(
"messages:EpisodeView.ComingSoonDescription",cleverapps.styles.FONTS.DESCRIPTION_TEXT)).fitTo(.9*t.Background.width);else{for(var n=100,s=0,i=0;i<this.episode.levelsPerEpisode;i++){var o=this.episode.getLevelContent(i);n=Math.min(n,o.base.length),s=Math.max(s,o.base.length)}var r=Math.round(n/3+s/2-2);r<1&&(r=1),5<r&&(r=5),r=this.formatDifficulty(r);var a=n+" - "+s;n===s&&(a=n),e=cleverapps.UI.generateTTFText("messages:EpisodeView.Description",cleverapps.styles.FONTS.DESCRIPTION_TEXT,{letters:a,difficulty:r})}(this.description=e).y=t.description.y,this.addChild(e)}},isCustomBackground:function(){return this.episode.getExternalBundle()||this.episode.getBundle().urls.background},addBackground:function(){var e=this.episode.getExternalBundle()&&this.episode.getExternalBundle().urls.background||this.episode.getBundle().urls.background;if(e){if(void 0===cc.loader.getRes(e))return console.log("No bg image loaded, using default: "+e),void this.addDefaultBackground()
;this.bg&&this.bg.removeFromParent(),this.bg=new cc.Sprite(cc.loader.getRes(e)),this.bg.setScale(this.bgScale),this.bg.setLocalZOrder(-1),this.addChild(this.bg)}},addDefaultBackground:function(){if("undefined"==typeof match3){var e=cleverapps.styles.EpisodeView.Background;this.bg=cleverapps.UI.createScale9Sprite(bundles.main.frames.episode_bg_png,cleverapps.UI.Scale9Rect.TwoPixelY),this.bg.setContentSize(e.width,e.height),this.bg.y=e.y,this.bg.setLocalZOrder(-1),this.addChild(this.bg),SceneDecors.add(this.bg,cleverapps.skins.getSlot("episodeView"))}else bundles.main.urls.blank_bg_jpg&&(this.bg=new cc.Sprite(bundles.main.urls.blank_bg_jpg),this.bg.setScale(2*this.bgScale),this.bg.setLocalZOrder(-2),this.addChild(this.bg))},addSpines:function(){var e=this.episode.getExternalBundle()&&this.episode.getExternalBundle().urls.png;if(e)if(void 0!==cc.loader.getRes(e))for(var t=0;t<10;t++){var n=this.episode.getExternalBundle().jsons["spine_"+t+"_json"];if(!n)break;var s=new cleverapps.Spine(n)
;s.setAnimation(0,"animation",!0),s.setLocalZOrder(1),this.animation=s,this.addChild(s)}else console.log("No spines image loaded")},addIsland:function(){var e=this.episode.getIslandBundle();if(e&&e.jsons["island_"+this.episode.episodeNo+"_json"]){var t=this.island=new IslandView(this.episode,this.episodesScene);t.setLocalZOrder(3),this.addChild(t)}},removeLoadAnimation:function(){this.loading&&(this.loading.finishAnimation(),delete this.loading)},removeNotOpennedAnimation:function(){this.notOpennedAnimation&&(this.notOpennedAnimation.removeFromParent(),delete this.notOpennedAnimation)},startLoadAnimation:function(){if(cleverapps.styles.EpisodeView.loadAnimation){var e=CloudsAnimation.factory();e.pageNo=this.pageNo,e.setPositionRound(this.getPosition()),this.getParent().addChild(e),(this.loading=e).startLoadAnimation(this)}},formatDifficulty:function(e){return e},finishLoadAnimation:function(){if(cleverapps.styles.EpisodeView.loadAnimation){if(this.loading)if(
cc.director.getRunningScene()instanceof levels.EpisodesScene&&this.loading.visible){cleverapps.styles.EpisodeView;this.loading.finishLoadAnimation(this.removeLoadAnimation.bind(this))}else this.removeLoadAnimation();if(cleverapps.styles.EpisodeView.oldAnimation&&!this.episode.isComingSoon()&&cleverapps.user.episode>=this.episode.episodeNo){var e;if(this.episode.isAvailableToPlay())this.episode.isFirstNotInShadow()&&(e=new cleverapps.Spine(bundles.main.jsons.episode_clouds_line_spine_json)).setAnimation(0,"animation",!0);else{(e=new cleverapps.Spine(bundles.main.jsons.episode_clouds_spine_json)).setAnimation(0,"old",!0);var t=cleverapps.UI.generateTTFText("messages:EpisodeView.TooOldEpisode",cleverapps.styles.FONTS.EPISODE_CLOUD_TEXT);t.setPositionRound(e.width/2,e.height/2+cleverapps.styles.EpisodeView.text.y),t.setDimensions(.5*cleverapps.UI.getSceneSize().width,0),t.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER),t.setAnchorPoint2(),e.addChild(t)}e&&(e.setLocalZOrder(100),
e.pageNo=this.pageNo,e.setPositionRound(this.getPosition()),this.getParent().addChild(e),this.notOpennedAnimation=e)}}},createUserView:function(){return new cleverapps.UI.Avatar(cleverapps.friends.getPlayer())},addPlayerAvatar:function(){var e=this.levelViews[levels.user.level];if(e&&!this.userView&&levels.user.episode===this.episode.episodeNo&&!this.episode.isComingSoon())if(cleverapps.social.isLoggedIn()){var t,n=this.userView=this.createUserView(),s=e.inLeftLevels(!0);cleverapps.styles.EpisodeView["player"+levels.user.level]?(t=cleverapps.styles.EpisodeView["player"+levels.user.level],s&&cleverapps.styles.EpisodeView["playerLeftLevels"+levels.user.level]&&(t=cleverapps.styles.EpisodeView["playerLeftLevels"+levels.user.level])):(t=cleverapps.styles.EpisodeView.player,s&&cleverapps.styles.EpisodeView.playerLeftLevels&&(t=cleverapps.styles.EpisodeView.playerLeftLevels)),n.setPosition(e.getPosition()),n.x+=e.width/2+t.x,n.y+=e.height/2+t.y,void 0!==t.scale&&n.setScale(n.getScale(
)*t.scale),this.addChild(n),n.setLocalZOrder(4)}else cleverapps.friends.onUserUpdatedListener=this.createListener(function(){this.addPlayerAvatar()}.bind(this))},addFingerTip:function(){if(levels.user.episode===this.episode.episodeNo&&!this.episode.isComingSoon()&&cleverapps.styles.EpisodeView.fingerTip){var e=this.levelViews[levels.user.level];if(!e||e.fingerTip)return;var t=new FingerView({control:"episode_view_finger"});t.setLocalZOrder(14),e.fingerTip=t,e.addChild(t),t.setPositionRound(e.width/2,e.height/2),t.delay(cleverapps.styles.EpisodeView.finger.delay),t.fadeIn(new cc.p(0,0)),t.press(),t.delay(.3),t.unPress(),t.delay(.1),t.press(),t.delay(.3),t.unPress(),t.fadeOut(),t.run({looped:!0})}}});cleverapps.styles.EpisodeView={height:cleverapps.styles.SCENE_HEIGHT,paddingTop:300,parallaxContainer:!0,addPixels:2,direction:cleverapps.UI.HORIZONTAL,Background:{width:720,height:1200},title:{y:490},description:{y:420},player:{x:5,y:5},episodeNum:{position:[{x:-180,y:480},{x:-540,y:480},{
x:-540,y:480}]},finger:{delay:5},loadAnimation:!1,oldAnimation:!1};var ComingSoonEpisodeView=EpisodeView.extend({ctor:function(e,t){this._super(e,t),this.setLocalZOrder(1)},customize:function(){this._super();var e=cleverapps.styles.EpisodeView.comingSoon;e.textOffset&&(this.title.y+=e.textOffset,this.description.y+=e.textOffset)},onExternalLoad:function(){this._super(),this.addCharacter()},addCharacter:function(){var e=cleverapps.styles.EpisodeView.comingSoon.character;if(e.json)(t=new cleverapps.Spine(e.json)).setAnimation(0,e.animationName,!0);else var t=new cc.Sprite(e.image);t.setScale(e.scale),t.setPosition(e.x,e.y),this.addChild(t)},addBackground:function(){if(bundles.main.jsons.episode_clouds_line_spine_json){var e=new cleverapps.Spine(bundles.main.jsons.episode_clouds_spine_json);e.setAnimation(0,"idle",!0),e.setLocalZOrder(-1),this.addChild(e)}}});cleverapps.overrideStyles(cleverapps.styles.EpisodeView,{comingSoon:{character:{scale:1,x:0,y:0}}});var Level=function(e,t,n){
this.episode=e,this.levelNo=t,this.episodeNo=e.episodeNo,this.stars=n||0,this.players=[],this.update()};Level.prototype.getHash=function(){},Level.prototype.listPlayers=function(){return this.players.length<=3?this.players:this.players.splice(0,3)},Level.prototype.isClickable=function(){return!!cleverapps.config.editorMode||!(this.type===Level.TYPE_NOTPASSED||!this.episode.isAvailableToPlay())&&(this.type===Level.TYPE_CURRENT||"olympics"!==cleverapps.config.name)},Level.prototype.getHumanReadableNumber=function(){return cleverapps.humanReadableNumber(this.episodeNo,this.levelNo)},Level.prototype.insertPlayer=function(e){this.players.push(e)},Level.prototype.removePlayer=function(e){var t=this.players.indexOf(e);-1<t&&this.players.splice(t,1)},Level.prototype.isRegular=function(){return this.episode.isRegular()},Level.prototype.isCurrentLevel=function(){return this.isRegular()&&levels.user.isCurrentLevel(this.levelNo,this.episode.episodeNo)},Level.prototype.isPassedLevel=function(){
return levels.user.isPassedLevel(this.levelNo,this.episode.episodeNo)},Level.prototype.isHard=function(){return-1!==this.episode.getHardLevels().indexOf(this.levelNo)},Level.prototype.isTricky=function(){return-1!==this.episode.getTrickyLevels().indexOf(this.levelNo)},Level.prototype.isNew=function(){return this.type!==Level.TYPE_PASSED||this.isCurrentLevel()},Level.prototype.isLastLevelOnEpisode=function(){return this.levelNo===this.episode.levelsPerEpisode-1},Level.prototype.getVersion=function(){return void 0===this.version&&(this.version=this.episode.getLevelContent(this.levelNo).version),this.version},Level.prototype.improveStars=function(e){this.stars=e},Level.prototype.loadBundle=function(e){var t=e&&e.onSuccess||function(){};this.load(t)},Level.prototype.load=function(e,t){this.content&&!cleverapps.config.editorMode?e&&e():(this.episode.loadData(),this.episode.whenLoaded(function(){this.content=this.episode.getLevelContent(this.levelNo),this.hash=Level.CalcHash(this.content),
e&&e()}.bind(this),t))},Level.prototype.unload=function(){this.episode.destructor()},Level.CalcHash=function(e){return RecursiveHasher(e,["episodeNo","levelNo","version","hard","paint","extra","gold","hash","hashes","comments","translate","definitions","bundles"])},Level.prototype.play=function(e,s){cleverapps.social.requestFullScreen(function(){cleverapps.config.editorMode&&(this.content=void 0,cleverapps.environment.setScene(cleverapps.Environment.SCENE_GAME)),cleverapps.rewardedAdsManager&&cleverapps.isLocalhost()&&cleverapps.rewardedAdsManager.showInterstitial();var n=new SceneProxy;cleverapps.scenes.replaceScene(n,e,{level:this}),this.episode.levels&&1===this.episode.levels.length&&!this.episode.loaded&&n.whenLoaded(function(e){e.registerCleanupCallback(this.unload.bind(this))}.bind(this)),this.load(function(){var e="mergecraft"===cleverapps.config.name?void 0:new Game(this,s),t=new GameScene(e,this);t instanceof SceneProxy?t.whenLoaded(function(e){n.instance=e,n.onLoad()}):(
n.instance=t,n.onLoad())}.bind(this))}.bind(this))},Level.prototype.onPressed=function(){cleverapps.lives&&cleverapps.lives.isEmpty()?cleverapps.metha.display({focus:["LevelPressedNoLives","MenuBarGoldItem","MenuBarLivesItem"],action:function(e){new LivesShopWindow,cleverapps.metha.onceNoWindowsListener=e}}):!BoostersBefore.isAvailable()&&(!0!==cleverapps.config.results||this.isCurrentLevel()&&!this.isHard())||!LevelStartWindow.isAvailable(this.episode.episodeNo,this.levelNo)?cleverapps.metha.display({focus:"LevelPressedPlay",action:function(e){this.play(e)}.bind(this)}):cleverapps.metha.display({focus:"LevelStartWindow",control:"MenuBarGoldItem",actions:[function(e){this.load(e)}.bind(this),function(e){new LevelStartWindow({level:this}),cleverapps.metha.onceNoWindowsListener=e}.bind(this)]})},Level.prototype.update=function(){cleverapps.metha.getType(
)===Metha.HOSE?levels.user.episode>this.episode.episodeNo?this.type=Level.TYPE_PASSED:levels.user.episode<this.episode.episodeNo?this.type=Level.TYPE_NOTPASSED:levels.user.level>this.levelNo?this.type=Level.TYPE_PASSED:levels.user.level===this.levelNo?this.type=Level.TYPE_CURRENT:this.type=Level.TYPE_NOTPASSED:this.type=Level.TYPE_CURRENT},Level.prototype.isChampion=function(){if(!this.episode.friendsResults)return!1;var e=this.episode.friendsResults.listTop4(this.levelNo,!0);return!(e.length<=1||levels.user.id!==e[0].id||void 0===e[0].score)},Level.TYPE_PASSED=0,Level.TYPE_CURRENT=1,Level.TYPE_NOTPASSED=2;var PlayerView=cleverapps.UI.Avatar.extend({ctor:function(e,t,n,s){var i=cleverapps.friends.getById(e);if(this._super(i.avatar),this.id=e,void 0!==t){var o=cleverapps.styles.LevelView;o=t?o["PlayerViewLeft"+s]?o["PlayerViewLeft"+s]:o.PlayerViewLeft:o["PlayerViewRight"+s]?o["PlayerViewRight"+s]:o.PlayerViewRight,this.setPositionRound(o.x,o.y),o.scale&&this.setScale(o.scale)}else{
o=cleverapps.styles.LevelView.PlayerView;this.setPositionRound(o.x,o.y),o.scale&&this.setScale(o.scale)}}});PlayerView.TAG=1;var LevelView=cc.Node.extend({ctor:function(e,t){this._super(),this.level=e,void 0!==t&&this.calculatePosition(t),void 0!==t&&t.episode.isComingSoon()?this.setPosition(cleverapps.styles.LevelView.coming_soon[0]):(this.addLevelBg(),this.addLevelId()),this.level.listPlayers().forEach(this.insertPlayer.bind(this)),this.level.isClickable()?(this.addTouchListener(),cleverapps.UI.applyHover(this)):(this.level.type===Level.TYPE_NOTPASSED||!this.level.episode.isAvailableToPlay()&&this.level.episode.episodeNo>=levels.user.episode)&&cleverapps.tooltipManager.create(this,{text:Messages.get("LevelNotPassedTooltip"),position:cleverapps.styles.UI.Tooltip.LOCATION.below}),void 0!==t&&t.episode.isComingSoon()||this.customize()},inLeftLevels:function(e){var t=cleverapps.styles.LevelView;if(t.leftLevels){var n=t.leftLevels;e&&t.playerLeftLevels&&(n=t.playerLeftLevels);var s=!1
;return this.level.episodeNo%2&&!t.notAlternate&&(s=!s),0<=n.indexOf(this.level.levelNo)&&(s=!s),s}},insertPlayer:function(e,t){if(cleverapps.friends.getById(e)){var n=cleverapps.styles.LevelView,s=new PlayerView(e,this.inLeftLevels(),this.level.episodeNo,this.level.levelNo),i=cleverapps.styles.LevelView.playersInterval,o=n.notAlternate?!this.inLeftLevels():this.inLeftLevels();s.x+=t*(o?i.x:-i.x),s.y-=t*i.y,0<t&&s.setLocalZOrder(-t),this.addChild(s)}},calculatePosition:function(){var e=cleverapps.styles.LevelView[this.level.episode.getBundle().levelPositions||"levels_1"][this.level.levelNo];(this.level.levelNo<Episode.LEVELS_PER_EPISODE||e)&&this.setPosition(e)},customize:function(){},getAnimationName:function(){var e=this.level.isHard()?["hard_past","hard_current","hard_future"]:["past","current","future"],t=this.getStars();return void 0!==t&&this.level.type===Level.TYPE_PASSED?(e=this.level.isHard()?["hard_past_stars0","hard_past_stars1","hard_past_stars2","hard_past_stars3"]:[
"past_stars0","past_stars1","past_stars2","past_stars3"])[t]:e[this.level.type]},getStars:function(){if(cleverapps.config.results&&(this.level.episode.isAvailableToPlay()&&this.level.type!==Level.TYPE_CURRENT&&this.level.type===Level.TYPE_PASSED))return void 0!==this.level.stars?this.level.stars:0},addLevelBg:function(){var e=cleverapps.styles.LevelView,t=new cc.Node;t.setContentSize(e.clickSize),this.setContentSize(t.getContentSize());var n=this.getAnimationName(),s=new cleverapps.Spine(bundles.level.jsons.level_json);s.setAnimation(0,n,!0),s.setPosition(t.width/2,t.height/2+e.dy),t.addChild(s),this.setAnchorPoint2(),this.addChild(t)},addLevelId:function(){this.level.isHard()&&cleverapps.styles.LevelView.hideHardLevelNo||LevelView.generateLevelId(this,this.level.type,this.level.getHumanReadableNumber())},addTouchListener:function(){cc.eventManager.addListener({event:cc.EventListener.TOUCH_ONE_BY_ONE,onTouchBegan:function(e){var t=this.convertTouchToNodeSpace(e)
;return this.beginLocation=e.getLocation(),!(!cc.rectContainsPoint(cc.rect(0,0,this.width,this.height),t)||!this.isVisible())&&(this.onTouchBegan(),!0)}.bind(this),onTouchMoved:function(e){if(this.beginLocation){var t=e.getLocation();if(10<Math.abs(t.x-this.beginLocation.x)+Math.abs(t.y-this.beginLocation.y))return this.onTouchEnded(),this.beginLocation=!1}return!0}.bind(this),onTouchEnded:function(e){if(this.beginLocation){var t=this.convertTouchToNodeSpace(e);if(cc.rectContainsPoint(cc.rect(0,0,this.width,this.height),t))return this.onTouchBegan(),this.onPressed(),!0}return!1}.bind(this)},this)},onPressed:function(){cleverapps.audio.playSound(bundles.main.urls.click_effect),this.level.onPressed()},onTouchBegan:function(){this.startPositionY=this.startPositionY||this.getPositionY(),this.setPositionY(this.startPositionY-3)},onTouchEnded:function(){this.setPositionY(this.startPositionY)}});LevelView.generateLevelId=function(e,t,n){var s=cleverapps.styles.LevelView.LevelId;if(
cleverapps.config.editorMode||-1!==s.showTypes.indexOf(t)){var i=cleverapps.styles.FONTS.LEVEL_TITLE_TEXT;t===Level.TYPE_NOTPASSED&&(i=cleverapps.styles.FONTS.LEVEL_NOT_PASSED_TITLE_TEXT),t===Level.TYPE_CURRENT&&cleverapps.styles.FONTS.LEVEL_CURRENT_TITLE_TEXT&&(i=cleverapps.styles.FONTS.LEVEL_CURRENT_TITLE_TEXT);var o,r=cleverapps.UI.generateImageText(n,i);1e3<=n?o=cleverapps.styles.FONTS.LEVEL_TITLE_TEXT.alternativeSizes[1]:100<=n&&(o=cleverapps.styles.FONTS.LEVEL_TITLE_TEXT.alternativeSizes[0]),o&&r.setScale(r.scale*o),e.addChild(r);var a=s;(e.levelId=r).setPositionRound(a.x,a.y)}},cleverapps.overrideFonts(cleverapps.styles.FONTS,{LEVEL_TITLE_TEXT:{name:"default",size:40,color:cleverapps.styles.COLORS.WHITE,alternativeSizes:[.9,.8]},LEVEL_NOT_PASSED_TITLE_TEXT:{name:"default",size:40,color:cleverapps.styles.COLORS.WHITE,alternativeSizes:[.9,.8]}}),cleverapps.styles.LevelView={curLevelAction:{scale:1.2},coming_soon:[{x:-60,y:-200}],LevelId:{x:{dx:0},y:{dy:0},showTypes:[
Level.TYPE_PASSED,Level.TYPE_CURRENT,Level.TYPE_NOTPASSED]},playersInterval:{x:16,y:8},PlayerView:{x:0,y:0},clickSize:{width:90,height:75},dy:-10};var FbConnectWindow=Window.extend({onWindowLoaded:function(e,t,n){var s=cleverapps.styles.FbConnectWindow;n=n||{};var i=s.width,o=[],r=function(e){e.setDimensions(i,0),e.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER),o.push(e)};n.errorMessage&&r(cleverapps.UI.generateTTFText(n.errorMessage,cleverapps.styles.FONTS.SMALL_TEXT_ERROR)),r(cleverapps.UI.generateTTFText("messages:FbConnectWindow.text",cleverapps.styles.FONTS.FBCONNECT_WINDOW_TEXT||cleverapps.styles.FONTS.WINDOW_TEXT));var a=new cleverapps.Layout(o,{padding:s.padding,y:s.offsetY,margin:s.Text.padding,direction:cleverapps.UI.VERTICAL,x:i/2});this._super({title:"messages:SignIn",closeButton:!n.withWindow,name:"fbconnectwindow",content:a}),e=cleverapps.once(e||function(){});var c=function(){this.onClose=function(){},this.close(),e()}.bind(this);t&&(this.onClose=t),this.addButtons(c),
cleverapps.audio.playSound(bundles.main.urls.window_effect)},addButtons:function(n){var s=cleverapps.social.getCodes(),i=cleverapps.styles.FbConnectWindow,e=s.map(function(e){i.Button[e]&&i.Button[e].button_png;var t={multiSocials:1<s.length,height:i.Button.height,showText:1===s.length,iconScale:i.Button.iconScale,login:!0,source:e,onSuccess:n};return new FbButton(t)}),t=new cleverapps.Layout(e,{direction:cleverapps.UI.HORIZONTAL,margin:i.Button.margin});this.window.addChild(t);var o=i.Button.bottomPadding;1<s.length&&void 0!==i.Button.multiSocials.bottomPadding&&(o=i.Button.multiSocials.bottomPadding),t.setPositionRound(this.window.width/2,t.height/2+o)}});cleverapps.styles.FbConnectWindow={width:600,offsetY:75,padding:{x:0,y:0},Button:{bottomPadding:50,height:120,margin:40,iconScale:.9,multiSocials:{}},Text:{extraWidth:0,padding:20},ButtonContent:{width:340,height:120,image:{x:20,y:5},minWidth:80,text:{x:10,y:6},empty:!1}};var Boatswain=function(e){this.level=e,
this.level.episode.isDailyCup()?this.intent=this.BACK_TO_DAILY_CUP:this.intent=this.BACK_TO_MAIN};Boatswain.prototype.BACK_TO_DAILY_CUP=function(e){cleverapps.scenes.replaceScene(new DailyCupScene,e)},Boatswain.prototype.DAILY_LEVEL_BACK_TO_MAIN=function(e){var t=function(){cleverapps.metha.gotoMainScene(e)};cleverapps.rewardedAdsManager.isAvailable(RewardedAdsManager.REWARDED)?(t=cleverapps.waitNoMore(3e4,t),cleverapps.rewardedAdsManager.play(RewardedAdsManager.REWARDED,t)):t()},Boatswain.prototype.BACK_TO_MAIN=function(e){cleverapps.Plot.GameLeave(e,{level:this.level})},Boatswain.prototype.PLAY_NEXT=function(e){cleverapps.metha.wantsToPlay(e,{level:this.level,playNext:!0})},Boatswain.prototype.REPLAY=function(e,t){(t=t||{}).level=this.level,t.replay=!0,cleverapps.metha.wantsToReplay(e,t)},Boatswain.EXIT_INTENT=0,Boatswain.NEXT_INTENT=1,Boatswain.REPLAY_INTENT=2;var DailyLevel=function(){cleverapps.isLocalhost()&&delete DailyLevel.AVAILABLE.source,this.load()}
;DailyLevel.prototype.load=function(){if(this.isAvailable()){var e=cleverapps.User.calcChannel("event");e&&0===e.indexOf(DailyLevel.EVENT_NAME)&&(this.currentEvent=e.substr(DailyLevel.EVENT_NAME.length),this.startFromPortlet=!0),this.currentEvent=this.currentEvent||this.getCurrentEvent();var t=cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.DAILY_LEVEL);this.passed=t&&t.event===this.currentEvent&&(!t.levelsToPass||0===t.levelsToPass),this.levelsToPass=t&&t.levelsToPass?t.levelsToPass:this.getCountOfLevelsForReward(),cleverapps.config.debugMode&&-1!==["576593702177"].indexOf(cleverapps.user.id)&&(this.passed=!1)}},DailyLevel.prototype.start=function(e){var t=this.getCurrentLevel(),n=new Episode(Episode.Types.DAILY_LEVELS,t).getLevel();LevelStartWindow.isAvailable(cleverapps.user.episode,cleverapps.user.level)&&BoostersBefore.isAvailable()?(new LevelStartWindow({level:n}),cleverapps.metha.onceNoWindowsListener=e):n.play(e)},DailyLevel.prototype.isAvailable=function(){
return cleverapps.user.checkAvailable(DailyLevel.AVAILABLE)&&this.getBundle()},DailyLevel.prototype.getBundle=function(){return bundles.episode_daily_levels_ru||bundles.episode_daily_levels},DailyLevel.prototype.isActive=function(){return this.isAvailable()&&!this.passed},DailyLevel.prototype.isStartFromPortlet=function(){return this.isAvailable()&&this.startFromPortlet},DailyLevel.prototype.reset=function(){this.passed=!1,this.levelsToPass=this.getCountOfLevelsForReward(),cleverapps.DataLoader.remove(cleverapps.DataLoaderTypes.DAILY_LEVEL)},DailyLevel.prototype.onWin=function(e){this.levelsToPass--,cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.DAILY_LEVEL,{event:this.getCurrentEvent(),levelsToPass:this.levelsToPass}),0===this.levelsToPass&&(this.passed=!0,cleverapps.social.setStatus&&cleverapps.social.setStatus(DailyLevel.EVENT_NAME+this.getCurrentEvent(),this.getStatus(e)),cleverapps.eventLogger.logEvent("daily_level_passed_"+this.getCurrentEvent()))},
DailyLevel.prototype.getStatus=function(e){var t={},n=e.content;if("board"===cleverapps.config.type){var s=function(e){return 1===e?Messages.get("DailyLevel.Status.wordsAmount1"):e<=4?Messages.get("DailyLevel.Status.wordsAmount234",{amount:e}):Messages.get("DailyLevel.Status.wordsAmount5",{amount:e})};t={firstWord:n.words[0].toUpperCase(),base:n.base.toUpperCase(),amountMinus1:s(n.words.length-1),baseLength:n.base.length,wordsAmount:s(n.words.length)}}else"solitaire"===cleverapps.config.type&&(t={cardsCount:Game.currentGame.table.beginCards,movesLeft:n.hand.num});var i=Messages.get("DailyLevel.Status.common",t);return i[Math.round(Math.random()*i.length)]},DailyLevel.prototype.getCurrentEvent=function(){if(this.currentEvent)return this.currentEvent;var e=new Date;return cleverapps.padZeroes(e.getFullYear()%100,2)+cleverapps.padZeroes(e.getMonth()+1,2)+cleverapps.padZeroes(e.getDate(),2)},DailyLevel.prototype.getCurrentLevel=function(){var e=this.getCurrentEvent(),t=e.substr(0,2),
n=e.substr(2,2),s=e.substr(4,2),i=new Date;i.setUTCFullYear(parseInt("20"+t),parseInt(n)-1,parseInt(s)),i.setUTCHours(0,0,0,0);var o=i.getTime()-new Date("2019-12-17").getTime();o/=864e5;var r=Math.floor(o),a=this.getBundle().levelsAmount-this.getCountOfLevelsForReward()+1,c=(r%a+a)%a;return console.log("dailylevel.getCurrentLevel event "+e+" levelNo "+c),c+(this.getCountOfLevelsForReward()-this.levelsToPass)},DailyLevel.prototype.getCountOfLevelsForReward=function(){return 1},DailyLevel.EVENT_NAME="dailylevel",DailyLevel.AVAILABLE={projectName:["wordsoup","crocword","olympics","tripeaks"],language:"ru",source:["web_ok","mobile_ok"]};var DailyLevelWindow=Window.extend({onWindowLoaded:function(e){this.options=e;var t=cleverapps.styles.DailyLevelWindow;this._super({title:"messages:DailyLevelWindow.title",name:"dailylevelwindow",content:this.getContent(),styles:cleverapps.overrideStyles(cleverapps.styles.Window,cleverapps.styles.DailyLevelWindow.window,!0),button:{text:Messages.get("Play"
),width:t.button.width,height:t.button.height,onPressed:function(){this.close()}.bind(this)}}),t.hero&&(this.hero=new cleverapps.Spine(t.hero.json,1),this.hero.setAnimation(0,t.hero.animation,!0),this.hero.setPositionRound(t.hero),this.hero.setScale(t.hero.scale),this.addChild(this.hero))},getContent:function(){var e=cleverapps.styles.DailyLevelWindow,t=[];if(e.animation.json){var n=this.createAnimation();t.push(n)}if(e.label){var s=new cc.Sprite(e.label);s.rotation=-15,t.push(s)}var i=new cleverapps.Layout(t,{direction:cleverapps.UI.HORIZONTAL,margin:2*e.contentObjectsMargin}),o=this.createText();return new cleverapps.Layout([o,i],{direction:cleverapps.UI.VERTICAL,margin:e.contentObjectsMargin,padding:{x:0,y:e.contentObjectsMargin}})},createText:function(){var e=cleverapps.styles.DailyLevelWindow,t=cleverapps.UI.generateTTFText("messages:DailyLevelWindow.text",cleverapps.styles.FONTS.WINDOW_SMALL_TEXT,{left:cleverapps.dailyLevel.levelsToPass});return t.setHorizontalAlignment(
cc.TEXT_ALIGNMENT_CENTER),t.setDimensions(cc.size(e.textWidth,0)),t},createAnimation:function(){var e=cleverapps.styles.DailyLevelWindow,t=new cc.Node;t.setAnchorPoint2(),t.setContentSize(e.size);var n=new cleverapps.Spine(e.animation.json,e.scale);return n.setAnimation(0,e.animation.name?e.animation.name:"idle",!0),t.addChild(n),n.setPositionRound(t.width/2+e.animation.dx,t.height/2+e.animation.dy),t}});cleverapps.styles.DailyLevelWindow={contentObjectsMargin:30,textWidth:540,size:{width:250,height:350},scale:.55,button:{width:200,height:100},animation:{dx:-100,dy:-70,json:bundles.hero.jsons.hero_json,name:"coming_soon"},label:bundles.game.frames.label_50_ok_png},cleverapps.Lives=function(e){cleverapps.config.debugMode&&(cleverapps.Lives.TIMEOUT=cleverapps.parseInterval("1 minutes")/cleverapps.Lives.MAX_REGEN_AMOUNT/1e3+""),e?(this.amount=cleverapps.Lives.MAX_REGEN_AMOUNT,this.whenStart=void 0,this.save()):this.load(),this.onChangeAmountListeners={},
this.onStartRegenerateListener=function(){},this.onBuyUnlimitedLivesListener=function(){},this.processRegenerateState()},cleverapps.Lives.prototype.processRegenerateState=function(e){var t,n;for(this.stopRegenerateTimeout();this.amount<cleverapps.Lives.MAX_REGEN_AMOUNT&&this.whenStart&&this.whenStart+cleverapps.parseInterval(cleverapps.Lives.TIMEOUT)<=Date.now();)this.amount++,this.whenStart+=cleverapps.parseInterval(cleverapps.Lives.TIMEOUT),n=t=!0;var s=cleverapps.tempGoods.checkGoodBuyed(cleverapps.TempGoods.UNLIMITED_LIVES);!t||e||s||this.runListeners(),this.amount>=cleverapps.Lives.MAX_REGEN_AMOUNT?delete this.whenStart:(this.whenStart||(this.whenStart=Date.now(),n=!0),this.startRegenerateTimeout(void 0!==e?e:s)),n&&this.save(),this.processLocalPushes()},cleverapps.Lives.prototype.startRegenerateTimeout=function(e){void 0===this.finishRegenerateTimeout&&(this.finishRegenerateTimeout=new cleverapps.LongTimeout(this.processRegenerateState.bind(this),this.calcTimeLeft()),
e||this.onStartRegenerateListener())},cleverapps.Lives.prototype.stopRegenerateTimeout=function(){clearTimeout(this.finishRegenerateTimeout),this.finishRegenerateTimeout=void 0},cleverapps.Lives.prototype.isRegenerateRunning=function(){return void 0!==this.finishRegenerateTimeout},cleverapps.Lives.prototype.calcTimeLeft=function(){var e=(this.whenStart||Date.now())+cleverapps.parseInterval(cleverapps.Lives.TIMEOUT)-Date.now();return e<0&&(e=0),e>cleverapps.parseInterval(cleverapps.Lives.TIMEOUT)&&(e=cleverapps.parseInterval(cleverapps.Lives.TIMEOUT)),e},cleverapps.Lives.prototype.isEmpty=function(){return 0===this.amount&&!cleverapps.tempGoods.checkGoodBuyed(cleverapps.TempGoods.UNLIMITED_LIVES)},cleverapps.Lives.prototype.isFull=function(){return this.amount>=cleverapps.Lives.MAX_REGEN_AMOUNT||cleverapps.tempGoods.checkGoodBuyed(cleverapps.TempGoods.UNLIMITED_LIVES)},cleverapps.Lives.prototype.give=function(e,t){e=void 0===e?1:e,this.setAmount(this.amount+e,t)},
cleverapps.Lives.prototype.setMaxAmount=function(e){cleverapps.Lives.MAX_REGEN_AMOUNT=e,this.save(),this.runListeners(),this.processRegenerateState()},cleverapps.Lives.prototype.setAmount=function(e,t){if(e<0&&(e=0),0<this.amount-e){var n=cleverapps.missionManager.findByType(Mission.TYPE_ENERGY_FEAST);n&&n.update(this.amount-e)}this.amount!==e&&(this.amount=e,this.save(),t||this.runListeners()),this.processRegenerateState(t)},cleverapps.Lives.prototype.processLocalPushes=cleverapps.timeredThrottle(cleverapps.parseInterval("1 minute"),function(){if(this.amount>=cleverapps.Lives.MAX_REGEN_AMOUNT||cleverapps.tempGoods.checkGoodBuyed(cleverapps.TempGoods.UNLIMITED_LIVES))cleverapps.localPushes.cancelPush(cleverapps.LocalPushes.TYPES.LIVES);else{var e=cleverapps.Lives.MAX_REGEN_AMOUNT-this.amount,t=(this.whenStart||Date.now())+cleverapps.parseInterval(cleverapps.Lives.TIMEOUT)*e-Date.now();cleverapps.localPushes.sendPush(cleverapps.LocalPushes.TYPES.LIVES,t)}}),
cleverapps.Lives.prototype.reset=function(){this.amount=cleverapps.Lives.MAX_REGEN_AMOUNT,this.whenStart=void 0,this.processRegenerateState(),this.save()},cleverapps.Lives.prototype.take=function(e){cleverapps.config.editorMode||(this.amount>=cleverapps.Lives.MAX_REGEN_AMOUNT&&delete this.whenStart,0<this.amount&&this.setAmount(this.amount-1,e))},cleverapps.Lives.prototype.getInfo=function(){var e={amount:this.amount,ws:this.whenStart};return cleverapps.Lives.SAVE_MAX_AMOUNT&&(e.max=cleverapps.Lives.MAX_REGEN_AMOUNT),e},cleverapps.Lives.prototype.updateInfo=function(e,t){this.amount=e.amount,this.whenStart=e.ws||e.whenStart,e.max&&(cleverapps.Lives.MAX_REGEN_AMOUNT=e.max),this.processRegenerateState(),this.save(t)},cleverapps.Lives.prototype.runListeners=function(){cleverapps.values(this.onChangeAmountListeners).forEach(function(e){e()})},cleverapps.Lives.prototype.save=function(e){cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.LIVES,this.getInfo()),
e||cleverapps.synchronizer.addUpdateTask("lives")},cleverapps.Lives.prototype.load=function(){var e=cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.LIVES);e?(this.amount=e.amount,this.whenStart=e.ws||e.whenStart,e.max&&(cleverapps.Lives.MAX_REGEN_AMOUNT=e.max)):(this.amount=cleverapps.Lives.MAX_REGEN_AMOUNT,this.whenStart=void 0)},cleverapps.Lives.MAX_REGEN_AMOUNT=5,cleverapps.Lives.TIMEOUT="30 minutes","olympics"===cleverapps.config.name&&(cleverapps.Lives.MAX_REGEN_AMOUNT=3),"merge"===cleverapps.config.type&&(cleverapps.Lives.TIMEOUT="3 minutes",cleverapps.Lives.SAVE_MAX_AMOUNT=!0),cleverapps.styles.COLORS=cleverapps.overrideColors(cleverapps.styles.COLORS,{LIGHT_TEXT_COLOR:new cc.Color(255,255,255,255),YELLOW_TEXT_COLOR:new cc.Color(247,230,43,255),LIGHT_TEXT_DISABLED_COLOR:new cc.Color(200,200,200,255),LIGHT_TEXT_STROKE_COLOR:new cc.Color(0,0,0,125),LIGHT_TEXT_SHADOW_COLOR:new cc.Color(9,0,0,100),GREEN:new cc.Color(123,194,63,255),COLOR_RED:new cc.Color(255,74,74,255),
DARK_TEXT_COLOR:new cc.Color(121,75,57,255)}),cleverapps.styles.DECORATORS=cleverapps.overrideStyles(cleverapps.styles.DECORATORS,{TITLE_TEXT_SHADOW:{color:cleverapps.styles.COLORS.TITLE_SHADOW,direction:cc.size(0,-2),blur:1},LIGHT_TEXT_STROKE:{color:cleverapps.styles.COLORS.LIGHT_TEXT_STROKE_COLOR,size:1},LIGHT_TEXT_SHADOW:{color:cleverapps.styles.COLORS.LIGHT_TEXT_SHADOW_COLOR,direction:cc.size(0,-3),blur:3}}),cleverapps.overrideFonts(cleverapps.styles.FONTS,{WINDOW_TITLE_TEXT:{size:50,color:cleverapps.styles.COLORS.LIGHT_TEXT_COLOR,stroke:cleverapps.styles.DECORATORS.LIGHT_TEXT_STROKE,shadow:cleverapps.styles.DECORATORS.LIGHT_TEXT_SHADOW},WINDOW_SMALL_TEXT:{size:40,color:cleverapps.styles.COLORS.LIGHT_TEXT_COLOR,stroke:cleverapps.styles.DECORATORS.LIGHT_TEXT_STROKE,shadow:cleverapps.styles.DECORATORS.LIGHT_TEXT_SHADOW},WINDOW_TEXT:{size:50,color:cleverapps.styles.COLORS.DARK_TEXT_COLOR},WAIT_WINDOW_TEXT:{size:50,color:cleverapps.styles.COLORS.LIGHT_TEXT_COLOR,
stroke:cleverapps.styles.DECORATORS.LIGHT_TEXT_STROKE,shadow:cleverapps.styles.DECORATORS.LIGHT_TEXT_SHADOW},SMALL_TEXT_ERROR:{size:40,color:cleverapps.styles.COLORS.COLOR_RED},FBCONNECT_WINDOW_TEXT:{size:50,color:cleverapps.styles.COLORS.DARK_TEXT_COLOR},NEW_VERSION_WINDOW_TEXT:{size:50,color:cleverapps.styles.COLORS.DARK_TEXT_COLOR},SETTINGS_WINDOW_ID_TEXT:{size:50,color:cleverapps.styles.COLORS.DARK_TEXT_COLOR},LIGHT_TITLE_TEXT:{size:50,color:cleverapps.styles.COLORS.LIGHT_TEXT_COLOR,stroke:cleverapps.styles.DECORATORS.LIGHT_TEXT_STROKE,shadow:cleverapps.styles.DECORATORS.LIGHT_TEXT_SHADOW},LIGHT_TITLE_TEXT_DISABLED:{size:50,color:cleverapps.styles.COLORS.LIGHT_TEXT_DISABLED_COLOR,stroke:cleverapps.styles.DECORATORS.LIGHT_TEXT_STROKE,shadow:cleverapps.styles.DECORATORS.LIGHT_TEXT_SHADOW},LIGHT_SUBTITLE_TEXT:{size:30,color:cleverapps.styles.COLORS.LIGHT_TEXT_COLOR,stroke:cleverapps.styles.DECORATORS.LIGHT_TEXT_STROKE,shadow:cleverapps.styles.DECORATORS.LIGHT_TEXT_SHADOW},UNIT_PROB:{
size:35,color:cleverapps.styles.COLORS.LIGHT_TEXT_COLOR,stroke:cleverapps.styles.DECORATORS.LIGHT_TEXT_STROKE,shadow:cleverapps.styles.DECORATORS.LIGHT_TEXT_SHADOW},BUTTON_TEXT:{size:50,color:cleverapps.styles.COLORS.LIGHT_TEXT_COLOR,stroke:cleverapps.styles.DECORATORS.LIGHT_TEXT_STROKE,shadow:cleverapps.styles.DECORATORS.LIGHT_TEXT_SHADOW},BIG_BUTTON_TEXT:{size:70,color:cleverapps.styles.COLORS.WHITE,stroke:cleverapps.styles.DECORATORS.LIGHT_TEXT_STROKE,shadow:cleverapps.styles.DECORATORS.LIGHT_TEXT_SHADOW},BUTTON_SMALL_TEXT:{size:36,color:cleverapps.styles.COLORS.LIGHT_TEXT_COLOR,stroke:cleverapps.styles.DECORATORS.LIGHT_TEXT_STROKE,shadow:cleverapps.styles.DECORATORS.LIGHT_TEXT_SHADOW},FORCE_MESSAGE_TEXT:{size:45,color:cleverapps.styles.COLORS.DARK_TEXT_COLOR},LIGHT_BUTTON_IMAGE_TEXT:{name:"default",size:35,color:cleverapps.styles.COLORS.LIGHT_TEXT_COLOR},LIGHT_BUTTON_TEXT:{size:45,color:cleverapps.styles.COLORS.LIGHT_TEXT_COLOR,stroke:cleverapps.styles.DECORATORS.LIGHT_TEXT_STROKE,
shadow:cleverapps.styles.DECORATORS.LIGHT_TEXT_SHADOW},LIGHT_TEXT:{size:35,color:cleverapps.styles.COLORS.LIGHT_TEXT_COLOR,stroke:cleverapps.styles.DECORATORS.LIGHT_TEXT_STROKE,shadow:cleverapps.styles.DECORATORS.LIGHT_TEXT_SHADOW},DARK_TEXT:{name:"nostroke",size:45,color:cleverapps.styles.COLORS.DARK_TEXT_COLOR},LOADING_TEXT:{size:45,color:cleverapps.styles.COLORS.LIGHT_TEXT_COLOR,stroke:cleverapps.styles.DECORATORS.LIGHT_TEXT_STROKE,shadow:cleverapps.styles.DECORATORS.LIGHT_TEXT_SHADOW},REWARDS_LIST_TEXT:{size:30,color:cleverapps.styles.COLORS.LIGHT_TEXT_COLOR},REWARD_WINDOW_REWARDS_TEXT:{name:"nostroke",size:40,color:cleverapps.styles.COLORS.DARK_TEXT_COLOR},SIDEBAR_ICON_TEXT:{name:"default",size:45,color:cleverapps.styles.COLORS.LIGHT_TEXT_COLOR,stroke:cleverapps.styles.DECORATORS.LIGHT_TEXT_STROKE,shadow:cleverapps.styles.DECORATORS.LIGHT_TEXT_SHADOW},CONFIRM_AND_EXIT_TEXT:{name:"nostroke",size:45,color:cleverapps.styles.COLORS.DARK_TEXT_COLOR}}),cleverapps.overrideStyles(
cleverapps.styles.Window,{Border:{y:110,x:60},titleCloseButtonMargin:70,Title:{offsetX:0,offsetY:-10,bg:{adjustToText:{width:120,height:-25,offset:{y:-8,x:0}},image:bundles.windows.frames.window_title_background,zIndex:1,x:{align:"center"},y:{align:"top",dy:0}}},CloseButton:{offsetX:30,offsetY:30},BottomButton:{bottomPadding:80},bgOffset:{y:-50,x:0},Background:{paddingX:30}}),cleverapps.overrideStyles(cleverapps.styles.Tabs,{buttons:{x:{align:"center",dx:0},y:{align:"center",dy:0},width:135,height:240},attention:{x:{align:"left",dx:-30},y:{align:"top",dy:-15}},margin:6,direction:cleverapps.UI.TOP_TO_BOTTOM}),cleverapps.overrideStyles(cleverapps.styles.SettingsWindow,{window:{contentOffset:-20}}),cleverapps.overrideStyles(cleverapps.styles.FbConnectWindow,{offsetY:90,Button:{bottomPadding:70}}),cleverapps.overrideStyles(cleverapps.styles.SideBarIconView,{lock:{color:new cc.Color(170,170,200),x:{align:"center",dx:0},y:{align:"center",dy:15}},text:{x:{align:"center",dx:0},y:{
align:"bottom",dy:-15},offsetY:4,bg:{scale9:!0,width:180,height:80},textWidth:150}}),cleverapps.styles.COLORS=cleverapps.overrideColors(cleverapps.styles.COLORS,{COLOR_BONUS:new cc.Color(215,169,255,255)}),cleverapps.overrideFonts(cleverapps.styles.FONTS,{MENUBAR_TEXT:{name:"default",size:56}}),cleverapps.overrideStyles(cleverapps.styles.MenuBar,{margin:0,smallMargin:-18,padding:{x:78,y:0},position:{x:{align:"left",dx:0},y:{align:"top",dy:-52}}}),cleverapps.overrideStyles(cleverapps.styles.MenuBarItem,{bg:{width:299,height:91,minWidth:247},icon:{x:26,y:0},plusButton:{position:{x:{align:"right",dx:-14},y:{align:"center",dy:1}}},textOffset:{imageFont:2},noPlusDx:12,iconBlockWidth:84,plusBlockWidth:84}),cleverapps.styles.COLORS=cleverapps.overrideColors(cleverapps.styles.COLORS,{SHOP_STROKE_COLOR:new cc.Color(0,0,0,100),SHOP_SHADOW_COLOR:new cc.Color(0,0,0,80)}),cleverapps.styles.DECORATORS=cleverapps.overrideStyles(cleverapps.styles.DECORATORS,{SHOP_STROKE:{
color:cleverapps.styles.COLORS.SHOP_STROKE_COLOR,size:1},SHOP_SHADOW:{color:cleverapps.styles.COLORS.SHOP_SHADOW_COLOR,direction:cc.size(0,-2),blur:3}}),cleverapps.overrideFonts(cleverapps.styles.FONTS,{TILE_SHOP_OFFER_TEXT_LARGE:{name:"default",color:cleverapps.styles.COLORS.LIGHT_TEXT_COLOR,size:62},TILE_SHOP_OFFER_TEXT_SMALL:{name:"default",color:cleverapps.styles.COLORS.LIGHT_TEXT_COLOR,size:35},SHOP_LARGE_TILE_BUTTON_TEXT:{name:"default",size:48,color:cleverapps.styles.COLORS.LIGHT_TEXT_COLOR,stroke:cleverapps.styles.DECORATORS.SHOP_STROKE,shadow:cleverapps.styles.DECORATORS.SHOP_SHADOW},SHOP_SMALL_TILE_BUTTON_TEXT:{name:"default",size:32,color:cleverapps.styles.COLORS.LIGHT_TEXT_COLOR,stroke:cleverapps.styles.DECORATORS.SHOP_STROKE,shadow:cleverapps.styles.DECORATORS.SHOP_SHADOW},SHOP_LIVES_PRODUCT_TILE_TITLE:{size:60,color:cleverapps.styles.COLORS.LIGHT_TEXT_COLOR,stroke:cleverapps.styles.DECORATORS.SHOP_STROKE,shadow:cleverapps.styles.DECORATORS.SHOP_SHADOW},
SHOP_LIVES_PRODUCT_TILE_DESCRIPTION_TEXT:{name:"nostroke",size:26,color:cleverapps.styles.COLORS.DARK_TEXT_COLOR}}),cleverapps.overrideStyles(cleverapps.styles.CoinsProductLargeTile,{adjustBackgroundCapInsets:!0,width:460,margin:18,offset:{y:-30}}),cleverapps.overrideStyles(cleverapps.styles.CoinsProductSmallTile,{adjustBackgroundCapInsets:!0,width:260,height:360,margin:5,offset:{y:-15}}),cleverapps.overrideStyles(cleverapps.styles.LargeTileRewardsBlock,{width:445,height:130,offsetY:30,gold:{icon:bundles.tile_shop.frames.shop_gold_png,scale:.7}}),cleverapps.overrideStyles(cleverapps.styles.SmallTileRewardsBlock,{width:245,height:80,offsetY:20,gold:{icon:bundles.tile_shop.frames.shop_gold_png,scale:.6}}),cleverapps.overrideStyles(cleverapps.styles.LargeTileButton,{width:230,height:90,text:{dy:0}}),cleverapps.overrideStyles(cleverapps.styles.SmallTileButton,{width:150,height:60,text:{dy:0}}),cleverapps.overrideStyles(cleverapps.styles.LargeTileIcon,{height:void 0,wrap:{dx:15,dy:30}}),
cleverapps.overrideStyles(cleverapps.styles.SmallTileIcon,{height:190,wrap:{dy:5}}),cleverapps.overrideStyles(cleverapps.styles.LargeTileBadge,{x:{align:"left",dx:-39},y:{align:"top",dy:39},text:{x:-5,y:5}}),cleverapps.overrideStyles(cleverapps.styles.SmallTileBadge,{x:{align:"right",dx:35},y:{align:"top",dy:33},text:{x:0,y:0},scale:.6}),cleverapps.overrideStyles(cleverapps.styles.LivesProductTile,{isSmall:!1,adjustBackgroundCapInsets:!0,width:460,height:747,margin:10,offset:{y:-30},title:{size:{width:445,height:125},y:12,bg:bundles.tile_shop.frames.tile_best_stripe_png,bg_off:bundles.tile_shop.frames.tile_best_stripe_png_off,paddingX:60}});var MenuBarGameLevelView=MenuBarItemView.extend({ctor:function(e){this._super(e),e.onChangeLevelNo=this.createListener(this.onChangeLevelNo.bind(this)),e.onChangeExpProgress=this.createListener(this.onChangeExpProgress.bind(this))},reset:function(){var e=cleverapps.styles.MenuBarGameLevelView;this.removeAllChildren(),this.setContentSize2(e.width,
e.height);var t=this.level=this.createLevel(),n=this.progress=this.createProgress(t);this.addChild(n),this.addChild(t),this.onChangeLevelNo(),this.updateProgress(!0),this.addAction()},updateToSmallSize:function(){},createLevel:function(){var e=cleverapps.styles.MenuBarGameLevelView,t=new cc.Scale9Sprite(bundles.menubar.frames.menubar_round_bg_png);t.setAnchorPoint2(),t.setPositionRound(t.width/2,this.height/2);var n=cleverapps.UI.generateImageText("",cleverapps.styles.FONTS.MENUBAR_LEVEL_TEXT);n.setAnchorPoint2(),n.setPositionRound(t.width/2+e.value.offset.x,t.height/2+e.value.offset.y);var s=this.crown=new cleverapps.Spine(bundles.menubar.jsons.crown_json);return s.setAnchorPoint2(),s.setPositionRound(e.crown.offset.x,t.height+e.crown.offset.y),s.setAnimation(0,"idle",!0),t.value=n,t.crown=s,t.addChild(n),t.addChild(s),t},createProgress:function(e){var t=cleverapps.styles.MenuBarGameLevelView,n=new ScaledProgressBar({background:bundles.menubar.frames.menubar_bg_png,
progress:bundles.menubar.frames.menubar_progress_png,padding:t.bar.padding});n.setAnchorPoint(0,.5),n.setDimension(this.width-e.width-t.margin,n.height),n.setPositionRound(e.width+t.margin,this.height/2);var s=cleverapps.UI.generateImageText("",cleverapps.styles.FONTS.MENUBAR_TEXT);return s.setAnchorPoint2(),s.setPositionRound(n.width/2+t.exp.offset.x,n.height/2+t.exp.offset.y),n.exp=s,n.addChild(s),n},updateProgress:function(e){var t=cleverapps.styles.MenuBarGameLevelView,n=this.progress,s=this.item.getCurrentValue(),i=s.currentExp,o=s.thresholdExp,r=Math.floor(t.bar.zeroPercentage+i/o*(100-t.bar.zeroPercentage));e?n.setPercentage(r):n.animatedChange(r-n.getPercentage()),n.exp.setString(i+"/"+o),n.exp.fitTo(n.width-t.exp.padding.x,n.height-t.exp.padding.y),n.exp.baseScale=n.exp.scale},onChangeExpProgress:function(){this.updateProgress(),this.progress.exp.stopAllActions(),this.progress.exp.runAction(new cc.Sequence(new cc.PlaySound(bundles.collectible.urls.exp_fly_finish_effect),
new cc.ScaleTo(.2,1.4*this.progress.exp.baseScale),new cc.ScaleTo(.2,this.progress.exp.baseScale))),this.animateCrowns()},onChangeLevelNo:function(){var e=cleverapps.styles.MenuBarGameLevelView,t=this.level;t.value.setString(this.item.getCurrentValue().level),t.value.fitTo(t.width-2*e.value.padding.x,t.height-2*e.value.padding.y),t.value.baseScale=t.value.scale},animateCrowns:function(){this.crown.setAnimationAndIdleAfter("animation","idle")},addAction:function(){cleverapps.config.debugMode&&cleverapps.UI.onClick(this,this.item.debugAction)}});cleverapps.overrideFonts(cleverapps.styles.FONTS,{MENUBAR_LEVEL_TEXT:{name:"default",size:86}}),cleverapps.styles.MenuBarGameLevelView={width:455,height:65,margin:-52,bar:{zeroPercentage:16,padding:{left:9,right:9,top:7,bottom:10},offset:{x:-1,y:3}},exp:{offset:{x:16,y:3},padding:{x:130,y:13}},value:{padding:{x:16,y:13},offset:{x:1,y:1}},crown:{offset:{x:9,y:-13}}};var GameLevelMenuBarItem=function(e){MenuBarItem.call(this,e),
this.onChangeLevelNo=function(){},this.onChangeExpProgress=function(){}};GameLevelMenuBarItem.prototype=Object.create(MenuBarItem.prototype),(GameLevelMenuBarItem.prototype.constructor=GameLevelMenuBarItem).prototype.customInit=function(){Game.currentGame.gameLevel.onChangeValue=function(){this.onChangeLevelNo()}.bind(this),Game.currentGame.gameLevel.onChangeExp=function(){this.onChangeExpProgress()}.bind(this)},GameLevelMenuBarItem.prototype.debugAction=function(){Game.currentGame.gameLevel.addExp(Game.currentGame.gameLevel.nextLevelThreshold())},GameLevelMenuBarItem.prototype.getCurrentValue=function(){return{level:Game.currentGame.gameLevel.getLevel(),currentExp:cleverapps.user.exp,thresholdExp:Game.currentGame.gameLevel.nextLevelThreshold()}};var UseEnergyButton=cleverapps.UI.Button.extend({ctor:function(e,t){this.price=e.energy,this._super({styles:t,content:this.createContent(e,t),onClicked:e.onClicked,button_images:e.button_images||cleverapps.UI.Button.Images.button_green})},
createContent:function(e,t){var n=new cc.Sprite(bundles.energyup.frames.button_energy_png),s=cleverapps.UI.generateImageText(this.price,e.font||cleverapps.styles.FONTS.BUTTON_TEXT);this.price>cleverapps.lives.amount&&s.setColor(cleverapps.styles.COLORS.COLOR_RED);var i=new cleverapps.Layout([n,s],{direction:cleverapps.UI.HORIZONTAL,margin:t.margin});return n.y+=cleverapps.styles.UseEnergyButton.iconOffsetY,i}});cleverapps.styles.UseEnergyButton={iconOffsetY:-3};var SpeedUpWindow=Window.extend({onWindowLoaded:function(e){this.worker=e,this._super({title:"messages:SpeedUpWindow.title",name:"SpeedUpWindow",content:this.createContent(),adjustToContent:!0,closeButton:!0}),cleverapps.audio.playSound(bundles.main.urls.window_effect)},createContent:function(){var e=cleverapps.styles.SpeedUpWindow,t=cleverapps.UI.generateOnlyText("messages:SpeedUpWindow.text",cleverapps.styles.FONTS.SPEEDUP_WINDOW_TEXT),n=this.createTimer(this.worker.getTimeLeft()),s=this.createButtons()
;return new cleverapps.Layout([s,n,t],{direction:cleverapps.UI.VERTICAL,margin:e.margin,padding:e.padding})},createButtons:function(){var e=cleverapps.styles.SpeedUpWindow.buttons,t=["speedup_worker_ruby"];this.worker.unit&&t.push("speedup_"+this.worker.unit.getKey()+"_ruby");var n=new UseGoldButton({price:SpeedUpWindow.CalcPrice(this.worker.getTimeLeft()),onClicked:this.speedUpForGold.bind(this),font:cleverapps.styles.FONTS.SPEEDUP_WINDOW_BUTTON_IMAGE_TEXT,eventName:t},e.button);if(this.worker.isSpeedUpBonusActive()){var s=new cc.Sprite(bundles.shared.frames.adicon_png);s.setScale(e.reward.scale);var i=new cleverapps.Layout([s,cleverapps.UI.generateOnlyText("messages:Watch",cleverapps.styles.FONTS.SPEEDUP_WINDOW_BUTTON_TEXT)],{direction:cleverapps.UI.HORIZONTAL,margin:e.button.margin}),o=new cleverapps.UI.Button({styles:e.button,content:i,onClicked:this.speedUpForVideo.bind(this),button_images:cleverapps.UI.Button.Images.button_blue}),r=cleverapps.UI.generateOnlyText(
"messages:SpeedUpWindow.hint",cleverapps.styles.FONTS.SPEEDUP_WINDOW_HINT_TEXT,{minutes:Number.parseInt(this.worker.bonus.time)});r.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER)}if(this.isStopAvailable())var a=new cleverapps.UI.Button({styles:e.button,content:cleverapps.UI.generateOnlyText("messages:SpeedUpWindow.stop",cleverapps.styles.FONTS.SPEEDUP_WINDOW_BUTTON_TEXT),onClicked:this.stopWorker.bind(this),button_images:cleverapps.UI.Button.Images.button_red});var c=new cleverapps.Layout([n,o,a],{direction:cleverapps.UI.HORIZONTAL,margin:e.margin,padding:e.padding});return new cleverapps.Layout([r,c],{direction:cleverapps.UI.VERTICAL,margin:e.margin})},createTimer:function(e){var t=cleverapps.styles.SpeedUpWindow.timer,n=new cc.Scale9Sprite(bundles.speedup.frames.timer_substrate);n.setAnchorPoint2(),n.setContentSize2(t);var s=new cleverapps.CountDownView(new cleverapps.CountDown(e,{onFinish:this.close.bind(this)}),{font:cleverapps.styles.FONTS.SPEEDUP_WINDOW_TIMER_TEXT})
;s.setAnchorPoint2(),s.setPositionRound(t.countdown),n.addChild(s);var i=new cc.Sprite(bundles.speedup.frames.timer_icon);return i.setAnchorPoint2(),i.setPositionRound(t.icon),n.addChild(i),n},speedUpForGold:function(){this.close(),cleverapps.metha.distract({focus:"dospeedup",control:"MenuBarGoldItem",actions:[function(e){setTimeout(e,300)},function(e){this.worker.speedUp(),e()}.bind(this)]})},speedUpForVideo:function(){if(this.close(),cleverapps.rewardedAdsManager.isAvailable()){if(this.worker.unit){var n=this.worker.bonus.time,s=cc.p(this.worker.unit.x,this.worker.unit.y);cleverapps.rewardedAdsManager.play(RewardedAdsManager.REWARDED,function(){var e=Game.currentGame.map.getUnit(s.x,s.y),t=Game.currentGame.workers.findAssigned(e);t&&t.speedUpPartially(cleverapps.parseInterval(n),!0)})}}else cleverapps.Notification.create("messages:AdsUnavailable")},stopWorker:function(){this.close(),this.worker.completeAssignment()},isStopAvailable:function(){
return this.worker.unit&&void 0!==this.worker.unit.findComponent(Buildable)}});SpeedUpWindow.CalcPrice=function(e){return Math.max(Math.ceil(.7*(e/60/1e3-.5)),0)},cleverapps.overrideFonts(cleverapps.styles.FONTS,{SPEEDUP_WINDOW_TEXT:{size:70,color:cleverapps.styles.COLORS.DARK_TEXT_COLOR},SPEEDUP_WINDOW_TIMER_TEXT:{size:76,color:cleverapps.styles.COLORS.LIGHT_TEXT_COLOR},SPEEDUP_WINDOW_BUTTON_TEXT:{size:70,color:cleverapps.styles.COLORS.LIGHT_TEXT_COLOR,stroke:cleverapps.styles.DECORATORS.LIGHT_TEXT_STROKE,shadow:cleverapps.styles.DECORATORS.LIGHT_TEXT_SHADOW},SPEEDUP_WINDOW_BUTTON_IMAGE_TEXT:{size:90,color:cleverapps.styles.COLORS.LIGHT_TEXT_COLOR,stroke:cleverapps.styles.DECORATORS.LIGHT_TEXT_STROKE,shadow:cleverapps.styles.DECORATORS.LIGHT_TEXT_SHADOW},SPEEDUP_WINDOW_HINT_TEXT:{size:50,color:cleverapps.styles.COLORS.DARK_TEXT_COLOR}}),cleverapps.styles.SpeedUpWindow={margin:35,padding:{x:120,top:110,bottom:80},timer:{width:470,height:100,countdown:{x:{align:"right",dx:-20},y:{
align:"center",dy:0},width:360},icon:{x:{align:"left",dx:-60},y:{align:"center",dy:0}}},buttons:{margin:30,padding:{x:0,top:15,bottom:0},reward:{scale:1.4},button:{width:400,height:136,padding:{left:30,right:30,top:15,bottom:15},margin:8}}};var BuyFogWindow=Window.extend({onWindowLoaded:function(e){this.fogBlock=e,this._super({name:"BuyFogWindow",title:"messages:"+this.fogBlock.id+".name",content:this.createContent()}),this.addPerson(),cleverapps.audio.playSound(bundles.main.urls.window_effect)},createContent:function(){var e=cleverapps.styles.BuyFogWindow,t=new cc.Node;t.setAnchorPoint2(),t.setContentSize2(e);var n=cleverapps.UI.generateOnlyText("messages:"+this.fogBlock.id+".text",cleverapps.styles.FONTS.WINDOW_TEXT,{tiles:this.fogBlock.tiles.length});n.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER),n.setDimensions(e.width,0),n.fitToHeight(e.text.height),n.setPositionRound(e.text),t.addChild(n);var s=cleverapps.UI.createScale9Sprite(bundles.buyfogwindow.frames.button_block)
;s.setContentSize2(e.buttonBlock),s.setPositionRound(e.buttonBlock);var i=new cc.Sprite(bundles.reward_icons.frames.gold_small_png),o=cleverapps.UI.generateImageText(this.fogBlock.getOpenPrice(),cleverapps.styles.FONTS.BUY_FOG_WINDOW_BUTTON_TEXT),r=new cleverapps.UI.Button({content:new cleverapps.Layout([i,o],{direction:cleverapps.UI.HORIZONTAL,margin:e.buttonBlock.button.margin}),width:e.buttonBlock.button.width,height:e.buttonBlock.button.height,onClicked:function(){this.fogBlock.buy()&&this.close()}.bind(this)});r.setPositionRound(e.buttonBlock.button),s.addChild(r);var a=cleverapps.UI.generateOnlyText("messages:moneyFog.buyNow",cleverapps.styles.FONTS.BUY_FOG_WINDOW_BUY_NOW_TEXT);a.setPositionRound(e.buttonBlock.buyNowText),a.fitTo(e.buttonBlock.button.width),s.addChild(a);var c=new cleverapps.Spine(bundles.buyfogwindow.jsons.island_items_json);return c.setPositionRound(e.buttonBlock.islandItems),c.setAnimation(0,"animation",!0),s.addChild(c),t.addChild(s),t},addPerson:function(){
var e=new cleverapps.Spine(bundles.dialogues.jsons.seller_json);e.setAnchorPoint2(),e.setPositionRound(cleverapps.styles.BuyFogWindow.person),e.setAnimation(0,"special_offer",!0),e.setLocalZOrder(1),this.addChild(e),e.y-=e.height,e.runAction(new cc.MoveBy(.4,0,e.height).easing(cc.easeBackOut()))},listBundles:function(){return["buyfogwindow"]}});cleverapps.overrideFonts(cleverapps.styles.FONTS,{BUY_FOG_WINDOW_BUY_NOW_TEXT:{size:55,color:cleverapps.styles.COLORS.YELLOW_TEXT_COLOR,stroke:cleverapps.styles.DECORATORS.LIGHT_TEXT_STROKE,shadow:cleverapps.styles.DECORATORS.LIGHT_TEXT_SHADOW},BUY_FOG_WINDOW_BUTTON_TEXT:{name:"default",size:70}}),cleverapps.styles.BuyFogWindow={width:1e3,height:650,text:{height:220,x:{align:"center"},y:{align:"top",dy:-15}},person:{x:{align:"center",dx:-650},y:{align:"bottom",dy:-70}},buttonBlock:{width:1020,height:450,x:{align:"center"},y:{align:"bottom",dy:-65},buyNowText:{x:{align:"center",dx:270},y:{align:"top",dy:-115}},button:{x:{align:"center",dx:270},
y:{align:"bottom",dy:115},margin:10,width:330,height:110},islandItems:{x:{align:"left",dx:55},y:{align:"center",dy:5}}}};var BuyIngredientsWindow=Window.extend({onWindowLoaded:function(e,t){this.ingredients=e,this.price=this.calcPrice(),this._super({title:"messages:BuyIngredientsWindow.title",name:"BuyIngredientsWindow",content:this.createContent(),buttons:this.createButton(),adjustToContent:!0,closeButton:!0,onClose:t}),cleverapps.audio.playSound(bundles.main.urls.window_effect)},createContent:function(){var e=cleverapps.styles.BuyIngredientsWindow,t=Object.keys(this.ingredients).map(function(e){return this.createTile({code:e,stage:4,amount:this.ingredients[e]})},this),n=new cleverapps.Layout(t,{direction:cleverapps.UI.HORIZONTAL,margin:e.tiles.margin}),s=cleverapps.UI.generateOnlyText("messages:BuyIngredientsWindow.text",cleverapps.styles.FONTS.DARK_TEXT);return new cleverapps.Layout([n,s],{direction:cleverapps.UI.VERTICAL,margin:e.margin,padding:e.padding})},createTile:function(e){
var t=cleverapps.styles.BuyIngredientsWindow.tile,n=new cc.Node;n.setContentSize2(t.background);var s=cleverapps.UI.createScale9Sprite(bundles.units_shop.frames.bg_png);s.setContentSize2(t.background),s.setPositionRound(t.background),n.addChild(s);var i=cleverapps.UI.createScale9Sprite(bundles.units_shop.frames.amount_bg_png);i.setContentSize2(t.amountBackground),i.setPositionRound(t.amountBackground),n.addChild(i);var o=cleverapps.UI.generateImageText("x"+e.amount,cleverapps.styles.FONTS.BUYINGREDIENTSWINDOW_AMOUNT);o.setPositionRound(t.amountText),n.addChild(o);var r=UnitView.getUnitImage(e);r.setAnchorPoint2(),r.setPositionRound(t.icon),r.setScale(t.icon.scale),n.addChild(r);var a=cleverapps.UI.generateOnlyText(Game.currentGame.unitsLibrary.getUnitName(e),cleverapps.styles.FONTS.DARK_TEXT);return a.setAnchorPoint2(),a.setPositionRound(t.title),a.fitTo(t.title.width),n.addChild(a),n},createButton:function(){var e=cleverapps.styles.BuyIngredientsWindow.button;return new UseGoldButton(
{button_images:cleverapps.UI.Button.Images.button_green,font:cleverapps.styles.FONTS.BUYINGREDIENTSWINDOW_AMOUNT,price:this.price,onClicked:this.buyIngredients.bind(this),image:bundles.reward_icons.frames.gold_small_png,eventName:"buy_ingredients_ruby"},e)},calcPrice:function(){var e=0;for(var t in this.ingredients)e+=3*this.ingredients[t];return e},buyIngredients:function(){Game.currentGame.harvested.addList(this.ingredients),this.close()},listBundles:function(){return["units_shop"]}});cleverapps.overrideFonts(cleverapps.styles.FONTS,{BUYINGREDIENTSWINDOW_AMOUNT:{size:60,color:cleverapps.styles.COLORS.LIGHT_TEXT_COLOR,stroke:cleverapps.styles.DECORATORS.LIGHT_TEXT_STROKE,shadow:cleverapps.styles.DECORATORS.LIGHT_TEXT_SHADOW}}),cleverapps.styles.BuyIngredientsWindow={margin:40,scale:1.4,padding:{x:120,top:100,bottom:230},icons:{margin:20},button:{width:300,height:110,padding:{left:20,right:20,top:5,bottom:10},margin:4},tiles:{margin:60},tile:{background:{width:280,height:450,x:{
align:"center"},y:{align:"center"}},amountBackground:{width:290,height:115,x:{align:"center"},y:{align:"center",dy:-80}},amountText:{x:{align:"center"},y:{align:"center",dy:-68}},icon:{x:{align:"center"},y:{align:"center",dy:75},scale:1.6},title:{width:260,x:{align:"center"},y:{align:"center",dy:-170}}}};var CenterHint=cc.Node.extend({ctor:function(e){this._super(),(this.game=e).onHintMessage=this.createListener(this.textHint.bind(this)),e.onStartMergeHint=this.createListener(this.startMergeHint.bind(this)),e.onFinishMergeHint=this.createListener(this.finishMergeHint.bind(this))},textHint:function(e,t){if(this.stopAllActions(),this.hint){if(this.hint.message===e)return void this.runAction(new cc.Sequence(new cc.DelayTime(1),new cc.CallFunc(function(){this.hideHintView(this.hint),delete this.hint}.bind(this))));this.hideHintView(this.hint),delete this.hint}var n=cleverapps.UI.generateOnlyText("",cleverapps.styles.FONTS.CENTER_HINT_TEXT);n.setVerticalAlignment(
cc.VERTICAL_TEXT_ALIGNMENT_CENTER),n.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER),40<(e=cleverapps.UI.LabelTTF.GetLocalizedText(e)).length&&n.setDimensions(.6*this.width,0),n.setString(e);var s=this.createHintView([n]);s.message=e,this.setLocalZOrder(t?50:15),this.runAction(new cc.Sequence(new cc.CallFunc(function(){this.showHintView(s),this.hint=s}.bind(this)),new cc.DelayTime(2.5),new cc.CallFunc(function(){this.hideHintView(this.hint),delete this.hint}.bind(this))))},startMergeHint:function(e,t){this.setLocalZOrder(15);var n=this.game.gameLevel.getLevel(),s=Families[t.code].units.length;if(!(n<=1||t.stage===s-1||"hero"===t.getType()&&t.stage===s-2)){var i=this.game.map.listAvailableUnits(t).length+1,o=Game.currentGame.mergeBonus(t,e);if(!(i<o.next)){if(this.stopAllActions(),this.hint){if(Unit.Equals(this.hint.unit,t))return;this.hideHintView(this.hint),delete this.hint}if(o.next<=17)var r=Game.currentGame.mergeBonus(t,o.next),a=Messages.get("CenterHint.merge.begins")+" "+o.next,
c=Messages.get("CenterHint.merge.ends")+" "+r.bonus;else a=Messages.get("CenterHint.merge.beginsExtra"),c=Messages.get("CenterHint.merge.endsExtra");var l=[cleverapps.UI.generateOnlyText(a,cleverapps.styles.FONTS.CENTER_HINT_TEXT),UnitView.getUnitImage(t),cleverapps.UI.generateOnlyText(c,cleverapps.styles.FONTS.CENTER_HINT_TEXT),UnitView.getUnitImage({code:t.code,stage:t.stage+1})];cleverapps.UI.fitToBox(l[1],{width:l[1].width,height:1.9*l[0].height}),cleverapps.UI.fitToBox(l[3],{width:l[3].width,height:2.1*l[0].height});var p=this.createHintView(l);p.unit=t,this.runAction(new cc.Sequence(new cc.DelayTime(.5),new cc.CallFunc(function(){this.showHintView(p),this.hint=p}.bind(this))))}}},finishMergeHint:function(){this.stopAllActions(),this.runAction(new cc.Sequence(new cc.DelayTime(.3),new cc.CallFunc(function(){this.hint&&(this.hideHintView(this.hint),delete this.hint)}.bind(this))))},createHintView:function(e){var t=cleverapps.styles.CenterHint,n=new cleverapps.Layout(e,{
direction:cleverapps.UI.HORIZONTAL,margin:t.margin,padding:t.padding}),s=new cc.Scale9Sprite(bundles.merge.frames.hint_background_png);s.setContentSize2(n.width,n.height),s.setAnchorPoint2(),s.setCascadeOpacityEnabled(!0),n.setAnchorPoint2(),n.setPositionRound(n.width/2,n.height/2),n.setCascadeOpacityEnabled(!0),s.addChild(n);var i=new cc.Sprite(bundles.centerhint.frames.worker_hint_png);i.setAnchorPoint2();var o=new cleverapps.Layout([i,s],{direction:cleverapps.UI.HORIZONTAL});return o.setAnchorPoint2(),o.setPositionRound(this.width/2,.8*this.height),o.setCascadeOpacityEnabled(!0),cleverapps.UI.fitToBox(o,{width:.8*this.width,height:o.height}),o},showHintView:function(e){this.addChild(e),e.setOpacity(0),e.stopAllActions(),e.runAction(new cc.FadeIn(.4).easing(cc.easeIn(2)))},hideHintView:function(e){e.stopAllActions(),e.runAction(new cc.Sequence(new cc.FadeOut(.4).easing(cc.easeIn(2)),new cc.RemoveSelf))}});cleverapps.overrideFonts(cleverapps.styles.FONTS,{CENTER_HINT_TEXT:{size:45,
color:cleverapps.styles.COLORS.DARK_TEXT_COLOR}}),cleverapps.styles.CenterHint={margin:10,padding:{x:40,top:12,bottom:35}};var NewElementsWindow=Window.extend({onWindowLoaded:function(e,t,n){this._super({name:e,content:this.createContent(t,n),noBackground:!0,closeButton:!1}),this.addPerson(t),cleverapps.audio.playSound(bundles.newelements.urls.quest_new_effect)},createOneScroll:function(e,t,n){var s=cleverapps.styles.NewElementsWindow.scroll,i=new cleverapps.Spine(bundles.newelements.jsons.scroll_json);i.setAnchorPoint2(),i.setScale(1.3),t.setAnchorPoint2(),t.setPositionRound(s.icon.x,s.icon.y),i.addChild(t);var o=t.scale;t.setScale(0);var r=cleverapps.UI.generateOnlyText(n,cleverapps.styles.FONTS.NEWELEMENTSWINDOW_TEXT);return r.setAnchorPoint2(),r.setPositionRound(s.text.x,s.text.y),r.fitTo(s.text.width,s.text.height),i.addChild(r),r.setOpacity(0),i.runAction(new cc.Sequence(new cc.DelayTime(.5+e),new cc.CallFunc(function(){i.setAnimationAndIdleAfter("open","idle"),t.runAction(
new cc.Sequence(new cc.DelayTime(.5),new cc.ScaleTo(.5,o).easing(cc.easeBackOut(1)))),r.runAction(new cc.Sequence(new cc.DelayTime(.7),new cc.FadeIn(1)))}))),i},createContent:function(e,t){var n=cleverapps.styles.NewElementsWindow;(t=cleverapps.UI.generateOnlyText(t,cleverapps.styles.FONTS.NEWELEMENTSWINDOW_TITLE_TEXT)).setAnchorPoint2();for(var s=[],i=0;i<e.length;i++)s.push(this.createOneScroll(i,e[i].icon,e[i].title));s=new cleverapps.Layout(s,{direction:cleverapps.UI.HORIZONTAL,margin:n.scrolls.margin});var o=new cleverapps.Layout([s,t],{direction:cleverapps.UI.VERTICAL,margin:n.margin,y:n.offsetY});return cleverapps.UI.onClick(o,this.close.bind(this)),t.setScale(.3),t.runAction(new cc.Sequence(new cc.ScaleTo(.26,1.4),new cc.ScaleTo(.37,1))),o},addPerson:function(e){var t=1===e.length?cleverapps.styles.NewElementsWindow.person1:cleverapps.styles.NewElementsWindow.person2,n=Game.currentGame.unitsLibrary.getCurrentHero();bundles.dialogues.jsons[n+"_json"]||(n="dwarf")
;var s=new cleverapps.Spine(bundles.dialogues.jsons[n+"_json"],t.scale);s.setAnchorPoint2(),s.setPositionRound(t.position),s.setAnimation(0,"idle",!0),s.setLocalZOrder(1),this.addChild(s),s.y-=s.height,s.runAction(new cc.MoveBy(.4,0,s.height).easing(cc.easeBackOut()))},listBundles:function(){return["newelements"]}});cleverapps.overrideFonts(cleverapps.styles.FONTS,{NEWELEMENTSWINDOW_TITLE_TEXT:{size:70,color:cleverapps.styles.COLORS.LIGHT_TEXT_COLOR,stroke:cleverapps.styles.DECORATORS.LIGHT_TEXT_STROKE},NEWELEMENTSWINDOW_TEXT:{size:28,color:cleverapps.styles.COLORS.DARK_TEXT_COLOR}}),cleverapps.styles.NewElementsWindow={width:400,height:600,margin:48,offsetY:300,scrolls:{margin:50},scroll:{icon:{x:{align:"center",dx:0},y:{align:"center",dy:30}},text:{x:{align:"center",dx:0},y:{align:"center",dy:-115},width:250,height:void 0}},person1:{position:[{x:{align:"center",dx:-440},y:{align:"bottom",dy:-30}},{x:{align:"center",dx:-440},y:{align:"bottom",dy:-30}},{x:{align:"left",dx:150},y:{
align:"bottom",dy:-30}}],scale:1.3},person2:{position:[{x:{align:"center",dx:-630},y:{align:"bottom",dy:-75}},{x:{align:"center",dx:-630},y:{align:"bottom",dy:-75}},{x:{align:"left",dx:50},y:{align:"bottom",dy:-75}}],scale:1}};var NewRecipesWindow=NewElementsWindow.extend({onWindowLoaded:function(e){for(var t=[],n=0;n<e.length;n++)t.push({icon:this.createIcon(e[n]),title:Messages.get("Units.dishes."+e[n].title+".name")});this._super("newRecipesWindow",t,"messages:NewRecipesWindow.recipes.title")},createIcon:function(e){var t=new cc.Sprite(bundles.newelements.frames.elements_icon_bg);t.setAnchorPoint2(),t.setScale(1.2);var n=UnitView.getUnitImage(e);return n.setAnchorPoint2(),n.setPositionRound(t.width/2,t.height/2),cleverapps.UI.fitToBox(n,{width:.7*t.width,height:.7*t.height}),t.addChild(n),t}});NewRecipesWindow.ListNewRecipes=function(){var t=Game.currentGame.gameLevel.getLevel();return Recipes.filter(function(e){return e.level===t}).map(function(e){return{title:e.code,code:"dishes",
stage:Recipes.indexOf(e)}})};var Worker=function(e){this.options=e,this.unit=void 0,this.start=void 0,this.duration=void 0,this.bonus=void 0,this.onRemove=function(){},this.onStartBuilding=function(e){},this.onCompleteBuilding=function(e){},this.onStartMining=function(e){},this.onCompleteMining=function(e){},this.onSpeedUpAdsChanged=function(){},this.onShowSpeedUp=function(e,t,n){}};Worker.prototype.save=function(){if(this.unit)return{unit:{x:this.unit.x,y:this.unit.y},start:this.start,duration:this.duration}},Worker.prototype.run=function(){if(this.options){var e=Game.currentGame.map.getUnit(this.options.unit.x,this.options.unit.y);if(e&&this.assign(e,this.options.duration,this.options.start))return;this.clearAssignment()}},Worker.MINING_ANIMATION_TIME=3e3,Worker.prototype.isBusy=function(){return void 0!==this.unit},Worker.prototype.assign=function(e,t,n){this.isBusy()&&this.completeAssignment();var s=e&&e.findComponent(Mineable),i=e&&e.findComponent(Buildable);if(!s&&!i)return!1;if(
i&&Game.currentGame.workers.findInstantAssigned(i))return!1;if(Game.currentGame.workers.findAssigned(e))return!1;this.unit=e,this.duration=t,this.start=n||Date.now();var o=this.getTimeLeft();return 0!==t&&0!==o||(o=Worker.MINING_ANIMATION_TIME),this.timeout=new cleverapps.LongTimeout(this.completeAssignment.bind(this),o),Game.currentGame.storeSave(),Game.currentGame.workers.onChangeStatusListener(),Game.currentGame.workers.assignSpeedUpBonus(this),s?(this.onStartMining(s),Game.currentGame.pushes.updateChopped()):i&&(this.onStartBuilding(i),Game.currentGame.pushes.updateBuilt()),!0},Worker.prototype.clearAssignment=function(){clearTimeout(this.timeout),this.unit=void 0,this.start=void 0,this.duration=void 0,this.bonus&&(clearTimeout(this.bonus.timeout),this.bonus=void 0),Game.currentGame.workers.removeRegularIfNeeded(),Game.currentGame.storeSave(),Game.currentGame.workers.onChangeStatusListener()},Worker.prototype.getTimeSpent=function(){return Date.now()-this.start},
Worker.prototype.completeAssignment=function(e){if(this.isBusy()){var t=this.getTimeSpent()+(e||0),n=this.unit;this.clearAssignment();var s=n.findComponent(Mineable);s&&(s.completeMining(),this.onCompleteMining(s));var i=n.findComponent(Buildable);i&&(i.completeBuilding(t),this.onCompleteBuilding(i))}},Worker.prototype.getTimeLeft=function(){var e=this.getTimeSpent();return this.duration-e<0?0:this.duration-e},Worker.prototype.clear=function(){clearTimeout(this.timeout),delete this.timeout,this.bonus&&(clearTimeout(this.bonus.timeout),delete this.bonus)},Worker.prototype.speedUpPartially=function(t,e){if(this.isBusy()){var n=this.unit;this.speedupInProgress=!0;var s=function(){this.completeAssignment(t);var e=n.findComponent(Buildable);e&&!e.isCompleted()&&this.assign(n,e.time),this.speedupInProgress=!1,Game.currentGame.pushes.updateBuilt(),Game.currentGame.pushes.updateChopped()}.bind(this);e?this.onShowSpeedUp(n,Math.min(t,this.getTimeLeft()),s):s()}},
Worker.prototype.speedUp=function(){Game.currentGame.gameEvent(Merge.SPEED_UP,{affected:this.unit}),this.speedUpPartially(this.getTimeLeft())},Worker.prototype.setSpeedUpBonus=function(){this.bonus||(this.bonus={time:Workers.SPEEDUP_BONUS_TIME,timeout:new cleverapps.LongTimeout(this.removeSpeedUpBonus.bind(this),cleverapps.parseInterval(Workers.SPEEDUP_BONUS_DURATION))},this.onSpeedUpAdsChanged())},Worker.prototype.removeSpeedUpBonus=function(){this.bonus&&(clearTimeout(this.bonus.timeout),this.bonus=void 0,this.onSpeedUpAdsChanged())},Worker.prototype.isSpeedUpBonusAvailable=function(){return cleverapps.rewardedAdsManager.isAvailable()&&this.isBusy()&&this.getTimeLeft()>cleverapps.parseInterval(Workers.SPEEDUP_BONUS_MINIMUM_REQUIRED_TIME)&&this.unit.findComponent(Buildable)},Worker.prototype.isSpeedUpBonusActive=function(){return this.bonus};var WorkerView=cc.Node.extend({ctor:function(e){this._super(),(this.worker=e).onRemove=this.removeFromParent.bind(this),
e.onStartBuilding=this.startBuilding.bind(this),e.onCompleteBuilding=this.complete.bind(this),e.onStartMining=this.startMining.bind(this),e.onCompleteMining=this.complete.bind(this),e.onSpeedUpAdsChanged=this.toggleAdsIcon.bind(this),e.onShowSpeedUp=this.showSpeedUp.bind(this)},_startMining:function(e){e.onHideDetails(),this.createMiningAnimation(e),0<cleverapps.parseInterval(e.getTask().time)&&this.showTimer(e)},startMining:function(e){InfoView.CloseInfo(this._startMining.bind(this,e))},createBuildingAnimation:function(e){var t=this.animation=new cleverapps.Spine(bundles.mineable.jsons.mining_start_json),n=WorkerView.mineEffects[e.unit.code]||WorkerView.mineEffects.default;this.sound=cleverapps.audio.playSound(n.sound),t.setAnimation(0,"building",!0),t.setLocalZOrder(2),e.unit.onGetView().addChild(t),t.setPositionRound(cleverapps.styles.WorkerView.buildingAnimation)},createMiningAnimation:function(e){var t=this.animation=new cleverapps.Spine(bundles.mineable.jsons.mining_start_json),
n=WorkerView.mineEffects.default;e.unit.getResource()&&WorkerView.mineEffects[e.unit.getResource()]&&(n=WorkerView.mineEffects[e.unit.getResource()]),this.sound=cleverapps.audio.playSound(n.sound),t.setAnimation(0,n.animation,!0),t.setLocalZOrder(2),e.unit.onGetView().addChild(t);var s=Game.currentGame.map,i=cleverapps.styles.WorkerView.miningAnimation;s.getFog(e.unit.x+Iso.DOWN_RIGHT.x,e.unit.y+Iso.DOWN_RIGHT.y)&&((i=cleverapps.clone(i,!0)).x.dx=i.x.leftDx,t.setScaleX(-1)),t.setPositionRound(i)},removeAnimation:function(){this.animation.removeFromParent(),delete this.animation,cleverapps.audio.stopSound(this.sound)},complete:function(e){this.hideTimer(e),this.removeAnimation()},startBuilding:function(e){InfoView.CloseInfo(function(){cleverapps.audio.playSound(bundles.buildable.urls.build_start_effect),e.onHideDetails(),this.createBuildingAnimation(e),this.showTimer(e)}.bind(this))},showTimer:function(e){this.hideTimer(e);var t=e.unit.onGetView(),n=new ComponentTimer(
this.worker.getTimeLeft(),{buttonCallback:this.worker.speedUp.bind(this.worker),adsActive:this.worker.isSpeedUpBonusActive(),adsCallback:this.worker.unit.handleClick.bind(this.worker.unit)});n.setPositionRound(cleverapps.styles.WorkerView.timer),t.insertAdditionalView("timer",n,function(){},this.worker.speedupInProgress)},hideTimer:function(e){e.unit.onGetView().removeAdditionalView("timer",function(){},this.worker.speedupInProgress)},toggleAdsIcon:function(){var e=this.worker.unit.onGetView().additionalViews.timer;e&&(this.worker.isSpeedUpBonusActive()?e.createAdsIcon():e.removeAdsIcon())},showSpeedUp:function(t,n,s){var i=t.onGetView().additionalViews.timer;cleverapps.metha.display({focus:"AdsTimeSpeedUp",actions:[function(e){setTimeout(e,200)},function(e){Game.currentGame.map.onZoomTo({zoom:1.3,direction:MergeScene.ZOOM_DIRECTION_IN}),Game.currentGame.map.onCenterTo(t.x,t.y,{callback:e})},function(e){i.removeAdsIcon(),i.showBoost({limit:n,duration:Workers.BOOST_ANIMATE_DURATION,
callback:function(){e(),s()}})}]})}});WorkerView.mineEffects={default:{animation:"chop",sound:bundles.mineable.urls.mining_start_effect},wood:{animation:"chop",sound:bundles.mineable.urls.mining_wood_start_effect},stone:{animation:"chop2",sound:bundles.mineable.urls.mining_stone_start_effect},wagon:{animation:"chop2",sound:bundles.mineable.urls.mining_wagon_start_effect},bamboo:{animation:"chop",sound:bundles.mineable.urls.mining_wood_start_effect}},cleverapps.styles.WorkerView={timer:{x:{align:"center",dx:0},y:{align:"center",dy:-29}},miningAnimation:{x:{align:"center",dx:90,leftDx:-45},y:{align:"bottom",dy:0}},buildingAnimation:{x:{align:"center",dx:70},y:{align:"bottom",dy:0}}};var Workers=function(){this.regular=[],this.instant=[],this.onAddWorker=function(){},this.onChangeStatusListener=function(){},this.onChangeTotalAmount=function(){},this.lastSpeedUp=0};Workers.prototype.save=function(){return{regular:this.regular.map(function(e){return e.save()}),
bonusWorkerEnd:this.bonusWorkerEnd,lastSpeedUp:this.lastSpeedUp}},Workers.prototype.clear=function(){this.regular.forEach(function(e){e.clear()}),clearTimeout(this.bonusWorkerTimeout),clearTimeout(this.speedUpTimeout)},Workers.prototype.load=function(e){Array.isArray(e)&&(e={regular:e}),e||(e={regular:[void 0,void 0]}),this.regular=e.regular.map(function(e){return new Worker(e)}),e.bonusWorker&&!e.bonusWorkerEnd&&(e.bonusWorkerEnd=e.bonusWorker+cleverapps.parseInterval(Workers.BONUS_WORKER_PERIOD)),this.bonusWorkerEnd=e.bonusWorkerEnd,this.instant=[],this.lastSpeedUp=e.lastSpeedUp||0,this.assignSpeedUpBonus()},Workers.prototype.runBonusWorker=function(){this.runBonusWorkerTimeout(),this.removeRegularIfNeeded()&&Game.currentGame.storeSave()},Workers.prototype.removeBonusWorker=function(){this.bonusWorkerEnd=void 0,clearTimeout(this.bonusWorkerTimeout),this.bonusWorkerTimeout=void 0,this.removeRegularIfNeeded(),Game.currentGame.storeSave()},Workers.prototype.bonusWorkerLeftTime=function(
){return this.bonusWorkerEnd?this.bonusWorkerEnd-Date.now():0},Workers.prototype.runBonusWorkerTimeout=function(){if(this.bonusWorkerEnd){var e=this.bonusWorkerLeftTime();0<e?this.bonusWorkerTimeout=new cleverapps.LongTimeout(this.removeBonusWorker.bind(this),e):this.removeBonusWorker()}},Workers.prototype.isBonusWorkerBuyed=function(){return 0<this.bonusWorkerLeftTime()},Workers.prototype.addBonusWorkerPeriod=function(e,t){this.isBonusWorkerBuyed()?(this.bonusWorkerEnd+=cleverapps.parseInterval(e),clearTimeout(this.bonusWorkerTimeout),t||this.onChangeTotalAmount()):(this.bonusWorkerEnd=Date.now()+cleverapps.parseInterval(e),this.addRegular(t)),this.runBonusWorkerTimeout(),Game.currentGame.storeSave()},Workers.prototype.buyBonusWorker=function(){return!!levels.user.takeGold(Workers.BONUS_WORKER_PRICE)&&(cleverapps.eventLogger.logEvent(cleverapps.EVENTS.BONUS_WORKER_BOUGHT),this.addBonusWorkerPeriod(Workers.BONUS_WORKER_PERIOD),!0)},Workers.prototype.removeRegularIfNeeded=function(){if(
!this.isBonusWorkerBuyed()&&(2<this.regular.length&&!this.regular[this.regular.length-1].isBusy()))return this.regular.pop().onRemove(),this.onChangeTotalAmount(),!0;return!1},Workers.prototype.countRegularFree=function(){return this.regular.filter(function(e){return!e.isBusy()}).length},Workers.prototype.countRegularTotal=function(){return this.regular.length},Workers.prototype.addRegular=function(e){var t=new Worker;this.regular.push(t),this.onAddWorker(t),e||this.onChangeTotalAmount()},Workers.prototype.addInstant=function(e){-1===this.instant.indexOf(e)&&this.instant.push(e)},Workers.prototype.removeInstant=function(e){var t=this.instant.indexOf(e);-1!==t&&this.instant.splice(t,1)},Workers.prototype.hasInstant=function(){return 0<this.listInstantFree().length},Workers.prototype.findAssigned=function(e){if(e)for(var t=0;t<this.regular.length;t++){var n=this.regular[t];if(n.unit===e)return n}},Workers.prototype.findInstantAssigned=function(e){for(var t=0;t<this.instant.length;t++){
var n=this.instant[t];if(n.assignment===e)return n}},Workers.prototype.findFree=function(){for(var e=0;e<this.regular.length;++e){var t=this.regular[e];if(!t.isBusy())return t}},Workers.prototype.findLeastBusy=function(){for(var e,t=1/0,n=0;n<this.regular.length;++n){var s=this.regular[n];s.isBusy()&&t>s.getTimeLeft()&&(t=(e=s).getTimeLeft())}return e},Workers.prototype.listBusy=function(){return this.regular.filter(function(e){return e.isBusy()})},Workers.prototype.listInstantFree=function(){return this.instant.filter(function(e){return!e.isWorking()})},Workers.prototype.assignSpeedUpBonus=function(e){clearTimeout(this.speedUpTimeout),this.speedUpTimeout=new cleverapps.LongTimeout(this.assignSpeedUpBonus.bind(this),cleverapps.parseInterval(Workers.SPEEDUP_BONUS_CHECK_INTERVAL));var t=(this.lastSpeedUp||0)+cleverapps.parseInterval(Workers.SPEEDUP_BONUS_TIMEOUT);if(!(Date.now()<t)){var n=e?[e]:this.regular;(e=cleverapps.Random.choose(n.filter(function(e){
return e.isSpeedUpBonusAvailable()&&!e.isSpeedUpBonusActive()})))&&(e.setSpeedUpBonus(),this.lastSpeedUp=Date.now(),Game.currentGame.storeSave())}},Workers.BONUS_WORKER_PERIOD="7 day",Workers.BONUS_WORKER_PRICE=225,Workers.SPEEDUP_BONUS_CHECK_INTERVAL="1 minute",Workers.SPEEDUP_BONUS_TIMEOUT="2 hours",Workers.SPEEDUP_BONUS_DURATION="15 minutes",Workers.SPEEDUP_BONUS_TIME="15 minutes",Workers.SPEEDUP_BONUS_MINIMUM_REQUIRED_TIME="2 minutes",cleverapps.config.debugMode&&(Workers.SPEEDUP_BONUS_CHECK_INTERVAL="1 seconds",Workers.SPEEDUP_BONUS_TIMEOUT="1 seconds",Workers.SPEEDUP_BONUS_DURATION="30 seconds"),Workers.BOOST_ANIMATE_DURATION=cleverapps.parseInterval("2 seconds");var BonusWorkerWindow=Window.extend({onWindowLoaded:function(){this._super({name:"BonusWorkerWindow",title:"messages:BonusWorkerWindow.title",content:this.createContent()}),cleverapps.audio.playSound(bundles.main.urls.window_effect)},createInfoBlock:function(){var e=cleverapps.styles.BonusWorkerWindow.infoBlock,
t=cleverapps.UI.createScale9Sprite(bundles.bonusworkerwindow.frames.info_background);t.setContentSize2(e);var n=Game.currentGame.workers.isBonusWorkerBuyed()?"buyed":"buy",s=cleverapps.UI.generateOnlyText("messages:BonusWorkerWindow."+n+".info.title",cleverapps.styles.FONTS.BONUS_WORKER_WINDOW_INFO_TITLE_TEXT);s.fitTo(e.infoTitle.width),s.setPositionRound(e.infoTitle),t.addChild(s);var i=cleverapps.UI.generateOnlyText("messages:BonusWorkerWindow."+n+".info.text",cleverapps.styles.FONTS.BONUS_WORKER_WINDOW_INFO_TEXT);return i.setPositionRound(e.infoText),i.setDimensions(e.infoText.width,0),i.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER),t.addChild(i),t},createContent:function(){var e=cleverapps.styles.BonusWorkerWindow,t=new cc.Node;t.setAnchorPoint2(),t.setContentSize2(e);var n=this.createInfoBlock();n.setPositionRound(e.infoBlock.position),t.addChild(n);var s=new cleverapps.Spine(bundles.dialogues.jsons.worker_json,e.person.scale);if(s.setAnchorPoint2(),s.setPositionRound(e.person)
,s.setAnimation(0,"idle",!0),t.addChild(s),Game.currentGame.workers.isBonusWorkerBuyed()){var i=cleverapps.UI.generateOnlyText("messages:BonusWorkerWindow.buy.lefttime.text",cleverapps.styles.FONTS.BONUS_WORKER_WINDOW_BUY_NOW_TEXT);i.fitTo(e.leftTimeText.width),i.setPositionRound(e.leftTimeText),t.addChild(i);var o=new cleverapps.CountDown(Game.currentGame.workers.bonusWorkerLeftTime()),r=new cleverapps.CountDownView(o,{font:cleverapps.styles.FONTS.BONUS_WORKER_WINDOW_TIMER_TEXT}),a=new cc.Scale9Sprite(bundles.bonusworkerwindow.frames.timer_substrate);a.setAnchorPoint2(),a.setContentSize2(e.timer.width,e.timer.height),r.setAnchorPoint2(),r.setPositionRound(a.width/2+e.timer.text.x,a.height/2+e.timer.text.y),a.addChild(r);var c=new cc.Sprite(bundles.bonusworkerwindow.frames.sanglass_timer_icon);c.setAnchorPoint2(),c.setPositionRound(e.timer.iconOffsetX,a.height/2),a.addChild(c),a.setPositionRound(e.timer),t.addChild(a)}else{var l=cleverapps.UI.generateOnlyText(
"messages:BonusWorkerWindow.buy.buynow.text",cleverapps.styles.FONTS.BONUS_WORKER_WINDOW_BUY_NOW_TEXT);l.fitTo(e.buyNowText.width),l.setPositionRound(e.buyNowText),t.addChild(l);var p=new cc.Sprite(bundles.reward_icons.frames.gold_small_png),d=cleverapps.UI.generateImageText(Workers.BONUS_WORKER_PRICE,cleverapps.styles.FONTS.BONUS_WORKER_WINDOW_BUTTON_TEXT),u=new cleverapps.UI.Button({content:new cleverapps.Layout([p,d],{direction:cleverapps.UI.HORIZONTAL,margin:e.button.margin}),width:e.button.width,height:e.button.height,onClicked:function(){Game.currentGame.workers.buyBonusWorker()&&this.close()}.bind(this)});u.setPositionRound(e.button),t.addChild(u)}return t}});cleverapps.overrideFonts(cleverapps.styles.FONTS,{BONUS_WORKER_WINDOW_BUTTON_TEXT:{name:"default",size:70},BONUS_WORKER_WINDOW_TIMER_TEXT:{size:45,color:cleverapps.styles.COLORS.LIGHT_TEXT_COLOR},BONUS_WORKER_WINDOW_INFO_TITLE_TEXT:{size:55,color:cleverapps.styles.COLORS.YELLOW_TEXT_COLOR,
stroke:cleverapps.styles.DECORATORS.LIGHT_TEXT_STROKE,shadow:cleverapps.styles.DECORATORS.LIGHT_TEXT_SHADOW},BONUS_WORKER_WINDOW_BUY_NOW_TEXT:{size:45,color:cleverapps.styles.COLORS.DARK_TEXT_COLOR},BONUS_WORKER_WINDOW_INFO_TEXT:{size:45,color:cleverapps.styles.COLORS.WHITE,stroke:cleverapps.styles.DECORATORS.LIGHT_TEXT_STROKE,shadow:cleverapps.styles.DECORATORS.LIGHT_TEXT_SHADOW}}),cleverapps.styles.BonusWorkerWindow={width:1470,height:550,infoBlock:{width:1500,height:450,position:{x:{align:"center"},y:{align:"top",dy:15}},infoTitle:{x:{align:"center",dx:380},y:{align:"top",dy:-60},width:650},infoText:{x:{align:"center",dx:380},y:{align:"center",dy:-30},width:680}},timer:{iconOffsetX:30,width:360,height:85,text:{x:15,y:2},x:{align:"right",dx:-20},y:{align:"bottom",dy:-25}},buyNowText:{width:380,x:{align:"right",dx:-450},y:{align:"bottom",dy:-10}},leftTimeText:{width:380,x:{align:"right",dx:-420},y:{align:"bottom",dy:-10}},button:{margin:10,width:380,height:130,x:{align:"right",dx:-20
},y:{align:"bottom",dy:-50}},person:{scale:1.5,x:{align:"left",dx:50},y:{align:"bottom",dy:-10}}};var Recipes=[{code:"icecream",level:1,time:"10 seconds",ingredients:{wheat:2},prize:[{code:"wands",stage:0},{code:"coins",stage:1}]},{code:"cookies",level:4,time:"45 seconds",ingredients:{candies:2},prize:[{code:"wands",stage:0},{code:"coins",stage:0},{code:"coins",stage:0}]},{code:"gingerbread",level:4,time:"90 seconds",ingredients:{candies:2,wheat:3},prize:[{code:"wands",stage:0},{code:"coins",stage:0},{code:"coins",stage:0}]},{code:"croissant",level:5,time:"15 minutes",ingredients:{candies:3,wheat:4},prize:[{code:"wands",stage:0},{code:"wands",stage:0},{code:"coins",stage:0}]},{code:"caramelpie",level:6,time:"5 minutes",ingredients:{candies:2,wheat:2},prize:[{code:"wands",stage:0},{code:"coins",stage:0}]},{code:"bakedapple",level:7,time:"5 minutes",ingredients:{apple:4},prize:[{code:"wands",stage:0},{code:"coins",stage:0}]},{code:"applejam",level:7,time:"15 minutes",ingredients:{
apple:5,wheat:2},prize:[{code:"wands",stage:1},{code:"coins",stage:0}]},{code:"caramelapple",level:8,time:"10 minutes",ingredients:{apple:4,wheat:2},prize:[{code:"wands",stage:0},{code:"wands",stage:0},{code:"coins",stage:0},{code:"coins",stage:0}]},{code:"applepie",level:8,time:"25 minutes",ingredients:{candies:6,apple:2,wheat:2},prize:[{code:"wands",stage:0},{code:"wands",stage:1},{code:"coins",stage:1}]},{code:"strawberryjuice",level:9,time:"5 minutes",ingredients:{strawberry:4},prize:[{code:"wands",stage:0},{code:"coins",stage:0}]},{code:"strawberrycake",level:9,time:"30 minutes",ingredients:{candies:4,wheat:3,strawberry:5},prize:[{code:"wands",stage:1},{code:"wands",stage:1},{code:"coins",stage:0},{code:"coins",stage:1}]},{code:"salad",level:10,time:"18 minutes",ingredients:{candies:2,strawberry:6},prize:[{code:"wands",stage:1},{code:"coins",stage:0},{code:"coins",stage:0}]},{code:"bubblegum",level:11,time:"20 minutes",ingredients:{wheat:6,apple:3},prize:[{code:"wands",stage:1},{
code:"coins",stage:1}]},{code:"granola",level:12,time:"20 minutes",ingredients:{candies:4,apple:5},prize:[{code:"wands",stage:1},{code:"coins",stage:1}]},{code:"strawberrypie",level:12,time:"15 minutes",ingredients:{strawberry:4,candies:3},prize:[{code:"wands",stage:1},{code:"coins",stage:0}]},{code:"mushroomcnacks",level:13,time:"5 minutes",ingredients:{mushrooms:4},prize:[{code:"wands",stage:0},{code:"coins",stage:0}]},{code:"mintcookies",level:13,time:"18 minutes",ingredients:{mushrooms:6,candies:2},prize:[{code:"wands",stage:1},{code:"coins",stage:0},{code:"coins",stage:0}]},{code:"stage18",level:14,time:"30 minutes",ingredients:{mushrooms:2,wheat:6,apple:2},prize:[{code:"wands",stage:0},{code:"wands",stage:1},{code:"coins",stage:1},{code:"coins",stage:0}]},{code:"stage19",level:15,time:"15 minutes",ingredients:{mushrooms:4,strawberry:2},prize:[{code:"wands",stage:1},{code:"coins",stage:0}]},{code:"stage20",level:16,time:"20 minutes",ingredients:{mushrooms:4,candies:2,corn:2},
prize:[{code:"wands",stage:0},{code:"wands",stage:0},{code:"coins",stage:0},{code:"coins",stage:0}]}],Orders=function(){cleverapps.EventEmitter.call(this),this.makers=[]};Orders.prototype=Object.create(cleverapps.EventEmitter.prototype),(Orders.prototype.constructor=Orders).prototype.getMaker=function(t){return this.makers.filter(function(e){return e.unit.code===t})[0]},Orders.prototype.listOrders=function(){return this.makers.filter(function(e){return e.state!==MakesOrder.STATE_EMPTY}).map(function(e){return{code:"dishes",stage:Recipes.indexOf(e.recipe),recipe:e.recipe,maker:e,type:"order"}})},Orders.prototype.findMaker=function(t){return this.makers.filter(function(e){return e.recipe===t})[0]},Orders.prototype.addOrder=function(e){-1===this.makers.indexOf(e)&&this.makers.push(e)},Orders.prototype.updateOrder=function(e){this.trigger("updateOrder",e),this.updateIngredients()},Orders.prototype.findCanCook=function(){for(var e=0;e<this.makers.length;e++)if(this.makers[e].canCook()
)return this.makers[e]},Orders.prototype.findReady=function(){for(var e=0;e<this.makers.length;e++)if(this.makers[e].isReady())return this.makers[e]},Orders.prototype.updateIngredients=function(){this.makers.forEach(function(e){e.onUpdateIngredients()}),this.trigger("canCook"),cleverapps.sideBar.resetByClassName(OrdersIcon)},Orders.prototype.chooseFreeRecipe=function(){var e=Recipes.filter(function(t,e){return 0<e&&Game.currentGame.harvested.isAvailableList(t.ingredients)&&t.level<=Game.currentGame.gameLevel.getLevel()&&this.makers.every(function(e){return e.recipe!==t})},this);if(0===e.length&&1<Game.currentGame.gameLevel.getLevel())return Recipes[0];if(e.length<=3)return cleverapps.Random.choose(e);for(var t=e.length-1;0<t&&cleverapps.Random.nextDouble()<.6;)t--;return e[t]};var Quest=function(e){cleverapps.EventEmitter.call(this),this.config=QuestsConfig[e.id].quest,this.id=e.id,this.type=this.config.type,this.unit=this.config.unit,this.progress=e.progress||0,
this.goal=e.goal||e.amount||1,this.fresh=e.fresh};Quest.prototype=Object.create(cleverapps.EventEmitter.prototype),(Quest.prototype.constructor=Quest).prototype.addProgress=function(e){this.progress+=e||1,this.progress>this.goal&&(this.progress=this.goal),this.isFinished()&&Game.currentGame.counter.setTimeout(function(){},0),this.trigger("updateProgress",this),Game.currentGame.storeSave(),cleverapps.sideBar.resetByClassName(QuestsSideBarIcon)},Quest.prototype.onClick=function(){Game.currentGame.quests.select(this)},Quest.prototype.setFresh=function(e){this.fresh=e},Quest.prototype.isFresh=function(){return this.fresh},Quest.prototype.select=function(){this.selected||(this.selected=!0,this.trigger("select",this))},Quest.prototype.unselect=function(){this.selected&&(this.selected=!1,this.trigger("unselect",this))},Quest.prototype.getSpawnTargets=function(e){e=e||0;var t=[],n=Game.currentGame,s=(this.unit.code,this.unit.stage);if("dishes"===this.unit.code){var i=Recipes[s],
o=n.orders.findMaker(i)||n.orders.makers[0];return o?[o]:[]}return t=Unit.getPreviousStagesTargets(this.unit.code,this.unit.stage+e),n.unitsLibrary.listCodesByType(["chest","source","generator"]).forEach(function(e){t=t.concat(Unit.getAllStagesTargets(e))}),t},Quest.prototype.getBuildUnits=function(){var e=this.getSpawnTargets(1);return Game.currentGame.map.listAvailableUnits(e).filter(function(e){if(Unit.Equals(e,this.unit)){var t=e.findComponent(Buildable);return t&&t.state===Buildable.STATES.WAIT}return!0},this)},Quest.prototype.getTargetUnits=function(){var e=Game.currentGame;switch(this.type){case Merge.SPAWN:return e.map.listAvailableUnits(this.getSpawnTargets());case Merge.HARVEST:return e.map.listAvailableUnits(this.getSpawnTargets(1));case Merge.MINE:return e.map.listAvailableUnits(this.unit);case Merge.BUILD:return this.getBuildUnits();case Merge.OPENFOG:return e.fogs.findAvailableFogBlock().head;case Merge.OPENDRAGON:return e.fogs.blocks.dragonIsland.head}return[]},
Quest.prototype.find=function(){var e=Game.currentGame.map,i=e.getScreenCenterCell(),t=cleverapps.toArray(this.getTargetUnits()),n={};t.forEach(function(e){if(e instanceof Unit&&e.isMergeable(e)){var t=Unit.GetKey(e);n[t]=(n[t]||0)+1}}),t=t.filter(function(e){return!(e instanceof Unit)||!e.isMergeable(e)||e.getData().chest||3<=n[Unit.GetKey(e)]});var s=this.unit&&this.unit.code,o=["chest","source","generator"],r=function(e){var t=e.stage;return e.code===s&&(t-=1e3),t+=100*(o.indexOf(e.type)+1)};t.sort(function(e,t){var n=r(e),s=r(t);return n!==s?n-s:cc.getDistanceChebyshev(e,i)-cc.getDistanceChebyshev(t,i)}),0!==t.length?(e.onCenterTo(t[0].x,t[0].y),e.onAddTarget(t[0].x,t[0].y)):cleverapps.Notification.create("messages:Quest.find.empty")},Quest.prototype.isFinished=function(){return this.progress>=this.goal},Quest.prototype.getTitle=function(){if(this.unit){var e=Families[this.unit.code];if("hero"===e.type&&this.unit.stage===e.units.length-1)return Messages.get("Quest.hero.title")}
return Messages.get("Quest."+this.type+".title")},Quest.prototype.save=function(){var e={id:this.id,goal:this.goal,progress:this.progress};return this.fresh&&(e.fresh=!0),e},Quest.prototype.getDialogue=function(){return QuestsConfig[this.id].dialogue},Quest.prototype.getTutorial=function(){return QuestsConfig[this.id].tutorial&&MergeTutorials[QuestsConfig[this.id].tutorial]},Quest.prototype.showDialogue=function(e){var t=this.getDialogue();if(t){var n=cleverapps.clone(t,!0);n.forEach(function(e){if(e.person){var t=cleverapps.styles.DialogueView.persons[e.person];t?e.person=t:delete e.person}if(e.person2){var n=cleverapps.styles.DialogueView.persons[e.person2];n?e.person2=n:delete e.person2}},this);var s=new Dialogue(n,{showUp:!0,autoClose:!1,autoScroll:!1}),i=function(){!s.typing&&s.stage>=s.data.length-1&&s.close()};s.on("buttonClicked",i),s.on("screenClicked",i),s.on("afterClose",e),new DialogueView(s,{screenClicked:!0,overlay:!0,button:{noButton:!0},delay:0}),s.run()}else e()},
Quest.prototype.showTutorial=function(e){var t=this.getTutorial();t?Game.currentGame.tutorial.showTutorial(t,e):e()},Quest.prototype.isApplicable=function(e,t){if(this.config.type!==e)return!1;var n=t&&(t.unit||t.affected);switch(Array.isArray(n)&&(n=n[0]),e){case Merge.SPAWN:case Merge.MINE:case Merge.BUILD:case Merge.HARVEST:return Unit.Equals(this.config.unit,n)}return!0};var Quests=function(e){cleverapps.EventEmitter.call(this);var t=Game.currentGame;this.quests=[],this.storeSelected=cleverapps.accumulate(3e4,this.storeSelected.bind(this)),t.unitsLibrary.on("unitAvailable",this.unitAvailable.bind(this)),e&&this.load(e),t.on("gameEvent",this.onGameEvent.bind(this))};Quests.prototype=Object.create(cleverapps.EventEmitter.prototype),(Quests.prototype.constructor=Quests).prototype.migrateLinear=function(e){var t=e&&e.quests||[];t.forEach(function(e){"woodsource_1"===e.id?e.id=1===e.configIndex?"woodsource_1_1":"woodsource_1_0":"wood_9"===e.id&&1===e.configIndex&&(e.id="wheat_4")})
;var n={};e.quests=t.filter(function(e){if(!n[e.id])return n[e.id]=!0})},Quests.prototype.load=function(e){if(!cleverapps.config.wysiwygMode||!cleverapps.flags.wysiwyg.skipQuests){this.migrateLinear(e),this.quests=(e&&e.quests||[]).filter(function(e){return QuestsConfig[e.id]}).map(function(e){return new Quest(e)});var t=e.selected;(void 0===t||t<0||t>=this.quests.length)&&(t=this.quests.length-1),this.quests[t]&&this.select(this.quests[t],t===e.selected)}},Quests.prototype.deleteHeroItemsQuests=function(t){if(!this.isEmpty()){var e=this.getSelectedQuest();this.quests=this.quests.filter(function(e){return!(e.unit&&e.unit.code===t&&e.unit.stage<Families[e.unit.code].units.length-1)}),this.chooseSelected(e)}},Quests.prototype.chooseSelected=function(e){if(this.selected=-1,0<this.quests.length)if(-1!==this.quests.indexOf(e))this.select(e);else for(var t=this.quests.length-1;0<=t;t--)if(!this.quests[t].isFresh()){this.select(this.quests[t]);break}cleverapps.sideBar.resetByClassName(
QuestsSideBarIcon),Game.currentGame.storeSave()},Quests.prototype.save=function(){var e=this.quests.map(function(e){return e.save()});return this.dirtySelected=!1,{quests:e,selected:this.selected}},Quests.prototype.getSelectedQuest=function(){return this.quests[this.selected]},Quests.prototype.select=function(e,t){var n=this.quests.indexOf(e);if(-1!==n&&n!==this.selected){var s=void 0!==this.selected&&this.quests[this.selected];s&&s.unselect(),this.selected=n,e.select(),this.trigger("select",this.selected),cleverapps.sideBar.resetByClassName(QuestsSideBarIcon),t||(this.dirtySelected=!0,this.storeSelected())}},Quests.prototype.storeSelected=function(){this.dirtySelected&&Game.currentGame.storeSave()},Quests.prototype.isRunning=function(t){return this.quests.some(function(e){return t===e.id})},Quests.prototype.isEmpty=function(){return 0===this.quests.length},Quests.prototype.create=function(t){if(!cleverapps.config.wysiwygMode||!cleverapps.flags.wysiwyg.skipQuests){
var e=cleverapps.values(QuestsConfig).filter(function(e){return!(!e.trigger||this.isRunning(e.id))&&(!!e.trigger.unit&&Unit.Equals(t.unit,e.trigger.unit))}.bind(this));0<e.length&&(e.forEach(function(e){var t=new Quest(e.quest);t.setFresh(!0),this.quests.push(t)}.bind(this)),Game.currentGame.storeSave(),Game.currentGame.counter.setTimeout(function(){},0))}},Quests.prototype.unitAvailable=function(e){this.create({unit:e})},Quests.prototype.findFinishedIndex=function(){for(var e=0;e<this.quests.length;e++)if(this.quests[e].isFinished())return e;return-1},Quests.prototype.finish=function(){if(!cleverapps.metha.isFocused()){var e=this.findFinishedIndex();if(-1!==e){var t=this.quests[e],n=this.getSelectedQuest(),s=function(){this.quests.splice(e,1),this.chooseSelected(n)}.bind(this);cleverapps.metha.display({focus:"FinishQuest",control:["MenuBarGoldItem","MenuBarGameLevelItem","MenuBarLivesItem","MenuBarCoinsItem"],actions:[function(e){new FinishQuestWindow(t,s),
cleverapps.metha.onceNoWindowsListener=e}.bind(this),function(e){Game.currentGame.counter.setTimeout(e,300)}]})}}},Quests.prototype.getFreshQuestsBatch=function(){var e=this.quests.filter(function(e){return e.isFresh()}),t=e.filter(function(e){return e.getTutorial()||e.getDialogue()});return e=cleverapps.substract(e,t,function(e){return e.id}),(e=t.slice(0,1).concat(e)).slice(0,2)},Quests.prototype.processFresh=function(){if(!cleverapps.metha.isFocused()){var t=this.getFreshQuestsBatch(),n=t[0];0!==t.length&&cleverapps.metha.display({focus:"StartQuest",control:["MenuBarGameLevelItem","MenuBarCoinsItem"],actions:[function(e){if(n.config.attentionTo){var t=n.config.attentionTo();Game.currentGame.map.onCenterTo(t.x,t.y,{duration:MergeScene.SCROLL_TO_DURATION}),e()}else e()},function(e){n.config.silent?e():Game.currentGame.counter.setTimeout(function(){n.showDialogue(e)},300)},function(e){cleverapps.metha.hideControlsWhileFocused(["MenuBarGameLevelItem","MenuBarCoinsItem"]),t.forEach(
function(e){e.setFresh(!1)}),this.select(t[t.length-1]),Game.currentGame.storeSave(),cleverapps.sideBar.resetByClassName(QuestsSideBarIcon),n.config.silent?e():(new StartQuestWindow(t),cleverapps.metha.onceNoWindowsListener=e)}.bind(this),function(e){Game.currentGame.counter.setTimeout(e,300)},function(e){n.showTutorial(e)}]})}},Quests.prototype.onGameEvent=function(t,n){this.quests.forEach(function(e){e.isApplicable(t,n)&&e.addProgress(n&&n.amount||1)},this),t===Merge.OPENFOG&&this.create(n)};var QuestIcon=cc.Node.extend({ctor:function(e,t){this._super(),this.quest=e,this.options=t=t||{};var n,s=cleverapps.styles.QuestIcon;t.round?(n=this.background=new cc.Sprite(bundles.sidebar.frames.icon_bg)).setScale(s.roundBackground.scale):(n=this.background=new cc.Scale9Sprite(bundles.mergeui.frames.icon_background)).setContentSize2(s.background),n.setPositionRound({align:"center"},{align:"center"}),this.setContentSize2(n.width*n.scale,n.height*n.scale),this.setAnchorPoint2(),this.addChild(n)
;var i=QuestIcon.getIconImage(e);if(cleverapps.UI.fitToBox(i,{width:.7*this.width,height:.7*this.height,maxScale:s.icon.maxScale}),i.setPositionRound(s.icon),this.addChild(i),!1!==t.progress){var o=this.progress=new QuestProgressView(e);o.setPositionRound(s.progress),this.addChild(o)}e.on("select",this.update.bind(this),this),e.on("unselect",this.update.bind(this),this),this.update(),!1!==t.clickable&&cleverapps.UI.onClick(this,function(){cleverapps.audio.playSound(bundles.main.urls.click_effect),e.onClick()}.bind(this),{swallowTouches:!1,ignoreOnTouchMoved:!0,useInteractiveScale:!0})},update:function(){if(!this.options.round){var e=bundles.mergeui.frames.icon_background;this.quest.selected&&(e=bundles.mergeui.frames.icon_background_light),this.background.setSpriteFrame(new cc.Sprite(e).getSpriteFrame())}}});QuestIcon.getIconImage=function(e){switch(e.type){case Merge.SPAWN:case Merge.BUILD:case Merge.MINE:case Merge.HARVEST:return UnitView.getUnitImage(e.unit);case Merge.OPENFOG:
return new cc.Sprite(bundles.unit_icons.frames.fog_icon_png);case Merge.OPENDRAGON:return UnitView.getUnitImage({code:"dragonmine",stage:0})}},cleverapps.styles.QuestIcon={background:{width:300,height:300},roundBackground:{scale:1.3},icon:{x:{align:"center"},y:{align:"center",dy:10},maxScale:1.6},progress:{x:{align:"center"},y:{align:"bottom",dy:-10}}};var QuestProgressView=cc.Node.extend({ctor:function(e){this._super();var t=this.styles=cleverapps.styles.QuestProgressView;this.quest=e;var n=this.background=cleverapps.UI.createSprite(t.background);this.setContentSize2(n.getContentSize()),this.setAnchorPoint2(),n.setPositionRound(this.width/2,this.height/2),this.addChild(n);var s=this.progressText=cleverapps.UI.generateImageText("",cleverapps.styles.FONTS.QUEST_PROGRESS_TEXT);s.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER),s.setPositionRound(t.text),this.addChild(s),e.on("updateProgress",this.update.bind(this),this),this.update()},update:function(){this.progressText.setString(
this.quest.progress+"/"+this.quest.goal),this.progressText.fitTo({width:.9*this.background.width,height:0})}});cleverapps.overrideFonts(cleverapps.styles.FONTS,{QUEST_PROGRESS_TEXT:{name:"default",size:60,color:cleverapps.styles.COLORS.LIGHT_TEXT_COLOR}}),cleverapps.styles.QuestProgressView={text:{x:{align:"center"},y:{align:"center",dy:3}},background:{image:bundles.sidebar.frames.caption_bg,width:240,height:90,scale9:!0}};var QuestsWindow=Window.extend({onWindowLoaded:function(){this._super({name:"QuestsWindow",title:"messages:QuestsWindow.title",content:this.createContent(),adjustToContent:!0,closeButton:!0,foreground:bundles.windows.frames.window_foreground_png}),Game.currentGame.quests.on("select",this.createDetails.bind(this),this),cleverapps.audio.playSound(bundles.main.urls.window_effect)},createContent:function(){var e=cleverapps.styles.QuestsWindow,t=new cc.Node;t.setAnchorPoint2(),t.setContentSize2(e);var n=this.createDetails();n.setAnchorPoint2(),n.setPositionRound(e.details
),t.addChild(n);var s=this.createSelect();return s.setAnchorPoint2(),s.setPositionRound(e.select),t.addChild(s),t},createDetails:function(){var e=cleverapps.styles.QuestsWindow.details,t=this.details;t?t.removeAllChildren():((t=this.details=cleverapps.UI.createScale9Sprite(bundles.unitslibrarywindow.frames.ow_details_background,cleverapps.UI.Scale9Rect.TwoPixelXY)).setContentSize2(e),t.setAnchorPoint2());var n=Game.currentGame.quests.getSelectedQuest();if(!n)return t;var s=new QuestIcon(n,{round:!0,clickable:!1});s.setPositionRound(e.icon),s.setScale(e.icon.scale),t.addChild(s);var i=cleverapps.UI.generateOnlyText(n.getTitle(),cleverapps.styles.FONTS.QUEST_DETAILS_TITLE_TEXT);i.setDimensions(e.title.fitTo.width,0),i.fitToHeight(e.title.fitTo.height),i.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER),i.setPositionRound(e.title),t.addChild(i);var o=this.button=new cleverapps.UI.Button({width:e.button.width,height:e.button.height,maxWidth:e.button.maxWidth,
text:"messages:QuestsWindow.find",font:cleverapps.styles.FONTS.QUEST_DETAILS_BUTTON_TEXT,onClicked:function(){n.find(),this.close()}.bind(this)});o.setPositionRound(e.button),t.addChild(o);var r=new RewardsListComponent(n.config.prize,{font:cleverapps.styles.FONTS.QUEST_REWARDS_TEXT,iconScale:e.rewards.scale,title:{text:"messages:RewardsListComponent.rewardTitle",direction:cleverapps.UI.HORIZONTAL},amountInRow:6,reward:{direction:cleverapps.UI.HORIZONTAL,amountPrefix:""}});return r.setPositionRound(e.rewards),t.addChild(r),t},createSelect:function(){var e=cleverapps.styles.QuestsWindow.select,t=this.icons=Game.currentGame.quests.quests.map(function(e){return new QuestIcon(e)},this),n=this.select=new cleverapps.Layout(t,{direction:cleverapps.UI.HORIZONTAL,padding:e.padding,margin:e.margin});return n.width>e.width&&(this.select=new cleverapps.UI.ScrollView(n,{childrenVisibility:cleverapps.UI.ScrollView.CHILDREN_VISIBILITY_NONE,direction:cleverapps.UI.ScrollView.DIR_HORIZONTAL,
scrollBarEnabled:!1}),this.select.setContentSize(e.width,n.height),this.select.scrollToDefault()),this.select.setAnchorPoint2(),this.select}});cleverapps.overrideFonts(cleverapps.styles.FONTS,{QUEST_DETAILS_TITLE_TEXT:{size:60,color:cleverapps.styles.COLORS.LIGHT_TEXT_COLOR,stroke:cleverapps.styles.DECORATORS.LIGHT_TEXT_STROKE,shadow:cleverapps.styles.DECORATORS.LIGHT_TEXT_SHADOW},QUEST_REWARDS_TEXT:{name:"default",size:60,color:cleverapps.styles.COLORS.LIGHT_TEXT_COLOR,stroke:cleverapps.styles.DECORATORS.LIGHT_TEXT_STROKE,shadow:cleverapps.styles.DECORATORS.LIGHT_TEXT_SHADOW},QUEST_DETAILS_BUTTON_TEXT:{size:60,color:cleverapps.styles.COLORS.LIGHT_TEXT_COLOR,stroke:cleverapps.styles.DECORATORS.LIGHT_TEXT_STROKE,shadow:cleverapps.styles.DECORATORS.LIGHT_TEXT_SHADOW}}),cleverapps.styles.QuestsWindow={width:2e3,height:1050,details:{width:1850,height:500,x:{align:"center",dx:0},y:{align:"top",dy:-80},icon:{x:{align:"left",dx:100},y:{align:"center",dy:-5},scale:1.2},title:{x:{
align:"center",dx:0},y:{align:"center",dy:50},fitTo:{width:840,height:110}},button:{x:{align:"right",dx:-80},y:{align:"center",dy:40},maxWidth:380,width:300,height:110},rewards:{x:{align:"center",dx:0},y:{align:"center",dy:-80},titleMargin:20,scale:.5}},select:{width:1950,margin:60,x:{align:"left",dx:25},y:{align:"top",dy:-580},icon:{scale:1.4},padding:{x:60,y:70}}};var StartQuestWindow=NewElementsWindow.extend({onWindowLoaded:function(e){var t=cleverapps.toArray(e).map(function(e){return{icon:this.createIcon(e),title:e.getTitle()}},this);this._super("StartQuestWindow",t,Messages.get("StartQuestWindow.title"))},createIcon:function(e){var t=new QuestIcon(e,{round:!0,clickable:!1});return t.setScale(.7),t}}),FinishQuestWindow=Window.extend({onWindowLoaded:function(e,t){this.quest=e,this.callback=t||function(){},this._super({name:"FinishQuestWindow",content:this.createContent(),noBackground:!0,closeButton:!1}),this.addPerson(),cleverapps.audio.playSound(
bundles.newelements.urls.quest_completed_effect)},createContent:function(){var e=cleverapps.styles.FinishQuestWindow,t=cleverapps.UI.generateOnlyText(Messages.get("FinishQuestWindow.title").replace(/\s+/g,"\n"),cleverapps.styles.FONTS.FINISHQUESTWINDOW_TITLE_TEXT);t.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER),t.setAnchorPoint2();var n=new cc.Node;n.setAnchorPoint2(),n.setContentSize2(e.middle.width,e.middle.height);var s=new QuestIcon(this.quest,{round:!0,clickable:!1,progress:!1});s.setAnchorPoint2(),s.setPositionRound(e.middle.icon.x,e.middle.icon.y),s.setScale(e.middle.icon.scale),n.addChild(s);var i=new cleverapps.Spine(bundles.newelements.jsons.shining_json,e.middle.shining.scale);i.setAnchorPoint2(),i.setLocalZOrder(-1),i.setPositionRound(e.middle.shining.x,e.middle.shining.y),i.setAnimation(0,"animation",!0),n.addChild(i);var o=this.rewards=new RewardsListComponent(this.quest.config.prize,{font:cleverapps.styles.FONTS.FINISHQUESTWINDOW_REWARD_TEXT,iconScale:e.rewards.scale,
title:"messages:RewardsListComponent.rewardTitle",amountInRow:6,reward:{direction:cleverapps.UI.HORIZONTAL,amountPrefix:""}});o.setLocalZOrder(1);var r=new cleverapps.Layout([o,n,t],{direction:cleverapps.UI.VERTICAL,y:e.offsetY});return cleverapps.UI.onClick(r,this.close.bind(this)),t.runAction(new cc.Sequence(new cc.ScaleTo(.26,1.4),new cc.ScaleTo(.37,1))),o.setVisible(!1),o.runAction(new cc.Sequence(new cc.DelayTime(.36),new cc.Show,new cc.ScaleTo(.2,1.14),new cc.ScaleTo(.2,1))),r},close:function(){if(!this.closing){this.closing=!0;var e=300;e=this.rewards.gameReceiveRewards(e),e+=1e3,Game.currentGame.counter.setTimeout(Window.prototype.close.bind(this),e),this.callback()}},addPerson:function(){var e=cleverapps.styles.FinishQuestWindow.person,t=Game.currentGame.unitsLibrary.getCurrentHero()||"dwarf",n=new cleverapps.Spine(bundles.dialogues.jsons[t+"_json"],e.scale);n.setAnchorPoint2(),n.setPositionRound(e.position),n.setAnimation(0,"dialogue_smile",!0),n.setLocalZOrder(-1),
this.addChild(n),n.y-=n.height,n.runAction(new cc.MoveBy(.4,0,n.height).easing(cc.easeBackOut()))},listBundles:function(){return["newelements"]}});cleverapps.overrideFonts(cleverapps.styles.FONTS,{FINISHQUESTWINDOW_TITLE_TEXT:{size:70,lineHeight:77,color:cleverapps.styles.COLORS.LIGHT_TEXT_COLOR,stroke:cleverapps.styles.DECORATORS.LIGHT_TEXT_STROKE,shadow:cleverapps.styles.DECORATORS.LIGHT_TEXT_SHADOW},FINISHQUESTWINDOW_REWARD_TEXT:{name:"default",size:90,color:cleverapps.styles.COLORS.LIGHT_TEXT_COLOR,stroke:cleverapps.styles.DECORATORS.LIGHT_TEXT_STROKE,shadow:cleverapps.styles.DECORATORS.LIGHT_TEXT_SHADOW}}),cleverapps.styles.FinishQuestWindow={offsetY:0,middle:{width:400,height:500,icon:{x:{align:"center",dx:0},y:{align:"center",dy:40},scale:1.3},shining:{x:{align:"center",dx:0},y:{align:"center",dy:40},scale:.7}},person:{position:[{x:{align:"center",dx:-460},y:{align:"bottom",dy:-30}},{x:{align:"center",dx:-460},y:{align:"bottom",dy:-30}},{x:{align:"left",dx:150},y:{
align:"bottom",dy:-30}}],scale:1.3},rewards:{scale:.7}};var UnitLibraryIcon=cleverapps.Layout.extend({ctor:function(e){this.unit=e;var t=this.styles=cleverapps.styles.UnitLibraryIcon,n=this.library=Game.currentGame.unitsLibrary,s=[],i=this.background=new cc.Scale9Sprite(bundles.mergeui.frames.icon_background_light);i.setContentSize2(t);var o=this.icon=UnitView.getUnitImage(e);o.clearTrack&&o.clearTrack(0),o.setAnchorPoint2(),o.setPositionRound(t.icon),o.setLocalZOrder(1),cleverapps.UI.fitToBox(o,{width:i.width-2*t.icon.padding.x,height:i.height-2*t.icon.padding.y,maxScale:t.icon.scale}),i.addChild(o);var r=n.getUnitName(e);0<=r.indexOf(" ")&&r.lastIndexOf(" ")===r.indexOf(" ")&&(r=r.replace(" ","\n"));var a=cleverapps.UI.generateOnlyText(r,cleverapps.styles.FONTS.LIGHT_SUBTITLE_TEXT);a.setDimensions(i.width,0),a.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER),a.fitToHeight(t.text.maxHeight),s.push(a),s.push(i),this._super(s,{direction:cleverapps.UI.VERTICAL}),n.isOpened(e)||(
o.setCascadeOpacityEnabled(!0),o.setCascadeColorEnabled(!0),o.setOpacity(120),o.setColor(new cc.Color(0,150,255,255))),n.isFresh(e)&&(cleverapps.UI.applyHover(this),cleverapps.UI.onClick(this,this.onClick.bind(this),{swallowTouches:!1,ignoreOnTouchMoved:!0,useInteractiveScale:!0})),n.on("unitStatusChanged",this.onUpdateStatus.bind(this),this),this.onUpdateStatus()},onClick:function(){this.library.removeFresh(this.unit,this.background),this.removeRays(),this.removeAttention(),cc.eventManager.removeListeners(this)},onUpdateStatus:function(){this.library.isFresh(this.unit)?(this.addRays(),this.setAttention(bundles.mergeui.frames.attention_coin)):(this.removeRays(),this.removeAttention())},setAttention:function(e){this.attention&&(this.attention.removeFromParent(),delete this.attention);var t=this.attention=new cc.Sprite(e);t.setPositionRound(this.styles.attention),t.setLocalZOrder(2),this.background.addChild(t)},removeAttention:function(){this.attention&&(this.attention.runAction(
new cc.Sequence(new cc.ScaleTo(.15,0),new cc.RemoveSelf)),delete this.attention)},addRays:function(){if(!this.rays){var e=this.rays=new cleverapps.Spine(bundles.merge.jsons.rays_json,1.2);e.setAnchorPoint2(),e.setPositionRound(this.background.width/2,this.background.height/2),e.setAnimation(0,"animation",!0),this.background.addChild(e)}},removeRays:function(){this.rays&&(this.rays.runAction(new cc.Sequence(new cc.ScaleTo(.5,0),new cc.RemoveSelf)),delete this.rays)}});cleverapps.styles.UnitLibraryIcon={width:260,height:260,icon:{x:{align:"center"},y:{align:"center",dy:5},scale:1.3,padding:{x:10,y:10}},text:{maxHeight:80},attention:{x:{align:"right",dx:15},y:{align:"top",dy:15}}};var HeroIcon=cc.Sprite.extend({ctor:function(e,t){this.unit=e,this._super(bundles.orderswindow.frames.hero_background),this.addIcon(),cleverapps.UI.applyHover(this),cleverapps.UI.onClick(this,t,{swallowTouches:!1,ignoreOnTouchMoved:!0,useInteractiveScale:!0}),Game.currentGame.unitsLibrary.on("unitStatusChanged",
this.updateAttention.bind(this),this),this.setCascadeOpacityEnabled(!0),this.setCascadeColorEnabled(!0),this.updateAttention()},addIcon:function(){var e;e=this.unit.unknownHero?new cc.Sprite(bundles.unitslibrarywindow.frames.icon_unknown):new cc.Sprite(bundles.unitslibrarywindow.frames["icon_"+this.unit.code]),this.icon=e,this.addChild(e)},setAttention:function(e){this.attention&&(this.attention.removeFromParent(),delete this.attention);var t=this.attention=new cc.Sprite(e);t.setPositionRound(cleverapps.styles.HeroIcon.attention),t.setLocalZOrder(2),this.addChild(t)},removeAttention:function(){this.attention&&(this.attention.runAction(new cc.Sequence(new cc.ScaleTo(.15,0),new cc.RemoveSelf)),delete this.attention)},onSelect:function(){this.selected=!0;var e=Game.currentGame.unitsLibrary;this.unit.unknownHero||e.isOpened(this.unit)?(this.icon.setColor(new cc.Color(255,255,255,255)),this.icon.setOpacity(255)):(this.icon.setColor(new cc.Color(160,160,160,255)),this.icon.setOpacity(120)),
this.setColor(new cc.Color(255,255,255,255)),this.setSpriteFrame(bundles.orderswindow.frames.hero_selected_background),this.icon.setPositionRound(this.unit.unknownHero?cleverapps.styles.HeroIcon.unknown_icon:cleverapps.styles.HeroIcon.icon_selected),this.updateAttention()},onUnSelect:function(){this.selected=!1,this.icon.setColor(new cc.Color(255,255,255,255)),this.icon.setOpacity(140),this.setColor(new cc.Color(160,160,160,255)),this.setSpriteFrame(bundles.orderswindow.frames.hero_background),this.icon.setPositionRound(this.unit.unknownHero?cleverapps.styles.HeroIcon.unknown_icon:cleverapps.styles.HeroIcon.icon),this.updateAttention()},updateAttention:function(){this.unit.unknownHero||(Game.currentGame.unitsLibrary.hasFresh(this.unit.code)?this.setAttention(bundles.mergeui.frames.attention_exclamation):this.removeAttention())}});cleverapps.styles.HeroIcon={icon:{x:{align:"center",dx:0},y:{align:"bottom",dy:12}},icon_selected:{x:{align:"center",dx:0},y:{align:"bottom",dy:30}},
unknown_icon:{x:{align:"center",dx:0},y:{align:"center",dy:0}},attention:{x:{align:"center",dx:100},y:{align:"center",dy:100}}};var FamilyLayout=cc.Node.extend({ctor:function(e,t,n){n=n||{},this.styles=this.getStyles(),this.code=e;var s=this.icons=t.map(function(e){return new UnitLibraryIcon(e)}),i=this.createGrid(s,n.columns||6),o=this.background=cleverapps.UI.createScale9Sprite(bundles.unitslibrarywindow.frames.ow_details_background,cleverapps.UI.Scale9Rect.TwoPixelXY);if(o.setContentSize2(n.width||i.width,n.height||i.height),o.addChild(i),!1!==n.title){var r=this.createTitle(n.title||Game.currentGame.unitsLibrary.getFamilyName(e));o.addChild(r)}this._super(),this.setContentSize2(o.getContentSize()),this.setAnchorPoint2(),o.setPositionRound(this.width/2,this.height/2),this.addChild(o)},gridSeparator:function(){return{horizontal:this.styles.grid.separator}},createGrid:function(e,t){var n=this.styles,s=new cleverapps.GridLayout(e,{columns:t,
direction:cleverapps.GridLayout.TOP_TO_BOTTOM,align:{y:cleverapps.GridLayout.ALIGN_END},padding:n.grid.padding,margin:n.grid.margin,separator:this.gridSeparator()});return s.setAnchorPoint2(),s.setPositionRound(n.grid),s},createTitle:function(e){var t=this.styles.title,n=cleverapps.UI.generateTTFText(e,cleverapps.styles.FONTS.LIGHT_TITLE_TEXT);n.setPositionRound(t.text);var s=cleverapps.UI.createScale9Sprite(bundles.unitslibrarywindow.frames.ow_tab_header_on,cleverapps.UI.Scale9Rect.TwoPixelXY);return s.setContentSize2(n.width+2*t.padding.x,n.height+2*t.padding.y),s.addChild(n),s.setPositionRound(t),s},getStyles:function(){return cleverapps.styles.FamilyLayout}});cleverapps.styles.FamilyLayout={title:{x:{align:"center"},y:{align:"top",dy:30},text:{x:{align:"center"},y:{align:"center",dy:6}},padding:{x:55,y:24}},grid:{x:{align:"left"},y:{align:"center",dy:-40},padding:{x:50,y:85},margin:{x:44,y:20},separator:{image:bundles.mergeui.frames.next_arrow,x:{align:"center"},y:{align:"top",
dy:-100}}}};var HeroDetailsLayout=FamilyLayout.extend({ctor:function(e,t,n){e.unknownHero&&(n.title="messages:Units.unknownHero.title"),this.searchUnit=n.searchUnit,this._super(e.code,t,n);var s=this.styles,i=cleverapps.UI.createScale9Sprite(bundles.unitslibrarywindow.frames.horizontal_scroll_foreground,cleverapps.UI.Scale9Rect.TwoPixelXY);if(i.setAnchorPoint2(),i.setPositionRound(s.foreground),i.setContentSize(s.foreground),this.addChild(i),e.unknownHero){var o=cleverapps.UI.generateOnlyText("messages:Units.unknownHero.details",cleverapps.styles.FONTS.LIGHT_TITLE_TEXT);o.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER),o.setDimensions(this.styles.unknownHeroText.width,0),o.setPositionRound(this.styles.unknownHeroText),this.addChild(o)}},createGrid:function(e){var t=this.styles,n=new cleverapps.GridLayout(e,{columns:e.length,direction:cleverapps.GridLayout.TOP_TO_BOTTOM,align:{y:cleverapps.GridLayout.ALIGN_END},padding:t.grid.padding,margin:t.grid.margin,separator:this.gridSeparator()}
);if(n.setAnchorPoint2(),n.width<=t.grid.width)return n.setPositionRound(t.grid),n;var s=new cleverapps.UI.ScrollView(n,{childrenVisibility:cleverapps.UI.ScrollView.CHILDREN_VISIBILITY_NONE,scrollBarEnabled:!1,direction:cleverapps.UI.ScrollView.DIR_HORIZONTAL});s.setContentSize(t.grid),s.setPositionRound(t.grid);var i=e.map(function(e){return e.unit}),o=this.searchUnit&&Unit.findUnit(i,this.searchUnit)||Game.currentGame.unitsLibrary.findFreshUnit(i)||Game.currentGame.unitsLibrary.findLastOpenedUnit(i),r=o?i.indexOf(o):i.length-1;return s.scrollTo(cleverapps.UI.ScrollView.SCROLLS.LOWER_RIGHT),s.runAction(new cc.Sequence(new cc.DelayTime(.5),new cc.CallFunc(function(){s.scrollToMakeNodeVisible(e[r],.6,{left:.96,right:.96},{easing:cc.easeBackInOut()})}))),s},getStyles:function(){return cleverapps.overrideStyles(this._super(),cleverapps.styles.HeroDetailsLayout,!0)}});cleverapps.styles.HeroDetailsLayout={unknownHeroText:{width:1600,x:{align:"center"},y:{align:"center"}},grid:{width:1870,
height:540,x:{align:"left",dx:3},y:{align:"center",dy:-20},padding:{x:50,y:100},margin:{x:54,y:20}},foreground:{width:1880,height:380,x:{align:"center",dx:4},y:{align:"center",dy:0}}};var UnitsTab=cc.Node.extend({ctor:function(e,n){this.library=Game.currentGame.unitsLibrary;var t=this.families=e.map(function(e){var t=UnitsLibrary.ListByCode(e);return new FamilyLayout(e,t,{width:n.width})},this),s=cleverapps.styles.UnitsTab,i=new cleverapps.Layout(t,{direction:cleverapps.UI.TOP_TO_BOTTOM,margin:s.margin,padding:s.padding}),o=this.scroll=new cleverapps.UI.ScrollView(i,{childrenVisibility:cleverapps.UI.ScrollView.CHILDREN_VISIBILITY_FULLCHECK,scrollBarEnabled:!1,direction:cleverapps.UI.ScrollView.DIR_VERTICAL});o.setContentSize(i.width,Math.min(i.height,n.height)),o.scrollToDefault(),o.setPositionRound({x:{align:"center"},y:{align:"top"}}),this._super(),this.setContentSize2(n),this.setAnchorPoint2(),this.setPositionRound({x:{align:"center"},y:{align:"center"}}),this.addChild(o)},
onSelectTab:function(e){var t=(e=e||{}).searchUnit&&Unit.findUnit(this.families,{code:e.searchUnit.code})||Game.currentGame.unitsLibrary.findFreshUnit(this.families)||this.families[0];this.scroll.scrollToDefault(),this.scroll.scrollToMakeNodeVisible(t,.8,void 0,{easing:cc.easeBackInOut()})},onUnSelectTab:function(){this.scroll.stopAutoScroll()}});cleverapps.styles.UnitsTab={margin:60,padding:{x:0,y:55}};var HeroesTab=cc.Node.extend({ctor:function(e){this._super(),this.setContentSize2(e),this.setAnchorPoint2(),this.setPositionRound({x:{align:"center"},y:{align:"center"}}),this.styles=cleverapps.styles.HeroesTab,this.icons=this.createHeroIcons(),this.scroll=this.createScroll(),this.selectHero(0)},createHeroIcons:function(){var t=Game.currentGame.unitsLibrary,n=t.getNextHero(),e=t.listCodesByType("hero").map(function(e){return t.isHeroAvailable(e)||n===e?{code:e,stage:Families[e].units.length-1,type:"hero"}:{type:"hero",unknownHero:!0}});return(e=e.concat(cleverapps.arrayFill(5,{
type:"hero",unknownHero:!0}))).map(function(e,t){return new HeroIcon(e,function(){cleverapps.audio.playSound(bundles.main.urls.click_effect),this.selectHero(t)}.bind(this))},this)},createScroll:function(){var e=new cleverapps.Layout(this.icons,{direction:cleverapps.UI.HORIZONTAL,padding:this.styles.scroll.padding,margin:this.styles.scroll.margin}),t=new cleverapps.UI.ScrollView(e,{childrenVisibility:cleverapps.UI.ScrollView.CHILDREN_VISIBILITY_NONE,scrollBarEnabled:!1,direction:cleverapps.UI.ScrollView.DIR_HORIZONTAL});return t.setContentSize(this.styles.scroll),t.setPositionRound(this.styles.scroll),this.addChild(t),t},createHeroDetails:function(e,t){this.details&&this.details.removeFromParent();var n=this.icons[e].unit,s=n.code?UnitsLibrary.ListByCode(n.code):[],i=new HeroDetailsLayout(n,s,{width:this.width,height:this.styles.details.height,searchUnit:t});return i.setPositionRound(this.styles.details),i.setLocalZOrder(1),this.details=i,this.addChild(i),i},selectHero:function(n,e){
this.selectedIndex!==n&&(this.icons.forEach(function(e,t){t===n?e.onSelect():e.onUnSelect()}),this.selectedIndex=n,this.createHeroDetails(n,e))},onSelectTab:function(e){e=e||{};var t=this.icons.map(function(e){return{code:e.unit.code}}),n=e.searchUnit&&Unit.findUnit(t,e.searchUnit)||Game.currentGame.unitsLibrary.findFreshUnit(t)||Unit.findUnit(t,{code:Game.currentGame.unitsLibrary.getNextHero()}),s=n?t.indexOf(n):0;this.scroll.scrollToDefault(),this.scroll.scrollToMakeNodeVisible(this.icons[s],0,{left:.96,right:.96},{easing:cc.easeBackInOut()}),this.selectHero(s,e.searchUnit)},onUnSelectTab:function(){this.scroll.stopAutoScroll()}});cleverapps.styles.HeroesTab={details:{x:{align:"center"},y:{align:"top",dy:-60},height:540},scroll:{width:1960,height:380,x:{align:"center"},y:{align:"bottom",dy:2},padding:{x:60,y:65},margin:40}};var MergeScene=GameSceneBase.extend({ctor:function(e,t){var n=this.merge=new Merge(t);this._super(n,n.level);var s=this.map=new Map2dView(n.map);if(
n.workers.regular.map(function(e){var t=new WorkerView(e);return this.scene.addChild(t),t},this),n.workers.onAddWorker=function(e){var t=new WorkerView(e);this.scene.addChild(t)}.bind(this),this.scroll=new cleverapps.UI.ScrollView(s,{childrenVisibility:cleverapps.UI.ScrollView.CHILDREN_VISIBILITY_FULLCHECK,childrenVisibilityPadding:Math.max(cleverapps.styles.Map2dView.cell.width,cleverapps.styles.Map2dView.cell.height),scrollBarEnabled:!1,zoom:!0,outOfBoundaryScale:.25,inertialScrollFactor:.2}),n.getScrollZoom=function(){return this.scroll.zoomHandler.normalizeZoom(this.scroll.zoom)}.bind(this),this.scroll.setContentSize(this.width,this.height),this.scroll.setPositionRound(this.scene.width/2,this.scene.height/2),this.scroll.setLocalZOrder(-1),this.scene.addChild(this.scroll),Game.currentMiniGame&&(n.scrollCell=Game.currentMiniGame),n.scrollCell){var i=this.map.getCell(Map2d.LAYER_UNITS,n.scrollCell.x,n.scrollCell.y);this.scroll.scrollTo(i,0)}else if(n.fogs.blocks.fog0){
var o=n.fogs.blocks.fog0.head;o&&this.centerTo(o.x,o.y,{silent:!0})}n.map.onCenterTo=this.centerTo.bind(this),n.map.onAddTarget=this.addTarget.bind(this),n.map.onZoomTo=this.zoomTo.bind(this),this.scroll.updateVisibility(),this.addCenterHint(),this.addSideBar(),this.addTutorial(),this.advice=new MergeAdviceView(n.advice,this),this.game.onSubstractEnergy=this.onSubEnergy.bind(this),this.game.gameLevel.onLevelUp=this.onLevelUp.bind(this),this.game.onAddItemsAnimation=this.addItemsAnimation.bind(this),this.game.pixelsPlanner.onCreateSwarm=this.createPixelsSwarmView.bind(this),this.game.barrelPlanner.onCreateBarrel=this.createBarrelView.bind(this),this.scroll.zoomHandler.setZoom(.8*this.getBasicZoom(),!0),this.game.onShowUp=this.showUp.bind(this),cleverapps.canBlockOrientation&&this.height>this.width&&cleverapps.rotatePhoneInfo(!1),cleverapps.environment.levelNo=levels.user.level,this.merge.on("stop",this.onStop.bind(this),this)},onStop:function(){this.onChangeSize=function(){}},
createPixelsSwarmView:function(e){var t=new PixelsSwarmView(e,this.scroll.getVisibleRect());this.map.animations.addChild(t)},createBarrelView:function(e){var t=new BarrelView(e);this.map.animations.addChild(t)},_playIntro:function(){this.needDisplayIntro=!1,cleverapps.metha.display({focus:"GameScene.intro",control:this.introControls(),action:this.displayIntro.bind(this)})},onChangeSize:function(){var e=cc.director.getWinSize();this.setContentSize(e),this.scene.setPositionRound(this.width/2,this.height/2),this.scene.setContentSize2(cleverapps.UI.getSceneSize()),this.scroll.setPositionRound(this.scene.width/2,this.scene.height/2),this.scroll.setContentSize(this.width,this.height),cleverapps.wideMode.refresh(),this.addMenuBar(),this.addSideBar(),this.addCenterHint(),cleverapps.Notification.remove(!0),cleverapps.eventBus.trigger("changeSceneSize")},getBasicZoom:function(){return this.merge.zoom?this.merge.zoom:cc.sys.isMobile?1.85:1.2},miniGameReward:function(){if(Game.currentMiniGame){if(
Game.currentMiniGame.reward){var e=Game.currentGame.map.getUnit(Game.currentMiniGame.x,Game.currentMiniGame.y);Game.currentMiniGame.reward.coins&&Game.currentGame.addCoins(Game.currentMiniGame.reward.coins,e,{withoutDelta:!0}),Game.currentMiniGame.reward.energy&&Game.currentGame.addEnergy(Game.currentMiniGame.reward.energy,e,{withoutDelta:!0}),Game.currentMiniGame.reward.gold&&Game.currentGame.addRubies(Game.currentMiniGame.reward.gold,e,{withoutDelta:!0})}Game.currentMiniGame=void 0}},showUp:function(e){this.runAction(new cc.Sequence(new cc.PlaySound(bundles.game.urls.start_game),new cc.CallFunc(function(){this.scroll.zoomTo(this.getBasicZoom(),1)}.bind(this)),new cc.DelayTime(1),new cc.CallFunc(function(){this.miniGameReward(),e()}.bind(this))))},getSourceCenterPosition:function(e){var t=this.map.alignInIsometricGrid(e.x,e.y);if(e instanceof Unit&&e.findComponent(MultiCell)){var n=e.findComponent(MultiCell).getCenter();t.x+=n.x,t.y+=n.y}return t},onSubEnergy:function(e,t){
var n=void 0,s=this.map.animations;(t instanceof Unit||t instanceof FogTile)&&(n=this.getSourceCenterPosition(t),cleverapps.UI.animateDelta(-e,{icon:bundles.flying.frames.flying_energy_png,x:n.x,y:n.y,iconScale:cleverapps.styles.MergeScene.flyingIcons.scale,parent:s,font:cleverapps.styles.FONTS.MENUBAR_TEXT}))},getAmountFlyItems:function(e){return 100<=e?8:50<=e?5:3<=e?3:e},addItemsAnimation:function(e,t,n,s,i){var o=void 0,r=this.map.animations;o=n instanceof Unit||n instanceof FogTile?this.getSourceCenterPosition(n):n.getPosition(),n instanceof cc.Node&&(r=n.parent);var a=s.beginScale||cleverapps.styles.MergeScene.flyingIcons.scale,c=this.getAmountFlyItems(t),l=bundles.flying.frames.flying_exp_png;switch(e){case"coins":l=bundles.flying.frames.flying_coin_png;break;case"energy":l=bundles.flying.frames.flying_energy_png;break;case"wands":l=bundles.flying.frames.flying_wand_png;break;case"rubies":l=bundles.flying.frames.flying_ruby_png;break;case"worker":
l=bundles.reward_icons.frames.reward_worker_png,c=1}for(var p=0;p<c;p++){var d=new cc.Sprite(l);d.setScale(a),d.setLocalZOrder(1e3-p),d.setPositionRound(o),r.addChild(d),d.replaceParentSamePlace(this.scene,{keepScale:!0}),this.jumpCollectAnimation(p,c,d,s,e,p===c-1?i:void 0)}s.withoutDelta||this.runAction(new cc.Sequence(new cc.DelayTime(.1*c+.7),new cc.CallFunc(function(){cleverapps.UI.animateDelta(t,{icon:l,iconScale:a,x:o.x,y:o.y+cleverapps.styles.MergeScene.changeInfo.dy,parent:r,font:cleverapps.styles.FONTS.MENUBAR_TEXT})})))},onLevelUp:function(){cleverapps.metha.display({focus:"onLevelUp",control:["MenuBarGoldItem","MenuBarGameLevelItem","MenuBarLivesItem","MenuBarCoinsItem"],actions:[function(e){new LevelUpWindow,cleverapps.metha.onceNoWindowsListener=e}.bind(this),function(e){var t=NewRecipesWindow.ListNewRecipes();0!==t.length?(cleverapps.metha.hideAllControls(),new NewRecipesWindow(t),cleverapps.metha.onceNoWindowsListener=e):e()}.bind(this)]})},
jumpCollectAnimation:function(e,t,n,s,i,o){var r=cleverapps.styles.MergeScene.jumpCollect,a=r.jumpBoth;s.jumpSide&&(a="left"===s.jumpSide?r.jumpLeft:r.jumpRight);var c={dist:{x:a.x1+e*(a.x2-a.x1)/t,y:a.y1+Math.random()*(a.y2-a.y1)},sound:bundles.merge.urls.coins_drop_effect,soundDelay:.3},l={speed:r.collect.speed,jump:!0};switch(i){case"coins":l.target=cleverapps.styles.MenuBar.CoinsItem.target;break;case"energy":l.target=cleverapps.styles.MenuBar.LivesItem.target;break;case"wands":l.target=cleverapps.styles.MenuBar.WandsItem.target;var p=this.game.fogs.findBlockWithProgress();if(p){var d=p.getProgressTarget();d&&(l.target=d,c.parent=this.map.animations,l.parent=this.map.animations,n.replaceParentSamePlace(this.map.animations),this.runAction(new cc.Sequence(new cc.DelayTime(.7),new cc.CallFunc(function(){var e=new cc.Node;e.setAnchorPoint2(),e.setPositionRound(d.getPosition());var t=cleverapps.UI.getSceneSize();e.setContentSize2(2*t.width/3,2*t.height/3),d.getParent().addChild(e),
this.scroll.scrollToMakeNodeVisible(e,1),e.removeFromParent()}.bind(this)))))}break;case"rubies":l.target=cleverapps.styles.MenuBar.GoldItem.target;break;case"worker":l.target=cleverapps.styles.MenuBar.WorkersItem.target;break;default:l.target=cleverapps.styles.MenuBar.GameLevelItem.target}n.setVisible(!1),n.runAction(new cc.Sequence(new cc.DelayTime(.1*e+.1*Math.random()),new cc.Show,new cc.CallFunc(cleverapps.UI.jumpCollectAnimation.bind(null,n,{jump:c,collect:l,callback:o}))))},makeNodeVisible:function(e){this.scroll.scrollToMakeNodeVisible(e,1,{left:.82,right:.82,top:.84,bottom:.98})},centerTo:function(s,i,o){cleverapps.windows.whenAllClosed(function(){var e=(o=o||{}).silent?0:void 0!==o.duration?o.duration:MergeScene.SCROLL_TO_DURATION,t=void 0!==o.layer?o.layer:Map2d.LAYER_UNITS,n=this.map.getCell(t,s,i);this.scroll.scrollTo(n,e,{callback:o.callback})}.bind(this))},addTarget:function(n,s){cleverapps.windows.whenAllClosed(function(){var e=this.map.getCell(Map2d.LAYER_UNITS,n,s),
t=new FingerView;t.setLocalZOrder(3e3),t.setPositionRound(e.getPosition()),this.map.animations.addChild(t),t.fadeIn({x:0,y:0}),t.delay(.1),t.press(),t.delay(.1),t.unPress(),t.delay(.1),t.press(),t.delay(.1),t.unPress(),t.fadeOut(),t.delay(1),t.runOnce(function(){t.removeFromParent()})}.bind(this))},closeAction:function(){if(cleverapps.administrator&&!cc.sys.isNative)return this.game.stop(),void AdministratorScene.open();window.closeApplication&&window.closeApplication()},addSideBar:function(){this.sideBar&&this.sideBar.removeFromParent();var e=this.sideBar=new SideBarView({silent:Boolean(this.sideBar)});e.setPositionRound(this.scene.width/2,this.scene.height/2),e.setLocalZOrder(1),this.scene.addChild(e)},addTutorial:function(){var e=new MergeTutorialView(this.merge.tutorial);e.setPositionRound(this.scene.width/2,this.scene.height/2),this.scene.addChild(e)},addCenterHint:function(){this.centerHint&&this.centerHint.removeFromParent();var e=this.centerHint=new CenterHint(this.merge)
;e.setAnchorPoint2(),e.setPositionRound(this.width/2,this.height/2),e.setContentSize2(this.width,this.height),this.scene.addChild(e)},zoomTo:function(e){var t=Game.currentGame.getScrollZoom(),n=e.zoom;if(!(e.direction===MergeScene.ZOOM_DIRECTION_IN&&n<t||e.direction===MergeScene.ZOOM_DIRECTION_OUT&&t<n)){var s=void 0!==e.duration?e.duration:.35+.35*(n-t);this.scroll.zoomTo(n,s)}}});(GameScene=MergeScene).SCROLL_TO_DURATION=1,MergeScene.ZOOM_DIRECTION_IN=0,MergeScene.ZOOM_DIRECTION_OUT=1,GameScene.BUNDLES=function(e,t){var n=t&&t.episodeNo||0,s=GameSceneBase.BUNDLES();return s.push("episode_"+n,"particle"),s},cleverapps.styles.MergeScene={changeInfo:{dy:75},flyingIcons:{scale:.6},jumpCollect:{jumpRight:{x1:50,x2:150,y1:-50,y2:-100},jumpLeft:{x1:-50,x2:-150,y1:-50,y2:-100},jumpBoth:{x1:-50,x2:50,y1:-50,y2:-100},collect:{speed:2600}}};var Pulsing=function(e){this.unit=e,this.beforeCollect=function(){},this.buildingComplete=function(){},this.init=function(){}},Bubble=function(e){
this.unit=e,this.beforeCollect=function(){}},Shine=function(){},Collectible=function(e){this.unit=e,this.onCollection=function(){}};Collectible.prototype.handleClick=function(){return this.collect(),!0},Collectible.prototype.clear=function(){this.timeout&&(clearTimeout(this.timeout),delete this.timeout)},Collectible.prototype.handleTouchBegin=function(){return!!this.unit.getData().unmergeable&&(this.collect(),!0)},Collectible.prototype.collect=function(){this.unit.findComponent(Pulsing)&&this.unit.findComponent(Pulsing).beforeCollect(),this.unit.findComponent(Bubble)&&this.unit.findComponent(Bubble).beforeCollect(),this.onCollection(),cleverapps.audio.playSound(bundles.main.urls.click_effect),Game.currentGame.advice.boo(),this.unit.remove(!0),this.timeout=setTimeout(function(){delete this.timeout,Game.currentGame.harvest(this.unit)}.bind(this),500)};var DivideCollectible=function(e){this.unit=e,this.onCollection=function(){}};DivideCollectible.prototype.handleClick=function(){
return this.collect(),!0},DivideCollectible.prototype.handleTouchBegin=function(){return!!this.unit.getData().unmergeable&&(this.collect(),!0)},DivideCollectible.prototype.collect=function(){this.unit.findComponent(Pulsing)&&this.unit.findComponent(Pulsing).beforeCollect(),this.onCollection(function(){Game.currentGame.harvest(this.unit)}.bind(this)),cleverapps.audio.playSound(bundles.main.urls.click_effect),this.unit.remove(!0)};var ResourceCollectible=function(e){this.unit=e,this.onCollection=function(){}};ResourceCollectible.prototype.handleClick=function(){if(!Buildable.IsBuilt(this.unit))return!1;var e=this.getResourceTarget();return!!e&&(this.collect(e),!0)},ResourceCollectible.prototype.getResourceTarget=function(){return Game.currentGame.getTargetCastle(this.unit)},ResourceCollectible.prototype.handleTouchBegin=function(){if(!Buildable.IsBuilt(this.unit))return!1;var e=this.getResourceTarget();return!!e&&(this.collect(e),!0)},ResourceCollectible.prototype.collect=function(e){
this.unit.findComponent(Pulsing)&&this.unit.findComponent(Pulsing).beforeCollect(),this.onCollection(),cleverapps.audio.playSound(bundles.main.urls.click_effect),Game.currentGame.advice.boo(),e.findComponent(Upgradable).incProgress(500),this.unit.remove(!0)};var Dish=function(e){this.unit=e,this.openAnimation=function(){}};Dish.prototype.listPrize=function(){return Recipes.filter(function(e){return e.code===this.unit.getData().dish},this)[0].prize},Dish.prototype.handleTouchBegin=function(){var e=Game.currentGame,t=this.listPrize();if(!(t.length>e.map.countEmptySlots()+1)){this.unit.findComponent(Bubble)&&this.unit.findComponent(Bubble).beforeCollect(),this.unit.remove(!0);var n=t.map(function(e){return new Unit(e)});return e.spawn(n,this.unit,{radius:Map2d.RADIUS_SMALL}),this.openAnimation(),!0}Game.currentGame.onHintMessage("messages:Spawn.nospace")};var MakesOrder=function(e,t){var n=Game.currentGame;(this.unit=e).onPrizeHarvested=this.reset.bind(this),this.onChangeState=function(e
){},this.onUpdateIngredients=function(){},n.orders.addOrder(this),cleverapps.config.editorMode||this.restore(t)};MakesOrder.ORDER_TIMEOUT="30 seconds",MakesOrder.prototype.save=function(e){e.state=this.state,e.recipe=this.recipe&&this.recipe.code,e.timeToReady=this.timeToReady},MakesOrder.prototype.restore=function(e){var t=e.recipe&&this.restoreRecipe(e.recipe);e.state!==MakesOrder.STATE_EMPTY&&t?e.state===MakesOrder.STATE_RECIPE?this._setState(MakesOrder.STATE_RECIPE,t):e.state===MakesOrder.STATE_COOKING?this._setState(MakesOrder.STATE_COOKING,t,e.timeToReady-Date.now()):(this._setState(MakesOrder.STATE_READY,t),this.unit.setPrizes([this.createPrizeUnit()])):this._setState(MakesOrder.STATE_EMPTY)},MakesOrder.prototype.isCooking=function(){return this.state===MakesOrder.STATE_COOKING},MakesOrder.prototype.restoreRecipe=function(e){for(var t=0;t<Recipes.length;++t){var n=Recipes[t];if(n.code===e&&Game.currentGame.harvested.isAvailableList(n.ingredients))return n}},
MakesOrder.prototype.clear=function(){clearTimeout(this.timeout)},MakesOrder.prototype._setState=function(e,t,n){if(!cleverapps.config.editorMode){var s=Game.currentGame;switch(clearTimeout(this.timeout),e){case MakesOrder.STATE_RECIPE:case MakesOrder.STATE_READY:this.state=e,this.recipe=t,delete this.timeToReady;break;case MakesOrder.STATE_COOKING:this.state=e,this.recipe=t,this.timeToReady=Date.now()+n,this.timeout=new cleverapps.LongTimeout(this.enjoy.bind(this),n);break;default:this.state=MakesOrder.STATE_EMPTY,delete this.recipe,delete this.timeToReady,this.timeout=new cleverapps.LongTimeout(this.order.bind(this),cleverapps.parseInterval(MakesOrder.ORDER_TIMEOUT))}this.onChangeState(),s.orders.updateOrder(this)}},MakesOrder.prototype.order=function(){var e=Game.currentGame.orders.chooseFreeRecipe();e?(this._setState(MakesOrder.STATE_RECIPE,e),this.unit.save()):this.reset()},MakesOrder.prototype.canCook=function(){
return this.state===MakesOrder.STATE_RECIPE&&Game.currentGame.harvested.canTakeList(this.recipe.ingredients)},MakesOrder.prototype.isReady=function(){return this.state===MakesOrder.STATE_READY},MakesOrder.prototype.cook=function(){return!!this.canCook()&&(Game.currentGame.harvested.takeList(this.recipe.ingredients),this._setState(MakesOrder.STATE_COOKING,this.recipe,cleverapps.parseInterval(this.recipe.time)),this.unit.save(),Game.currentGame.pushes.updateOrders(),!0)},MakesOrder.prototype.enjoy=function(){return this.state===MakesOrder.STATE_COOKING&&(this._setState(MakesOrder.STATE_READY,this.recipe),this.unit.setPrizes([this.createPrizeUnit()]),this.unit.save(),cleverapps.sideBar.resetByClassName(OrdersIcon),Game.currentGame.pushes.updateOrders(),!0)},MakesOrder.prototype.reset=function(){this._setState(MakesOrder.STATE_EMPTY),this.unit.save()},MakesOrder.prototype.handleClick=function(){return-1===[MakesOrder.STATE_EMPTY,MakesOrder.STATE_READY].indexOf(this.state)&&(
Game.currentGame.tutorial.checkTargets(this.unit)?new OrdersWindow(this):cleverapps.metha.display({focus:"openOrdersWindow",action:function(e){new OrdersWindow(this),cleverapps.metha.onceNoWindowsListener=e}.bind(this)}),!0)},MakesOrder.prototype.getTimeLeft=function(){return Math.max(this.timeToReady-Date.now()||0,0)},MakesOrder.prototype.getPrizeUnitInfo=function(){return this.recipe&&{code:"dishes",stage:Recipes.indexOf(this.recipe)}},MakesOrder.prototype.createPrizeUnit=function(){return new Unit(this.getPrizeUnitInfo())},MakesOrder.STATE_EMPTY=0,MakesOrder.STATE_RECIPE=1,MakesOrder.STATE_COOKING=2,MakesOrder.STATE_READY=3;var Chest=function(e){this.unit=e,this.openAnimation=function(){}};Chest.prototype.open=function(){var e=Game.currentGame,t=this.listPrize();if(t.length>e.map.countEmptySlots()+1)e.onHintMessage("messages:Spawn.nospace");else{e.gameEvent(Merge.PRIZE_HARVESTED,{affected:this.unit,prizes:t}),this.unit.remove(!0);var n=t.map(function(e){return new Unit({code:e.code,
stage:e.stage})});e.spawn(n,this.unit,{radius:Map2d.RADIUS_BIG}),this.openAnimation()}},Chest.prototype.listAvailable=function(){var n=ChestListPrize[this.unit.code][this.unit.stage],s=[];for(var i in n){var e=[i],o=n[i].basic.length;if(n[i].hero)Game.currentGame.unitsLibrary.getNextHero()?(e=[Game.currentGame.unitsLibrary.getNextHero()],o=Math.min(o,Families[e[0]].units.length-1)):e=[];n[i].family&&(e=Game.currentGame.unitsLibrary.listAvailableByType(i)),e.forEach(function(e){for(var t=0;t<o;t++)0<=n[i].basic[t]&&s.push({code:e,stage:t})})}return s},Chest.ListPrizeProb=function(e){var t,n=ChestListPrize[e.code][e.stage],c={},s=function(e,t,n,s,i){if(i){var o=[e];if(!n||(o=Game.currentGame.unitsLibrary.listAvailableByType(e)).length){if(s){var r=Game.currentGame.unitsLibrary.getNextHero();if(!r||t>=Families[r].units.length-1)return;o=[r]}i/=o.length;for(var a=0;a<o.length;a++)c[e].types.push({code:o[a],stage:t,prob:i})}}};for(t in n){var i,o=0;for(c[t]={minAmount:0,maxAmount:0,
resource:n[t].resource,types:[]},i=0;i<n[t].basic.length;i++)0<=n[t].basic[i]&&o++;for(i=0;i<n[t].basic.length;i++)0<=n[t].basic[i]&&(c[t].minAmount+=n[t].basic[i],c[t].maxAmount+=n[t].basic[i],s(t,i,n[t].family,n[t].hero,n[t].itemsProb?n[t].itemsProb[i]:1/o));n[t].bonus&&(n[t].prob||(c[t].minAmount+=n[t].bonus[0]),c[t].maxAmount+=n[t].bonus[1]),c[t].types.length&&c[t].maxAmount||delete c[t]}var r={minAmount:0,maxAmount:0,types:[]};for(t in c)r.minAmount+=c[t].minAmount,r.maxAmount+=c[t].maxAmount;var a,l=(r.minAmount+r.maxAmount)/2;for(t in c){var p=(c[t].minAmount+c[t].maxAmount)/2;for(a=0;a<c[t].types.length;a++){var d=c[t].types[a];r.types.push(d),d.prob*=p/l}}var u=0;for(a=0;a<r.types.length-1;a++){if(1<=u+r.types[a].prob){r.types=r.types.slice(0,a+1);break}u+=r.types[a].prob}for(r.types[r.types.length-1].prob=1-u,a=0;a<r.types.length;a++)r.types[a].prob=Math.round(1e4*r.types[a].prob)/100;var h=[];for(a=0;a<r.types.length;a++)h.push(a);for(h=h.sort(function(e,t){
return r.types[t].prob!=r.types[e].prob?r.types[t].prob-r.types[e].prob:e-t}),c={minAmount:r.minAmount,maxAmount:r.maxAmount,types:[]},a=0;a<h.length;a++)c.types.push(r.types[h[a]]);return c},Chest.prototype.listPrize=function(){this.unit.seedRandom();var e=ChestListPrize[this.unit.code][this.unit.stage],o=[],t=function(e,t,n,s){if(n){var i=Game.currentGame.unitsLibrary.listAvailableByType(e);if(!i.length)return;e=cleverapps.Random.choose(i)}s&&(!(e=Game.currentGame.unitsLibrary.getNextHero())||t>=Families[e].units.length-1)||o.push(Game.currentGame.decreasePrizeStageIfNeeded({code:e,stage:t}))};for(var n in e){var s,i,r=[],a=0;for(i=0;i<e[n].basic.length;i++)0<=e[n].basic[i]&&a++;for(i=0;i<e[n].basic.length;i++)if(0<=e[n].basic[i]){for(s=0;s<e[n].basic[i];s++)t(n,i,e[n].family,e[n].hero);r.push({code:n,stage:i,family:e[n].family,hero:e[n].hero,prob:e[n].itemsProb?e[n].itemsProb[i]:1/a})}if(e[n].bonus){var c=cleverapps.Random.random(e[n].bonus[0],e[n].bonus[1]);for(s=0;s<c;s++)if(!(
e[n].prob&&cleverapps.Random.nextDouble()>e[n].prob))for(var l=cleverapps.Random.nextDouble(),p=0,d=0;d<r.length;d++)if(l<=(p+=r[d].prob)){t(r[d].code,r[d].stage,r[d].family,r[d].hero);break}}}return o},Chest.prototype.handleClick=function(){if(this.unit.onSqueeze(),cleverapps.audio.playSound(bundles.collectible.urls.coins_fly_finish_effect),cleverapps.config.wysiwygMode&&cleverapps.flags.wysiwyg.skipOpenChestWindow)return this.open(),!0;var t={executed:!1},e=[function(e){setTimeout(e,300)},function(e){new OpenChestWindow(this.unit,t),cleverapps.metha.onceNoWindowsListener=e}.bind(this),function(e){t.executed?cleverapps.metha.compound(e,[function(e){setTimeout(e,300)},function(e){this.open(),e()}.bind(this)]):e()}.bind(this)];return Game.currentGame.tutorial.checkTargets(this.unit)?cleverapps.metha.compound(function(){},e):cleverapps.metha.display({focus:"openChestWindow",actions:e}),!0};var Generator=function(e,t){this.unit=e,this.levels=e.getData().generator.levels,
this.brightLevels=e.getData().generator.brightLevels,this.level=t.level||0,this.changedLevels=t.changedLevels||0,this.beforeUpdateStage=function(){},this.afterUpdateStage=function(){},this.beforeUpdateLevel=function(){},this.levels&&this.level>=this.levels&&setTimeout(this._gotoNextStage.bind(this),0)};Generator.prototype.save=function(e){e.level=this.level,e.changedLevels=this.changedLevels},Generator.prototype.clear=function(){this.timeout&&(clearTimeout(this.timeout),delete this.timeout)},Generator.prototype._gotoNextStage=function(){this.beforeUpdateStage(),this.timeout=setTimeout(function(){delete this.timeout;var e=new Unit({code:this.unit.code,stage:this.unit.stage+1,level:0,changedLevels:this.changedLevels});Game.currentGame.replace(this.unit,e,!0),e.findComponent(Generator).afterUpdateStage()}.bind(this),1e3)},Generator.prototype.gotoNextLevel=function(){this.beforeUpdateLevel(),this.timeout=setTimeout(function(){delete this.timeout;var e=new Unit({code:this.unit.code,
stage:this.unit.stage,level:this.levels?this.level+1:0,changedLevels:this.changedLevels+1});Game.currentGame.replace(this.unit,e,!0)}.bind(this),this.levels?600:0)};var InstantWorker=function(e,t){this.unit=e,this.limit=t.limit||cleverapps.parseInterval("1 hour"),this.onStartMagic=function(){},this.onFinishMagic=function(){},this.onPercentageChanged=function(){},this.onDragStart=function(){},this.onDragFinish=function(){}};InstantWorker.prototype.isFresh=function(){return this.limit===cleverapps.parseInterval("1 hour")},InstantWorker.prototype.isWorking=function(){return Boolean(this.assignment)},InstantWorker.prototype.save=function(e){e.limit=this.limit},InstantWorker.prototype.getInfo=function(){return{title:this.unit,duration:this.limit,remains:{value:this.limit,total:cleverapps.parseInterval("1 hour")},guide:{class:InstantWorkerGuideWindow,unit:this.unit}}},InstantWorker.prototype.getPercentage=function(){return 100*this.limit/cleverapps.parseInterval("1 hour")},
InstantWorker.BUILDING_ANIMATION_TIME=5500,InstantWorker.prototype.buildInstantly=function(e){if(!Game.currentGame.workers.findInstantAssigned(e)){var t=Game.currentGame.map.findEmptySlot(e.unit.x,e.unit.y);t&&this.unit.move(t.x,t.y);var n=Game.currentGame.workers.findAssigned(e.unit);n&&n.completeAssignment(),this.assignment=e,this.onStartMagic(e),Game.currentGame.counter.setTimeout(this.doMagic.bind(this,e),InstantWorker.BUILDING_ANIMATION_TIME)}},InstantWorker.prototype.doMagic=function(e){delete this.assignment,this.onFinishMagic(e);var t=Math.min(this.limit,e.time);if(e.completeBuilding(t),this.limit-=t,this.unit.save(),this.onPercentageChanged(),this.limit<=0){Game.currentGame.workers.removeInstant(this);var n=new Unit({code:this.unit.code,stage:0});Game.currentGame.replace(this.unit,n)}},InstantWorker.prototype.getTarget=function(e,t){var n=Game.currentGame.map.getUnit(e,t);if(!n)return!1;var s=n.findComponent(Buildable);return s&&!s.isCompleted(
)&&void 0===Game.currentGame.workers.findInstantAssigned(s)?n:void 0},InstantWorker.prototype.handleDragStart=function(){return this.availableBuildings=Game.currentGame.map.listAvailableUnits().filter(function(e){return this.getTarget(e.x,e.y)},this),this.availableBuildings.forEach(function(e){e.highlight(),e.findComponent(Buildable).onHighlight()}),this.onDragStart(),!1},InstantWorker.prototype.handleDragMove=function(e,t){this.getTarget(e,t)&&this.unit.light.hide()},InstantWorker.prototype.handleDragEnd=function(e,t){var n=this.getTarget(e,t);if(this.availableBuildings.forEach(function(e){e.unhighlight(),e.findComponent(Buildable).onUnhighlight()}),this.availableBuildings=void 0,this.onDragFinish(),n)return this.buildInstantly(n.findComponent(Buildable)),!0};var Grounded=function(e){this.unit=e,this.remove=function(){}};Grounded.prototype.save=function(e){e.grounded=1};var SourceChestBonues=[{heroitems:{hero:!0,basic:[0,0,0],bonus:[1,1],itemsProb:[.58,.29,.13],prob:.5},fruit:{
family:!0,basic:[0],bonus:[1,1],prob:.5}},{coins:{basic:[0],bonus:[2,2],prob:.3},worker:{basic:[0],bonus:[1,1],prob:.2},heroitems:{hero:!0,basic:[0,0,0],bonus:[2,2],itemsProb:[.58,.29,.13],prob:.8},fruit:{family:!0,basic:[0,-1,-1,-1,0],bonus:[1,3]}},{rubies:{basic:[0],bonus:[2,2],prob:.3},coins:{basic:[0],bonus:[2,2],prob:.3},crystal:{basic:[0],bonus:[2,2],prob:.3},worker:{basic:[0],bonus:[0,1]},heroitems:{hero:!0,basic:[0,0,0],bonus:[2,2],itemsProb:[.58,.29,.13],prob:.8},fruit:{family:!0,basic:[0,-1,-1,-1,0],bonus:[2,4]}}],ChestListPrize={treasure:[{rubies:{basic:[0,0],bonus:[2,3]},coins:{basic:[0,0],bonus:[1,2]}},{rubies:{basic:[0,1],bonus:[1,2]},coins:{basic:[0,2,0],bonus:[2,3]}},{rubies:{basic:[0,1,1],bonus:[3,4]},coins:{basic:[0,2,1],bonus:[2,4]}}],freechest:[{rubies:{basic:[0],bonus:[1,1],prob:.7},coins:{basic:[0,0],bonus:[6,6],itemsProb:[.66,.34],prob:.5},crystal:{basic:[0],bonus:[2,2],prob:.3},worker:{basic:[0],bonus:[2,2],prob:.2},heroitems:{hero:!0,basic:[0,0,0],bonus:[2,2],
itemsProb:[.58,.29,.13],prob:.8},fruit:{family:!0,basic:[0,-1,-1,-1,0],bonus:[3,6]}}],herochest:[{coins:{basic:[0,0],bonus:[2,2],prob:.8},worker:{basic:[0],bonus:[3,3],prob:.3},heroitems:{hero:!0,basic:[1,1,1],bonus:[3,6],itemsProb:[.25,.5,.25]}}],woodchest:[cleverapps.extend({wood:{basic:[3],resource:!0}},SourceChestBonues[0]),cleverapps.extend({wood:{basic:[1,1],bonus:[2,4],itemsProb:[.6,.4],resource:!0}},SourceChestBonues[1]),cleverapps.extend({wood:{basic:[0,0,0],bonus:[7,9],itemsProb:[.2,.4,.4],resource:!0}},SourceChestBonues[2])],stonechest:[cleverapps.extend({stone:{basic:[1,0],bonus:[2,2],itemsProb:[.7,.3],resource:!0}},SourceChestBonues[0]),cleverapps.extend({stone:{basic:[0,0,0],bonus:[3,5],itemsProb:[.25,.5,.25],resource:!0}},SourceChestBonues[1]),cleverapps.extend({stone:{basic:[0,0,0],bonus:[7,9],itemsProb:[.2,.4,.4],resource:!0}},SourceChestBonues[2])],wagonchest:[cleverapps.extend({wagon:{basic:[1,0],bonus:[2,2],itemsProb:[.7,.3],resource:!0}},SourceChestBonues[0]),
cleverapps.extend({wagon:{basic:[0,0,0],bonus:[3,5],itemsProb:[.25,.5,.25],resource:!0}},SourceChestBonues[1]),cleverapps.extend({wagon:{basic:[0,0,0],bonus:[7,9],itemsProb:[.2,.4,.4],resource:!0}},SourceChestBonues[2])],bamboochest:[cleverapps.extend({bamboo:{basic:[1,0],bonus:[2,2],itemsProb:[.7,.3],resource:!0}},SourceChestBonues[0]),cleverapps.extend({bamboo:{basic:[0,0,0],bonus:[3,5],itemsProb:[.25,.5,.25],resource:!0}},SourceChestBonues[1]),cleverapps.extend({bamboo:{basic:[0,0,0],bonus:[7,9],itemsProb:[.2,.4,.4],resource:!0}},SourceChestBonues[2])],sapphirechest:[cleverapps.extend({sapphire:{basic:[1,0],bonus:[2,2],itemsProb:[.7,.3],resource:!0}},SourceChestBonues[0]),cleverapps.extend({sapphire:{basic:[0,0,0],bonus:[3,5],itemsProb:[.25,.5,.25],resource:!0}},SourceChestBonues[1]),cleverapps.extend({sapphire:{basic:[0,0,0],bonus:[7,9],itemsProb:[.2,.4,.4],resource:!0}},SourceChestBonues[2])],magicalwoodchest:[cleverapps.extend({magicalwood:{basic:[1,0],bonus:[2,2],itemsProb:[.7,
.3],resource:!0}},SourceChestBonues[0]),cleverapps.extend({magicalwood:{basic:[0,0,0],bonus:[3,5],itemsProb:[.25,.5,.25],resource:!0}},SourceChestBonues[1]),cleverapps.extend({magicalwood:{basic:[0,0,0],bonus:[7,9],itemsProb:[.2,.4,.4],resource:!0}},SourceChestBonues[2])],sacks:[{fruit:{family:!0,basic:[4,-1,-1,-1,0],bonus:[0,1]}},{fruit:{family:!0,basic:[7,-1,-1,-1,1],bonus:[0,2]}},{fruit:{family:!0,basic:[11,-1,-1,-1,3],bonus:[0,2]}}]},ChestCreatePrize={treasure:[void 0,{exp:1},{exp:2}],woodchest:[void 0,{exp:1},{exp:3}],stonechest:[void 0,{exp:5},{exp:15}],wagonchest:[void 0,{exp:5},{exp:15}],bamboochest:[void 0,{exp:5},{exp:15}],sapphirechest:[void 0,{exp:5},{exp:15}],magicalwoodchest:[void 0,{exp:5},{exp:15}],sacks:[void 0,{exp:1},{exp:2}]},CastleListPrize=function(e){e.unit.seedRandom(e.harvested);var t=cleverapps.Random.choose([5,6,7,8]);t*=e.unit.findComponent(Upgradable).level;var n=[{code:"sacks",stage:0},{code:"sacks",stage:1},{code:"worker",stage:0},{code:"worker",stage:1},
{code:"crystal",stage:0},{code:"wands",stage:0},{code:"coins",stage:0},{code:"coins",stage:1},{code:"rubies",stage:0},{code:"rubies",stage:1}];cleverapps.config.wysiwygMode&&(t=16,n=[{code:"sacks",stage:2},{code:"woodchest",stage:1},{code:"treasure",stage:2},{code:"crystal",stage:3},{code:"wands",stage:2},{code:"coins",stage:3},{code:"coins",stage:2},{code:"rubies",stage:2},{code:"rubies",stage:1}]);var s,i=[];for(s=0;s<t;s++){var o=cleverapps.Random.choose(n);i.push(o)}for(var r=!0;r;){r=!1,i.sort(function(e,t){return e.code!==t.code?e.code<t.code:e.stage-t.stage});var a=[];for(s=0;s<i.length;s++)s<i.length-2&&i[s].code===i[s+2].code&&i[s].stage===i[s+2].stage&&i[s].stage<Families[i[s].code].units.length-1?(a.push({code:i[s].code,stage:i[s].stage+1}),s+=2,r=!0):a.push(i[s]);i=a}var c=[];for(s=0;s<i.length;s++)c.push(Game.currentGame.decreasePrizeStageIfNeeded({code:i[s].code,stage:i[s].stage}));return c},ShapeSquare=[{x:0,y:0},{x:1,y:0},{x:0,y:1},{x:1,y:1}],ShapeTopRightCorner=[{x:0,
y:0},{x:-1,y:0},{x:0,y:-1}],ResourceFamily=function(i,o){for(var e=[0,1,2,3,5,10,15,25,150,300,500,1e3,3e3,5e3,8e3],t=[0,0,1,2,3,5,10,15,20,25,30,35,40,45,50],r=[],n=0;n<i;n++)if(n===i-1)r.push({exp:10*r[n-1].exp,coins:75});else{var s=void 0;(e[n]||t[n])&&(s={},e[n]&&(s.exp=e[n]),t[n]&&(s.coins=t[n])),r.push(s)}var a=["0 seconds","0 seconds","15 seconds","40 seconds","1 minute","5 minute","15 minute","2 hour","4 hour","8 hour","12 hour","14 hour","16 hour","18 hour","20 hour","22 hour"],c=[1,3,10,30,90,270,810,2430,7290,21870,65610,196830,590490,177e4,53e5].slice(0,i-1).map(function(e,t){var n=t;"wood"!==o&&1<n&&n++,a.length<=n&&(n=a.length-1);var s={buildable:a[n],createPrize:r[t]};return t<2&&(s.removable=!0),t===i-2&&(s.unmergeable=!0,s.resourceCollectible=!0,s.pulsing=!0),s.value=e,s});return c.push({unmergeable:!0,temporary:!0,multicell:ShapeSquare,important:!0,upgradable:{stages:5,level:0,collectedStage:i-2,moveToNextStageOnUpgrade:!0,changeImageStages:[2]}}),c.push({
unmergeable:!0,multicell:ShapeSquare,upgradable:{stages:5,level:1,collectedStage:i-2},castle:!0,important:!0,buildable:"24 hour",createPrize:r[i-1]}),{type:"resource",units:c}},FruitFamily=function(){return{type:"fruit",units:[{removable:!0},{createPrize:{exp:1,coins:1},removable:!0},{createPrize:{exp:2,coins:2},removable:!0},{fruit:!0,unmergeable:!0,createPrize:{exp:3,coins:3}},{pulsing:!0,collectible:!0,value:1,unmergeable:!0},{mineable:[{time:"15 seconds",exp:5,energy:5}]}]}},CustomFamily=function(e,t,n){for(var s=[void 0,5,10,15,25],i=[],o=0;o<e;o++){var r={createPrize:{exp:s[o]}};n.shine&&0<o&&(r.shine=!0),n.instantWorker&&o===e-1&&(r.instantWorker=!0),n.crystal&&o===e-1&&(r.crystal=!0),i.push(r)}return{type:t,units:i}},ChestFamily=function(e){for(var t=ChestListPrize[e],n=[],s=0;s<t.length;s++){var i={chest:!0};ChestCreatePrize[e]&&(i.createPrize=ChestCreatePrize[e][s]),n.push(i)}return{type:"chest",resource:e,units:n}},ValuableFamily=function(s,i){var e=i.amounts,o=i.exp;return{
type:"valuables",id:s,units:e.map(function(e,t){var n;return n="wands"===s?{value:e,divideCollectible:0!==e}:{value:e,collectible:0!==e},o[t]&&(n.createPrize={exp:o[t]}),i.shineFrom&&t>=i.shineFrom&&(n.shine=!0),n})}},GeneratorFamily=function(e){var t,n,s=[],i=[],o=[];for(n=7,t=0;t<n;t++)s.push({time:t===n-1?"3 hours":"0 seconds",exp:t===n-1?50:15,energy:t===n-1?30:5});for(n=6,t=0;t<n;t++)i.push({time:t===n-1?"3 hours":"0 seconds",exp:t===n-1?100:30,energy:t===n-1?40:10});for(n=5,t=0;t<n;t++)o.push({time:t===n-1?"3 hours":"0 seconds",exp:t===n-1?150:50,energy:t===n-1?50:15});return{type:"generator",resource:e,units:[{unmergeable:!0,mineable:s,multicell:ShapeSquare,generator:{levels:3},important:!0},{unmergeable:!0,mineable:i,multicell:ShapeSquare,generator:{levels:5},important:!0},{unmergeable:!0,mineable:o,multicell:ShapeSquare,generator:{brightLevels:5},important:!0}]}},SourceFamily=function(e){var t={stump:[{time:"0 second",exp:5,energy:3},{time:"30 seconds",exp:20,energy:5}],
sapling:[{time:"0 second",exp:5,energy:3},{time:"0 second",exp:20,energy:5},{time:"45 second",exp:25,energy:10},{time:"1 minute",exp:30,energy:15}],tree:[{time:"0 minute",exp:5,energy:5},{time:"0 minute",exp:20,energy:10},{time:"0 minute",exp:25,energy:15},{time:"45 seconds",exp:30,energy:20},{time:"1 minute",exp:35,energy:25},{time:"5 minute",exp:40,energy:30}]};return{type:"source",resource:e,units:[{removable:!0},{mineable:t.stump,unmergeable:!0,createPrize:{exp:1,coins:1}},{removable:!0},{mineable:t.sapling,unmergeable:!0,createPrize:{exp:5,coins:2}},{removable:!0},{mineable:t.tree,unmergeable:!0,createPrize:{exp:10,coins:5}}]}},DishesFamily=function(){return{type:"dish",units:Recipes.map(function(e,t){return{dish:e.code,recipe:e,bubble:!0,unmergeable:!0}})}},HeroFamily=function(n){for(var e=[void 0,{exp:1,coins:1},{exp:2,coins:1},{exp:3,coins:1},{exp:5,coins:2},{exp:10,coins:3},{exp:25,coins:5}],t=cleverapps.arrayFill(n).map(function(e,t){return t===n-1?{makesorder:!0,
unmergeable:!0}:{heroitem:!0}}),s=0;s<t.length-1;s++)t[s].createPrize=e[s];return{type:"hero",units:t}},MagicPlantFamily=function(e){for(var t=[0,1,2,3,5,10,15,25,150],n=[0,0,1,2,3,5,10,15,20],s=[],i=0;i<e;++i){var o={};(t[i]||n[i])&&(o.createPrize={exp:t[i],coins:n[i]}),i===e-1&&(o.magicplant={listPrize:[{code:"crystal",stage:3}],timeout:"24 hours"},o.unmergeable=!0),4<i&&(o.shine=!0),s.push(o)}return{type:"magicplant",units:s}},RubiesPlantFamily=function(e){for(var t=[0,50,200],n=[0,10,30],s=[],i=0;i<e;++i){var o={magicplant:{listPrize:[{code:"rubies",stage:i}],timeout:"3 hours"},shine:!0};(t[i]||n[i])&&(o.createPrize={exp:t[i],coins:n[i]}),s.push(o)}return{type:"rubiesplant",units:s}},SpecialUnitFamily=function(e){return{units:[e]}},DecoratorFamily=function(){var e=[{multicell:ShapeTopRightCorner}];return e.forEach(function(e){e.unmergeable=!0}),{type:"decorator",units:e}},Families={};Families.wood=ResourceFamily(9,"wood"),Families.stone=ResourceFamily(10,"stone"),
Families.wagon=ResourceFamily(10,"wagon"),Families.bamboo=ResourceFamily(10,"bamboo"),Families.sapphire=ResourceFamily(11,"sapphire"),Families.wheat=FruitFamily(),Families.candies=FruitFamily(),Families.apple=FruitFamily(),Families.strawberry=FruitFamily(),Families.mushrooms=FruitFamily(),Families.corn=FruitFamily(),Families.treasure=ChestFamily("treasure"),Families.herochest=ChestFamily("herochest"),Families.freechest=ChestFamily("freechest"),Families.sacks=ChestFamily("sacks"),Families.woodchest=ChestFamily("woodchest"),Families.stonechest=ChestFamily("stonechest"),Families.wagonchest=ChestFamily("wagonchest"),Families.bamboochest=ChestFamily("bamboochest"),Families.sapphirechest=ChestFamily("sapphirechest"),Families.wands=ValuableFamily("wands",{amounts:[5,15,45,135,405,1215],exp:[0,1,3,5,7,10]}),Families.coins=ValuableFamily("coins",{amounts:[0,1,3,10,30,90,270,810],exp:[0,1,2,3,5,7,9,15],shineFrom:4}),Families.rubies=ValuableFamily("rubies",{amounts:[0,2,6,20,60,180],exp:[0,1,1,2,
3,10],shineFrom:2}),Families.worker=CustomFamily(5,"custom",{instantWorker:!0}),Families.crystal=CustomFamily(4,"custom",{shine:!0,crystal:!0}),Families.woodsource=SourceFamily("wood"),Families.stonesource=SourceFamily("stone"),Families.wagonsource=SourceFamily("wagon"),Families.bamboosource=SourceFamily("bamboo"),Families.sapphiresource=SourceFamily("sapphire"),Families.woodgenerator=GeneratorFamily("wood"),Families.stonegenerator=GeneratorFamily("stone"),Families.wagongenerator=GeneratorFamily("wagon"),Families.bamboogenerator=GeneratorFamily("bamboo"),Families.sapphiregenerator=GeneratorFamily("sapphire"),Families.dishes=DishesFamily(),Families.dwarf=HeroFamily(2),Families.king=HeroFamily(4),Families.bear=HeroFamily(7),Families.elf=HeroFamily(8),Families.warlock=HeroFamily(9),Families.troll=HeroFamily(10),Families.multiCellBody=SpecialUnitFamily({multiCellBody:!0}),Families.specialoffer=SpecialUnitFamily({unmergeable:!0,specialoffer:!0}),Families.dragonmine=SpecialUnitFamily({
minigame:"minesweeper",unmergeable:!0,multicell:ShapeSquare,important:!0}),Families.decorator=DecoratorFamily(),Families.magicplant=MagicPlantFamily(9),Families.rubiesplant=RubiesPlantFamily(3),function(){for(var e in Families)Families[e].code=e}();var SourceMine={chestPrizes:{stump:function(e){var t=[{code:e.getResource()+"chest",stage:0}];return e.isGrounded()||t.push({code:e.getResource()+"source",stage:2}),t},sapling:function(e){var t=[{code:e.getResource()+"chest",stage:1}];return e.isGrounded()||t.push({code:e.getResource()+"source",stage:4}),t},tree:function(e){return[{code:e.getResource()+"chest",stage:2}]}},defaults:function(e,t){switch(e){case 0:return Mines.Times(2,{code:t.getResource(),stage:0}).concat(Mines.HeroItem(.25,1));case 1:return Mines.Probability(4,[.02,.25,.5,1],[{code:"worker",stage:0},{type:"resource",stage:0},{code:t.getResource(),stage:0},{code:t.getResource(),stage:1}]).concat(Mines.HeroItem(.35,1));case 2:return Mines.Probability(4,[.13,.13,.15,.25,1],[{
code:"worker",stage:0},{code:"coins",stage:0},{type:"resource",stage:0},{code:t.getResource(),stage:0},{code:t.getResource(),stage:1}]).concat(Mines.HeroItem(.4,1));case 3:return Mines.Probability(5,[.1,.1,.15,.25,1],[{code:"worker",stage:0},{code:"coins",stage:0},{type:"resource",stage:0},{code:t.getResource(),stage:0},{code:t.getResource(),stage:1}]).concat(Mines.Maybe(.1,{type:"fruit",stage:0})).concat(Mines.HeroItem(.5,2));case 4:return Mines.Probability(6,[.06,.1,.25,.16,1],[{code:"worker",stage:0},{code:"crystal",stage:0},{code:"coins",stage:0},{type:"resource",stage:0},{code:t.getResource(),stage:1}]).concat(Mines.Maybe(.25,{type:"fruit",stage:0})).concat(Mines.HeroItem(.7,2))}},stump:function(e,t){return e===t.getData().mineable.length-1?SourceMine.chestPrizes.stump(t):SourceMine.defaults(e,t)},sapling:function(e,t){return e===t.getData().mineable.length-1?SourceMine.chestPrizes.sapling(t):SourceMine.defaults(e,t)},tree:function(e,t){return e===t.getData(
).mineable.length-1?SourceMine.chestPrizes.tree(t):SourceMine.defaults(e,t)}},FruitMine=function(e,t){return Mines.Probability(5,[.166,.166,1],[{code:t.code,stage:1},{code:"coins",stage:0},{code:t.code,stage:0}])},GeneratorSourceMine={level1:function(e,t){var n=Mines.Probability(3,[.75,.25],[{code:t.getResource()+"source",stage:0},{code:t.getResource(),stage:0}]);return e===t.getData().mineable.length-1&&(n=n.concat([{code:"coins",stage:0},{code:"coins",stage:0},{code:"coins",stage:0},{code:"rubies",stage:0}])),n},level2:function(e,t){var n=Mines.Probability(4,[.35,.35,.15,.15],[{code:t.getResource()+"source",stage:0},{code:t.getResource()+"source",stage:2},{code:t.getResource(),stage:0},{code:t.getResource(),stage:1}]);return e===t.getData().mineable.length-1&&(n=n.concat([{code:"coins",stage:0},{code:"coins",stage:0},{code:"coins",stage:0},{code:"coins",stage:0},{code:"rubies",stage:0}])),n},level3:function(e,t){var n=Mines.Probability(5,[.2,.3,.3,.1,.1],[{code:t.getResource(
)+"source",stage:0},{code:t.getResource()+"source",stage:2},{code:t.getResource()+"source",stage:4},{code:t.getResource(),stage:0},{code:t.getResource(),stage:1}]);return e===t.getData().mineable.length-1&&(n=n.concat([{code:"coins",stage:1},{code:"coins",stage:1},{code:"rubies",stage:0}])),n}},Mines={fruit:{5:FruitMine},source:{1:SourceMine.stump,3:SourceMine.sapling,5:SourceMine.tree},generator:[GeneratorSourceMine.level1,GeneratorSourceMine.level2,GeneratorSourceMine.level3],HeroItem:function(e,t){if(cleverapps.Random.nextDouble()<e){var n=Math.floor(cleverapps.Random.nextDouble()*t),s=Game.currentGame.unitsLibrary.getNextHero();if(s&&n<Families[s].units.length-1)return[{code:s,stage:n}]}return[]},Maybe:function(e,t){return cleverapps.Random.nextDouble()<e?[t]:[]},Times:function(e,t){for(var n=[],s=0;s<e;s++)n.push({code:t.code,stage:t.stage});return n},Probability:function(e,t,n){t[t.length-1]=100;for(var s=[],i=0;i<e;i++)for(var o=cleverapps.Random.nextDouble(),r=0;r<t.length;r++
)if((o-=t[r])<0){s.push({unit:cleverapps.clone(n[r]),probability:t[r]});break}return s.sort(function(e,t){return e.probability-t.probability}),s.map(function(e){return e.unit})}},Buildable=function(e,t){this.unit=e,this.load(t),this.onCompletion=function(){},this.onHighlight=function(){},this.onUnhighlight=function(){},this.onHideDetails=function(){},this.onShowDetails=function(){},e.onInfoOpened=function(){this.onHideDetails()}.bind(this),e.onInfoClosed=function(e){e||this.onShowDetails()}.bind(this)};Buildable.IsBuilt=function(e){var t=e.findComponent(Buildable);return!t||t.isCompleted()},Buildable.STATES={WAIT:0,FINISHED:1},Buildable.prototype.isCompleted=function(){return this.state===Buildable.STATES.FINISHED},Buildable.prototype.load=function(e){void 0!==e.time?(this.time=e.time,this.state=Buildable.STATES.WAIT):(this.time=cleverapps.parseInterval(this.unit.getData().buildable),this.state=0===this.time?Buildable.STATES.FINISHED:Buildable.STATES.WAIT)},
Buildable.prototype.save=function(e){this.isCompleted()||(e.time=this.time,e.unbuilt=!0)},Buildable.prototype.getInfo=function(){if(!Game.currentGame.workers.findInstantAssigned(this)&&this.state===Buildable.STATES.WAIT)return{title:"messages:Buildable.info.title",duration:this.time,actions:{build:this.startBuilding.bind(this),instant:Game.currentGame.workers.hasInstant()&&this.assignInstantWorker.bind(this)}}},Buildable.prototype.getTask=function(){return{time:this.time}},Buildable.prototype.assignInstantWorker=function(){var e=Game.currentGame.workers.listInstantFree()[0];e?e.buildInstantly(this):console.log("No instant")},Buildable.prototype.startBuilding=function(){var e,t=Game.currentGame.workers.findFree();t||Game.currentGame.workersBusyHint(),t&&t.assign(this.unit,this.time)&&(Game.currentGame.gameEvent(Merge.START_BUILDING,{affected:this.unit}),e=!0),e||this.onShowDetails()},Buildable.prototype.completeBuilding=function(e){var t=this.time-e;if(0<t)this.time=t,
this.state=Buildable.STATES.WAIT;else{this.time=0,this.state=Buildable.STATES.FINISHED,this.onCompletion(),this.unit.onCreatePrize(),Game.currentGame.gameEvent(Merge.BUILD,{affected:this.unit});var n=this.unit.findComponent(Castle);n&&n.buildingComplete();var s=this.unit.findComponent(Upgradable);s&&s.buildingComplete();var i=this.unit.findComponent(Pulsing);i&&i.init(),Game.currentGame.onUnitAvailable(this.unit),cleverapps.missionManager.findByType(Mission.TYPE_BATTLEPASS)&&2<=this.unit.stage&&this.unit.setPoints(Buildable.POINTS[Math.min(this.unit.stage,Buildable.POINTS.length-1)])}this.unit.save(),this.onShowDetails()},Buildable.POINTS=[0,0,5,10,20,60,300,600,2e3,2500,3e3,4e3];var Mineable=function(e,t){this.unit=e,this.mined=t.mined||0,this.state=t.state||Mineable.STATES.WAIT,this.onMoveNext=function(){},e.onPrizeHarvested=this.nextPosition.bind(this),this.isCompleted()?this.removeUponCompletion():this.state===Mineable.STATES.FINISHED&&this.unit.setPrizes(this.listPrize(),
this.getTask().exp),this.onHideDetails=function(){},this.onShowDetails=function(){},e.onInfoOpened=function(){this.onHideDetails()}.bind(this),e.onInfoClosed=function(e){e||this.onShowDetails()}.bind(this)};Mineable.STATES={WAIT:0,FINISHED:1},Mineable.prototype.save=function(e){e.mined=this.mined,e.state=this.state},Mineable.prototype.listPrize=function(){var e=this.unit.findComponent(Generator);return this.unit.seedRandom(this.mined+(e?10*e.changedLevels:0)),Mines[this.unit.getType()][this.unit.stage](this.mined,this.unit).map(function(e){if(e instanceof Unit)return e;if(e.type){var t=Game.currentGame.listAvailableByType(e.type);return new Unit(Game.currentGame.decreasePrizeStageIfNeeded({code:cleverapps.Random.choose(t),stage:e.stage}))}return new Unit(Game.currentGame.decreasePrizeStageIfNeeded(e))})},Mineable.prototype.getTask=function(){return this.unit.getData().mineable[this.mined]},Mineable.prototype.startMine=function(){var e=Game.currentGame,t=e.workers.findFree()
;t||e.workersBusyHint();var n,s=this.getTask();if(t&&e.useEnergy(s.energy,this.unit)){e.gameEvent(Merge.START_MINING,{unit:this.unit});var i=cleverapps.parseInterval(s.time);n=t.assign(this.unit,i)}n||this.onShowDetails()},Mineable.prototype.completeMining=function(){this.state=Mineable.STATES.FINISHED,this.unit.save(),Game.currentGame.gameEvent(Merge.COMPLETE_MINING,{unit:this.unit}),this.unit.setPrizes(this.listPrize(),this.getTask().exp)},Mineable.prototype.isCompleted=function(){return this.mined>=this.unit.getData().mineable.length},Mineable.prototype.removeUponCompletion=function(){this.unit.movable=!1,this.timeout=setTimeout(function(){delete this.timeout,delete this.unit.movable;var e=this.unit.findComponent(Generator);e?e.gotoNextLevel():(this.unit.onDestruction(),this.unit.remove(!0),Game.currentGame.fogs.updateBlockedGrounds())}.bind(this),1e3)},Mineable.prototype.nextPosition=function(){this.mined++,this.onMoveNext(),this.onShowDetails(),this.isCompleted()?(
Game.currentGame.gameEvent(Merge.MINE,{affected:this.unit}),this.removeUponCompletion()):this.state=Mineable.STATES.WAIT,this.unit.save()},Mineable.prototype.clear=function(){this.timeout&&(clearTimeout(this.timeout),delete this.timeout)},Mineable.prototype.getInfo=function(){if(this.state===Mineable.STATES.WAIT)return{title:this.unit,progress:{value:this.mined,total:this.unit.getData().mineable.length},duration:cleverapps.parseInterval(this.getTask().time),actions:{energy:{action:this.startMine.bind(this),energy:this.getTask().energy}}}};var MiniGame=function(e,t){this.unit=e,this.sinceLastHarvest=void 0,this.harvestDuration=cleverapps.parseInterval(MiniGame.HARVEST_INTERVAL),this.onCompleteWait=function(){},this.onStartWait=function(){},e.onPrizeHarvested=this.restartHarvest.bind(this),this.sinceLastHarvest=t.sinceLastHarvest,this.isPrizeReady()?(this.sinceLastHarvest=void 0,this.unit.setPrizes(this.getMiniGamePrize())):this.timeout=new cleverapps.LongTimeout(this.makeReady.bind(this
),this.timeToReady())};MiniGame.prototype.getMiniGamePrize=function(){return{minigame:!0}},MiniGame.prototype.isPrizeReady=function(){return void 0===this.sinceLastHarvest||0===this.timeToReady()},MiniGame.prototype.save=function(e){e.sinceLastHarvest=this.sinceLastHarvest},MiniGame.prototype.getInfo=function(){return{title:this.unit,countdown:this.timeToReady(),actions:{speedup:{unit:this.unit,action:this.makeReady.bind(this),duration:this.timeToReady()}}}},MiniGame.prototype.clear=function(){clearTimeout(this.timeout)},MiniGame.prototype.restartHarvest=function(){this.sinceLastHarvest=Date.now(),clearTimeout(this.timeout),this.timeout=new cleverapps.LongTimeout(this.makeReady.bind(this),this.timeToReady()),this.unit.save(),this.onStartWait(),Game.currentGame.pushes.updateMiniGames()},MiniGame.prototype.makeReady=function(){clearTimeout(this.timeout),this.sinceLastHarvest=void 0,this.unit.setPrizes(this.getMiniGamePrize()),this.unit.save(),this.onCompleteWait(),
Game.currentGame.pushes.updateMiniGames()},MiniGame.prototype.timeToReady=function(){return Math.max(0,this.sinceLastHarvest+this.harvestDuration-Date.now())},MiniGame.HARVEST_INTERVAL="6 hours";var MultiCell=function(e){this.unit=e,this.shape=e.getData().multicell,this.bodyUnits=this.shape.map(function(){var e=new Unit({code:"multiCellBody",stage:0});return e.head=this.unit,e},this)};MultiCell.prototype.getCenter=function(){for(var e=0,t=0,n=0;n<this.shape.length;n++)e+=this.shape[n].x+this.shape[n].y,t+=this.shape[n].x-this.shape[n].y;return e/=this.shape.length,t/=this.shape.length,{x:cleverapps.styles.Map2dView.cell.width*e/2,y:cleverapps.styles.Map2dView.cell.height*t/2}},MultiCell.prototype.restore=function(){for(var e,t,n,s,i=Game.currentGame.map,o=0;o<this.shape.length;o++)if((this.shape[o].x||this.shape[o].y)&&(n=this.unit.x+this.shape[o].x,s=this.unit.y+this.shape[o].y,(e=this.bodyUnits[o])!==(t=i.getUnit(n,s)))){if(t){var r=i.findEmptySlot(n,s);r&&(t.move(r.x,r.y),t=void 0)}
t||(e.setPosition(n,s),i.add(Map2d.LAYER_UNITS,e.x,e.y,e),cleverapps.eventLogger.logEvent("restore_multicellbody"))}},MultiCell.prototype.remove=function(){for(var e,t=0;t<this.shape.length;t++)void 0!==(e=this.bodyUnits[t]).x&&void 0!==e.y&&e.remove()},MultiCell.prototype.occupite=function(){for(var e,t,n,s,i=Game.currentGame.map,o=0;o<this.shape.length;o++)(this.shape[o].x||this.shape[o].y)&&(e=this.unit.x+this.shape[o].x,t=this.unit.y+this.shape[o].y,n=i.getUnit(e,t),s=this.bodyUnits[o],n&&n!==s||(s.setPosition(e,t),i.add(Map2d.LAYER_UNITS,s.x,s.y,s)))};var Fruit=function(e,t){this.unit=e,this.harvested=t.harvested||0,this.harvestDuration=cleverapps.parseInterval(Fruit.HARVEST_DURATION_PER_CODE[this.unit.code]),this.onStartGrowth=function(){},this.onCompleteGrowth=function(){},e.onPrizeHarvested=this.restartGrowth.bind(this),this.sinceLastHarvest=t.sinceLastHarvest,void 0!==this.sinceLastHarvest&&this.timeToReady()?this.timeout=new cleverapps.LongTimeout(this.makeReady.bind(this),
this.timeToReady()):(this.unit.setPrizes(this.listPrize(),Fruit.HARVESTED_EXP),this.sinceLastHarvest=void 0)};Fruit.HARVESTED_EXP=3,Fruit.MAX_HARVESTED=3,Fruit.HARVEST_DURATION_PER_CODE={candies:"4 hour",wheat:"3 hour",apple:"5 hour",strawberry:"3 hour",mushrooms:"4 hour",corn:"5 hour"},Fruit.prototype.save=function(e){e.harvested=this.harvested,e.sinceLastHarvest=this.sinceLastHarvest},Fruit.prototype.clear=function(){clearTimeout(this.timeout)},Fruit.prototype.getInfo=function(){return{title:{code:this.unit.code,stage:4,icon:!0},progress:{value:this.harvested,total:Fruit.MAX_HARVESTED},countdown:this.timeToReady(),actions:{speedup:{unit:this.unit,action:this.makeReady.bind(this),duration:this.timeToReady()}}}},Fruit.prototype.timeToReady=function(){return Math.max(0,this.sinceLastHarvest+this.harvestDuration-Date.now())},Fruit.prototype.listPrize=function(){this.unit.seedRandom(this.harvested);for(var e=cleverapps.Random.choose([4,5,6]),t=[],n=0;n<e;n++)t.push(new Unit({
code:this.unit.code,stage:4}));return 6<=Game.currentGame.gameLevel.getLevel()&&cleverapps.Random.random(0,1)<1&&t.push(new Unit({code:"magicplant",stage:0})),t},Fruit.prototype.restartGrowth=function(){if(this.harvested++,this.sinceLastHarvest=Date.now(),this.unit.save(),clearTimeout(this.timeout),this.harvested===Fruit.MAX_HARVESTED){this.unit.remove();var e=new Unit({code:this.unit.code,stage:5});e.setPosition(this.unit.x,this.unit.y),Game.currentGame.map.add(Map2d.LAYER_UNITS,e.x,e.y,e),Game.currentGame.map.onAdd(Map2d.LAYER_UNITS,e.x,e.y,e),Game.currentGame.onUnitAvailable(e)}else this.timeout=new cleverapps.LongTimeout(this.makeReady.bind(this),this.timeToReady()),this.onStartGrowth();Game.currentGame.pushes.updateFruits()},Fruit.prototype.isGrowing=function(){return void 0!==this.sinceLastHarvest&&0<this.timeToReady()},Fruit.prototype.makeReady=function(){clearTimeout(this.timeout),this.sinceLastHarvest=void 0,this.unit.save(),this.unit.setPrizes(this.listPrize(),
Fruit.HARVESTED_EXP),this.onCompleteGrowth(),Game.currentGame.pushes.updateFruits()};var Upgradable=function(e,t){var n=(this.unit=e).getData().upgradable;this.level=void 0!==t.level?t.level:n.level,this.progress=void 0!==t.progress?t.progress:0,this.stages=n.stages,this.collectedStage=n.collectedStage,this.moveToNextStageOnUpgrade=n.moveToNextStageOnUpgrade,this.changeImageStages=n.changeImageStages,this.onBuild=function(){},this.onUpdateLevel=function(){},this.onChangeProgress=function(){},this.highlightCollect=function(){},this.unhighlightCollect=function(){},this.onStartUpdateLevel=function(){},this.beforeChangeUnit=function(){},this.progress>=this.stages&&setTimeout(this.moveToNextLevel.bind(this),0)};Upgradable.prototype.save=function(e){e.progress=this.progress,e.level=this.level},Upgradable.prototype.getProgressAnimation=function(){if(!this.changeImageStages||this.progress<this.changeImageStages[0])return"animation";for(
var e=0;e<this.changeImageStages.length&&this.progress>=this.changeImageStages[e];)e++;return"animation"+(e+1)},Upgradable.prototype.canCollectStage=function(e){return Buildable.IsBuilt(this.unit)?e===this.collectedStage&&this.progress<this.stages:(Game.currentGame.onHintMessage(Messages.get("cantCollectBuilding",{target:Messages.get("Units."+this.unit.code+".stage"+this.unit.stage+".name")})),!1)},Upgradable.prototype.buildingComplete=function(){this.buildingCompleteTimeout=setTimeout(function(){delete this.buildingCompleteTimeout,this.onBuild()}.bind(this),1500)},Upgradable.prototype.clear=function(){this.buildingCompleteTimeout&&(clearTimeout(this.buildingCompleteTimeout),delete this.buildingCompleteTimeout),this.moveToNextLevelTimeout&&(clearTimeout(this.moveToNextLevelTimeout),delete this.moveToNextLevelTimeout),this.incProgressTimeout&&(clearTimeout(this.incProgressTimeout),delete this.incProgressTimeout)},Upgradable.prototype.moveToNextLevel=function(){if(
this.moveToNextStageOnUpgrade){this.beforeChangeUnit();var e=new Unit({code:this.unit.code,stage:this.unit.stage+1,unbuilt:!0});if(this.unit.remove(),e.setPosition(this.unit.x,this.unit.y),Game.currentGame.map.add(Map2d.LAYER_UNITS,e.x,e.y,e),Game.currentGame.map.onAdd(Map2d.LAYER_UNITS,e.x,e.y,e),cleverapps.config.wysiwygMode&&cleverapps.flags.wysiwyg.skipBuildingStage){var t=e.findComponent(Buildable);t.onHideDetails(),setTimeout(function(){t.completeBuilding(t.time)},200)}}else this.level++,this.progress=0,this.onUpdateLevel(),this.onChangeProgress(!0),this.unit.save()},Upgradable.prototype.incProgress=function(e){this.progress++,this.unit.save(),this.incProgressTimeout=setTimeout(function(e){delete this.incProgressTimeout,this.onChangeProgress(),e===this.stages&&(this.onStartUpdateLevel(),this.moveToNextLevelTimeout=setTimeout(function(){delete this.moveToNextLevelTimeout,this.moveToNextLevel()}.bind(this),500))}.bind(this,this.progress),e)},
Upgradable.prototype.handleClick=function(){var t=this.unit,n=t.getFamily();if("resource"===n.type&&t.stage===n.units.length-2&&!cleverapps.metha.isFocused())return cleverapps.metha.display({focus:"CastleWindow",action:function(e){new CastleGuideWindow({code:t.code,stage:n.units.length-1}),cleverapps.metha.onceNoWindowsListener=e}}),!0};var Castle=function(e,t){if(this.unit=e,this.harvested=t.harvested||0,this.builded=!1,this.sinceLastHarvest=void 0,this.harvestDuration=cleverapps.parseInterval("24 hour"),this.onBuildCastle=function(){},this.onCompleteWait=function(){},this.onStartWait=function(){},e.onPrizeHarvested=this.restartHarvest.bind(this),Buildable.IsBuilt(this.unit))if(this.builded=!0,this.sinceLastHarvest=t.sinceLastHarvest,this.isCreatingPrize())this.timeout=new cleverapps.LongTimeout(this.makeReady.bind(this),this.timeToReady());else{var n=this.listPrize().map(function(e){return new Unit(e)});this.unit.setPrizes(n,Castle.HARVESTED_EXP),this.sinceLastHarvest=void 0}}
;Castle.prototype.isCreatingPrize=function(){return void 0!==this.sinceLastHarvest&&0<this.timeToReady()},Castle.prototype.save=function(e){e.sinceLastHarvest=this.sinceLastHarvest,e.harvested=this.harvested},Castle.prototype.getInfo=function(){if(this.builded)return{title:this.unit,countdown:this.timeToReady(),actions:{speedup:{unit:this.unit,action:this.makeReady.bind(this),duration:this.timeToReady()}}}},Castle.prototype.clear=function(){clearTimeout(this.timeout)},Castle.prototype.listPrize=function(){return CastleListPrize(this)},Castle.prototype.restartHarvest=function(){this.sinceLastHarvest=Date.now(),this.harvested++,clearTimeout(this.timeout),this.timeout=new cleverapps.LongTimeout(this.makeReady.bind(this),this.timeToReady()),this.unit.save(),this.onStartWait(),Game.currentGame.pushes.updateCastles()},Castle.prototype.makeReady=function(){clearTimeout(this.timeout);var e=this.listPrize().map(function(e){return new Unit(e)});this.unit.setPrizes(e,Castle.HARVESTED_EXP),
this.sinceLastHarvest=void 0,this.unit.save(),this.onCompleteWait(),Game.currentGame.pushes.updateCastles()},Castle.prototype.timeToReady=function(){return Math.max(0,this.sinceLastHarvest+this.harvestDuration-Date.now())},Castle.prototype.buildingComplete=function(){var e=3500;cleverapps.config.wysiwygMode&&cleverapps.flags.wysiwyg.skipBuildingStage&&(e=2e3),Game.currentGame.counter.setTimeout(function(){this.builded=!0,this.onBuildCastle(),this.makeReady()}.bind(this),e)},Castle.HARVESTED_EXP=50;var Crystal=function(e){this.unit=e};Crystal.prototype.getInfo=function(){return{title:Game.currentGame.unitsLibrary.getUnitName(this.unit),guide:{class:CrystalGuideWindow,unit:this.unit}}};var HeroItem=function(e){this.unit=e};HeroItem.prototype.getInfo=function(){if(!(cleverapps.metha.isFocused()||Game.currentGame.gameLevel.getLevel()<3))return{title:Game.currentGame.unitsLibrary.getUnitName(this.unit),guide:{class:UnitsLibraryWindow,unit:this.unit}}};var SpecialOffer=function(e,t){
this.unit=e,this.prize=new Unit({code:t.prize.code,stage:t.prize.stage}),this.timeStart=Date.now(),this.timeout=new cleverapps.LongTimeout(this.pass.bind(this),cleverapps.parseInterval(SpecialOffer.DURATION)),cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.SPECIAL_OFFER_LAST_TIME,this.timeStart),this.onAppearance=function(){},this.onDestruction=function(){},this.onBuying=function(){},cleverapps.eventLogger.logEvent(cleverapps.EVENTS.SPECIAL_OFFER_COUNT)};SpecialOffer.IsAvailable=function(e){if(cleverapps.config.wysiwygMode&&cleverapps.flags.wysiwyg.skipSpecialOffer)return!1;if(e.stage<6)return!1;if(cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.SPECIAL_OFFER_LAST_TIME)+cleverapps.parseInterval(SpecialOffer.TIMEOUT)>Date.now())return!1;var t=Families[e.code];return"resource"===t.type?e.stage>=t.units.length-4&&e.stage<t.units.length-2:"hero"===t.type&&(e.stage>=t.units.length-3&&e.stage<t.units.length-1)},SpecialOffer.CreateOffer=function(e){var t=Game.currentGame,n=t.map,
s=n.findEmptySlot(e.x,e.y);if(s){var i=new Unit({code:"specialoffer",stage:0,prize:e});i.setPosition(s.x,s.y),n.add(Map2d.LAYER_UNITS,s.x,s.y,i),t.counter.setTimeout(function(){n.onAdd(Map2d.LAYER_UNITS,i.x,i.y,i),i.findComponent(SpecialOffer).onAppearance()}.bind(this),1e3)}},SpecialOffer.prototype.clear=function(){clearTimeout(this.timeout)},SpecialOffer.prototype.getTimeLeft=function(){return Math.max(0,this.timeStart+cleverapps.parseInterval(SpecialOffer.DURATION)-Date.now())},SpecialOffer.prototype.getPrice=function(){return Math.max(300,300+200*(this.prize.stage-6))},SpecialOffer.prototype.handleClick=function(){cleverapps.metha.display({focus:"specialOfferWindow",actions:[function(e){setTimeout(e,300)},function(e){new SpecialOfferWindow(this),cleverapps.metha.onceNoWindowsListener=e}.bind(this)]})},SpecialOffer.prototype.buy=function(){if(this.getTimeLeft()&&cleverapps.user.takeGold(this.getPrice())){var e=Game.currentGame.map,t=this.unit,n=this.prize;return t.remove(!0),
n.setPosition(t.x,t.y),e.add(Map2d.LAYER_UNITS,n.x,n.y,n),e.onAdd(Map2d.LAYER_UNITS,n.x,n.y,n),this.onBuying(),cleverapps.eventLogger.logEvent(cleverapps.EVENTS.SPECIAL_OFFER_BUY),cleverapps.eventLogger.logEvent(cleverapps.EVENTS.SPECIAL_OFFER_RUBY,{amount:this.getPrice()}),!0}return!1},SpecialOffer.prototype.pass=function(){this.onDestruction(),this.unit.onDestruction(),this.unit.remove(!0)},SpecialOffer.TIMEOUT="24 hours",SpecialOffer.DURATION="5 minutes",cleverapps.config.debugMode&&(SpecialOffer.TIMEOUT="10 seconds",SpecialOffer.DURATION="30 seconds");var MagicPlant=function(e,t){this.unit=e,this.lastHarvested=t.lastHarvested||0;var n=e.getData();this.prizes=n.magicplant.listPrize,this.growTime=n.magicplant.timeout,e.onPrizeHarvested=this.restartGrowth.bind(this),this.timeout=new cleverapps.LongTimeout(this.makeReady.bind(this),this.getTimeLeft()),this.onStartGrowth=function(){},this.onCompleteGrowth=function(){}};MagicPlant.prototype.save=function(e){
e.lastHarvested=this.lastHarvested},MagicPlant.prototype.clear=function(){clearTimeout(this.timeout)},MagicPlant.prototype.restartGrowth=function(){clearTimeout(this.timeout),this.lastHarvested=Date.now(),this.timeout=new cleverapps.LongTimeout(this.makeReady.bind(this),this.getTimeLeft()),this.unit.save(),this.onStartGrowth(),Game.currentGame.pushes.updateMagicPlants()},MagicPlant.prototype.isGrowing=function(){return 0<this.getTimeLeft()},MagicPlant.prototype.makeReady=function(){clearTimeout(this.timeout);var e=this.listPrize().map(function(e){return new Unit(e)});this.lastHarvested=void 0,this.unit.setPrizes(e,MagicPlant.HARVESTED_EXP),this.unit.save(),this.onCompleteGrowth(),Game.currentGame.pushes.updateMagicPlants()},MagicPlant.prototype.getTimeLeft=function(){return Math.max(0,this.lastHarvested+cleverapps.parseInterval(this.growTime)-Date.now())},MagicPlant.prototype.listPrize=function(){return this.prizes},MagicPlant.prototype.getInfo=function(){return{title:this.unit,
countdown:this.getTimeLeft(),actions:{speedup:{unit:this.unit,action:this.makeReady.bind(this),duration:this.getTimeLeft()}}}},MagicPlant.HARVESTED_EXP=10;var ComponentsFactory=function(e,t,n){n.grounded&&e.push(new Grounded(t));var s=t.getData();s.chest&&e.push(new Chest(t)),s.fruit&&e.push(new Fruit(t,n)),s.pulsing&&e.push(new Pulsing(t)),s.bubble&&e.push(new Bubble(t)),s.collectible&&e.push(new Collectible(t)),s.divideCollectible&&e.push(new DivideCollectible(t)),s.resourceCollectible&&e.push(new ResourceCollectible(t)),s.shine&&e.push(new Shine),s.dish&&e.push(new Dish(t)),s.makesorder&&e.push(new MakesOrder(t,n)),s.mineable&&e.push(new Mineable(t,n)),s.instantWorker&&e.push(new InstantWorker(t,n)),s.buildable&&n.unbuilt&&e.push(new Buildable(t,n)),s.generator&&e.push(new Generator(t,n)),s.upgradable&&e.push(new Upgradable(t,n)),s.castle&&e.push(new Castle(t,n)),s.multicell&&e.push(new MultiCell(t)),s.crystal&&e.push(new Crystal(t)),s.heroitem&&e.push(new HeroItem(t)),
s.specialoffer&&e.push(new SpecialOffer(t,n)),s.magicplant&&e.push(new MagicPlant(t,n)),s.minigame&&e.push(new MiniGame(t,n))},Unit=function(e){this.code=e.code,this.stage=e.stage,this.checkTouchInside=function(){},this.onClickEvent=function(){},this.onDragStart=function(){},this.onDragMove=function(){},this.onDragEnd=function(){},this.onAdd=function(){},this.onRemove=function(){},this.onDestruction=function(){},this.onMove=function(){},this.onMerge=function(){},this.onStartAnimateMerge=function(){},this.onStopAnimateMerge=function(){},this.onSqueeze=function(){},this.onSpawned=function(){},this.onFogOpen=function(){},this.onDidMerged=function(){},this.onMarkError=function(){},this.onMarkNormal=function(){},this.onInfoOpened=function(){},this.onInfoClosed=function(){},this.onChangePrizes=function(){},this.onPrizeHarvested=function(){},this.onGetView=function(){},this.onShowPoints=function(){},this.onHidePoints=function(){},this.onClaimPoints=function(){},this.load(e),this.components=[]
,ComponentsFactory(this.components,this,e)};Unit.prototype.getResource=function(){return Families[this.code].resource},Unit.prototype.getType=function(){return Families[this.code].type},Unit.prototype.onTouchBeginEvent=function(){if(this.claimPoints())return!0;for(var e=0;e<this.components.length;e++){var t=this.components[e];if(t.handleTouchBegin&&t.handleTouchBegin())return!0}return!1},Unit.prototype.getData=function(){return Families[this.code].units[this.stage]},Unit.prototype.saveRemoval=function(){cleverapps.config.adminMode||cleverapps.unitSaver.remove(this.x,this.y)},Unit.prototype.load=function(e){e.points&&cleverapps.missionManager.findByType(Mission.TYPE_BATTLEPASS)&&(this.points=e.points)},Unit.prototype.save=function(){if(!(cleverapps.config.adminMode||cleverapps.config.editorMode||cleverapps.config.wysiwygMode)&&Game.currentGame.initialized&&this.isPersistent()&&"decorator"!==this.code&&void 0!==this.x&&void 0!==this.y){var t={stage:this.stage,code:this.code}
;this.points&&cleverapps.missionManager.findByType(Mission.TYPE_BATTLEPASS)&&(t.points=this.points),this.components.forEach(function(e){e.save&&e.save(t)}),cleverapps.unitSaver.update(this.x,this.y,t)}},Unit.prototype.clear=function(){this.components.forEach(function(e){e.clear&&e.clear()}),this.light&&this.light.clear()},Unit.prototype.isPersistent=function(){return"multiCellBody"!==this.code&&"specialoffer"!==this.code&&this.code&&void 0!==this.stage},Unit.prototype.getKey=function(){return Unit.GetKey(this)},Unit.GetKey=function(e){return e.code+"_"+e.stage},Unit.GetPositionKey=function(e){return e.x+"_"+e.y},Unit.ParseKey=function(e){if(2===(e=e.split("_")).length)return{code:e[0],stage:cleverapps.castType(e[1])}},Unit.findUnit=function(e,t){t=t||{};for(var n=0;n<e.length;++n){var s=e[n];if(!(void 0!==t.code&&s.code!==t.code||void 0!==t.stage&&s.stage!==t.stage))return s}},Unit.prototype.findComponent=function(e){for(var t=0;t<this.components.length;t++)if(
this.components[t]instanceof e)return this.components[t]},Unit.prototype.setPrizes=function(e,t){var n=this.prizes&&!this.prizes.minigame&&0<this.prizes.length&&0<e.length;this.prizes=e,this.prizesExp=t,this.onChangePrizes(n)},Unit.prototype.getFogState=function(){var e=Game.currentGame.map.getFog(this.x,this.y);if(e)return e.fogBlock.state},Unit.prototype.isGrounded=function(){return void 0!==this.findComponent(Grounded)},Unit.prototype.isMultiCell=function(){return void 0!==this.findComponent(MultiCell)},Unit.prototype.isUpgradable=function(){return void 0!==this.findComponent(Upgradable)},Unit.prototype.isMultiCellBody=function(){return"multiCellBody"===this.code},Unit.prototype.getInfo=function(){for(var e,t=0;t<this.components.length;t++){var n=this.components[t];if(e=n.getInfo&&n.getInfo())break}return!cleverapps.metha.isFocused()&&this.getData().removable&&(e?(e.actions=e.actions||{},e.actions.remove={unit:this}):e={title:Game.currentGame.unitsLibrary.getUnitName(this),actions:{
remove:{unit:this}}}),e},Unit.prototype.isMoveable=function(){if(this.getData().important||!1===this.movable)return!1;for(var e=[Grounded,MultiCell,Dish,SpecialOffer],t=0;t<e.length;t++)if(void 0!==this.findComponent(e[t]))return!1;if(void 0!==this.findComponent(Collectible)&&this.getData().unmergeable&&Buildable.IsBuilt(this)){if("resource"!==this.getType())return!1;if(0<Game.currentGame.map.listAvailableUnits().filter(function(e){return e.code===this.code&&e.isUpgradable()}.bind(this)).length)return!1}return!this.isMultiCellBody()},Unit.prototype.handleClick=function(){cleverapps.config.debugMode&&console.log("unit",this);var e=Game.currentGame,t=e.workers.findAssigned(this);if(void 0!==t)return 0<SpeedUpWindow.CalcPrice(t.getTimeLeft())&&!t.speedupInProgress&&cleverapps.metha.display({focus:"SpeedUp",control:"MenuBarGoldItem",action:function(e){new SpeedUpWindow(t),cleverapps.metha.onceNoWindowsListener=e}}),!0;if(this.prizes){if(this.onSqueeze(),this.prizes.minigame
)return this.prizes=void 0,this.onChangePrizes(),this.onPrizeHarvested(),cleverapps.metha.display({focus:"MinesweeperScene",actions:[function(e){setTimeout(e,300)},function(e){Game.currentGame.stop(),Game.currentGame=void 0,Game.currentMiniGame={x:this.x,y:this.y},cleverapps.scenes.replaceScene(new MineGameScene,e)}.bind(this)]}),!0;var n=e.spawn(this.prizes,this,{radius:Map2d.RADIUS_SMALL});if(0<n.length)this.setPrizes(n);else{var s=this.prizes.length,i=this.prizes;this.prizes=void 0,this.prizesExp&&(e.gameLevel.addExp(this.prizesExp,this,{delay:100*s+500}),this.prizesExp=void 0),this.onChangePrizes(),this.onPrizeHarvested(),e.gameEvent(Merge.PRIZE_HARVESTED,{affected:this,prizes:i})}return!0}for(var o=0;o<this.components.length;o++){var r=this.components[o];if(r.handleClick&&r.handleClick())return!0}return!1},Unit.prototype.distanceTo=function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)},Unit.prototype.isMergeable=function(e,t){return!this.getData().unmergeable&&!e.getData(
).unmergeable&&(!!Buildable.IsBuilt(this)&&(!!Buildable.IsBuilt(e)&&(!e.isLast()&&(!(!t||"crystal"!==this.code||!this.isLast()||e.code===this.code)||e.code===this.code&&e.stage===this.stage))))},Unit.prototype.setPosition=function(e,t){if(this.x!==e||this.y!==t){void 0!==this.x&&void 0!==this.y&&this.saveRemoval(),this.x=e,this.y=t;var n=this.findComponent(MultiCell);n&&!cleverapps.config.editorMode&&n.occupite(),this.save()}},Unit.prototype.remove=function(e){this.unhighlight();var t=Game.currentGame.map,n=t.getUnit(this.x,this.y);n&&n!==this||(t.remove(Map2d.LAYER_UNITS,this.x,this.y),this.saveRemoval());var s=this.findComponent(MultiCell);s&&s.remove(),e||this.onRemove()},Unit.prototype.seedRandom=function(e){e=e||0,void 0===this.x&&void 0===this.y?Game.currentGame.currentLoadingUnitPosition&&(e+=1e3*Game.currentGame.currentLoadingUnitPosition.x+Game.currentGame.currentLoadingUnitPosition.y):e+=1e3*this.x+this.y,cleverapps.Random.seed(e)},Unit.prototype.highlight=function(e){
this.unhighlight(),this.light=new Highlight(this.x,this.y),e&&e.drag?(Game.currentGame.map.onAnimationsAdd(this.light),this.light.move(this.x,this.y,!0)):Game.currentGame.map.onAdd(Map2d.LAYER_UNITS,this.light.x,this.light.y,this.light),e&&e.duration&&this.light.schedule(this.unhighlight.bind(this),e.duration)},Unit.prototype.unhighlight=function(){this.light&&(this.light.remove(),delete this.light)},Unit.prototype.unhighlightMerge=function(){this.clusters&&(this.onStopAnimateMerge(this),Game.currentGame.onFinishMergeHint(),this.clusters.forEach(function(e){e.forEach(function(e){var t=Game.currentGame.map.getUnit(e.x,e.y);t.unhighlight(),t.onStopAnimateMerge(this)})}),this.clusters=void 0)},Unit.prototype.highlightMerge=function(e){(this.clusters=e).length&&(cleverapps.config.wysiwygMode&&cleverapps.flags.wysiwyg.automerge||this.onStartAnimateMerge(this),Game.currentGame.onStartMergeHint(e.reduce(function(e,t){return e+t.length},1),this),e.forEach(function(e){var n=e[0];e.forEach(
function(e){var t=Game.currentGame.map.getUnit(e.x,e.y);t.highlight(),cleverapps.config.wysiwygMode&&(cleverapps.flags.wysiwyg.mergeAnimation2||cleverapps.flags.wysiwyg.automerge)||0!==t.distanceTo(n)||t.light.up(),cleverapps.config.wysiwygMode&&cleverapps.flags.wysiwyg.automerge||t.onStartAnimateMerge(n)})}))},Unit.prototype.didMerged=function(){Buildable.IsBuilt(this)&&this.onCreatePrize(),this.onDidMerged()},Unit.prototype.handleDragStart=function(){if(!this.isMoveable())return!1;Game.currentGame.map.setDragging(this),this.highlight({drag:!0});var e=this.findComponent(InstantWorker);e&&e.handleDragStart();var t=this.findComponent(MultiCell);if(t)for(var n=0;n<t.shape.length;n++)Game.currentGame.map.layers[Map2d.LAYER_UNITS][this.y+t.shape[n].y][this.x+t.shape[n].x]=void 0;else Game.currentGame.map.layers[Map2d.LAYER_UNITS][this.y][this.x]=void 0;return this.lastX=this.x,this.lastY=this.y,!0},Unit.prototype.listMergeAtPoint=function(e,t){var n=Game.currentGame.map;if(n.isGround(e,t
)&&!n.getFog(e,t)&&n.getUnit(e,t)&&this.isMergeable(n.getUnit(e,t),!0)){var s=n.bfs(e,t,n.getUnit(e,t));if(2<=s.length)return s}},Unit.prototype.listMergeClusters=function(e,t){var n=Game.currentGame.map,s=n.listUnitsFromPointByCircle(e,t).filter(this.equals.bind(this)),i={},o=[];return s.forEach(function(e){if(!i[e.x+1e4*e.y]){var t=n.bfs(e.x,e.y,e);t.forEach(function(e){i[e.x+1e4*e.y]=!0}),1<t.length&&o.push(t)}}),o},Unit.prototype.handleDragMove=function(e,t){if(this.lastX!==e||this.lastY!==t||!this.clusters&&cleverapps.config.wysiwygMode&&cleverapps.flags.wysiwyg.mergeAnimation2){this.lastX=e,this.lastY=t;var n=this.findComponent(InstantWorker);if(n&&n.handleDragMove(e,t),cleverapps.config.wysiwygMode&&cleverapps.flags.wysiwyg.automerge)AutomergeHelper.handleDragMove(e,t,this);else if(cleverapps.config.wysiwygMode&&cleverapps.flags.wysiwyg.mergeAnimation2){if(!this.clusters){var s=this.listMergeClusters(this.x,this.y);this.unhighlightMerge(),this.light.show(),this.light.hide(),
this.highlightMerge(s)}}else{this.unhighlightMerge(),this.light.show();var i=this.listMergeAtPoint(e,t);i&&(this.light.hide(),this.highlightMerge([i]))}this.light.move(e,t),this.light.error?this.onMarkError():this.onMarkNormal()}},Unit.prototype.handleDragEnd=function(){var e=this.light.error;this.unhighlightMerge(),this.unhighlight(),Game.currentGame.map.setDragging(void 0),Game.currentGame.onFinishMergeHint();var t=this.findComponent(InstantWorker);if(!t||!t.handleDragEnd(this.lastX,this.lastY))if(e)this.move(this.x,this.y);else{var n=this.listMergeAtPoint(this.lastX,this.lastY);if(n){var s=Game.currentGame.map.getUnit(this.lastX,this.lastY);Game.currentGame.merge(n,this,s)}else this.move(this.lastX,this.lastY),cleverapps.config.wysiwygMode&&cleverapps.flags.wysiwyg.automerge&&AutomergeHelper.handleDragEnd(this)}},Unit.prototype.onCreatePrize=function(){if(this.getData().createPrize){var e=0;this.getData().createPrize.coins&&(Game.currentGame.addCoins(this.getData().createPrize.coins
,this,{delay:e,jumpSide:"left"}),e+=1e3),this.getData().createPrize.exp&&Game.currentGame.gameLevel.addExp(this.getData().createPrize.exp,this,{delay:e,jumpSide:"right"})}},Unit.prototype.move=function(n,s){var i=Game.currentGame.map,e=i.getUnit(n,s);if(e!==this){var t,o=this.findComponent(MultiCell),r=[];if(o)for(t=0;t<o.shape.length;t++)(e=i.getUnit(n+o.shape[t].x,s+o.shape[t].y))&&e!==this&&e.head!==this&&r.push(e);else e&&r.push(e);if(void 0!==this.x&&void 0!==this.y&&i.getUnit(this.x,this.y)===this)if(o)for(t=0;t<o.shape.length;t++)i.layers[Map2d.LAYER_UNITS][this.y+o.shape[t].y][this.x+o.shape[t].x]=void 0;else i.layers[Map2d.LAYER_UNITS][this.y][this.x]=void 0;if(r.length){var a=[];r.forEach(function(e){a.push({x:e.x,y:e.y})}),r.forEach(function(e){if(e.isMultiCell())e.remove();else if(e.isMultiCellBody())e.head.remove();else{var t=i.findEmptySlot(n,s,void 0,void 0,a);t?e.move(t.x,t.y):e.remove()}})}void 0!==this.x&&void 0!==this.y&&i.getUnit(this.x,this.y)&&i.getUnit(this.x,
this.y)!==this&&(delete this.x,delete this.y),(i.layers[Map2d.LAYER_UNITS][s][n]=this).setPosition(n,s),this.onMove(),Game.currentGame.workers.findAssigned(this)&&Game.currentGame.storeSave()}},Unit.prototype.getFamily=function(){return Families[this.code]},Unit.prototype.isLast=function(){return this.getFamily().units.length-1===this.stage},Unit.getPreviousStagesTargets=function(n,e){return cleverapps.arrayFill(e).map(function(e,t){return{code:n,stage:t}})},Unit.getAllStagesTargets=function(e){return Unit.getPreviousStagesTargets(e,Families[e].units.length)},Unit.prototype.equals=function(e){return Unit.Equals(this,e)},Unit.Equals=function(e,t){return e&&t&&void 0!==e.code&&void 0!==e.stage&&e.code===t.code&&e.stage===t.stage},Unit.prototype.setPoints=function(e){this.points=e,this.onShowPoints()},Unit.prototype.claimPoints=function(){if(this.points)return cleverapps.missionManager.findByType(Mission.TYPE_BATTLEPASS)?(cleverapps.missionManager.dispatchEvent(Mission.EVENT_UNIT_BUILT,{
amount:this.points}),this.onClaimPoints(this.points)):this.onHidePoints(),delete this.points,this.save(),!0};var GameLevel=function(e){this.calcThreshold(),this.calcMaxEnergy(),this.onChangeValue=function(){},this.onChangeExp=function(){},this.onLevelUp=function(){},this.onChangeGameLevel=function(){}};GameLevel.prototype.calcThreshold=function(){GameLevel.THRESHOLD=[20,100,200,500,1e3,2200,3500];for(var e=GameLevel.THRESHOLD.length;e<100;e++)GameLevel.THRESHOLD.push(GameLevel.THRESHOLD[e-1]+1500)},GameLevel.prototype.getLevel=function(){return cleverapps.user.level+1},GameLevel.prototype.getNextLevel=function(){return cleverapps.user.level+2},GameLevel.prototype.nextLevelThreshold=function(){if(cleverapps.user.level<=GameLevel.THRESHOLD.length-1)return GameLevel.THRESHOLD[cleverapps.user.level];var e=cleverapps.user.level-(GameLevel.THRESHOLD.length-1);return(GameLevel.THRESHOLD[GameLevel.THRESHOLD.length-1]-GameLevel.THRESHOLD[GameLevel.THRESHOLD.length-2])*e},
GameLevel.prototype.checkLevelUp=function(){cleverapps.user.exp>=this.nextLevelThreshold()&&this.onLevelUp()},GameLevel.prototype.moveToNextLevel=function(){cleverapps.user.exp-=this.nextLevelThreshold(),cleverapps.user.level++,this.calcMaxEnergy(),Game.currentGame.fogs.onChangeGameLevel(),this.onChangeValue(),this.onChangeExp(),Game.currentGame.energyLottery.onChangeGameLevel(),Game.currentGame.barrelPlanner.onChangeGameLevel(),cleverapps.user.save(),cleverapps.sideBar.refreshAllIcons();var e=Game.currentGame.level.hash;if(cleverapps.eventLogger.logEvent(cleverapps.EVENTS.LEVEL_FINISH,{hash:e}),cleverapps.eventLogger.logEvent(cleverapps.EVENTS.UNIQUE_FINISH,{hash:e}),void 0!==cleverapps.abTest.group&&cleverapps.eventLogger.logEvent("abtest_"+cleverapps.abTest.group+"_"+cleverapps.EVENTS.LEVEL_FINISH),"merge"===cleverapps.config.type){var t=cleverapps.user.getDaysSinceRegistration();6===cleverapps.user.level&&t<=2?cleverapps.eventLogger.logEvent("gamelevel_conversion_d2"
):7===cleverapps.user.level&&t<=7&&cleverapps.eventLogger.logEvent("gamelevel_conversion_d7"),3===levels.user.level&&cleverapps.eventLogger.logEvent(cleverapps.EVENTS.TUTORIAL_COMPLETED),6<=levels.user.level&&cleverapps.eventLogger.logEvent(cleverapps.EVENTS.ACHIEVED_LEVEL)}cleverapps.environment.levelNo=levels.user.level},GameLevel.prototype.setExp=function(e){cleverapps.user.exp=e,this.onChangeExp(),cleverapps.user.save()},GameLevel.prototype.addExp=function(e,t,n){cleverapps.user.exp+=e,cleverapps.user.save(),Game.currentGame.addItemsAnimation("exp",e,t,n,function(){this.onChangeExp(),this.checkLevelUp()}.bind(this))},GameLevel.prototype.calcMaxEnergy=function(){cleverapps.lives.setMaxAmount(75+2*cleverapps.user.level),0===cleverapps.user.level&&cleverapps.lives.setAmount(cleverapps.Lives.MAX_REGEN_AMOUNT)},GameLevel.prototype.levelUpPrize=function(){var e,t,n;switch(cleverapps.user.level+1){case 1:e=150,t=5;break;case 2:case 3:case 4:case 5:e=50,t=10,n=30;break;case 6:case 7:
case 8:e=100,t=5,n=50;break;default:e=150,t=5,n=100}return{coins:e,rubies:t,energy:n}};var Harvested=function(e){this.items=e,this.onChangeItems=function(){}};Harvested.prototype.save=function(){return this.items},Harvested.prototype.get=function(e){return this.items[e]||0},Harvested.prototype.add=function(e,t){this.items[e]=(this.items[e]||0)+t,Game.currentGame.storeSave(),this.onChangeItems()},Harvested.prototype.addList=function(e){for(var t in e)this.items[t]=(this.items[t]||0)+e[t];Game.currentGame.storeSave(),this.onChangeItems()},Harvested.prototype.canTake=function(e,t){return this.items[e]&&this.items[e]>=t},Harvested.prototype.isAvailableList=function(e){var t=Game.currentGame.unitsLibrary.listAvailableByType("fruit");for(var n in e)if(t.indexOf(n)<0)return!1;return!0},Harvested.prototype.canTakeList=function(e){for(var t in e)if(!this.canTake(t,e[t]))return!1;return!0},Harvested.prototype.take=function(e,t){return!!this.canTake(e,t)&&(this.items[e]-=t,
Game.currentGame.storeSave(),this.onChangeItems(),!0)},Harvested.prototype.takeList=function(e){if(this.canTakeList(e)){for(var t in e)this.items[t]-=e[t];return Game.currentGame.storeSave(),this.onChangeItems(),!0}return!1},Harvested.prototype.calcMissingIngredients=function(e){var t={};for(var n in e.ingredients){var s=Math.max(0,e.ingredients[n]-this.get(n));s&&(t[n]=s)}return t};var UnitSaver=function(){this.prefix=cleverapps.config.prefix+cleverapps.social.getLocalStoragePreffix()+"_map",this.loadMap()};UnitSaver.prototype.update=function(e,t,n,s){cleverapps.DataLoader.save(this.getStoreKey(e,t),n),!0!==s&&cleverapps.unitSyncer.save(e,t,n)},UnitSaver.prototype.getStoreKey=function(e,t){return this.prefix+e+"_"+t},UnitSaver.prototype.parseStoreKey=function(e){var t=e.replace(this.prefix,"").split("_");return{x:parseInt(t[0]),y:parseInt(t[1])}},UnitSaver.prototype.remove=function(e,t){cleverapps.DataLoader.remove(this.getStoreKey(e,t)),cleverapps.unitSyncer.remove(e,t)},
UnitSaver.prototype.load=function(e,t){return cleverapps.DataLoader.load(this.getStoreKey(e,t))},UnitSaver.prototype.loadMap=function(){var s=[];return this.listUnitsKeys().forEach(function(e){var t=cleverapps.DataLoader.load(e);if(t){var n=this.parseStoreKey(e);n.data=t,s.push(n)}},this),cleverapps.unitSyncer.loadMap(s),s},UnitSaver.prototype.listUnitsKeys=function(){return Object.keys(cleverapps.DataLoader.data).filter(function(e){return 0===e.indexOf(this.prefix)},this)},UnitSaver.prototype.updateInfo=function(e){this.listUnitsKeys().forEach(function(e){cleverapps.DataLoader.load(e)&&(cleverapps.DataLoader.remove(e),0)});var t=[];e.forEach(function(e){e.kickout?t.push(e):(this.update(e.x,e.y,e.data,!0),0)},this),this.saveKickOuts(t)},UnitSaver.prototype.loadKickOuts=function(){return cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.UNIT_SAVER_KICKOUTS)||[]},UnitSaver.prototype.saveKickOuts=function(e){cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.UNIT_SAVER_KICKOUTS,e)}
;var Merge=function(e,t){var n=e&&e.episodeNo||0,s=e&&e.levelNo||0;(e=new Episode(n,s).getLevel(s)).load(),GameBase.call(this,e,t),this.onShowUp=function(){},this.onChangeCoinsListener=function(){},this.onChangeWandsListener=function(){},this.onSubstractEnergy=function(){},this.onAddItemsAnimation=function(){},this.getScrollZoom=function(){},this.onHintMessage=function(){},this.onStartMergeHint=function(){},this.onFinishMergeHint=function(){};var i=this.loadSave();console.log("Stored",i),this.map=new Map2d(e.content.map,{visibleBox:e.content.visibleBox,regions:e.content.regions,decorators:e.content.decorators});var o=cleverapps.unitSaver.loadMap(),r=this.isRegularGame=e.episode.type===Episode.Types.REGULAR&&!isNaN(e.episode.episodeNo);if(r){var a=[];0===o.filter(function(e){var t=Families[e.data.code],n=t&&t.units[e.data.stage];return n&&n.makesorder}).length&&cleverapps.user.level<2&&(i=this.getInitialInfo(),a=o),a.forEach(function(e){cleverapps.unitSaver.remove(e.x,e.y)}),
o=cleverapps.substract(o,a,Unit.GetPositionKey)}i.gameLevel&&(cleverapps.user.level=i.gameLevel.value,cleverapps.user.exp=i.gameLevel.exp,cleverapps.user.save()),this.coins=i.coins,this.wands=i.wands,this.wands<0&&(this.wands=0),this.scrollCell=i.scrollCell,this.zoom=cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.ZOOM),this.gameLevel=new GameLevel,this.workers=new Workers,this.orders=new Orders,this.harvested=new Harvested(i.harvested),this.harvested.onChangeItems=this.orders.updateIngredients.bind(this.orders),this.unitsLibrary=new UnitsLibrary(i.unitsLibrary),this.quests=new Quests(i.quests),this.energyLottery=new EnergyLottery(i.energyLottery),this.energyProducts=new EnergyProducts(i.energyProducts),r?(o.forEach(function(e){this.loadUnit(e)},this),this.workers.load(i.workers)):(MergeEditor.InsertDefaults(this.map,e.content.field),this.workers.regular=[new Worker,new Worker]),this.pixelsPlanner=new PixelsPlanner(i.pixels),this.barrelPlanner=new BarrelPlanner(i.barrel),
this.unitsShop=new UnitsShop(i.unitsShop),this.fogs=new Fogs(i.fogs||[]),this.fogs.calcFogStates(),this.advice=new MergeAdvice,this.tutorial=new MergeTutorial,this.pushes=new MergePushes,cleverapps.config.adminMode||cleverapps.config.wysiwygMode||(this.counter.registerStage(0,this.initStage.bind(this)),this.counter.registerStage(5,this.education.bind(this)),this.counter.registerStage(10,this.quests.finish.bind(this.quests)),this.counter.registerStage(20,this.gameLevel.checkLevelUp.bind(this.gameLevel)),this.counter.registerStage(30,this.tutorial.processFresh.bind(this.tutorial)),this.counter.registerStage(40,this.quests.processFresh.bind(this.quests)),this.counter.registerStage(50,this.advice.stopIdleHint.bind(this.advice)),this.counter.registerStage(60,cleverapps.postpone(cleverapps.parseInterval("30 seconds"),this.startIdleHint.bind(this))),this.counter.registerStage(70,cleverapps.throttle(cleverapps.parseInterval("1 minute"),this.runEmptyCounter.bind(this))),this.initialized=!0,
this.updateAvailableUnits())},Game=Merge;Merge.prototype=Object.create(GameBase.prototype),(Merge.constructor=Merge).prototype.runEmptyCounter=function(){this.stopped||cleverapps.placements.runWhenFreeFocus(Placements.EMPTY_COUNTER)},Merge.prototype.startIdleHint=function(){this.stopped||this.tutorial.isActive()||this.advice.startIdleHint()},Merge.prototype.listUnitsByType=function(t){return this.map.listAvailableUnits().filter(function(e){return void 0!==e.findComponent(t)})},Merge.prototype.loadUnit=function(e){this.currentLoadingUnitPosition={x:e.x,y:e.y};var t=new Unit(e.data);t.setPosition(e.x,e.y),this.map.add(Map2d.LAYER_UNITS,e.x,e.y,t),this.map.onAdd(Map2d.LAYER_UNITS,e.x,e.y,t)},Merge.prototype.initStage=function(){this.initStageRunned||(this.initStageRunned=!0,this.initWorkers(),this.restoreStaticUnits(),this.restoreImportantUnits(),this.restoreMultiCells(),this.restoreKickOuts())},Merge.prototype.restoreImportantUnits=function(){var e=[],i=[];for(
var t in this.fogs.fakeUnits)for(var n in this.fogs.fakeUnits[t]){var o=parseInt(t),r=parseInt(n);this.fogs.fakeUnits[o][r].important&&!this.map.getFog(o,r)&&e.push({x:o,y:r,fakeUnit:this.fogs.fakeUnits[o][r]})}for(r=0;r<this.map.getHeight();r++)for(o=0;o<this.map.getWidth();o++){var s=this.map.getUnit(o,r);s&&s.getData().important&&i.push(s)}e.forEach(function(e){var n=e.fakeUnit;o=e.x,r=e.y;var t,s=void 0;(i.forEach(function(e,t){e.code===n.code&&e.getType()===n.type&&(void 0===s||i[s].stage<e.stage)&&(s=t)}),void 0===s)?((t=new Unit(n)).move(o,r),Game.currentGame.map.onAdd(Map2d.LAYER_UNITS,o,r,t)):((t=i[s]).move(o,r),i.splice(s,1))}),0<i.length&&i.forEach(function(e){e.remove()})},Merge.prototype.restoreMultiCells=function(){this.map.listAvailableUnits().forEach(function(e){var t=e.findComponent(MultiCell);t&&t.restore()})},Merge.prototype.restoreKickOuts=function(){cleverapps.unitSaver.loadKickOuts().forEach(function(e){var t=this.map.findEmptySlot(e.x,e.y),n="fail";if(t){e.x=t.x,
e.y=t.y,this.loadUnit(e);var s=this.map.getUnit(e.x,e.y);n=s.code,(s.getData().makesorder||s.getData().important)&&(n+="_"+s.stage)}cleverapps.eventLogger.logEvent("restore_kickout_"+n)},this),cleverapps.unitSaver.saveKickOuts([])},Merge.prototype.restoreStaticUnits=function(){var e=this.fogs.fakeUnits;for(var t in e)for(var n in e[t]){var s=parseInt(t),i=parseInt(n),o=e[s][i];if("decorator"===o.code&&!this.map.getFog(s,i)){var r=new Unit(o);r.move(s,i),this.map.onAdd(Map2d.LAYER_UNITS,s,i,r)}}},Merge.prototype.workersBusyHint=function(){if(this.workers.isBonusWorkerBuyed()||this.lastWorkersWindowShowed&&!(this.lastWorkersWindowShowed<Date.now()-cleverapps.parseInterval(Merge.WORKERS_WINDOW_INTERVAL))){this.onHintMessage(Messages.get("Workers.busy"));var e=this.workers.findLeastBusy();e&&(this.map.onCenterTo(e.unit.x,e.unit.y),this.map.onAddTarget(e.unit.x,e.unit.y))}else cleverapps.metha.display({focus:"BonusWorkerWindow",control:["MenuBarGoldItem","MenuBarWorkersItem"],
action:function(e){this.lastWorkersWindowShowed=Date.now(),new BonusWorkerWindow,cleverapps.metha.onceNoWindowsListener=e}.bind(this)})},Merge.prototype.initWorkers=function(){this.workers.regular.forEach(function(e){e.run()}),this.workers.runBonusWorker()},Merge.prototype.education=function(){this.fogs.blocks.fog1&&!cleverapps.config.wysiwygMode&&cleverapps.metha.display({focus:"Education",actions:[function(e){this.fogs.blocks.fog0&&this.fogs.blocks.fog0.open(),setTimeout(e,500)}.bind(this),function(e){this.unitsLibrary.isHeroAvailable("dwarf")?e():this.tutorial.showTutorial(MergeTutorials.dwarf,e)}.bind(this),function(e){this.fogs.blocks.fog1.open(),setTimeout(e,500)}.bind(this)]})},Merge.prototype.storeSave=function(){this.initialized&&(this.saveZoom&&cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.ZOOM,this.getScrollZoom()),GameBase.prototype.storeSave.call(this))},Merge.prototype.getInfo=function(){return{workers:this.workers.save(),harvested:this.harvested.save(),
unitsLibrary:this.unitsLibrary.save(),fogs:this.fogs.save(),pixels:this.pixelsPlanner.save(),barrel:this.barrelPlanner.save(),quests:this.quests.save(),energyLottery:this.energyLottery.save(),energyProducts:this.energyProducts.save(),scrollCell:this.map.getScreenCenterCell()||this.scrollCell,unitsShop:this.unitsShop.save(),coins:this.coins,wands:this.wands}},Merge.prototype.getInitialInfo=function(){return{harvested:{},coins:100,wands:0,fogs:[]}},Merge.prototype.stop=function(){GameBase.prototype.stop.call(this),this.tutorial.clear(),this.advice.clear(),this.pixelsPlanner.clear(),this.barrelPlanner.clear(),this.workers.clear(),this.unitsShop.clear(),this.energyLottery.clear(),this.map.stop(),InfoView.Clear(),this.level.unload()},Merge.prototype.useEnergy=function(e,t){return cleverapps.lives.amount<e?(cleverapps.metha.display({focus:"buy_energy",control:["MenuBarGoldItem","MenuBarGameLevelItem","MenuBarLivesItem","MenuBarCoinsItem"],action:function(e){new LivesShopWindow,
cleverapps.metha.onceNoWindowsListener=e}}),!1):(cleverapps.eventLogger.logEvent("use_energy",{amount:e}),cleverapps.lives.setAmount(cleverapps.lives.amount-e),this.onSubstractEnergy(e,t),!0)},Merge.prototype.addItemsAnimation=function(e,t,n,s,i){(s=s||{}).delay?this.counter.setTimeoutUnblocked(function(){s.delay=void 0,this.addItemsAnimation(e,t,n,s,i)}.bind(this),s.delay):n?this.onAddItemsAnimation(e,t,n,s,i):i()},Merge.prototype.setCoins=function(e){this.coins=e,this.onChangeCoinsListener(this.coins),Game.currentGame.storeSave()},Merge.prototype.canTakeCoins=function(e){return this.coins>=e},Merge.prototype.takeCoins=function(e){return this.canTakeCoins(e)?(this.setCoins(this.coins-e),cleverapps.audio.playSound(bundles.main.urls.shop_buy_effect),!0):(cleverapps.metha.isFocused()?(cleverapps.metha.showControlsWhileFocused(["MenuBarGoldItem","MenuBarCoinsItem"]),new SoftCurrencyShopWindow):cleverapps.metha.display({focus:"ShopWindow",control:["MenuBarGoldItem","MenuBarCoinsItem"],
action:function(e){new SoftCurrencyShopWindow,cleverapps.metha.onceNoWindowsListener=e}}),!1)},Merge.prototype.setWands=function(e){this.wands=e,this.fogs.onChangeWandsAmount(),this.onChangeWandsListener(this.wands),Game.currentGame.storeSave()},Merge.prototype.takeWands=function(e){this.setWands(this.wands-e),Game.currentGame.storeSave()},Merge.prototype.addReward=function(e,t,n,s){switch(e){case"exp":return void this.gameLevel.addExp(t,n,s);case"coins":return void this.addCoins(t,n,s);case"rubies":case"gold":return void this.addRubies(t,n,s);case"energy":return void this.addEnergy(t,n,s);case"wands":return void this.addWands(t,n,s);case"worker":return void this.addWorker(t,n,s)}},Merge.prototype.addCoins=function(e,t,n){this.coins=this.coins+e,Game.currentGame.storeSave(),this.addItemsAnimation("coins",e,t,n,function(){this.onChangeCoinsListener(this.coins)}.bind(this))},Merge.prototype.addRubies=function(e,t,n){cleverapps.user.setGold(cleverapps.user.gold+e,!0),
this.addItemsAnimation("rubies",e,t,n,function(){cleverapps.user.onChangeGold()}.bind(this))},Merge.prototype.addEnergy=function(e,t,n){cleverapps.lives.give(e,!0),this.addItemsAnimation("energy",e,t,n,function(){cleverapps.lives.runListeners(),cleverapps.lives.processRegenerateState()}.bind(this))},Merge.prototype.addWands=function(e,t,n){this.wands=this.wands+e,Game.currentGame.storeSave(),this.addItemsAnimation("wands",e,t,n,function(){this.fogs.onChangeWandsAmount(),this.onChangeWandsListener(this.wands)}.bind(this))},Merge.prototype.addWorker=function(e,t,n){this.workers.addBonusWorkerPeriod(e.interval,!0),this.addItemsAnimation("worker",1,t,n,function(){this.workers.onChangeTotalAmount()}.bind(this))},Merge.prototype.harvest=function(e){if("resource"!==e.getType())switch(e.code){case"rubies":this.addRubies(e.getData().value);break;case"coins":this.addCoins(e.getData().value);break;case"wands":this.addWands(e.getData().value);break;default:this.harvested.add(e.code,e.getData(
).value)}this.counter.setTimeout(function(){this.gameEvent(Merge.HARVEST,{affected:e})}.bind(this),0)},Merge.prototype.addUnits=function(e,n){n=n||{};var s=this.map.getScreenCenterCell()||this.map.getMapCenterCell();cleverapps.toArray(e).forEach(function(e){var t=this.map.findEmptySlot(s.x,s.y);e.setPosition(t.x,t.y),this.map.add(Map2d.LAYER_UNITS,t.x,t.y,e),this.onUnitAvailable(e),this.counter.setTimeout(function(){this.map.onAdd(Map2d.LAYER_UNITS,t.x,t.y,e),e.onAdd()}.bind(this),1e3*(n.delay||0))},this)},Merge.prototype.spawn=function(e,s,i){this.advice.boo();var o=[];if(0===e.length||cleverapps.config.editorMode)return o;var t=e.filter(function(e){var t=i.fromNode?this.map.getView().getCellByCoordinates(s):s,n=this.map.findEmptySlot(t.x,t.y,e,i);return n?(e.setPosition(n.x,n.y),this.map.add(Map2d.LAYER_UNITS,n.x,n.y,e),this.onUnitAvailable(e),!0):(o.push(e),!1)},this);return this.spawnAction(t,s,i),o},Merge.prototype.spawnAction=function(e,n,s){e.length?cleverapps.audio.playSound(
s.sound||bundles.merge.urls.spawn_start_effect):(cleverapps.audio.playSound(bundles.merge.urls.spawn_fail_effect),Game.currentGame.onHintMessage("messages:Spawn.nospace")),this.counter.setTimeout(function(){e.forEach(function(e,t){this.map.onAdd(Map2d.LAYER_UNITS,e.x,e.y,e),e.onSpawned(n,t,s)},this)}.bind(this),100),this.counter.setTimeout(function(){e.forEach(function(e){this.gameEvent(Merge.SPAWN,{unit:e,affected:s.fromNode?void 0:n})},this)}.bind(this),700)},Merge.prototype.mergeBonus=function(e,t){var n=0,s=5;if(3<=t&&"hero"===Families[e.code].type&&e.stage===Families[e.code].units.length-2)n=1,t-=3;else for(;3<=t;){for(var i=3,o=1;2*i-1<=t;)o*=2,i=2*i-1;5===s&&(s=2*i-1),t-=i,n+=o}return{bonus:n,keepLast:t,next:s}},Merge.prototype.playMergeSound=function(){cleverapps.audio.playSound(bundles.merge.urls.merge_effect)},Merge.prototype.gameEvent=function(e,t){this.trigger("gameEvent",e,t)},Merge.prototype.merge=function(n,e,t,s){var i,o=[e];cleverapps.config.wysiwygMode&&s?(
i=this.mergeBonus(t,n.length),o=[],n.forEach(function(e){var t=this.map.getUnit(e.x,e.y);t.claimPoints(),t.onMerge(s.centerUnitPos),t.remove(!0),o.push(t)},this)):(i=this.mergeBonus(t,n.length+1),n.forEach(function(e){var t=this.map.getUnit(e.x,e.y);t.claimPoints(),t.onMerge(n[0]),t.remove(!0),o.push(t)},this),e.remove());for(var r=[],a=!(cleverapps.config.wysiwygMode&&cleverapps.flags.wysiwyg.skipBuildingStage),c=0;c<i.bonus+i.keepLast;c++){var l=n[c],p=void 0;(p=c<i.bonus?new Unit({code:t.code,stage:t.stage+1,unbuilt:a}):new Unit({code:t.code,stage:t.stage})).setPosition(l.x,l.y),this.map.add(Map2d.LAYER_UNITS,l.x,l.y,p),r.push(p)}var d=SpecialOffer.IsAvailable(r[0]);d&&SpecialOffer.CreateOffer(r[0]),this.counter.setTimeout(function(){r.forEach(function(e){this.map.onAdd(Map2d.LAYER_UNITS,e.x,e.y,e),e.onStartDidMerged()},this),this.playMergeSound()}.bind(this),200);var u=void 0;this.tutorial.isActive()||d||(u=r.filter(function(e){return!Buildable.IsBuilt(e)})[0]),
this.counter.setTimeout(function(){r.forEach(function(e){e.didMerged()},this)}.bind(this),300),u&&this.counter.setTimeout(function(){InfoView.DisplayInfo(u)}.bind(this),1100),this.counter.setTimeout(function(){r.forEach(function(e){this.onUnitAvailable(e),this.gameEvent(Merge.SPAWN,{unit:e,affected:o})},this),this.gameEvent(Merge.MERGE,{affected:o})}.bind(this),400),5<i.next&&i.next===2*n.length+1&&this.counter.setTimeout(function(){this.map.showMergeBonus(r)}.bind(this),600)},Merge.prototype.replace=function(e,t,n){n?(e.remove(),t.setPosition(e.x,e.y),this.map.add(Map2d.LAYER_UNITS,t.x,t.y,t),this.map.onAdd(Map2d.LAYER_UNITS,t.x,t.y,t)):(e.onDestruction(),e.remove(!0),this.spawn([t],e,{radius:0}))},Merge.prototype.replaceHeroFamilyWithCoins=function(i){this.counter.setTimeout(function(){for(var e=this.map.listAvailableUnits(),t=0;t<e.length;++t){var n=e[t];if("specialoffer"===n.code&&n.findComponent(SpecialOffer).prize.code===i.code)n.remove();else if(
n.code===i.code&&n.stage<i.units.length-1)this.replace(n,new Unit({code:"coins",stage:Math.min(n.stage,3)}));else if(n.prizes&&n.prizes.length){var s=n.prizes.filter(function(e){return e.code!==i.code});0===s.length?(n.prizes=void 0,n.prizesExp=void 0,n.onChangePrizes(),n.onPrizeHarvested()):s.length!==n.prizes.length&&(n.prizes=s,n.onChangePrizes())}}}.bind(this),100)},Merge.prototype.getTargetCastle=function(e){for(var t=this.map.listAvailableUnits(),n=0;n<t.length;n++)if(t[n].code===e.code&&t[n].isUpgradable()&&t[n].findComponent(Upgradable).canCollectStage(e.stage))return t[n]},Merge.prototype.updateAvailableUnits=function(){for(var e in this.map.listAvailableUnits().forEach(this.onUnitAvailable.bind(this)),this.fogs.fakeUnits)for(var t in this.fogs.fakeUnits[e]){var n=parseInt(e),s=parseInt(t);!this.map.getFog(n,s)&&this.fogs.fakeUnits[n][s]&&this.unitsLibrary.openUnit(this.fogs.fakeUnits[n][s])}},Merge.prototype.decreasePrizeStageIfNeeded=function(e){if(!e.stage)return e;if(
"resource"!==Families[e.code].type&&"hero"!==Families[e.code].type)return e;for(;0<e.stage&&!this.unitsLibrary.isOpened({code:e.code,stage:e.stage});)e.stage--;return e},Merge.prototype.onUnitAvailable=function(n){if("resource"===n.getType()&&n.isUpgradable()&&Game.currentGame.map.listAvailableUnits().forEach(function(e){if(e.code===n.code){var t=e.findComponent(Pulsing);t&&t.init()}}),Buildable.IsBuilt(n)){this.unitsLibrary.openUnit(n),"hero"===n.getType()&&this.unitsLibrary.isHeroAvailable(n.code)&&(this.fogs.calcFogStates(),this.replaceHeroFamilyWithCoins(Families[n.code]),this.quests.deleteHeroItemsQuests(n.code));var e=n.findComponent(InstantWorker);e&&this.workers.addInstant(e)}else this.tutorial.triggerBuildTutorial({unit:n})},Merge.prototype.listAvailableByType=function(e){return this.unitsLibrary.listAvailableByType(e)},Merge.prototype.showUp=function(e){this.onShowUp(function(){this.saveZoom=!0,e()}.bind(this))},Merge.WORKERS_WINDOW_INTERVAL="15 minutes",Merge.MERGE="merge",
Merge.SPAWN="spawn",Merge.HARVEST="harvest",Merge.OPENFOG="openfog",Merge.OPENDRAGON="opendragon",Merge.START_MINING="startmining",Merge.COMPLETE_MINING="completemining",Merge.MINE="mine",Merge.START_BUILDING="startbuilding",Merge.BUILD="build",Merge.SPEED_UP="speedup",Merge.PRIZE_HARVESTED="prizeharvested";var MergeTutorial=function(){cleverapps.EventEmitter.call(this),this.fresh=[];var e=Game.currentGame;e.on("gameEvent",this.onGameEvent.bind(this)),e.advice.on("showHint",this.onShowHint.bind(this))};MergeTutorial.prototype=Object.create(cleverapps.EventEmitter.prototype),(MergeTutorial.prototype.constructor=MergeTutorial).prototype.isActive=function(){return this.runningTutorial},MergeTutorial.prototype.showTutorial=function(n,e){n=cleverapps.toArray(n),cleverapps.metha.compound(e,[function(e){this.runningTutorial=n,Game.currentGame.advice.stopHint(),InfoView.CloseInfo(void 0,!0),e()}.bind(this),function(e){var t=n.map(function(t,n){return function(e){this.finished?e():(
t.targets=cleverapps.toArray(t.targets),this.showTutorialStep(t,n,e))}.bind(this)},this);cleverapps.metha.compound(e,t)}.bind(this),function(e){delete this.runningTutorial,delete this.finished,e()}.bind(this)])},MergeTutorial.prototype.showTutorialStep=function(t,e,n){this.step=t,this.runningIndex=e,this.onceStepCallback=cleverapps.once(n),this.onceFinishTutorialStep=cleverapps.once(this.finishTutorialStep.bind(this)),t.controls&&cleverapps.metha.showControlsWhileFocused(t.controls),cleverapps.metha.showControlsWhileFocused("map2d");var s=Game.currentGame;s.advice.setLogic(t.type,t);var i=t.wait||MergeTutorial.WAIT_MOVE,o=cleverapps.once(function(){if(this.clearFinishAllTimeout(),this.trigger("showTutorialStep",t),s.advice.hasHints()){var e=s.advice.findMove();!e||!e.cells||s.map.isScreenCell(e.cells[0].x,e.cells[0].y)&&"openfog"!==t.type||t.noScroll||s.map.onCenterTo(e.cells[0].x,e.cells[0].y)}}.bind(this));s.advice.hasHints()?(this.finishAllTimeout=setTimeout(this.finishAll.bind(this
),cleverapps.parseInterval(i)),this.onShowHintCallback=o,s.advice.startHint()):o()},MergeTutorial.prototype.onShowHint=function(){this.isActive()&&this.onShowHintCallback&&this.onShowHintCallback()},MergeTutorial.prototype.onGameEvent=function(e,t){if(this.isActive()){var n=MergeTutorial.Types[this.step.type]||{};if(-1!==(n.types||[this.step.type]).indexOf(e)){var s=Game.currentGame;n.allMoves&&s.advice.findMove()||n.affected&&t.affected&&!this.checkTargets(t.affected)||this.runOnceFinishTutorialStep()}}},MergeTutorial.prototype.triggerBuildTutorial=function(e){var t;e.unit&&!Game.currentGame.unitsLibrary.isOpened(e.unit)&&("wood"!==e.unit.code||2!==e.unit.stage||Game.currentGame.workers.findAssigned(e.unit)||(t=MergeTutorials.wood_2),t&&this.runningTutorial!==t&&-1===this.fresh.indexOf(t)&&(this.fresh.push(t),Game.currentGame.counter.setTimeout(function(){},0)))},MergeTutorial.prototype.processFresh=function(){if(this.fresh.length&&!cleverapps.metha.isFocused()){
var t=this.fresh.shift();cleverapps.metha.display({focus:"StartTutorial",action:function(e){this.showTutorial(t,e)}.bind(this)})}},MergeTutorial.prototype.clear=function(){this.clearFinishAllTimeout()},MergeTutorial.prototype.clearFinishAllTimeout=function(){this.finishAllTimeout&&(clearTimeout(this.finishAllTimeout),delete this.finishAllTimeout)},MergeTutorial.prototype.runOnceFinishTutorialStep=function(){if(this.onceFinishTutorialStep){var e=this.onceFinishTutorialStep;delete this.onceFinishTutorialStep,e()}},MergeTutorial.prototype.finishAll=function(){this.finished=!0,this.runOnceFinishTutorialStep()},MergeTutorial.prototype.isFirstStep=function(){return 0===this.runningIndex},MergeTutorial.prototype.isLastStep=function(){return this.runningIndex===this.runningTutorial.length-1},MergeTutorial.prototype.finishTutorialStep=function(){var e=Game.currentGame;e.advice.stopHint(),cleverapps.metha.hideControlsWhileFocused("map2d"),e.counter.setTimeout(this.runNextStep.bind(this),300)},
MergeTutorial.prototype.runNextStep=function(){if(this.trigger("finishTutorialStep"),!this.isLastStep()&&this.step.controls&&cleverapps.metha.hideControlsWhileFocused(this.step.controls),delete this.step,delete this.runningIndex,delete this.onShowHintCallback,this.clearFinishAllTimeout(),this.onceStepCallback){var e=this.onceStepCallback;delete this.onceStepCallback,e()}},MergeTutorial.prototype.checkTargets=function(e){return this.isActive()&&this.step&&this.step.targets&&cleverapps.contains(this.step.targets,e,Unit.GetKey)},MergeTutorial.prototype.isInfoAvailable=function(){return!(this.isActive()&&this.step&&this.step.type===Merge.MERGE)},MergeTutorial.WAIT_MOVE="10 seconds",MergeTutorial.Types={},MergeTutorial.Types[Merge.MERGE]={affected:!0},MergeTutorial.Types[Merge.SPAWN]={affected:!0},MergeTutorial.Types[Merge.HARVEST]={affected:!0,allMoves:!0},MergeTutorial.Types[Merge.SPEED_UP]={affected:!0,types:[Merge.SPEED_UP,Merge.MINE,Merge.BUILD]};var MergeTutorials={dwarf:{
type:Merge.MERGE,targets:{code:"dwarf",stage:0},person:"dwarf",text:"messages:Tutorial.dwarf.step1"},wheat_3:[{type:Merge.MERGE,targets:{code:"wheat",stage:0},person:"dwarf",controls:["MenuBarGameLevelItem","MenuBarCoinsItem"],text:"messages:Tutorial.wheat_3_tutorial.step1"},{type:Merge.MERGE,targets:{code:"wheat",stage:1},person:"dwarf",controls:["MenuBarGameLevelItem","MenuBarCoinsItem"],text:"messages:Tutorial.wheat_3_tutorial.step2"},{type:Merge.MERGE,targets:{code:"wheat",stage:2},person:"dwarf",controls:["MenuBarGameLevelItem","MenuBarCoinsItem"],text:"messages:Tutorial.wheat_3_tutorial.step3"}],dishes_0:[{type:Merge.SPAWN,targets:{code:"wheat",stage:3},person:"dwarf",controls:"sidebar",text:"messages:Tutorial.dishes_0.step1"},{type:Merge.HARVEST,targets:{code:"wheat",stage:4},person:"dwarf",controls:"sidebar",text:"messages:Tutorial.dishes_0.step2"},{type:Merge.SPAWN,targets:{code:"dwarf",stage:1},prizes:{code:"dishes",stage:0},person:"dwarf",controls:"sidebar",
text:"messages:Tutorial.dishes_0.step3"},{type:Merge.SPAWN,targets:{code:"dishes",stage:0},person:"dwarf",controls:"sidebar",text:"messages:Tutorial.dishes_0.step4"},{type:Merge.HARVEST,targets:{code:"wands",stage:0},person:"dwarf",controls:"MenuBarWandsItem",text:"messages:Tutorial.dishes_0.step5"},{type:Merge.OPENFOG,noScroll:!0,targets:"fog2",person:"dwarf",controls:"MenuBarWandsItem",text:"messages:Tutorial.dishes_0.step6"}],woodsource_1_1:[{type:Merge.START_MINING,targets:{code:"woodsource",stage:1},person:"worker",text:"messages:Tutorial.woodsource_1.step1"},{type:Merge.SPAWN,targets:{code:"woodsource",stage:1},prizes:{code:"wood",stage:0},person:"worker",wait:"15 seconds",text:"messages:Tutorial.woodsource_1.step2"},{type:Merge.MERGE,targets:{code:"wood",stage:0},person:"worker",text:"messages:Tutorial.woodsource_1.step2.1"},{type:Merge.START_MINING,targets:{code:"woodsource",stage:1,mined:1},person:"worker",text:"messages:Tutorial.woodsource_1.step3"},{type:Merge.SPEED_UP,
targets:{code:"woodsource",stage:1,mined:1},person:"worker",text:"messages:Tutorial.woodsource_1.step4"},{type:Merge.SPAWN,targets:{code:"woodsource",stage:1},prizes:{code:"woodchest",stage:0},person:"worker",text:"messages:Tutorial.woodsource_1.step5"},{type:Merge.SPAWN,targets:{code:"woodchest",stage:0},person:"worker",text:"messages:Tutorial.woodsource_1.step6"}],wood_2:[{type:Merge.START_BUILDING,targets:{code:"wood",stage:2},person:"worker",text:"messages:Tutorial.wood_2.step1"},{type:Merge.SPEED_UP,targets:{code:"wood",stage:2},person:"worker",text:"messages:Tutorial.wood_2.step2"}]},MergeTutorialView=cc.Node.extend({ctor:function(e){this._super(),this.tutorial=e;var t=cleverapps.UI.getSceneSize();this.setContentSize2(t),this.setAnchorPoint2(.5,.5),this.setLocalZOrder(12),this.setCascadeOpacityEnabled(!0),this.tutorial.on("showTutorialStep",this.showTutorialStep.bind(this),this),this.tutorial.on("finishTutorialStep",this.finishTutorialStep.bind(this),this),
cleverapps.windows.onOpenListeners.tutorial=this.createListener(this.hideDialogue.bind(this)),cleverapps.windows.onCloseListeners.tutorial=this.createListener(this.showDialogue.bind(this))},showTutorialStep:function(e){this.data=e,this.createDialogue()},finishTutorialStep:function(){this.dialogue&&(this.dialogue.options.showUp=this.tutorial.isLastStep(),this.dialogue.close(),delete this.dialogue),this.dialogueComponent&&this.dialogueComponent.hide()},createDialogue:function(){Messages.has(this.data.text)&&(this.dialogueComponent=new MinimalDialogue({text:Messages.get(this.data.text),person:this.data.person&&cleverapps.styles.DialogueView.persons[this.data.person]}),this.addChild(this.dialogueComponent))},showDialogue:function(){this.dialogueView&&this.dialogueView.setVisible(!0)},hideDialogue:function(){this.dialogueView&&this.dialogueView.setVisible(!1)}});cleverapps.styles.MergeTutorialView={};var MergePushes=function(){this.updateFruits(),this.updateCastles(),this.updateOrders()}
;MergePushes.prototype.updateBuilt=function(){var e=this._buildingBuilt();cleverapps.localPushes.cancelPush(cleverapps.LocalPushes.TYPES.BUILDING_BUILT),void 0!==e&&cleverapps.localPushes.sendPush(cleverapps.LocalPushes.TYPES.BUILDING_BUILT,e)},MergePushes.prototype._buildingBuilt=function(){var e=Game.currentGame.workers.regular.filter(function(e){return e.isBusy()}),n=void 0;return e.forEach(function(e){if(e.unit.findComponent(Buildable)){var t=e.getTimeLeft();(void 0===n||t<n)&&(n=t)}}),n},MergePushes.prototype.updateChopped=function(){var e=this._treeChopped();cleverapps.localPushes.cancelPush(cleverapps.LocalPushes.TYPES.TREE_CHOPPED),void 0!==e&&cleverapps.localPushes.sendPush(cleverapps.LocalPushes.TYPES.TREE_CHOPPED,e)},MergePushes.prototype._treeChopped=function(){var e=Game.currentGame.workers.regular.filter(function(e){return e.isBusy()}),n=void 0;return e.forEach(function(e){if(e.unit.findComponent(Mineable)){var t=e.getTimeLeft();(void 0===n||t<n)&&(n=t)}}),n},
MergePushes.prototype.updateOrders=function(){var e=this._orderReady();cleverapps.localPushes.cancelPush(cleverapps.LocalPushes.TYPES.ORDER_READY),void 0!==e&&cleverapps.localPushes.sendPush(cleverapps.LocalPushes.TYPES.ORDER_READY,e)},MergePushes.prototype._orderReady=function(){var e=Game.currentGame.listUnitsByType(MakesOrder),s=void 0;return e.forEach(function(e){var t=e.findComponent(MakesOrder);if(t.isCooking()){var n=t.getTimeLeft();(void 0===s||n<s)&&(s=n)}}),s},MergePushes.prototype.updateCastles=function(){var e=this._castlePrize();cleverapps.localPushes.cancelPush(cleverapps.LocalPushes.TYPES.CASTLE_PRIZE),void 0!==e&&cleverapps.localPushes.sendPush(cleverapps.LocalPushes.TYPES.CASTLE_PRIZE,e)},MergePushes.prototype.updateMiniGames=function(){var e=this._miniGamePrize();cleverapps.localPushes.cancelPush(cleverapps.LocalPushes.TYPES.MINI_GAME_PRIZE),void 0!==e&&cleverapps.localPushes.sendPush(cleverapps.LocalPushes.TYPES.MINI_GAME_PRIZE,e)},
MergePushes.prototype._castlePrize=function(){var e=Game.currentGame.listUnitsByType(Castle),s=void 0;return e.forEach(function(e){var t=e.findComponent(Castle);if(t.isCreatingPrize()){var n=t.timeToReady();(void 0===s||n<s)&&(s=n)}}),s},MergePushes.prototype._miniGamePrize=function(){var e=Game.currentGame.listUnitsByType(MiniGame),n=void 0;return e.forEach(function(e){var t=e.findComponent(MiniGame).timeToReady();0<t&&(void 0===n||t<n)&&(n=t)}),n},MergePushes.prototype.updateFruits=function(){var e=this._fruitRipe();cleverapps.localPushes.cancelPush(cleverapps.LocalPushes.TYPES.FRUIT_RIPE),void 0!==e&&cleverapps.localPushes.sendPush(cleverapps.LocalPushes.TYPES.FRUIT_RIPE,e)},MergePushes.prototype._fruitRipe=function(){var e=Game.currentGame.listUnitsByType(Fruit),s=void 0;return e.forEach(function(e){var t=e.findComponent(Fruit);if(t.isGrowing()){var n=t.timeToReady();(void 0===s||n<s)&&(s=n)}}),s},MergePushes.prototype.updateMagicPlants=function(){var e=this._magicPlantsReady()
;cleverapps.localPushes.cancelPush(cleverapps.LocalPushes.TYPES.MAGIC_PLANT_READY),void 0!==e&&cleverapps.localPushes.sendPush(cleverapps.LocalPushes.TYPES.MAGIC_PLANT_READY,e)},MergePushes.prototype._magicPlantsReady=function(){var e=Game.currentGame.listUnitsByType(MagicPlant),s=void 0;return e.forEach(function(e){var t=e.findComponent(MagicPlant);if(t.isGrowing()){var n=t.getTimeLeft();(void 0===s||n<s)&&(s=n)}}),s};var Highlight=function(e,t){this.error=0,this.x=e,this.y=t,this.onMove=function(){},this.onRemove=function(){},this.show=function(){},this.hide=function(){},this.up=function(){}};Highlight.prototype.isBlockedCell=function(e,t){var n=Game.currentGame.map;if(!n.isGround(e,t))return!0;var s=n.getUnit(e,t);return!(!s||s.isMoveable())||void 0!==n.layers[Map2d.LAYER_FOG][t][e]},Highlight.prototype.move=function(e,t,n){this.error=this.isBlockedCell(e,t),this.onMove(e,t,n)},Highlight.prototype.clear=function(){clearTimeout(this.timeout)},Highlight.prototype.remove=function(){
clearTimeout(this.timeout),this.onRemove()},Highlight.prototype.schedule=function(e,t){clearTimeout(this.timeout),this.timeout=setTimeout(e,t)},Highlight.ONE_PULSE=1500;var PixelsPlanner=function(e){this.stored=e,this.onCreateSwarm=function(){},this.init()};PixelsPlanner.prototype.clear=function(){clearTimeout(this.waitTimeout),this.waitTimeout=void 0},PixelsPlanner.prototype.restart=function(){this.waitingRestart=!0,void 0!==this.waitTimeout?(this.clear(),this.startCurrentLevel()):(this.level=0,Game.currentGame.storeSave())},PixelsPlanner.prototype.init=function(){this.inited||cleverapps.config.editorMode||cleverapps.config.adminMode||cleverapps.config.wysiwygMode||(Game.currentGame.unitsLibrary.listAvailableByType("fruit").length<2?this.waitTimeout=new cleverapps.LongTimeout(this.init.bind(this),cleverapps.parseInterval(PixelsPlanner.BETWEEN_INIT_TIMEOUT)):(this.inited=!0,this.stored?(this.level=this.stored.level,this.time=this.stored.time,this.firstTime=!1):(this.level=2,
this.time=Date.now(),this.firstTime=!0),this.waitTimeout=void 0,this.startCurrentLevel()))},PixelsPlanner.prototype.save=function(){if(this.inited)return{level:this.level,time:this.time}},PixelsPlanner.prototype.sendPixels=function(){this.onCreateSwarm(new PixelsSwarm(this,{amount:cleverapps.Random.choose(PixelsPlanner.LEVELS[this.level].amount),onFirstCollected:this.nextLevel.bind(this),onFinish:this.startCurrentLevel.bind(this)}))},PixelsPlanner.prototype.nextLevel=function(){this.level<PixelsPlanner.LEVELS.length-1&&(this.level++,Game.currentGame.storeSave())},PixelsPlanner.prototype.startCurrentLevel=function(){if(void 0===this.waitTimeout){(this.waitingRestart||this.time<Date.now()-cleverapps.parseInterval(PixelsPlanner.CLEAR_TIMEOUT))&&(this.level=0,delete this.waitingRestart),this.time=Date.now(),Game.currentGame.storeSave();var e=cleverapps.parseInterval(this.firstTime?PixelsPlanner.FIRST_TIMEOUT:PixelsPlanner.LEVELS[this.level].timeout);this.firstTime=!1,
this.waitTimeout=new cleverapps.LongTimeout(function(){this.waitTimeout=void 0,this.sendPixels()}.bind(this),e)}},PixelsPlanner.LEVELS=[{amount:[4,5,5,6],timeout:"30 seconds"},{amount:[3,4],timeout:"3 minutes"},{amount:[2,3,3,4],timeout:"4 minutes"},{amount:[2,3],timeout:"5 minutes"},{amount:[2],timeout:"10 minutes"}],PixelsPlanner.BETWEEN_INIT_TIMEOUT="5 seconds",PixelsPlanner.FIRST_TIMEOUT="20 seconds",PixelsPlanner.CLEAR_TIMEOUT="1 hour";var PixelsSwarm=function(e,t){this.pixelsPlanner=e,this.amountPixels=t.amount,this.onFinish=t.onFinish,this.onFirstCollected=t.onFirstCollected};PixelsSwarm.prototype.createPixels=function(){for(var e=[],t=0,n=this.amountPixels;t<n;++t)e.push({type:PixelsSwarm.PIXEL_TYPE_FRUIT});var s=cleverapps.missionManager.findByType(Mission.TYPE_ENERGY_FEAST);if(s&&s.isRunning())for(n=Math.ceil(1.5*n);t<n;++t)e.push({type:PixelsSwarm.PIXEL_TYPE_ENERGY});return cleverapps.Random.shuffle(e)},PixelsSwarm.prototype.pixelCollectPrize=function(e,t){if(
e.type===PixelsSwarm.PIXEL_TYPE_FRUIT){var n=Game.currentGame.unitsLibrary.listAvailableByType("fruit"),s=new Unit({code:cleverapps.Random.choose(n),stage:0});if(!Game.currentGame.spawn([s],e,{fromNode:!0,parentWorldPosition:t,sound:bundles.merge.urls.spawn_beetle_effect}).length)return this.pixelCollected||(this.pixelCollected=!0,this.onFirstCollected()),!0}else if(e.type===PixelsSwarm.PIXEL_TYPE_ENERGY){var i=cleverapps.Random.random(5,10);return Game.currentGame.addReward("energy",i,e,{withoutDelta:!0}),this.pixelCollected||(this.pixelCollected=!0,this.onFirstCollected()),!0}return!1},PixelsSwarm.PIXEL_TYPE_FRUIT="fruit",PixelsSwarm.PIXEL_TYPE_ENERGY="energy";var PixelsSwarmView=cc.Node.extend({ctor:function(e,t){this._super(),this.model=e,this.visibleRect=t,this.pixels=[];var n=Math.random()*this.visibleRect.width*.3,s=e.createPixels();this.amountPixels=s.length;for(var i=0;i<s.length;i++)this.sendPixel({type:s[i].type,order:i,groupDelta:n,totalAmount:s.length,
onDie:this.pixelDie.bind(this)});cleverapps.audio.playSound(bundles.merge.urls.pixel_spawn_effect)},pixelDie:function(){this.amountPixels--,this.amountPixels||this.finish()},finish:function(){this.pixels=void 0,this.removeFromParent(),this.model.onFinish()},findClosestPixel:function(e){for(var t=void 0,n=void 0,s=0;s<this.pixels.length;s++)if(this.pixels[s]!==e&&this.pixels[s].flying){var i=cc.pDistance(e,this.pixels[s]);i<cleverapps.styles.PixelsSwarmView.minimalDistance&&(void 0===t||i<t)&&(t=i,n=this.pixels[s])}return n},sendPixel:function(e){var t=cleverapps.styles.PixelsSwarmView,n=this.visibleRect.x,s=this.visibleRect.y+this.visibleRect.height,i={x:n+(e.order-e.totalAmount/2)*t.x-t.y/2-t.dy+e.groupDelta,y:s+Math.random()*t.y+t.dy},o={x:1.2*this.visibleRect.width,y:1.2*this.visibleRect.height},r=new PixelView({type:e.type,pixelsSwarmView:this,distance:o,onDie:e.onDie});r.setPositionRound(i),this.addChild(r),this.pixels.push(r)}});cleverapps.styles.PixelsSwarmView={x:120,y:200,
dy:100,minimalDistance:80};var PixelView=cc.Node.extend({ctor:function(e){switch(this._super(),this.type=e.type,this.pixelsSwarmView=e.pixelsSwarmView,this.onDie=e.onDie,this.setAnchorPoint2(),this.setContentSize2(cleverapps.styles.PixelView.width,cleverapps.styles.PixelView.height),this.animation=new cleverapps.Spine(bundles.merge.jsons.pixels_json),this.animation.setPositionRound(cleverapps.styles.PixelView.animation),this.animation.setAnimation(0,"animation",!0),this.addChild(this.animation),this.type){case PixelsSwarm.PIXEL_TYPE_FRUIT:this.animation.setSkin("standart");break;case PixelsSwarm.PIXEL_TYPE_ENERGY:this.animation.setSkin("energy")}this.speed={x:e.distance.x/90,y:-e.distance.y/90},this.flying=!0,this.scheduleUpdate(),this.setScale(0),this.runAction(new cc.Sequence(new cc.ScaleTo(.2,1),new cc.DelayTime(89.4),new cc.ScaleTo(.2,0),new cc.CallFunc(this.die.bind(this)))),cleverapps.UI.onClick(this,this.collect.bind(this),{swallowTouches:!1,ignoreOnTouchMoved:!0}),
cleverapps.UI.onDrag(this,{onDragStart:function(){return this.flying=!1,this.setLocalZOrder(1),this.unscheduleUpdate(),!0}.bind(this),onDragEnd:function(){this.flying=!0,this.setLocalZOrder(0),this.scheduleUpdate()}.bind(this),swallowTouches:!0,followPointer:!0})},die:function(){this.flying=!1,this.removeFromParent(),this.onDie()},collect:function(){this.collected||this.pixelsSwarmView.model.pixelCollectPrize(this,this.parent.convertToWorldSpace(this.getPosition()))&&(this.collected=!0,this.flying=!1,this.unscheduleUpdate(),this.stopAllActions(),this.animation.setAnimation(0,"animation2",!1),this.animation.setCompleteListener(this.die.bind(this)))},update:function(e){this._super(e);var t={x:this.speed.x,y:this.speed.y},n=this.pixelsSwarmView.findClosestPixel(this);if(n){var s={x:this.x-n.x,y:this.y-n.y},i=cc.pLength(s);s=i<1?{x:1,y:0}:{x:s.x/i,y:s.y/i},t={x:t.x+s.x*cleverapps.styles.PixelView.gravitySpeed,y:t.y+s.y*cleverapps.styles.PixelView.gravitySpeed}}this.setPosition({
x:this.x+e*t.x,y:this.y+e*t.y})}});cleverapps.styles.PixelView={width:80,height:80,animation:{x:{align:"center"},y:{align:"center",dy:-40}},gravitySpeed:100};var BarrelPlanner=function(e){this.time=e&&e.time||0,this.onCreateBarrel=function(){},this.init()};BarrelPlanner.prototype.onChangeGameLevel=function(){this.inited||this.init()},BarrelPlanner.prototype.init=function(){this.isAvailable()&&(this.inited=!0,this.checkTimeout=new cleverapps.LongTimeout(this.scheduleSending.bind(this),cleverapps.parseInterval(BarrelPlanner.INIT_TIMEOUT)))},BarrelPlanner.prototype.isAvailable=function(){return!cleverapps.flags.noads&&RewardedAdsManager.IsEnabled()&&cleverapps.user.checkAvailable(BarrelPlanner.AVAILABLE)&&!cleverapps.config.editorMode&&!cleverapps.config.adminMode},BarrelPlanner.prototype.clear=function(){clearInterval(this.checkTimeout),delete this.checkTimeout},BarrelPlanner.prototype.sendBarrel=function(){var e=new Barrel;e.on("collect",function(){this.time=Date.now(),
Game.currentGame.storeSave(),this.scheduleSending()}.bind(this)),this.onCreateBarrel(e)},BarrelPlanner.prototype.scheduleSending=function(){if(this.clear(),!(cleverapps.config.editorMode||cleverapps.config.adminMode||cleverapps.config.wysiwygMode)){var e=this.time+cleverapps.parseInterval(BarrelPlanner.BARRELS_INTERVAL)-Date.now();e<=0&&cleverapps.rewardedAdsManager.isAvailable()?this.sendBarrel():this.checkTimeout=new cleverapps.LongTimeout(this.scheduleSending.bind(this),e<=0?cleverapps.parseInterval(BarrelPlanner.AD_CHECK_INTERVAL):e)}},BarrelPlanner.prototype.save=function(){if(this.inited)return{time:this.time}},BarrelPlanner.AVAILABLE={episode:0,level:3},BarrelPlanner.BARRELS_INTERVAL="3 hours",BarrelPlanner.AD_CHECK_INTERVAL="1 minute",BarrelPlanner.INIT_TIMEOUT="10 second",cleverapps.config.debugMode&&(BarrelPlanner.BARRELS_INTERVAL="3 minutes",BarrelPlanner.AD_CHECK_INTERVAL="10 seconds",BarrelPlanner.INIT_TIMEOUT="5 seconds");var Barrel=function(){
cleverapps.EventEmitter.call(this)};Barrel.prototype=Object.create(cleverapps.EventEmitter.prototype),(Barrel.prototype.constructor=Barrel).prototype.collect=function(e){if(!this.collected){e.price.type===Barrel.PRICE_TYPES.RUBY&&cleverapps.user.takeGold(e.price.amount),e.price.type===Barrel.PRICE_TYPES.COIN&&Game.currentGame.takeCoins(e.price.amount);var t=Barrel.ITEMS.indexOf(e);cleverapps.eventLogger.logEvent("barrel_reward_"+t),this.trigger("collect",e.reward),this.collected=!0}},Barrel.prototype.showItemAds=function(e){this.collected||(Game.currentGame.map.countEmptySlots()<e.reward.amount?Game.currentGame.onHintMessage("messages:Spawn.nospace",!0):e.price.type!==Barrel.PRICE_TYPES.RUBY||cleverapps.user.canTakeGold(e.price.amount)?e.price.type!==Barrel.PRICE_TYPES.COIN||Game.currentGame.canTakeCoins(e.price.amount)?cleverapps.rewardedAdsManager.play(RewardedAdsManager.REWARDED,this.collect.bind(this,e)):Game.currentGame.takeCoins(e.price.amount):cleverapps.user.takeGold(
e.price.amount))},Barrel.PRICE_TYPES={RUBY:0,COIN:1},Barrel.ITEMS=[{buttonTxt:"messages:FREE",price:{},reward:{unit:{code:"rubies",stage:0},amount:1}},{reward:{unit:{code:"woodchest",stage:1},amount:1},price:{type:Barrel.PRICE_TYPES.COIN,amount:50,icon:bundles.reward_icons.frames.shop_coin_png}},{reward:{unit:{code:"worker",stage:2},amount:2},price:{type:Barrel.PRICE_TYPES.RUBY,amount:10,icon:bundles.reward_icons.frames.gold_small_png}}];var BarrelView=cc.Node.extend({ctor:function(e){this._super(),(this.barrel=e).on("collect",this.createListener(this.animateCollect.bind(this))),this.setAnchorPoint2(),this.setContentSize2(cleverapps.styles.BarrelView),this.animation=new cleverapps.Spine(bundles.merge.jsons.adsbarrel_json),this.animation.setPositionRound(this.width/2,this.height/2),this.addChild(this.animation),cleverapps.UI.onClick(this,this.onClick.bind(this),{swallowTouches:!1,ignoreOnTouchMoved:!0});var t=Game.currentGame.map.getView().getCell(Map2d.LAYER_WATER,
BarrelView.POSSIBLE_CELL.x,BarrelView.POSSIBLE_CELL.y).getPosition();this.setPositionRound(t),this.showUp()},showUp:function(){this.runAction(new cc.Sequence(new cc.DelayTime(1.3),new cc.CallFunc(function(){var e=new PrizeView({sprite:bundles.shared.frames.adicon_png,padding:cleverapps.styles.BarrelView.ad_icon_padding,onClick:this.onClick.bind(this)});e.setPositionRound(this.width/2,this.height),e.basePosition=e.getPosition(),this.addChild(e),e.runAnimation(),e.runAction(new cc.ScaleTo(.2,1,1).easing(cc.easeIn(1)))}.bind(this)))),this.animation.setAnimationAndIdleAfter("appearance","animation"),cleverapps.audio.playSound(bundles.merge.urls.barrel_appear_sfx)},animateCollect:function(e){this.stopAllActions(),this.runAction(new cc.Sequence(new cc.DelayTime(1.25),new cc.ScaleTo(.2,.1),new cc.Hide,new cc.DelayTime(2),new cc.RemoveSelf));for(var n=[],t=0;t<e.amount;t++)n.push(new Unit(e.unit));var s={focus:"barrelReward",actions:[function(e){setTimeout(e,250)},function(e){
Game.currentGame.map.onCenterTo(BarrelView.POSSIBLE_CELL.x,BarrelView.POSSIBLE_CELL.y,{layer:Map2d.LAYER_WATER,callback:e})}.bind(this),function(e){Game.currentGame.spawn(n,this,{fromNode:!0}),setTimeout(e,700)}.bind(this),function(e){var t=n[0];t&&t.x&&t.y&&Game.currentGame.map.onCenterTo(t.x,t.y,{duration:1.7*MergeScene.SCROLL_TO_DURATION}),e()}]};cleverapps.metha.isFocused()&&"BarrelAdsOpen"===cleverapps.metha.focus?cleverapps.metha.distract(s):cleverapps.metha.display(s)},onClick:function(){this.barrel.collected||cleverapps.metha.display({focus:"BarrelAdsOpen",control:["MenuBarGoldItem","MenuBarCoinsItem"],action:function(e){new BarrelAdsWindow(this.barrel),cleverapps.metha.onceNoWindowsListener=e}.bind(this)})}});BarrelView.POSSIBLE_CELL={x:38,y:37},cleverapps.styles.BarrelView={width:100,height:100,ad_icon_padding:{x:15,y:15}};var BarrelAdsWindow=Window.extend({onWindowLoaded:function(e){this.barrel=e,this._super({name:"barreladswindow",title:"messages:BarrelAdsWindow.title",
content:this.createContent(),styles:cleverapps.overrideStyles(cleverapps.styles.Window,cleverapps.styles.BarrelAdsWindow.Window,!0)}),e.on("collect",this.createListener(this.close.bind(this)))},createContent:function(){var e=Barrel.ITEMS.map(function(e){return this.createItem(e)},this),t=new cleverapps.Layout(e,{direction:cleverapps.UI.HORIZONTAL,margin:cleverapps.styles.BarrelAdsWindow.itemsMargin}),n=cleverapps.UI.generateOnlyText("messages:BarrelAdsWindow.subTitle",cleverapps.styles.FONTS.BARREL_ADS_TITLE);return new cleverapps.Layout([t,n],{direction:cleverapps.UI.VERTICAL,margin:cleverapps.styles.BarrelAdsWindow.contentMargin,padding:cleverapps.styles.BarrelAdsWindow.contentPadding})},createItem:function(e){var t=cleverapps.styles.BarrelAdsWindow.item,n=new cc.Node;n.setAnchorPoint2(),n.setContentSize2(t);var s=cleverapps.UI.createScale9Sprite(bundles.units_shop.frames.bg_png,cleverapps.UI.Scale9Rect.TwoPixelXY);s.setContentSize2(n.getContentSize()),n.addChild(s,-1),
s.setPositionRound(n.width/2,n.height/2);var i=this.createIcon(e);n.addChild(i),i.setPositionRound(t.iconNode);var o=this.createItemStrip(e);n.addChild(o),o.setPositionRound(t.strip);var r=cleverapps.UI.generateOnlyText("messages:Units."+e.reward.unit.code+".stage"+(e.reward.unit.stage+1)+".name",cleverapps.styles.FONTS.BARREL_ADS_TITLE);return n.addChild(r),r.setPositionRound(t.title),r.setDimensions(t.title.maxWidth,0),r.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER),cleverapps.UI.onClick(n,this.barrel.showItemAds.bind(this.barrel,e)),new cleverapps.Layout([this.createItemButton(e),n],{direction:cleverapps.UI.VERTICAL,margin:t.buttonMargin})},createItemStrip:function(e){var t=cleverapps.styles.BarrelAdsWindow.item.strip,n=cleverapps.UI.createScale9Sprite(bundles.units_shop.frames.amount_bg_png,cleverapps.UI.Scale9Rect.TwoPixelXY);n.setContentSize2(t);var s=cleverapps.UI.generateImageText("x"+e.reward.amount,cleverapps.styles.FONTS.BARREL_ADS_AMOUNT);return n.addChild(s),
s.setPositionRound(t.amount),n},createIcon:function(e){return new UnitOnCell(e.reward.unit,{scale:cleverapps.styles.BarrelAdsWindow.item.iconNode.scale,animation:!0})},createItemButton:function(e){var t=cleverapps.styles.BarrelAdsWindow.item.button,n=new cc.Node;n.setAnchorPoint2();var s=new cc.Sprite(bundles.shared.frames.adicon_png);s.setPositionRound(t.adIcon),n.setContentSize2(s.getContentSize()),n.addChild(s),n.setScale(t.adIcon.scale);var i=[];if(e.buttonTxt){(o=cleverapps.UI.generateOnlyText(e.buttonTxt,cleverapps.styles.FONTS.BUTTON_TEXT)).fitTo(t.textWidth),i.push(o)}else{var o=cleverapps.UI.generateOnlyText(e.price.amount,cleverapps.styles.FONTS.BUTTON_TEXT),r=new cc.Sprite(e.price.icon);e.price.type===Barrel.PRICE_TYPES.RUBY&&r.setScale(t.rubyIcon.scale);var a=new cleverapps.Layout([o,r],{direction:cleverapps.UI.HORIZONTAL,margin:t.iconMargin});cleverapps.UI.fitToBox(a,{width:t.textWidth,height:a.height}),i.push(a);var c=cleverapps.UI.generateOnlyText("+",
cleverapps.styles.FONTS.BUTTON_TEXT);i.push(c)}i.push(n);var l=new cleverapps.Layout(i,{direction:cleverapps.UI.HORIZONTAL,margin:t.margin});return new cleverapps.UI.Button({button_images:cleverapps.UI.Button.Images.button_blue,width:t.width,height:t.height,content:l,fitTo:!1,onClicked:this.barrel.showItemAds.bind(this.barrel,e)})},listBundles:function(){return["reward_icons","units_shop"]}});cleverapps.overrideFonts(cleverapps.styles.FONTS,{BARREL_ADS_TITLE:{size:35,color:cleverapps.styles.COLORS.DARK_TEXT_COLOR},BARREL_ADS_AMOUNT:{name:"nostroke",size:60,color:cleverapps.styles.COLORS.WHITE}}),cleverapps.styles.BarrelAdsWindow={itemsMargin:65,contentMargin:20,contentPadding:{x:40,y:0},item:{width:350,height:590,buttonMargin:20,iconNode:{x:{align:"center"},y:{align:"center",dy:130},scale:1.5},strip:{width:360,height:150,x:{align:"center"},y:{align:"bottom",dy:120},amount:{x:{align:"center"},y:{align:"center",dy:7}}},title:{maxWidth:320,x:{align:"center"},y:{align:"bottom",dy:50}},
button:{margin:10,textWidth:190,iconMargin:5,width:350,height:120,rubyIcon:{scale:.85},adIcon:{x:{align:"center"},y:{align:"center",dy:10},scale:.8}}},Window:{contentOffset:-10,Border:{y:70}}};var Fogs=function(t){this.blocks={};var e=Object.keys(FogsConfig).filter(function(e){return!FogsConfig[e].opened&&-1===t.indexOf(e)});this.fakeUnits=this.readDefaults(Game.currentGame.level.content.field);var i=Game.currentGame,o=i.map.regions;e.forEach(function(e){var n=new FogBlock(e,FogsConfig[e]),s=o[e];if(s){if(i.isRegularGame)if(0<s.positions.filter(function(e){return i.map.getUnit(e.x,e.y)}).length)return void console.log("Units available in closed fog - "+e+" - open it");s.positions.forEach(function(e){var t=s.head&&e.x===s.head.x&&e.y===s.head.y;n.add(e.x,e.y,t)}),this.blocks[e]=n}},this),this.blockedGrounds=new FogBlockedGround};Fogs.ReadMapUnit=function(e){var t=Families[e.code].units[e.stage];return e.type=Families[e.code].type,"source"===e.type&&t.mineable&&(e.grounded=!0),
t.multicell&&(e.multicell=t.multicell),t.important&&(e.important=t.important),e},Fogs.prototype.readDefaults=function(e){var s={};return e.forEach(function(e){var t=(e=Fogs.ReadMapUnit(e)).x,n=e.y;void 0===s[t]&&(s[t]={}),s[t][n]=e}),s},Fogs.prototype.open=function(e){delete this.blocks[e],this.blockedGrounds.updateBlockedGrounds(),this.calcFogStates(),Game.currentGame.storeSave()},Fogs.prototype.save=function(){return cleverapps.substract(Object.keys(FogsConfig),Object.keys(this.blocks))},Fogs.prototype.onChangeGameLevel=function(){this.calcFogStates()},Fogs.prototype.onChangeWandsAmount=function(){for(var e in this.blocks)this.blocks[e].onChangeWandsAmount()},Fogs.prototype.calcFogStates=function(){for(var e in this.blocks){var t=this.blocks[e];t.state;t.calcState()}},Fogs.prototype.isOpened=function(e){return!this.blocks[e]},Fogs.prototype.getBlockById=function(e){return this.blocks[e]},Fogs.prototype.updateBlockedGrounds=function(){this.blockedGrounds.updateBlockedGrounds()},
Fogs.prototype.findAvailableFogBlock=function(){var e;for(var t in this.blocks){var n=this.blocks[t];n.state!==FogBlock.UNAVAILABLE&&(!e||e.state<n.state)&&(e=n)}return e};var FogsConfig={fog0:{price:0,exp:0,headless:!0},fog1:{price:0,exp:0,headless:!0},fog2:{price:5,exp:10,conditions:{level:2}},fog3:{price:5,exp:10,parentFogId:"fog2",conditions:{level:3}},fog4_0:{price:5,exp:20,parentFogId:"fog3",conditions:{level:4}},fog4_1:{price:5,exp:25,parentFogId:"fog3",conditions:{level:4}},fog5:{price:15,exp:50,parentFogId:"fog2",conditions:{level:5}},fog6:{price:20,exp:50,parentFogId:"fog3",conditions:{level:6,hero:"king"}},fog7:{price:115,exp:50,parentFogId:"fog6",conditions:{level:7}},fog8:{price:225,exp:50,parentFogId:"fog7",conditions:{level:8,hero:"bear"}},fog9:{price:500,exp:50,parentFogId:"fog8",conditions:{level:9}},fog10:{price:1e3,exp:50,parentFogId:"fog9",conditions:{level:10}},fog11:{price:1500,exp:50,parentFogId:"fog3",conditions:{level:11,hero:"elf"}},fog12:{price:1300,exp:50,
parentFogId:"fog11",conditions:{level:12}},fog13:{price:1600,exp:50,parentFogId:"fog12",conditions:{level:13,hero:"warlock"}},fog14:{price:1950,exp:50,parentFogId:"fog13",conditions:{level:14}},fog15:{price:2350,exp:50,parentFogId:"fog13",conditions:{level:15}},fog16:{price:2800,exp:50,parentFogId:"fog15",conditions:{level:16,hero:"troll"}},fog17:{price:3300,exp:50,parentFogId:"fog16",conditions:{level:17}},fog18:{price:4160,exp:50,parentFogId:"fog17",conditions:{level:18}},moneyFog1:{price:240,money:!0,parentFogId:"fog4_1",conditions:{hero:"king"}},moneyFog2:{price:900,money:!0,parentFogId:"fog5",conditions:{level:7}},moneyFog3:{price:800,money:!0,parentFogId:"fog7",conditions:{hero:"bear"}},moneyFog4:{price:1100,money:!0,parentFogId:"fog14",conditions:{hero:"warlock"}},fog99:{price:1e3,exp:50,available:!(Fogs.prototype.findBlockWithProgress=function(){return cleverapps.values(this.blocks).filter(function(e){return e.state===FogBlock.CANTOPEN&&!e.isMoney()&&!e.isSpecial()}).sort(
function(e,t){return e.getOpenPrice()-t.getOpenPrice()})[0]}),conditions:{level:100}},dragonIsland:{special:!0,price:1e3,conditions:{hero:"king"}}},FogBlock=function(e,t){this.id=cleverapps.castType(e),this.options=t,this.tiles=[],this.state=FogBlock.UNAVAILABLE,this.clear(),this.getProgressTarget=function(){}};FogBlock.prototype.clear=function(){this.onOpen=function(){},this.onUpdateState=function(){},this.onWandsChanged=function(){},this.onUpdateConditions=function(){},this.onUpdatePromptFinger=function(){}},FogBlock.prototype.getKey=function(){return this.id},FogBlock.prototype.isMoney=function(){return this.options&&this.options.money},FogBlock.prototype.isSpecial=function(){return this.options&&this.options.special},FogBlock.prototype.click=function(){if(this.state!==FogBlock.UNAVAILABLE){var e=this.listNotFinishedConditions();if(e.length){var t,n=e[e.length-1];n.level&&(t=Messages.get("Fog.clear.levelCondition",{level:n.level}),Game.currentGame.onHintMessage(t,!0)),
n.hero&&this.displayHeroCondition(n)}this.isMoney()||(this.state===FogBlock.CANTOPEN&&this.displayWandsCondition(),this.state===FogBlock.CANOPEN&&Game.currentGame.onHintMessage("messages:Fog.clear.clearNow"));for(var s=0;s<this.tiles.length;s++)this.tiles[s].onClick()}},FogBlock.prototype.displayItemCondition=cleverapps.throttle(500,function(t){InfoView.CloseInfo();var n=Game.currentGame.map,e=n.listAvailableUnits({code:t.itemCode});if(0!==e.length){var s=[];e.forEach(function(e){if(e.highlight({duration:2*Highlight.ONE_PULSE}),-1===s.indexOf(e)){var t=n.bfs(e.x,e.y,e);t.length>s.length&&(s=t)}});var i=n.getUnit(s[0].x,s[0].y);n.onCenterTo(i.x,i.y,{callback:function(){InfoView.DisplayInfo(i)}}),Game.currentGame.map.onZoomTo({zoom:1.3,direction:MergeScene.ZOOM_DIRECTION_IN}),Game.currentGame.onHintMessage(t.text)}else cleverapps.metha.display({focus:"FogLockLibrary",action:function(e){new UnitsLibraryWindow({code:t.itemCode,stage:Families[t.itemCode].units.length-1}),
cleverapps.metha.onceNoWindowsListener=e}})}),FogBlock.prototype.displayHeroCondition=function(e){this.displayItemCondition({itemCode:e.hero,text:Messages.get("Fog.clear.heroCondition",{hero:Messages.get("Units."+e.hero+".name")})})},FogBlock.prototype.displayWandsCondition=function(){this.displayItemCondition({itemCode:"wands",text:Messages.get("Fog.clear.notEnoughWands",{wands:this.getOpenPrice()-Game.currentGame.wands})})},FogBlock.prototype.setState=function(e){if(this.state!==e){this.state=e,this.onUpdateState(this.state);for(var t=0;t<this.tiles.length;t++)this.tiles[t].updateState(this.state)}else this.onUpdatePromptFinger(),e===FogBlock.NOTREADY&&this.onUpdateConditions(e)},FogBlock.prototype.onChangeWandsAmount=function(){this.state!==FogBlock.CANTOPEN&&this.state!==FogBlock.CANOPEN||(this.setState(this.canOpen()?FogBlock.CANOPEN:FogBlock.CANTOPEN),this.onWandsChanged())},FogBlock.prototype.calcState=function(){var e=FogBlock.UNAVAILABLE;this.isAvailable()&&(
e=FogBlock.NOTREADY,this.isReady()&&(e=FogBlock.CANTOPEN,this.canOpen()&&(e=FogBlock.CANOPEN))),this.setState(e)},FogBlock.prototype.add=function(e,t,n){var s=new FogTile(e,t,this,n);n&&(this.head=s),this.tiles.push(s)},FogBlock.prototype.getOpenPrice=function(){return this.options.price},FogBlock.prototype.isAvailable=function(){return!(!1===this.options.available||!0===this.options.debugMode&&!cleverapps.config.debugMode)&&(void 0===this.options.parentFogId||Game.currentGame.fogs.isOpened(this.options.parentFogId))},FogBlock.prototype.showBuyWindow=function(){this.isMoney()&&cleverapps.metha.display({focus:"BuyFogWindow",control:["MenuBarGoldItem"],action:function(e){new BuyFogWindow(this),cleverapps.metha.onceNoWindowsListener=e}.bind(this)})},FogBlock.prototype.buy=function(){return!(!this.isMoney()||!cleverapps.user.takeGold(this.getOpenPrice()))&&(this.open(),cleverapps.eventLogger.logEvent(cleverapps.EVENTS.MONEY_FOG_RUBY,{amount:this.getOpenPrice()}),
cleverapps.eventLogger.logEvent(cleverapps.EVENTS.MONEY_FOG+"_"+this.id),!0)},FogBlock.prototype.isReady=function(){return!cleverapps.environment.isEditorScene()&&0===this.listNotFinishedConditions().length},FogBlock.prototype.canOpen=function(){if(this.isMoney())return!0;var e=Game.currentGame;return this.getOpenPrice()<=e.wands},FogBlock.prototype.listNotFinishedConditions=function(){var e=[];if(this.options.conditions){var t=Game.currentGame;for(var n in this.options.conditions)switch(n){case"level":(cleverapps.config.editorMode||t.gameLevel.getLevel()<this.options.conditions.level)&&e.push({level:this.options.conditions.level});break;case"hero":!cleverapps.config.editorMode&&t.unitsLibrary.isHeroAvailable(this.options.conditions.hero)||e.push({hero:this.options.conditions.hero})}}return e},FogBlock.prototype.open=function(){var e=Game.currentGame;this.options.exp&&e.gameLevel.addExp(this.options.exp,this.head),this.onOpen();for(var t=0;t<this.tiles.length;t++)this.tiles[t].onOpen()
,e.fogs.blockedGrounds.add(this.tiles[t].x,this.tiles[t].y);this.tiles=[],this.head=void 0,this.isMoney()||e.takeWands(this.getOpenPrice()),e.gameEvent(Merge.OPENFOG,{fog:this.id}),e.fogs.open(this.id),"dragonIsland"===this.id&&e.gameEvent(Merge.OPENDRAGON)},FogBlock.UNAVAILABLE=0,FogBlock.NOTREADY=1,FogBlock.CANTOPEN=2,FogBlock.CANOPEN=3;var FogTile=function(e,t,n,s){this.x=e,this.y=t,this.isHead=s,this.fogBlock=n,this.clear();var i=Game.currentGame;i.map.add(Map2d.LAYER_FOG,this.x,this.y,this),i.map.onAdd(Map2d.LAYER_FOG,this.x,this.y,this)};FogTile.prototype.clear=function(){this.onOpen=function(){},this.onUpdateState=function(){},this.onClick=function(){}},FogTile.prototype.onClickEvent=function(){this.fogBlock.click()},FogTile.prototype.isBorderFog=function(e){var t=Game.currentGame.map.getFog(this.x+e.x,this.y+e.y);return void 0===t||t.fogBlock!==this.fogBlock},FogTile.prototype.getFakeUnit=function(){var e=Game.currentGame;if(e.fogs.fakeUnits[this.x]
)return e.fogs.fakeUnits[this.x][this.y]},FogTile.prototype.updateState=function(e){this.onUpdateState(e)},FogTile.prototype.open=function(){Game.currentGame.map.remove(Map2d.LAYER_FOG,this.x,this.y);var e=this.getFakeUnit();if(e){var t=new Unit(e);t.setPosition(this.x,this.y),Game.currentGame.map.add(Map2d.LAYER_UNITS,this.x,this.y,t),Game.currentGame.map.onAdd(Map2d.LAYER_UNITS,this.x,this.y,t),Game.currentGame.onUnitAvailable(t),t.onFogOpen()}this.onOpen(),this.fogBlock=void 0};var FogBlockedGround=function(){FogBlock.call(this,FogBlockedGround.ID),this.state=FogBlock.CANTOPEN,this.updateBlockedGrounds()};FogBlockedGround.prototype=Object.create(FogBlock.prototype),(FogBlockedGround.prototype.constructor=FogBlockedGround).prototype.click=function(){Game.currentGame.onHintMessage(Messages.get("FogBlockedGround.clickMessage"))},FogBlockedGround.prototype.updateBlockedGrounds=function(){var r={},a=ISO_NEIGHBORS,c=[],n=0,l=Game.currentGame.map,s=function(e){var t=c[e].cell,n=c[e].status
;if(!(n<=(r[t.x+t.y*l.getWidth()]||0))&&l.isGround(t.x,t.y)){var s=l.getFog(t.x,t.y);if(!s||s.fogBlock===this){r[t.x+t.y*l.getWidth()]=n;var i=s?s.getFakeUnit():l.getUnit(t.x,t.y);i&&(i instanceof Unit&&i.findComponent(Grounded)||i.grounded)&&(n=1);for(var o=0;o<a.length;o++)c.push({cell:cc.p(t.x+a[o].x,t.y+a[o].y),status:n})}}}.bind(this);Object.keys(FogsConfig).forEach(function(e){var t=l.regions[e]&&l.regions[e].head;if(t&&!r[t.x+t.y*l.getWidth()])for(c.push({cell:t,status:2});n<c.length;)s(n++)});for(var e=l.onDiscoverView(),t=0;t<l.getHeight();t++)for(var i=0;i<l.getWidth();i++)1!==r[i+t*l.getWidth()]||l.getFog(i,t)||e&&!e.getCell(Map2d.LAYER_FOG,i,t)||this.add(i,t);this.tiles=this.tiles.filter(function(e){var t=1!==r[e.x+e.y*l.getWidth()];return t&&e.open(),!t})},FogBlockedGround.ID="blockedGroundFog";var FogBlockView=cc.Node.extend({ctor:function(e){this._super(),this.fogBlock=e,this.setCascadeColorEnabled(!0),this.setCascadeOpacityEnabled(!0),this.setAnchorPoint2(),
e.onOpen=this.onOpen.bind(this),e.onUpdateState=this.onUpdateState.bind(this),e.onUpdateConditions=this.onUpdateConditions.bind(this),e.onUpdatePromptFinger=this.updatePromptFinger.bind(this),e.onWandsChanged=this.onWandsChanged.bind(this),e.getProgressTarget=this.getProgressTarget.bind(this),this.onUpdateState(e.state,!0),this.onWandsChanged()},hideBlocker:function(){this.blocker&&(this.blocker.runAction(new cc.Sequence(new cc.ScaleTo(.2,0),new cc.RemoveSelf)),this.blocker=void 0)},getProgressTarget:function(){return this.opener},createBlocker:function(e,t){for(var n,s=cleverapps.styles.FogBlockView.blocker,i=[],o=0;o<e.length;o++){var r=new cc.Sprite(bundles.fog.frames.fog_blocker_png);if(i.push(r),r.setCascadeColorEnabled(!0),r.setCascadeOpacityEnabled(!0),e[o].hero&&(n=bundles.unit_icons.frames["small_icon_"+e[o].hero])){var a=new cc.Sprite(n);a.setPositionRound(s.icon.x,s.icon.y),r.addChild(a),cleverapps.UI.onClick(r,this.fogBlock.displayHeroCondition.bind(this.fogBlock,e[o]))}if(
e[o].level){var c=cleverapps.UI.generateImageText(e[o].level,cleverapps.styles.FONTS.FOG_BLOCKER_TEXT);c.setPositionRound(s.text.x,s.text.y),c.fitTo(s.content.width,s.content.height),r.addChild(c)}var l=new cc.Sprite(bundles.fog.frames.fog_blocker_cloud_png);l.setPositionRound(s.cloud.x,s.cloud.y),r.addChild(l)}this.blocker&&this.blocker.removeFromParent(),this.blocker=new cleverapps.Layout(i,{direction:cleverapps.UI.HORIZONTAL,margin:s.margin}),this.blocker.setCascadeColorEnabled(!0),this.blocker.setCascadeOpacityEnabled(!0),this.addChild(this.blocker),this.blocker.setPositionRound(s.position),t||(this.blocker.setScale(0),this.blocker.runAction(new cc.ScaleTo(.3,1))),cleverapps.config.debugMode&&cleverapps.UI.onClick(this.blocker,function(){this.lastClick>Date.now()-200?(Game.currentGame.addWands(this.fogBlock.options.price),this.fogBlock.open()):this.lastClick=Date.now()}.bind(this),{noThrottle:!0})},addBlocker:function(e,t){e===FogBlock.NOTREADY?this.createBlocker(
this.fogBlock.listNotFinishedConditions(),t):this.hideBlocker()},hideOpener:function(){this.opener&&(this.opener.runAction(new cc.Sequence(new cc.ScaleTo(.2,0),new cc.RemoveSelf)),this.opener=void 0)},hideOpenerWindow:function(){this.openerWindow&&(this.openerWindow.runAction(new cc.Sequence(new cc.ScaleTo(.2,0),new cc.RemoveSelf)),this.openerWindow=void 0)},onWandsChanged:function(){if(this.opener&&!this.fogBlock.isMoney()){var e=Game.currentGame.wands,t=this.fogBlock.getOpenPrice(),n=t<e?t:e;if(this.opener.currentAmount===n)return;this.opener.text.stopAllActions();var s=cleverapps.UI.generateImageText(n,cleverapps.styles.FONTS.WAND_PROGRESS_TEXT),i=cleverapps.UI.generateImageText("/"+t,cleverapps.styles.FONTS.WAND_PROGRESS_TEXT),o=new cleverapps.Layout([s,i],{direction:cleverapps.UI.HORIZONTAL});o.width>cleverapps.styles.FogBlockView.opener.text.width&&o.setScale(cleverapps.styles.FogBlockView.opener.text.width/o.width),this.opener.text.removeAllChildren(),this.opener.text.addChild(o
),this.opener.text.runAction(new cc.Sequence(new cc.ScaleTo(.15,1.4),new cc.ScaleTo(.15,1)));var r=e/t*100;void 0!==this.opener.lastPercent?this.opener.bar.animatedChange(r-this.opener.lastPercent):this.opener.bar.setPercentage(r),this.opener.lastPercent=r,this.opener.currentAmount=n}},addMoneyOpenner:function(e){var t=cleverapps.styles.FogBlockView.opener;this.opener=new cc.Node,this.opener.setAnchorPoint2(),this.opener.setContentSize2(t.size),this.opener.setPositionRound(t),this.addChild(this.opener);var n=new cc.Sprite(bundles.merge.frames.seller_icon);n.setPositionRound(t.money.sellerIcon),cleverapps.UI.onClick(n,this.handleBuy.bind(this)),cleverapps.UI.applyHover(n),this.opener.addChild(n),e||(this.opener.setScale(0),this.opener.runAction(new cc.ScaleTo(.3,1)))},handleBuy:function(){this.fogBlock.showBuyWindow()},addOpenner:function(e,t){if(e===FogBlock.CANTOPEN||e===FogBlock.CANOPEN){if(this.fogBlock.isMoney())return void this.addMoneyOpenner(t)
;var n=cleverapps.styles.FogBlockView.opener;if(!this.opener){this.opener=cleverapps.UI.createScale9Sprite(bundles.merge.frames.bar_bg_png),this.opener.setContentSize2(n.size),this.opener.setPositionRound(n),this.addChild(this.opener),this.opener.bar=new ScaledProgressBar(bundles.merge.frames.bar_png),this.opener.bar.setDimension(n.bar.size),this.opener.bar.setPositionRound(n.bar),this.opener.addChild(this.opener.bar);var s=new cc.Sprite(bundles.menubar.frames.merge_wand_png);s.setPositionRound(n.icon),s.setScale(n.icon.scale),this.opener.addChild(s),this.opener.text=new cc.Node,this.opener.text.setAnchorPoint2(),this.opener.text.setPositionRound(n.text),this.opener.addChild(this.opener.text),this.onWandsChanged(),t||(this.opener.setScale(0),this.opener.runAction(new cc.ScaleTo(.3,1)))}}else this.hideOpener()},addOpennerWindow:function(e,t){if(e!==FogBlock.CANOPEN||this.fogBlock.isMoney())this.hideOpenerWindow();else{var n=cleverapps.styles.FogBlockView.openerWindow,
s=cleverapps.styles.CommonButtons;this.openerWindow=cleverapps.UI.createScale9Sprite(bundles.mergeui.frames.background);var i=cleverapps.UI.generateOnlyText(Messages.get("Fog.clear"),cleverapps.styles.FONTS.INFO_TEXT),o=cleverapps.UI.generateImageText(this.fogBlock.getOpenPrice(),cleverapps.styles.FONTS.LIGHT_BUTTON_IMAGE_TEXT),r=new cc.Sprite(bundles.fog.frames.button_wand_png),a=new cleverapps.Layout([r,o],{direction:cleverapps.UI.HORIZONTAL,margin:s.margin}),c=this.openerWindow.button=new cleverapps.UI.Button({width:n.button.width,height:n.button.height,padding:s.padding,contentOffset:s.contentOffset,fitTo:s.fitTo,content:a,ignoreOnTouchMoved:!0,onClicked:this.handleOpen.bind(this),button_images:cleverapps.UI.Button.Images.button_green});c.adviceTarget="openfog";var l=new cleverapps.Layout([c,i],{direction:cleverapps.UI.VERTICAL,margin:n.content.margin,padding:n.content.padding});this.openerWindow.setContentSize(l.getContentSize()),this.openerWindow.addChild(l),l.setPositionRound(
this.openerWindow.width/2,this.openerWindow.height/2);var p=new cc.Sprite(bundles.mergeui.frames.pointer);p.setAnchorPoint2(),p.setPositionRound(l.width/2,n.pointer.dy),p.setLocalZOrder(-1),l.addChild(p),this.addChild(this.openerWindow),this.openerWindow.setPositionRound(n),t||(this.openerWindow.setScale(0),this.openerWindow.runAction(new cc.ScaleTo(.3,1))),this.updatePromptFinger()}},updatePromptFinger:function(){if(this.openerWindow&&!this.openerWindow.button.finger&&!Game.currentGame.tutorial.isActive()&&this.fogBlock===Game.currentGame.fogs.findAvailableFogBlock()){var e=this.openerWindow.button.finger=new FingerView({scaleX:.8,scaleY:.8});this.openerWindow.button.addChild(e),e.setPositionRound(this.openerWindow.button.width/2,this.openerWindow.button.height/2),e.standardLoop({delay:2})}},onUpdateState:function(e,t){this.addBlocker(e,t),this.addOpenner(e,t),this.addOpennerWindow(e,t)},onUpdateConditions:function(e){this.addBlocker(e,!0)},handleOpen:function(){this.fogBlock.open()},
onOpen:function(){this.fogBlock.clear(),this.fogBlock=void 0,this.hideBlocker(),this.hideOpener(),this.hideOpenerWindow()}});cleverapps.overrideFonts(cleverapps.styles.FONTS,{FOG_BLOCKER_TEXT:{name:"nostroke",size:36,color:cleverapps.styles.COLORS.LIGHT_TEXT_COLOR},WAND_PROGRESS_TEXT:{name:"default",size:30},BUY_BUTTON_TEXT:{size:30,color:cleverapps.styles.COLORS.LIGHT_TEXT_COLOR,stroke:cleverapps.styles.DECORATORS.LIGHT_TEXT_STROKE,shadow:cleverapps.styles.DECORATORS.LIGHT_TEXT_SHADOW}}),cleverapps.styles.FogBlockView={openerWindow:{x:{align:"center"},y:{align:"top",dy:250},pointer:{dy:-6},content:{margin:15,padding:{x:20,y:20}},button:{width:160,height:60}},opener:{x:{align:"center"},y:{align:"top",dy:70},size:{width:200,height:40},text:{width:130,x:{align:"center"},y:{algin:"center",dy:2}},icon:{x:{align:"left",dx:-42},y:{algin:"center",dy:0},scale:.8},bar:{size:{width:190,height:32},x:5,y:6},money:{sellerIcon:{x:{align:"center",dx:30},y:{align:"center"}}}},blocker:{margin:16,
content:{width:44,height:44},position:{x:{align:"center"},y:{align:"center",dy:100}},text:{x:{align:"center",dx:7},y:{align:"center",dy:-29}},icon:{x:{align:"center",dx:4},y:{align:"center",dy:-28}},cloud:{x:{align:"center",dx:1},y:{align:"bottom",dy:-1}}}};var FogTileView=cc.Node.extend({ctor:function(e){if(this._super(),this.fogTile=e,this.setCascadeColorEnabled(!0),this.setCascadeOpacityEnabled(!0),this.setAnchorPoint2(),this.setContentSize2(cleverapps.styles.Map2dView.cell),this.tileView=new cc.Node,this.tileView.setCascadeColorEnabled(!0),this.tileView.setCascadeOpacityEnabled(!0),this.tileView.setContentSize2(this.getContentSize()),this.tileView.setPositionRound(this.width/2,this.height/2),this.addChild(this.tileView),e.onOpen=this.onOpen.bind(this),e.onUpdateState=this.onUpdateState.bind(this),e.onClick=this.onClick.bind(this),this.onUpdateState(e.fogBlock.state,!0),e.isHead&&!e.fogBlock.options.headless&&!cleverapps.config.editorMode){var t=new FogBlockView(e.fogBlock)
;t.setPositionRound(this.width/2,this.height/2),this.addChild(t)}},onClick:function(){this.fogTile.fogBlock.isMoney()&&this.fogTile.fogBlock.state===FogBlock.CANOPEN?this.fogTile.fogBlock.showBuyWindow():this.clickAnimation()},onUpdateState:function(e,t){if(e===FogBlock.CANTOPEN||e===FogBlock.CANOPEN){if(this.state!==FogTileView.GROUND_STATE){if(this.state===FogTileView.FULL_STATE){this.sprite.removeFromParent();for(var n=0;n<this.borders.length;n++)this.borders[n].removeFromParent();this.borders=[]}this.tileView.setAnchorPoint2(),this.sprite=new cc.Sprite(bundles.fog.frames.fog2_png);var s=Game.currentGame.map.getView().getCell(Map2d.LAYER_GROUND,this.fogTile.x,this.fogTile.y);if(this.sprite.setPositionRound(s.width/2,s.height/2),s.addChild(this.sprite),this.fogTile.fogBlock.isMoney()){this.sprite.setColor(new cc.Color(255,150,255,255));var i=new cleverapps.Spine(bundles.merge.jsons.buy_fog_tile_json);i.setTimeScale(.5+Math.random()),i.setPositionRound(this.sprite.width/2,
this.sprite.height/2),this.sprite.addChild(i),i.setAnimation(0,"animation",!0)}this.state=FogTileView.GROUND_STATE;var o=this.fogTile.getFakeUnit();if(o){var r=this.unitNode=new cc.Node;r.setPositionRound(this.tileView.width/2,this.tileView.height/2),r.setCascadeOpacityEnabled(!0),r.setCascadeColorEnabled(!0),r.setOpacity(120),this.fogTile.fogBlock.isMoney()?r.setColor(new cc.Color(255,100,100,255)):r.setColor(new cc.Color(0,150,255,255)),this.tileView.addChild(r);var a=UnitView.getUnitStyles(o);r.setAnchorPoint2(a.anchorX,a.anchorY);var c=UnitView.getUnitImage(o);if(r.setContentSize(c.getContentSize()),c.setPositionRound(r.width/2,r.height/2),r.addChild(c),c.clearTrack&&c.clearTrack(0),o.grounded){var l=new cc.Sprite(GroundedView.getImage());l.setOpacity(130);var p=r.getAnchorPoint();l.setPositionRound(r.width*p.x,r.height*p.y),r.addChild(l)}o.multicell&&MultiCellView(o.multicell,r)}}this.runRepeatAnimation(e)}else if(this.state!==FogTileView.FULL_STATE){
a=cleverapps.styles.FogTileView.borders;this.tileView.setAnchorPoint2(cleverapps.styles.FogTileView.anchorX,cleverapps.styles.FogTileView.anchorY),this.sprite=new cc.Sprite(bundles.fog.frames.fog_png),this.sprite.setPositionRound(a.center),this.tileView.addChild(this.sprite),this.borders=[];var d={down_left:{x:-1,y:0},down_right:{x:0,y:1},up_left:{x:0,y:-1},up_right:{x:1,y:0}};for(var u in d)if(this.fogTile.isBorderFog(d[u])){var h=new cc.Sprite(bundles.fog.frames["fog_"+u+"_png"]);h.setPositionRound(a[u]),this.tileView.addChild(h),this.borders.push(h)}this.state=FogTileView.FULL_STATE}},runRepeatAnimation:function(e){e!==FogBlock.CANOPEN||this.fogTile.fogBlock.options.headless||this.fogTile.fogBlock.isMoney()||(this.tileView.stopAllActions(),this.tileView.runAction(new cc.RepeatForever(new cc.Sequence(new cc.FadeTo(1,255),new cc.FadeTo(2,70).easing(cc.easeIn(1.5))))))},clickAnimation:function(){var e=this;this.state===FogTileView.GROUND_STATE&&(e=this.sprite),
this.tileView.stopAllActions();var t,n=this.fogTile.fogBlock.state,s=230;n!==FogBlock.CANTOPEN&&n!==FogBlock.CANOPEN||(s=210),t=new cc.Sequence(new cc.TintTo(.3,s,s,s),new cc.TintTo(.3,255,255,255)),e.runAction(new cc.Sequence(t,t,t,t,t,new cc.CallFunc(function(){this.runRepeatAnimation(n)}.bind(this))))},onOpen:function(){this.fogTile.clear(),this.fogTile=void 0,this.stopAllActions(),this.runAction(new cc.Sequence(new cc.DelayTime(.3),new cc.RemoveSelf)),this.sprite.stopAllActions(),this.sprite.runAction(new cc.Sequence(new cc.FadeOut(.2),new cc.RemoveSelf)),this.unitNode&&(this.unitNode.removeFromParent(),this.unitNode=void 0),this.tileView.stopAllActions(),this.tileView.runAction(new cc.FadeOut(.2))}});FogTileView.FULL_STATE=0,FogTileView.GROUND_STATE=1,cleverapps.styles.FogTileView={anchorX:.5,anchorY:.22,borders:{center:{x:{align:"center",dx:1},y:{align:"center",dy:-13}},down_left:{x:{align:"left",dx:-12},y:{align:"bottom",dy:-32}},down_right:{x:{align:"right",dx:10},y:{
align:"bottom",dy:-36}},up_left:{x:{align:"left",dx:-12},y:{align:"top",dy:4}},up_right:{x:{align:"right",dx:16},y:{align:"top",dy:10}}}};var QuestsConfig={wheat_3:{trigger:{unit:{code:"dwarf",stage:1}},tutorial:"wheat_3",quest:{silent:!0,type:Merge.SPAWN,unit:{code:"wheat",stage:3}}},dishes_0:{trigger:{unit:{code:"wheat",stage:3}},tutorial:"dishes_0",quest:{type:Merge.SPAWN,unit:{code:"dishes",stage:0}}},woodsource_1_0:{trigger:{unit:{code:"woodsource",stage:1}},quest:{type:Merge.OPENFOG}},woodsource_1_1:{trigger:{unit:{code:"woodsource",stage:1}},tutorial:"woodsource_1_1",quest:{type:Merge.MINE,unit:{code:"woodsource",stage:1}}},candies_4:{trigger:{unit:{code:"candies",stage:4}},quest:{type:Merge.HARVEST,unit:{code:"candies",stage:4}}},wheat_4:{trigger:{unit:{code:"wood",stage:8}},quest:{type:Merge.HARVEST,unit:{code:"wheat",stage:4}}},dragonisland_1:{trigger:{unit:{code:"king",stage:3}},quest:{type:Merge.OPENDRAGON,attentionTo:function(){return Game.currentGame.fogs.getBlockById(
"dragonIsland").head}}}};Object.keys(Families).forEach(function(e){var s=Families[e];-1!==["hero","resource","magicplant"].indexOf(s.type)&&Unit.getAllStagesTargets(e).filter(function(e){return 0!==e.stage&&!s.units[e.stage].temporary&&("dwarf"!==e.code&&!QuestsConfig[Unit.GetKey(e)]||void 0)}).forEach(function(e){var t=s.units[e.stage],n=t.buildable&&0<cleverapps.parseInterval(t.buildable);QuestsConfig[Unit.GetKey(e)]={trigger:{unit:{code:e.code,stage:e.stage-1}},quest:{type:n?Merge.BUILD:Merge.SPAWN,unit:e}},"magicplant"===s.type&&1===e.stage&&delete QuestsConfig[Unit.GetKey(e)].trigger})}),function(){var s=cc.loader.getRes(bundles.main.jsons.quests_data_json).quests;Object.keys(QuestsConfig).forEach(function(e){var t=QuestsConfig[e];t.quest.id=e;var n=s[e];n?(t.dialogue=n.dialogue,void 0!==n.goal?(t.quest.goal=n.goal,void 0!==n.prize?t.quest.prize=n.prize:console.error("No prize specified for quest '"+e+"'")):console.error("No goal specified for quest '"+e+"'")):console.error(
"No data for quest '"+e+"'")})}();var MergeAdviceBaseLogic=function(e){var t=cleverapps.toArray(e&&e.targets);t&&0<t.length&&(this.targets=t);var n=cleverapps.toArray(e&&e.priority);n&&0<n.length&&(this.priority={},n.forEach(function(e,t){this.priority[Unit.GetKey(e)]=t+1},this))};MergeAdviceBaseLogic.prototype.findMove=function(){},MergeAdviceBaseLogic.prototype.listAvailableUnits=function(){var e=Game.currentGame.map.listAvailableUnits();if(this.targets){var n={};this.targets.forEach(function(e){n[Unit.GetKey(e)]=[]}),e.forEach(function(e){var t=Unit.GetKey(e);n[t]&&n[t].push(e)}),e=this.targets.reduce(function(e,t){return e.concat(n[Unit.GetKey(t)])},[])}return this.priority&&(e=e.sort(function(e,t){return this.getPriorityIndex(e)-this.getPriorityIndex(t)}.bind(this))),e},MergeAdviceBaseLogic.prototype.isPriorityUnit=function(e){return this.getPriorityIndex(e)<1e4},MergeAdviceBaseLogic.prototype.getPriorityIndex=function(e){return this.priority&&this.priority[Unit.GetKey(e)]||1e4}
;var MergeAdviceMergeLogic=function(e){MergeAdviceBaseLogic.call(this,e)};MergeAdviceMergeLogic.prototype=Object.create(MergeAdviceBaseLogic.prototype),(MergeAdviceMergeLogic.prototype.constructor=MergeAdviceMergeLogic).prototype.findMove=function(){var l=function(e){return 3<=e.cells.length},e=function(e){var t=[];if(cleverapps.values(e).forEach(function(e){t=t.concat(e)}),0!==t.length){var n=t.filter(l),s=[];if(n.length){var i=function(e){for(var t=0;t<e.length;t++)if(e[t].isScreenCluster())return e[t]}(n);s=this.merge(i||n[this.indexOfNearestCluster(n)])}else{var o=this.chooseBiggerClustersFamily(e);if(3<=o.amount){var r=o.clusters.slice(),a=this.indexOfNearestCluster(r),c=r[a];r.splice(a,1),r.length&&(s=this.combine([c,r[this.indexOfNearestCluster(r)]])),0===s.length&&(s=this.combine(o.clusters))}}return s&&2<=s.length?{cells:s}:void 0}}.bind(this),t=this.getClusters(),n={},s=t;if(this.priority)for(var i in s={},t){(this.priority[i]?n:s)[i]=t[i]}return e(n)||e(s)},
MergeAdviceMergeLogic.prototype.merge=function(e){cleverapps.Random.seed(100*e.cells.length+e.stage);var r=cleverapps.shuffle(e.cells.slice()),a=Game.currentGame.map,n=r.filter(function(e,t){var n=a.getUnit(e.x,e.y);a.layers[Map2d.LAYER_UNITS][e.y][e.x]=void 0;var s=r[(t+1)%r.length],i=a.getUnit(s.x,s.y).listMergeAtPoint(s.x,s.y),o=i&&r.length-1===i.length;return a.layers[Map2d.LAYER_UNITS][e.y][e.x]=n,o},this)[0];if(n){var t=cleverapps.shuffle(e.cells.slice()).filter(function(t){return ISO_NEIGHBORS.some(function(e){return n.x+e.x===t.x&&n.y+e.y===t.y})})[0];return[n,t]}},MergeAdviceMergeLogic.prototype.getClusters=function(){var i={},o={},r={};if(this.listAvailableUnits().forEach(function(e){if(!o[e.x+1e4*e.y]&&e.isMergeable(e)){var t=e.listMergeAtPoint(e.x,e.y)||[cc.p(e.x,e.y)],n=new MergeAdviceMergeLogic.Cluster(e.code,e.stage,t);t.forEach(function(e){o[e.x+1e4*e.y]=!0});var s=e.getKey();i[s]||(i[s]=[]),i[s].push(n),r[e.code]||(r[e.code]=cleverapps.arrayFill(
Families[e.code].units.length,0)),r[e.code][e.stage]+=t.length}},this),this.hintActive){Object.keys(r).forEach(function(e){for(var t=0;t<r[e].length&&!(3<=r[e][t]);t++);r[e]=t});var n={};Object.keys(i).forEach(function(e){var t=Unit.ParseKey(e);r[t.code]===t.stage&&(n[e]=i[e])}),i=n}return i},MergeAdviceMergeLogic.prototype.indexOfNearestCluster=function(e){for(var n,s=Game.currentGame.map.getScreenCenterCell(),i=-1,o=0;o<e.length;o++)e[o].cells.forEach(function(e){var t=Math.abs(e.x-s.x)+Math.abs(e.y-s.y);(!n||t<n)&&(n=t,i=o)});return i},MergeAdviceMergeLogic.prototype.chooseBiggerClustersFamily=function(e){var t,n;for(var s in e){var i=e[s],o=0;i.forEach(function(e){o+=e.cells.length}),(!n||n<o)&&(t=i,n=o)}return{clusters:t,amount:n}},MergeAdviceMergeLogic.prototype.combine=function(e){var t=(e=e.slice().sort(function(e,t){return e.cells.length-t.cells.length})).reverse().filter(function(e){return 2<=e.cells.length||this.findCombineAdjacentCell(e.cells[0])},this)[0],n=e.filter(
function(e){return e!==t})[0];if(t&&n)return cleverapps.Random.seed(100*e.length+n.stage),[cleverapps.Random.choose(n.cells),2<=t.cells.length?cleverapps.Random.choose(t.cells):this.findCombineAdjacentCell(t.cells[0])]},MergeAdviceMergeLogic.prototype.findCombineAdjacentCell=function(s){var i,o,r=Game.currentGame.map;return[{x:0,y:1},{x:0,y:-1},{x:1,y:0},{x:-1,y:0}].forEach(function(e){var t=cc.p(s.x+e.x,s.y+e.y);if(r.isGround(t.x,t.y)&&!r.getFog(t.x,t.y)){var n=r.getUnit(t.x,t.y);n?n.isMoveable()&&(o=t):i=t}},this),i||o},MergeAdviceMergeLogic.Cluster=function(e,t,n){this.code=e,this.stage=t,this.cells=n},MergeAdviceMergeLogic.Cluster.prototype.isScreenCluster=function(){return this.cells.every(function(e){return Game.currentGame.map.isScreenCell(e.x,e.y)})},MergeAdviceMergeLogic.Cluster.prototype.isAnyCellOnScreen=function(){return this.cells.some(function(e){return Game.currentGame.map.isScreenCell(e.x,e.y)})};var MergeAdviceSpawnLogic=function(e){MergeAdviceBaseLogic.call(this,e)
;var t=cleverapps.toArray(e&&e.prizes);t&&0<t.length&&(this.prizes=t)};MergeAdviceSpawnLogic.prototype=Object.create(MergeAdviceBaseLogic.prototype),(MergeAdviceSpawnLogic.prototype.constructor=MergeAdviceSpawnLogic).prototype.checkUnitPrizes=function(e){if("dishes"===e.code||"chest"===e.getType())return!0;var t=e.prizes||[];if("hero"===e.getType()&&0===t.length){var n=e.findComponent(MakesOrder);n.state===MakesOrder.STATE_EMPTY&&n.order();var s=n.getPrizeUnitInfo();s&&t.push(s)}return 0<t.length&&(!this.prizes||cleverapps.contains(t,this.prizes,Unit.GetKey))},MergeAdviceSpawnLogic.prototype.findMove=function(){var e=this.listAvailableUnits().filter(this.checkUnitPrizes.bind(this))[0],t={};e&&Game.currentGame.map.findEmptySlot(e.x,e.y)&&(t.cells=[cc.p(e.x,e.y)]);var n=cleverapps.windows.currentWindow();if((n instanceof OrdersWindow&&e&&"hero"===e.getType()||n instanceof OpenChestWindow&&e&&"chest"===e.getType())&&(t.window=Merge.SPAWN),t.cells||t.window)return t}
;var MergeAdviceHarvestLogic=function(e){MergeAdviceBaseLogic.call(this,e)};MergeAdviceHarvestLogic.prototype=Object.create(MergeAdviceBaseLogic.prototype),(MergeAdviceHarvestLogic.prototype.constructor=MergeAdviceHarvestLogic).prototype.findMove=function(){var e=this.listAvailableUnits().filter(function(e){return e.getData().collectible||e.getData().divideCollectible||e.getData().resourceCollectible},this)[0];if(e)return{cells:[cc.p(e.x,e.y)]}};var MergeAdviceMineLogic=function(e){MergeAdviceBaseLogic.call(this,e)};MergeAdviceMineLogic.prototype=Object.create(MergeAdviceBaseLogic.prototype),(MergeAdviceMineLogic.prototype.constructor=MergeAdviceMineLogic).prototype.findMove=function(){var e=this.listAvailableUnits().map(function(e){return e.findComponent(Mineable)}).filter(function(e){return e&&e.state===Mineable.STATES.WAIT}).sort(function(e,t){return t.mined-e.mined})[0];if(e)return{cells:[cc.p(e.unit.x,e.unit.y)],unitView:["energy"]}};var MergeAdviceOpenFogLogic=function(e){
MergeAdviceBaseLogic.call(this,e)};MergeAdviceOpenFogLogic.prototype=Object.create(MergeAdviceBaseLogic.prototype),(MergeAdviceOpenFogLogic.prototype.constructor=MergeAdviceOpenFogLogic).prototype.findMove=function(){for(var e=0;e<this.targets.length;++e){var t=Game.currentGame.fogs.blocks[this.targets[e]];if(t&&t.head&&t.state===FogBlock.CANOPEN)return{cells:[cc.p(t.head.x,t.head.y)],fogView:["openfog"]}}};var MergeAdviceSpeedupLogic=function(e){MergeAdviceBaseLogic.call(this,e)};MergeAdviceSpeedupLogic.prototype=Object.create(MergeAdviceBaseLogic.prototype),(MergeAdviceSpeedupLogic.prototype.constructor=MergeAdviceSpeedupLogic).prototype.findMove=function(){for(var e=Game.currentGame.workers.listBusy().sort(function(e,t){return e.getTimeLeft()-t.getTimeLeft()}),t=0;t<e.length;++t){var n=e[t],s=n.unit.findComponent(Buildable);if(s&&0!==s.time)return{cells:[cc.p(n.unit.x,n.unit.y)],unitView:["speedup"]};var i=n.unit.findComponent(Mineable);if(i&&0!==cleverapps.parseInterval(i.getTask(
).time))return{cells:[cc.p(n.unit.x,n.unit.y)],unitView:["speedup"]}}};var MergeAdviceBuildLogic=function(e){MergeAdviceBaseLogic.call(this,e)};MergeAdviceBuildLogic.prototype=Object.create(MergeAdviceBaseLogic.prototype),(MergeAdviceBuildLogic.prototype.constructor=MergeAdviceBuildLogic).prototype.findMove=function(){var e=this.listAvailableUnits().filter(function(e){return!Buildable.IsBuilt(e)&&!Game.currentGame.workers.findAssigned(e)})[0];if(e)return{cells:[cc.p(e.x,e.y)],unitView:["build"]}};var MergeAdvice=function(){cleverapps.EventEmitter.call(this),this.logics=[],Game.currentGame.map.on("changeDragging",this.onChangeDragging.bind(this))};MergeAdvice.prototype=Object.create(cleverapps.EventEmitter.prototype),(MergeAdvice.prototype.constructor=MergeAdvice).prototype.setLogic=function(e,t){var n,s=[];switch(e){case Merge.MERGE:n=MergeAdviceMergeLogic;break;case Merge.SPAWN:n=MergeAdviceSpawnLogic;break;case Merge.HARVEST:n=MergeAdviceHarvestLogic;break;case Merge.OPENFOG:
n=MergeAdviceOpenFogLogic;break;case Merge.START_MINING:n=MergeAdviceMineLogic;break;case Merge.SPEED_UP:n=MergeAdviceSpeedupLogic;break;case Merge.START_BUILDING:n=MergeAdviceBuildLogic}n&&s.push(new n(t)),this.logics=s},MergeAdvice.prototype.onChangeDragging=function(e){e&&this.boo()},MergeAdvice.prototype.clear=function(){this.stopHint()},MergeAdvice.prototype.boo=function(){this.hintActive&&(this.trigger("hideHint"),clearTimeout(this.showHintTimeout),this.showHintTimeout=setTimeout(this.showHint.bind(this),MergeAdvice.SCARED_TIMEOUT))},MergeAdvice.prototype.showHint=function(){if(this.hintActive){var e,t=Game.currentGame.map,n=!t.dragging;this.trigger("hideHint",n),t.dragging||(e=this.findMove()),e&&this.trigger("showHint",e),clearTimeout(this.showHintTimeout),this.showHintTimeout=setTimeout(this.showHint.bind(this),2e3)}},MergeAdvice.prototype.startHint=function(){this.hintActive||(this.hintActive=!0,this.showHint())},MergeAdvice.prototype.stopHint=function(){this.hintActive&&(
delete this.idleHintActive,delete this.hintActive,clearTimeout(this.showHintTimeout),this.trigger("hideHint"))},MergeAdvice.prototype.findMove=function(){for(var e=0;e<this.logics.length;++e){var t=this.logics[e].findMove();if(t)return t}},MergeAdvice.prototype.hasHints=function(){return 0<this.logics.length},MergeAdvice.prototype.stopIdleHint=function(){this.idleHintActive&&this.stopHint()},MergeAdvice.prototype.startIdleHint=function(){if(!this.hintActive&&Game.currentGame.gameLevel.getLevel()<=6){var e=Game.currentGame.fogs.findBlockWithProgress();if(e){var t=Game.currentGame.map.listAvailableUnits({code:"wands"}).reduce(function(e,t){return e+t.getData().value},0);Game.currentGame.wands+t>=e.getOpenPrice()&&(this.setLogic(Merge.HARVEST,{targets:Unit.getAllStagesTargets("wands")}),this.idleHintActive=!0,this.startHint())}}},MergeAdvice.SCARED_TIMEOUT=1e3;var MergeAdviceView=function(e,t){this.advice=e,this.mapView=t.map,this.advice.on("showHint",this.showHint.bind(this),t),
this.advice.on("hideHint",this.hideHint.bind(this),t)};MergeAdviceView.prototype.findAdviceTarget=function(e,t){t=cleverapps.toArray(t);for(var n=[e];0<n.length;){var s=n.pop();if(s.adviceTarget&&t.some(function(e){return e===s.adviceTarget}))return s;n=n.concat(s.children),s.additionalViews&&Object.keys(s.additionalViews).forEach(function(e){n.push(s.additionalViews[e])})}},MergeAdviceView.prototype.showHint=function(e){if(e.window){var t=cleverapps.windows.currentWindow();if(t){var n=this.findAdviceTarget(t,e.window);if(n)return void this.showButtonHint(n)}}if(e.fogView){var s=this.mapView.getCell(Map2d.LAYER_FOG,e.cells[0].x,e.cells[0].y);if(s&&(n=this.findAdviceTarget(s,e.fogView)))return void this.showButtonHint(n)}if(e.unitView){var i=this.mapView.getCell(Map2d.LAYER_UNITS,e.cells[0].x,e.cells[0].y);if(i&&(n=this.findAdviceTarget(i,e.unitView)))return void this.showButtonHint(n)}e.cells&&this.showCellHint(e.cells)},MergeAdviceView.prototype.showButtonHint=function(e){
var t=new FingerView;t.setLocalZOrder(100),t.setCascadeOpacityEnabled(!0),t.moveSpeed=MergeAdviceView.HINT_SPEED,e.addChild(t),t.delay(.2),t.fadeIn(cc.p(e.width/2,e.height/2)),t.press(),t.delay(.3),t.unPress(),t.fadeOut(),t.delay(.8),t.runOnce(t.removeFromParent.bind(t)),this.hintFinger&&this.hintFinger.removeFromParent(),this.hintFinger=t},MergeAdviceView.prototype.showCellHint=function(e){var t=new FingerView;t.setLocalZOrder(100),t.setCascadeOpacityEnabled(!0),t.moveSpeed=MergeAdviceView.HINT_SPEED,this.mapView.animations.addChild(t),t.delay(.2),t.fadeIn(this.mapView.alignInIsometricGrid(e[0].x,e[0].y)),t.press(),t.delay(.3),2<=e.length&&t.moveTo(this.mapView.alignInIsometricGrid(e[1].x,e[1].y)),t.unPress(),t.fadeOut(),t.delay(.8),t.runOnce(t.removeFromParent.bind(t)),this.hintFinger&&this.hintFinger.removeFromParent(),this.hintFinger=t},MergeAdviceView.prototype.hideHint=function(e){var t=this.hintFinger;t&&(t.clearActions(),e?t.removeFromParent():t.runAction(new cc.Sequence(
new cc.FadeOut(.2),new cc.RemoveSelf)))},MergeAdviceView.RUN_SPEED=1e3,MergeAdviceView.HINT_SPEED=500;var ViewFactory=function(e,t){if(e instanceof Fruit){var n=new FruitView(e);n.setPositionRound(t.width/2,t.height/2),t.addChild(n)}if(e instanceof Shine&&ShineView(t),e instanceof Dish&&DishView(e,t),e instanceof Mineable){var s=new MineableView(e,t);s.setPositionRound(t.width/2,t.height/2),t.addChild(s)}if(e instanceof Buildable&&!e.isCompleted()){var i=new BuildableView(e,t);i.setPositionRound(t.width/2,t.height/2),t.addChild(i)}if(e instanceof Collectible&&CollectibleView(e,t),e instanceof DivideCollectible&&DivideCollectibleView(e,t),e instanceof ResourceCollectible&&ResourceCollectibleView(e,t),e instanceof Pulsing&&PulsingView(e,t),e instanceof Bubble&&BubbleView(e,t),e instanceof Chest&&ChestView(e,t),e instanceof Generator){var o=new GeneratorView(e,t);o.setPositionRound(t.width/2,t.height/2),t.addChild(o)}if(e instanceof Castle){var r=new CastleView(e);r.setPositionRound(
t.width/2,t.height/2),t.addChild(r)}if(e instanceof MiniGame){var a=new MiniGameView(e);a.setPositionRound(t.width/2,t.height/2),t.addChild(a)}if(e instanceof Upgradable){var c=new UpgradableView(e,t);c.setPositionRound(t.width/2,t.height/2),t.addChild(c,1)}if(e instanceof Grounded){var l=new GroundedView(e),p=Game.currentGame.map.getView().getCell(Map2d.LAYER_GROUND,t.unit.x,t.unit.y);l.setPositionRound(p.width/2,p.height/2),p.addChild(l)}if(e instanceof MakesOrder){var d=new MakesOrderView(e,t);d.setPositionRound(t.width/2,t.height/2),t.addChild(d)}if(e instanceof MultiCell&&MultiCellView(e.shape,t),e instanceof InstantWorker){var u=new InstantWorkerView(e,t);u.setPositionRound(t.width/2,t.height/2),t.addChild(u)}if(e instanceof SpecialOffer){var h=new SpecialOfferView(e,t);h.setPositionRound(t.width/2,t.height/2),t.addChild(h)}if(e instanceof MagicPlant){var g=new MagicPlantView(e);g.setPositionRound(t.width/2,t.height/2),t.addChild(g)}},PulsingView=function(e,t){
e.init=PulsingView.init.bind(this,e,t),e.init()};PulsingView.init=function(t,e){Buildable.IsBuilt(t.unit)&&("resource"!==t.unit.getType()||0<Game.currentGame.map.listAvailableUnits().filter(function(e){return e.code===t.unit.code&&e.isUpgradable()}.bind(this)).length)&&PulsingView.create(t,e)},PulsingView.create=function(e,t){var n=new cleverapps.Spine(bundles.merge.jsons.flickering_json),s=t.getAnchorPoint();n.setPositionRound(t.width*s.x+cleverapps.styles.PulsingView.flickering.x,t.height*s.y+cleverapps.styles.PulsingView.flickering.y),n.setLocalZOrder(-1),n.setAnimation(0,"animation",!0),t.addChild(n),e.beforeCollect=function(){n&&(n.replaceParentSamePlace(t.getParent()),n.setCompleteListenerRemove(),n=void 0)},t.runAction(new cc.Sequence(new cc.DelayTime(.8),new cc.CallFunc(function(){t.sprite.runAction(new cc.RepeatForever(new cc.Sequence(new cc.ScaleTo(.7,1.1),new cc.ScaleTo(.7,1))))})))},cleverapps.styles.PulsingView={flickering:{x:2,y:4}};var BubbleView=function(e,t){
var n=new cleverapps.Spine(bundles.merge.jsons.recipe_bubble_down_json);n.setPositionRound(cleverapps.styles.BubbleView.animation),n.setLocalZOrder(-1),n.setAnimation(0,"idle",!0),t.addChild(n);var s=new cleverapps.Spine(bundles.merge.jsons.recipe_bubble_up_json);s.setPositionRound(cleverapps.styles.BubbleView.animation),s.setLocalZOrder(1),s.setAnimation(0,"idle",!0),t.addChild(s),t.setAnchorPoint2(),t.sprite.setScale(.8),t.sprite.y+=cleverapps.styles.BubbleView.unit.dy,t.sprite.runAction(new cc.RepeatForever(new cc.Sequence(new cc.RotateBy(2,-5),new cc.RotateBy(4,10),new cc.RotateBy(2,-5)))),t.sprite.runAction(new cc.RepeatForever(new cc.Sequence(new cc.MoveBy(.9,0,cleverapps.styles.BubbleView.unit.moveY/2),new cc.MoveBy(1.8,0,-cleverapps.styles.BubbleView.unit.moveY),new cc.MoveBy(.9,0,cleverapps.styles.BubbleView.unit.moveY/2)))),e&&(e.beforeCollect=function(){t.sprite.stopAllActions(),n&&(n.replaceParentSamePlace(t.getParent()),n.setAnimation(0,"disappearance",!1),
n.setCompleteListenerRemove(),n=void 0),s&&(s.replaceParentSamePlace(t.getParent()),s.setAnimation(0,"disappearance",!1),s.setCompleteListenerRemove(),s=void 0)})};cleverapps.styles.BubbleView={animation:{x:{align:"center"},y:{align:"center",dy:35}},unit:{moveY:6,dy:37}};var ShineView=function(e){var t=new cleverapps.Spine(bundles.shine.jsons.shine_animation_json);t.setAnimation(0,"animation",!0),t.setPositionRound(e.width/2,e.height/2),e.addChild(t)},CollectibleView=function(e,t){e.onCollection=CollectibleView.collectionAnimation.bind(e,t)};CollectibleView.GetCollectAnimationOptions=function(e){if("fruit"===e.unit.getType())return{target:cleverapps.styles.SideBarIconView.orders,sound:bundles.collectible.urls.fruit_fly_finish_effect,targetEffect:!0};switch(e.unit.code){case"coins":return{target:cleverapps.styles.MenuBar.CoinsItem.target};case"rubies":return{target:cleverapps.styles.MenuBar.GoldItem.target}}return{target:cleverapps.styles.MenuBar.GameLevelItem.target}},
CollectibleView.collectionAnimation=function(e){var t=CollectibleView.GetCollectAnimationOptions(this),n=new cc.Node;if(n.setAnchorPoint2(),n.setPosition(e.getPosition()),e.getParent().addChild(n),e.replaceParentSamePlace(n,{keepScale:!0}),cleverapps.config.wysiwygMode&&cleverapps.flags.wysiwyg.customCollectAnimation){var s=cleverapps.styles.AdsMap2d.collectAnimation,i=new cleverapps.Spine(bundles.ads_map2d.jsons.collect_json,s.scale);return i.setPositionRound(s.position),n.addChild(i),e.runAction(new cc.Sequence(new cc.ScaleTo(.2,0).easing(cc.easeBackIn()),new cc.CallFunc(function(){i.setAnimation(0,"animation",!1),cleverapps.audio.playSound(bundles.ads_map2d.urls.cloud_merge_effect)}),new cc.RemoveSelf)),void i.setCompleteListener(function(){i.setCompleteListener(function(){}),n.removeFromParent()})}e.runAction(new cc.Sequence(new cc.ScaleTo(.3,1.4*e.getScale()))),t.sound&&n.runAction(new cc.Sequence(new cc.DelayTime(.7),new cc.PlaySound(t.sound))),cleverapps.UI.collectAnimation(n,
t.target,{targetEffect:t.targetEffect,finishRemove:!1,noScale:!0,callback:function(){e.removeFromParent(),o.stop(function(){n.removeFromParent()})}.bind(this)});var o=new cleverapps.Particles(bundles.particle.jsons.particles_collect_json,bundles.game.urls.particle_texture);o.setScale(1/n.getScale()),o.setLocalZOrder(-1),n.addChild(o)};var DivideCollectibleView=function(t){t.onCollection=function(e){DivideCollectibleView.collectionAnimation.call(t,e)}};DivideCollectibleView.collectionAnimation=function(e){Game.currentGame.onAddItemsAnimation("wands",Math.ceil(this.unit.getData().value/5),this.unit,{withoutDelta:!0},e),this.unit.onDestruction()};var ResourceCollectibleView=function(e,t){e.onCollection=ResourceCollectibleView.collectionAnimation.bind(e,t)};ResourceCollectibleView.collectionAnimation=function(e){var t=Game.currentGame.getTargetCastle(this.unit),n=Map2dView.IsoToScreen(t.x-this.unit.x,t.y-this.unit.y);if(t.findComponent(MultiCell)){var s=t.findComponent(MultiCell
).getCenter();n.x+=s.x,n.y+=s.y}Game.currentGame.map.onCenterTo(t.x,t.y),cleverapps.UI.jumpAnimation(e,n,{parent:Game.currentGame.map.getView().animations,h:cleverapps.styles.UnitView.spawnHeight,time:.5,callback:function(){e.removeFromParent()}.bind(this)})};var ChestView=function(e,t){if(e.openAnimation=ChestView.openAnimation.bind(e,t),"sacks"!==e.unit.code){var n=Families[e.unit.code].units.length,s=void 0;if(e.unit.stage===n-1&&(s="stage3"),e.unit.stage===n-2&&(s="stage2"),s){var i=new cleverapps.Spine(bundles.chests.jsons.chest_animation_json);i.setAnimation(0,s,!0),i.setPositionRound(t.width/2,t.height/2),t.addChild(i)}}};ChestView.openAnimation=function(e){e.playAppearance()};var GeneratorView=cc.Node.extend({ctor:function(t,e){this._super(),this.unitView=e,(this.generator=t).afterUpdateStage=this.afterUpdateStage.bind(this),t.beforeUpdateStage=this.beforeUpdateStage.bind(this),t.beforeUpdateLevel=this.beforeUpdateLevel.bind(this);var n=cleverapps.styles.GeneratorView
;this.levelStars=[];var s=t.levels,i=t.level;if(!s&&t.brightLevels&&(s=i=t.brightLevels),s){for(var o=0;o<s;o++){var r=new cc.Sprite(o<i?bundles.merge.frames.generator_star_on:bundles.merge.frames.generator_star_off);this.levelStars.push(r)}var a=new cleverapps.Layout(this.levelStars,{direction:cleverapps.UI.HORIZONTAL,margin:n.stars.margin});a.width>n.stars.maxWidth&&a.setScale(n.stars.maxWidth/a.width),a.setPositionRound(n.stars),this.addChild(a)}this.guideButton=new cleverapps.UI.Button({button_png:bundles.merge.frames.guide_button_png,button_on_png:bundles.merge.frames.guide_button_on_png,onClicked:function(){cleverapps.metha.display({focus:"GeneratorGuideWindow",action:function(e){new GeneratorGuideWindow(t.unit),cleverapps.metha.onceNoWindowsListener=e}})}}),this.guideButton.setPositionRound(n.guideButton),this.addChild(this.guideButton)},beforeUpdateLevel:function(){if(this.generator.levels){var e=this.levelStars[this.generator.level];e.runAction(new cc.Sequence(new cc.ScaleTo(
.3,1.7),new cc.CallFunc(function(){e.setSpriteFrame(bundles.merge.frames.generator_star_on)}),new cc.ScaleTo(.3,1)))}},beforeUpdateStage:function(){var e=cleverapps.styles.GeneratorView,t=Game.currentGame.map.getView(),n=new cleverapps.Spine(bundles.merge.jsons.change_stage_cloud_json,e.cloud.scale),s=t.alignInIsometricGrid(this.generator.unit.x,this.generator.unit.y);n.setPositionRound(s.x+e.cloud.x,s.y+e.cloud.y),t.animations.addChild(n),n.setAnimation(0,"animation",!1),n.setCompleteListenerRemove()},afterUpdateStage:function(){this.unitView.setScale(.8),this.unitView.runAction(new cc.ScaleTo(.3,1))}});cleverapps.styles.GeneratorView={cloud:{x:84,y:70,scale:1.35},stars:{x:{align:"center"},y:{align:"top",dy:0},margin:0,maxWidth:200},guideButton:{x:{align:"right",dx:100},y:{align:"top",dy:120}}};var UpgradableView=cc.Node.extend({ctor:function(t,e){this._super(),this.setAnchorPoint2(),this.unitView=e,(this.upgradable=t).onUpdateLevel=this.onUpdateLevel.bind(this),
t.onStartUpdateLevel=this.onStartUpdateLevel.bind(this),t.onChangeProgress=this.onChangeProgress.bind(this),t.onBuild=this.onBuild.bind(this),t.highlightCollect=this.highlightCollect.bind(this),t.unhighlightCollect=this.unhighlightCollect.bind(this),t.beforeChangeUnit=this.beforeChangeUnit.bind(this);var n=cleverapps.styles.UpgradableView;this.progressBlock=new cc.Node,this.progressBlock.setAnchorPoint2(),this.progressBlock.setPositionRound(n.progress),this.addChild(this.progressBlock),this.progress=cleverapps.UI.createScale9Sprite(bundles.merge.frames.upgradable_bar_bg_png),this.progress.setContentSize2(n.progress.size),this.progressBlock.addChild(this.progress),this.progress.bar=new ScaledProgressBar(bundles.merge.frames.upgradable_bar_png),this.progress.bar.setDimension(n.progress.bar.size),this.progress.bar.setPositionRound(n.progress.bar),this.progress.addChild(this.progress.bar),this.progress.textContainer=new cc.Node,this.progress.textContainer.setAnchorPoint2(),
this.progress.textContainer.setPositionRound(n.progress.text),this.progress.text=cleverapps.UI.generateImageText("",cleverapps.styles.FONTS.UPGRADABLE_PROGRESS_TEXT),this.progress.textContainer.addChild(this.progress.text),this.progress.addChild(this.progress.textContainer),this.onChangeProgress(!0),this.level=new cc.Sprite(bundles.merge.frames.upgradable_level_png),this.level.setPositionRound(n.level),this.level.setVisible(!1),this.level.text=cleverapps.UI.generateImageText("",cleverapps.styles.FONTS.UPGRADABLE_LEVEL_TEXT),this.level.text.setPositionRound(n.level.text),this.level.addChild(this.level.text),this.progressBlock.addChild(this.level),this.guideButton=new cleverapps.UI.Button({button_png:bundles.merge.frames.guide_button_png,button_on_png:bundles.merge.frames.guide_button_on_png,onClicked:function(){cleverapps.metha.display({focus:"CastleWindow",action:function(e){new CastleGuideWindow({code:t.unit.code,stage:Families[t.unit.code].units.length-1}),
cleverapps.metha.onceNoWindowsListener=e}})}}),this.guideButton.setPositionRound(n.guideButton),this.addChild(this.guideButton),cleverapps.config.wysiwygMode&&cleverapps.flags.wysiwyg.hideGuideAndProgress&&(this.guideButton.setVisible(!1),this.progressBlock.setVisible(!1)),this.onUpdateLevel(!0),Buildable.IsBuilt(this.upgradable.unit)||(this.progressBlock.setScale(0),this.guideButton.setScale(0))},beforeChangeUnit:function(){this.children.slice().forEach(function(e){e.cloudAnimation&&e.replaceParentSamePlace(Game.currentGame.map.getView().animations)})},highlightCollect:function(){this.unitView.sprite.stopAllActions(),this.unitView.sprite.runAction(new cc.RepeatForever(new cc.Sequence(new cc.ScaleTo(.3,1.05),new cc.ScaleTo(.3,1))))},unhighlightCollect:function(){this.unitView.sprite.stopAllActions(),this.unitView.sprite.setScale(1)},onChangeStageImage:function(){var e=new cleverapps.Spine(bundles.merge.jsons.change_stage_cloud_json);e.cloudAnimation=!0,e.setPositionRound(
cleverapps.styles.UpgradableView.cloudAnimation),this.addChild(e,-1),e.setAnimation(0,"animation",!1),e.setCompleteListenerRemove(),cleverapps.audio.playSound(bundles.merge.urls.upgradable_build_effect,{throttle:2e3})},onChangeProgress:function(e){this.progress.text.setString(this.upgradable.progress+"/"+this.upgradable.stages),e||this.progress.textContainer.runAction(new cc.Sequence(new cc.ScaleTo(.15,1.4),new cc.ScaleTo(.15,1)));var t=this.upgradable.progress/this.upgradable.stages*100;void 0===this.progress.lastPercent||e?this.progress.bar.setPercentage(t):this.progress.bar.animatedChange(t-this.progress.lastPercent),this.progress.lastPercent=t,e?this.unitView.sprite.setAnimation(0,this.upgradable.getProgressAnimation(),!0):(this.onChangeStageImage(),this.runAction(new cc.Sequence(new cc.DelayTime(.5),new cc.CallFunc(function(){this.unitView.sprite.setAnimation(0,this.upgradable.getProgressAnimation(),!0)}.bind(this)))))},onUpdateLevel:function(e){this.level.text.setString(
this.upgradable.level),this.level.text.fitTo(cleverapps.styles.UpgradableView.level.text.maxWidth),this.upgradable.level&&this.level.setVisible(!0),e||this.onBuild()},onBuild:function(){this.progressBlock.runAction(new cc.ScaleTo(.3,1)),this.guideButton.runAction(new cc.ScaleTo(.3,1))},onStartUpdateLevel:function(){this.progressBlock.runAction(new cc.ScaleTo(.3,0)),this.guideButton.runAction(new cc.ScaleTo(.3,0))}});cleverapps.overrideFonts(cleverapps.styles.FONTS,{UPGRADABLE_PROGRESS_TEXT:{name:"default",size:30},UPGRADABLE_LEVEL_TEXT:{name:"default",size:40}}),cleverapps.styles.UpgradableView={guideButton:{x:{align:"right",dx:100},y:{align:"top",dy:100}},level:{x:{align:"left",dx:-120},y:{align:"center",dy:0},text:{x:{align:"center",dx:3},y:{algin:"center",dy:3},maxWidth:40}},cloudAnimation:{x:{align:"center"},y:{align:"center"}},progress:{x:{align:"center"},y:{align:"bottom",dy:-80},size:{width:180,height:34},text:{width:130,x:{align:"center"},y:{algin:"center",dy:3}},bar:{size:{
width:174,height:27},x:3,y:5}}};var CastleView=cc.Node.extend({ctor:function(e){this._super(),this.castle=e,this.castle.onBuildCastle=this.buildCastle.bind(this),this.castle.onStartWait=this.startWait.bind(this),this.castle.onCompleteWait=this.completeWait.bind(this),this.castle.builded&&(this.buildCastle(),this.startWait(),void 0===this.castle.sinceLastHarvest&&this.completeWait())},buildCastle:function(e){this.animation=new cleverapps.Spine(bundles.castle.jsons.castle_animation_json),this.addChild(this.animation)},startWait:function(){this.animation.setAnimation(0,"animation",!0)},completeWait:function(){this.animation.setAnimation(0,"blink",!1),this.animation.setCompleteListener(function(){this.animation.setCompleteListener(function(){}),this.animation.setAnimation(0,"ready",!0)}.bind(this))}}),MiniGameView=cc.Node.extend({ctor:function(e){this._super(),this.minigame=e,this.minigame.onStartWait=this.startWait.bind(this),this.minigame.onCompleteWait=this.completeWait.bind(this),
this.animation=new cleverapps.Spine(bundles.castle.jsons.castle_animation_json),this.animation.setPositionRound(cleverapps.styles.MiniGameView),this.addChild(this.animation),this.startWait(),void 0===this.minigame.sinceLastHarvest&&this.completeWait()},startWait:function(){this.animation.setAnimation(0,"animation",!0)},completeWait:function(){this.animation.setAnimation(0,"blink",!1),this.animation.setCompleteListener(function(){this.animation.setCompleteListener(function(){}),this.animation.setAnimation(0,"ready",!0)}.bind(this))}});cleverapps.styles.MiniGameView={x:{align:"center"},y:{align:"center",dy:-20}};var MultiCellView=function(e,t){var n=MultiCellView.calcCenterPosition(e);t.x+=n.x,t.y+=n.y};MultiCellView.calcCenterPosition=function(e){for(var t=0,n=0,s=0;s<e.length;s++){var i=e[s].x+e[s].y+1,o=e[s].x-e[s].y;t+=i*cleverapps.styles.Map2dView.cell.width/2,n+=o*cleverapps.styles.Map2dView.cell.height/2}return t/=e.length,n/=e.length,{
x:t-=cleverapps.styles.Map2dView.cell.width/2,y:n}};var DishView=function(e,t){e.openAnimation=DishView.openAnimation.bind(e,t)};DishView.openAnimation=function(e){e.playAppearance()};var BuildableView=cc.Node.extend({ctor:function(e,t){this._super(),this.build=e,(this.parentUnitView=t).setImageOpacity(180),this.showCheckmark(),e.onCompletion=this.animateCompletion.bind(this),e.onHighlight=this.highlight.bind(this),e.onUnhighlight=this.unhighlight.bind(this),e.onHideDetails=this.hideCheckmark.bind(this),e.onShowDetails=this.showCheckmark.bind(this)},showCheckmark:function(e){e=e||function(){},this.build.isCompleted()?e():this.checkmark?e():(this.checkmark=new cc.Sprite(bundles.buildable.frames.buildable_exclamation),this.checkmark.setScale(.3),this.addChild(this.checkmark),this.checkmark.runAction(new cc.Sequence(new cc.ScaleTo(.1,1).easing(cc.easeOut(2)),new cc.CallFunc(e))))},hideCheckmark:function(e){e=e||function(){},this.checkmark?(this.checkmark.stopAllActions(),
this.checkmark.runAction(new cc.Sequence(new cc.ScaleTo(.1,.3).easing(cc.easeIn(2)),new cc.RemoveSelf,new cc.CallFunc(e))),this.checkmark=void 0):e()},highlight:function(){this.parentUnitView.setImageOpacity(255),this.parentUnitView.sprite.setColor(cc.color(255,255,0))},unhighlight:function(){this.build.isCompleted()?this.parentUnitView.setImageOpacity(255):this.parentUnitView.setImageOpacity(180),this.parentUnitView.sprite.setColor(cc.color(255,255,255))},animateCompletion:function(){var e=this.parentUnitView;if(e.setImageOpacity(255),!this.build.unit.findComponent(MultiCell)){var t=e.parent,n=new cleverapps.Spine(bundles.buildable.jsons.buildable_below_json);n.setLocalZOrder(-1),t.addChild(n);var s=new cleverapps.Spine(bundles.buildable.jsons.buildable_above_json);s.setLocalZOrder(1),t.addChild(s),n.setAnimation(0,"animation",!1),n.setCompleteListenerRemove(),s.setAnimation(0,"animation",!1),s.setCompleteListenerRemove()}e.runAction(new cc.Sequence(new cc.DelayTime(.13),
new cc.ScaleTo(.5,1.3),new cc.ScaleTo(.4,1))),cleverapps.audio.playSound(bundles.buildable.urls.build_finish_effect)}}),MineableView=cc.Node.extend({ctor:function(e,t){var n=cleverapps.styles.MineableView;this._super(),this.mine=e,this.parentUnitView=t,this.visible=!1;var s=this.progress=new DiscreteProgress(e.mined,e.unit.getData().mineable.length,!0);s.setAnchorPoint2(),s.setPositionRound(n.progress),t.addChild(s),this.shouldDisplayProgress()||s.setVisible(!1),e.onMoveNext=this.moveNext.bind(this),e.onHideDetails=this.hideProgress.bind(this),e.onShowDetails=this.showProgress.bind(this)},shouldDisplayProgress:function(){return 0!==this.mine.mined||1===this.mine.unit.getData().mineable.length},moveNext:function(){this.progress.setStep(this.mine.mined),this.showProgress()},showProgress:function(){this.shouldDisplayProgress()&&(this.progress.visible||this.progress.runAction(new cc.Sequence(new cc.MoveBy(0,0,15),new cc.ScaleTo(0,.5),new cc.Show,new cc.Spawn(new cc.MoveBy(.1,0,-15),
new cc.ScaleTo(.1,1)))))},hideProgress:function(){this.progress.setVisible(!1)}});cleverapps.styles.MineableView={progress:{x:{align:"center"},y:{align:"bottom",dy:25}}};var GroundedView=cc.Sprite.extend({ctor:function(e){this._super(GroundedView.getImage()),e.remove=function(e){e?this.removeFromParent():this.runAction(new cc.Sequence(new cc.FadeOut(.5),new cc.RemoveSelf))}.bind(this)}});GroundedView.getImage=function(){return bundles.merge.frames.grounded_bg};var FruitView=cc.Node.extend({ctor:function(e){this._super(),this.fruit=e,this.startGrowth(),e.onStartGrowth=this.startGrowth.bind(this),e.onCompleteGrowth=this.completeGrowth.bind(this),void 0===this.fruit.sinceLastHarvest&&this.completeGrowth()},updateAnimation:function(e){if(this.animation&&(this.animation.removeFromParent(),this.animation=void 0),e){if(cleverapps.config.wysiwygMode&&cleverapps.flags.wysiwyg.hideFruitParticlesAnimation)return;var t=this.animation=new cleverapps.Spine(e);t.setAnimation(0,"animation",!0),
this.addChild(t)}},startGrowth:function(){this.updateAnimation(bundles.fruit.jsons.fruit_growing_json)},completeGrowth:function(){var e=new cleverapps.Spine(bundles.fruit.jsons.fruit_ready_json);e.setAnimation(0,"animation",!1),e.setCompleteListenerRemove(function(){this.updateAnimation(bundles.fruit.jsons.fruit_ripe_json)}.bind(this)),this.addChild(e)}}),MakesOrderView=cc.Node.extend({ctor:function(e,t){this._super(),this.maker=e,this.parentUnitView=t,this.prizeView=void 0,e.onChangeState=this.handleStateChange.bind(this),e.onUpdateIngredients=this.handleUpdateIngredients.bind(this),this.runAction(new cc.Sequence(new cc.DelayTime(1),new cc.CallFunc(this.handleStateChange.bind(this))))},handleUpdateIngredients:function(){this.prizeView&&this.prizeView.hasAttention()&&this.prizeView.createAttention(this.getAttentionImage())},getAttentionImage:function(){return this.maker.canCook(
)?bundles.mergeui.frames.small_attention_exclamation:bundles.mergeui.frames.small_attention_exclamation_disabled},handleStateChange:function(){if(!cleverapps.config.wysiwygMode||!cleverapps.flags.wysiwyg.hidePrizeView){var e;this.prizeView&&(this.parentUnitView.removeAdditionalView("prize"),this.prizeView=void 0);var t=this.parentUnitView,n=t.getContentSize();switch(this.maker.state){case MakesOrder.STATE_RECIPE:e=new PrizeView({prize:this.maker.createPrizeUnit(),onClick:t.handleClick.bind(t),attention:this.getAttentionImage()}),cleverapps.audio.playSound(bundles.merge.urls.new_order_effect);break;case MakesOrder.STATE_COOKING:e=new PrizeView({animation:!0,onClick:t.handleClick.bind(t)})}e&&(e.setPositionRound(n.width/2,n.height),t.insertAdditionalView("prize",e),this.prizeView=e)}}});cleverapps.styles.MakesOrderView={};var InstantWorkerView=cc.Node.extend({ctor:function(e,t){this._super(),this.worker=e,this.parentUnitView=t,this.worker.onStartMagic=this.startMagic.bind(this),
this.worker.onFinishMagic=this.finishMagic.bind(this),this.worker.onDragStart=this.handleDragStart.bind(this),this.worker.onDragFinish=this.handleDragFinish.bind(this),this.worker.onPercentageChanged=this.onUpdateProgress.bind(this),e.unit.onInfoOpened=this.hideProgress.bind(this),e.unit.onInfoClosed=this.onUpdateProgress.bind(this),this.onUpdateProgress()},handleDragStart:function(){var e=this.parentUnitView.getAnimation();e.setCompleteListener(null),e.setAnimation(0,"idle_up",!0)},handleDragFinish:function(){var e=this.parentUnitView.getAnimation();e.setCompleteListener(null);var t=UnitView.getUnitAnimations(this.worker.unit);t?e.setIdleSet(t):e.setAnimation(0,"animation",!0)},showTimer:function(e){this.hideTimer(e);var t=e.unit.onGetView(),n=new ComponentTimer(e.time,{instant:{limit:Math.min(e.time,this.worker.limit),duration:InstantWorker.BUILDING_ANIMATION_TIME}});n.setPositionRound(cleverapps.styles.WorkerView.timer),t.insertAdditionalView("timer",n)},hideTimer:function(e){
e.unit.onGetView().removeAdditionalView("timer")},jumpAnimation:function(e,t,n,s){var i=t.convertToNodeSpace(t.parent.convertToWorldSpace(t)),o=t.convertToNodeSpace(e.parent.convertToWorldSpace(e)),r=cc.pDistance(o,i);this.animation.replaceParent(t),this.animation.setPositionRound(o),this.animation.setAnimation(0,n,!0),this.animation.runAction(new cc.Sequence(new cc.JumpTo(.45,i.x,i.y,.3*r,1),new cc.CallFunc(function(){s&&s()})))},startMagic:function(e){var t=this.worker.unit;if(e.onHideDetails(),this.showTimer(e),!this.animation){var n=this.animation=UnitView.getUnitImage(t),s=UnitView.getUnitStyles(t);n.setAnchorPoint2(s.anchorX,s.anchorY),n.setCompleteListener(null)}this.parentUnitView.setVisible(!1),this.jumpAnimation(t.onGetView(),e.unit.onGetView(),"jump",function(){this.animation.setAnimation(0,"building",!0),cleverapps.audio.playSound(bundles.merge.urls.instantworker_build_effect)}.bind(this))},finishMagic:function(e){this.hideTimer(e),this.animation&&this.jumpAnimation(
e.unit.onGetView(),this.worker.unit.onGetView().parent,"jump_back",function(){e.onShowDetails(),this.parentUnitView.setVisible(!0),this.animation.removeFromParent(),delete this.animation}.bind(this))},onUpdateProgress:function(){this.worker.isFresh()||this.showProgress()},showProgress:function(){var e=cleverapps.styles.InstantWorkerView.progress;if(!this.progress){var t=new ScaledProgressBar(bundles.mergeui.frames.progress_bar);t.setDimension(e.width,e.height),t.setPositionRound(0,0),t.setPercentage(100);var n=new cc.Scale9Sprite(bundles.mergeui.frames.progress_stroke);n.setAnchorPoint2(0,0),n.setPositionRound(0,0),n.setContentSize2(t.width,t.height);var s=this.progress=new cc.Scale9Sprite(bundles.mergeui.frames.progress_background);s.setAnchorPoint2(),s.setPositionRound(e),s.setContentSize2(t.width,t.height),s.addChild(t),s.addChild(n),s.bar=t,this.addChild(s)}this.progress.bar.setPercentage(this.worker.getPercentage()),this.progress.visible||this.progress.runAction(new cc.Sequence(
new cc.MoveBy(0,0,-15),new cc.ScaleTo(0,.5),new cc.Show,new cc.Spawn(new cc.MoveBy(.1,0,15),new cc.ScaleTo(.1,1))))},hideProgress:function(){this.progress&&this.progress.setVisible(!1)}});cleverapps.styles.InstantWorkerView={progress:{width:80,height:13,x:5,y:47},timer:{x:{align:"center",dx:0},y:{align:"center",dy:-29}}};var SpecialOfferView=cc.Node.extend({ctor:function(e,t){this._super(),this.specialOffer=e,this.parentUnitView=t,e.onAppearance=this.createListener(this.playAppearance.bind(this)),e.onDestruction=this.createListener(this.playDestruction.bind(this)),e.onBuying=this.createListener(this.playBuying.bind(this))},createPrizeView:function(e){var t=UnitView.getUnitStyles(e),n=UnitView.getUnitImage(e);return n.setAnchorPoint2(t.anchorX,t.anchorY),n.setLocalZOrder(-1),n},createTimer:function(){var e=cleverapps.styles.SpecialOfferView.timer,t=new cc.Scale9Sprite(bundles.mergeui.frames.timer_substrate);t.setAnchorPoint2(),t.setContentSize2(e),t.setPositionRound(e)
;var n=new cleverapps.CountDownView(new cleverapps.CountDown(this.specialOffer.getTimeLeft()),{font:cleverapps.styles.FONTS.COMPONENT_TIMER_TEXT});n.setAnchorPoint2(),n.setPositionRound(e.countdown),t.addChild(n);var s=new cc.Sprite(bundles.mergeui.frames.timer_icon_png);s.setAnchorPoint2(),s.setPositionRound(e.icon),t.addChild(s);var i=new cleverapps.UI.Button({styles:e.button,content:cleverapps.UI.generateOnlyText("messages:SpecialOfferView.buy",cleverapps.styles.FONTS.BUTTON_SMALL_TEXT),onClicked:this.specialOffer.handleClick.bind(this.specialOffer),button_images:cleverapps.UI.Button.Images.small_button_blue});return i.setAnchorPoint2(),i.setPositionRound(e.button),t.addChild(i),t},playAppearance:function(){var e=cleverapps.styles.SpecialOfferView,t=this.parentUnitView;t.setVisible(!1);var n=new cleverapps.Spine(bundles.merge.jsons.specialoffer_helicopter_json);n.setPositionRound(e.helicopter),t.addChild(n),n.replaceParentSamePlace(Game.currentGame.map.getView().animations)
;var s=this.createPrizeView(this.specialOffer.prize);s.setPositionRound(e.prize),s.y+=e.prize.offset.y-s.height/2,s.setVisible(!1),n.addChild(s);var i=e.helicopter.offset;n.runAction(new cc.Sequence(new cc.PlaySound(bundles.merge.urls.specialoffer_helicopter_effect),new cc.DelayTime(.5667),new cc.CallFunc(n.runAction.bind(n,new cc.RepeatForever(new cc.Sequence(new cc.MoveBy(1.25,i.x,i.y).easing(cc.easeQuadraticActionInOut()),new cc.MoveBy(1.25,-i.x,-i.y).easing(cc.easeQuadraticActionInOut()))))))),s.runAction(new cc.Sequence(new cc.DelayTime(.5667),new cc.Show,new cc.MoveBy(.2,0,-62),new cc.CallFunc(s.runAction.bind(s,new cc.RepeatForever(new cc.Sequence(new cc.ScaleTo(.247,.92,1),new cc.ScaleTo(.169,1,1))))))),n.setAnimation(0,"appearance",!1),n.setCompleteListener(function(){n.stopAllActions(),n.setAnimation(0,"disappearance",!1),n.setCompleteListenerRemove();var e=t.convertToWorldSpace(cc.p(t.width/2,t.height/2));e=n.convertToNodeSpace(e),s.stopAllActions(),s.runAction(
new cc.Sequence(new cc.ScaleTo(.2,1,1),new cc.MoveTo(.17,e.x,e.y),new cc.CallFunc(function(){s.replaceParentSamePlace(t.parent),s.runAction(new cc.Sequence(new cc.PlaySound(bundles.merge.urls.spawn_landing_effect),new cc.ScaleTo(.15,1,.8),new cc.ScaleTo(.15,1,1)));var e=new cleverapps.Spine(bundles.buildable.jsons.buildable_above_json);e.setLocalZOrder(1),e.setAnimation(0,"animation_bonus",!1),e.setCompleteListenerRemove(),t.parent.addChild(e),t.setVisible(!0),t.setScale(.3),t.runAction(new cc.Sequence(new cc.DelayTime(.3),new cc.PlaySound(bundles.merge.urls.specialoffer_appearance_effect),new cc.ScaleTo(.4,1.3),new cc.ScaleTo(.2,1),new cc.CallFunc(function(){s.replaceParentSamePlace(t);var e=this.createTimer();t.insertAdditionalView("timer",e)}.bind(this))))}.bind(this))))}.bind(this))},playDestruction:function(){cleverapps.audio.playSound(bundles.merge.urls.specialoffer_destruction_effect),this.parentUnitView.removeAdditionalView("timer")},playBuying:function(){
var e=this.specialOffer.prize.onGetView();e.setScale(.2),e.setVisible(!1);var t=this.parentUnitView,n=new cleverapps.Spine(bundles.buildable.jsons.buildable_above_json);n.setLocalZOrder(2),n.setCompleteListenerRemove(),t.parent.addChild(n),t.stopAllActions(),t.runAction(new cc.Sequence(new cc.DelayTime(.7),new cc.PlaySound(bundles.merge.urls.specialoffer_buying_effect),new cc.CallFunc(function(){n.setAnimation(0,"animation",!1),t.removeAdditionalView("timer"),e.setVisible(!0),e.runAction(new cc.ScaleTo(.2,1))}),new cc.ScaleTo(.2,.3),new cc.RemoveSelf))}});cleverapps.styles.SpecialOfferView={timer:{width:135,height:29,x:{align:"center",dx:0},y:{align:"center",dy:-10},margin:20,countdown:{x:{align:"right",dx:-7},y:{align:"center",dy:1}},icon:{x:{align:"left",dx:-12},y:{align:"center"}},button:{x:{align:"center"},y:{align:"bottom",dy:-56},width:130,height:50,padding:{left:12,right:12,top:0,bottom:0},margin:0}},prize:{x:{align:"center"},y:260,offset:{y:62}},helicopter:{x:{align:"center"},
y:{align:"bottom"},offset:{x:20,y:10}}};var MagicPlantView=cc.Node.extend({ctor:function(e){this._super(),(this.plant=e).onStartGrowth=this.startGrowth.bind(this),e.onCompleteGrowth=this.completeGrowth.bind(this),0<e.getTimeLeft()?this.startGrowth():this.completeGrowth()},updateAnimation:function(e){if(this.animation&&(this.animation.removeFromParent(),this.animation=void 0),e){var t=this.animation=new cleverapps.Spine(e);t.setAnimation(0,"animation",!0),this.addChild(t)}},startGrowth:function(){this.updateAnimation(bundles.fruit.jsons.fruit_growing_json)},completeGrowth:function(){var e=new cleverapps.Spine(bundles.fruit.jsons.fruit_ready_json);e.setAnimation(0,"animation",!1),e.setCompleteListenerRemove(function(){this.updateAnimation(bundles.fruit.jsons.fruit_ripe_json)}.bind(this)),this.addChild(e)}}),DiscreteProgress=cc.Node.extend({ctor:function(e,t,n){this._super(),this.total=t=t||1;var s=new cc.Scale9Sprite(
n?bundles.discreteprogress.frames.dp_background_small:bundles.discreteprogress.frames.dp_background);this.addChild(s);var i=this.generateProgressBar(t,n);s.setAnchorPoint2(0,.5),s.setPositionRound(0,i.height/2),s.setContentSize2(i.width,i.height);var o=new cc.Scale9Sprite(n?bundles.discreteprogress.frames.dp_stroke_small:bundles.discreteprogress.frames.dp_stroke);o.setAnchorPoint2(0,.5),o.setPositionRound(0,i.height/2),o.setContentSize2(i.width,i.height),this.addChild(o),this.setContentSize2(i.width,i.height),this.setAnchorPoint2(),this.setStep(e)},generateProgressBar:function(e,t){var n=t?cleverapps.styles.SmallDiscreteProgress:cleverapps.styles.DiscreteProgress,s=n.width,i=n.height;this.steps=[];for(var o=0,r=0;o<e;++o){var a
;a=1===e?t?bundles.discreteprogress.frames.dp_progress_0_small:bundles.discreteprogress.frames.dp_progress_0:0===o?t?bundles.discreteprogress.frames.dp_progress_1_small:bundles.discreteprogress.frames.dp_progress_1:o===e-1?t?bundles.discreteprogress.frames.dp_progress_2_small:bundles.discreteprogress.frames.dp_progress_2:t?bundles.discreteprogress.frames.dp_progress_3_small:bundles.discreteprogress.frames.dp_progress_3;var c=new cc.Scale9Sprite(a);c.setAnchorPoint(0,.5),c.setPosition(r,i/2+n.adjust.y),c.setContentSize(s/e,i),r+=c.width+n.smallMargin,this.steps.push(c),this.addChild(c)}return{width:r,height:i}},setStep:function(e){e=this.step=Math.min(this.total-e-1,this.total);for(var t=0;t<this.total;++t){var n=this.steps[t];n.stopAllActions(),t<e?(n.setOpacity(255),n.setVisible(!0)):t===e?n.runAction(new cc.RepeatForever(new cc.Sequence(new cc.FadeTo(.7,50),new cc.FadeTo(.7,170)))):n.setVisible(!1)}}});cleverapps.styles.DiscreteProgress={width:170,height:25,smallMargin:1,adjust:{y:0}
},cleverapps.styles.SmallDiscreteProgress=cleverapps.overrideStyles(cleverapps.styles.DiscreteProgress,{width:80,height:13,smallMargin:.5,adjust:{y:-1}},!0);var ComponentTimer=cc.Node.extend({ctor:function(e,t){t=this.options=t||{},this._super(),t.instant?this.countdown=this.createFastCountdown(e,t.instant.limit,t.instant.duration):this.countdown=new cleverapps.CountDown(e,{onTick:this.onTickHandler.bind(this)}),this.createContent()},createFastCountdown:function(e,t,n,s){var i=n/50,o=t/i;s=s||function(){},this.fastDuration=n;var r=setInterval(function(){if(i<=0)return delete this.fastDuration,clearInterval(r),void s();e-=o,i-=1,a.onSecond()}.bind(this),50),a={onSecond:function(){},getTimeLeft:function(){return e},stop:function(){clearInterval(r)},remove:function(){clearInterval(r)}};return a},onTickHandler:function(){!this.button&&this.isButtonAvailable()&&(this.createButton(),this.removeAdsIcon())},isButtonAvailable:function(){
return this.options.buttonCallback&&0===SpeedUpWindow.CalcPrice(this.countdown.getTimeLeft())},createContent:function(){this.createTimer(),this.createAnimation(),this.isButtonAvailable()?this.createButton(!0):this.options.adsActive&&this.createAdsIcon(!0)},createTimer:function(){if(!this.timer){var e=cleverapps.styles.Timer.timer,t=new cleverapps.CountDownView(this.countdown,{font:cleverapps.styles.FONTS.COMPONENT_TIMER_TEXT});t.setAnchorPoint2(),t.setPositionRound(e.padding.left+t.width/2,e.padding.bottom+t.height/2);var n=new cc.Scale9Sprite(bundles.mergeui.frames.timer_substrate);n.setAnchorPoint2(),n.setContentSize2(t.width+e.padding.left+e.padding.right,t.height+e.padding.bottom+e.padding.top),n.addChild(t);var s=new cc.Sprite(bundles.mergeui.frames.timer_icon_png);s.setLocalZOrder(1);var i=this.timer=new cleverapps.Layout([s,n],{direction:cleverapps.UI.HORIZONTAL,margin:e.margin});if(i.icon=s,this.addChild(i),this.fastDuration){var o=t.scale;t.setCascadeColorEnabled(!0),
t.setColor(cleverapps.styles.COLORS.CONGRATS_BLUE);var r=this.fastDuration/1e3/5;i.runAction(new cc.Repeat(new cc.Sequence(new cc.ScaleTo(r/2,1.2*o),new cc.ScaleTo(r/2,o)),5))}}},removeTimer:function(){this.timer&&(this.timer.removeFromParent(),delete this.timer)},createAnimation:function(){var e=cleverapps.styles.Timer.animation,t=this.animation=new cleverapps.Spine(bundles.mergeui.jsons.timer_json);t.setAnchorPoint2(),t.setPositionRound(e.x,e.y),t.setAnimation(0,"animation",!0),this.addChild(t)},createButton:function(e){var t=cleverapps.styles.Timer.button,n=this.button=new UseGoldButton({button_images:cleverapps.UI.Button.Images.small_button_blue,price:SpeedUpWindow.CalcPrice(this.countdown.getTimeLeft()),onClicked:this.options.buttonCallback,font:cleverapps.styles.FONTS.BUTTON_SMALL_TEXT,eventName:"speedup_worker_ruby"},t);n.setAnchorPoint2(),n.setPositionRound(t),n.adviceTarget=Merge.SPEED_UP,this.addChild(n),!0!==e&&(n.setScale(.3),n.runAction(new cc.ScaleTo(.2,1)))},
createAdsIcon:function(e){if(!this.adsIcon){var t=cleverapps.styles.Timer.adsIcon,n=this.adsIcon=new cc.Sprite(bundles.mergeui.frames.watch_ad_icon);n.setAnchorPoint2(),n.setPositionRound(t),this.addChild(n),cleverapps.UI.onClick(n,this.options.adsCallback),this.timer.icon.setSpriteFrame(bundles.mergeui.frames.timer_ribbon_icon_png),!0!==e&&(n.setScale(.3),n.runAction(new cc.ScaleTo(.2,1)))}},removeAdsIcon:function(e){this.adsIcon&&(e?this.adsIcon.removeFromParent():this.adsIcon.runAction(new cc.Sequence(new cc.ScaleTo(.2,.3),new cc.RemoveSelf)),delete this.adsIcon,this.timer.icon.setSpriteFrame(bundles.mergeui.frames.timer_icon_png))},showBoost:function(e){if(this.countdown){var t=this.countdown.getTimeLeft();this.countdown.stop(),delete this.countdown,this.countdown=this.createFastCountdown(t,e.limit,e.duration,e.callback),this.removeTimer(),this.createTimer()}}});cleverapps.overrideFonts(cleverapps.styles.FONTS,{COMPONENT_TIMER_TEXT:{size:22,color:cleverapps.styles.COLORS.WHITE}}),
cleverapps.styles.Timer={timer:{margin:-15,padding:{left:17,right:5,top:3,bottom:5}},animation:{width:50,height:50,x:0,y:45},button:{x:0,y:-45,width:130,height:50,padding:{left:12,right:12,top:0,bottom:0},margin:0},adsIcon:{x:-43,y:58}};var InfoView=cc.Scale9Sprite.extend({ctor:function(e){var t=cleverapps.styles.InfoView;this._super(bundles.mergeui.frames.background);var n=[];e.title&&n.push(this.createTitle(e.title)),e.progress&&n.push(this.createProgressBar(e.progress)),e.duration&&n.push(this.createDuration(e.duration)),e.countdown&&n.push(this.createCountDown(e.countdown)),e.remains&&n.push(this.createRemainsBar(e.remains)),e.actions&&n.push(this.createActions(e.actions));var s=new cleverapps.Layout(n,{direction:cleverapps.UI.TOP_TO_BOTTOM,margin:t.margin,padding:t.padding});s.setAnchorPoint2(),s.setPositionRound(s.width/2,s.height/2),this.setAnchorPoint2(.5,0),this.setContentSize2(s.width,s.height),this.setLocalZOrder(2);var i=new cc.Sprite(bundles.mergeui.frames.pointer)
;i.setPositionRound(t.pointer.x,t.pointer.y),this.addChild(i),this.addChild(s),e.guide&&this.addChild(this.createGuide(e.guide)),this.baseScale=1},createTitle:function(e){var t=cleverapps.styles.InfoView.title,n="string"==typeof e?e:Game.currentGame.unitsLibrary.getUnitName(e),s=t.width;if(e.icon){var i=UnitView.getUnitImage(e);i.setScale(t.icon.scale),s-=i.width*i.scaleX}var o=cleverapps.UI.generateOnlyText(n,cleverapps.styles.FONTS.INFO_TEXT);return o.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER),o.width>s&&0<=n.indexOf(" ")&&n.lastIndexOf(" ")===n.indexOf(" ")&&(n=n.replace(" ","\n"),o.setString(n)),o.fitTo(s),e.icon?new cleverapps.Layout([i,o],{direction:cleverapps.UI.HORIZONTAL,margin:t.icon.margin,padding:t.icon.padding}):o},createProgressBar:function(e){return new DiscreteProgress(e.value,e.total)},createRemainsBar:function(e){var t=cleverapps.styles.InfoView.remains,n=new ScaledProgressBar({progress:bundles.mergeui.frames.progress_bar,
background:bundles.mergeui.frames.progress_background,foreground:bundles.mergeui.frames.progress_stroke,padding:t.padding});return n.setAnchorPoint2(),n.setPercentage(e.value/e.total*100),n.setDimension(t.width,t.height),n},createDuration:function(e){var t=cleverapps.UI.generateImageText(cleverapps.intervalToString(e),cleverapps.styles.FONTS.INFO_TIMER_TEXT);return this.createTimer(t)},createCountDown:function(e){var t=this.countdown=new cleverapps.CountDown(e,{onFinish:InfoView.CloseInfo}),n=new cleverapps.CountDownView(t,{font:cleverapps.styles.FONTS.INFO_TIMER_TEXT});return this.createTimer(n)},createTimer:function(e){var t=cleverapps.styles.InfoView.timer,n=new cc.Sprite(bundles.infoview.frames.timer);return new cleverapps.Layout([n,e],{direction:cleverapps.UI.HORIZONTAL,margin:t.margin,padding:t.padding})},createActions:function(e){var t=cleverapps.styles.InfoView.actions,n=[];for(var s in e){var i=e[s];if(i)switch(s){case"build":n.push(this.createBuildButton(i));break
;case"instant":n.push(this.createInstantButton(i));break;case"energy":n.push(this.createEnergyButton(i));break;case"speedup":n.push(this.createSpeedUpButton(i));break;case"remove":n.push(this.createRemoveButton(i))}}return new cleverapps.Layout(n,{direction:cleverapps.UI.TOP_TO_BOTTOM,padding:t.padding,margin:t.margin})},createBuildButton:function(e){e={button_images:e.button_images||cleverapps.UI.Button.Images.button_green,text:e.text||"messages:InfoView.button.build",icon:e.icon||new cc.Sprite(bundles.infoview.frames.dwarf_head),action:e instanceof Function?e:e.action,adviceTarget:e.adviceTarget||"build"};var t=cleverapps.styles.InfoView.button,n=cleverapps.UI.generateOnlyText(e.text,cleverapps.styles.FONTS.INFO_BUILD_BUTTON_TEXT),s=e.icon,i=t.width-t.padding.left-t.padding.right-s.width*s.scale;n.fitTo(i);var o=new cleverapps.Layout([n,s],{direction:cleverapps.UI.HORIZONTAL,margin:t.margin}),r=new cleverapps.UI.Button({styles:t,content:o,onClicked:InfoView.CloseInfo.bind(null,
e.action),button_images:e.button_images});return r.adviceTarget=e.adviceTarget,r},createInstantButton:function(e){return this.createBuildButton({button_images:cleverapps.UI.Button.Images.button_blue,text:"messages:InfoView.button.instant",icon:new cc.Sprite(bundles.infoview.frames.instant_dwarf_head),action:e,adviceTarget:"instant"})},createRemoveButton:function(t){var e=cleverapps.styles.InfoView.button,n=Messages.get("InfoView.button.remove"),s=!1;return Game.currentGame.gameLevel.getLevel()<InfoView.MINIMAL_REMOVE_LEVEL&&(n=Messages.get("InfoView.button.level",{level:InfoView.MINIMAL_REMOVE_LEVEL}),s=!0),new cleverapps.UI.Button({styles:e,text:n,disabled:s,font:cleverapps.styles.FONTS.INFO_BUILD_BUTTON_TEXT,onClicked:InfoView.CloseInfo.bind(null,function(){cleverapps.metha.isFocused()||cleverapps.metha.display({focus:"ShovelWindow",action:function(e){new RemoveUnitWindow(t.unit),cleverapps.metha.onceNoWindowsListener=e}})}),button_images:cleverapps.UI.Button.Images.button_red})},
createEnergyButton:function(e){var t=cleverapps.styles.InfoView.button,n=new UseEnergyButton({energy:e.energy,onClicked:InfoView.CloseInfo.bind(InfoView,e.action),font:cleverapps.styles.FONTS.INFO_BUTTON_TEXT},t);return n.adviceTarget="energy",n},createSpeedUpButton:function(e){var t=cleverapps.styles.InfoView.button,n="speedup_fruit_ruby";return e.unit&&"fruit"!==e.unit.getType()&&(n="speedup_"+e.unit.code+"_ruby"),new UseGoldButton({price:SpeedUpWindow.CalcPrice(e.duration),onClicked:InfoView.CloseInfo.bind(InfoView,e.action),image:bundles.infoview.frames.button_coin_png,font:cleverapps.styles.FONTS.INFO_BUTTON_TEXT,eventName:n},t)},createGuide:function(t){var e=cleverapps.styles.InfoView.guide,n=new cleverapps.UI.Button({button_png:bundles.merge.frames.guide_button_png,button_on_png:bundles.merge.frames.guide_button_on_png,onClicked:function(){cleverapps.metha.display({focus:"InfoViewGuide",action:function(e){new t.class(t.unit),cleverapps.metha.onceNoWindowsListener=e}})}})
;return n.setAnchorPoint2(),n.setPositionRound(e),n}});InfoView.MINIMAL_REMOVE_LEVEL=6,InfoView.SqueezeAndDisplay=function(e){if(!InfoView.blocked){var t=InfoView.latestParent===e;t||InfoView.CloseInfo(),(InfoView.blocked=e).onSqueeze(function(){InfoView.blocked=!1,t?InfoView.CloseInfo():InfoView.DisplayInfo(e)}.bind(this))}},InfoView.DisplayInfo=function(e){var t=e.getInfo();t&&!Game.currentGame.map.dragging&&Game.currentGame.tutorial.isInfoAvailable()&&(InfoView.IsOpened()&&InfoView.CloseInfo(),InfoView.CreateInfo(t,e))},InfoView.IsOpened=function(){return void 0!==InfoView.latestParent},InfoView.Clear=function(e){e&&InfoView.latestParent!==e||(InfoView.latestParent=void 0),e&&InfoView.blocked!==e||(InfoView.blocked=!1)},InfoView.CloseInfo=function(e,t){InfoView.latestParent?(InfoView.latestParent.onGetView().removeAdditionalView("info",e,t),InfoView.latestParent.onInfoClosed(e),InfoView.latestParent=void 0):e&&e()},InfoView.CreateInfo=function(e,t){var n=cleverapps.styles.InfoView,
s=new InfoView(e),i=t.onGetView();(s.setPositionRound(i.width/2,i.height+n.dy),i.insertAdditionalView("info",s),t.onInfoOpened(),cleverapps.config.wysiwygMode)||cc.director.getRunningScene().makeNodeVisible(s);InfoView.latestParent=t},cleverapps.overrideFonts(cleverapps.styles.FONTS,{INFO_TEXT:{size:23,color:cleverapps.styles.COLORS.DARK_TEXT_COLOR},INFO_BUTTON_TEXT:{size:40,color:cleverapps.styles.COLORS.LIGHT_TEXT_COLOR,stroke:cleverapps.styles.DECORATORS.LIGHT_TEXT_STROKE,shadow:cleverapps.styles.DECORATORS.LIGHT_TEXT_SHADOW},INFO_BUILD_BUTTON_TEXT:{size:28,color:cleverapps.styles.COLORS.LIGHT_TEXT_COLOR,stroke:cleverapps.styles.DECORATORS.LIGHT_TEXT_STROKE,shadow:cleverapps.styles.DECORATORS.LIGHT_TEXT_SHADOW},INFO_TIMER_TEXT:{name:"nostroke",size:30,color:cleverapps.styles.COLORS.DARK_TEXT_COLOR}}),cleverapps.styles.InfoView={dy:10,margin:5,padding:{x:20,y:20},pointer:{x:{align:"center"},y:-6},title:{width:185,height:80,icon:{scale:.6,margin:2,padding:{left:-15,right:0,y:0}}},
remains:{width:170,height:25,padding:{x:0,y:0}},timer:{margin:5,padding:{x:0,top:10,bottom:0}},actions:{margin:10,padding:{x:0,top:10,bottom:0}},button:{width:170,height:70,padding:{left:20,right:20,top:5,bottom:10},margin:5},guide:{x:{align:"right",dx:35},y:{align:"top",dy:35}}};var PrizeView=cc.Scale9Sprite.extend({ctor:function(e){e=e||{};var t=cleverapps.styles.PrizeView;this._super(!0===e.warning?bundles.mergeui.frames.background_warning:bundles.mergeui.frames.background),this.setAnchorPoint2(.5,0),this.setContentSize2(t.width,t.height),this.setLocalZOrder(1);var n=new cc.Sprite(!0===e.warning?bundles.mergeui.frames.pointer2_warning:bundles.mergeui.frames.pointer2);if(n.setAnchorPoint2(),n.setPositionRound(this.width/2,t.pointer.dy),this.addChild(n),e.prize||e.sprite){var s;e.sprite?s=new cc.Sprite(e.sprite):(s=UnitView.getUnitImage(e.prize)).clearTrack&&s.clearTrack(0),s.setPositionRound(this.width/2,this.height/2);var i=e.padding||t.padding;cleverapps.UI.fitToBox(s,{
width:this.width-2*i.x,height:this.height-2*i.y}),this.addChild(s)}if(e.animation){var o=new cleverapps.Spine(bundles.mergeui.jsons.timer_json,t.animation.scale);o.setAnchorPoint2(),o.setPositionRound(this.width/2,this.height/2),o.setAnimation(0,"animation",!0),this.addChild(o)}e.attention&&this.createAttention(e.attention),e.onClick&&!cleverapps.environment.isSceneWithPreview()&&cleverapps.UI.onClick(this,e.onClick),this.setScale(.5)},createAttention:function(e){this.attention&&this.attention.removeFromParent();var t=cleverapps.styles.PrizeView,n=this.attention=new cc.Sprite(e);n.setPositionRound(this.width+t.attention.dx,this.height+t.attention.dy),this.addChild(n)},hasAttention:function(){return this.attention},runAnimation:function(){var e=cleverapps.styles.PrizeView;this.runAction(new cc.Sequence(new cc.ScaleTo(.2,1,1).easing(cc.easeIn(1)),new cc.CallFunc(function(){this.runAction(new cc.RepeatForever(new cc.Sequence(new cc.MoveBy(e.duration,0,e.delta).easing(cc.easeInOut(1.7)),
new cc.MoveBy(e.duration,0,-e.delta).easing(cc.easeInOut(1.7)))))}.bind(this))))}});cleverapps.styles.PrizeView={width:72,height:72,padding:{x:10,y:10},duration:1,delta:10,pointer:{dy:2},attention:{dx:-7,dy:-7},animation:{scale:.8}};var HighlightView=cc.Node.extend({ctor:function(e){this._super(),this.highlight=e;var t=bundles.merge.jsons.hint_json;cleverapps.config.wysiwygMode&&cleverapps.flags.wysiwyg.customHighlight&&(t=bundles.ads_map2d.jsons.highlight,this.customHighlight=Game.currentGame.map.getAdsMapView().customHighlightColor,this.setColor(this.customHighlight));var n=new cleverapps.Spine(t);this.setAnchorPoint2(),this.setContentSize2(cleverapps.styles.Map2dView.cell),n.setPositionRound(this.width/2,this.height/2),n.setAnimation(0,"animation",!0),this.addChild(n),this.setLocalZOrder(-1),this.setRecCascadeColorEnabled(),e.onMove=this.createListener(this.move.bind(this)),e.hide=this.createListener(this.hide.bind(this)),e.show=this.createListener(this.show.bind(this)),
e.onRemove=this.createListener(this.removeFromParent.bind(this)),e.up=this.createListener(this.up.bind(this))}});HighlightView.prototype.hide=function(){this.visible=!1},HighlightView.prototype.show=function(e,t){this.visible=!0},HighlightView.prototype.up=function(){this.setLocalZOrder(1)},HighlightView.prototype.move=function(e,t,n){this.stopAllActions();var s=Game.currentGame.map.getView().alignInIsometricGrid(e,t);n?this.setPositionRound(s):this.runAction(new cc.MoveTo(.05,s.x,s.y));var i=cleverapps.styles.COLORS.WHITE;this.highlight.error?i=cleverapps.styles.COLORS.COLOR_RED:cleverapps.config.wysiwygMode&&cleverapps.flags.wysiwyg.customHighlight&&(i=this.customHighlight),this.setColor(i)};var UnitView=cc.Node.extend({ctor:function(e){this._super(),this.unit=e,this.additionalViews={},this.sprite=UnitView.getUnitImage(e);var t=UnitView.getUnitStyles(e);this.setAnchorPoint2(t.anchorX,t.anchorY);var n=this.sprite.getContentSize();n.width=Math.max(
cleverapps.styles.UnitView.minimalSize.width,n.width),n.height=Math.max(cleverapps.styles.UnitView.minimalSize.height,n.height),this.setContentSize2(n),this.sprite.setPositionRound(this.width/2,this.height/2),this.addChild(this.sprite),e.checkTouchInside=this.createListener(this.checkTouchInside.bind(this)),e.onClickEvent=this.createListener(this.handleClick.bind(this)),e.onDragStart=this.createListener(this.handleDragStart.bind(this)),e.onDragMove=this.createListener(this.handleDragMove.bind(this)),e.onDragEnd=this.createListener(this.handleDragEnd.bind(this)),e.onAdd=this.createListener(this.playAddAnimation.bind(this)),e.onDestruction=this.createListener(this.playDestruction.bind(this)),e.onRemove=this.createListener(this.removeFromParent.bind(this)),e.onMove=this.createListener(this.move.bind(this)),e.onStartDidMerged=this.createListener(this.startDidMerged.bind(this)),e.onDidMerged=this.createListener(this.didMerged.bind(this)),e.onMerge=this.createListener(this.merge.bind(this)),
e.onStartAnimateMerge=this.createListener(this.startAnimateMerge.bind(this)),e.onStopAnimateMerge=this.createListener(this.stopAnimateMerge.bind(this)),e.onSqueeze=this.createListener(this.squeeze.bind(this)),e.onSpawned=this.createListener(this.spawn.bind(this)),e.onFogOpen=this.createListener(this.fogOpen.bind(this)),e.onChangePrizes=this.createListener(this.showPrizeView.bind(this)),e.onMarkError=this.createListener(this.markError.bind(this)),e.onMarkNormal=this.createListener(this.markNormal.bind(this)),e.onGetView=this.createListener(function(){return this}.bind(this)),e.onShowPoints=this.createListener(this.showPoints.bind(this)),e.onHidePoints=this.createListener(this.hidePoints.bind(this)),e.onClaimPoints=this.createListener(this.claimPoints.bind(this)),this.unit.components.forEach(function(e){ViewFactory(e,this)},this);var s=this.unit.prizes;void 0!==s&&(s.length||s.minigame)&&this.runAction(new cc.Sequence(new cc.DelayTime(1),new cc.CallFunc(this.showPrizeView.bind(this)))),
this.unit.points&&this.showPoints()},checkTouchInside:function(e){if(!this.isDisplayed())return!1;var t={width:cleverapps.styles.Map2dView.cell.width,height:cleverapps.styles.Map2dView.cell.height};return this.unit.isMultiCell()&&(t.width*=2,t.height*=2),cleverapps.UI.targetContainPoint(this,this.convertTouchToNodeSpace(e),t)},update:function(e){if(void 0!==this.lastDragTouchMove){this.setPositionRound(this.parent.convertTouchToNodeSpace(this.lastDragTouchMove));var t=Game.currentGame.map.getView(),n=t.convertTouchToNodeSpace(this.lastDragTouchMove),s=t.getCellByCoordinates(n);this.unit.handleDragMove(s.x,s.y);var i=cc.director.getRunningScene().scroll;i&&i.borderTouchScrollIteration(this.lastDragTouchMove,15*e/.016,85)}},unscheduleUpdate:function(){this.lastDragTouchMove=void 0,this._super()},cleanup:function(){this._super(),Object.keys(this.additionalViews).forEach(function(e){this.removeAdditionalView(e)}.bind(this)),InfoView.Clear(this.unit)}})
;UnitView.prototype.removeSilent=function(){this.unit.findComponent(Grounded)&&this.unit.findComponent(Grounded).remove(!0),this.removeFromParent()},UnitView.prototype.fogOpen=function(){this.runAction(new cc.Sequence(new cc.ScaleTo(.2,1.2).easing(cc.easeOut(2)),new cc.ScaleTo(.3,1).easing(cc.easeInOut(2))))},UnitView.prototype.spawn=function(e,t,n){var s;if(n.parentWorldPosition)s=this.getParent().convertToNodeSpace(n.parentWorldPosition);else if(n.fromNode)s=e.parent?this.getRelativeCoordinates(e):e;else{(s=Map2dView.IsoToScreen(e.x-this.unit.x,e.y-this.unit.y)).y+=cleverapps.styles.Map2dView.cell.height/2;var i=e.findComponent&&e.findComponent(MultiCell);if(i){var o=i.getCenter();s.x+=o.x,s.y+=o.y}}this.setScale(n.startScale?n.startScale:.3),n.startAnchors&&(s.x+=this.scale*this.width*(this.anchorX-n.startAnchors.anchorX),s.y+=this.scale*this.height*(this.anchorY-n.startAnchors.anchorY));var r={x:this.x-s.x,y:this.y-s.y};this.setPositionRound(s.x,s.y),this.visible=!1
;var a=this.getAnimation(),c=a&&a.findAnimation("landing");c&&(a.setCompleteListener(null),a.setAnimation(0,"landing",!1),a.clearTrack(0)),this.runAction(new cc.Sequence(new cc.DelayTime(.1*t),new cc.Show,new cc.CallFunc(function(){var n=new cleverapps.Particles(bundles.particle.jsons.particles_spawn_json,bundles.game.urls.particle_texture);Game.currentGame.map.getView().animations.addChild(n),n.followTarget(this);var e=.6*(.5+.001*Math.sqrt(r.x*r.x+r.y*r.y));cleverapps.UI.jumpAnimation(this,r,{parent:Game.currentGame.map.getView().animations,h:cleverapps.styles.UnitView.spawnHeight,time:e,spawn:new cc.ScaleTo(e,1).easing(cc.easeOut(2)),callback:function(){var e=Game.currentGame.map.getView().getCell(Map2d.LAYER_UNITS,this.unit.x,this.unit.y),t=new cleverapps.Spine(bundles.merge.jsons.reward_highlight_json);t.setPositionRound(e.width/2,e.height/2),t.setLocalZOrder(-1),t.setCompleteListenerRemove(),t.setAnimation(0,"animation",!1),e.addChild(t),n.stop(),c&&(a.setAnimation(0,"landing",!1
),a.setCompleteListener(function(){a.setCompleteListener(null),UnitView.applyDefaultAnimation(a,this.unit)}.bind(this))),cleverapps.audio.playSound(bundles.merge.urls.spawn_landing_effect)}.bind(this)})}.bind(this))))},UnitView.prototype.squeeze=function(e){this.runAction(new cc.Sequence(new cc.ScaleTo(.1,1.1,.9),new cc.ScaleTo(.1,1,1),new cc.CallFunc(function(){e&&e()})))},UnitView.prototype.handleClick=function(){if(cleverapps.config.debugMode){if(this.lastClick&&this.lastClick>Date.now()-200){var e=Game.currentGame,t=this.unit.findComponent(Buildable);if(e.workers.findAssigned(this.unit)||t&&e.workers.findInstantAssigned(t))return;return InfoView.CloseInfo(),this.unit.onDestruction(),this.unit.remove(!0),void e.fogs.updateBlockedGrounds()}this.lastClick=Date.now()}this.unit.getData().developing&&Game.currentGame.onHintMessage("messages:Unit.Developing"),"decorator"!==this.unit.code&&(this.unit.handleClick()?InfoView.CloseInfo():(cleverapps.audio.playSound(
bundles.main.urls.click_effect),InfoView.SqueezeAndDisplay(this.unit)))},UnitView.prototype.startDidMerged=function(){this.visible=!1;var e=bundles.merge.jsons.merge_json;cleverapps.config.wysiwygMode&&cleverapps.flags.wysiwyg.customMergeAnimation&&(e=bundles.ads_map2d.jsons.merge_json);var t=new cleverapps.Spine(e);this.parent.addChild(t),t.replaceParentSamePlace(Game.currentGame.map.getView().animations),t.setAnimation(0,"animation",!1),t.setCompleteListener(t.removeFromParent.bind(t))},UnitView.prototype.didMerged=function(){this.visible=!0,this.setScale(.5),this.runAction(new cc.Sequence(new cc.ScaleTo(.3,1.2,1.2).easing(cc.easeOut(2)),new cc.ScaleTo(.2,1,1).easing(cc.easeIn(2))))},UnitView.prototype.stopAnimateMerge=function(e){this.animateMergeAction&&!this.animateMergeAction.isDone()&&(this.stopAction(this.animateMergeAction),delete this.animateMergeAction),this.unit!==e&&this.setPositionRound(0,0),this.setScale(1)},UnitView.prototype.merge=function(e){
var t=Game.currentGame.map.getView();this.replaceParentSamePlace(t.getCell(Map2d.LAYER_UNITS,e.x,e.y)),this.runAction(new cc.Sequence(new cc.MoveTo(.2,0,0).easing(cc.easeIn(2)),new cc.RemoveSelf))},UnitView.prototype.startAnimateMerge=function(e){var t=[];if(t.push(new cc.Sequence(new cc.ScaleTo(.3,1),new cc.ScaleTo(.3,1.03),new cc.DelayTime(.1))),0!==this.unit.distanceTo(e)&&this.unit!==e){var n=Game.currentGame.map.getView().getCell(Map2d.LAYER_UNITS,e.x,e.y),s=n.x-this.parent.x,i=n.y-this.parent.y,o=Math.sqrt(s*s+i*i);s=s/o*cleverapps.styles.UnitView.merge,i=i/o*cleverapps.styles.UnitView.merge,2<this.unit.distanceTo(e)&&(s/=2,i/=2),cleverapps.config.wysiwygMode&&cleverapps.flags.wysiwyg.automerge?t.push(new cc.Sequence(new cc.MoveBy(.6,-s,-i).easing(cc.easeBackOut()),new cc.DelayTime(.1))):t.push(new cc.Sequence(new cc.MoveBy(.3,s,i).easing(cc.easeBackIn()),new cc.MoveBy(.3,-s,-i).easing(cc.easeOut(2)),new cc.DelayTime(.1)))}if(0<t.length){var r=1===t.length?t[0]:new cc.Spawn(t)
;this.animateMergeAction=this.runAction(new cc.RepeatForever(r))}},UnitView.prototype.handleDragStart=function(){if(!this.unit.handleDragStart())return!1;for(var e in InfoView.CloseInfo(),this.additionalViews){var t=this.additionalViews[e];this.hideAdditionalView(t,t.replaceParentSamePlace.bind(t,Game.currentGame.map.getView().animations))}var n=Game.currentGame.map.getView();if(this.replaceParentSamePlace(n.animations),this.unit.findComponent(Shine)||this.unit.findComponent(Chest)||this.unit.findComponent(Fruit)){var s=this.path=new cleverapps.Particles(bundles.particle.jsons.particles_drag_json,bundles.game.urls.particle_texture);s.setScale(1/Game.currentGame.getScrollZoom()),s.setPosition(this.width/2,this.height/2),this.addChild(s),s.setLocalZOrder(-1)}return this.scheduleUpdate(),!0},UnitView.prototype.handleDragMove=function(e){this.lastDragTouchMove=e.touch},UnitView.prototype.handleDragEnd=function(){for(var e in this.markNormal(),this.path&&(this.path.stop(),this.path=void 0),
this.additionalViews)this.showAdditionalView(this.additionalViews[e]);this.unscheduleUpdate(),this.unit.handleDragEnd()},UnitView.prototype.markNormal=function(){this.sprite&&this.sprite.setColor(cleverapps.styles.COLORS.WHITE)},UnitView.prototype.markError=function(){this.sprite&&this.sprite.setColor(cleverapps.styles.COLORS.COLOR_RED)},UnitView.prototype.move=function(){var e=Game.currentGame.map.getView();for(var t in this.replaceParentSamePlace(e.getCell(Map2d.LAYER_UNITS,this.unit.x,this.unit.y)),this.additionalViews){var n=this.additionalViews[t];n.replaceParentSamePlace(this),this.updateAdditionalViewPosition(n)}var s={x:0,y:0};this.unit.isMultiCell()&&(s=MultiCellView.calcCenterPosition(this.unit.findComponent(MultiCell).shape)),this.stopAllActions(),this.runAction(new cc.Sequence(new cc.MoveTo(.1,s),new cc.CallFunc(function(){for(var e in this.additionalViews){var t=this.additionalViews[e];t.replaceParentSamePlace(Game.currentGame.map.getView().animations),
this.updateAdditionalViewPosition(t)}}.bind(this))))},UnitView.UnitIconFrame=function(e){return bundles["unit_"+e.code].frames["unit_"+e.code+(e.stage+1)]},UnitView.UnitIconJson=function(e){return bundles["unit_"+e.code].jsons["unit_"+e.code+(e.stage+1)]},UnitView.getUnitStyles=function(e){var t=cleverapps.styles.UnitAnchors[e.code]&&cleverapps.styles.UnitAnchors[e.code]["stage"+(e.stage+1)]||{};return{anchorX:void 0===t.anchorX?.5:t.anchorX,anchorY:void 0===t.anchorY?.5:t.anchorY}},UnitView.getUnitAnimations=function(e){return cleverapps.styles.UnitAnimations[e.code]&&cleverapps.styles.UnitAnimations[e.code]["stage"+(e.stage+1)]},UnitView.getUnitImage=function(e){if(!bundles["unit_"+e.code])throw"Not found bundle unit_"+e.code;var t,n=UnitView.UnitIconJson(e),s=UnitView.UnitIconFrame(e);if(!n&&!s)throw"Not found frame unit_"+(e.code+(e.stage+1));return n?(t=new cleverapps.Spine(n),UnitView.applyDefaultAnimation(t,e)):t=new cc.Sprite(s),t},UnitView.applyDefaultAnimation=function(e,t){
var n=UnitView.getUnitAnimations(t);n?e.setIdleSet(n):e.setAnimation(0,e.findAnimation("idle")?"idle":"animation",!0)},UnitView.prototype.playDestruction=function(){this.stopAllActions();var e=new cleverapps.Spine(bundles.merge.jsons.destruction_json);e.setPositionRound(this.width/2,this.height/2),e.setCompleteListenerRemove(this.removeFromParent.bind(this)),e.setAnimation(0,"animation",!1),this.addChild(e),e.replaceParentSamePlace(this.parent),this.unit.findComponent(Grounded)&&this.unit.findComponent(Grounded).remove(),cleverapps.audio.playSound(bundles.merge.urls.unit_desturction_effect),this.runAction(new cc.Sequence(new cc.ScaleTo(.2,1.3,1.3).easing(cc.easeIn(1)),new cc.ScaleTo(.2,.5,.5).easing(cc.easeOut(1)),new cc.RemoveSelf))},UnitView.prototype.playAppearance=function(){this.stopAllActions();var e=new cleverapps.Spine(bundles.merge.jsons.appearance_json);e.setPositionRound(this.width/2,this.height/2),e.setCompleteListenerRemove(this.removeFromParent.bind(this)),e.setAnimation(
0,"animation",!1),this.addChild(e),e.replaceParentSamePlace(this.parent),this.runAction(new cc.Sequence(new cc.ScaleTo(.2,1.3,1.3).easing(cc.easeIn(1)),new cc.ScaleTo(.2,.5,.5).easing(cc.easeOut(1)),new cc.RemoveSelf))},UnitView.prototype.playAddAnimation=function(){var e=new cleverapps.Spine(bundles.buildable.jsons.buildable_above_json);e.setLocalZOrder(1),e.setAnimation(0,"animation_bonus",!1),e.setCompleteListenerRemove(),this.parent.addChild(e),this.setVisible(!1),this.setScale(.3),this.runAction(new cc.Sequence(new cc.DelayTime(.3),new cc.PlaySound(bundles.merge.urls.specialoffer_appearance_effect),new cc.Show,new cc.ScaleTo(.4,1.3),new cc.ScaleTo(.2,1)))},UnitView.prototype.showPrizeView=function(e){if(!cleverapps.config.wysiwygMode||!cleverapps.flags.wysiwyg.hidePrizeView){this.removeAdditionalView("prize");var t=this.unit.prizes;if(void 0!==t){var n={warning:e,onClick:this.handleClick.bind(this)};this.unit.findComponent(MakesOrder)&&(
n.attention=bundles.mergeui.frames.small_ok_exclamation),t.minigame?n.sprite=bundles.merge.frames.pickaxe:n.prize=t[0];var s=new PrizeView(n);s.setPositionRound(this.width/2,this.height),this.insertAdditionalView("prize",s),cleverapps.audio.playSound(bundles.merge.urls.prize_view_created_effect)}}},UnitView.prototype.insertAdditionalView=function(e,t,n,s){this.removeAdditionalView(e),this.addChild(t),t.basePosition=t.getPosition(),t.invertZOrder="timer"===e;var i=Game.currentGame,o=i.map.getView();o&&t.replaceParentSamePlace(o.animations),this.additionalViews[e]=t,i.map.dragging===this.unit?t.setVisible(!1):this.showAdditionalView(t,n,s)},UnitView.prototype.getAdditionalView=function(e){return this.additionalViews[e]},UnitView.prototype.removeAdditionalView=function(e,t,n){var s=this.additionalViews[e];if(s){delete this.additionalViews[e];var i=function(){s.removeFromParent(),t&&t()};n?i():this.hideAdditionalView(s,i)}return s},UnitView.prototype.showAdditionalView=function(e,t,n){if(
!cleverapps.config.editorMode&&(this.updateAdditionalViewPosition(e),!n)){var s=[new cc.Show,new cc.ScaleTo(.2,1,1).easing(cc.easeIn(1))];t&&s.push(new cc.CallFunc(t)),e.runAnimation&&s.push(new cc.CallFunc(e.runAnimation.bind(e))),e.stopAllActions(),e.setScale(.5),e.runAction(new cc.Sequence(s))}},UnitView.prototype.updateAdditionalViewPosition=function(e){var t=Game.currentGame.map.getView(),n=t&&e.invertZOrder?e.y-2*t.height:-e.y;e.setPositionRound(e.parent.convertToNodeSpace(this.convertToWorldSpace(e.basePosition))),e.setLocalZOrder(n)},UnitView.prototype.hideAdditionalView=function(e,t){var n=[new cc.ScaleTo(.1,.5,.5).easing(cc.easeIn(1)),new cc.Hide];t&&n.push(new cc.CallFunc(t)),e.stopAllActions(),e.setScale(1),e.runAction(new cc.Sequence(n))},UnitView.prototype.setImageOpacity=function(e){this.sprite.setOpacity(e)},UnitView.prototype.onDeletePressed=function(){confirm('Delete unit "'+this.unit.code+"'?")&&(this.unit.onDestruction(),this.unit.remove(!0),
Game.currentGame.fogs.updateBlockedGrounds())},UnitView.prototype.getAnimation=function(){if(this.sprite instanceof cleverapps.Spine)return this.sprite},UnitView.prototype.showPoints=function(){var e=cleverapps.styles.UnitView.pointsAnimation;if(!this.pointAnimation){var t=this.pointAnimation=new cleverapps.Spine(bundles.merge.jsons.battle_star);t.setAnchorPoint2(),t.setPositionRound(e),t.setAnimation(0,"idle",!0),this.addChild(t),t.setScale(.1),t.runAction(new cc.ScaleTo(1,1)),t.runAction(new cc.MoveBy(1,0,e.offsetY)),cleverapps.UI.onTouchBegan(t,this.unit.onTouchBeginEvent.bind(this.unit)),cleverapps.config.wysiwygMode&&cleverapps.flags.wysiwyg.hideUnitPointAnimation&&t.setVisible(!1)}},UnitView.prototype.hidePoints=function(){var e=cleverapps.styles.UnitView.pointsAnimation;this.pointAnimation&&(this.pointAnimation.stopAllActions(),this.pointAnimation.runAction(new cc.ScaleTo(.3,.1)),this.pointAnimation.runAction(new cc.Sequence(new cc.MoveBy(.3,0,-e.offsetY),new cc.RemoveSelf)),
delete this.pointAnimation)},UnitView.prototype.claimPoints=function(e){if(this.pointAnimation){this.pointAnimation.stopAllActions();var n=cleverapps.styles.SideBarIconView.battlepass;n?cleverapps.UI.collectAnimation(this.pointAnimation,n,{targetEffect:!0,callback:function(){cleverapps.UI.animateDelta(e,{x:cleverapps.styles.UnitView.iconPoints.position.x,y:cleverapps.styles.UnitView.iconPoints.position.y,parent:n,font:cleverapps.styles.FONTS.MENUBAR_TEXT}),cleverapps.audio.playSound(bundles.collectible.urls.exp_fly_finish_effect);var t=cleverapps.missionManager.findByType(Mission.TYPE_BATTLEPASS);t&&t.logic.displayOnFreeFocus()&&!cleverapps.metha.isFocused()&&cleverapps.metha.display({focus:t.name+"Window",action:function(e){new t.view(t),cleverapps.metha.onceNoWindowsListener=e}})}}):this.pointAnimation.removeFromParent(),delete this.pointAnimation}},cleverapps.styles.UnitView={merge:16,iconPoints:{position:{x:{align:"center"},y:{align:"center",dy:100}}},minimalSize:{width:108,
height:80},spawnHeight:240,pointsAnimation:{x:{align:"center",dx:0},y:{align:"center",dy:0},offsetY:50}};var OrdersTab=cc.Node.extend({ctor:function(t){var e=cleverapps.styles.OrdersTab;this._super(),this.setContentSize2(e);var n=Game.currentGame.orders.listOrders();if(0===n.length){var s=cleverapps.UI.generateOnlyText("messages:OrdersWindow.orders.placeholder",cleverapps.styles.FONTS.DARK_TEXT);return s.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER),s.setDimensions(.9*this.width,0),s.setPositionRound(this.width/2,this.height/2),void this.addChild(s)}this.createScroll(),void 0===t&&(t=Game.currentGame.orders.findReady()||Game.currentGame.orders.findCanCook());var i=n.filter(function(e){return e.maker===t})[0]||n[0];this.selectOrder(i)},createDetails:function(e){this.details&&(this.details.removeFromParent(),delete this.details);var t=cleverapps.styles.OrdersTab.details,n=this.details=new OrderDetails(e);n.setAnchorPoint2(),n.setPositionRound(t),this.addChild(n)},
createScroll:function(){var e,t=cleverapps.styles.OrdersTab.scroll,n=Game.currentGame.orders.listOrders(),s=this.icons=n.map(function(e){return new OrderMakerIcon(e,this.createListener(this.selectOrder.bind(this,e)))},this),i=new cleverapps.Layout(s,{direction:cleverapps.UI.HORIZONTAL,margin:t.margin,padding:t.padding});i.width>t.width?((e=new cleverapps.UI.ScrollView(i,{childrenVisibility:cleverapps.UI.ScrollView.CHILDREN_VISIBILITY_NONE,direction:cleverapps.UI.ScrollView.DIR_HORIZONTAL,scrollBarEnabled:!1})).setContentSize2(t.width,t.height),e.scrollToDefault()):((e=new cc.Node).setContentSize2(t.width,t.height),i.setPositionRound({align:"left"},{align:"top"}),e.addChild(i)),e.setAnchorPoint2(),e.setPositionRound(t),this.addChild(e)},selectOrder:function(t){this.icons.forEach(function(e){e.unit===t.maker.unit?e.onSelect():e.onUnSelect()}),this.createDetails(t)}});cleverapps.styles.OrdersTab={width:1800,height:1030,details:{width:1150,height:450,x:{align:"center"},y:{align:"top",
dy:-55}},scroll:{width:1752,height:395,x:{align:"center"},y:{align:"bottom",dy:35},margin:50,padding:{x:60,y:60}}};var OrderMakerIcon=cc.Sprite.extend({ctor:function(e,t){this.order=e,this.unit=e.maker.unit,this._super(bundles.orderswindow.frames.hero_background),this.icon=new cc.Sprite(bundles.unitslibrarywindow.frames["icon_"+this.unit.code]),this.addChild(this.icon),cleverapps.UI.applyHover(this),cleverapps.UI.onClick(this,t,{swallowTouches:!1,ignoreOnTouchMoved:!0,useInteractiveScale:!0}),Game.currentGame.orders.on("canCook",this.updateAttention.bind(this),this),Game.currentGame.orders.on("updateOrder",this.updateAttention.bind(this),this),this.setCascadeOpacityEnabled(!0),this.setCascadeColorEnabled(!0),this.updateAttention()},setAttention:function(e){this.attention&&(this.attention.removeFromParent(),delete this.attention);var t=this.attention=new cc.Sprite(e);t.setPositionRound(cleverapps.styles.OrderMakerIcon.attention),t.setLocalZOrder(2),this.addChild(t)},
removeAttention:function(){this.attention&&(this.attention.runAction(new cc.Sequence(new cc.ScaleTo(.15,0),new cc.RemoveSelf)),delete this.attention)},onSelect:function(){this.selected=!0,this.setColor(new cc.Color(255,255,255,255)),this.icon.setOpacity(255),this.setSpriteFrame(bundles.orderswindow.frames.hero_selected_background),this.icon.setPositionRound(cleverapps.styles.OrderMakerIcon.icon_selected),this.updateAttention()},onUnSelect:function(){this.selected=!1,this.setColor(new cc.Color(160,160,160,255)),this.icon.setOpacity(140),this.setSpriteFrame(bundles.orderswindow.frames.hero_background),this.icon.setPositionRound(cleverapps.styles.OrderMakerIcon.icon),this.updateAttention()},updateAttention:function(){switch(this.order.maker.state){case MakesOrder.STATE_RECIPE:this.order.maker.canCook()?this.setAttention(bundles.mergeui.frames.attention_exclamation):this.unit.prize||this.setAttention(bundles.mergeui.frames.attention_exclamation_disabled);break
;case MakesOrder.STATE_COOKING:this.unit.prize?this.removeAttention():this.setAttention(bundles.mergeui.frames.attention_sandglass);break;case MakesOrder.STATE_READY:this.setAttention(bundles.mergeui.frames.attention_ok);break;default:this.removeAttention()}}});cleverapps.styles.OrderMakerIcon={icon:{x:{align:"center",dx:0},y:{align:"bottom",dy:12}},icon_selected:{x:{align:"center",dx:0},y:{align:"bottom",dy:30}},attention:{x:{align:"center",dx:100},y:{align:"center",dy:100}}};var OrderDetails=cc.Node.extend({ctor:function(e){var t=cleverapps.styles.OrderDetails;this._super(),this.setContentSize2(t),this.setAnchorPoint2(),this.order=e=cleverapps.extend({},e,{prize:!0});var n=cleverapps.UI.createScale9Sprite(bundles.orderswindow.frames.ow_details_background,cleverapps.UI.Scale9Rect.TwoPixelXY);n.setContentSize2(t),n.setPositionRound(this.width/2,this.height/2),this.addChild(n);var s=this.prize=this.createPrize(e),i=this.rewards=this.createRewards(),o=this.button=this.createButton(),
r=this.ingredients=this.createIngredients(),a=this.timer=this.createTimer();s.addChild(a);var c=new cleverapps.Layout([i,r],{direction:cleverapps.UI.VERTICAL,margin:t.verticalMargin}),l=new cleverapps.Layout([o,s],{direction:cleverapps.UI.VERTICAL,margin:t.verticalMargin}),p=new cc.Sprite(bundles.orderswindow.frames.equal_separator);p.setAnchorPoint2();var d=new cleverapps.Layout([c,p,l],{direction:cleverapps.UI.HORIZONTAL,margin:t.horizontalMargin,align:cleverapps.UI.ALIGN_END});d.setAnchorPoint2(.5,1),d.setPositionRound(t),n.addChild(d),p.y+=t.equalSeparatorOffsetY,Game.currentGame.orders.on("updateOrder",function(e){e===this.order.maker&&(this.updateButton(),this.updateTimer(),this.updateIngredients())}.bind(this),this)},createPrize:function(){var e=cleverapps.styles.OrderDetails.prize,t=this.order,n=new cc.Node;n.setAnchorPoint2(),n.setContentSize2(e);var s=new cc.Sprite(bundles.merge.frames.stand_ground);s.setAnchorPoint2(),s.setPositionRound(e.ground),n.addChild(s)
;var i=new cc.Node;return i.sprite=UnitView.getUnitImage(t),i.addChild(i.sprite),i.setContentSize(i.sprite.getContentSize()),i.sprite.setPositionRound(i.width/2,i.height/2),BubbleView(void 0,i),i.setPositionRound(e.icon),i.setScale(e.icon.scale),n.addChild(i),n},createTimer:function(){var e,t=cleverapps.styles.OrderDetails.timer,n=this.order.maker.getTimeLeft();return n?(e=new cleverapps.CountDownView(new cleverapps.CountDown(n),{font:cleverapps.styles.FONTS.ORDERDETAILS_TIMER_TEXT,background_image:{image:bundles.mergeui.frames.timer_substrate,width:t.width,height:t.height,scale9:!0}})).fitTo(.9*e.width,e.height):e=new cc.Node,e.setPositionRound(t),e},createRewards:function(){var n=cleverapps.styles.OrderDetails.rewards,e=cleverapps.UI.generateOnlyText("messages:OrdersWindow.orders.reward",cleverapps.styles.FONTS.ORDERDETAILS_REWARD_LABEL_TEXT);e.fitTo(n.label.width,n.label.height);var t=this.order.recipe.prize.map(function(e){var t=UnitView.getUnitImage(e)
;return t.clearTrack&&t.clearTrack(0),cleverapps.UI.fitToBox(t,{width:t.width,height:n.height}),t.scale*=1.4*(OrderDetails.UNIT_SCALES[Unit.GetKey(e)]||1),t});return t.unshift(e),new cleverapps.Layout(t,{direction:cleverapps.UI.HORIZONTAL,margin:n.margin,padding:n.padding})},claimIngredients:function(){this.ingredients&&this.ingredients.icons&&this.ingredients.icons.forEach(function(e){e.flyIconAnimation(this.prize)},this),this.prize.runAction(new cc.Sequence(new cc.DelayTime(.8),new cc.CallFunc(function(){var e=new cleverapps.Spine(bundles.orderswindow.jsons.ow_rewards_highlight_json,1.7);e.setAnchorPoint2(),e.setPositionRound(this.width/2,this.height/2),e.setAnimation(0,"animation",!1),e.setCompleteListenerRemove(),this.addChild(e)},this.prize)))},createButton:function(){var e,t=cleverapps.styles.OrderDetails.button,n=this.order.maker;if(n.state===MakesOrder.STATE_COOKING)e=new UseGoldButton({price:SpeedUpWindow.CalcPrice(n.getTimeLeft()),onClicked:this.makeOrder.bind(this),
font:cleverapps.styles.FONTS.ORDERDETAILS_BUTTON_TEXT,image:bundles.reward_icons.frames.gold_small_png,eventName:"speedup_order_ruby"},t);else if(-1!==[MakesOrder.STATE_RECIPE,MakesOrder.STATE_READY].indexOf(n.state)){var s=MakesOrder.STATE_RECIPE===n.state?"messages:OrdersWindow.orders.button.make":"messages:OrdersWindow.orders.button.claim";if(e=new cleverapps.UI.Button({styles:t,content:cleverapps.UI.generateOnlyText(s,cleverapps.styles.FONTS.ORDERDETAILS_BUTTON_TEXT),onClicked:this.makeOrder.bind(this),button_images:cleverapps.UI.Button.Images.button_green}),n.state===MakesOrder.STATE_READY&&!Game.currentGame.tutorial.isActive()){var i=new FingerView({scaleX:.8,scaleY:.8});e.addChild(i),i.setPositionRound(e.width/2,e.height/2),i.standardLoop({delay:2.5})}}return e.adviceTarget=Merge.SPAWN,e},createIngredients:function(){for(var e=cleverapps.styles.OrderDetails.ingredients,t=Object.keys(this.order.recipe.ingredients),n=(t=t.concat(cleverapps.arrayFill(3-t.length,"")).reverse()).map(
function(e){return new IngredientOrderIcon({code:e,stage:4,order:this.order})},this),s=n.slice(),i=0;i<n.length;i+=2){var o=new cc.Sprite(bundles.orderswindow.frames.plus_separator);""===s[i].unit.code&&o.setOpacity(150),s.splice(i+1,0,o)}var r=new cleverapps.Layout(s,{direction:cleverapps.UI.HORIZONTAL,margin:e.margin});return r.setAnchorPoint2(),r.icons=n,r},updateButton:function(){var e=this.button;if(e){var t=this.createButton();t.setVisible(!1),t.setScale(.1),t.setPositionRound(e.getPosition()),e.parent.addChild(t),e.runAction(new cc.Sequence(new cc.ScaleTo(.15,.1),new cc.CallFunc(t.runAction.bind(t,new cc.Sequence(new cc.Show,new cc.ScaleTo(.15,1)))),new cc.RemoveSelf)),this.button=t}},updateTimer:function(){var e=this.timer;if(e){var t=this.createTimer();t.setPositionRound(e.getPosition()),e.parent.addChild(t),e.removeFromParent(),this.timer=t}},updateIngredients:function(){var e=this.ingredients;if(e){var t=this.createIngredients();t.setPositionRound(e.getPosition()),
e.parent.addChild(t),e.removeFromParent(),this.ingredients=t}},makeOrder:function(){var e=this.order.maker;switch(e.state){case MakesOrder.STATE_RECIPE:e.cook()?(this.claimIngredients(),this.updateIngredients(),this.updateButton(),this.updateTimer()):this.showBuyIngredientsWindow();break;case MakesOrder.STATE_COOKING:e.enjoy()&&(this.updateIngredients(),this.updateButton(),this.updateTimer());break;case MakesOrder.STATE_READY:var t=e.unit;cleverapps.windows.currentWindow().close(),Game.currentGame.map.onCenterTo(t.x,t.y,{callback:t.handleClick.bind(t)})}},showBuyIngredientsWindow:function(){var e=Game.currentGame.harvested.calcMissingIngredients(this.order.recipe);cleverapps.metha.showControlsWhileFocused("MenuBarGoldItem"),new BuyIngredientsWindow(e,function(){cleverapps.metha.hideControlsWhileFocused("MenuBarGoldItem"),this.order.maker.canCook()&&this.makeOrder()}.bind(this))}});OrderDetails.UNIT_SCALES={wands_0:.85,wands_1:1.2,wands_3:1.3,wands_4:1.1,wands_5:1.3},
cleverapps.overrideFonts(cleverapps.styles.FONTS,{ORDERDETAILS_REWARD_LABEL_TEXT:{size:60,color:cleverapps.styles.COLORS.LIGHT_TEXT_COLOR,stroke:cleverapps.styles.DECORATORS.LIGHT_TEXT_STROKE,shadow:cleverapps.styles.DECORATORS.LIGHT_TEXT_SHADOW},ORDERDETAILS_TIMER_TEXT:{size:48,color:cleverapps.styles.COLORS.LIGHT_TEXT_COLOR,stroke:cleverapps.styles.DECORATORS.LIGHT_TEXT_STROKE,shadow:cleverapps.styles.DECORATORS.LIGHT_TEXT_SHADOW},ORDERDETAILS_BUTTON_TEXT:{size:54,color:cleverapps.styles.COLORS.LIGHT_TEXT_COLOR,stroke:cleverapps.styles.DECORATORS.LIGHT_TEXT_STROKE,shadow:cleverapps.styles.DECORATORS.LIGHT_TEXT_SHADOW}}),cleverapps.styles.OrderDetails={width:1680,height:550,x:{align:"center"},y:{align:"top",dy:-60},horizontalMargin:30,verticalMargin:15,equalSeparatorOffsetY:-120,ingredients:{margin:15},rewards:{margin:20,padding:{x:10,y:0},height:84,label:{width:310,height:0}},button:{width:280,height:100,padding:{left:20,right:20,top:5,bottom:5},margin:4},prize:{width:300,height:300,
icon:{x:{align:"center",dx:-7},y:{align:"center",dy:-20},scale:1.7},ground:{x:{align:"center",dx:0},y:{align:"center",dy:-25}}},timer:{x:{align:"center"},y:{align:"bottom",dy:5},width:250,height:64}};var IngredientIcon=cc.Scale9Sprite.extend({ctor:function(e){var t=cleverapps.styles.IngredientIcon;this._super(bundles.mergeui.frames.icon_background),this.setContentSize2(t);var n=UnitView.getUnitImage(e);n.setScale(t.icon.scale),n.setPositionRound(t.icon),this.addChild(n);var s=Game.currentGame.harvested.get(e.code),i=cleverapps.UI.generateImageText(s,cleverapps.styles.FONTS.INGREDIENT_ICON_TEXT);i.setLocalZOrder(2),i.setPositionRound(t.amountText),this.addChild(i)}});cleverapps.overrideFonts(cleverapps.styles.FONTS,{INGREDIENT_ICON_TEXT:{name:"default",size:72,color:cleverapps.styles.COLORS.LIGHT_TEXT_COLOR}}),cleverapps.styles.IngredientIcon={width:280,height:280,icon:{x:{align:"center",dx:0},y:{align:"center",dy:10},scale:1.4},amountText:{x:{align:"right",dx:-35},y:{align:"bottom",
dy:35}}};var IngredientOrderIcon=cc.Scale9Sprite.extend({ctor:function(e){this.unit=e,this._super(bundles.mergeui.frames.icon_background_light),this.setContentSize2(cleverapps.styles.IngredientOrderIcon),e.code?(this.addIcon(),this.addAmountText()):this.setOpacity(150)},addIcon:function(){var e=cleverapps.styles.IngredientOrderIcon.icon,t=this.icon=UnitView.getUnitImage(this.unit);t.setScale(e.scale),t.setPositionRound(e),this.addChild(t);var n=this.unit.order;n&&n.maker.state!==MakesOrder.STATE_RECIPE&&t.setOpacity(127)},addAmountText:function(){var e=this.unit.order;if(!e||e.maker.state===MakesOrder.STATE_RECIPE){var t=cleverapps.styles.IngredientOrderIcon,n=Game.currentGame.harvested.get(this.unit.code),s=this.unit.order.recipe.ingredients[this.unit.code],i=cleverapps.UI.generateImageText(n,cleverapps.styles.FONTS.INGREDIENT_ORDER_ICON_TEXT);i.setColor(n<s?cleverapps.styles.COLORS.COLOR_RED:cleverapps.styles.COLORS.GREEN);var o=cleverapps.UI.generateImageText("/"+s,
cleverapps.styles.FONTS.INGREDIENT_ORDER_ICON_TEXT),r=new cleverapps.Layout([i,o],{direction:cleverapps.UI.HORIZONTAL});r.setLocalZOrder(2),r.setPositionRound(t.amountText),cleverapps.UI.fitToBox(r,{width:t.amountText.width,height:r.height}),this.addChild(r)}},flyIconAnimation:function(e){if(this.unit.code){var t=UnitView.getUnitImage(this.unit),n=cc.director.getRunningScene().scene,s=n.convertToNodeSpace(this.convertToWorldSpace(this.icon)),i=n.convertToNodeSpace(e.parent.convertToWorldSpace(e));n.addChild(t),t.setLocalZOrder(100),t.setPositionRound(s),t.runAction(new cc.Sequence(new cc.ScaleTo(0,this.scale),new cc.Spawn(new cc.JumpTo(.8,i.x,i.y,200,1),new cc.Sequence(new cc.ScaleTo(.6,2),new cc.ScaleTo(.2,this.scale))),new cc.RemoveSelf))}}});cleverapps.overrideFonts(cleverapps.styles.FONTS,{INGREDIENT_ORDER_ICON_TEXT:{name:"default",size:72,color:cleverapps.styles.COLORS.LIGHT_TEXT_COLOR}}),cleverapps.styles.IngredientOrderIcon={width:280,height:280,icon:{x:{align:"center",dx:0},y:{
align:"center",dy:35},scale:1.4},amountText:{width:200,x:{align:"center",dx:0},y:{align:"bottom",dy:35}}};var OrdersWindowUnitsTab=cc.Node.extend({ctor:function(e){var t=cleverapps.styles.OrdersWindowUnitsTab;this._super(),this.setContentSize2(t);var n=new cleverapps.GridLayout(e,{columns:5,direction:cleverapps.GridLayout.TOP_TO_BOTTOM,margin:t.grid.margin,padding:t.grid.padding});n.height>t.grid.height&&((n=new cleverapps.UI.ScrollView(n,{childrenVisibility:cleverapps.UI.ScrollView.CHILDREN_VISIBILITY_FULLCHECK,direction:cleverapps.UI.ScrollView.DIR_VERTICAL,scrollBarEnabled:!1})).setContentSize(t.grid.width,t.grid.height),n.scrollToDefault()),n.setAnchorPoint2(),n.setPositionRound(t.grid),this.addChild(n)}});cleverapps.styles.OrdersWindowUnitsTab={width:1800,height:1030,grid:{x:{align:"left",dx:62},y:{align:"top",dy:-5},width:1680,height:990,margin:{x:60,y:40},padding:{x:25,y:60}}};var RecipeIcon=cc.Scale9Sprite.extend({ctor:function(e){var t=cleverapps.styles.RecipeIcon;this.unit=e,
this.recipe=Families.dishes.units[e.stage].recipe,this._super(bundles.mergeui.frames.icon_background),this.setContentSize2(t);var n=Game.currentGame.gameLevel.getLevel();this.recipe.level<=n?(this.addIcon(),this.addTooltip()):this.addLevelBlocker()},addIcon:function(){var e=cleverapps.styles.RecipeIcon.icon,t=UnitView.getUnitImage(this.unit);t.setScale(e.scale),t.setPositionRound(e),this.addChild(t)},addLevelBlocker:function(){var e=cleverapps.styles.RecipeIcon.blocker,t=new cc.Sprite(bundles.mergeui.frames.icon_blocker);t.setPositionRound(e),this.addChild(t);var n=new cleverapps.UI.generateImageText(this.recipe.level,cleverapps.styles.FONTS.RECIPE_ICON_BLOCKER_TEXT);n.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER),n.setPositionRound(e.text),n.fitTo(e.text.width,e.text.height),t.addChild(n)},addTooltip:function(){var n=cleverapps.styles.RecipeIcon.tooltip,e=cleverapps.UI.generateOnlyText("messages:OrdersWindow.icons.required",cleverapps.styles.FONTS.DARK_TEXT),t=Object.keys(
this.recipe.ingredients).map(function(e){var t=UnitView.getUnitImage({code:e,stage:4});return t.setScale(n.scale),t});t=new cleverapps.Layout(t,{direction:cleverapps.UI.HORIZONTAL,margin:n.margin});var s=new cleverapps.Layout([t,e],{direction:cleverapps.UI.VERTICAL,margin:n.margin});cleverapps.tooltipManager.create(this,{content:s,size:s.getContentSize(),position:cleverapps.styles.UI.Tooltip.LOCATION.below,swallowTouches:!1,ignoreOnTouchMoved:!0,ignoreOnTouchMovedThreshold:n.ignoreOnTouchMovedThreshold,useInteractiveScale:!0})}});cleverapps.overrideFonts(cleverapps.styles.FONTS,{RECIPE_ICON_BLOCKER_TEXT:{name:"nostroke",size:58,color:cleverapps.styles.COLORS.DARK_TEXT_COLOR}}),cleverapps.styles.RecipeIcon={width:280,height:280,blocker:{x:{align:"center"},y:{align:"center"},text:{width:62,height:85,x:{align:"center",dx:8},y:{align:"center",dy:-29}}},tooltip:{scale:1,margin:0,ignoreOnTouchMovedThreshold:10},icon:{x:{align:"center"},y:{align:"center",dy:5},scale:1.8}}
;var OrdersWindow=Window.extend({onWindowLoaded:function(e){var t=cleverapps.styles.OrdersWindow;this.tabsInfo=this.createTabs(e),this._super({name:"OrdersWindow",title:"messages:OrdersWindow.orders.title",adjustToContent:!0,closeButton:!0,noBackground:!0,regularCloseButton:!0,extraWidth:2*t.contentOffsetX,contentOffsetX:t.contentOffsetX,content:this.createContent(),foreground:bundles.windows.frames.window_foreground_png}),cleverapps.audio.playSound(bundles.main.urls.window_effect),this.tabs.activateTab(0)},createTabs:function(e){var t=function(e){return this.content.addChild(e),e}.bind(this);return{0:{icon:bundles.windows.frames.tab_icon_orders,updateTitle:this.setTitle.bind(this,"messages:OrdersWindow.orders.title"),generator:function(){return t(new OrdersTab(e))}},1:{icon:bundles.windows.frames.tab_icon_recipes,updateTitle:this.setTitle.bind(this,"messages:OrdersWindow.recipes.title"),generator:function(){return t(new OrdersWindowUnitsTab(this.listRecipeUnits()))}.bind(this)},2:{
icon:bundles.windows.frames.tab_icon_ingredients,updateTitle:this.setTitle.bind(this,"messages:OrdersWindow.ingredients.title"),generator:function(){return t(new OrdersWindowUnitsTab(this.listIngredientUnits()))}.bind(this)}}},createContent:function(){var e=cleverapps.styles.OrdersWindow,t=this.content=cleverapps.UI.createScale9Sprite(bundles.windows.frames.window_bg_png,cleverapps.styles.Window.Background.scale9);t.setContentSize2(e.width,e.height);var n=this.tabs=new Tabs(this.tabsInfo,e.tabs);return n.setAnchorPoint2(),n.setPositionRound(e.tabs),t.addChild(n),t},listIngredientUnits:function(){return Game.currentGame.listAvailableByType("fruit").map(function(e){return new IngredientIcon({code:e,stage:4})})},listRecipeUnits:function(){return Families.dishes.units.map(function(e,t){return new RecipeIcon({code:"dishes",stage:t})})}});cleverapps.overrideFonts(cleverapps.styles.FONTS,{ORDERSWINDOW_TITLE:{size:24,color:cleverapps.styles.COLORS.LIGHT_TEXT_COLOR,
stroke:cleverapps.styles.DECORATORS.LIGHT_TEXT_STROKE,shadow:cleverapps.styles.DECORATORS.LIGHT_TEXT_SHADOW},ORDERSWINDOW_TITLE_DISABLED:{size:24,color:cleverapps.styles.COLORS.LIGHT_TEXT_DISABLED_COLOR,stroke:cleverapps.styles.DECORATORS.LIGHT_TEXT_STROKE,shadow:cleverapps.styles.DECORATORS.LIGHT_TEXT_SHADOW}}),cleverapps.styles.OrdersWindow={width:1800,height:1050,contentOffsetX:60,tabs:{x:{align:"left",dx:-118},y:{align:"top",dy:-40}}};var UnitOnCell=cc.Node.extend({ctor:function(e,t){var n=(t=t||{}).scale||1,s=cleverapps.styles.UnitOnCell;this._super(),this.setAnchorPoint2(),this.setContentSize2(s.width*n,s.height*n);var i=new cc.Sprite(bundles.merge.frames.stand_ground);i.setAnchorPoint2(),i.setPositionRound(this.width/2+s.ground.x*n,this.height/2+s.ground.y*n),i.setScale(s.ground.scale*n),this.addChild(i);var o=UnitView.getUnitStyles(e);if(t.animation){var r=new cleverapps.Spine(bundles.unitoncell.jsons.prize_shining_json,s.shine.scale*n);r.setPositionRound(
this.width/2+s.shine.x*n,this.height/2+s.shine.y*n),r.setAnimation(0,"idle",!0),this.addChild(r)}var a=UnitView.getUnitImage(e);a.setAnchorPoint2(o.anchorX,o.anchorY),a.setPositionRound(this.width/2+s.icon.x*n,this.height/2+s.icon.y*n),a.setScale(n),this.addChild(a)}});cleverapps.styles.UnitOnCell={width:169,height:131,icon:{x:0,y:-22},shine:{x:0,y:-9,scale:.75},ground:{x:3,y:-24,scale:.625}};var OpenChestWindow=Window.extend({onWindowLoaded:function(e,t){this.unit=e,this.asyncResult=t,this._super({title:this.getTitle(),name:"OpenChestWindow",content:this.createContent(),buttons:this.createButton(),adjustToContent:!0,closeButton:!0,foreground:bundles.windows.frames.window_foreground_png}),cleverapps.audio.playSound(bundles.main.urls.window_effect)},getTitle:function(){var e=Messages.get("sacks"===this.unit.getResource()?"sack":"chest");return Messages.get("OpenChestWindow.title",{name:e})},openChest:function(){this.asyncResult.executed=!0,this.close()},generateContains:function(){
var s=cleverapps.styles.OpenChestWindow.prize,i=[];return this.unit.findComponent(Chest).listAvailable().forEach(function(e){var t=new cc.Scale9Sprite(bundles.openchestwindow.frames.icon_background_light);t.setContentSize2(s.background);var n=UnitView.getUnitImage(e);n.setAnchorPoint2(),n.setPositionRound(t.width/2,t.height/2),cleverapps.UI.fitToBox(n,s.icon),t.addChild(n),i.push(t)}),i},generateMayContain:function(){var e=cleverapps.styles.OpenChestWindow,t=new cleverapps.Layout(this.generateContains(),{direction:cleverapps.UI.HORIZONTAL,margin:e.containScroll.margin,padding:e.containScroll.padding}),n=new cleverapps.UI.ScrollView(t,{scrollBarEnabled:!1,direction:cleverapps.UI.HORIZONTAL});return n.setContentSize2(e.containScroll.width,t.height+2),n.scrollToDefault(),n},generateMayContainText:function(){return cleverapps.UI.generateOnlyText("messages:OpenChestWindow.suggestion",cleverapps.styles.FONTS.DARK_TEXT)},generateQuestion:function(){return cleverapps.UI.generateOnlyText(
"messages:OpenChestWindow.question",cleverapps.styles.FONTS.OPENCHESTWINDOW_TITLE_TEXT,{name:Messages.get("sacks"===this.unit.getResource()?"sack":"chest")})},createContent:function(){var e=cleverapps.styles.OpenChestWindow;return new cleverapps.Layout([this.generateMayContain(),this.generateMayContainText(),new UnitOnCell(this.unit,{scale:e.chest.scale,animation:!0}),this.generateQuestion()],{margin:e.margin,padding:e.padding})},createButton:function(){var e=cleverapps.styles.OpenChestWindow.button,t=new cleverapps.UI.Button({font:cleverapps.styles.FONTS.LIGHT_BUTTON_TEXT,text:"messages:OpenChestWindow.button",width:e.width,height:e.height,onClicked:this.openChest.bind(this),button_images:cleverapps.UI.Button.Images.button_green});return t.adviceTarget=Merge.SPAWN,t}});cleverapps.overrideFonts(cleverapps.styles.FONTS,{OPENCHESTWINDOW_TITLE_TEXT:{name:"nostroke",size:55,color:cleverapps.styles.COLORS.DARK_TEXT_COLOR}}),cleverapps.styles.OpenChestWindow={margin:30,padding:{left:25,
right:28,top:90,bottom:200},containScroll:{width:1400,margin:14,padding:{x:40,y:0}},button:{width:300,height:110},chest:{scale:1.6},prize:{background:{width:200,height:200},icon:{width:160,height:160,maxScale:1.6}}};var ChestPrizeProbWindow=Window.extend({onWindowLoaded:function(e){this.unit=e,this.prob=Chest.ListPrizeProb(e),this._super({title:"messages:Units."+e.code+".stage"+(e.stage+1)+".name",name:"ChestPrizeProbWindow",content:this.createContent(),adjustToContent:!0,closeButton:!0,foreground:bundles.windows.frames.window_foreground_png}),cleverapps.audio.playSound(bundles.main.urls.window_effect)},generateContains:function(){var i=[],o=cleverapps.styles.ChestPrizeProbWindow.prize;return this.prob.types.forEach(function(e){var t=new cc.Scale9Sprite(bundles.openchestwindow.frames.icon_background_light);t.setContentSize2(o.background);var n=UnitView.getUnitImage(e);n.setAnchorPoint2(),n.setPositionRound(t.width/2,t.height/2),cleverapps.UI.fitToBox(n,o.icon),t.addChild(n)
;var s=cleverapps.UI.generateOnlyText(e.prob+"%",cleverapps.styles.FONTS.UNIT_PROB);s.setPositionRound(o.probText),t.addChild(s),i.push(t)}),i},generateSameItemsText:function(){return cleverapps.UI.generateOnlyText("messages:ChestContainSameItems",cleverapps.styles.FONTS.SAME_ITEMS_TEXT)},generateMayContainText:function(){return cleverapps.UI.generateOnlyText("messages:ChestContainAmount",cleverapps.styles.FONTS.DARK_TEXT,{min:this.prob.minAmount,max:this.prob.maxAmount})},generateMayContain:function(){var e=cleverapps.styles.ChestPrizeProbWindow,t=new cleverapps.Layout(this.generateContains(),{direction:cleverapps.UI.HORIZONTAL,margin:e.containScroll.margin,padding:e.containScroll.padding}),n=new cleverapps.UI.ScrollView(t,{scrollBarEnabled:!1,direction:cleverapps.UI.HORIZONTAL});return n.setContentSize2(e.containScroll.width,t.height+2),n.scrollToDefault(),n},createContent:function(){var e=cleverapps.styles.ChestPrizeProbWindow;return new cleverapps.Layout([
this.generateSameItemsText(),this.generateMayContain(),this.generateMayContainText(),new UnitOnCell(this.unit,{scale:e.chest.scale,animation:!0})],{margin:e.margin,padding:e.padding})}});cleverapps.overrideFonts(cleverapps.styles.FONTS,{SAME_ITEMS_TEXT:{size:23,color:cleverapps.styles.COLORS.DARK_TEXT_COLOR}}),cleverapps.styles.ChestPrizeProbWindow={margin:30,prize:{background:{width:200,height:200},icon:{width:160,height:160,maxScale:1.6},probText:{x:{align:"right",dx:-10},y:{align:"bottom"}}},padding:{left:25,right:28,top:90,bottom:80},chest:{scale:1.6},containScroll:{width:1400,margin:14,padding:{x:40,y:0}}};var UnitsLibrary=function(e){cleverapps.EventEmitter.call(this),this.codesByType={},this.opened={},this.fresh={},e&&this.load(e),this.init()};UnitsLibrary.prototype=Object.create(cleverapps.EventEmitter.prototype),(UnitsLibrary.prototype.constructor=UnitsLibrary).prototype.load=function(e){var t=e.opened||{},n=e.fresh||{};for(var s in Object.keys(t).forEach(function(e){
Families[e]||(delete t[e],delete n[e])}),n=this.listFromBit(n),t=this.listFromBit(t),n)Object.keys(n[s]).forEach(function(e){this.isHidden({code:s,stage:e})&&delete n[s][e]},this);this.opened=t,this.fresh=n},UnitsLibrary.prototype.fromBit=function(e){for(var t={},n=0;e;)e%2&&(t[n]=!0),e=Math.floor(e/2),n++;return t},UnitsLibrary.prototype.toBit=function(e){var t=0;for(var n in e)t|=1<<n;return t},UnitsLibrary.prototype.listToBit=function(e){var t={};for(var n in e){var s=this.toBit(e[n]);0!==s&&(t[n]=s)}return t},UnitsLibrary.prototype.listFromBit=function(e){var t={};for(var n in e)"object"==typeof e[n]?t[n]=e[n]:t[n]=this.fromBit(e[n]);return t},UnitsLibrary.prototype.save=function(){return{opened:this.listToBit(this.opened),fresh:this.listToBit(this.fresh)}},UnitsLibrary.prototype.init=function(){for(var e in Families){var t=Families[e].type;this.codesByType[t]||(this.codesByType[t]=[]),this.codesByType[t].push(e),this.opened[e]||(this.opened[e]={},this.fresh[e]={}),this.fresh[e]||(
this.fresh[e]={})}},UnitsLibrary.ListByCode=function(e){for(var t=[],n=0;n<Families[e].units.length;n++)Families[e].units[n].temporary||t.push({code:e,stage:n});return t},UnitsLibrary.prototype.isOpened=function(e){return this.opened[e.code][e.stage]},UnitsLibrary.prototype.isFresh=function(e){return void 0!==this.fresh[e.code][e.stage]},UnitsLibrary.prototype.storeSave=function(){Game.currentGame.storeSave()},UnitsLibrary.prototype.openUnit=function(e){this.isOpened(e)||(this.opened[e.code][e.stage]=!0,this.isHidden(e)||(this.fresh[e.code][e.stage]=!0),this.trigger("unitAvailable",e),this.trigger("unitStatusChanged"),cleverapps.sideBar.resetByClassName(UnitsLibraryIcon),this.storeSave())},UnitsLibrary.prototype.isHidden=function(e){var t=Families[e.code],n=t.units[e.stage];return void 0===n&&console.log("UNIT",e.code,e.stage),-1!==UnitsLibrary.HIDDEN_CODES.indexOf(e.code)||n.temporary||-1!==UnitsLibrary.HIDDEN_TYPES.indexOf(t.type)},UnitsLibrary.prototype.removeFresh=function(e,t){
this.fresh[e.code][e.stage]&&(delete this.fresh[e.code][e.stage],Game.currentGame.addCoins(this.calcRewardCoins(e),t,{beginScale:1}),this.trigger("unitStatusChanged"),cleverapps.sideBar.resetByClassName(UnitsLibraryIcon),this.storeSave())},UnitsLibrary.prototype.hasOpened=function(e){return 0<Object.keys(this.opened[e]).length},UnitsLibrary.prototype.hasFresh=function(e){return 0<Object.keys(this.fresh[e]).length},UnitsLibrary.prototype.listAvailableByType=function(e){return this.codesByType[e].filter(function(e){return this.hasOpened(e)},this)},UnitsLibrary.prototype.listCodesByType=function(e){if(Array.isArray(e)){var t=[];return e.forEach(function(e){t=t.concat(this.listCodesByType(e))},this),t}return this.codesByType[e]},UnitsLibrary.prototype.getFamilyName=function(e){return Messages.get("Units."+e+".name")||e+" family"},UnitsLibrary.prototype.getUnitName=function(e){return Messages.get("Units."+e.code+".stage"+(e.stage+1)+".name")||e.code+" stage "+(e.stage+1)},
UnitsLibrary.prototype.hasAnyFresh=function(e){return(e=e||Object.keys(this.fresh)).some(this.hasFresh.bind(this))},UnitsLibrary.prototype.calcRewardCoins=function(e){return Math.round(3*Math.pow(1.3,e.stage))},UnitsLibrary.prototype.getCurrentHero=function(){for(var e=this.codesByType.hero.length-1;0<=e;e--){var t=this.codesByType.hero[e];if(this.isHeroAvailable(t))return t}},UnitsLibrary.prototype.getCurrentResource=function(){for(var e=this.codesByType.resource.length-1;0<=e;e--){var t=this.codesByType.resource[e];if(this.hasOpened(t))return t}},UnitsLibrary.prototype.getNextHero=function(){for(var e=0;e<this.codesByType.hero.length;e++){var t=this.codesByType.hero[e];if(!this.isHeroAvailable(t))return t}},UnitsLibrary.prototype.isHeroAvailable=function(e){return Game.currentGame.orders.getMaker(e)},UnitsLibrary.prototype.findFreshUnit=function(e){for(var t=0;t<e.length;++t){var n=e[t];if(n.code&&(void 0===n.stage&&this.hasFresh(n.code)||this.isFresh(n)))return n}},
UnitsLibrary.prototype.findLastOpenedUnit=function(e){for(var t=e.length-1;0<=t;--t){var n=e[t];if(n.code&&this.isOpened(n))return n}},UnitsLibrary.HIDDEN_CODES=["herochest","freechest","dishes","multiCellBody","decorator","dragonmine","specialoffer"],UnitsLibrary.HIDDEN_TYPES=["generator"];var UnitsLibraryWindow=Window.extend({onWindowLoaded:function(e){this.searchUnit=e;var t=cleverapps.styles.UnitsLibraryWindow;this.unitsLibrary=Game.currentGame.unitsLibrary,this.tabsInfo=this.createTabs(),this._super({name:"UnitsLibraryWindow",content:this.createContent(),adjustToContent:!0,noBackground:!0,closeButton:!0,regularCloseButton:!0,extraWidth:2*t.contentOffsetX,contentOffsetX:t.contentOffsetX,foreground:bundles.windows.frames.window_foreground_png,styles:cleverapps.extendStyles(cleverapps.styles.Window,t.window)}),cleverapps.audio.playSound(bundles.main.urls.window_effect)},createTabs:function(){return{0:{icon:bundles.windows.frames.tab_icon_heroes,generator:this.createTab.bind(this,0)},
1:{icon:bundles.windows.frames.tab_icon_resource,generator:this.createTab.bind(this,1)},2:{icon:bundles.windows.frames.tab_icon_fruit,generator:this.createTab.bind(this,2)},3:{icon:bundles.windows.frames.tab_icon_source,generator:this.createTab.bind(this,3)},4:{icon:bundles.windows.frames.tab_icon_chest,generator:this.createTab.bind(this,4)},5:{icon:bundles.windows.frames.tab_icon_valuable,generator:this.createTab.bind(this,5)}}},createContent:function(){var e=cleverapps.styles.UnitsLibraryWindow,t=this.content=cleverapps.UI.createScale9Sprite(bundles.windows.frames.window_bg_png,cleverapps.styles.Window.Background.scale9);t.setAnchorPoint2(),t.setContentSize2(e.width,e.height);var n,s,i=this.tabs=new Tabs(this.tabsInfo,e.tabs);for(var o in i.setAnchorPoint2(),i.setPositionRound(e.tabs),t.addChild(i),this.tabsInfo){var r=UnitsLibraryWindow.listCodesByTabId(o);!n&&this.searchUnit&&-1!==r.indexOf(this.searchUnit.code)&&(n=o),!s&&this.unitsLibrary.hasAnyFresh(r)&&(s=o)}
return i.activateTab(n||s||0,{searchUnit:this.searchUnit}),this.unitsLibrary.on("unitStatusChanged",this.updateTabsAttentions.bind(this),this),this.updateTabsAttentions(),t},updateTabsAttentions:function(){for(var e in this.tabsInfo){var t=UnitsLibraryWindow.listCodesByTabId(e);this.tabs.setAttention(e,this.unitsLibrary.hasAnyFresh(t))}},createTab:function(e){var t,n=cleverapps.styles.UnitsLibraryWindow,s={width:n.width-2*n.padding.x,height:n.height-2*n.padding.y};if(0===e)t=new HeroesTab(s);else{var i=UnitsLibraryWindow.listCodesByTabId(e);t=new UnitsTab(i,s)}return this.content.addChild(t),t}});UnitsLibraryWindow.listCodesByTabId=function(e){var t=Game.currentGame.unitsLibrary,n=[];return UnitsLibraryWindow.TabsInfo[e].types.forEach(function(e){n=n.concat(t.listCodesByType(e))}),n=cleverapps.substract(n,UnitsLibrary.HIDDEN_CODES)},UnitsLibraryWindow.TabsInfo={0:{types:["hero"]},1:{types:["resource"]},2:{types:["fruit"]},3:{types:["source"]},4:{types:["chest"]},5:{types:["valuables",
"custom","magicplant","rubiesplant"]}},cleverapps.styles.UnitsLibraryWindow={width:2e3,height:1050,contentOffsetX:60,window:{bgOffset:{y:-30}},padding:{x:60,y:34},tabs:{x:{align:"left",dx:-118},y:{align:"top",dy:-40},height:154}};var LevelUpWindow=Window.extend({onWindowLoaded:function(){this._super({name:"LevelUpWindow",content:this.createContent(),noBackground:!0,closeButton:!1}),cleverapps.audio.playSound(bundles.levelupwindow.urls.levelup_effect)},createContent:function(){var e=Game.currentGame.gameLevel,t=cleverapps.styles.LevelUpWindow,n=new cleverapps.Spine(bundles.levelupwindow.jsons.levelup_json);n.setPositionRound(n.width/2,n.height/2),n.setAnimationAndIdleAfter("animation","idle");var s=cleverapps.UI.generateOnlyText(Messages.get("LevelUpWindow.title"),cleverapps.styles.FONTS.LEVELUPWINDOW_TITLE_TEXT);s.setAnchorPoint2(),s.setPositionRound(n.width/2,n.height/2+t.title.dy),s.fitTo(t.title.fitTo.width,t.title.fitTo.height);var i=this.newLevel=cleverapps.UI.generateOnlyText(
e.getNextLevel(),cleverapps.styles.FONTS.LEVELUPWINDOW_VALUE_TEXT);i.setAnchorPoint2(),i.setPositionRound(n.width/2,n.height/2+t.value.dy);var o=new cc.Node;o.addChild(n),o.addChild(s),o.addChild(i),cleverapps.UI.wrap(o);var r=this.rewards=new RewardsListComponent(e.levelUpPrize(),{font:cleverapps.styles.FONTS.LEVELUPWINDOW_REWARD_TEXT,iconScale:t.rewards.scale,title:"messages:RewardsListComponent.rewardTitle",amountInRow:6,reward:{direction:cleverapps.UI.HORIZONTAL,amountPrefix:""}}),a=new cleverapps.Layout([r,o],{direction:cleverapps.UI.VERTICAL,margin:t.margin,y:t.dy});return r.setLocalZOrder(1),cleverapps.UI.onClick(a,this.close.bind(this)),s.runAction(new cc.Sequence(new cc.ScaleTo(.26,1.4),new cc.ScaleTo(.37,1))),i.setScale(0),i.runAction(new cc.Sequence(new cc.DelayTime(1),new cc.ScaleTo(.26,1.4),new cc.ScaleTo(.37,1))),r.setVisible(!1),r.runAction(new cc.Sequence(new cc.DelayTime(.36),new cc.Show,new cc.ScaleTo(.2,1.14),new cc.ScaleTo(.2,1))),a},close:function(){if(
!this.closing){this.closing=!0,Game.currentGame.gameLevel.moveToNextLevel();var e=0;e=this.rewards.gameReceiveRewards(e),e+=1500,Game.currentGame.counter.setTimeout(function(){Window.prototype.close.call(this)}.bind(this),e)}},listBundles:function(){return["levelupwindow"]}});cleverapps.overrideFonts(cleverapps.styles.FONTS,{LEVELUPWINDOW_TITLE_TEXT:{size:60,color:cleverapps.styles.COLORS.LIGHT_TEXT_COLOR,stroke:cleverapps.styles.DECORATORS.LIGHT_TEXT_STROKE,shadow:cleverapps.styles.DECORATORS.LIGHT_TEXT_SHADOW},LEVELUPWINDOW_VALUE_TEXT:{size:220,color:cleverapps.styles.COLORS.LIGHT_TEXT_COLOR,stroke:cleverapps.styles.DECORATORS.LIGHT_TEXT_STROKE,shadow:cleverapps.styles.DECORATORS.LIGHT_TEXT_SHADOW},LEVELUPWINDOW_REWARD_TEXT:{name:"default",size:90,color:cleverapps.styles.COLORS.LIGHT_TEXT_COLOR,stroke:cleverapps.styles.DECORATORS.LIGHT_TEXT_STROKE,shadow:cleverapps.styles.DECORATORS.LIGHT_TEXT_SHADOW}}),cleverapps.styles.LevelUpWindow={dy:-1e3,margin:0,title:{dy:223,fitTo:{width:500,
height:0}},value:{dy:-10},rewards:{scale:.8}},RewardsListComponent.prototype.gameReceiveRewards=function(s){return this.iterateRewards(function(t,e,n){t.setCascadeOpacityEnabled(!0),t.runAction(new cc.Sequence(new cc.DelayTime(s/1e3),new cc.FadeOut(.3))),0===e.indexOf("unit")?(t.icon.replaceParentSamePlace(cc.director.getRunningScene(),{keepScale:!0}),t.icon.runAction(new cc.Sequence(new cc.DelayTime(.4),new cc.ScaleTo((s+200)/1e3,1.7),new cc.CallFunc(function(){var e=cleverapps.arrayFill(n.amount||1).map(function(){return new Unit(n)});t.icon.replaceParentSamePlace(Game.currentGame.map.getView().animations,{keepScale:!0}),Game.currentGame.spawn(e,t.icon,{fromNode:!0,startScale:t.icon.scale,startAnchors:{anchorX:.5,anchorY:.5}})}),new cc.DelayTime(.2),new cc.RemoveSelf))):Game.currentGame.addReward(e,n,t,{delay:s,beginScale:1,withoutDelta:!0}),s+=300}.bind(this)),s},RewardWindow.prototype.onClose=function(){},RewardWindow.prototype.close=function(){if(!this.closing){if(this.closing=!0,
!Game.currentGame)return this.receiveReward(),Window.prototype.close.call(this),void(this.options.callback&&this.options.callback());var e=this.rewardsList.gameReceiveRewards(300);Game.currentGame.counter.setTimeout(function(){cleverapps.windows.hideWindow()}.bind(this),e),Game.currentGame.counter.setTimeout(function(){Window.prototype.close.call(this),this.options.callback&&this.options.callback()}.bind(this),e+1200)}},BattlePass.getLevels=function(){return[{level:0,energy:30,task:{type:Mission.EVENT_UNIT_BUILT,goal:30},reward:{unit:{code:"treasure",stage:0,amount:1}},premiumReward:{unit:{code:"treasure",stage:0,amount:2}}},{level:1,energy:35,task:{type:Mission.EVENT_UNIT_BUILT,goal:75},reward:{unit:{code:"worker",stage:2,amount:2}},premiumReward:{unit:{code:"worker",stage:4,amount:1}}},{level:2,energy:40,task:{type:Mission.EVENT_UNIT_BUILT,goal:150},reward:{unit:{code:"sacks",stage:0,amount:1}},premiumReward:{unit:{code:"sacks",stage:0,amount:3}}},{level:3,energy:45,task:{
type:Mission.EVENT_UNIT_BUILT,goal:350},reward:{unit:{code:"treasure",stage:1,amount:1}},premiumReward:{unit:{code:"treasure",stage:2,amount:3}}},{level:4,energy:50,task:{type:Mission.EVENT_UNIT_BUILT,goal:700},reward:{unit:{code:"crystal",stage:2,amount:1}},premiumReward:{unit:{code:"worker",stage:4,amount:1}}},{level:5,energy:55,task:{type:Mission.EVENT_UNIT_BUILT,goal:2500},reward:{unit:{code:"treasure",stage:2,amount:1}},premiumReward:{unit:{code:"rubies",stage:4,amount:1}}},{level:6,energy:60,task:{type:Mission.EVENT_UNIT_BUILT,goal:3750},reward:{unit:{code:"sacks",stage:1,amount:1}},premiumReward:{unit:{code:"sacks",stage:1,amount:3}}},{level:7,energy:65,task:{type:Mission.EVENT_UNIT_BUILT,goal:5e3},reward:{unit:{code:"worker",stage:4,amount:1}},premiumReward:{unit:{code:"crystal",stage:3,amount:1}}},{level:8,energy:70,task:{type:Mission.EVENT_UNIT_BUILT,goal:8e3},reward:{unit:{code:"sacks",stage:2,amount:2}},premiumReward:{unit:{code:"sacks",stage:2,amount:2}}},{level:9,
energy:75,task:{type:Mission.EVENT_UNIT_BUILT,goal:12e3},reward:{unit:{code:"magicplant",stage:5,amount:2}},premiumReward:{unit:{code:"rubiesplant",stage:1,amount:1}}}]};var UnitSyncer=function(){for(var e in this.syncers={},this.index={},Families)if(!UnitSyncer.DISABLED_CODES[e]){var t=this.syncers[e]=new FamilySyncer(e);CustomSyncers.extractors[t.getSyncerCode()]=this.getInfo.bind(this,e)}};UnitSyncer.prototype.reset=function(){for(var e in this.syncers)this.syncers[e].reset()},UnitSyncer.prototype.remove=function(e,t){var n=FamilySyncer.GetKey(e,t),s=this.index[n],i=this.syncers[s];i&&(i.remove(e,t),delete this.index[n])},UnitSyncer.prototype.save=function(e,t,n,s){this.remove(e,t);var i=this.syncers[n&&n.code];i&&(i.save(e,t,n,s),this.index[FamilySyncer.GetKey(e,t)]=n.code)},UnitSyncer.prototype.loadMap=function(e){cleverapps.values(this.syncers).forEach(function(e){e.reset(!0)}),this.index={},e.forEach(function(e){this.save(e.x,e.y,e.data,!0)},this)},
UnitSyncer.prototype.getInfo=function(e){return this.syncers[e].getInfo()},UnitSyncer.prototype.updateInfo=function(n){if(void 0!==n){Object.keys(this.syncers).forEach(function(e){var t=n[e]||{};this.syncers[e].updateInfo(t)},this);var t=[];cleverapps.values(this.syncers).forEach(function(e){t=t.concat(e.listUnits())},this),t=t.sort(UnitSyncer.UNITS_IMPORTANCE_ORDER),this.index={},t.forEach(function(e){var t=FamilySyncer.GetKey(e.x,e.y);this.index[t]?e.kickout=!0:this.index[t]=e.data.code},this),cleverapps.unitSaver.updateInfo(t)}},UnitSyncer.UNITS_IMPORTANCE_ORDER=function(e,t){var n=Families[e.data.code].units[e.data.stage],s=Families[t.data.code].units[t.data.stage];return n.makesorder!==s.makesorder?n.makesorder?-1:1:n.important!==s.important?n.important?-1:1:t.data.stage-e.data.stage},UnitSyncer.DISABLED_CODES=cleverapps.createSet(["multiCellBody","specialoffer","decorator"]);var FamilySyncer=function(e,t){this.code=e,this.data={},this.syncerCode="units_"+e}
;FamilySyncer.prototype.getSyncerCode=function(){return this.syncerCode},FamilySyncer.prototype.addUpdateTask=function(){cleverapps.synchronizer.addUpdateTask(this.syncerCode)},FamilySyncer.prototype.remove=function(e,t){var n=FamilySyncer.GetKey(e,t);this.data[n]&&(delete this.data[n],this.addUpdateTask())},FamilySyncer.prototype.save=function(e,t,n,s){var i=FamilySyncer.GetKey(e,t),o=this.encode(n);this.data[i]=o,!0!==s&&this.addUpdateTask()},FamilySyncer.prototype.reset=function(e){this.data={},!0!==e&&this.addUpdateTask()},FamilySyncer.GetKey=function(e,t){return e+"_"+t},FamilySyncer.ParseKey=function(e){var t=e.split("_");return{x:parseInt(t[0]),y:parseInt(t[1])}},FamilySyncer.prototype.encode=function(e){var t=cleverapps.clone(e,!0);return delete t.code,t},FamilySyncer.prototype.decode=function(e){var t=cleverapps.clone(e,!0);return t.code=this.code,t},FamilySyncer.prototype.getInfo=function(){return this.data},FamilySyncer.prototype.updateInfo=function(e){this.data=e},
FamilySyncer.prototype.listUnits=function(){return Object.keys(this.data).map(function(e){var t=FamilySyncer.ParseKey(e);return t.data=this.decode(this.data[e]),t},this).filter(function(e){return Families[e.data.code].units[e.data.stage]})};var GuideWindow=Window.extend({onWindowLoaded:function(e,t){this._super({title:this.getWindowTitle(e),name:t.name,content:this.createContent(e),adjustToContent:!0,closeButton:!0}),cleverapps.audio.playSound(bundles.main.urls.window_effect)},getWindowTitle:function(e){return Game.currentGame.unitsLibrary.getUnitName(e)},getStageSize:function(){var e=cleverapps.styles.GuideWindow.stages;return cc.size(e.width,e.height)},getUpperArrowStyle:function(){return cleverapps.styles.GuideWindow.upperArrow},getLowerArrowStyle:function(){return cleverapps.styles.GuideWindow.lowerArrow},createContent:function(e){var t=cleverapps.styles.GuideWindow,n=new cleverapps.Layout([this.createFirstStage(e),this.createArrow(bundles.guidewindow.frames.upper_arrow,
this.getUpperArrowStyle()),this.createSecondStage(e),this.createArrow(bundles.guidewindow.frames.lower_arrow,this.getLowerArrowStyle()),this.createThirdStage(e)],{direction:cleverapps.UI.HORIZONTAL,margin:t.margin,padding:t.padding});return n.setAnchorPoint2(),n},createArrow:function(e,t){var n=new cc.Node;return n.setAnchorPoint2(),n.setContentSize2(0,0),n.setLocalZOrder(10),this.addSprite(n,e,t),n},createStageBackgroundWithText:function(e,t){var n=cleverapps.styles.GuideWindow.stages,s=cleverapps.UI.createScale9Sprite(bundles.guidewindow.frames.stage_background,cleverapps.UI.Scale9Rect.TwoPixelXY);return s.setAnchorPoint2(),s.setContentSize2(this.getStageSize()),(e=cleverapps.UI.generateOnlyText(e,cleverapps.styles.FONTS.GUIDE_WINDOW_INDEX_TEXT)).setAnchorPoint2(.5,0),e.setPositionRound(n.index.x,n.index.y),s.addChild(e),(t=cleverapps.UI.generateOnlyText(t,cleverapps.styles.FONTS.GUIDE_WINDOW_DESCRIPTION_TEXT)).setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER),t.setDimensions(
n.description.width,0),t.fitTo(n.description.width,n.description.height),t.setAnchorPoint2(.5,1),t.setPositionRound(n.description.x,n.description.y),s.addChild(t),s},addContainer:function(e,t){var n=new cc.Node;return n.setAnchorPoint2(),n.setPositionRound(t.x,t.y),e.addChild(n),n},addUnitIcon:function(e,t,n,s){var i=UnitView.getUnitImage({code:t,stage:n});return i.setAnchorPoint2(),i.setPositionRound(s.x,s.y),s.scale&&i.setScale(s.scale),e.addChild(i),i},addSprite:function(e,t,n){var s=new cc.Sprite(t);return s.setAnchorPoint2(),s.setPositionRound(n.x,n.y),n.scale&&s.setScale(n.scale),e.addChild(s),s},createFirstStage:function(e){return new cc.Node},createSecondStage:function(e){return new cc.Node},createThirdStage:function(e){return new cc.Node},listBundles:function(){return["guidewindow"]}});cleverapps.overrideFonts(cleverapps.styles.FONTS,{GUIDE_WINDOW_INDEX_TEXT:{size:70,color:cleverapps.styles.COLORS.DARK_TEXT_COLOR},GUIDE_WINDOW_DESCRIPTION_TEXT:{size:35,
color:cleverapps.styles.COLORS.DARK_TEXT_COLOR,lineHeight:40}}),cleverapps.styles.GuideWindow={margin:15,padding:{x:60,top:90,bottom:60},stages:{width:400,height:800,index:{x:{align:"center"},y:150},description:{width:320,height:156,x:{align:"center"},y:160}},upperArrow:{x:{align:"center"},y:{align:"center",dy:180}},lowerArrow:{x:{align:"center"},y:{align:"center",dy:-120}}};var CastleGuideWindow=GuideWindow.extend({onWindowLoaded:function(e){this._super(e,{name:"CastleGuideWindow"})},createFirstStage:function(t){var e=cleverapps.styles.CastleGuideWindow.firstStage,n=this.createStageBackgroundWithText(1,Messages.get("CastleGuideWindow.firstStage")),s=this.addContainer(n,e.container);return this.addSprite(s,bundles.guidewindow.frames.blue_light,e.light),this.addUnitIcon(s,t.code,t.stage-2,e.result),this.addSprite(s,bundles.guidewindow.frames.blue_light_foreground,e.foreground),this.addSprite(s,bundles.guidewindow.frames.blue_light_tears,e.tears),e.components.forEach(function(e){
this.addUnitIcon(s,t.code,t.stage-3,e)},this),n},createSecondStage:function(t){var e=cleverapps.styles.CastleGuideWindow.secondStage,n=this.createStageBackgroundWithText(2,Messages.get("CastleGuideWindow.secondStage")),s=this.addContainer(n,e.container);this.addUnitIcon(s,t.code,t.stage-1,e.castle);var i=this.addSprite(s,bundles.guidewindow.frames.progress,e.progress);return this.addUnitIcon(i,t.code,t.stage,e.icon),this.addSprite(s,bundles.guidewindow.frames.white_arrows,e.arrows),e.components.forEach(function(e){this.addUnitIcon(s,t.code,t.stage-2,e)},this),n},createThirdStage:function(e){var t=cleverapps.styles.CastleGuideWindow.thirdStage,n=this.createStageBackgroundWithText(3,Messages.get("CastleGuideWindow.thirdStage")),s=this.addContainer(n,t.container);return this.addSprite(s,bundles.guidewindow.frames.yellow_light,t.light),this.addUnitIcon(s,e.code,e.stage,t.castle),this.addSprite(s,bundles.guidewindow.frames.crystals,t.crystals),n}});cleverapps.styles.CastleGuideWindow={
firstStage:{container:{x:{align:"center"},y:{align:"center",dy:180}},result:{x:0,y:0},light:{x:0,y:0},foreground:{x:0,y:0},tears:{x:0,y:-279},components:[{x:-107,y:-166,scale:.9},{x:-4,y:-236,scale:.9},{x:105,y:-166,scale:.9}]},secondStage:{container:{x:{align:"center"},y:{align:"center",dy:60}},castle:{x:0,y:0,scale:.9},progress:{x:0,y:-125},icon:{x:{align:"left",dx:10},y:{align:"center",dy:-2},scale:.3},arrows:{x:-10,y:125},components:[{x:-94,y:218,scale:.7},{x:96,y:200,scale:.8}]},thirdStage:{container:{x:{align:"center"},y:{align:"center",dy:60}},castle:{x:0,y:0,scale:1.1},light:{x:0,y:50},crystals:{x:0,y:50}}};var GeneratorGuideWindow=GuideWindow.extend({onWindowLoaded:function(e){this._super(e,{name:"CastleWindow"})},createFirstStage:function(e){var t=cleverapps.styles.GeneratorGuideWindow.firstStage,n=this.createStageBackgroundWithText(1,Messages.get("GeneratorGuideWindow.firstStage")),s=this.addContainer(n,t.container);this.addSprite(s,bundles.guidewindow.frames.yellow_light,
t.light),this.addUnitIcon(s,e.code,e.stage,t.generator);var i=new cleverapps.Layout([new cc.Sprite(bundles.merge.frames.generator_star_on),new cc.Sprite(bundles.merge.frames.generator_star_on),new cc.Sprite(bundles.merge.frames.generator_star_on)],{direction:cleverapps.UI.HORIZONTAL,margin:t.stars.margin});return i.setPositionRound(t.stars),s.addChild(i),n},createSecondStage:function(e){var t=cleverapps.styles.GeneratorGuideWindow.secondStage,n=e.code.replace("generator","source"),s=this.createStageBackgroundWithText(2,Messages.get("GeneratorGuideWindow.secondStage")),i=this.addContainer(s,t.container);return this.addSprite(i,bundles.guidewindow.frames.blue_light,t.light),t.units.forEach(function(e){this.addUnitIcon(i,n,e.stage,e)},this),s},createThirdStage:function(e){var t=cleverapps.styles.GeneratorGuideWindow.thirdStage,n=e.code.replace("generator","source"),s=this.createStageBackgroundWithText(3,Messages.get("GeneratorGuideWindow.thirdStage")),i=this.addContainer(s,t.container)
;return t.components.forEach(function(e){this.addUnitIcon(i,n,2,e)},this),this.addUnitIcon(i,n,3,t.result),this.addSprite(i,bundles.guidewindow.frames.white_plus,t.plus),this.addSprite(i,bundles.guidewindow.frames.white_arrow_up,t.arrow),s}});cleverapps.styles.GeneratorGuideWindow={firstStage:{container:{x:{align:"center"},y:{align:"center",dy:100}},light:{x:0,y:0},generator:{x:0,y:0,scale:1.2},stars:{x:0,y:-30,margin:10}},secondStage:{container:{x:{align:"center"},y:{align:"center",dy:80}},light:{x:0,y:0,scale:.7},units:[{x:-13,y:64,scale:1,stage:0},{x:52,y:2,scale:1.15,stage:2},{x:-41,y:-25,scale:1.3,stage:4}]},thirdStage:{container:{x:{align:"center"},y:{align:"center",dy:210}},result:{x:70,y:25,scale:1.3},plus:{x:-6,y:-181},arrow:{x:-7,y:-45},components:[{x:-44,y:-255,scale:1.15},{x:74,y:-177,scale:1.15},{x:-68,y:-125,scale:1.15}]}};var CrystalGuideWindow=GuideWindow.extend({onWindowLoaded:function(e){this._super(e,{name:"CrystalGuideWindow"})},createFirstStage:function(t){
var e=cleverapps.styles.CrystalGuideWindow.firstStage,n=this.createStageBackgroundWithText(1,Messages.get("CrystalGuideWindow.firstStage")),s=this.addContainer(n,e.container);return this.addUnitIcon(s,t.code,t.stage-1,e.unit),this.addSprite(s,bundles.guidewindow.frames.three_white_arrows,e.arrows),e.components.forEach(function(e){this.addUnitIcon(s,t.code,t.stage-2,e)},this),n},createSecondStage:function(e){var t=cleverapps.styles.CrystalGuideWindow.secondStage,n=this.createStageBackgroundWithText(2,Messages.get("CrystalGuideWindow.secondStage")),s=this.addContainer(n,t.container);return this.addSprite(s,bundles.guidewindow.frames.blue_light,t.background),this.addUnitIcon(s,e.code,e.stage,t.unit),this.addSprite(s,bundles.guidewindow.frames.blue_light_foreground,t.foreground),n},createThirdStage:function(e){var s=cleverapps.styles.CrystalGuideWindow.thirdStage,t=this.createStageBackgroundWithText(3,Messages.get("CrystalGuideWindow.thirdStage")),i=this.addContainer(t,s.container);return[
{code:"coins",stage:3},{code:"coins",stage:2},{code:"coins",stage:2},{code:e.code,stage:e.stage}].forEach(function(e,t){if(s.icons[t]){var n=this.addSprite(i,bundles.guidewindow.frames.tile_light,s.icons[t]);this.addUnitIcon(n,e.code,e.stage,s.units)}},this),this.addSprite(i,bundles.guidewindow.frames.white_plus,s.plus),this.addSprite(i,bundles.guidewindow.frames.white_arrow_up,s.arrow),t}});cleverapps.styles.CrystalGuideWindow={firstStage:{container:{x:{align:"center"},y:{align:"center",dy:180}},unit:{x:0,y:0,scale:1.4},arrows:{x:-10,y:-129},components:[{x:-107,y:-166,scale:1.2},{x:-4,y:-224,scale:1.2},{x:105,y:-166,scale:1.2}]},secondStage:{container:{x:{align:"center"},y:{align:"center",dy:90}},unit:{x:0,y:0,scale:1.8},background:{x:0,y:0,scale:.9},foreground:{x:0,y:0}},thirdStage:{container:{x:{align:"center"},y:{align:"center",dy:210}},units:{x:{align:"center",dx:5},y:{align:"bottom",dy:25}},icons:[{x:80,y:15,scale:1.3},{x:-52,y:-102,scale:1.3},{x:79,y:-181,scale:1.3},{x:-49,
y:-260,scale:1.3}],plus:{x:9,y:-136},arrow:{x:0,y:-25}}};var InstantWorkerGuideWindow=GuideWindow.extend({onWindowLoaded:function(e){this._super(e,{name:"InstantWorkerGuideWindow"})},createFirstStage:function(t){var e=cleverapps.styles.InstantWorkerGuideWindow.firstStage,n=this.createStageBackgroundWithText(1,Messages.get("InstantWorkerGuideWindow.firstStage")),s=this.addContainer(n,e.container);return this.addUnitIcon(s,t.code,t.stage-1,e.unit),this.addSprite(s,bundles.guidewindow.frames.three_white_arrows,e.arrows),e.components.forEach(function(e){this.addUnitIcon(s,t.code,t.stage-2,e)},this),n},createSecondStage:function(e){var t=cleverapps.styles.InstantWorkerGuideWindow.secondStage,n=this.createStageBackgroundWithText(2,Messages.get("InstantWorkerGuideWindow.secondStage")),s=this.addContainer(n,t.container);return this.addSprite(s,bundles.guidewindow.frames.blue_light,t.background),this.addUnitIcon(s,e.code,e.stage,t.unit),this.addSprite(s,
bundles.guidewindow.frames.blue_light_foreground,t.foreground),n},createThirdStage:function(e){var t=cleverapps.styles.InstantWorkerGuideWindow.thirdStage,n=this.createStageBackgroundWithText(3,Messages.get("InstantWorkerGuideWindow.thirdStage")),s=this.addContainer(n,t.container),i=this.addSprite(s,bundles.guidewindow.frames.guide_rays,t.rays);this.addUnitIcon(i,e.code,e.stage,t.unit);var o=this.addUnitIcon(s,"wood",3,t.building);return this.addSprite(o,bundles.guidewindow.frames.guide_attention,t.attention),this.addSprite(s,bundles.guidewindow.frames.white_arrow_up,t.arrow),this.addSprite(s,bundles.finger.frames.tutorial_hand_png,t.hand),n}});cleverapps.styles.InstantWorkerGuideWindow={firstStage:{container:{x:{align:"center",dx:25},y:{align:"center",dy:180}},unit:{x:0,y:0,scale:1.4},arrows:{x:-22,y:-112},components:[{x:-129,y:-140,scale:1.2},{x:-32,y:-214,scale:1.2},{x:78,y:-147,scale:1.2}]},secondStage:{container:{x:{align:"center"},y:{align:"center",dy:50}},unit:{x:0,y:0,scale:1.6
},background:{x:0,y:0,scale:.8},foreground:{x:-2,y:19}},thirdStage:{container:{x:{align:"center",dx:-50},y:{align:"center",dy:90}},rays:{x:0,y:0},unit:{x:{align:"center"},y:{align:"center"},scale:1.6},building:{x:145,y:83,scale:1.4},attention:{x:{align:"center"},y:{align:"center"},scale:.7},hand:{x:70,y:-100,scale:.7},arrow:{x:65,y:45}}};var EnergyFeastMissionRulesWindow=GuideWindow.extend({onWindowLoaded:function(){this._super(null,{name:"EnergyFeastMissionRulesWindow"})},getWindowTitle:function(e){return"messages:EnergyFeastMissionRulesWindow.title"},getStageSize:function(){var e=cleverapps.styles.EnergyFeastMissionRulesWindow.stages;return cc.size(e.width,e.height)},createContent:function(e){var t=cleverapps.styles.EnergyFeastMissionRulesWindow,n=new cleverapps.Layout([this.createFirstStage(e),this.createArrow(bundles.guidewindow.frames.upper_arrow,t.upperArrow),this.createSecondStage(e),this.createArrow(bundles.guidewindow.frames.lower_arrow,t.lowerArrow),this.createThirdStage(e)],
{direction:cleverapps.UI.HORIZONTAL,margin:t.stages.margin});n.setAnchorPoint2();var s=cleverapps.UI.generateOnlyText("messages:EnergyFeastMissionRulesWindow.description",cleverapps.styles.FONTS.GUIDE_WINDOW_DESCRIPTION_TEXT);s.setAnchorPoint2(),s.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER),s.setDimensions(n.width,0);var i=new cleverapps.Layout([n,s],{direction:cleverapps.UI.VERTICAL,margin:t.margin,padding:t.padding});return i.setAnchorPoint2(),i},createFirstStage:function(e){var t=cleverapps.styles.EnergyFeastMissionRulesWindow.firstStage,n=this.createStageBackgroundWithText(1,"messages:EnergyFeastMissionRulesWindow.firstStage"),s=this.addContainer(n,t.container);return this.addSprite(s,bundles.guidewindow.frames.blue_light,t.light),this.addSprite(s,bundles.guidewindow.frames.energies,t.energies),n},createSecondStage:function(e){var t=cleverapps.styles.EnergyFeastMissionRulesWindow.secondStage,n=this.createStageBackgroundWithText(2,
"messages:EnergyFeastMissionRulesWindow.secondStage"),s=this.addContainer(n,t.container);return this.addSprite(s,bundles.guidewindow.frames.rating,t.rating),n},createThirdStage:function(e){var t=cleverapps.styles.EnergyFeastMissionRulesWindow.thirdStage,n=this.createStageBackgroundWithText(3,"messages:EnergyFeastMissionRulesWindow.thirdStage"),s=this.addContainer(n,t.container);return this.addSprite(s,bundles.guidewindow.frames.yellow_light,t.light),this.addSprite(s,bundles.guidewindow.frames.treasure,t.present),n}});cleverapps.styles.EnergyFeastMissionRulesWindow={margin:30,padding:{x:60,top:100,bottom:70},stages:{width:400,height:700,margin:15},upperArrow:{x:{align:"center"},y:{align:"center",dy:200}},lowerArrow:{x:{align:"center"},y:{align:"center",dy:-100}},firstStage:{container:{x:{align:"center"},y:{align:"center",dy:90}},light:{x:0,y:0,scale:.9},energies:{x:0,y:0}},secondStage:{container:{x:{align:"center"},y:{align:"center",dy:60}},rating:{x:0,y:0,scale:.9}},thirdStage:{
container:{x:{align:"center"},y:{align:"center",dy:90}},light:{x:0,y:0,scale:.9},present:{x:19,y:21,scale:2}}};var BattlePassRulesWindow=GuideWindow.extend({onWindowLoaded:function(){this._super(null,{name:"BattlePassRulesWindow"})},getWindowTitle:function(e){return"messages:BattlePassRulesWindow.title"},createFirstStage:function(e){var t=cleverapps.styles.BattlePassRulesWindow.firstStage,n=this.createStageBackgroundWithText(1,"messages:BattlePassRulesWindow.firstStage"),s=this.addContainer(n,t.container);return this.addSprite(s,bundles.guidewindow.frames.blue_light,t.light),this.addSprite(s,bundles.guidewindow.frames.worker_with_building,t.unit),n},createSecondStage:function(e){var t=cleverapps.styles.BattlePassRulesWindow.secondStage,n=this.createStageBackgroundWithText(2,"messages:BattlePassRulesWindow.secondStage"),s=this.addContainer(n,t.container);this.addSprite(s,bundles.merge.frames.stand_ground,t.ground),this.addSprite(s,bundles.guidewindow.frames.guide_rays,t.light),
this.addUnitIcon(s,"wood",6,t.unit);var i=new cleverapps.Spine(bundles.merge.jsons.battle_star,t.star.scale);return i.setAnchorPoint2(),i.setPositionRound(t.star),i.setAnimation(0,"idle",!0),s.addChild(i),i.runAction(new cc.RepeatForever(new cc.Sequence(new cc.CallFunc(FingerView.showFingerOnce.bind(FingerView,i)),new cc.DelayTime(2.5)))),n},createThirdStage:function(e){var t=cleverapps.styles.BattlePassRulesWindow.thirdStage,n=this.createStageBackgroundWithText(3,"messages:BattlePassRulesWindow.thirdStage"),s=this.addContainer(n,t.container);return this.addSprite(s,bundles.guidewindow.frames.yellow_light,t.light),this.addSprite(s,bundles.merge.frames.stand_ground,t.ground),this.addSprite(s,bundles.guidewindow.frames.prizes_heap,t.prizes),n}});cleverapps.styles.BattlePassRulesWindow={firstStage:{container:{x:{align:"center"},y:{align:"center",dy:90}},light:{x:0,y:0,scale:1.2},unit:{x:0,y:0,scale:.8}},secondStage:{container:{x:{align:"center"},y:{align:"center",dy:60}},ground:{x:0,y:-40
},light:{x:0,y:10},unit:{x:-5,y:30,scale:1.5},star:{x:-15,y:155,scale:1.5}},thirdStage:{container:{x:{align:"center"},y:{align:"center",dy:60}},light:{x:0,y:0},ground:{x:0,y:-40},prizes:{x:0,y:0,scale:.7}}};var UnitsShop=function(e){this.stored=e,this.inited=!1};UnitsShop.prototype.save=function(){return this.inited?{refreshTime:this.refreshTime,buyed:this.buyed}:this.stored},UnitsShop.prototype.init=function(){this.inited||(this.inited=!0,this.stored?(this.refreshTime=this.stored.refreshTime,this.buyed=this.stored.buyed,this.runRefreshTimeout()):this.refreshProducts())},UnitsShop.prototype.clear=function(){this.refreshTimeout&&clearTimeout(this.refreshTimeout)},UnitsShop.prototype.getLeftTime=function(){return this.refreshTime+cleverapps.parseInterval(UnitsShop.PRODUCTS_TIMEOUT)-Date.now()},UnitsShop.prototype.processCartUnits=function(e){this.cartUnits&&this.cartUnits.length&&(this.cartUnits.forEach(function(e){Game.currentGame.onUnitAvailable(e)},this),Game.currentGame.spawnAction(
this.cartUnits,e,{fromNode:!0,startScale:1/Game.currentGame.getScrollZoom()}),this.cartUnits=void 0)},UnitsShop.prototype.getCartAmount=function(){return this.cartUnits?this.cartUnits.length:0},UnitsShop.prototype.buy=function(e,t){for(this.buyed||(this.buyed=[]),this.buyed.push({code:e.code,stage:e.stage,amount:t}),Game.currentGame.storeSave(),"freechest"===e.code&&(cleverapps.sideBar.resetByClassName(UnitsShopIcon),cleverapps.localPushes.sendPush(cleverapps.LocalPushes.TYPES.FREE_CHEST,this.getLeftTime())),this.cartUnits||(this.cartUnits=[]),i=0;i<t;i++){var n=new Unit(e),s=Game.currentGame.map.getScreenCenterCell(),o=Game.currentGame.map.findEmptySlot(s.x,s.y,n);o&&(n.setPosition(o.x,o.y),Game.currentGame.map.add(Map2d.LAYER_UNITS,o.x,o.y,n),this.cartUnits.push(n))}},UnitsShop.prototype.runRefreshTimeout=function(){0<this.getLeftTime()?(this.clear(),this.refreshTimeout=new cleverapps.LongTimeout(this.refreshProducts.bind(this),this.getLeftTime())):this.refreshProducts()},
UnitsShop.prototype.canTakeFreeChest=function(){return this.init(),!this.buyed||0===this.buyed.filter(function(e){return"freechest"===e.code}).length},UnitsShop.prototype.generateProducts=function(){var s=cleverapps.clone(UnitsShop.DEFAULT_PRODUCTS,!0),i=Game.currentGame.unitsLibrary.listAvailableByType("fruit");UnitsShop.FRUIT_TEMPLATE.forEach(function(e){for(var t=0;t<i.length;t++){var n=cleverapps.clone(e,!0);n.unit.code=i[t],s.push(n)}});var n=Game.currentGame.unitsLibrary.getCurrentResource();if(n){UnitsShop.RESOURCE_CHESTS_TEMPLATE.forEach(function(e){var t=cleverapps.clone(e,!0);t.unit.code=n+"chest",s.push(t)});for(var e=UnitsShop.RESOURCE_DATA[n]||UnitsShop.RESOURCE_DATA.default,t=0,o=e.basicPrice;t<e.stages;t++,o*=3){var r=cleverapps.clone(UnitsShop.RESOURCE_TEMPLATE,!0);r.unit={stage:t,code:n},r.price=o,s.push(r)}}var a=Game.currentGame.unitsLibrary.getNextHero();return a&&"dwarf"!==a&&UnitsShop.HERO_ITEMS_TEMPLATE.forEach(function(e){var t=cleverapps.clone(e,!0)
;t.unit.code=a,s.unshift(t)}),this.buyed&&this.buyed.forEach(function(e){for(var t=0;t<s.length;t++)if(0<s[t].left&&s[t].unit.code===e.code&&s[t].unit.stage===e.stage&&s[t].amount===e.amount){s[t].left--;break}}),s},UnitsShop.prototype.buyedSomething=function(){return this.buyed&&this.buyed.length},UnitsShop.prototype.buyRefresh=function(){return!(!this.buyedSomething()||!cleverapps.user.takeGold(UnitsShop.REFRESH_PRICE))&&(cleverapps.eventLogger.logEvent("refresh_unit_shop_ruby",{amount:UnitsShop.REFRESH_PRICE}),this.refreshProducts(),!0)},UnitsShop.prototype.refreshProducts=function(){this.refreshTime=Date.now(),this.buyed=void 0,this.runRefreshTimeout(),Game.currentGame.storeSave(),cleverapps.localPushes.cancelPush(cleverapps.LocalPushes.TYPES.FREE_CHEST),cleverapps.sideBar.resetByClassName(UnitsShopIcon)},UnitsShop.PRODUCTS_TIMEOUT="6 hours",UnitsShop.COIN_PRICE=0,UnitsShop.RUBY_PRICE=1,UnitsShop.FRUIT_TAB=0,UnitsShop.RESOURCE_TAB=1,UnitsShop.OTHER_TAB=2,UnitsShop.REFRESH_PRICE=99
;var UnitsShopWindow=Window.extend({onWindowLoaded:function(e){var t=cleverapps.styles.UnitsShopWindow;e=e||{},Game.currentGame.unitsShop.init(),this.products=Game.currentGame.unitsShop.generateProducts(),this.tabsInfo=this.createTabs(),this._super({name:"UnitsShop",content:this.createContent(e),adjustToContent:!0,noBackground:!0,closeButton:!0,regularCloseButton:!0,extraWidth:2*t.contentOffsetX,contentOffsetX:t.contentOffsetX,foreground:bundles.windows.frames.window_foreground_png}),cleverapps.audio.playSound(bundles.main.urls.window_effect)},getTabProducts:function(t){return this.products.filter(function(e){return e.tab===t})},generateTab:function(e){var t=cleverapps.styles.UnitsShopWindow.tab,n=this.getTabProducts(e).map(function(e){var t=new UnitsShopTileModel(e);return new UnitsShopTile(t,{cart:this.cart,onClicked:function(){t.buy(),this.updateFreeChestAttention(),Game.currentGame.unitsShop.buyedSomething()&&(this.refreshButton.enable(),this.refreshButton.buttonContent.setOpacity(
255))}.bind(this)})}.bind(this)),s=new cleverapps.Layout(n,{direction:cleverapps.UI.HORIZONTAL,margin:t.tiles.margin,padding:t.tiles.padding}),i=new cleverapps.UI.ScrollView(s,{scrollBarEnabled:!1,direction:cleverapps.UI.HORIZONTAL});return i.setContentSize2(t.tiles.width,s.height+2),i.scrollToDefault(),i.setPositionRound(t),i},createTabs:function(){var e=function(e){var t=this.generateTab(e);return this.content.addChild(t),t},t={};return t[UnitsShop.FRUIT_TAB]={icon:bundles.windows.frames.tab_icon_ingredients,generator:e.bind(this,UnitsShop.FRUIT_TAB)},t[UnitsShop.RESOURCE_TAB]={icon:bundles.windows.frames.tab_icon_resource,generator:e.bind(this,UnitsShop.RESOURCE_TAB)},t[UnitsShop.OTHER_TAB]={icon:bundles.windows.frames.tab_icon_specials,generator:e.bind(this,UnitsShop.OTHER_TAB)},t},createBottomLine:function(e){var t=cleverapps.styles.UnitsShopWindow.bottomLine,n=cleverapps.UI.createScale9Sprite(bundles.units_shop.frames.title_png);n.setContentSize2(t),n.setPositionRound(t)
;var s=cleverapps.UI.generateOnlyText("messages:UnitsShop.newItemsWillAppear",cleverapps.styles.FONTS.UNITSSHOP_APPEAR_IN);s.setPositionRound(t.appearInText),s.fitTo(t.appearInText.maxWidth),n.addChild(s);var i=new cc.Sprite(bundles.main.frames.timer_icon);i.setPositionRound(t.timerIcon),i.setScale(t.timerIcon.scale),n.addChild(i);var o=new cleverapps.CountDown(Game.currentGame.unitsShop.getLeftTime()),r=new cleverapps.CountDownView(o,{font:cleverapps.styles.FONTS.UNITSSHOP_TIMER});r.setAnchorPoint2(0,.5),r.setPositionRound(t.timer),n.addChild(r);var a=cleverapps.UI.generateOnlyText("messages:UnitsShop.reset",cleverapps.styles.FONTS.UNITSSHOP_BUTTON_TEXT),c=new cc.Sprite(bundles.reward_icons.frames.gold_small_png),l=cleverapps.UI.generateImageText(UnitsShop.REFRESH_PRICE,cleverapps.styles.FONTS.UNITSSHOP_BUTTON_PRICE),p=new cleverapps.Layout([a,c,l],{direction:cleverapps.UI.HORIZONTAL,margin:t.button.margin});p.setCascadeOpacityEnabled(!0),a.y+=t.button.textOffsetY,
l.y+=t.button.priceOffsetY;var d=this.refreshButton=new cleverapps.UI.Button({content:p,width:t.button.width,height:t.button.height,padding:t.button.padding,onClicked:function(){Game.currentGame.unitsShop.buyRefresh()&&(this.cart.removeFromParent(!1),new UnitsShopWindow({activeTab:this.tabs.getActive(),cart:this.cart}),this.onClose=function(){},this.close())}.bind(this)});return d.buttonContent=p,Game.currentGame.unitsShop.buyedSomething()||(d.disable(),p.setOpacity(150)),d.setPositionRound(t.button),n.addChild(d),this.cart=e||new UnitsShopCart,n.addChild(this.cart),n},onClose:function(){this.cart.processItems()},updateFreeChestAttention:function(){this.tabs.setAttention(UnitsShop.OTHER_TAB,Game.currentGame.unitsShop.canTakeFreeChest())},createContent:function(e){var t=cleverapps.styles.UnitsShopWindow,n=this.content=cleverapps.UI.createScale9Sprite(bundles.windows.frames.window_bg_png,cleverapps.styles.Window.Background.scale9);n.setAnchorPoint2(),n.setContentSize2(t.width,t.height),
n.addChild(this.createBottomLine(e.cart));var s=this.tabs=new Tabs(this.tabsInfo,t.tabs);return s.setAnchorPoint2(0,0),s.setPositionRound(t.tabs),n.addChild(s),s.activateTab(e.activeTab||0),this.updateFreeChestAttention(),n}});UnitsShopWindow.prototype.listBundles=function(){return["units_shop"]},cleverapps.overrideFonts(cleverapps.styles.FONTS,{UNITSSHOP_BUTTON_TEXT:{size:40,color:cleverapps.styles.COLORS.LIGHT_TEXT_COLOR,stroke:cleverapps.styles.DECORATORS.LIGHT_TEXT_STROKE,shadow:cleverapps.styles.DECORATORS.LIGHT_TEXT_SHADOW},UNITSSHOP_BUTTON_PRICE:{name:"default",size:48},UNITSSHOP_APPEAR_IN:{size:48,color:cleverapps.styles.COLORS.LIGHT_TEXT_COLOR,stroke:cleverapps.styles.DECORATORS.LIGHT_TEXT_STROKE,shadow:cleverapps.styles.DECORATORS.LIGHT_TEXT_SHADOW},UNITSSHOP_TIMER:{name:"default",size:56}}),cleverapps.styles.UnitsShopWindow={width:2e3,height:1050,contentOffsetX:60,tabs:{x:{align:"left",dx:-118},y:{align:"top",dy:-40}},bottomLine:{width:1960,height:90,x:{align:"center"},y:{
align:"bottom",dy:105},timerIcon:{x:{align:"left",dx:1136},y:{align:"center",dy:-2},scale:.6},timer:{x:{align:"left",dx:1224},y:{align:"center",dy:0}},appearInText:{x:{align:"right",dx:-842},y:{align:"center",dy:-5},maxWidth:800},button:{x:{align:"right",dx:-80},y:{align:"center"},width:360,height:110,textOffsetY:-2,priceOffsetY:5,margin:8,padding:{left:10,right:10,top:10,bottom:15}}},tab:{x:{align:"center"},y:{align:"top",dy:-70},tiles:{margin:40,width:1950,padding:{x:50}}}};var UnitsShopCart=cc.Node.extend({ctor:function(){this._super();var e=cleverapps.styles.UnitsShopCart;this.amount=Game.currentGame.unitsShop.getCartAmount(),this.setAnchorPoint2(),this.setPositionRound(e),this.setContentSize2(e),this.icon=new cc.Node,this.icon.setAnchorPoint2(),this.icon.setContentSize2(e),this.icon.setCascadeOpacityEnabled(!0),this.icon.setPositionRound(this.width/2,this.height/2),this.addChild(this.icon);var t=new cc.Sprite(bundles.units_shop.frames.cart_bottom_png);t.setPositionRound(
e.bottomIcon),this.icon.addChild(t);var n=new cc.Sprite(bundles.units_shop.frames.cart_top_png);n.setPositionRound(e.topIcon),n.setLocalZOrder(2),this.icon.addChild(n),this.amountBlock=new cc.Sprite(bundles.merge.frames.upgradable_level_png),this.amountBlock.setPositionRound(e.amountBlock),this.amountText=cleverapps.UI.generateImageText("",cleverapps.styles.FONTS.UNITSSHOP_CART_AMOUNT),this.amountText.setPositionRound(e.amountBlock.amountText),this.amountBlock.addChild(this.amountText),this.addChild(this.amountBlock),this.firstItem=this.target=new cc.Node,this.firstItem.setPositionRound(e.item.firstItem.oneItem),this.firstItem.setLocalZOrder(1),this.icon.addChild(this.firstItem),this.secondItem=new cc.Node,this.secondItem.setPositionRound(e.item.secondItem),this.icon.addChild(this.secondItem),this.updateCartAmount()},incAmount:function(e){this.amount++,this.updateCartAmount(),this.firstItem.children.length&&(this.secondItem.removeAllChildren(),this.firstItem.children[0].replaceParent(
this.secondItem),this.firstItem.removeAllChildren(),this.firstItem.setPositionRound(cleverapps.styles.UnitsShopCart.item.firstItem.twoItems)),e.setScale(cleverapps.styles.UnitsShopCart.item.scale),e.replaceParent(this.firstItem)},updateCartAmount:function(){this.amountBlock&&(this.amountText.setString(this.amount),this.amountText.fitTo(cleverapps.styles.UnitsShopCart.amountBlock.amountText.maxWidth))},processItems:function(){if(Game.currentGame.unitsShop.cartUnits&&Game.currentGame.unitsShop.cartUnits.length){this.replaceParentSamePlace(Game.currentGame.map.getView().animations),this.setScale(1/Game.currentGame.getScrollZoom()),this.amountBlock.removeFromParent(),this.amountBlock=void 0,this.runAction(new cc.Sequence(new cc.MoveBy(.5,{x:cleverapps.styles.UnitsShopCart.moveDelta.x/Game.currentGame.getScrollZoom(),y:cleverapps.styles.UnitsShopCart.moveDelta.y/Game.currentGame.getScrollZoom()}),new cc.CallFunc(function(){this.setLocalZOrder(-1),Game.currentGame.unitsShop.processCartUnits(
this),e.stop()}.bind(this)),new cc.DelayTime(.2),new cc.CallFunc(function(){this.firstItem.removeFromParent(),this.secondItem.removeFromParent()}.bind(this)))),this.icon.runAction(new cc.Sequence(new cc.ScaleTo(.5,1.5),new cc.DelayTime(.7),new cc.FadeOut(.3),new cc.CallFunc(function(){this.removeFromParent()}.bind(this))));var e=new cleverapps.Particles(bundles.particle.jsons.particles_collect_json,bundles.game.urls.particle_texture);e.setScale(1.5),e.setLocalZOrder(-1),e.setPositionRound(this.width/2,this.height/2),this.addChild(e)}},listNodeBundles:function(){return["units_shop"]}});cleverapps.overrideFonts(cleverapps.styles.FONTS,{UNITSSHOP_CART_AMOUNT:{name:"default",size:40}}),cleverapps.styles.UnitsShopCart={x:{align:"left",dx:120},y:{align:"center",dy:-5},width:189,height:139,bottomIcon:{x:{align:"center"},y:{align:"center"}},topIcon:{x:{align:"center",dx:-18},y:{align:"center",dy:-18}},amountBlock:{x:{align:"right",dx:-10},y:{align:"bottom",dy:4},amountText:{x:{align:"center",
dx:2},y:{align:"center",dy:4},maxWidth:40}},item:{scale:.8,firstItem:{oneItem:{x:{align:"center",dx:-15},y:{align:"bottom",dy:85}},twoItems:{x:{align:"center",dx:-30},y:{align:"bottom",dy:85}}},secondItem:{x:{align:"center",dx:0},y:{align:"bottom",dy:100}}},moveDelta:{x:500,y:400}},UnitsShop.DEFAULT_PRODUCTS=[{unit:{code:"herochest",stage:0},price:80,priceType:UnitsShop.RUBY_PRICE,tab:UnitsShop.OTHER_TAB,amount:1,left:2},{unit:{code:"crystal",stage:0},price:75,priceType:UnitsShop.COIN_PRICE,tab:UnitsShop.OTHER_TAB,amount:1,left:1},{unit:{code:"crystal",stage:3},price:195,priceType:UnitsShop.RUBY_PRICE,tab:UnitsShop.OTHER_TAB,amount:1,left:1},{unit:{code:"freechest",stage:0},tab:UnitsShop.OTHER_TAB,amount:1,left:1},{unit:{code:"worker",stage:4},price:150,priceType:UnitsShop.RUBY_PRICE,tab:UnitsShop.OTHER_TAB,amount:2,left:2},{unit:{code:"sacks",stage:2},price:150,priceType:UnitsShop.COIN_PRICE,tab:UnitsShop.FRUIT_TAB,amount:1,left:3}],UnitsShop.FRUIT_TEMPLATE=[{unit:{stage:4},price:75,
priceType:UnitsShop.COIN_PRICE,tab:UnitsShop.FRUIT_TAB,amount:5,left:3},{unit:{stage:4},price:25,priceType:UnitsShop.RUBY_PRICE,tab:UnitsShop.FRUIT_TAB,amount:10,left:3}],UnitsShop.RESOURCE_CHESTS_TEMPLATE=[{unit:{stage:0},price:55,priceType:UnitsShop.COIN_PRICE,tab:UnitsShop.RESOURCE_TAB,amount:1,left:2},{unit:{stage:1},price:135,priceType:UnitsShop.COIN_PRICE,tab:UnitsShop.RESOURCE_TAB,amount:1,left:2},{unit:{stage:2},price:75,priceType:UnitsShop.RUBY_PRICE,tab:UnitsShop.RESOURCE_TAB,amount:1,left:2}],UnitsShop.RESOURCE_TEMPLATE={priceType:UnitsShop.COIN_PRICE,tab:UnitsShop.RESOURCE_TAB,amount:1,left:5},UnitsShop.HERO_ITEMS_TEMPLATE=[{unit:{stage:1},price:25,priceType:UnitsShop.RUBY_PRICE,tab:UnitsShop.OTHER_TAB,amount:1,left:3},{unit:{stage:0},price:35,priceType:UnitsShop.COIN_PRICE,tab:UnitsShop.OTHER_TAB,amount:1,left:3}],UnitsShop.RESOURCE_DATA={default:{basicPrice:50,stages:6},wood:{basicPrice:25,stages:4},stone:{basicPrice:30,stages:5},wagon:{basicPrice:35,stages:5}}
;var UnitsShopTileModel=function(e){TileModel.call(this,e),this.onBuy=function(){}};UnitsShopTileModel.prototype=Object.create(TileModel.prototype),(UnitsShopTileModel.prototype.constructor=UnitsShopTileModel).prototype.getAvailable=function(){return 0<this.product.left},UnitsShopTileModel.prototype.getCurrentPrice=function(){return this.product.price?this.product.price:"messages:FREE"},UnitsShopTileModel.prototype.getPriceIcon=function(){if(this.product.price)return this.product.priceType===UnitsShop.COIN_PRICE?bundles.reward_icons.frames.shop_coin_png:this.product.priceType===UnitsShop.RUBY_PRICE?bundles.reward_icons.frames.gold_small_png:void 0},UnitsShopTileModel.prototype.buy=function(){if(0<this.product.left)if(Game.currentGame.map.countEmptySlots()>=this.product.amount){var e=!1;this.product.priceType===UnitsShop.RUBY_PRICE?e=cleverapps.user.takeGold(this.product.price):this.product.priceType===UnitsShop.COIN_PRICE?e=Game.currentGame.takeCoins(this.product.price
):this.product.price||(e=!0),e&&(this.product.priceType===UnitsShop.RUBY_PRICE?cleverapps.eventLogger.logEvent(cleverapps.EVENTS.UNITS_SHOP_RUBY,{amount:this.product.price}):this.product.priceType===UnitsShop.COIN_PRICE&&cleverapps.eventLogger.logEvent(cleverapps.EVENTS.UNITS_SHOP_COINS,{amount:this.product.price}),cleverapps.eventLogger.logEvent(cleverapps.EVENTS.UNITS_SHOP_ITEM+"_"+this.product.unit.code+"_"+this.product.unit.stage+"_"+this.product.amount),Game.currentGame.unitsShop.buy(this.product.unit,this.product.amount),this.product.left--,this.onBuy())}else Game.currentGame.onHintMessage("messages:Spawn.nospace",!0)};var UnitsShopTile=cc.Node.extend({ctor:function(e,t){this._super(),this.tileModel=e,this.options=t||{},this.createContent(),this.tileModel.product.left||this.disable(),this.tileModel.onBuy=this.createListener(this.onBuyProduct.bind(this))},flyUnitToCart:function(e){var t=cleverapps.styles.UnitsShopTile,n=new cc.Node;n.setAnchorPoint2();var s=UnitView.getUnitImage(
this.tileModel.product.unit);s.setScale(t.icon.scale),n.addChild(s),this.iconNode.addChild(n),n.setPositionRound(this.iconNode.width/2,this.iconNode.height/2),n.setVisible(!1),n.runAction(new cc.Sequence(new cc.DelayTime(.1*e),new cc.CallFunc(function(){n.setVisible(!0),cleverapps.UI.collectAnimation(n,this.options.cart.target,{targetEffect:!0,finishRemove:!1,callback:function(){this.options.cart.incAmount(s),i.stop(function(){n.removeFromParent()})}.bind(this)})}.bind(this))));var i=new cleverapps.Particles(bundles.particle.jsons.particles_collect_json,bundles.game.urls.particle_texture);i.setLocalZOrder(-1),n.addChild(i),n.replaceParentSamePlace(cc.director.getRunningScene())},onBuyProduct:function(){for(var e=0;e<this.tileModel.product.amount;e++)this.flyUnitToCart(e);this.updateLeft(),this.tileModel.product.left||this.disable()},disable:function(){var e=cleverapps.styles.UnitsShopTile;this.amountBg.removeFromParent(),this.amountText.removeFromParent(),
this.iconNode.removeFromParent(),this.iconNode=new cc.Sprite(bundles.units_shop.frames.lock_png),this.iconNode.setPositionRound(e.blockIcon),this.bg.addChild(this.iconNode),this.button.disable(),this.updateAttention()},updateLeft:function(){this.leftText.setString(Messages.get("UnitsShop.left",{left:this.tileModel.product.left})),this.leftText.fitTo(cleverapps.styles.UnitsShopTile.title.left.maxWidth)},updateAttention:function(){!this.tileModel.product.left||this.tileModel.product.price?this.attention&&this.attention.removeFromParent():this.attention||(this.attention=new cc.Sprite(bundles.windows.frames.tab_attention),this.attention.setPositionRound(cleverapps.styles.UnitsShopTile.attention),this.addChild(this.attention),this.attention.runAction(new cc.RepeatForever(new cc.Sequence(new cc.ScaleTo(.3,1.1),new cc.ScaleTo(.3,1)))))},createContent:function(){var e=cleverapps.styles.UnitsShopTile;this.setContentSize2(e),this.setAnchorPoint2(),this.bg=cleverapps.UI.createScale9Sprite(
bundles.units_shop.frames.bg_png),this.bg.setContentSize2(e.bg),this.bg.setPositionRound(e.bg),this.addChild(this.bg);var t=cleverapps.UI.createScale9Sprite(bundles.units_shop.frames.title_png);t.setContentSize2(e.title),t.setPositionRound(e.title),this.bg.addChild(t),this.leftText=cleverapps.UI.generateOnlyText("",cleverapps.styles.FONTS.UNITSSHOPTILE_LEFT),this.leftText.setPositionRound(e.title.left),t.addChild(this.leftText),this.updateLeft(),this.amountBg=cleverapps.UI.createScale9Sprite(bundles.units_shop.frames.amount_bg_png),this.amountBg.setContentSize2(e.amount),this.amountBg.setPositionRound(e.amount),this.bg.addChild(this.amountBg),this.amountText=cleverapps.UI.generateImageText("x"+this.tileModel.product.amount,cleverapps.styles.FONTS.UNITSSHOPTILE_AMOUNT),this.amountText.setPositionRound(e.amount.text),this.bg.addChild(this.amountText),this.iconNode=new UnitOnCell(this.tileModel.product.unit,{scale:e.icon.scale}),this.iconNode.setAnchorPoint2(),
this.iconNode.setPositionRound(e.icon),this.bg.addChild(this.iconNode);var n,s=Game.currentGame.unitsLibrary.getUnitName(this.tileModel.product.unit);if(0<=s.indexOf(" ")?(s.lastIndexOf(" ")===s.indexOf(" ")&&(s=s.replace(" ","\n")),(n=cleverapps.UI.generateOnlyText(s,cleverapps.styles.FONTS.UNITSSHOPTILE_NAME)).setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER)):n=cleverapps.UI.generateOnlyText(s,cleverapps.styles.FONTS.UNITSSHOPTILE_NAME),n.fitTo(e.name.maxWidth,e.name.maxHeight),n.setPositionRound(e.name),this.bg.addChild(n),"chest"===Families[this.tileModel.product.unit.code].type){var i=new cleverapps.UI.Button({button_png:bundles.merge.frames.guide_button_png,button_on_png:bundles.merge.frames.guide_button_on_png,onClicked:function(){new ChestPrizeProbWindow(this.tileModel.product.unit)}.bind(this)});i.setPositionRound(e.guideButton),this.addChild(i)}this.button=new TileButton(this.tileModel,!1,{button_png:this.tileModel.product.price?e.button.button_png:e.button.free_button_png,
button_on_png:this.tileModel.product.price?e.button.button_on_png:e.button.free_button_on_png,button_off_png:e.button.button_off_png,width:e.button.width,height:e.button.height,onClicked:this.options.onClicked,font:cleverapps.styles.FONTS.UNITSSHOPTILE_BUTTON,scale:e.button.scale}),this.button.setPositionRound(e.button),this.addChild(this.button),this.updateAttention()}});cleverapps.overrideFonts(cleverapps.styles.FONTS,{UNITSSHOPTILE_AMOUNT:{name:"default",size:68},UNITSSHOPTILE_NAME:{size:46,color:cleverapps.styles.COLORS.DARK_TEXT_COLOR},UNITSSHOPTILE_LEFT:{size:46,color:cleverapps.styles.COLORS.LIGHT_TEXT_COLOR,stroke:cleverapps.styles.DECORATORS.LIGHT_TEXT_STROKE,shadow:cleverapps.styles.DECORATORS.LIGHT_TEXT_SHADOW},UNITSSHOPTILE_BUTTON:{size:68,color:cleverapps.styles.COLORS.LIGHT_TEXT_COLOR,stroke:cleverapps.styles.DECORATORS.LIGHT_TEXT_STROKE,shadow:cleverapps.styles.DECORATORS.LIGHT_TEXT_SHADOW}}),cleverapps.styles.UnitsShopTile={width:380,height:740,bg:{width:370,height:600,
x:{align:"center"},y:{align:"top",dy:-5}},attention:{x:{align:"right",dx:30},y:{align:"bottom",dy:42}},name:{maxWidth:340,maxHeight:110,x:{align:"center"},y:{align:"center",dy:-230}},icon:{x:{align:"center"},y:{align:"top",dy:-144},scale:1.4},blockIcon:{x:{align:"center"},y:{align:"center",dy:0}},amount:{width:380,height:120,x:{align:"center"},y:{align:"bottom",dy:120},text:{x:{align:"center"},y:{align:"bottom",dy:160}}},title:{width:356,height:80,x:{align:"center"},y:{align:"top",dy:-6},left:{x:{align:"center"},y:{align:"center",dy:-4},maxWidth:264}},guideButton:{x:{align:"left",dx:-14},y:{align:"top",dy:2}},button:{x:{align:"center"},y:{align:"bottom",dy:10},width:380,height:106,scale:1,button_png:bundles.buttons_main.frames.blue_button_png,button_on_png:bundles.buttons_main.frames.blue_button_on_png,free_button_png:bundles.buttons.frames.window_button_png,free_button_on_png:bundles.buttons.frames.window_button_on_png,button_off_png:bundles.buttons.frames.window_button_disabled_png}}
;var SpecialOfferWindow=Window.extend({onWindowLoaded:function(e){this.specialOffer=e,this._super({title:"messages:SpecialOfferWindow.title",name:"SpecialOfferWindow",content:this.createContent(),closeButton:!0}),cleverapps.audio.playSound(bundles.merge.urls.specialoffer_window_effect)},createContent:function(){var e=cleverapps.styles.SpecialOfferWindow,t=new cc.Node;t.setAnchorPoint2(),t.setContentSize(e);var n=this.offerButtons=this.createButtons();n.setAnchorPoint2(),n.setPositionRound(e.buttons),t.addChild(n);var s=this.createInfoBlock();s.setAnchorPoint2(),s.setPositionRound(e.infoBlock),t.addChild(s);var i=new cleverapps.Spine(bundles.dialogues.jsons.seller_json);i.setAnchorPoint2(),i.setPositionRound(e.person),t.addChild(i),this.specialOffer.prize.getData().buildable?i.setAnimation(0,"special_offer_building",!0):i.setAnimation(0,"special_offer",!0);var o=cleverapps.UI.generateOnlyText("messages:SpecialOfferWindow.text",cleverapps.styles.FONTS.SPECIAL_OFFER_WINDOW_TEXT)
;return o.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER),o.setDimensions(e.title.width,e.title.height),o.setAnchorPoint2(),o.setPositionRound(e.title),t.addChild(o),t},createInfoBlock:function(){var e=cleverapps.styles.SpecialOfferWindow.infoBlock,t=cleverapps.UI.createScale9Sprite(bundles.bonusworkerwindow.frames.info_background);t.setContentSize2(e);var n=this.createTimer();n.setAnchorPoint2(),n.setPositionRound(e.timer),t.addChild(n);var s=this.createUnitIcon();return s.setAnchorPoint2(),s.setPositionRound(e.icon),t.addChild(s),t},createUnitIcon:function(){var e=cleverapps.styles.SpecialOfferWindow.infoBlock.icon,t=new cc.Node;t.setAnchorPoint2(),t.setContentSize2(e);var n=new cc.Sprite(bundles.merge.frames.stand_ground);n.setAnchorPoint2(),n.setPositionRound(e.ground),t.addChild(n);var s=UnitView.getUnitStyles(this.specialOffer.prize),i=UnitView.getUnitImage(this.specialOffer.prize);return i.setAnchorPoint2(s.anchorX,s.anchorY),i.setPositionRound(e.icon),i.setScale(e.icon.scale),
t.addChild(i),t},createTimer:function(){var e=cleverapps.styles.SpecialOfferWindow.infoBlock.timer,t=new cc.Scale9Sprite(bundles.merge.frames.bar_bg_png);t.setAnchorPoint2(),t.setContentSize2(e);var n=new cleverapps.CountDownView(new cleverapps.CountDown(this.specialOffer.getTimeLeft(),{onFinish:this.timeIsOver.bind(this)}),{font:cleverapps.styles.FONTS.SPECIAL_OFFER_WINDOW_TIMER_TEXT});n.setAnchorPoint2(),n.setPositionRound(e.countdown),t.addChild(n);var s=new cc.Sprite(bundles.speedup.frames.timer_icon);s.setAnchorPoint2(),s.setPositionRound(e.icon),s.setScale(e.icon.scale),t.addChild(s);var i=cleverapps.UI.generateOnlyText("messages:SpecialOfferWindow.timer",cleverapps.styles.FONTS.SPECIAL_OFFER_WINDOW_TITLE_TEXT);return new cleverapps.Layout([t,i],{direction:cleverapps.UI.VERTICAL,margin:e.margin})},createButtons:function(){var e=cleverapps.styles.SpecialOfferWindow.buttons,t=new cc.Sprite(bundles.reward_icons.frames.shop_gold_png),n=cleverapps.UI.generateImageText(
this.specialOffer.getPrice(),cleverapps.styles.FONTS.SPECIAL_OFFER_WINDOW_BUTTON_PRICE_TEXT),s=new cleverapps.Layout([t,n],{direction:cleverapps.UI.HORIZONTAL,margin:e.button.margin}),i=new cleverapps.UI.Button({styles:e.button,content:s,contentOff:cleverapps.UI.generateOnlyText("messages:SpecialOfferWindow.timeIsOver",cleverapps.styles.FONTS.SPECIAL_OFFER_WINDOW_BUTTON_TEXT),onClicked:this.tryBuy.bind(this),button_images:cleverapps.UI.Button.Images.button_blue}),o=new cleverapps.UI.Button({styles:e.button,content:cleverapps.UI.generateOnlyText("messages:SpecialOfferWindow.pass",cleverapps.styles.FONTS.SPECIAL_OFFER_WINDOW_BUTTON_TEXT),onClicked:this.tryPass.bind(this),button_images:cleverapps.UI.Button.Images.button_red});return new cleverapps.Layout([i,o],{direction:cleverapps.UI.HORIZONTAL,margin:e.margin})},tryBuy:function(){this.specialOffer.buy()&&this.close()},tryPass:function(){this.close(),this.specialOffer.pass()},timeIsOver:function(){this.offerButtons.children[0].disable(),
this.offerButtons.children[1].disable()}});cleverapps.overrideFonts(cleverapps.styles.FONTS,{SPECIAL_OFFER_WINDOW_TIMER_TEXT:{size:38,color:cleverapps.styles.COLORS.WHITE},SPECIAL_OFFER_WINDOW_TITLE_TEXT:{size:55,color:cleverapps.styles.COLORS.YELLOW_TEXT_COLOR,stroke:cleverapps.styles.DECORATORS.LIGHT_TEXT_STROKE,shadow:cleverapps.styles.DECORATORS.LIGHT_TEXT_SHADOW},SPECIAL_OFFER_WINDOW_TEXT:{size:40,color:cleverapps.styles.COLORS.DARK_TEXT_COLOR},SPECIAL_OFFER_WINDOW_BUTTON_PRICE_TEXT:{size:70,color:cleverapps.styles.COLORS.LIGHT_TEXT_COLOR,stroke:cleverapps.styles.DECORATORS.LIGHT_TEXT_STROKE,shadow:cleverapps.styles.DECORATORS.LIGHT_TEXT_SHADOW},SPECIAL_OFFER_WINDOW_BUTTON_TEXT:{size:50,color:cleverapps.styles.COLORS.LIGHT_TEXT_COLOR,stroke:cleverapps.styles.DECORATORS.LIGHT_TEXT_STROKE,shadow:cleverapps.styles.DECORATORS.LIGHT_TEXT_SHADOW}}),cleverapps.styles.SpecialOfferWindow={width:1400,height:610,person:{scale:1.5,x:{align:"left",dx:-30},y:{align:"bottom",dy:-100}},
infoBlock:{width:1430,height:340,x:{align:"center"},y:{align:"top"},icon:{width:270,height:270,x:{align:"right",dx:-70},y:{align:"center",dy:5},icon:{x:{align:"center"},y:{align:"center",dy:-45},scale:1.5},shine:{x:{align:"center"},y:{align:"center",dy:-25},scale:1.4},ground:{x:{align:"center",dx:5},y:{align:"center",dy:-50}}},timer:{width:260,height:50,x:{align:"right",dx:-350},y:{align:"center",dy:10},margin:20,countdown:{x:{align:"right",dx:-20},y:{align:"center",dy:2}},icon:{x:{align:"left",dx:-20},y:{align:"center"},scale:.5}}},title:{width:600,height:0,x:{align:"right",dx:-90},y:{align:"bottom",dy:125}},buttons:{x:{align:"right",dx:-30},y:{align:"bottom",dy:-25},margin:52,button:{width:360,height:110,padding:{left:20,right:20,top:5,bottom:10},margin:12}}};var EnergyProducts=function(e){this.data=e||{}};EnergyProducts.prototype.save=function(){return this.data},EnergyProducts.prototype.getBuyTime=function(e){return this.data[e]||0},EnergyProducts.prototype.buyProduct=function(e){
this.data[e]=Date.now(),Game.currentGame.storeSave()};var EnergyLottery=function(e){this.onLotteryStatusChanged=function(e){},this.load(e),this.update()};EnergyLottery.prototype.onChangeGameLevel=function(){this.update()},EnergyLottery.prototype.load=function(e){e=e||{},this.refreshTime=e.refreshTime||0,this.roundTime=e.roundTime||0,this.seed=e.seed||0,this.used=e.used||0,e.swaps&&(this.swaps=e.swaps.split("").map(cleverapps.castType)),e.lastRefreshTime&&0===e.roundTime&&(e.roundTime=1)},EnergyLottery.prototype.save=function(){var e={refreshTime:this.refreshTime,roundTime:this.roundTime,seed:this.seed,used:this.used};return this.swaps&&(e.swaps=this.swaps.join("")),e},EnergyLottery.prototype.update=function(){clearTimeout(this.timeout);var e=this.getTimeLeft(),t=e<=0&&this.isAvailable();this.ready!==t&&(this.ready=t,this.onLotteryStatusChanged()),0<e&&(this.timeout=new cleverapps.LongTimeout(this.update.bind(this),e))},EnergyLottery.prototype.clear=function(){clearTimeout(this.timeout)
},EnergyLottery.prototype.isAvailable=function(){return cleverapps.user.checkAvailable(EnergyLottery.AVAILABLE)},EnergyLottery.prototype.isReady=function(){return this.isAvailable()&&this.ready},EnergyLottery.prototype.getTimeLeft=function(){var e=this.roundTime+cleverapps.parseInterval(EnergyLottery.ROUND_INTERVAL);return this.used===EnergyLottery.USED_ALL&&(e=Math.max(e,this.getNextRefreshTime())),Math.max(0,e-Date.now())},EnergyLottery.prototype.getNextRefreshTime=function(){return this.refreshTime+cleverapps.parseInterval(EnergyLottery.REFRESH_INTERVAL)},EnergyLottery.prototype.getLot=function(e){return this.lots[e]},EnergyLottery.prototype.isUsed=function(e){return this.used&1<<e},EnergyLottery.prototype.refresh=function(){this.lots=void 0,this.refreshTime=Date.now(),this.used=0,this.seed++,this.swaps=void 0,Game.currentGame.storeSave()},EnergyLottery.prototype.initializeLots=function(){this.getNextRefreshTime()<=Date.now()&&this.refresh(),this.lots||(cleverapps.Random.seed(
this.seed),this.lots=cleverapps.Random.shuffle(EnergyLottery.LOTS),this.swaps&&this.makeSwaps(this.lots,this.swaps))},EnergyLottery.prototype.refreshRound=function(){this.roundTime=1,Game.currentGame.storeSave(),this.update()},EnergyLottery.prototype.useLot=function(e){if(!this.isUsed(e)&&this.isReady()){if(0===this.roundTime){var t=this.lots.indexOf(EnergyLottery.MAX_VALUE);t!==e&&(this.swaps=[e,t],this.makeSwaps(this.lots,this.swaps))}this.used=this.used|1<<e,this.roundTime=Date.now(),Game.currentGame.storeSave(),this.update()}},EnergyLottery.prototype.makeSwaps=function(e,t){for(var n=0;n<t.length;n+=2){var s=e[t[n]];e[t[n]]=e[t[n+1]],e[t[n+1]]=s}},EnergyLottery.maxValue=function(){return EnergyLottery.MAX_VALUE},EnergyLottery.countLots=function(){return EnergyLottery.LOTS.length},EnergyLottery.AVAILABLE={level:4},EnergyLottery.LOTS=[30,35,40,45,50,55,60,65,100],EnergyLottery.MAX_VALUE=Math.max.apply(Math,EnergyLottery.LOTS),EnergyLottery.USED_ALL=(1<<EnergyLottery.LOTS.length)-1,
EnergyLottery.ROUND_INTERVAL="3 hours",EnergyLottery.REFRESH_INTERVAL="24 hours",cleverapps.config.debugMode&&(EnergyLottery.ROUND_INTERVAL="30 seconds",EnergyLottery.REFRESH_INTERVAL="5 minutes");var EnergyLotteryWindow=Window.extend({onWindowLoaded:function(e){this.used=!1,Game.currentGame.energyLottery.initializeLots(),this._super({name:"EnergyLotteryWindow",content:this.createContent(),noBackground:!0,adjustToContent:!0,closeButton:!0}),this.onClose=e},createContent:function(){var e=cleverapps.styles.EnergyLotteryWindow,t=new cleverapps.Spine(bundles.energylotterywindow.jsons.energy_lottery_json);t.setAnchorPoint2(),t.setPositionRound(e.background),t.setAnimation(0,"animation",!0);var n=new cc.Node;n.setAnchorPoint2(),n.setContentSize2(t.width,t.height),n.addChild(t);var s=this.createField();s.setAnchorPoint2(),s.setPositionRound(e.field),n.addChild(s);var i=cleverapps.UI.generateOnlyText("messages:EnergyLotteryWindow.title",cleverapps.styles.FONTS.ENERGY_LOTTERY_TITLE_TEXT)
;i.setAnchorPoint2(),i.setPositionRound(e.title),i.fitTo(e.title.width,e.title.height),n.addChild(i);var o=cleverapps.UI.generateOnlyText("messages:EnergyLotteryWindow.description",cleverapps.styles.FONTS.ENERGY_LOTTERY_DESCRIPTION_TEXT);o.setAnchorPoint2(),o.setPositionRound(e.description),o.fitTo(e.description.width,e.description.height),n.addChild(o);var r=new cleverapps.Spine(bundles.dialogues.jsons.seller_json);r.setAnchorPoint2(),r.setPositionRound(e.person),r.setAnimation(0,"lottery",!0),r.setLocalZOrder(1),n.addChild(r);var a=this.axe=new cleverapps.Spine(bundles.energylotterywindow.jsons.energy_lottery_axe_json);return a.setAnchorPoint2(),a.setPositionRound(e.axe),a.setLocalZOrder(10),a.runAction(new cc.Sequence(new cc.DelayTime(.3),new cc.CallFunc(a.setAnimationAndIdleAfter.bind(a,"axe_emergence","axe_idle")))),n.addChild(a),n},createDescription:function(){return cleverapps.UI.generateOnlyText("messages:EnergyLotteryWindow.description",cleverapps.styles.FONTS.WINDOW_TEXT)},
createField:function(){for(var e=cleverapps.styles.EnergyLotteryWindow.field,t=[],n=0;n<EnergyLottery.countLots();n++)t[n]=this.createLotIcon(n);return this.icons=t,new cleverapps.GridLayout(t,{columns:3,margin:e.margin,padding:e.padding})},createLotIcon:function(e){var t=cleverapps.styles.EnergyLotteryWindow.icon,n=Game.currentGame.energyLottery,s=new cc.Node;s.setAnchorPoint2(),s.setContentSize2(t);var i=s.animation=new cleverapps.Spine(bundles.energylotterywindow.jsons.energy_lottery_icon_json);i.setAnchorPoint2(),i.setPositionRound(s.width/2,s.height/2),s.addChild(i);var o=s.reward=cleverapps.UI.generateImageText(n.getLot(e),cleverapps.styles.FONTS.ENERGY_LOTTERY_VALUE_TEXT);return o.setAnchorPoint2(),o.setPositionRound(t.reward),s.addChild(o),n.isUsed(e)?i.setAnimation(0,"idle_crashed",!0):(i.setAnimation(0,"idle",!0),o.setVisible(!1),cleverapps.UI.applyHover(s),cleverapps.UI.onClick(s,this.onIconClicked.bind(this,e),{useInteractiveScale:!0})),s},onIconClicked:function(n){
var s=Game.currentGame.energyLottery;if(!this.used&&!s.isUsed(n)&&s.isReady()){var i=this.icons[n];this.used=!0,this.icons.forEach(function(e,t){cc.eventManager.removeListeners(e),s.isUsed(t)||e===i||e.animation.setAnimationAndIdleAfter("close","idle_closed")}.bind(this)),cleverapps.audio.playSound(bundles.energylotterywindow.urls.open_lot_effect);var o=this.axe;o.stopAllActions(),o.setAnimation(0,"axe_crash1",!1),o.setCompleteListener(function(){var e=cleverapps.styles.EnergyLotteryWindow.axe.target.offset,t=o.parent.convertToNodeSpace(i.parent.convertToWorldSpace(i.getPosition()));o.setCompleteListener(null),o.setAnimation(0,"axe_crash2",!1),o.runAction(new cc.Sequence(new cc.MoveTo(.5667,t.x+e.x,t.y+e.y),new cc.CallFunc(function(){i.animation.setAnimationAndIdleAfter("crash","idle_crashed"),i.setLocalZOrder(1),s.useLot(n),i.reward.setVisible(!0),i.reward.setString(s.getLot(n)),Game.currentGame.addReward("energy",s.getLot(n),i,{beginScale:.8,withoutDelta:!0}),
cleverapps.UI.onTouchBegan(this.window,this.close.bind(this))}.bind(this))))}.bind(this))}},listBundles:function(){return["energylotterywindow"]}});cleverapps.overrideStyles(cleverapps.styles.DECORATORS,{ENERGY_LOTTERY_STROKE:{color:new cc.Color(95,29,17,255),size:1},ENERGY_LOTTERY_SHADOW:{color:new cc.Color(11,13,37,128),direction:cc.size(0,-3),blur:4}}),cleverapps.overrideFonts(cleverapps.styles.FONTS,{ENERGY_LOTTERY_TITLE_TEXT:{size:78,color:new cc.Color(255,201,39,255),stroke:cleverapps.styles.DECORATORS.ENERGY_LOTTERY_STROKE,shadow:cleverapps.styles.DECORATORS.ENERGY_LOTTERY_SHADOW},ENERGY_LOTTERY_DESCRIPTION_TEXT:{size:34,color:new cc.Color(255,220,132,255),stroke:cleverapps.styles.DECORATORS.ENERGY_LOTTERY_STROKE,shadow:cleverapps.styles.DECORATORS.ENERGY_LOTTERY_SHADOW},ENERGY_LOTTERY_VALUE_TEXT:{size:40,color:new cc.Color(253,236,65,255),stroke:cleverapps.styles.DECORATORS.ENERGY_LOTTERY_STROKE}}),cleverapps.styles.EnergyLotteryWindow={background:{x:{align:"center"},y:{
align:"center",dy:-45}},field:{x:{align:"center",dx:0},y:{align:"center",dy:-28},margin:{x:50,y:50},padding:{x:30,y:30}},person:{x:{align:"center",dx:-609},y:{align:"bottom",dy:50}},icon:{width:150,height:150,reward:{x:{align:"center"},y:{align:"center",dy:-17}}},title:{x:{align:"center",dx:0},y:{align:"center",dy:396},width:600,height:90},description:{x:{align:"center",dx:0},y:{align:"center",dy:306},width:400,height:50},axe:{x:{align:"right",dx:155},y:{align:"bottom",dy:-360},target:{offset:{x:709,y:-465}}}};var EnergyFeastMissionWindow=Window.extend({onWindowLoaded:function(e){this.mission=e,this._super({name:"EnergyFeastMissionWindow",content:this.createContent(),noBackground:!0}),cleverapps.metha.showControlsWhileFocused(["MenuBarGoldItem","MenuBarLivesItem","MenuBarWorkersItem"]),e.updateCompetitionResults();var t=cleverapps.styles.EnergyFeastMissionWindow,n=new cc.Node;n.setAnchorPoint2(),n.setContentSize(this.getContentSize()),n.setPositionRound(this.width/2,this.height/2),
this.addChild(n);var s=cleverapps.UI.getSceneSize();if(s.width<t.needWidth){var i=s.width/t.needWidth;n.setScale(i),n.height/=i,this.content.setScale(i)}var o=this.person=new cleverapps.Spine(bundles.dialogues.jsons.warlock_json,t.person.scale);o.setAnchorPoint2(),o.setPositionRound(t.person),o.setAnimation(0,"dialogue_smile",!0),n.addChild(o);var r=this.smallBug=new cleverapps.Spine(bundles.energy_feast.jsons.energy_feast_small_bug_json);r.setAnimation(0,"animation",!0),r.setAnchorPoint2(),r.setPositionRound(t.smallBug),n.addChild(r);var a=this.mediumBug=new cleverapps.Spine(bundles.energy_feast.jsons.energy_feast_medium_bug_json);a.setAnimation(0,"animation",!0),a.setAnchorPoint2(),a.setPositionRound(t.mediumBug),n.addChild(a);var c=this.bigBug=this.createOfferBug();c.setAnchorPoint2(),c.setPositionRound(t.bigBug),n.addChild(c)},createContent:function(){var e=cleverapps.styles.EnergyFeastMissionWindow,t=this.mission,n=new cleverapps.Spine(bundles.energy_feast.jsons.energy_feast_json)
;n.setAnchorPoint2(),n.setPositionRound(e.background),n.setAnimation(0,"animation",!0);var s=new cc.Node;s.setAnchorPoint2(),s.setContentSize2(n.width,n.height),s.addChild(n);var i=this.createTable();i.setAnchorPoint2(),i.setPositionRound(e.table),s.addChild(i);var o=cleverapps.UI.generateOnlyText("messages:EnergyFeastMissionWindow.title",cleverapps.styles.FONTS.ENERGY_FEAST_MAIN_TITLE_TEXT);o.setAnchorPoint2(),o.setPositionRound(e.mainTitle),o.fitTo(e.mainTitle.width,e.mainTitle.height),s.addChild(o);var r=new cleverapps.UI.Button({button_png:bundles.merge.frames.guide_button_png,button_on_png:bundles.merge.frames.guide_button_on_png,onClicked:function(){new EnergyFeastMissionRulesWindow}});if(r.setAnchorPoint2(),r.setPositionRound(e.helpButton),s.addChild(r),t.isRunning()){var a=new cleverapps.CountDownView(new cleverapps.CountDown(t.getTimeLeft(),{onFinish:function(){new EnergyFeastMissionWindow(t),this.close()}.bind(this)}),{font:cleverapps.styles.FONTS.ENERGY_FEAST_TIMER_TEXT})
;a.setAnchorPoint2(),a.setPositionRound(e.timer),s.addChild(a)}else{var c=cleverapps.UI.generateOnlyText("messages:EnergyFeastMissionWindow.finished",cleverapps.styles.FONTS.ENERGY_FEAST_TIMER_TEXT);c.setAnchorPoint2(),c.setPositionRound(e.finishTitle),c.fitTo(e.finishTitle.width,e.finishTitle.height),s.addChild(c);var l=new cleverapps.UI.Button({styles:e.finishButton,button_images:cleverapps.UI.Button.Images.button_blue,text:t.getPrize()?"messages:ClaimPrize.Button.text":"messages:Close",font:cleverapps.styles.FONTS.BUTTON_TEXT,onClicked:this.claimPrizes.bind(this)});l.setAnchorPoint2(),l.setPositionRound(e.finishButton),s.addChild(l)}return this.content=s},onShow:function(){var e=this.person;e.y-=e.height,e.runAction(new cc.MoveBy(.4,0,e.height).easing(cc.easeBackOut()));var t=this.bigBug;t.y+=t.height,t.x+=t.height,t.runAction(new cc.MoveBy(.6,-t.height,-t.height).easing(cc.easeCubicActionOut()));var n=this.mediumBug;n.y+=t.height,n.x+=t.height,n.runAction(new cc.MoveBy(.8,-t.height
,-t.height).easing(cc.easeCubicActionOut()));var s=this.smallBug;s.y+=t.height,s.x+=t.height,s.runAction(new cc.MoveBy(.7,-t.height,-t.height).easing(cc.easeCubicActionOut()));var i=this.buyPackButton;i&&(i.setVisible(!1),i.setScale(.2),i.runAction(new cc.Sequence(new cc.DelayTime(.6),new cc.Show,new cc.ScaleTo(.2,1)))),cleverapps.audio.playSound(bundles.merge.urls.pixel_fly_effect)},onClose:function(){var e=this.mission;e.isRunning()||e.receiveReward()||e.complete()},createTable:function(){var e=cleverapps.styles.EnergyFeastMissionWindow.table,t=this.mission,n=cleverapps.missionManager.table.createTableView({id:t.type,data:t.getResults(),dataIcon:t.getIcon(),options:{styles:e},rowConstructor:EnergyFeastMissionWindow.MissionRow});return t.onChangeResults=this.createListener(function(){var e=t.getResults();n.updateResults(e),cleverapps.missionManager.table.updateResults(t.type,e)}),n},createOfferBug:function(){var e=cleverapps.styles.EnergyFeastMissionWindow.bigBug,
t=EnergyFeastMissionWindow.PACK,n=new cleverapps.Spine(bundles.energy_feast.jsons.energy_feast_big_bug_json);if(n.setAnimation(0,"animation",!0),!this.mission.isRunning())return n.setAnimation(0,"animation2",!0),n;var s=new cc.Sprite(bundles.reward_icons.frames.reward_energy_png);s.setScale(e.energyReward.scale);var i=cleverapps.UI.generateOnlyText(t.prizes.energy,cleverapps.styles.FONTS.ENERGY_FEAST_REWARD_TEXT);i.fitTo(e.energyReward.width);var o=new cleverapps.Layout([i,s],{direction:cleverapps.UI.VERTICAL});o.setAnchorPoint2(),o.setPositionRound(e.energyReward),n.addChild(o);var r=new cc.Sprite(bundles.reward_icons.frames.reward_worker_png);r.setScale(e.workerReward.scale);var a=cleverapps.UI.generateOnlyText(t.prizes.worker.title,cleverapps.styles.FONTS.ENERGY_FEAST_REWARD_TEXT);a.fitTo(e.workerReward.width);var c=new cleverapps.Layout([a,r],{direction:cleverapps.UI.VERTICAL});c.setAnchorPoint2(),c.setPositionRound(e.workerReward),n.addChild(c)
;var l=this.buyPackButton=new UseGoldButton({button_images:cleverapps.UI.Button.Images.button_green,price:t.price,onClicked:this.buyPackProduct.bind(this)},e.buyPackButton);return l.setAnchorPoint2(),l.setPositionRound(e.buyPackButton),n.addChild(l),n},claimPrizes:function(){var e=this.mission;if(e.isCompleted())this.close();else{var t=e.receiveReward();t&&t.unit&&Game.currentGame.map.countEmptySlots()<cleverapps.toArray(t.unit).length?Game.currentGame.onHintMessage("messages:Spawn.nospace",!0):(this.close(),e.complete())}},buyPackProduct:function(){cleverapps.eventLogger.logEvent(cleverapps.EVENTS.ENERGY_FEAST_PACK_BUY),cleverapps.eventLogger.logEvent(cleverapps.EVENTS.ENERGY_FEAST_PACK_RUBY,{amount:EnergyFeastMissionWindow.PACK.price}),new RewardWindow({reward:EnergyFeastMissionWindow.PACK.prizes}),this.close()},listBundles:function(){return["energy_feast"]}});EnergyFeastMissionWindow.MissionRow=cleverapps.MissionRow.extend({getTooltipText:function(){return Messages.get(
"EnergyFeastMissionWindow.tooltip.amount")},addPrizeBannerTooltip:function(e,t){cleverapps.tooltipManager.create(t,{text:e,position:cleverapps.styles.UI.Tooltip.LOCATION.above,clickableArea:this.clickableArea})}}),EnergyFeastMissionWindow.PACK={price:250,prizes:{energy:250,worker:Product.FormatUnlimitedLives("1 day")}},cleverapps.overrideStyles(cleverapps.styles.DECORATORS,{ENERGY_FEAST_STROKE:{color:new cc.Color(95,29,17,255),size:1},ENERGY_FEAST_SHADOW:{color:new cc.Color(11,13,37,128),direction:cc.size(0,-3),blur:4}}),cleverapps.overrideFonts(cleverapps.styles.FONTS,{ENERGY_FEAST_MAIN_TITLE_TEXT:{size:78,color:new cc.Color(255,201,39,255),stroke:cleverapps.styles.DECORATORS.ENERGY_FEAST_STROKE,shadow:cleverapps.styles.DECORATORS.ENERGY_FEAST_SHADOW},ENERGY_FEAST_TIMER_TEXT:{size:52,color:new cc.Color(255,220,132,255),stroke:cleverapps.styles.DECORATORS.ENERGY_FEAST_STROKE,shadow:cleverapps.styles.DECORATORS.ENERGY_FEAST_SHADOW},ENERGY_FEAST_REWARD_TEXT:{size:34,color:new cc.Color(
255,220,132,255),shadow:cleverapps.styles.DECORATORS.ENERGY_FEAST_SHADOW}}),cleverapps.styles.EnergyFeastMissionWindow={background:{x:{align:"center"},y:{align:"center",dy:65}},needWidth:1800,table:{x:{align:"center",dx:-12},y:{align:"center",dy:-42},height:680,margin:-2,bg:void 0},person:{x:{align:"center",dx:-700},y:{align:"bottom",dy:52},scale:1.6},mainTitle:{x:{align:"center",dx:0},y:{align:"center",dy:436},width:780,height:90},helpButton:{x:{align:"center",dx:-385},y:{align:"center",dy:433}},smallBug:{x:{align:"center",dx:1108},y:{align:"center",dy:62}},mediumBug:{x:{align:"center",dx:857},y:{align:"center",dy:411}},bigBug:{x:{align:"center",dx:730},y:{align:"center",dy:75},workerReward:{x:{align:"center",dx:5},y:{align:"center",dy:-320},width:130,scale:1},energyReward:{x:{align:"center",dx:-160},y:{align:"center",dy:-318},width:130,scale:.9},buyPackButton:{x:{align:"center",dx:-60},y:{align:"center",dy:-533},width:230,height:90}},timer:{x:{align:"center",dx:0},y:{align:"center",
dy:343}},finishTitle:{x:{align:"center",dx:0},y:{align:"center",dy:341},width:415,height:60},finishButton:{x:{align:"center",dx:0},y:{align:"bottom",dy:-50},width:400,height:95}};var EnergyFeastLockedIcon=function(){SideBarIcon.call(this,{animation:bundles.sidebar.jsons.energy_feast_icon_json})};EnergyFeastLockedIcon.prototype=Object.create(SideBarIcon.prototype),(EnergyFeastLockedIcon.prototype.constructor=EnergyFeastLockedIcon).prototype.resetState=function(){if(this.available=!1,cleverapps.config.debugMode&&-1!==cleverapps.missionManager.getProjectAvailableTypes().indexOf(Mission.TYPE_ENERGY_FEAST)){var e=Missions[Mission.TYPE_ENERGY_FEAST].available;cleverapps.user.checkAvailable(e,{future:!0})&&(cleverapps.user.checkAvailable(e)||(this.available=!0,this.setLocked(!0),this.setAttention(!1),this.setTitle(Messages.get("IconLocked.TextDefault",{levelNo:this.getTipData()}))))}},EnergyFeastLockedIcon.prototype.onPressed=function(){this.removeFromSideBar(),cleverapps.metha.display({
focus:"reloadMainScene",action:function(e){cleverapps.metha.gotoMainScene(e)}})},EnergyFeastLockedIcon.prototype.getTipData=function(){var e=Missions[Mission.TYPE_ENERGY_FEAST].available;return cleverapps.humanReadableNumber(e.episode,e.level)};var RemoveUnitWindow=Window.extend({onWindowLoaded:function(e){this.unit=e,this._super({name:"RemoveUnitWindow",title:"messages:RemoveUnitWindow.title",adjustToContent:!0,closeButton:!0,content:this.createContent()}),cleverapps.audio.playSound(bundles.main.urls.window_effect)},createContent:function(){var e=cleverapps.styles.RemoveUnitWindow,t=this.createIcon();t.setAnchorPoint2();var n=cleverapps.UI.generateOnlyText("messages:RemoveUnitWindow.text",cleverapps.styles.FONTS.DARK_TEXT);n.setAnchorPoint2(),n.setDimensions(e.text.width,0),n.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER);var s=this.createButtons();return s.setAnchorPoint2(),new cleverapps.Layout([s,n,t],{direction:cleverapps.UI.VERTICAL,margin:e.margin,padding:e.padding})},
createIcon:function(){var e=cleverapps.styles.RemoveUnitWindow.icon,t=new cc.Node;t.setAnchorPoint2(),t.setContentSize2(e);var n=UnitView.getUnitStyles(this.unit),s=UnitView.getUnitImage(this.unit);cleverapps.UI.fitToBox(s,e.icon),s.setAnchorPoint2(n.anchorX,n.anchorY),s.setPositionRound(e.icon),t.addChild(s),s.clearTrack&&s.clearTrack(0);var i=new cc.Sprite(bundles.merge.frames.stand_ground);return i.setAnchorPoint2(),i.setPositionRound(e.ground),i.setLocalZOrder(-1),t.addChild(i),t},createButtons:function(){var e=cleverapps.styles.RemoveUnitWindow.buttons,t=new cleverapps.UI.Button({width:e.width,height:e.height,button_images:cleverapps.UI.Button.Images.button_red,font:cleverapps.styles.FONTS.LIGHT_BUTTON_TEXT,text:"messages:Yes",onClicked:function(){this.unit.onDestruction(),this.unit.remove(!0),this.close()}.bind(this)}),n=new cleverapps.UI.Button({width:e.width,height:e.height,button_images:cleverapps.UI.Button.Images.button_green,font:cleverapps.styles.FONTS.LIGHT_BUTTON_TEXT,
text:"messages:No",onClicked:this.close.bind(this)});return new cleverapps.Layout([t,n],{direction:cleverapps.UI.HORIZONTAL,margin:e.margin})}});cleverapps.styles.RemoveUnitWindow={margin:50,padding:{x:100,top:120,bottom:80},icon:{width:300,height:220,icon:{width:180,height:180,maxScale:1.7,x:{align:"center",dx:0},y:{align:"center",dy:-10}},ground:{x:{align:"center",dx:10},y:{align:"center",dy:-20}}},text:{width:1e3},buttons:{width:300,height:110,margin:40}};var SpecialEnergyOfferWindow=Window.extend({onWindowLoaded:function(){this._super({name:"SpecialEnergyOfferWindow",content:this.createContent(),noBackground:!0,adjustToContent:!0,closeButton:!0}),this.addPerson()},createContent:function(){var e=cleverapps.styles.SpecialEnergyOfferWindow,t=new cc.Node;t.setAnchorPoint2(),t.setContentSize2(e);var n=cleverapps.UI.generateOnlyText("messages:SpecialEnergyOfferWindow.title",cleverapps.styles.FONTS.SPECIALENERGYOFFER_TITLE_TEXT);n.setAnchorPoint2(),n.setPositionRound(e.title),t.addChild(n
);var s=this.target=new cc.Node;s.setAnchorPoint2(),s.setPositionRound(e.target),t.addChild(s);var i=cleverapps.UI.generateImageText("x"+SpecialEnergyOfferWindow.ENERGY_AMOUNT,cleverapps.styles.FONTS.SPECIALENERGYOFFER_AMOUNT_TEXT);i.setAnchorPoint2(),i.setPositionRound(e.amount),i.fitTo(e.amount.width,e.amount.height),t.addChild(i);var o=new UseGoldButton({button_images:cleverapps.UI.Button.Images.button_green,font:cleverapps.styles.FONTS.SPECIALENERGYOFFER_BUTTON_TEXT,image:bundles.reward_icons.frames.gold_small_png,price:SpecialEnergyOfferWindow.ENERGY_PRICE,filter:function(){return!this.used}.bind(this),onClicked:this.buyEnergy.bind(this),eventName:"buy_special_energy_ruby"},e.button);return o.setAnchorPoint2(),o.setPositionRound(e.button),t.addChild(o),t},addPerson:function(){var e=cleverapps.styles.SpecialEnergyOfferWindow.person,t=new cleverapps.Spine(bundles.dialogues.jsons.seller_json);t.setAnimation(0,"special_offer",!0),t.setPositionRound(e.position),this.addChild(t),
t.y-=t.height,t.runAction(new cc.MoveBy(.4,0,t.height).easing(cc.easeBackOut()))},buyEnergy:function(){this.used=!0,Game.currentGame.addReward("energy",SpecialEnergyOfferWindow.ENERGY_PRICE,this.target,{beginScale:1,withoutDelta:!0}),Game.currentGame.counter.setTimeout(this.close.bind(this),1500)}});SpecialEnergyOfferWindow.ENERGY_AMOUNT=330,SpecialEnergyOfferWindow.ENERGY_PRICE=200,cleverapps.overrideFonts(cleverapps.styles.FONTS,{SPECIALENERGYOFFER_TITLE_TEXT:{size:70,color:cleverapps.styles.COLORS.LIGHT_TEXT_COLOR,stroke:cleverapps.styles.DECORATORS.LIGHT_TEXT_STROKE,shadow:cleverapps.styles.DECORATORS.LIGHT_TEXT_SHADOW},SPECIALENERGYOFFER_AMOUNT_TEXT:{size:50,color:cleverapps.styles.COLORS.LIGHT_TEXT_COLOR,stroke:cleverapps.styles.DECORATORS.LIGHT_TEXT_STROKE,shadow:cleverapps.styles.DECORATORS.LIGHT_TEXT_SHADOW},SPECIALENERGYOFFER_BUTTON_TEXT:{size:60,color:cleverapps.styles.COLORS.LIGHT_TEXT_COLOR,stroke:cleverapps.styles.DECORATORS.LIGHT_TEXT_STROKE,
shadow:cleverapps.styles.DECORATORS.LIGHT_TEXT_SHADOW}}),cleverapps.styles.SpecialEnergyOfferWindow={width:1200,height:1200,animation:{x:{align:"center"},y:{align:"center"}},title:{x:{align:"center"},y:{align:"center",dy:350}},target:{x:{align:"center"},y:{align:"center"}},amount:{x:{align:"center"},y:{align:"center",dy:-50}},button:{x:{align:"center"},y:{align:"center",dy:-200},width:300,height:100},person:{position:[{x:{align:"center",dx:-540},y:{align:"bottom",dy:-30}},{x:{align:"center",dx:-540},y:{align:"bottom",dy:-30}},{x:{align:"left",dx:280},y:{align:"bottom",dy:-30}}]}},function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(function(){try{return require("moment")}catch(e){}}()):"function"==typeof define&&define.amd?define(["require"],function(e){return t(function(){try{return e("moment")}catch(e){}}())}):(e=e||self).Chart=t(e.moment)}(this,function(s){"use strict";s=s&&s.hasOwnProperty("default")?s.default:s;var e,p={aliceblue:[240,248,255],
antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],
firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,
205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135
,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},l=(function(e){var l={};for(var t in p)p.hasOwnProperty(t)&&(l[p[t]]=t);var r=e.exports={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}};for(var n in r)if(
r.hasOwnProperty(n)){if(!("channels"in r[n]))throw new Error("missing channels property: "+n);if(!("labels"in r[n]))throw new Error("missing channel labels property: "+n);if(r[n].labels.length!==r[n].channels)throw new Error("channel and label counts mismatch: "+n);var s=r[n].channels,i=r[n].labels;delete r[n].channels,delete r[n].labels,Object.defineProperty(r[n],"channels",{value:s}),Object.defineProperty(r[n],"labels",{value:i})}r.rgb.hsl=function(e){var t,n,s=e[0]/255,i=e[1]/255,o=e[2]/255,r=Math.min(s,i,o),a=Math.max(s,i,o),c=a-r;return a===r?t=0:s===a?t=(i-o)/c:i===a?t=2+(o-s)/c:o===a&&(t=4+(s-i)/c),(t=Math.min(60*t,360))<0&&(t+=360),n=(r+a)/2,[t,100*(a===r?0:n<=.5?c/(a+r):c/(2-a-r)),100*n]},r.rgb.hsv=function(e){var t,n,s,i,o,r=e[0]/255,a=e[1]/255,c=e[2]/255,l=Math.max(r,a,c),p=l-Math.min(r,a,c),d=function(e){return(l-e)/6/p+.5};return 0===p?i=o=0:(o=p/l,t=d(r),n=d(a),s=d(c),r===l?i=s-n:a===l?i=1/3+t-s:c===l&&(i=2/3+n-t),i<0?i+=1:1<i&&(i-=1)),[360*i,100*o,100*l]},
r.rgb.hwb=function(e){var t=e[0],n=e[1],s=e[2];return[r.rgb.hsl(e)[0],1/255*Math.min(t,Math.min(n,s))*100,100*(s=1-1/255*Math.max(t,Math.max(n,s)))]},r.rgb.cmyk=function(e){var t,n=e[0]/255,s=e[1]/255,i=e[2]/255;return[100*((1-n-(t=Math.min(1-n,1-s,1-i)))/(1-t)||0),100*((1-s-t)/(1-t)||0),100*((1-i-t)/(1-t)||0),100*t]},r.rgb.keyword=function(e){var t=l[e];if(t)return t;var n,s,i,o=1/0;for(var r in p)if(p.hasOwnProperty(r)){var a=p[r],c=(s=e,i=a,Math.pow(s[0]-i[0],2)+Math.pow(s[1]-i[1],2)+Math.pow(s[2]-i[2],2));c<o&&(o=c,n=r)}return n},r.keyword.rgb=function(e){return p[e]},r.rgb.xyz=function(e){var t=e[0]/255,n=e[1]/255,s=e[2]/255;return[100*(.4124*(t=.04045<t?Math.pow((t+.055)/1.055,2.4):t/12.92)+.3576*(n=.04045<n?Math.pow((n+.055)/1.055,2.4):n/12.92)+.1805*(s=.04045<s?Math.pow((s+.055)/1.055,2.4):s/12.92)),100*(.2126*t+.7152*n+.0722*s),100*(.0193*t+.1192*n+.9505*s)]},r.rgb.lab=function(e){var t=r.rgb.xyz(e),n=t[0],s=t[1],i=t[2];return s/=100,i/=108.883,n=.008856<(n/=95.047)?Math.pow(n
,1/3):7.787*n+16/116,[116*(s=.008856<s?Math.pow(s,1/3):7.787*s+16/116)-16,500*(n-s),200*(s-(i=.008856<i?Math.pow(i,1/3):7.787*i+16/116))]},r.hsl.rgb=function(e){var t,n,s,i,o,r=e[0]/360,a=e[1]/100,c=e[2]/100;if(0===a)return[o=255*c,o,o];t=2*c-(n=c<.5?c*(1+a):c+a-c*a),i=[0,0,0];for(var l=0;l<3;l++)(s=r+1/3*-(l-1))<0&&s++,1<s&&s--,o=6*s<1?t+6*(n-t)*s:2*s<1?n:3*s<2?t+(n-t)*(2/3-s)*6:t,i[l]=255*o;return i},r.hsl.hsv=function(e){var t=e[0],n=e[1]/100,s=e[2]/100,i=n,o=Math.max(s,.01);return n*=(s*=2)<=1?s:2-s,i*=o<=1?o:2-o,[t,100*(0===s?2*i/(o+i):2*n/(s+n)),(s+n)/2*100]},r.hsv.rgb=function(e){var t=e[0]/60,n=e[1]/100,s=e[2]/100,i=Math.floor(t)%6,o=t-Math.floor(t),r=255*s*(1-n),a=255*s*(1-n*o),c=255*s*(1-n*(1-o));switch(s*=255,i){case 0:return[s,c,r];case 1:return[a,s,r];case 2:return[r,s,c];case 3:return[r,a,s];case 4:return[c,r,s];case 5:return[s,r,a]}},r.hsv.hsl=function(e){var t,n,s,i=e[0],o=e[1]/100,r=e[2]/100,a=Math.max(r,.01);return s=(2-o)*r,n=o*a,[i,100*(n=(n/=(t=(2-o)*a)<=1?t:2-t
)||0),100*(s/=2)]},r.hwb.rgb=function(e){var t,n,s,i,o,r,a,c=e[0]/360,l=e[1]/100,p=e[2]/100,d=l+p;switch(1<d&&(l/=d,p/=d),s=6*c-(t=Math.floor(6*c)),0!=(1&t)&&(s=1-s),i=l+s*((n=1-p)-l),t){default:case 6:case 0:o=n,r=i,a=l;break;case 1:o=i,r=n,a=l;break;case 2:o=l,r=n,a=i;break;case 3:o=l,r=i,a=n;break;case 4:o=i,r=l,a=n;break;case 5:o=n,r=l,a=i}return[255*o,255*r,255*a]},r.cmyk.rgb=function(e){var t=e[0]/100,n=e[1]/100,s=e[2]/100,i=e[3]/100;return[255*(1-Math.min(1,t*(1-i)+i)),255*(1-Math.min(1,n*(1-i)+i)),255*(1-Math.min(1,s*(1-i)+i))]},r.xyz.rgb=function(e){var t,n,s,i=e[0]/100,o=e[1]/100,r=e[2]/100;return n=-.9689*i+1.8758*o+.0415*r,s=.0557*i+-.204*o+1.057*r,t=.0031308<(t=3.2406*i+-1.5372*o+-.4986*r)?1.055*Math.pow(t,1/2.4)-.055:12.92*t,n=.0031308<n?1.055*Math.pow(n,1/2.4)-.055:12.92*n,s=.0031308<s?1.055*Math.pow(s,1/2.4)-.055:12.92*s,[255*(t=Math.min(Math.max(0,t),1)),255*(n=Math.min(Math.max(0,n),1)),255*(s=Math.min(Math.max(0,s),1))]},r.xyz.lab=function(e){var t=e[0],n=e[1],s=e[2]
;return n/=100,s/=108.883,t=.008856<(t/=95.047)?Math.pow(t,1/3):7.787*t+16/116,[116*(n=.008856<n?Math.pow(n,1/3):7.787*n+16/116)-16,500*(t-n),200*(n-(s=.008856<s?Math.pow(s,1/3):7.787*s+16/116))]},r.lab.xyz=function(e){var t,n,s,i=e[0];t=e[1]/500+(n=(i+16)/116),s=n-e[2]/200;var o=Math.pow(n,3),r=Math.pow(t,3),a=Math.pow(s,3);return n=.008856<o?o:(n-16/116)/7.787,t=.008856<r?r:(t-16/116)/7.787,s=.008856<a?a:(s-16/116)/7.787,[t*=95.047,n*=100,s*=108.883]},r.lab.lch=function(e){var t,n=e[0],s=e[1],i=e[2];return(t=360*Math.atan2(i,s)/2/Math.PI)<0&&(t+=360),[n,Math.sqrt(s*s+i*i),t]},r.lch.lab=function(e){var t,n=e[0],s=e[1];return t=e[2]/360*2*Math.PI,[n,s*Math.cos(t),s*Math.sin(t)]},r.rgb.ansi16=function(e){var t=e[0],n=e[1],s=e[2],i=1 in arguments?arguments[1]:r.rgb.hsv(e)[2];if(0===(i=Math.round(i/50)))return 30;var o=30+(Math.round(s/255)<<2|Math.round(n/255)<<1|Math.round(t/255));return 2===i&&(o+=60),o},r.hsv.ansi16=function(e){return r.rgb.ansi16(r.hsv.rgb(e),e[2])},
r.rgb.ansi256=function(e){var t=e[0],n=e[1],s=e[2];return t===n&&n===s?t<8?16:248<t?231:Math.round((t-8)/247*24)+232:16+36*Math.round(t/255*5)+6*Math.round(n/255*5)+Math.round(s/255*5)},r.ansi16.rgb=function(e){var t=e%10;if(0===t||7===t)return 50<e&&(t+=3.5),[t=t/10.5*255,t,t];var n=.5*(1+~~(50<e));return[(1&t)*n*255,(t>>1&1)*n*255,(t>>2&1)*n*255]},r.ansi256.rgb=function(e){if(232<=e){var t=10*(e-232)+8;return[t,t,t]}var n;return e-=16,[Math.floor(e/36)/5*255,Math.floor((n=e%36)/6)/5*255,n%6/5*255]},r.rgb.hex=function(e){var t=(((255&Math.round(e[0]))<<16)+((255&Math.round(e[1]))<<8)+(255&Math.round(e[2]))).toString(16).toUpperCase();return"000000".substring(t.length)+t},r.hex.rgb=function(e){var t=e.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!t)return[0,0,0];var n=t[0];3===t[0].length&&(n=n.split("").map(function(e){return e+e}).join(""));var s=parseInt(n,16);return[s>>16&255,s>>8&255,255&s]},r.rgb.hcg=function(e){var t,n=e[0]/255,s=e[1]/255,i=e[2]/255,o=Math.max(Math.max(n,s)
,i),r=Math.min(Math.min(n,s),i),a=o-r;return t=a<=0?0:o===n?(s-i)/a%6:o===s?2+(i-n)/a:4+(n-s)/a+4,t/=6,[360*(t%=1),100*a,100*(a<1?r/(1-a):0)]},r.hsl.hcg=function(e){var t=e[1]/100,n=e[2]/100,s=1,i=0;return(s=n<.5?2*t*n:2*t*(1-n))<1&&(i=(n-.5*s)/(1-s)),[e[0],100*s,100*i]},r.hsv.hcg=function(e){var t=e[1]/100,n=e[2]/100,s=t*n,i=0;return s<1&&(i=(n-s)/(1-s)),[e[0],100*s,100*i]},r.hcg.rgb=function(e){var t=e[0]/360,n=e[1]/100,s=e[2]/100;if(0===n)return[255*s,255*s,255*s];var i,o=[0,0,0],r=t%1*6,a=r%1,c=1-a;switch(Math.floor(r)){case 0:o[0]=1,o[1]=a,o[2]=0;break;case 1:o[0]=c,o[1]=1,o[2]=0;break;case 2:o[0]=0,o[1]=1,o[2]=a;break;case 3:o[0]=0,o[1]=c,o[2]=1;break;case 4:o[0]=a,o[1]=0,o[2]=1;break;default:o[0]=1,o[1]=0,o[2]=c}return i=(1-n)*s,[255*(n*o[0]+i),255*(n*o[1]+i),255*(n*o[2]+i)]},r.hcg.hsv=function(e){var t=e[1]/100,n=t+e[2]/100*(1-t),s=0;return 0<n&&(s=t/n),[e[0],100*s,100*n]},r.hcg.hsl=function(e){var t=e[1]/100,n=e[2]/100*(1-t)+.5*t,s=0;return 0<n&&n<.5?s=t/(2*n):.5<=n&&n<1&&(
s=t/(2*(1-n))),[e[0],100*s,100*n]},r.hcg.hwb=function(e){var t=e[1]/100,n=t+e[2]/100*(1-t);return[e[0],100*(n-t),100*(1-n)]},r.hwb.hcg=function(e){var t=e[1]/100,n=1-e[2]/100,s=n-t,i=0;return s<1&&(i=(n-s)/(1-s)),[e[0],100*s,100*i]},r.apple.rgb=function(e){return[e[0]/65535*255,e[1]/65535*255,e[2]/65535*255]},r.rgb.apple=function(e){return[e[0]/255*65535,e[1]/255*65535,e[2]/255*65535]},r.gray.rgb=function(e){return[e[0]/100*255,e[0]/100*255,e[0]/100*255]},r.gray.hsl=r.gray.hsv=function(e){return[0,0,e[0]]},r.gray.hwb=function(e){return[0,100,e[0]]},r.gray.cmyk=function(e){return[0,0,0,e[0]]},r.gray.lab=function(e){return[e[0],0,0]},r.gray.hex=function(e){var t=255&Math.round(e[0]/100*255),n=((t<<16)+(t<<8)+t).toString(16).toUpperCase();return"000000".substring(n.length)+n},r.rgb.gray=function(e){return[(e[0]+e[1]+e[2])/3/255*100]}}(e={exports:{}}),e.exports);function o(t,n){return function(e){return n(t(e))}}function c(e,t){for(var n=[t[e].parent,e],s=l[t[e].parent][e],
i=t[e].parent;t[i].parent;)n.unshift(t[i].parent),s=o(l[t[i].parent][i],s),i=t[i].parent;return s.conversion=n,s}l.rgb,l.hsl,l.hsv,l.hwb,l.cmyk,l.xyz,l.lab,l.lch,l.hex,l.keyword,l.ansi16,l.ansi256,l.hcg,l.apple,l.gray;var d={};Object.keys(l).forEach(function(a){d[a]={},Object.defineProperty(d[a],"channels",{value:l[a].channels}),Object.defineProperty(d[a],"labels",{value:l[a].labels});var r=function(e){for(var t=function(e){var t=function(){for(var e={},t=Object.keys(l),n=t.length,s=0;s<n;s++)e[t[s]]={distance:-1,parent:null};return e}(),n=[e];for(t[e].distance=0;n.length;)for(var s=n.pop(),i=Object.keys(l[s]),o=i.length,r=0;r<o;r++){var a=i[r],c=t[a];-1===c.distance&&(c.distance=t[s].distance+1,c.parent=s,n.unshift(a))}return t}(a),n={},s=Object.keys(t),i=s.length,o=0;o<i;o++){var r=s[o];null!==t[r].parent&&(n[r]=c(r,t))}return n}();Object.keys(r).forEach(function(e){var t,n,i,s,o=r[e];d[a][e]=(s=function(e){if(null==e)return e;1<arguments.length&&(e=Array.prototype.slice.call(
arguments));var t=i(e);if("object"==typeof t)for(var n=t.length,s=0;s<n;s++)t[s]=Math.round(t[s]);return t},"conversion"in(i=o)&&(s.conversion=i.conversion),s),d[a][e].raw=(n=function(e){return null==e?e:(1<arguments.length&&(e=Array.prototype.slice.call(arguments)),t(e))},"conversion"in(t=o)&&(n.conversion=t.conversion),n)})});var u=d,r={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,
47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144
],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218
,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},n={getRgba:i,getHsla:a,getRgb:function(e){var t=i(e);return t&&t.slice(0,3)},getHsl:function(e){var t=a(e);return t&&t.slice(0,3)},getHwb:h,getAlpha:function(e){var t=i(e);return t?t[3]:(t=a(e))?t[3]:(t=h(e))?t[3]:void 0},hexString:function(e,t){
return t=void 0!==t&&3===e.length?t:e[3],"#"+_(e[0])+_(e[1])+_(e[2])+(0<=t&&t<1?_(Math.round(255*t)):"")},rgbString:function(e,t){return t<1||e[3]&&e[3]<1?g(e,t):"rgb("+e[0]+", "+e[1]+", "+e[2]+")"},rgbaString:g,percentString:function(e,t){return t<1||e[3]&&e[3]<1?v(e,t):"rgb("+Math.round(e[0]/255*100)+"%, "+Math.round(e[1]/255*100)+"%, "+Math.round(e[2]/255*100)+"%)"},percentaString:v,hslString:function(e,t){return t<1||e[3]&&e[3]<1?m(e,t):"hsl("+e[0]+", "+e[1]+"%, "+e[2]+"%)"},hslaString:m,hwbString:function(e,t){return void 0===t&&(t=void 0!==e[3]?e[3]:1),"hwb("+e[0]+", "+e[1]+"%, "+e[2]+"%"+(void 0!==t&&1!==t?", "+t:"")+")"},keyword:function(e){return t[e.slice(0,3)]}};function i(e){if(e){var t=[0,0,0],n=1,s=e.match(/^#([a-fA-F0-9]{3,4})$/i),i="";if(s){i=(s=s[1])[3];for(var o=0;o<t.length;o++)t[o]=parseInt(s[o]+s[o],16);i&&(n=Math.round(parseInt(i+i,16)/255*100)/100)}else if(s=e.match(/^#([a-fA-F0-9]{6}([a-fA-F0-9]{2})?)$/i)){for(i=s[2],s=s[1],o=0;o<t.length;o++)t[o]=parseInt(
s.slice(2*o,2*o+2),16);i&&(n=Math.round(parseInt(i,16)/255*100)/100)}else if(s=e.match(/^rgba?\(\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/i)){for(o=0;o<t.length;o++)t[o]=parseInt(s[o+1]);n=parseFloat(s[4])}else if(s=e.match(/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,\s*([+-]?[\d\.]+)\%\s*,\s*([+-]?[\d\.]+)\%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/i)){for(o=0;o<t.length;o++)t[o]=Math.round(2.55*parseFloat(s[o+1]));n=parseFloat(s[4])}else if(s=e.match(/(\w+)/)){if("transparent"==s[1])return[0,0,0,0];if(!(t=r[s[1]]))return}for(o=0;o<t.length;o++)t[o]=f(t[o],0,255);return n=n||0==n?f(n,0,1):1,t[3]=n,t}}function a(e){if(e){var t=e.match(/^hsla?\(\s*([+-]?\d+)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)/);if(t){var n=parseFloat(t[4]);return[f(parseInt(t[1]),0,360),f(parseFloat(t[2]),0,100),f(parseFloat(t[3]),0,100),f(isNaN(n)?1:n,0,1)]}}}function h(e){if(e){var t=e.match(
/^hwb\(\s*([+-]?\d+)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)/);if(t){var n=parseFloat(t[4]);return[f(parseInt(t[1]),0,360),f(parseFloat(t[2]),0,100),f(parseFloat(t[3]),0,100),f(isNaN(n)?1:n,0,1)]}}}function g(e,t){return void 0===t&&(t=void 0!==e[3]?e[3]:1),"rgba("+e[0]+", "+e[1]+", "+e[2]+", "+t+")"}function v(e,t){return"rgba("+Math.round(e[0]/255*100)+"%, "+Math.round(e[1]/255*100)+"%, "+Math.round(e[2]/255*100)+"%, "+(t||e[3]||1)+")"}function m(e,t){return void 0===t&&(t=void 0!==e[3]?e[3]:1),"hsla("+e[0]+", "+e[1]+"%, "+e[2]+"%, "+t+")"}function f(e,t,n){return Math.min(Math.max(t,e),n)}function _(e){var t=e.toString(16).toUpperCase();return t.length<2?"0"+t:t}var t={};for(var y in r)t[r[y]]=y;var w=function(e){return e instanceof w?e:this instanceof w?(this.valid=!1,this.values={rgb:[0,0,0],hsl:[0,0,0],hsv:[0,0,0],hwb:[0,0,0],cmyk:[0,0,0,0],alpha:1},void("string"==typeof e?(t=n.getRgba(e))?this.setValues("rgb",t):(t=n.getHsla(e)
)?this.setValues("hsl",t):(t=n.getHwb(e))&&this.setValues("hwb",t):"object"==typeof e&&(void 0!==(t=e).r||void 0!==t.red?this.setValues("rgb",t):void 0!==t.l||void 0!==t.lightness?this.setValues("hsl",t):void 0!==t.v||void 0!==t.value?this.setValues("hsv",t):void 0!==t.w||void 0!==t.whiteness?this.setValues("hwb",t):void 0===t.c&&void 0===t.cyan||this.setValues("cmyk",t)))):new w(e);var t};w.prototype={isValid:function(){return this.valid},rgb:function(){return this.setSpace("rgb",arguments)},hsl:function(){return this.setSpace("hsl",arguments)},hsv:function(){return this.setSpace("hsv",arguments)},hwb:function(){return this.setSpace("hwb",arguments)},cmyk:function(){return this.setSpace("cmyk",arguments)},rgbArray:function(){return this.values.rgb},hslArray:function(){return this.values.hsl},hsvArray:function(){return this.values.hsv},hwbArray:function(){var e=this.values;return 1!==e.alpha?e.hwb.concat([e.alpha]):e.hwb},cmykArray:function(){return this.values.cmyk},
rgbaArray:function(){var e=this.values;return e.rgb.concat([e.alpha])},hslaArray:function(){var e=this.values;return e.hsl.concat([e.alpha])},alpha:function(e){return void 0===e?this.values.alpha:(this.setValues("alpha",e),this)},red:function(e){return this.setChannel("rgb",0,e)},green:function(e){return this.setChannel("rgb",1,e)},blue:function(e){return this.setChannel("rgb",2,e)},hue:function(e){return e&&(e=(e%=360)<0?360+e:e),this.setChannel("hsl",0,e)},saturation:function(e){return this.setChannel("hsl",1,e)},lightness:function(e){return this.setChannel("hsl",2,e)},saturationv:function(e){return this.setChannel("hsv",1,e)},whiteness:function(e){return this.setChannel("hwb",1,e)},blackness:function(e){return this.setChannel("hwb",2,e)},value:function(e){return this.setChannel("hsv",2,e)},cyan:function(e){return this.setChannel("cmyk",0,e)},magenta:function(e){return this.setChannel("cmyk",1,e)},yellow:function(e){return this.setChannel("cmyk",2,e)},black:function(e){
return this.setChannel("cmyk",3,e)},hexString:function(){return n.hexString(this.values.rgb)},rgbString:function(){return n.rgbString(this.values.rgb,this.values.alpha)},rgbaString:function(){return n.rgbaString(this.values.rgb,this.values.alpha)},percentString:function(){return n.percentString(this.values.rgb,this.values.alpha)},hslString:function(){return n.hslString(this.values.hsl,this.values.alpha)},hslaString:function(){return n.hslaString(this.values.hsl,this.values.alpha)},hwbString:function(){return n.hwbString(this.values.hwb,this.values.alpha)},keyword:function(){return n.keyword(this.values.rgb,this.values.alpha)},rgbNumber:function(){var e=this.values.rgb;return e[0]<<16|e[1]<<8|e[2]},luminosity:function(){for(var e=this.values.rgb,t=[],n=0;n<e.length;n++){var s=e[n]/255;t[n]=s<=.03928?s/12.92:Math.pow((s+.055)/1.055,2.4)}return.2126*t[0]+.7152*t[1]+.0722*t[2]},contrast:function(e){var t=this.luminosity(),n=e.luminosity();return n<t?(t+.05)/(n+.05):(n+.05)/(t+.05)},
level:function(e){var t=this.contrast(e);return 7.1<=t?"AAA":4.5<=t?"AA":""},dark:function(){var e=this.values.rgb;return(299*e[0]+587*e[1]+114*e[2])/1e3<128},light:function(){return!this.dark()},negate:function(){for(var e=[],t=0;t<3;t++)e[t]=255-this.values.rgb[t];return this.setValues("rgb",e),this},lighten:function(e){var t=this.values.hsl;return t[2]+=t[2]*e,this.setValues("hsl",t),this},darken:function(e){var t=this.values.hsl;return t[2]-=t[2]*e,this.setValues("hsl",t),this},saturate:function(e){var t=this.values.hsl;return t[1]+=t[1]*e,this.setValues("hsl",t),this},desaturate:function(e){var t=this.values.hsl;return t[1]-=t[1]*e,this.setValues("hsl",t),this},whiten:function(e){var t=this.values.hwb;return t[1]+=t[1]*e,this.setValues("hwb",t),this},blacken:function(e){var t=this.values.hwb;return t[2]+=t[2]*e,this.setValues("hwb",t),this},greyscale:function(){var e=this.values.rgb,t=.3*e[0]+.59*e[1]+.11*e[2];return this.setValues("rgb",[t,t,t]),this},clearer:function(e){
var t=this.values.alpha;return this.setValues("alpha",t-t*e),this},opaquer:function(e){var t=this.values.alpha;return this.setValues("alpha",t+t*e),this},rotate:function(e){var t=this.values.hsl,n=(t[0]+e)%360;return t[0]=n<0?360+n:n,this.setValues("hsl",t),this},mix:function(e,t){var n=e,s=void 0===t?.5:t,i=2*s-1,o=this.alpha()-n.alpha(),r=((i*o==-1?i:(i+o)/(1+i*o))+1)/2,a=1-r;return this.rgb(r*this.red()+a*n.red(),r*this.green()+a*n.green(),r*this.blue()+a*n.blue()).alpha(this.alpha()*s+n.alpha()*(1-s))},toJSON:function(){return this.rgb()},clone:function(){var e,t,n=new w,s=this.values,i=n.values;for(var o in s)s.hasOwnProperty(o)&&(e=s[o],"[object Array]"===(t={}.toString.call(e))?i[o]=e.slice(0):"[object Number]"===t?i[o]=e:console.error("unexpected color value:",e));return n}},w.prototype.spaces={rgb:["red","green","blue"],hsl:["hue","saturation","lightness"],hsv:["hue","saturation","value"],hwb:["hue","whiteness","blackness"],cmyk:["cyan","magenta","yellow","black"]},
w.prototype.maxes={rgb:[255,255,255],hsl:[360,100,100],hsv:[360,100,100],hwb:[360,100,100],cmyk:[100,100,100,100]},w.prototype.getValues=function(e){for(var t=this.values,n={},s=0;s<e.length;s++)n[e.charAt(s)]=t[e][s];return 1!==t.alpha&&(n.a=t.alpha),n},w.prototype.setValues=function(e,t){var n,s,i=this.values,o=this.spaces,r=this.maxes,a=1;if(this.valid=!0,"alpha"===e)a=t;else if(t.length)i[e]=t.slice(0,e.length),a=t[e.length];else if(void 0!==t[e.charAt(0)]){for(n=0;n<e.length;n++)i[e][n]=t[e.charAt(n)];a=t.a}else if(void 0!==t[o[e][0]]){var c=o[e];for(n=0;n<e.length;n++)i[e][n]=t[c[n]];a=t.alpha}if(i.alpha=Math.max(0,Math.min(1,void 0===a?i.alpha:a)),"alpha"===e)return!1;for(n=0;n<e.length;n++)s=Math.max(0,Math.min(r[e][n],i[e][n])),i[e][n]=Math.round(s);for(var l in o)l!==e&&(i[l]=u[e][l](i[e]));return!0},w.prototype.setSpace=function(e,t){var n=t[0];return void 0===n?this.getValues(e):("number"==typeof n&&(n=Array.prototype.slice.call(t)),this.setValues(e,n),this)},
w.prototype.setChannel=function(e,t,n){var s=this.values[e];return void 0===n?s[t]:(n===s[t]||(s[t]=n,this.setValues(e,s)),this)},"undefined"!=typeof window&&(window.Color=w);var b,T=w,S={noop:function(){},uid:(b=0,function(){return b++}),isNullOrUndef:function(e){return null==e},isArray:function(e){if(Array.isArray&&Array.isArray(e))return!0;var t=Object.prototype.toString.call(e);return"[object"===t.substr(0,7)&&"Array]"===t.substr(-6)},isObject:function(e){return null!==e&&"[object Object]"===Object.prototype.toString.call(e)},isFinite:function(e){return("number"==typeof e||e instanceof Number)&&isFinite(e)},valueOrDefault:function(e,t){return void 0===e?t:e},valueAtIndexOrDefault:function(e,t,n){return S.valueOrDefault(S.isArray(e)?e[t]:e,n)},callback:function(e,t,n){if(e&&"function"==typeof e.call)return e.apply(n,t)},each:function(e,t,n,s){var i,o,r;if(S.isArray(e))if(o=e.length,s)for(i=o-1;0<=i;i--)t.call(n,e[i],i);else for(i=0;i<o;i++)t.call(n,e[i],i);else if(S.isObject(e))for(
o=(r=Object.keys(e)).length,i=0;i<o;i++)t.call(n,e[r[i]],r[i])},arrayEquals:function(e,t){var n,s,i,o;if(!e||!t||e.length!==t.length)return!1;for(n=0,s=e.length;n<s;++n)if(i=e[n],o=t[n],i instanceof Array&&o instanceof Array){if(!S.arrayEquals(i,o))return!1}else if(i!==o)return!1;return!0},clone:function(e){if(S.isArray(e))return e.map(S.clone);if(S.isObject(e)){for(var t={},n=Object.keys(e),s=n.length,i=0;i<s;++i)t[n[i]]=S.clone(e[n[i]]);return t}return e},_merger:function(e,t,n,s){var i=t[e],o=n[e];S.isObject(i)&&S.isObject(o)?S.merge(i,o,s):t[e]=S.clone(o)},_mergerIf:function(e,t,n){var s=t[e],i=n[e];S.isObject(s)&&S.isObject(i)?S.mergeIf(s,i):t.hasOwnProperty(e)||(t[e]=S.clone(i))},merge:function(e,t,n){var s,i,o,r,a,c=S.isArray(t)?t:[t],l=c.length;if(!S.isObject(e))return e;for(s=(n=n||{}).merger||S._merger,i=0;i<l;++i)if(t=c[i],S.isObject(t))for(a=0,r=(o=Object.keys(t)).length;a<r;++a)s(o[a],e,t,n);return e},mergeIf:function(e,t){return S.merge(e,t,{merger:S._mergerIf})},
extend:Object.assign||function(e){return S.merge(e,[].slice.call(arguments,1),{merger:function(e,t,n){t[e]=n[e]}})},inherits:function(e){var t=this,n=e&&e.hasOwnProperty("constructor")?e.constructor:function(){return t.apply(this,arguments)},s=function(){this.constructor=n};return s.prototype=t.prototype,n.prototype=new s,n.extend=S.inherits,e&&S.extend(n.prototype,e),n.__super__=t.prototype,n},_deprecated:function(e,t,n,s){void 0!==t&&console.warn(e+': "'+n+'" is deprecated. Please use "'+s+'" instead')}},E=S;S.callCallback=S.callback,S.indexOf=function(e,t,n){return Array.prototype.indexOf.call(e,t,n)},S.getValueOrDefault=S.valueOrDefault,S.getValueAtIndexOrDefault=S.valueAtIndexOrDefault;var C={linear:function(e){return e},easeInQuad:function(e){return e*e},easeOutQuad:function(e){return-e*(e-2)},easeInOutQuad:function(e){return(e/=.5)<1?.5*e*e:-.5*(--e*(e-2)-1)},easeInCubic:function(e){return e*e*e},easeOutCubic:function(e){return(e-=1)*e*e+1},easeInOutCubic:function(e){return(
e/=.5)<1?.5*e*e*e:.5*((e-=2)*e*e+2)},easeInQuart:function(e){return e*e*e*e},easeOutQuart:function(e){return-((e-=1)*e*e*e-1)},easeInOutQuart:function(e){return(e/=.5)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2)},easeInQuint:function(e){return e*e*e*e*e},easeOutQuint:function(e){return(e-=1)*e*e*e*e+1},easeInOutQuint:function(e){return(e/=.5)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2)},easeInSine:function(e){return 1-Math.cos(e*(Math.PI/2))},easeOutSine:function(e){return Math.sin(e*(Math.PI/2))},easeInOutSine:function(e){return-.5*(Math.cos(Math.PI*e)-1)},easeInExpo:function(e){return 0===e?0:Math.pow(2,10*(e-1))},easeOutExpo:function(e){return 1===e?1:1-Math.pow(2,-10*e)},easeInOutExpo:function(e){return 0===e?0:1===e?1:(e/=.5)<1?.5*Math.pow(2,10*(e-1)):.5*(2-Math.pow(2,-10*--e))},easeInCirc:function(e){return 1<=e?e:-(Math.sqrt(1-e*e)-1)},easeOutCirc:function(e){return Math.sqrt(1-(e-=1)*e)},easeInOutCirc:function(e){return(e/=.5)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)},
easeInElastic:function(e){var t=1.70158,n=0,s=1;return 0===e?0:1===e?1:(n||(n=.3),s<1?(s=1,t=n/4):t=n/(2*Math.PI)*Math.asin(1/s),-s*Math.pow(2,10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/n))},easeOutElastic:function(e){var t=1.70158,n=0,s=1;return 0===e?0:1===e?1:(n||(n=.3),s<1?(s=1,t=n/4):t=n/(2*Math.PI)*Math.asin(1/s),s*Math.pow(2,-10*e)*Math.sin((e-t)*(2*Math.PI)/n)+1)},easeInOutElastic:function(e){var t=1.70158,n=0,s=1;return 0===e?0:2==(e/=.5)?1:(n||(n=.45),s<1?(s=1,t=n/4):t=n/(2*Math.PI)*Math.asin(1/s),e<1?s*Math.pow(2,10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/n)*-.5:s*Math.pow(2,-10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/n)*.5+1)},easeInBack:function(e){return e*e*(2.70158*e-1.70158)},easeOutBack:function(e){return(e-=1)*e*(2.70158*e+1.70158)+1},easeInOutBack:function(e){var t=1.70158;return(e/=.5)<1?e*e*((1+(t*=1.525))*e-t)*.5:.5*((e-=2)*e*((1+(t*=1.525))*e+t)+2)},easeInBounce:function(e){return 1-C.easeOutBounce(1-e)},easeOutBounce:function(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(
e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},easeInOutBounce:function(e){return e<.5?.5*C.easeInBounce(2*e):.5*C.easeOutBounce(2*e-1)+.5}},A={effects:C};E.easingEffects=C;var I=Math.PI,R=I/180,L=2*I,O=I/2,P=I/4,x=2*I/3,k={clear:function(e){e.ctx.clearRect(0,0,e.width,e.height)},roundedRect:function(e,t,n,s,i,o){if(o){var r=Math.min(o,i/2,s/2),a=t+r,c=n+r,l=t+s-r,p=n+i-r;e.moveTo(t,c),a<l&&c<p?(e.arc(a,c,r,-I,-O),e.arc(l,c,r,-O,0),e.arc(l,p,r,0,O),e.arc(a,p,r,O,I)):a<l?(e.moveTo(a,n),e.arc(l,c,r,-O,O),e.arc(a,c,r,O,I+O)):c<p?(e.arc(a,c,r,-I,0),e.arc(a,p,r,0,I)):e.arc(a,c,r,-I,I),e.closePath(),e.moveTo(t,n)}else e.rect(t,n,s,i)},drawPoint:function(e,t,n,s,i,o){var r,a,c,l,p,d=(o||0)*R;if(t&&"object"==typeof t&&("[object HTMLImageElement]"===(r=t.toString())||"[object HTMLCanvasElement]"===r))return e.save(),e.translate(s,i),e.rotate(d),e.drawImage(t,-t.width/2,-t.height/2,t.width,t.height),void e.restore();if(!(isNaN(n)||n<=0)){switch(
e.beginPath(),t){default:e.arc(s,i,n,0,L),e.closePath();break;case"triangle":e.moveTo(s+Math.sin(d)*n,i-Math.cos(d)*n),d+=x,e.lineTo(s+Math.sin(d)*n,i-Math.cos(d)*n),d+=x,e.lineTo(s+Math.sin(d)*n,i-Math.cos(d)*n),e.closePath();break;case"rectRounded":l=n-(p=.516*n),a=Math.cos(d+P)*l,c=Math.sin(d+P)*l,e.arc(s-a,i-c,p,d-I,d-O),e.arc(s+c,i-a,p,d-O,d),e.arc(s+a,i+c,p,d,d+O),e.arc(s-c,i+a,p,d+O,d+I),e.closePath();break;case"rect":if(!o){l=Math.SQRT1_2*n,e.rect(s-l,i-l,2*l,2*l);break}d+=P;case"rectRot":a=Math.cos(d)*n,c=Math.sin(d)*n,e.moveTo(s-a,i-c),e.lineTo(s+c,i-a),e.lineTo(s+a,i+c),e.lineTo(s-c,i+a),e.closePath();break;case"crossRot":d+=P;case"cross":a=Math.cos(d)*n,c=Math.sin(d)*n,e.moveTo(s-a,i-c),e.lineTo(s+a,i+c),e.moveTo(s+c,i-a),e.lineTo(s-c,i+a);break;case"star":a=Math.cos(d)*n,c=Math.sin(d)*n,e.moveTo(s-a,i-c),e.lineTo(s+a,i+c),e.moveTo(s+c,i-a),e.lineTo(s-c,i+a),d+=P,a=Math.cos(d)*n,c=Math.sin(d)*n,e.moveTo(s-a,i-c),e.lineTo(s+a,i+c),e.moveTo(s+c,i-a),e.lineTo(s-c,i+a);break
;case"line":a=Math.cos(d)*n,c=Math.sin(d)*n,e.moveTo(s-a,i-c),e.lineTo(s+a,i+c);break;case"dash":e.moveTo(s,i),e.lineTo(s+Math.cos(d)*n,i+Math.sin(d)*n)}e.fill(),e.stroke()}},_isPointInArea:function(e,t){return e.x>t.left-1e-6&&e.x<t.right+1e-6&&e.y>t.top-1e-6&&e.y<t.bottom+1e-6},clipArea:function(e,t){e.save(),e.beginPath(),e.rect(t.left,t.top,t.right-t.left,t.bottom-t.top),e.clip()},unclipArea:function(e){e.restore()},lineTo:function(e,t,n,s){var i=n.steppedLine;if(i){if("middle"===i){var o=(t.x+n.x)/2;e.lineTo(o,s?n.y:t.y),e.lineTo(o,s?t.y:n.y)}else"after"===i&&!s||"after"!==i&&s?e.lineTo(t.x,n.y):e.lineTo(n.x,t.y);e.lineTo(n.x,n.y)}else n.tension?e.bezierCurveTo(s?t.controlPointPreviousX:t.controlPointNextX,s?t.controlPointPreviousY:t.controlPointNextY,s?n.controlPointNextX:n.controlPointPreviousX,s?n.controlPointNextY:n.controlPointPreviousY,n.x,n.y):e.lineTo(n.x,n.y)}},M=k;E.clear=k.clear,E.drawRoundedRectangle=function(e){e.beginPath(),k.roundedRect.apply(k,arguments)};var N={
_set:function(e,t){return E.merge(this[e]||(this[e]={}),t)}};N._set("global",{defaultColor:"rgba(0,0,0,0.1)",defaultFontColor:"#666",defaultFontFamily:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",defaultFontSize:12,defaultFontStyle:"normal",defaultLineHeight:1.2,showLines:!0});var B=N,D=E.valueOrDefault,F={toLineHeight:function(e,t){var n=(""+e).match(/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/);if(!n||"normal"===n[1])return 1.2*t;switch(e=+n[2],n[3]){case"px":return e;case"%":e/=100}return t*e},toPadding:function(e){var t,n,s,i;return E.isObject(e)?(t=+e.top||0,n=+e.right||0,s=+e.bottom||0,i=+e.left||0):t=n=s=i=+e||0,{top:t,right:n,bottom:s,left:i,height:t+s,width:i+n}},_parseFont:function(e){var t,n=B.global,s=D(e.fontSize,n.defaultFontSize),i={family:D(e.fontFamily,n.defaultFontFamily),lineHeight:E.options.toLineHeight(D(e.lineHeight,n.defaultLineHeight),s),size:s,style:D(e.fontStyle,n.defaultFontStyle),weight:null,string:""};return i.string=!(t=i)||E.isNullOrUndef(t.size
)||E.isNullOrUndef(t.family)?null:(t.style?t.style+" ":"")+(t.weight?t.weight+" ":"")+t.size+"px "+t.family,i},resolve:function(e,t,n,s){var i,o,r,a=!0;for(i=0,o=e.length;i<o;++i)if(void 0!==(r=e[i])&&(void 0!==t&&"function"==typeof r&&(r=r(t),a=!1),void 0!==n&&E.isArray(r)&&(r=r[n],a=!1),void 0!==r))return s&&!a&&(s.cacheable=!1),r}},U={_factorize:function(e){var t,n=[],s=Math.sqrt(e);for(t=1;t<s;t++)e%t==0&&(n.push(t),n.push(e/t));return s===(0|s)&&n.push(s),n.sort(function(e,t){return e-t}).pop(),n},log10:Math.log10||function(e){var t=Math.log(e)*Math.LOG10E,n=Math.round(t);return e===Math.pow(10,n)?n:t}},W=U;E.log10=U.log10;var V=E,G=A,H=M,j=F,z=W;V.easing=G,V.canvas=H,V.options=j,V.math=z,V.rtl={getRtlAdapter:function(e,t,n){return e?(s=t,i=n,{x:function(e){return s+s+i-e},setWidth:function(e){i=e},textAlign:function(e){return"center"===e?e:"right"===e?"left":"right"},xPlus:function(e,t){return e-t},leftForLtr:function(e,t){return e-t}}):{x:function(e){return e},setWidth:function(
e){},textAlign:function(e){return e},xPlus:function(e,t){return e+t},leftForLtr:function(e,t){return e}};var s,i},overrideTextDirection:function(e,t){var n,s;"ltr"!==t&&"rtl"!==t||(s=[(n=e.canvas.style).getPropertyValue("direction"),n.getPropertyPriority("direction")],n.setProperty("direction",t,"important"),e.prevTextDirection=s)},restoreTextDirection:function(e){var t=e.prevTextDirection;void 0!==t&&(delete e.prevTextDirection,e.canvas.style.setProperty("direction",t[0],t[1]))}};var Y=function(e){V.extend(this,e),this.initialize.apply(this,arguments)};V.extend(Y.prototype,{_type:void 0,initialize:function(){this.hidden=!1},pivot:function(){return this._view||(this._view=V.extend({},this._model)),this._start={},this},transition:function(e){var t=this._model,n=this._start,s=this._view;return t&&1!==e?(s||(s=this._view={}),n||(n=this._start={}),function(e,t,n,s){var i,o,r,a,c,l,p,d,u,h=Object.keys(n);for(i=0,o=h.length;i<o;++i)if(l=n[r=h[i]],t.hasOwnProperty(r)||(t[r]=l),(a=t[r]
)!==l&&"_"!==r[0]){if(e.hasOwnProperty(r)||(e[r]=a),(p=typeof l)==typeof(c=e[r]))if("string"===p){if((d=T(c)).valid&&(u=T(l)).valid){t[r]=u.mix(d,s).rgbString();continue}}else if(V.isFinite(c)&&V.isFinite(l)){t[r]=c+(l-c)*s;continue}t[r]=l}}(n,s,t,e)):(this._view=V.extend({},t),this._start=null),this},tooltipPosition:function(){return{x:this._model.x,y:this._model.y}},hasValue:function(){return V.isNumber(this._model.x)&&V.isNumber(this._model.y)}}),Y.extend=V.inherits;var X=Y,K=X.extend({chart:null,currentStep:0,numSteps:60,easing:"",render:null,onAnimationProgress:null,onAnimationComplete:null}),q=K;Object.defineProperty(K.prototype,"animationObject",{get:function(){return this}}),Object.defineProperty(K.prototype,"chartInstance",{get:function(){return this.chart},set:function(e){this.chart=e}}),B._set("global",{animation:{duration:1e3,easing:"easeOutQuart",onProgress:V.noop,onComplete:V.noop}});var Z={animations:[],request:null,addAnimation:function(e,t,n,s){var i,o,
r=this.animations;for(t.chart=e,t.startTime=Date.now(),t.duration=n,s||(e.animating=!0),i=0,o=r.length;i<o;++i)if(r[i].chart===e)return void(r[i]=t);r.push(t),1===r.length&&this.requestAnimationFrame()},cancelAnimation:function(t){var e=V.findIndex(this.animations,function(e){return e.chart===t});-1!==e&&(this.animations.splice(e,1),t.animating=!1)},requestAnimationFrame:function(){var e=this;null===e.request&&(e.request=V.requestAnimFrame.call(window,function(){e.request=null,e.startDigest()}))},startDigest:function(){this.advance(),0<this.animations.length&&this.requestAnimationFrame()},advance:function(){for(var e,t,n,s,i=this.animations,o=0;o<i.length;)t=(e=i[o]).chart,n=e.numSteps,s=Math.floor((Date.now()-e.startTime)/e.duration*n)+1,e.currentStep=Math.min(s,n),V.callback(e.render,[t,e],t),V.callback(e.onAnimationProgress,[e],t),e.currentStep>=n?(V.callback(e.onAnimationComplete,[e],t),t.animating=!1,i.splice(o,1)):++o}},Q=V.options.resolve,J=["push","pop","shift","splice",
"unshift"];function $(t,e){var n=t._chartjs;if(n){var s=n.listeners,i=s.indexOf(e);-1!==i&&s.splice(i,1),0<s.length||(J.forEach(function(e){delete t[e]}),delete t._chartjs)}}var ee=function(e,t){this.initialize(e,t)};V.extend(ee.prototype,{datasetElementType:null,dataElementType:null,_datasetElementOptions:["backgroundColor","borderCapStyle","borderColor","borderDash","borderDashOffset","borderJoinStyle","borderWidth"],_dataElementOptions:["backgroundColor","borderColor","borderWidth","pointStyle"],initialize:function(e,t){this.chart=e,this.index=t,this.linkScales(),this.addElements(),this._type=this.getMeta().type},updateIndex:function(e){this.index=e},linkScales:function(){var e=this.getMeta(),t=this.chart,n=t.scales,s=this.getDataset(),i=t.options.scales;null!==e.xAxisID&&e.xAxisID in n&&!s.xAxisID||(e.xAxisID=s.xAxisID||i.xAxes[0].id),null!==e.yAxisID&&e.yAxisID in n&&!s.yAxisID||(e.yAxisID=s.yAxisID||i.yAxes[0].id)},getDataset:function(){return this.chart.data.datasets[this.index]
},getMeta:function(){return this.chart.getDatasetMeta(this.index)},getScaleForId:function(e){return this.chart.scales[e]},_getValueScaleId:function(){return this.getMeta().yAxisID},_getIndexScaleId:function(){return this.getMeta().xAxisID},_getValueScale:function(){return this.getScaleForId(this._getValueScaleId())},_getIndexScale:function(){return this.getScaleForId(this._getIndexScaleId())},reset:function(){this._update(!0)},destroy:function(){this._data&&$(this._data,this)},createMetaDataset:function(){var e=this.datasetElementType;return e&&new e({_chart:this.chart,_datasetIndex:this.index})},createMetaData:function(e){var t=this.dataElementType;return t&&new t({_chart:this.chart,_datasetIndex:this.index,_index:e})},addElements:function(){var e,t,n=this.getMeta(),s=this.getDataset().data||[],i=n.data;for(e=0,t=s.length;e<t;++e)i[e]=i[e]||this.createMetaData(e);n.dataset=n.dataset||this.createMetaDataset()},addElementAndReset:function(e){var t=this.createMetaData(e);this.getMeta(
).data.splice(e,0,t),this.updateElement(t,e,!0)},buildOrUpdateElements:function(){var i,e=this.getDataset(),t=e.data||(e.data=[]);this._data!==t&&(this._data&&$(this._data,this),t&&Object.isExtensible(t)&&(this,(i=t)._chartjs?i._chartjs.listeners.push(this):(Object.defineProperty(i,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[this]}}),J.forEach(function(e){var n="onData"+e.charAt(0).toUpperCase()+e.slice(1),s=i[e];Object.defineProperty(i,e,{configurable:!0,enumerable:!1,value:function(){var t=Array.prototype.slice.call(arguments),e=s.apply(this,t);return V.each(i._chartjs.listeners,function(e){"function"==typeof e[n]&&e[n].apply(e,t)}),e}})}))),this._data=t),this.resyncElements()},_configure:function(){this._config=V.merge({},[this.chart.options.datasets[this._type],this.getDataset()],{merger:function(e,t,n){"_meta"!==e&&"data"!==e&&V._merger(e,t,n)}})},_update:function(e){this._configure(),this._cachedDataOpts=null,this.update(e)},update:V.noop,transition:function(e){
for(var t=this.getMeta(),n=t.data||[],s=n.length,i=0;i<s;++i)n[i].transition(e);t.dataset&&t.dataset.transition(e)},draw:function(){var e=this.getMeta(),t=e.data||[],n=t.length,s=0;for(e.dataset&&e.dataset.draw();s<n;++s)t[s].draw()},getStyle:function(e){var t,n=this.getMeta(),s=n.dataset;return this._configure(),s&&void 0===e?t=this._resolveDatasetElementOptions(s||{}):(e=e||0,t=this._resolveDataElementOptions(n.data[e]||{},e)),!1!==t.fill&&null!==t.fill||(t.backgroundColor=t.borderColor),t},_resolveDatasetElementOptions:function(e,t){var n,s,i,o,r=this.chart,a=this._config,c=e.custom||{},l=r.options.elements[this.datasetElementType.prototype._type]||{},p=this._datasetElementOptions,d={},u={chart:r,dataset:this.getDataset(),datasetIndex:this.index,hover:t};for(n=0,s=p.length;n<s;++n)i=p[n],o=t?"hover"+i.charAt(0).toUpperCase()+i.slice(1):i,d[i]=Q([c[o],a[o],l[o]],u);return d},_resolveDataElementOptions:function(e,t){var n=e&&e.custom,s=this._cachedDataOpts;if(s&&!n)return s;var i,o,r,
a,c=this.chart,l=this._config,p=c.options.elements[this.dataElementType.prototype._type]||{},d=this._dataElementOptions,u={},h={chart:c,dataIndex:t,dataset:this.getDataset(),datasetIndex:this.index},g={cacheable:!n};if(n=n||{},V.isArray(d))for(o=0,r=d.length;o<r;++o)u[a=d[o]]=Q([n[a],l[a],p[a]],h,t,g);else for(o=0,r=(i=Object.keys(d)).length;o<r;++o)u[a=i[o]]=Q([n[a],l[d[a]],l[a],p[a]],h,t,g);return g.cacheable&&(this._cachedDataOpts=Object.freeze(u)),u},removeHoverStyle:function(e){V.merge(e._model,e.$previousStyle||{}),delete e.$previousStyle},setHoverStyle:function(e){var t=this.chart.data.datasets[e._datasetIndex],n=e._index,s=e.custom||{},i=e._model,o=V.getHoverColor;e.$previousStyle={backgroundColor:i.backgroundColor,borderColor:i.borderColor,borderWidth:i.borderWidth},i.backgroundColor=Q([s.hoverBackgroundColor,t.hoverBackgroundColor,o(i.backgroundColor)],void 0,n),i.borderColor=Q([s.hoverBorderColor,t.hoverBorderColor,o(i.borderColor)],void 0,n),i.borderWidth=Q([
s.hoverBorderWidth,t.hoverBorderWidth,i.borderWidth],void 0,n)},_removeDatasetHoverStyle:function(){var e=this.getMeta().dataset;e&&this.removeHoverStyle(e)},_setDatasetHoverStyle:function(){var e,t,n,s,i,o,r=this.getMeta().dataset,a={};if(r){for(o=r._model,i=this._resolveDatasetElementOptions(r,!0),e=0,t=(s=Object.keys(i)).length;e<t;++e)a[n=s[e]]=o[n],o[n]=i[n];r.$previousStyle=a}},resyncElements:function(){var e=this.getMeta(),t=this.getDataset().data,n=e.data.length,s=t.length;s<n?e.data.splice(s,n-s):n<s&&this.insertElements(n,s-n)},insertElements:function(e,t){for(var n=0;n<t;++n)this.addElementAndReset(e+n)},onDataPush:function(){var e=arguments.length;this.insertElements(this.getDataset().data.length-e,e)},onDataPop:function(){this.getMeta().data.pop()},onDataShift:function(){this.getMeta().data.shift()},onDataSplice:function(e,t){this.getMeta().data.splice(e,t),this.insertElements(e,arguments.length-2)},onDataUnshift:function(){this.insertElements(0,arguments.length)}}),
ee.extend=V.inherits;var te=ee,ne=2*Math.PI;function se(e,t){var n=t.startAngle,s=t.endAngle,i=t.pixelMargin,o=i/t.outerRadius,r=t.x,a=t.y;e.beginPath(),e.arc(r,a,t.outerRadius,n-o,s+o),t.innerRadius>i?(o=i/t.innerRadius,e.arc(r,a,t.innerRadius-i,s+o,n-o,!0)):e.arc(r,a,i,s+Math.PI/2,n-Math.PI/2),e.closePath(),e.clip()}B._set("global",{elements:{arc:{backgroundColor:B.global.defaultColor,borderColor:"#fff",borderWidth:2,borderAlign:"center"}}});var ie=X.extend({_type:"arc",inLabelRange:function(e){var t=this._view;return!!t&&Math.pow(e-t.x,2)<Math.pow(t.radius+t.hoverRadius,2)},inRange:function(e,t){var n=this._view;if(n){for(var s=V.getAngleFromPoint(n,{x:e,y:t}),i=s.angle,o=s.distance,r=n.startAngle,a=n.endAngle;a<r;)a+=ne;for(;a<i;)i-=ne;for(;i<r;)i+=ne;var c=r<=i&&i<=a,l=o>=n.innerRadius&&o<=n.outerRadius;return c&&l}return!1},getCenterPoint:function(){var e=this._view,t=(e.startAngle+e.endAngle)/2,n=(e.innerRadius+e.outerRadius)/2;return{x:e.x+Math.cos(t)*n,y:e.y+Math.sin(t)*n}},
getArea:function(){var e=this._view;return Math.PI*((e.endAngle-e.startAngle)/(2*Math.PI))*(Math.pow(e.outerRadius,2)-Math.pow(e.innerRadius,2))},tooltipPosition:function(){var e=this._view,t=e.startAngle+(e.endAngle-e.startAngle)/2,n=(e.outerRadius-e.innerRadius)/2+e.innerRadius;return{x:e.x+Math.cos(t)*n,y:e.y+Math.sin(t)*n}},draw:function(){var e,t,n,s,i,o=this._chart.ctx,r=this._view,a="inner"===r.borderAlign?.33:0,c={x:r.x,y:r.y,innerRadius:r.innerRadius,outerRadius:Math.max(r.outerRadius-a,0),pixelMargin:a,startAngle:r.startAngle,endAngle:r.endAngle,fullCircles:Math.floor(r.circumference/ne)};if(o.save(),o.fillStyle=r.backgroundColor,o.strokeStyle=r.borderColor,c.fullCircles){for(c.endAngle=c.startAngle+ne,o.beginPath(),o.arc(c.x,c.y,c.outerRadius,c.startAngle,c.endAngle),o.arc(c.x,c.y,c.innerRadius,c.endAngle,c.startAngle,!0),o.closePath(),e=0;e<c.fullCircles;++e)o.fill();c.endAngle=c.startAngle+r.circumference%ne}o.beginPath(),o.arc(c.x,c.y,c.outerRadius,c.startAngle,c.endAngle
),o.arc(c.x,c.y,c.innerRadius,c.endAngle,c.startAngle,!0),o.closePath(),o.fill(),r.borderWidth&&(t=o,s=c,(i="inner"===(n=r).borderAlign)?(t.lineWidth=2*n.borderWidth,t.lineJoin="round"):(t.lineWidth=n.borderWidth,t.lineJoin="bevel"),s.fullCircles&&function(e,t,n,s){var i,o=n.endAngle;for(s&&(n.endAngle=n.startAngle+ne,se(e,n),n.endAngle=o,n.endAngle===n.startAngle&&n.fullCircles&&(n.endAngle+=ne,n.fullCircles--)),e.beginPath(),e.arc(n.x,n.y,n.innerRadius,n.startAngle+ne,n.startAngle,!0),i=0;i<n.fullCircles;++i)e.stroke();for(e.beginPath(),e.arc(n.x,n.y,t.outerRadius,n.startAngle,n.startAngle+ne),i=0;i<n.fullCircles;++i)e.stroke()}(t,n,s,i),i&&se(t,s),t.beginPath(),t.arc(s.x,s.y,n.outerRadius,s.startAngle,s.endAngle),t.arc(s.x,s.y,s.innerRadius,s.endAngle,s.startAngle,!0),t.closePath(),t.stroke()),o.restore()}}),oe=V.valueOrDefault,re=B.global.defaultColor;B._set("global",{elements:{line:{tension:.4,backgroundColor:re,borderWidth:3,borderColor:re,borderCapStyle:"butt",borderDash:[],
borderDashOffset:0,borderJoinStyle:"miter",capBezierPoints:!0,fill:!0}}});var ae=X.extend({_type:"line",draw:function(){var e,t,n,s=this._view,i=this._chart.ctx,o=s.spanGaps,r=this._children.slice(),a=B.global,c=a.elements.line,l=-1,p=this._loop;if(r.length){if(this._loop){for(e=0;e<r.length;++e)if(t=V.previousItem(r,e),!r[e]._view.skip&&t._view.skip){r=r.slice(e).concat(r.slice(0,e)),p=o;break}p&&r.push(r[0])}for(i.save(),i.lineCap=s.borderCapStyle||c.borderCapStyle,i.setLineDash&&i.setLineDash(s.borderDash||c.borderDash),i.lineDashOffset=oe(s.borderDashOffset,c.borderDashOffset),i.lineJoin=s.borderJoinStyle||c.borderJoinStyle,i.lineWidth=oe(s.borderWidth,c.borderWidth),i.strokeStyle=s.borderColor||a.defaultColor,i.beginPath(),(n=r[0]._view).skip||(i.moveTo(n.x,n.y),l=0),e=1;e<r.length;++e)n=r[e]._view,t=-1===l?V.previousItem(r,e):r[l],n.skip||(l!==e-1&&!o||-1===l?i.moveTo(n.x,n.y):V.canvas.lineTo(i,t._view,n),l=e);p&&i.closePath(),i.stroke(),i.restore()}}}),ce=V.valueOrDefault,
le=B.global.defaultColor;function pe(e){var t=this._view;return!!t&&Math.abs(e-t.x)<t.radius+t.hitRadius}B._set("global",{elements:{point:{radius:3,pointStyle:"circle",backgroundColor:le,borderColor:le,borderWidth:1,hitRadius:1,hoverRadius:4,hoverBorderWidth:1}}});var de=X.extend({_type:"point",inRange:function(e,t){var n=this._view;return!!n&&Math.pow(e-n.x,2)+Math.pow(t-n.y,2)<Math.pow(n.hitRadius+n.radius,2)},inLabelRange:pe,inXRange:pe,inYRange:function(e){var t=this._view;return!!t&&Math.abs(e-t.y)<t.radius+t.hitRadius},getCenterPoint:function(){var e=this._view;return{x:e.x,y:e.y}},getArea:function(){return Math.PI*Math.pow(this._view.radius,2)},tooltipPosition:function(){var e=this._view;return{x:e.x,y:e.y,padding:e.radius+e.borderWidth}},draw:function(e){var t=this._view,n=this._chart.ctx,s=t.pointStyle,i=t.rotation,o=t.radius,r=t.x,a=t.y,c=B.global,l=c.defaultColor;t.skip||(void 0===e||V.canvas._isPointInArea(t,e))&&(n.strokeStyle=t.borderColor||l,n.lineWidth=ce(t.borderWidth,
c.elements.point.borderWidth),n.fillStyle=t.backgroundColor||l,V.canvas.drawPoint(n,s,o,r,a,i))}}),ue=B.global.defaultColor;function he(e){return e&&void 0!==e.width}function ge(e){var t,n,s,i,o;return he(e)?(o=e.width/2,t=e.x-o,n=e.x+o,s=Math.min(e.y,e.base),i=Math.max(e.y,e.base)):(o=e.height/2,t=Math.min(e.x,e.base),n=Math.max(e.x,e.base),s=e.y-o,i=e.y+o),{left:t,top:s,right:n,bottom:i}}function ve(e,t,n){return e===t?n:e===n?t:e}function me(e,t,n){var s=null===t,i=null===n,o=!(!e||s&&i)&&ge(e);return o&&(s||t>=o.left&&t<=o.right)&&(i||n>=o.top&&n<=o.bottom)}B._set("global",{elements:{rectangle:{backgroundColor:ue,borderColor:ue,borderSkipped:"bottom",borderWidth:0}}});var fe=X.extend({_type:"rectangle",draw:function(){var e,t,n,s,i,o,r,a,c,l,p,d,u,h,g,v,m,f=this._chart.ctx,_=this._view,y=(h=ge(e=_),g=h.right-h.left,v=h.bottom-h.top,n=g/2,s=v/2,d=(t=e).borderWidth,l=(c=t).borderSkipped,p={},l&&(c.horizontal?c.base>c.x&&(l=ve(l,"left","right")):c.base<c.y&&(l=ve(l,"bottom","top")),
p[l]=!0),u=p,V.isObject(d)?(i=+d.top||0,o=+d.right||0,r=+d.bottom||0,a=+d.left||0):i=o=r=a=+d||0,m={t:u.top||i<0?0:s<i?s:i,r:u.right||o<0?0:n<o?n:o,b:u.bottom||r<0?0:s<r?s:r,l:u.left||a<0?0:n<a?n:a},{outer:{x:h.left,y:h.top,w:g,h:v},inner:{x:h.left+m.l,y:h.top+m.t,w:g-m.l-m.r,h:v-m.t-m.b}}),w=y.outer,b=y.inner;f.fillStyle=_.backgroundColor,f.fillRect(w.x,w.y,w.w,w.h),w.w===b.w&&w.h===b.h||(f.save(),f.beginPath(),f.rect(w.x,w.y,w.w,w.h),f.clip(),f.fillStyle=_.borderColor,f.rect(b.x,b.y,b.w,b.h),f.fill("evenodd"),f.restore())},height:function(){var e=this._view;return e.base-e.y},inRange:function(e,t){return me(this._view,e,t)},inLabelRange:function(e,t){var n=this._view;return he(n)?me(n,e,null):me(n,null,t)},inXRange:function(e){return me(this._view,e,null)},inYRange:function(e){return me(this._view,null,e)},getCenterPoint:function(){var e,t,n=this._view;return he(n)?(e=n.x,t=(n.y+n.base)/2):(e=(n.x+n.base)/2,t=n.y),{x:e,y:t}},getArea:function(){var e=this._view;return he(e
)?e.width*Math.abs(e.y-e.base):e.height*Math.abs(e.x-e.base)},tooltipPosition:function(){var e=this._view;return{x:e.x,y:e.y}}}),_e={},ye=ie,we=ae,be=de,Te=fe;_e.Arc=ye,_e.Line=we,_e.Point=be,_e.Rectangle=Te;var Se=V._deprecated,Ee=V.valueOrDefault;B._set("bar",{hover:{mode:"label"},scales:{xAxes:[{type:"category",offset:!0,gridLines:{offsetGridLines:!0}}],yAxes:[{type:"linear"}]}}),B._set("global",{datasets:{bar:{categoryPercentage:.8,barPercentage:.9}}});var Ce=te.extend({dataElementType:_e.Rectangle,_dataElementOptions:["backgroundColor","borderColor","borderSkipped","borderWidth","barPercentage","barThickness","categoryPercentage","maxBarThickness","minBarLength"],initialize:function(){var e,t;te.prototype.initialize.apply(this,arguments),(e=this.getMeta()).stack=this.getDataset().stack,e.bar=!0,t=this._getIndexScale().options,Se("bar chart",t.barPercentage,"scales.[x/y]Axes.barPercentage","dataset.barPercentage"),Se("bar chart",t.barThickness,"scales.[x/y]Axes.barThickness",
"dataset.barThickness"),Se("bar chart",t.categoryPercentage,"scales.[x/y]Axes.categoryPercentage","dataset.categoryPercentage"),Se("bar chart",this._getValueScale().options.minBarLength,"scales.[x/y]Axes.minBarLength","dataset.minBarLength"),Se("bar chart",t.maxBarThickness,"scales.[x/y]Axes.maxBarThickness","dataset.maxBarThickness")},update:function(e){var t,n,s=this.getMeta().data;for(this._ruler=this.getRuler(),t=0,n=s.length;t<n;++t)this.updateElement(s[t],t,e)},updateElement:function(e,t,n){var s=this.getMeta(),i=this.getDataset(),o=this._resolveDataElementOptions(e,t);e._xScale=this.getScaleForId(s.xAxisID),e._yScale=this.getScaleForId(s.yAxisID),e._datasetIndex=this.index,e._index=t,e._model={backgroundColor:o.backgroundColor,borderColor:o.borderColor,borderSkipped:o.borderSkipped,borderWidth:o.borderWidth,datasetLabel:i.label,label:this.chart.data.labels[t]},V.isArray(i.data[t])&&(e._model.borderSkipped=null),this._updateElementGeometry(e,t,n,o),e.pivot()},
_updateElementGeometry:function(e,t,n,s){var i=e._model,o=this._getValueScale(),r=o.getBasePixel(),a=o.isHorizontal(),c=this._ruler||this.getRuler(),l=this.calculateBarValuePixels(this.index,t,s),p=this.calculateBarIndexPixels(this.index,t,c,s);i.horizontal=a,i.base=n?r:l.base,i.x=a?n?r:l.head:p.center,i.y=a?p.center:n?r:l.head,i.height=a?p.size:void 0,i.width=a?void 0:p.size},_getStacks:function(e){var t,n,s=this._getIndexScale(),i=s._getMatchingVisibleMetas(this._type),o=s.options.stacked,r=i.length,a=[];for(t=0;t<r&&(n=i[t],(!1===o||-1===a.indexOf(n.stack)||void 0===o&&void 0===n.stack)&&a.push(n.stack),n.index!==e);++t);return a},getStackCount:function(){return this._getStacks().length},getStackIndex:function(e,t){var n=this._getStacks(e),s=void 0!==t?n.indexOf(t):-1;return-1===s?n.length-1:s},getRuler:function(){var e,t,n=this._getIndexScale(),s=[];for(e=0,t=this.getMeta().data.length;e<t;++e)s.push(n.getPixelForValue(null,e,this.index));return{pixels:s,start:n._startPixel,
end:n._endPixel,stackCount:this.getStackCount(),scale:n}},calculateBarValuePixels:function(e,t,n){var s,i,o,r,a,c,l,p=this.chart,d=this._getValueScale(),u=d.isHorizontal(),h=p.data.datasets,g=d._getMatchingVisibleMetas(this._type),v=d._parseValue(h[e].data[t]),m=n.minBarLength,f=d.options.stacked,_=this.getMeta().stack,y=void 0===v.start?0:0<=v.max&&0<=v.min?v.min:v.max,w=void 0===v.start?v.end:0<=v.max&&0<=v.min?v.max-v.min:v.min-v.max,b=g.length;if(f||void 0===f&&void 0!==_)for(s=0;s<b&&(i=g[s]).index!==e;++s)i.stack===_&&(o=void 0===(l=d._parseValue(h[i.index].data[t])).start?l.end:0<=l.min&&0<=l.max?l.max:l.min,(v.min<0&&o<0||0<=v.max&&0<o)&&(y+=o));return r=d.getPixelForValue(y),c=(a=d.getPixelForValue(y+w))-r,void 0!==m&&Math.abs(c)<m&&(c=m,a=0<=w&&!u||w<0&&u?r-m:r+m),{size:c,base:r,head:a,center:a+c/2}},calculateBarIndexPixels:function(e,t,n,s){var i,o,r,a,c,l,p,d,u,h,g,v,m,f,_,y,w,b,T="flex"===s.barThickness?(h=t,v=s,f=(g=n).pixels,_=f[h],y=0<h?f[h-1]:null,
w=h<f.length-1?f[h+1]:null,b=v.categoryPercentage,null===y&&(y=_-(null===w?g.end-g.start:w-_)),null===w&&(w=_+_-y),m=_-(_-Math.min(y,w))/2*b,{chunk:Math.abs(w-y)/2*b/g.stackCount,ratio:v.barPercentage,start:m}):(i=t,o=n,l=(r=s).barThickness,p=o.stackCount,d=o.pixels[i],u=V.isNullOrUndef(l)?function(e,t){var n,s,i,o,r=e._length;for(i=1,o=t.length;i<o;++i)r=Math.min(r,Math.abs(t[i]-t[i-1]));for(i=0,o=e.getTicks().length;i<o;++i)s=e.getPixelForTick(i),r=0<i?Math.min(r,Math.abs(s-n)):r,n=s;return r}(o.scale,o.pixels):-1,V.isNullOrUndef(l)?(a=u*r.categoryPercentage,c=r.barPercentage):(a=l*p,c=1),{chunk:a/p,ratio:c,start:d-a/2}),S=this.getStackIndex(e,this.getMeta().stack),E=T.start+T.chunk*S+T.chunk/2,C=Math.min(Ee(s.maxBarThickness,1/0),T.chunk*T.ratio);return{base:E-C/2,head:E+C/2,center:E,size:C}},draw:function(){var e=this.chart,t=this._getValueScale(),n=this.getMeta().data,s=this.getDataset(),i=n.length,o=0;for(V.canvas.clipArea(e.ctx,e.chartArea);o<i;++o){var r=t._parseValue(s.data[o]
);isNaN(r.min)||isNaN(r.max)||n[o].draw()}V.canvas.unclipArea(e.ctx)},_resolveDataElementOptions:function(){var e=V.extend({},te.prototype._resolveDataElementOptions.apply(this,arguments)),t=this._getIndexScale().options,n=this._getValueScale().options;return e.barPercentage=Ee(t.barPercentage,e.barPercentage),e.barThickness=Ee(t.barThickness,e.barThickness),e.categoryPercentage=Ee(t.categoryPercentage,e.categoryPercentage),e.maxBarThickness=Ee(t.maxBarThickness,e.maxBarThickness),e.minBarLength=Ee(n.minBarLength,e.minBarLength),e}}),Ae=V.valueOrDefault,Ie=V.options.resolve;B._set("bubble",{hover:{mode:"single"},scales:{xAxes:[{type:"linear",position:"bottom",id:"x-axis-0"}],yAxes:[{type:"linear",position:"left",id:"y-axis-0"}]},tooltips:{callbacks:{title:function(){return""},label:function(e,t){var n=t.datasets[e.datasetIndex].label||"",s=t.datasets[e.datasetIndex].data[e.index];return n+": ("+e.xLabel+", "+e.yLabel+", "+s.r+")"}}}});var Re=te.extend({dataElementType:_e.Point,
_dataElementOptions:["backgroundColor","borderColor","borderWidth","hoverBackgroundColor","hoverBorderColor","hoverBorderWidth","hoverRadius","hitRadius","pointStyle","rotation"],update:function(n){var s=this,e=s.getMeta().data;V.each(e,function(e,t){s.updateElement(e,t,n)})},updateElement:function(e,t,n){var s=this.getMeta(),i=e.custom||{},o=this.getScaleForId(s.xAxisID),r=this.getScaleForId(s.yAxisID),a=this._resolveDataElementOptions(e,t),c=this.getDataset().data[t],l=this.index,p=n?o.getPixelForDecimal(.5):o.getPixelForValue("object"==typeof c?c:NaN,t,l),d=n?r.getBasePixel():r.getPixelForValue(c,t,l);e._xScale=o,e._yScale=r,e._options=a,e._datasetIndex=l,e._index=t,e._model={backgroundColor:a.backgroundColor,borderColor:a.borderColor,borderWidth:a.borderWidth,hitRadius:a.hitRadius,pointStyle:a.pointStyle,rotation:a.rotation,radius:n?0:a.radius,skip:i.skip||isNaN(p)||isNaN(d),x:p,y:d},e.pivot()},setHoverStyle:function(e){var t=e._model,n=e._options,s=V.getHoverColor
;e.$previousStyle={backgroundColor:t.backgroundColor,borderColor:t.borderColor,borderWidth:t.borderWidth,radius:t.radius},t.backgroundColor=Ae(n.hoverBackgroundColor,s(n.backgroundColor)),t.borderColor=Ae(n.hoverBorderColor,s(n.borderColor)),t.borderWidth=Ae(n.hoverBorderWidth,n.borderWidth),t.radius=n.radius+n.hoverRadius},_resolveDataElementOptions:function(e,t){var n=this.chart,s=this.getDataset(),i=e.custom||{},o=s.data[t]||{},r=te.prototype._resolveDataElementOptions.apply(this,arguments),a={chart:n,dataIndex:t,dataset:s,datasetIndex:this.index};return this._cachedDataOpts===r&&(r=V.extend({},r)),r.radius=Ie([i.radius,o.r,this._config.radius,n.options.elements.point.radius],a,t),r}}),Le=V.valueOrDefault,Oe=Math.PI,Pe=2*Oe,xe=Oe/2;B._set("doughnut",{animation:{animateRotate:!0,animateScale:!1},hover:{mode:"single"},legendCallback:function(e){var t,n,s,i=document.createElement("ul"),o=e.data,r=o.datasets,a=o.labels;if(i.setAttribute("class",e.id+"-legend"),r.length)for(
n=r[t=0].data.length;t<n;++t)(s=i.appendChild(document.createElement("li"))).appendChild(document.createElement("span")).style.backgroundColor=r[0].backgroundColor[t],a[t]&&s.appendChild(document.createTextNode(a[t]));return i.outerHTML},legend:{labels:{generateLabels:function(i){var o=i.data;return o.labels.length&&o.datasets.length?o.labels.map(function(e,t){var n=i.getDatasetMeta(0),s=n.controller.getStyle(t);return{text:e,fillStyle:s.backgroundColor,strokeStyle:s.borderColor,lineWidth:s.borderWidth,hidden:isNaN(o.datasets[0].data[t])||n.data[t].hidden,index:t}}):[]}},onClick:function(e,t){var n,s,i,o=t.index,r=this.chart;for(n=0,s=(r.data.datasets||[]).length;n<s;++n)(i=r.getDatasetMeta(n)).data[o]&&(i.data[o].hidden=!i.data[o].hidden);r.update()}},cutoutPercentage:50,rotation:-xe,circumference:Pe,tooltips:{callbacks:{title:function(){return""},label:function(e,t){var n=t.labels[e.index],s=": "+t.datasets[e.datasetIndex].data[e.index];return V.isArray(n)?(n=n.slice())[0]+=s:n+=s,n}
}}});var ke=te.extend({dataElementType:_e.Arc,linkScales:V.noop,_dataElementOptions:["backgroundColor","borderColor","borderWidth","borderAlign","hoverBackgroundColor","hoverBorderColor","hoverBorderWidth"],getRingIndex:function(e){for(var t=0,n=0;n<e;++n)this.chart.isDatasetVisible(n)&&++t;return t},update:function(e){var t,n,s,i,o=this,r=o.chart,a=r.chartArea,c=r.options,l=1,p=1,d=0,u=0,h=o.getMeta(),g=h.data,v=c.cutoutPercentage/100||0,m=c.circumference,f=o._getRingWeight(o.index);if(m<Pe){var _=c.rotation%Pe,y=(_+=Oe<=_?-Pe:_<-Oe?Pe:0)+m,w=Math.cos(_),b=Math.sin(_),T=Math.cos(y),S=Math.sin(y),E=_<=0&&0<=y||Pe<=y,C=_<=xe&&xe<=y||Pe+xe<=y,A=_<=-xe&&-xe<=y||Oe+xe<=y,I=_===-Oe||Oe<=y?-1:Math.min(w,w*v,T,T*v),R=A?-1:Math.min(b,b*v,S,S*v),L=E?1:Math.max(w,w*v,T,T*v),O=C?1:Math.max(b,b*v,S,S*v);l=(L-I)/2,p=(O-R)/2,d=-(L+I)/2,u=-(O+R)/2}for(s=0,i=g.length;s<i;++s)g[s]._options=o._resolveDataElementOptions(g[s],s);for(r.borderWidth=o.getMaxBorderWidth(),t=(a.right-a.left-r.borderWidth)/l,
n=(a.bottom-a.top-r.borderWidth)/p,r.outerRadius=Math.max(Math.min(t,n)/2,0),r.innerRadius=Math.max(r.outerRadius*v,0),r.radiusLength=(r.outerRadius-r.innerRadius)/(o._getVisibleDatasetWeightTotal()||1),r.offsetX=d*r.outerRadius,r.offsetY=u*r.outerRadius,h.total=o.calculateTotal(),o.outerRadius=r.outerRadius-r.radiusLength*o._getRingWeightOffset(o.index),o.innerRadius=Math.max(o.outerRadius-r.radiusLength*f,0),s=0,i=g.length;s<i;++s)o.updateElement(g[s],s,e)},updateElement:function(e,t,n){var s=this.chart,i=s.chartArea,o=s.options,r=o.animation,a=(i.left+i.right)/2,c=(i.top+i.bottom)/2,l=o.rotation,p=o.rotation,d=this.getDataset(),u=n&&r.animateRotate?0:e.hidden?0:this.calculateCircumference(d.data[t])*(o.circumference/Pe),h=n&&r.animateScale?0:this.innerRadius,g=n&&r.animateScale?0:this.outerRadius,v=e._options||{};V.extend(e,{_datasetIndex:this.index,_index:t,_model:{backgroundColor:v.backgroundColor,borderColor:v.borderColor,borderWidth:v.borderWidth,borderAlign:v.borderAlign,
x:a+s.offsetX,y:c+s.offsetY,startAngle:l,endAngle:p,circumference:u,outerRadius:g,innerRadius:h,label:V.valueAtIndexOrDefault(d.label,t,s.data.labels[t])}});var m=e._model;n&&r.animateRotate||(m.startAngle=0===t?o.rotation:this.getMeta().data[t-1]._model.endAngle,m.endAngle=m.startAngle+m.circumference),e.pivot()},calculateTotal:function(){var n,s=this.getDataset(),e=this.getMeta(),i=0;return V.each(e.data,function(e,t){n=s.data[t],isNaN(n)||e.hidden||(i+=Math.abs(n))}),i},calculateCircumference:function(e){var t=this.getMeta().total;return 0<t&&!isNaN(e)?Pe*(Math.abs(e)/t):0},getMaxBorderWidth:function(e){var t,n,s,i,o,r,a,c,l=0,p=this.chart;if(!e)for(t=0,n=p.data.datasets.length;t<n;++t)if(p.isDatasetVisible(t)){e=(s=p.getDatasetMeta(t)).data,t!==this.index&&(o=s.controller);break}if(!e)return 0;for(t=0,n=e.length;t<n;++t)i=e[t],o?(o._configure(),r=o._resolveDataElementOptions(i,t)):r=i._options,"inner"!==r.borderAlign&&(a=r.borderWidth,l=(c=r.hoverBorderWidth)>(l=l<a?a:l)?c:l)
;return l},setHoverStyle:function(e){var t=e._model,n=e._options,s=V.getHoverColor;e.$previousStyle={backgroundColor:t.backgroundColor,borderColor:t.borderColor,borderWidth:t.borderWidth},t.backgroundColor=Le(n.hoverBackgroundColor,s(n.backgroundColor)),t.borderColor=Le(n.hoverBorderColor,s(n.borderColor)),t.borderWidth=Le(n.hoverBorderWidth,n.borderWidth)},_getRingWeightOffset:function(e){for(var t=0,n=0;n<e;++n)this.chart.isDatasetVisible(n)&&(t+=this._getRingWeight(n));return t},_getRingWeight:function(e){return Math.max(Le(this.chart.data.datasets[e].weight,1),0)},_getVisibleDatasetWeightTotal:function(){return this._getRingWeightOffset(this.chart.data.datasets.length)}});B._set("horizontalBar",{hover:{mode:"index",axis:"y"},scales:{xAxes:[{type:"linear",position:"bottom"}],yAxes:[{type:"category",position:"left",offset:!0,gridLines:{offsetGridLines:!0}}]},elements:{rectangle:{borderSkipped:"left"}},tooltips:{mode:"index",axis:"y"}}),B._set("global",{datasets:{horizontalBar:{
categoryPercentage:.8,barPercentage:.9}}});var Me=Ce.extend({_getValueScaleId:function(){return this.getMeta().xAxisID},_getIndexScaleId:function(){return this.getMeta().yAxisID}}),Ne=V.valueOrDefault,Be=V.options.resolve,De=V.canvas._isPointInArea;function Fe(e,t){var n=e&&e.options.ticks||{},s=n.reverse,i=void 0===n.min?t:0,o=void 0===n.max?t:0;return{start:s?o:i,end:s?i:o}}B._set("line",{showLines:!0,spanGaps:!1,hover:{mode:"label"},scales:{xAxes:[{type:"category",id:"x-axis-0"}],yAxes:[{type:"linear",id:"y-axis-0"}]}});var Ue=te.extend({datasetElementType:_e.Line,dataElementType:_e.Point,_datasetElementOptions:["backgroundColor","borderCapStyle","borderColor","borderDash","borderDashOffset","borderJoinStyle","borderWidth","cubicInterpolationMode","fill"],_dataElementOptions:{backgroundColor:"pointBackgroundColor",borderColor:"pointBorderColor",borderWidth:"pointBorderWidth",hitRadius:"pointHitRadius",hoverBackgroundColor:"pointHoverBackgroundColor",
hoverBorderColor:"pointHoverBorderColor",hoverBorderWidth:"pointHoverBorderWidth",hoverRadius:"pointHoverRadius",pointStyle:"pointStyle",radius:"pointRadius",rotation:"pointRotation"},update:function(e){var t,n,s=this,i=s.getMeta(),o=i.dataset,r=i.data||[],a=s.chart.options,c=s._config,l=s._showLine=Ne(c.showLine,a.showLines);for(s._xScale=s.getScaleForId(i.xAxisID),s._yScale=s.getScaleForId(i.yAxisID),l&&(void 0!==c.tension&&void 0===c.lineTension&&(c.lineTension=c.tension),o._scale=s._yScale,o._datasetIndex=s.index,o._children=r,o._model=s._resolveDatasetElementOptions(o),o.pivot()),t=0,n=r.length;t<n;++t)s.updateElement(r[t],t,e);for(l&&0!==o._model.tension&&s.updateBezierControlPoints(),t=0,n=r.length;t<n;++t)r[t].pivot()},updateElement:function(e,t,n){var s,i,o=this.getMeta(),r=e.custom||{},a=this.getDataset(),c=this.index,l=a.data[t],p=this._xScale,d=this._yScale,u=o.dataset._model,h=this._resolveDataElementOptions(e,t);s=p.getPixelForValue("object"==typeof l?l:NaN,t,c),
i=n?d.getBasePixel():this.calculatePointY(l,t,c),e._xScale=p,e._yScale=d,e._options=h,e._datasetIndex=c,e._index=t,e._model={x:s,y:i,skip:r.skip||isNaN(s)||isNaN(i),radius:h.radius,pointStyle:h.pointStyle,rotation:h.rotation,backgroundColor:h.backgroundColor,borderColor:h.borderColor,borderWidth:h.borderWidth,tension:Ne(r.tension,u?u.tension:0),steppedLine:!!u&&u.steppedLine,hitRadius:h.hitRadius}},_resolveDatasetElementOptions:function(e){var t,n,s,i,o,r,a,c,l,p,d,u=this._config,h=e.custom||{},g=this.chart.options,v=g.elements.line,m=te.prototype._resolveDatasetElementOptions.apply(this,arguments);return m.spanGaps=Ne(u.spanGaps,g.spanGaps),m.tension=Ne(u.lineTension,v.tension),m.steppedLine=Be([h.steppedLine,u.steppedLine,v.stepped]),m.clip=(t=Ne(u.clip,(r=this._xScale,a=this._yScale,c=m.borderWidth,p=Fe(r,l=c/2),{top:(d=Fe(a,l)).end,right:p.end,bottom:d.start,left:p.start})),V.isObject(t)?(n=t.top,s=t.right,i=t.bottom,o=t.left):n=s=i=o=t,{top:n,right:s,bottom:i,left:o}),m},
calculatePointY:function(e,t,n){var s,i,o,r,a,c,l,p=this.chart,d=this._yScale,u=0,h=0;if(d.options.stacked){for(a=+d.getRightValue(e),l=(c=p._getSortedVisibleDatasetMetas()).length,s=0;s<l&&(o=c[s]).index!==n;++s)i=p.data.datasets[o.index],"line"===o.type&&o.yAxisID===d.id&&((r=+d.getRightValue(i.data[t]))<0?h+=r||0:u+=r||0);return a<0?d.getPixelForValue(h+a):d.getPixelForValue(u+a)}return d.getPixelForValue(e)},updateBezierControlPoints:function(){var e,t,n,s,i=this.chart,o=this.getMeta(),r=o.dataset._model,a=i.chartArea,c=o.data||[];function l(e,t,n){return Math.max(Math.min(e,n),t)}if(r.spanGaps&&(c=c.filter(function(e){return!e._model.skip})),"monotone"===r.cubicInterpolationMode)V.splineCurveMonotone(c);else for(e=0,t=c.length;e<t;++e)n=c[e]._model,s=V.splineCurve(V.previousItem(c,e)._model,n,V.nextItem(c,e)._model,r.tension),n.controlPointPreviousX=s.previous.x,n.controlPointPreviousY=s.previous.y,n.controlPointNextX=s.next.x,n.controlPointNextY=s.next.y;if(
i.options.elements.line.capBezierPoints)for(e=0,t=c.length;e<t;++e)n=c[e]._model,De(n,a)&&(0<e&&De(c[e-1]._model,a)&&(n.controlPointPreviousX=l(n.controlPointPreviousX,a.left,a.right),n.controlPointPreviousY=l(n.controlPointPreviousY,a.top,a.bottom)),e<c.length-1&&De(c[e+1]._model,a)&&(n.controlPointNextX=l(n.controlPointNextX,a.left,a.right),n.controlPointNextY=l(n.controlPointNextY,a.top,a.bottom)))},draw:function(){var e,t=this.chart,n=this.getMeta(),s=n.data||[],i=t.chartArea,o=t.canvas,r=0,a=s.length;for(this._showLine&&(e=n.dataset._model.clip,V.canvas.clipArea(t.ctx,{left:!1===e.left?0:i.left-e.left,right:!1===e.right?o.width:i.right+e.right,top:!1===e.top?0:i.top-e.top,bottom:!1===e.bottom?o.height:i.bottom+e.bottom}),n.dataset.draw(),V.canvas.unclipArea(t.ctx));r<a;++r)s[r].draw(i)},setHoverStyle:function(e){var t=e._model,n=e._options,s=V.getHoverColor;e.$previousStyle={backgroundColor:t.backgroundColor,borderColor:t.borderColor,borderWidth:t.borderWidth,radius:t.radius},
t.backgroundColor=Ne(n.hoverBackgroundColor,s(n.backgroundColor)),t.borderColor=Ne(n.hoverBorderColor,s(n.borderColor)),t.borderWidth=Ne(n.hoverBorderWidth,n.borderWidth),t.radius=Ne(n.hoverRadius,n.radius)}}),We=V.options.resolve;B._set("polarArea",{scale:{type:"radialLinear",angleLines:{display:!1},gridLines:{circular:!0},pointLabels:{display:!1},ticks:{beginAtZero:!0}},animation:{animateRotate:!0,animateScale:!0},startAngle:-.5*Math.PI,legendCallback:function(e){var t,n,s,i=document.createElement("ul"),o=e.data,r=o.datasets,a=o.labels;if(i.setAttribute("class",e.id+"-legend"),r.length)for(n=r[t=0].data.length;t<n;++t)(s=i.appendChild(document.createElement("li"))).appendChild(document.createElement("span")).style.backgroundColor=r[0].backgroundColor[t],a[t]&&s.appendChild(document.createTextNode(a[t]));return i.outerHTML},legend:{labels:{generateLabels:function(i){var o=i.data;return o.labels.length&&o.datasets.length?o.labels.map(function(e,t){var n=i.getDatasetMeta(0),
s=n.controller.getStyle(t);return{text:e,fillStyle:s.backgroundColor,strokeStyle:s.borderColor,lineWidth:s.borderWidth,hidden:isNaN(o.datasets[0].data[t])||n.data[t].hidden,index:t}}):[]}},onClick:function(e,t){var n,s,i,o=t.index,r=this.chart;for(n=0,s=(r.data.datasets||[]).length;n<s;++n)(i=r.getDatasetMeta(n)).data[o].hidden=!i.data[o].hidden;r.update()}},tooltips:{callbacks:{title:function(){return""},label:function(e,t){return t.labels[e.index]+": "+e.yLabel}}}});var Ve=te.extend({dataElementType:_e.Arc,linkScales:V.noop,_dataElementOptions:["backgroundColor","borderColor","borderWidth","borderAlign","hoverBackgroundColor","hoverBorderColor","hoverBorderWidth"],_getIndexScaleId:function(){return this.chart.scale.id},_getValueScaleId:function(){return this.chart.scale.id},update:function(e){var t,n,s,i=this,o=i.getDataset(),r=i.getMeta(),a=i.chart.options.startAngle||0,c=i._starts=[],l=i._angles=[],p=r.data;for(i._updateRadius(),r.count=i.countVisibleElements(),t=0,
n=o.data.length;t<n;t++)c[t]=a,s=i._computeAngle(t),a+=l[t]=s;for(t=0,n=p.length;t<n;++t)p[t]._options=i._resolveDataElementOptions(p[t],t),i.updateElement(p[t],t,e)},_updateRadius:function(){var e=this.chart,t=e.chartArea,n=e.options,s=Math.min(t.right-t.left,t.bottom-t.top);e.outerRadius=Math.max(s/2,0),e.innerRadius=Math.max(n.cutoutPercentage?e.outerRadius/100*n.cutoutPercentage:1,0),e.radiusLength=(e.outerRadius-e.innerRadius)/e.getVisibleDatasetCount(),this.outerRadius=e.outerRadius-e.radiusLength*this.index,this.innerRadius=this.outerRadius-e.radiusLength},updateElement:function(e,t,n){var s=this.chart,i=this.getDataset(),o=s.options,r=o.animation,a=s.scale,c=s.data.labels,l=a.xCenter,p=a.yCenter,d=o.startAngle,u=e.hidden?0:a.getDistanceFromCenterForValue(i.data[t]),h=this._starts[t],g=h+(e.hidden?0:this._angles[t]),v=r.animateScale?0:a.getDistanceFromCenterForValue(i.data[t]),m=e._options||{};V.extend(e,{_datasetIndex:this.index,_index:t,_scale:a,_model:{
backgroundColor:m.backgroundColor,borderColor:m.borderColor,borderWidth:m.borderWidth,borderAlign:m.borderAlign,x:l,y:p,innerRadius:0,outerRadius:n?v:u,startAngle:n&&r.animateRotate?d:h,endAngle:n&&r.animateRotate?d:g,label:V.valueAtIndexOrDefault(c,t,c[t])}}),e.pivot()},countVisibleElements:function(){var n=this.getDataset(),e=this.getMeta(),s=0;return V.each(e.data,function(e,t){isNaN(n.data[t])||e.hidden||s++}),s},setHoverStyle:function(e){var t=e._model,n=e._options,s=V.getHoverColor,i=V.valueOrDefault;e.$previousStyle={backgroundColor:t.backgroundColor,borderColor:t.borderColor,borderWidth:t.borderWidth},t.backgroundColor=i(n.hoverBackgroundColor,s(n.backgroundColor)),t.borderColor=i(n.hoverBorderColor,s(n.borderColor)),t.borderWidth=i(n.hoverBorderWidth,n.borderWidth)},_computeAngle:function(e){var t=this.getMeta().count,n=this.getDataset(),s=this.getMeta();if(isNaN(n.data[e])||s.data[e].hidden)return 0;var i={chart:this.chart,dataIndex:e,dataset:n,datasetIndex:this.index}
;return We([this.chart.options.elements.arc.angle,2*Math.PI/t],i,e)}});B._set("pie",V.clone(B.doughnut)),B._set("pie",{cutoutPercentage:0});var Ge=ke,He=V.valueOrDefault;B._set("radar",{spanGaps:!1,scale:{type:"radialLinear"},elements:{line:{fill:"start",tension:0}}});var je=te.extend({datasetElementType:_e.Line,dataElementType:_e.Point,linkScales:V.noop,_datasetElementOptions:["backgroundColor","borderWidth","borderColor","borderCapStyle","borderDash","borderDashOffset","borderJoinStyle","fill"],_dataElementOptions:{backgroundColor:"pointBackgroundColor",borderColor:"pointBorderColor",borderWidth:"pointBorderWidth",hitRadius:"pointHitRadius",hoverBackgroundColor:"pointHoverBackgroundColor",hoverBorderColor:"pointHoverBorderColor",hoverBorderWidth:"pointHoverBorderWidth",hoverRadius:"pointHoverRadius",pointStyle:"pointStyle",radius:"pointRadius",rotation:"pointRotation"},_getIndexScaleId:function(){return this.chart.scale.id},_getValueScaleId:function(){return this.chart.scale.id},
update:function(e){var t,n,s=this.getMeta(),i=s.dataset,o=s.data||[],r=this.chart.scale,a=this._config;for(void 0!==a.tension&&void 0===a.lineTension&&(a.lineTension=a.tension),i._scale=r,i._datasetIndex=this.index,i._children=o,i._loop=!0,i._model=this._resolveDatasetElementOptions(i),i.pivot(),t=0,n=o.length;t<n;++t)this.updateElement(o[t],t,e);for(this.updateBezierControlPoints(),t=0,n=o.length;t<n;++t)o[t].pivot()},updateElement:function(e,t,n){var s=e.custom||{},i=this.getDataset(),o=this.chart.scale,r=o.getPointPositionForValue(t,i.data[t]),a=this._resolveDataElementOptions(e,t),c=this.getMeta().dataset._model,l=n?o.xCenter:r.x,p=n?o.yCenter:r.y;e._scale=o,e._options=a,e._datasetIndex=this.index,e._index=t,e._model={x:l,y:p,skip:s.skip||isNaN(l)||isNaN(p),radius:a.radius,pointStyle:a.pointStyle,rotation:a.rotation,backgroundColor:a.backgroundColor,borderColor:a.borderColor,borderWidth:a.borderWidth,tension:He(s.tension,c?c.tension:0),hitRadius:a.hitRadius}},
_resolveDatasetElementOptions:function(){var e=this._config,t=this.chart.options,n=te.prototype._resolveDatasetElementOptions.apply(this,arguments);return n.spanGaps=He(e.spanGaps,t.spanGaps),n.tension=He(e.lineTension,t.elements.line.tension),n},updateBezierControlPoints:function(){var e,t,n,s,i=this.getMeta(),o=this.chart.chartArea,r=i.data||[];function a(e,t,n){return Math.max(Math.min(e,n),t)}for(i.dataset._model.spanGaps&&(r=r.filter(function(e){return!e._model.skip})),e=0,t=r.length;e<t;++e)n=r[e]._model,s=V.splineCurve(V.previousItem(r,e,!0)._model,n,V.nextItem(r,e,!0)._model,n.tension),n.controlPointPreviousX=a(s.previous.x,o.left,o.right),n.controlPointPreviousY=a(s.previous.y,o.top,o.bottom),n.controlPointNextX=a(s.next.x,o.left,o.right),n.controlPointNextY=a(s.next.y,o.top,o.bottom)},setHoverStyle:function(e){var t=e._model,n=e._options,s=V.getHoverColor;e.$previousStyle={backgroundColor:t.backgroundColor,borderColor:t.borderColor,borderWidth:t.borderWidth,radius:t.radius},
t.backgroundColor=He(n.hoverBackgroundColor,s(n.backgroundColor)),t.borderColor=He(n.hoverBorderColor,s(n.borderColor)),t.borderWidth=He(n.hoverBorderWidth,n.borderWidth),t.radius=He(n.hoverRadius,n.radius)}});B._set("scatter",{hover:{mode:"single"},scales:{xAxes:[{id:"x-axis-1",type:"linear",position:"bottom"}],yAxes:[{id:"y-axis-1",type:"linear",position:"left"}]},tooltips:{callbacks:{title:function(){return""},label:function(e){return"("+e.xLabel+", "+e.yLabel+")"}}}}),B._set("global",{datasets:{scatter:{showLine:!1}}});var ze={bar:Ce,bubble:Re,doughnut:ke,horizontalBar:Me,line:Ue,polarArea:Ve,pie:Ge,radar:je,scatter:Ue};function Ye(e,t){return e.native?{x:e.x,y:e.y}:V.getRelativePosition(e,t)}function Xe(e,t){var n,s,i,o,r,a,c=e._getSortedVisibleDatasetMetas();for(s=0,o=c.length;s<o;++s)for(i=0,r=(n=c[s].data).length;i<r;++i)(a=n[i])._view.skip||t(a)}function Ke(e,t){var n=[];return Xe(e,function(e){e.inRange(t.x,t.y)&&n.push(e)}),n}function qe(e,s,i,o){
var r=Number.POSITIVE_INFINITY,a=[];return Xe(e,function(e){if(!i||e.inRange(s.x,s.y)){var t=e.getCenterPoint(),n=o(s,t);n<r?(a=[e],r=n):n===r&&a.push(e)}}),a}function Ze(e){var i=-1!==e.indexOf("x"),o=-1!==e.indexOf("y");return function(e,t){var n=i?Math.abs(e.x-t.x):0,s=o?Math.abs(e.y-t.y):0;return Math.sqrt(Math.pow(n,2)+Math.pow(s,2))}}function Qe(e,t,n){var s=Ye(t,e);n.axis=n.axis||"x";var i=Ze(n.axis),o=n.intersect?Ke(e,s):qe(e,s,!1,i),r=[];return o.length?(e._getSortedVisibleDatasetMetas().forEach(function(e){var t=e.data[o[0]._index];t&&!t._view.skip&&r.push(t)}),r):[]}var Je={modes:{single:function(e,t){var n=Ye(t,e),s=[];return Xe(e,function(e){if(e.inRange(n.x,n.y))return s.push(e),s}),s.slice(0,1)},label:Qe,index:Qe,dataset:function(e,t,n){var s=Ye(t,e);n.axis=n.axis||"xy";var i=Ze(n.axis),o=n.intersect?Ke(e,s):qe(e,s,!1,i);return 0<o.length&&(o=e.getDatasetMeta(o[0]._datasetIndex).data),o},"x-axis":function(e,t){return Qe(e,t,{intersect:!1})},point:function(e,t){return Ke(
e,Ye(t,e))},nearest:function(e,t,n){var s=Ye(t,e);n.axis=n.axis||"xy";var i=Ze(n.axis);return qe(e,s,n.intersect,i)},x:function(e,t,n){var s=Ye(t,e),i=[],o=!1;return Xe(e,function(e){e.inXRange(s.x)&&i.push(e),e.inRange(s.x,s.y)&&(o=!0)}),n.intersect&&!o&&(i=[]),i},y:function(e,t,n){var s=Ye(t,e),i=[],o=!1;return Xe(e,function(e){e.inYRange(s.y)&&i.push(e),e.inRange(s.x,s.y)&&(o=!0)}),n.intersect&&!o&&(i=[]),i}}},$e=V.extend;function et(e,t){return V.where(e,function(e){return e.pos===t})}function tt(e,i){return e.sort(function(e,t){var n=i?t:e,s=i?e:t;return n.weight===s.weight?n.index-s.index:n.weight-s.weight})}function nt(e,t,n,s){return Math.max(e[n],t[n])+Math.max(e[s],t[s])}function st(e,t,n){var s,i,o=n.box,r=e.maxPadding;if(n.size&&(e[n.pos]-=n.size),n.size=n.horizontal?o.height:o.width,e[n.pos]+=n.size,o.getPadding){var a=o.getPadding();r.top=Math.max(r.top,a.top),r.left=Math.max(r.left,a.left),r.bottom=Math.max(r.bottom,a.bottom),r.right=Math.max(r.right,a.right)}if(
s=t.outerWidth-nt(r,e,"left","right"),i=t.outerHeight-nt(r,e,"top","bottom"),s!==e.w||i!==e.h)return e.w=s,e.h=i,n.horizontal?s!==e.w:i!==e.h}function it(e,t){var n,s=t.maxPadding;return n={left:0,top:0,right:0,bottom:0},(e?["left","right"]:["top","bottom"]).forEach(function(e){n[e]=Math.max(t[e],s[e])}),n}function ot(e,t,n){var s,i,o,r,a,c,l=[];for(s=0,i=e.length;s<i;++s)(r=(o=e[s]).box).update(o.width||t.w,o.height||t.h,it(o.horizontal,t)),st(t,n,o)&&(c=!0,l.length&&(a=!0)),r.fullWidth||l.push(o);return a&&ot(l,t,n)||c}function rt(e,t,n){var s,i,o,r,a=n.padding,c=t.x,l=t.y;for(s=0,i=e.length;s<i;++s)r=(o=e[s]).box,o.horizontal?(r.left=r.fullWidth?a.left:t.left,r.right=r.fullWidth?n.outerWidth-a.right:t.left+t.w,r.top=l,r.bottom=l+r.height,r.width=r.right-r.left,l=r.bottom):(r.left=c,r.right=c+r.width,r.top=t.top,r.bottom=t.top+t.h,r.height=r.bottom-r.top,c=r.right);t.x=c,t.y=l}B._set("global",{layout:{padding:{top:0,right:0,bottom:0,left:0}}});var at,ct={defaults:{},addBox:function(e
,t){e.boxes||(e.boxes=[]),t.fullWidth=t.fullWidth||!1,t.position=t.position||"top",t.weight=t.weight||0,t._layers=t._layers||function(){return[{z:0,draw:function(){t.draw.apply(t,arguments)}}]},e.boxes.push(t)},removeBox:function(e,t){var n=e.boxes?e.boxes.indexOf(t):-1;-1!==n&&e.boxes.splice(n,1)},configure:function(e,t,n){for(var s,i=["fullWidth","position","weight"],o=i.length,r=0;r<o;++r)s=i[r],n.hasOwnProperty(s)&&(t[s]=n[s])},update:function(n,e,t){if(n){var s=n.options.layout||{},i=V.options.toPadding(s.padding),o=e-i.width,r=t-i.height,a=(u=function(e){var t,n,s,i=[];for(t=0,n=(e||[]).length;t<n;++t)s=e[t],i.push({index:t,box:s,pos:s.position,horizontal:s.isHorizontal(),weight:s.weight});return i}(n.boxes),h=tt(et(u,"left"),!0),g=tt(et(u,"right")),v=tt(et(u,"top"),!0),m=tt(et(u,"bottom")),{leftAndTop:h.concat(v),rightAndBottom:g.concat(m),chartArea:et(u,"chartArea"),vertical:h.concat(g),horizontal:v.concat(m)}),c=a.vertical,l=a.horizontal,p=Object.freeze({outerWidth:e,
outerHeight:t,padding:i,availableWidth:o,vBoxMaxWidth:o/2/c.length,hBoxMaxHeight:r/2}),d=$e({maxPadding:$e({},i),w:o,h:r,x:i.left,y:i.top},i);!function(e,t){var n,s,i;for(n=0,s=e.length;n<s;++n)(i=e[n]).width=i.horizontal?i.box.fullWidth&&t.availableWidth:t.vBoxMaxWidth,i.height=i.horizontal&&t.hBoxMaxHeight}(c.concat(l),p),ot(c,d,p),ot(l,d,p)&&ot(c,d,p),function(n){var s=n.maxPadding;function e(e){var t=Math.max(s[e]-n[e],0);return n[e]+=t,t}n.y+=e("top"),n.x+=e("left"),e("right"),e("bottom")}(d),rt(a.leftAndTop,d,p),d.x+=d.w,d.y+=d.h,rt(a.rightAndBottom,d,p),n.chartArea={left:d.left,top:d.top,right:d.left+d.w,bottom:d.top+d.h},V.each(a.chartArea,function(e){var t=e.box;$e(t,n.chartArea),t.update(d.w,d.h)})}var u,h,g,v,m}},lt=(at=Object.freeze({__proto__:null,
default:"@keyframes chartjs-render-animation{from{opacity:.99}to{opacity:1}}.chartjs-render-monitor{animation:chartjs-render-animation 1ms}.chartjs-size-monitor,.chartjs-size-monitor-expand,.chartjs-size-monitor-shrink{position:absolute;direction:ltr;left:0;top:0;right:0;bottom:0;overflow:hidden;pointer-events:none;visibility:hidden;z-index:-1}.chartjs-size-monitor-expand>div{position:absolute;width:1000000px;height:1000000px;left:0;top:0}.chartjs-size-monitor-shrink>div{position:absolute;width:200%;height:200%;left:0;top:0}"}))&&at.default||at,pt="$chartjs",dt="chartjs-size-monitor",ut="chartjs-render-monitor",ht=["animationstart","webkitAnimationStart"],gt={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"};function vt(e,t){var n=V.getStyle(e,t),s=n&&n.match(/^(\d+)(\.\d+)?px$/);return s?Number(s[1]):void 0}var mt=!!function(){
var e=!1;try{var t=Object.defineProperty({},"passive",{get:function(){e=!0}});window.addEventListener("e",null,t)}catch(e){}return e}()&&{passive:!0};function ft(e,t,n){e.addEventListener(t,n,mt)}function _t(e,t,n){e.removeEventListener(t,n,mt)}function yt(e,t,n,s,i){return{type:e,chart:t,native:i||null,x:void 0!==n?n:null,y:void 0!==s?s:null}}function wt(e){var t=document.createElement("div");return t.className=e||"",t}function bt(n,s,i){var e,t,o,r,a,c,l,p=n[pt]||(n[pt]={}),d=p.resizer=function(e){var t=wt(dt),n=wt(dt+"-expand"),s=wt(dt+"-shrink");n.appendChild(wt()),s.appendChild(wt()),t.appendChild(n),t.appendChild(s),t._reset=function(){n.scrollLeft=1e6,n.scrollTop=1e6,s.scrollLeft=1e6,s.scrollTop=1e6};var i=function(){t._reset(),e()};return ft(n,"scroll",i.bind(n,"expand")),ft(s,"scroll",i.bind(s,"shrink")),t}((o=!(e=function(){if(p.resizer){var e=i.options.maintainAspectRatio&&n.parentNode,t=e?e.clientWidth:0;s(yt("resize",i)),e&&e.clientWidth<t&&i.canvas&&s(yt("resize",i))}}),
r=[],function(){r=Array.prototype.slice.call(arguments),t=t||this,o||(o=!0,V.requestAnimFrame.call(window,function(){o=!1,e.apply(t,r)}))}));c=(a=n)[pt]||(a[pt]={}),l=c.renderProxy=function(e){"chartjs-render-animation"===e.animationName&&function(){if(p.resizer){var e=n.parentNode;e&&e!==d.parentNode&&e.insertBefore(d,e.firstChild),d._reset()}}()},V.each(ht,function(e){ft(a,e,l)}),c.reflow=!!a.offsetParent,a.classList.add(ut)}var Tt={disableCSSInjection:!1,_enabled:"undefined"!=typeof window&&"undefined"!=typeof document,_ensureLoaded:function(e){if(!this.disableCSSInjection){var t=e.getRootNode?e.getRootNode():document;!function(e,t){var n=e[pt]||(e[pt]={});if(!n.containsStyles){n.containsStyles=!0,t="/* Chart.js */\n"+t;var s=document.createElement("style");s.setAttribute("type","text/css"),s.appendChild(document.createTextNode(t)),e.appendChild(s)}}(t.host?t:document.head,lt)}},acquireContext:function(e,t){"string"==typeof e?e=document.getElementById(e):e.length&&(e=e[0]),
e&&e.canvas&&(e=e.canvas);var n=e&&e.getContext&&e.getContext("2d");return n&&n.canvas===e?(this._ensureLoaded(e),function(e,t){var n=e.style,s=e.getAttribute("height"),i=e.getAttribute("width");if(e[pt]={initial:{height:s,width:i,style:{display:n.display,height:n.height,width:n.width}}},n.display=n.display||"block",null===i||""===i){var o=vt(e,"width");void 0!==o&&(e.width=o)}if(null===s||""===s)if(""===e.style.height)e.height=e.width/(t.options.aspectRatio||2);else{var r=vt(e,"height");void 0!==o&&(e.height=r)}}(e,t),n):null},releaseContext:function(e){var n=e.canvas;if(n[pt]){var s=n[pt].initial;["height","width"].forEach(function(e){var t=s[e];V.isNullOrUndef(t)?n.removeAttribute(e):n.setAttribute(e,t)}),V.each(s.style||{},function(e,t){n.style[t]=e}),n.width=n.width,delete n[pt]}},addEventListener:function(o,e,r){var t=o.canvas;if("resize"!==e){var n=r[pt]||(r[pt]={});ft(t,e,(n.proxies||(n.proxies={}))[o.id+"_"+e]=function(e){var t,n,s,i;r((n=o,s=gt[(t=e).type]||t.type,
i=V.getRelativePosition(t,n),yt(s,n,i.x,i.y,t)))})}else bt(t,r,o)},removeEventListener:function(e,t,n){var s,i,o,r,a,c,l=e.canvas;if("resize"!==t){var p=((n[pt]||{}).proxies||{})[e.id+"_"+t];p&&_t(l,t,p)}else a=(s=l)[pt]||{},c=a.resizer,delete a.resizer,o=(i=s)[pt]||{},(r=o.renderProxy)&&(V.each(ht,function(e){_t(i,e,r)}),delete o.renderProxy),i.classList.remove(ut),c&&c.parentNode&&c.parentNode.removeChild(c)}};V.addEvent=ft,V.removeEvent=_t;var St=Tt._enabled?Tt:{acquireContext:function(e){return e&&e.canvas&&(e=e.canvas),e&&e.getContext("2d")||null}},Et=V.extend({initialize:function(){},acquireContext:function(){},releaseContext:function(){},addEventListener:function(){},removeEventListener:function(){}},St);B._set("global",{plugins:{}});var Ct={_plugins:[],_cacheId:0,register:function(e){var t=this._plugins;[].concat(e).forEach(function(e){-1===t.indexOf(e)&&t.push(e)}),this._cacheId++},unregister:function(e){var n=this._plugins;[].concat(e).forEach(function(e){var t=n.indexOf(e)
;-1!==t&&n.splice(t,1)}),this._cacheId++},clear:function(){this._plugins=[],this._cacheId++},count:function(){return this._plugins.length},getAll:function(){return this._plugins},notify:function(e,t,n){var s,i,o,r,a,c=this.descriptors(e),l=c.length;for(s=0;s<l;++s)if("function"==typeof(a=(o=(i=c[s]).plugin)[t])&&((r=[e].concat(n||[])).push(i.options),!1===a.apply(o,r)))return!1;return!0},descriptors:function(e){var t=e.$plugins||(e.$plugins={});if(t.id===this._cacheId)return t.descriptors;var s=[],i=[],n=e&&e.config||{},o=n.options&&n.options.plugins||{};return this._plugins.concat(n.plugins||[]).forEach(function(e){if(-1===s.indexOf(e)){var t=e.id,n=o[t];!1!==n&&(!0===n&&(n=V.clone(B.global.plugins[t])),s.push(e),i.push({plugin:e,options:n||{}}))}}),t.descriptors=i,t.id=this._cacheId,i},_invalidate:function(e){delete e.$plugins}},At={constructors:{},defaults:{},registerScaleType:function(e,t,n){this.constructors[e]=t,this.defaults[e]=V.clone(n)},getScaleConstructor:function(e){
return this.constructors.hasOwnProperty(e)?this.constructors[e]:void 0},getScaleDefaults:function(e){return this.defaults.hasOwnProperty(e)?V.merge({},[B.scale,this.defaults[e]]):{}},updateScaleDefaults:function(e,t){this.defaults.hasOwnProperty(e)&&(this.defaults[e]=V.extend(this.defaults[e],t))},addScalesToLayout:function(t){V.each(t.scales,function(e){e.fullWidth=e.options.fullWidth,e.position=e.options.position,e.weight=e.options.weight,ct.addBox(t,e)})}},It=V.valueOrDefault,Rt=V.rtl.getRtlAdapter;B._set("global",{tooltips:{enabled:!0,custom:null,mode:"nearest",position:"average",intersect:!0,backgroundColor:"rgba(0,0,0,0.8)",titleFontStyle:"bold",titleSpacing:2,titleMarginBottom:6,titleFontColor:"#fff",titleAlign:"left",bodySpacing:2,bodyFontColor:"#fff",bodyAlign:"left",footerFontStyle:"bold",footerSpacing:2,footerMarginTop:6,footerFontColor:"#fff",footerAlign:"left",yPadding:6,xPadding:6,caretPadding:2,caretSize:5,cornerRadius:6,multiKeyBackground:"#fff",displayColors:!0,
borderColor:"rgba(0,0,0,0)",borderWidth:0,callbacks:{beforeTitle:V.noop,title:function(e,t){var n="",s=t.labels,i=s?s.length:0;if(0<e.length){var o=e[0];o.label?n=o.label:o.xLabel?n=o.xLabel:0<i&&o.index<i&&(n=s[o.index])}return n},afterTitle:V.noop,beforeBody:V.noop,beforeLabel:V.noop,label:function(e,t){var n=t.datasets[e.datasetIndex].label||"";return n&&(n+=": "),V.isNullOrUndef(e.value)?n+=e.yLabel:n+=e.value,n},labelColor:function(e,t){var n=t.getDatasetMeta(e.datasetIndex).data[e.index]._view;return{borderColor:n.borderColor,backgroundColor:n.backgroundColor}},labelTextColor:function(){return this._options.bodyFontColor},afterLabel:V.noop,afterBody:V.noop,beforeFooter:V.noop,footer:V.noop,afterFooter:V.noop}}});var Lt={average:function(e){if(!e.length)return!1;var t,n,s=0,i=0,o=0;for(t=0,n=e.length;t<n;++t){var r=e[t];if(r&&r.hasValue()){var a=r.tooltipPosition();s+=a.x,i+=a.y,++o}}return{x:s/o,y:i/o}},nearest:function(e,t){var n,s,i,o=t.x,r=t.y,a=Number.POSITIVE_INFINITY;for(
n=0,s=e.length;n<s;++n){var c=e[n];if(c&&c.hasValue()){var l=c.getCenterPoint(),p=V.distanceBetweenPoints(t,l);p<a&&(a=p,i=c)}}if(i){var d=i.tooltipPosition();o=d.x,r=d.y}return{x:o,y:r}}};function Ot(e,t){return t&&(V.isArray(t)?Array.prototype.push.apply(e,t):e.push(t)),e}function Pt(e){return("string"==typeof e||e instanceof String)&&-1<e.indexOf("\n")?e.split("\n"):e}function xt(e){var t=B.global;return{xPadding:e.xPadding,yPadding:e.yPadding,xAlign:e.xAlign,yAlign:e.yAlign,rtl:e.rtl,textDirection:e.textDirection,bodyFontColor:e.bodyFontColor,_bodyFontFamily:It(e.bodyFontFamily,t.defaultFontFamily),_bodyFontStyle:It(e.bodyFontStyle,t.defaultFontStyle),_bodyAlign:e.bodyAlign,bodyFontSize:It(e.bodyFontSize,t.defaultFontSize),bodySpacing:e.bodySpacing,titleFontColor:e.titleFontColor,_titleFontFamily:It(e.titleFontFamily,t.defaultFontFamily),_titleFontStyle:It(e.titleFontStyle,t.defaultFontStyle),titleFontSize:It(e.titleFontSize,t.defaultFontSize),_titleAlign:e.titleAlign,
titleSpacing:e.titleSpacing,titleMarginBottom:e.titleMarginBottom,footerFontColor:e.footerFontColor,_footerFontFamily:It(e.footerFontFamily,t.defaultFontFamily),_footerFontStyle:It(e.footerFontStyle,t.defaultFontStyle),footerFontSize:It(e.footerFontSize,t.defaultFontSize),_footerAlign:e.footerAlign,footerSpacing:e.footerSpacing,footerMarginTop:e.footerMarginTop,caretSize:e.caretSize,cornerRadius:e.cornerRadius,backgroundColor:e.backgroundColor,opacity:0,legendColorBackground:e.multiKeyBackground,displayColors:e.displayColors,borderColor:e.borderColor,borderWidth:e.borderWidth}}function kt(e,t){return"center"===t?e.x+e.width/2:"right"===t?e.x+e.width-e.xPadding:e.x+e.xPadding}function Mt(e){return Ot([],Pt(e))}var Nt=X.extend({initialize:function(){this._model=xt(this._options),this._lastActive=[]},getTitle:function(){var e=this._options.callbacks,t=e.beforeTitle.apply(this,arguments),n=e.title.apply(this,arguments),s=e.afterTitle.apply(this,arguments),i=[];return Ot(i=Ot(i=Ot(i,Pt(t)),
Pt(n)),Pt(s))},getBeforeBody:function(){return Mt(this._options.callbacks.beforeBody.apply(this,arguments))},getBody:function(e,n){var s=this,i=s._options.callbacks,o=[];return V.each(e,function(e){var t={before:[],lines:[],after:[]};Ot(t.before,Pt(i.beforeLabel.call(s,e,n))),Ot(t.lines,i.label.call(s,e,n)),Ot(t.after,Pt(i.afterLabel.call(s,e,n))),o.push(t)}),o},getAfterBody:function(){return Mt(this._options.callbacks.afterBody.apply(this,arguments))},getFooter:function(){var e=this._options.callbacks,t=e.beforeFooter.apply(this,arguments),n=e.footer.apply(this,arguments),s=e.afterFooter.apply(this,arguments),i=[];return Ot(i=Ot(i=Ot(i,Pt(t)),Pt(n)),Pt(s))},update:function(e){var t,n,s,i,o,r,a,c,l,p,d,u,h,g,v,m,f,_,y,w,b,T,S,E=this,C=E._options,A=E._model,I=E._model=xt(C),R=E._active,L=E._data,O={xAlign:A.xAlign,yAlign:A.yAlign},P={x:A.x,y:A.y},x={width:A.width,height:A.height},k={x:A.caretX,y:A.caretY};if(R.length){I.opacity=1;var M=[],N=[];k=Lt[C.position].call(E,R,E._eventPosition)
;var B=[];for(t=0,n=R.length;t<n;++t)B.push((p=l=c=o=i=void 0,i=(s=R[t])._xScale,o=s._yScale||s._scale,r=s._index,a=s._datasetIndex,l=(c=s._chart.getDatasetMeta(a).controller)._getIndexScale(),p=c._getValueScale(),{xLabel:i?i.getLabelForIndex(r,a):"",yLabel:o?o.getLabelForIndex(r,a):"",label:l?""+l.getLabelForIndex(r,a):"",value:p?""+p.getLabelForIndex(r,a):"",index:r,datasetIndex:a,x:s._model.x,y:s._model.y}));C.filter&&(B=B.filter(function(e){return C.filter(e,L)})),C.itemSort&&(B=B.sort(function(e,t){return C.itemSort(e,t,L)})),V.each(B,function(e){M.push(C.callbacks.labelColor.call(E,e,E._chart)),N.push(C.callbacks.labelTextColor.call(E,e,E._chart))}),I.title=E.getTitle(B,L),I.beforeBody=E.getBeforeBody(B,L),I.body=E.getBody(B,L),I.afterBody=E.getAfterBody(B,L),I.footer=E.getFooter(B,L),I.x=k.x,I.y=k.y,I.caretPadding=C.caretPadding,I.labelColors=M,I.labelTextColors=N,I.dataPoints=B,x=function(e,t){var n=e._chart.ctx,s=2*t.yPadding,i=0,o=t.body,r=o.reduce(function(e,t){
return e+t.before.length+t.lines.length+t.after.length},0);r+=t.beforeBody.length+t.afterBody.length;var a=t.title.length,c=t.footer.length,l=t.titleFontSize,p=t.bodyFontSize,d=t.footerFontSize;s+=a*l,s+=a?(a-1)*t.titleSpacing:0,s+=a?t.titleMarginBottom:0,s+=r*p,s+=r?(r-1)*t.bodySpacing:0,s+=c?t.footerMarginTop:0,s+=c*d,s+=c?(c-1)*t.footerSpacing:0;var u=0,h=function(e){i=Math.max(i,n.measureText(e).width+u)};return n.font=V.fontString(l,t._titleFontStyle,t._titleFontFamily),V.each(t.title,h),n.font=V.fontString(p,t._bodyFontStyle,t._bodyFontFamily),V.each(t.beforeBody.concat(t.afterBody),h),u=t.displayColors?p+2:0,V.each(o,function(e){V.each(e.before,h),V.each(e.lines,h),V.each(e.after,h)}),u=0,n.font=V.fontString(d,t._footerFontStyle,t._footerFontFamily),V.each(t.footer,h),{width:i+=2*t.xPadding,height:s}}(this,I),d=I,h=O=function(e,t){var n,s,i,o,r,a=e._model,c=e._chart,l=e._chart.chartArea,p="center",d="center";a.y<t.height?d="top":a.y>c.height-t.height&&(d="bottom");var u=(
l.left+l.right)/2,h=(l.top+l.bottom)/2;"center"===d?(n=function(e){return e<=u},s=function(e){return u<e}):(n=function(e){return e<=t.width/2},s=function(e){return e>=c.width-t.width/2}),i=function(e){return e+t.width+a.caretSize+a.caretPadding>c.width},o=function(e){return e-t.width-a.caretSize-a.caretPadding<0},r=function(e){return e<=h?"top":"bottom"},n(a.x)?(p="left",i(a.x)&&(p="center",d=r(a.y))):s(a.x)&&(p="right",o(a.x)&&(p="center",d=r(a.y)));var g=e._options;return{xAlign:g.xAlign?g.xAlign:p,yAlign:g.yAlign?g.yAlign:d}}(this,u=x),g=E._chart,v=d.x,m=d.y,f=d.caretSize,_=d.caretPadding,y=d.cornerRadius,w=h.xAlign,b=h.yAlign,T=f+_,S=y+_,"right"===w?v-=u.width:"center"===w&&((v-=u.width/2)+u.width>g.width&&(v=g.width-u.width),v<0&&(v=0)),"top"===b?m+=T:m-="bottom"===b?u.height+T:u.height/2,"center"===b?"left"===w?v+=T:"right"===w&&(v-=T):"left"===w?v-=S:"right"===w&&(v+=S),P={x:v,y:m}}else I.opacity=0;return I.xAlign=O.xAlign,I.yAlign=O.yAlign,I.x=P.x,I.y=P.y,I.width=x.width,
I.height=x.height,I.caretX=k.x,I.caretY=k.y,E._model=I,e&&C.custom&&C.custom.call(E,I),E},drawCaret:function(e,t){var n=this._chart.ctx,s=this._view,i=this.getCaretPosition(e,t,s);n.lineTo(i.x1,i.y1),n.lineTo(i.x2,i.y2),n.lineTo(i.x3,i.y3)},getCaretPosition:function(e,t,n){var s,i,o,r,a,c,l=n.caretSize,p=n.cornerRadius,d=n.xAlign,u=n.yAlign,h=e.x,g=e.y,v=t.width,m=t.height;if("center"===u)a=g+m/2,"left"===d?(i=(s=h)-l,o=s,r=a+l,c=a-l):(i=(s=h+v)+l,o=s,r=a-l,c=a+l);else if(s="left"===d?(i=h+p+l)-l:"right"===d?(i=h+v-p-l)-l:(i=n.caretX)-l,o=i+l,"top"===u)a=(r=g)-l,c=r;else{a=(r=g+m)+l,c=r;var f=o;o=s,s=f}return{x1:s,x2:i,x3:o,y1:r,y2:a,y3:c}},drawTitle:function(e,t,n){var s,i,o,r=t.title,a=r.length;if(a){var c=Rt(t.rtl,t.x,t.width);for(e.x=kt(t,t._titleAlign),n.textAlign=c.textAlign(t._titleAlign),n.textBaseline="middle",s=t.titleFontSize,i=t.titleSpacing,n.fillStyle=t.titleFontColor,n.font=V.fontString(s,t._titleFontStyle,t._titleFontFamily),o=0;o<a;++o)n.fillText(r[o],c.x(e.x),e.y+s/2)
,e.y+=s+i,o+1===a&&(e.y+=t.titleMarginBottom-i)}},drawBody:function(t,e,n){var s,i,o,r,a,c,l,p,d=e.bodyFontSize,u=e.bodySpacing,h=e._bodyAlign,g=e.body,v=e.displayColors,m=0,f=v?kt(e,"left"):0,_=Rt(e.rtl,e.x,e.width),y=function(e){n.fillText(e,_.x(t.x+m),t.y+d/2),t.y+=d+u},w=_.textAlign(h);for(n.textAlign=h,n.textBaseline="middle",n.font=V.fontString(d,e._bodyFontStyle,e._bodyFontFamily),t.x=kt(e,w),n.fillStyle=e.bodyFontColor,V.each(e.beforeBody,y),m=v&&"right"!==w?"center"===h?d/2+1:d+2:0,a=0,l=g.length;a<l;++a){for(s=g[a],i=e.labelTextColors[a],o=e.labelColors[a],n.fillStyle=i,V.each(s.before,y),c=0,p=(r=s.lines).length;c<p;++c){if(v){var b=_.x(f);n.fillStyle=e.legendColorBackground,n.fillRect(_.leftForLtr(b,d),t.y,d,d),n.lineWidth=1,n.strokeStyle=o.borderColor,n.strokeRect(_.leftForLtr(b,d),t.y,d,d),n.fillStyle=o.backgroundColor,n.fillRect(_.leftForLtr(_.xPlus(b,1),d-2),t.y+1,d-2,d-2),n.fillStyle=i}y(r[c])}V.each(s.after,y)}m=0,V.each(e.afterBody,y),t.y-=u},drawFooter:function(e,t,
n){var s,i,o=t.footer,r=o.length;if(r){var a=Rt(t.rtl,t.x,t.width);for(e.x=kt(t,t._footerAlign),e.y+=t.footerMarginTop,n.textAlign=a.textAlign(t._footerAlign),n.textBaseline="middle",s=t.footerFontSize,n.fillStyle=t.footerFontColor,n.font=V.fontString(s,t._footerFontStyle,t._footerFontFamily),i=0;i<r;++i)n.fillText(o[i],a.x(e.x),e.y+s/2),e.y+=s+t.footerSpacing}},drawBackground:function(e,t,n,s){n.fillStyle=t.backgroundColor,n.strokeStyle=t.borderColor,n.lineWidth=t.borderWidth;var i=t.xAlign,o=t.yAlign,r=e.x,a=e.y,c=s.width,l=s.height,p=t.cornerRadius;n.beginPath(),n.moveTo(r+p,a),"top"===o&&this.drawCaret(e,s),n.lineTo(r+c-p,a),n.quadraticCurveTo(r+c,a,r+c,a+p),"center"===o&&"right"===i&&this.drawCaret(e,s),n.lineTo(r+c,a+l-p),n.quadraticCurveTo(r+c,a+l,r+c-p,a+l),"bottom"===o&&this.drawCaret(e,s),n.lineTo(r+p,a+l),n.quadraticCurveTo(r,a+l,r,a+l-p),"center"===o&&"left"===i&&this.drawCaret(e,s),n.lineTo(r,a+p),n.quadraticCurveTo(r,a,r+p,a),n.closePath(),n.fill(),
0<t.borderWidth&&n.stroke()},draw:function(){var e=this._chart.ctx,t=this._view;if(0!==t.opacity){var n={width:t.width,height:t.height},s={x:t.x,y:t.y},i=Math.abs(t.opacity<.001)?0:t.opacity,o=t.title.length||t.beforeBody.length||t.body.length||t.afterBody.length||t.footer.length;this._options.enabled&&o&&(e.save(),e.globalAlpha=i,this.drawBackground(s,t,e,n),s.y+=t.yPadding,V.rtl.overrideTextDirection(e,t.textDirection),this.drawTitle(s,t,e),this.drawBody(s,t,e),this.drawFooter(s,t,e),V.rtl.restoreTextDirection(e,t.textDirection),e.restore())}},handleEvent:function(e){var t,n=this,s=n._options;return n._lastActive=n._lastActive||[],"mouseout"===e.type?n._active=[]:(n._active=n._chart.getElementsAtEventForMode(e,s.mode,s),s.reverse&&n._active.reverse()),(t=!V.arrayEquals(n._active,n._lastActive))&&(n._lastActive=n._active,(s.enabled||s.custom)&&(n._eventPosition={x:e.x,y:e.y},n.update(!0),n.pivot())),t}}),Bt=Lt,Dt=Nt;Dt.positioners=Bt;var Ft=V.valueOrDefault;function Ut(){
return V.merge({},[].slice.call(arguments),{merger:function(e,t,n,s){if("xAxes"===e||"yAxes"===e){var i,o,r,a=n[e].length;for(t[e]||(t[e]=[]),i=0;i<a;++i)r=n[e][i],o=Ft(r.type,"xAxes"===e?"category":"linear"),i>=t[e].length&&t[e].push({}),!t[e][i].type||r.type&&r.type!==t[e][i].type?V.merge(t[e][i],[At.getScaleDefaults(o),r]):V.merge(t[e][i],r)}else V._merger(e,t,n,s)}})}function Wt(){return V.merge({},[].slice.call(arguments),{merger:function(e,t,n,s){var i=t[e]||{},o=n[e];"scales"===e?t[e]=Ut(i,o):"scale"===e?t[e]=V.merge(i,[At.getScaleDefaults(o.type),o]):V._merger(e,t,n,s)}})}function Vt(e,t,n){for(var s,i=function(e){return e.id===s};s=t+n++,0<=V.findIndex(e,i););return s}function Gt(e){return"top"===e||"bottom"===e}function Ht(n,s){return function(e,t){return e[n]===t[n]?e[s]-t[s]:e[n]-t[n]}}B._set("global",{elements:{},events:["mousemove","mouseout","click","touchstart","touchmove"],hover:{onHover:null,mode:"nearest",intersect:!0,animationDuration:400},onClick:null,
maintainAspectRatio:!0,responsive:!0,responsiveAnimationDuration:0});var jt=function(e,t){return this.construct(e,t),this};V.extend(jt.prototype,{construct:function(e,t){var n,s,i=this;(s=(n=(n=t)||{}).data=n.data||{}).datasets=s.datasets||[],s.labels=s.labels||[],n.options=Wt(B.global,B[n.type],n.options||{}),t=n;var o=Et.acquireContext(e,t),r=o&&o.canvas,a=r&&r.height,c=r&&r.width;i.id=V.uid(),i.ctx=o,i.canvas=r,i.config=t,i.width=c,i.height=a,i.aspectRatio=a?c/a:null,i.options=t.options,i._bufferedRender=!1,i._layers=[],(i.chart=i).controller=i,jt.instances[i.id]=i,Object.defineProperty(i,"data",{get:function(){return i.config.data},set:function(e){i.config.data=e}}),o&&r?(i.initialize(),i.update()):console.error("Failed to create chart: can't acquire context from the given item")},initialize:function(){return Ct.notify(this,"beforeInit"),V.retinaScale(this,this.options.devicePixelRatio),this.bindEvents(),this.options.responsive&&this.resize(!0),this.initToolTip(),Ct.notify(this,
"afterInit"),this},clear:function(){return V.canvas.clear(this),this},stop:function(){return Z.cancelAnimation(this),this},resize:function(e){var t=this,n=t.options,s=t.canvas,i=n.maintainAspectRatio&&t.aspectRatio||null,o=Math.max(0,Math.floor(V.getMaximumWidth(s))),r=Math.max(0,Math.floor(i?o/i:V.getMaximumHeight(s)));if((t.width!==o||t.height!==r)&&(s.width=t.width=o,s.height=t.height=r,s.style.width=o+"px",s.style.height=r+"px",V.retinaScale(t,n.devicePixelRatio),!e)){var a={width:o,height:r};Ct.notify(t,"resize",[a]),n.onResize&&n.onResize(t,a),t.stop(),t.update({duration:n.responsiveAnimationDuration})}},ensureScalesHaveIDs:function(){var e=this.options,n=e.scales||{},t=e.scale;V.each(n.xAxes,function(e,t){e.id||(e.id=Vt(n.xAxes,"x-axis-",t))}),V.each(n.yAxes,function(e,t){e.id||(e.id=Vt(n.yAxes,"y-axis-",t))}),t&&(t.id=t.id||"scale")},buildOrUpdateScales:function(){var r=this,e=r.options,a=r.scales||{},t=[],c=Object.keys(a).reduce(function(e,t){return e[t]=!1,e},{});e.scales&&(
t=t.concat((e.scales.xAxes||[]).map(function(e){return{options:e,dtype:"category",dposition:"bottom"}}),(e.scales.yAxes||[]).map(function(e){return{options:e,dtype:"linear",dposition:"left"}}))),e.scale&&t.push({options:e.scale,dtype:"radialLinear",isDefault:!0,dposition:"chartArea"}),V.each(t,function(e){var t=e.options,n=t.id,s=Ft(t.type,e.dtype);Gt(t.position)!==Gt(e.dposition)&&(t.position=e.dposition),c[n]=!0;var i=null;if(n in a&&a[n].type===s)(i=a[n]).options=t,i.ctx=r.ctx,i.chart=r;else{var o=At.getScaleConstructor(s);if(!o)return;i=new o({id:n,type:s,options:t,ctx:r.ctx,chart:r}),a[i.id]=i}i.mergeTicksOptions(),e.isDefault&&(r.scale=i)}),V.each(c,function(e,t){e||delete a[t]}),r.scales=a,At.addScalesToLayout(this)},buildOrUpdateControllers:function(){var e,t,n=[],s=this.data.datasets;for(e=0,t=s.length;e<t;e++){var i=s[e],o=this.getDatasetMeta(e),r=i.type||this.config.type;if(o.type&&o.type!==r&&(this.destroyDatasetMeta(e),o=this.getDatasetMeta(e)),o.type=r,o.order=i.order||0,
o.index=e,o.controller)o.controller.updateIndex(e),o.controller.linkScales();else{var a=ze[o.type];if(void 0===a)throw new Error('"'+o.type+'" is not a chart type.');o.controller=new a(this,e),n.push(o.controller)}}return n},resetElements:function(){var n=this;V.each(n.data.datasets,function(e,t){n.getDatasetMeta(t).controller.reset()},n)},reset:function(){this.resetElements(),this.tooltip.initialize()},update:function(e){var t,n,s,i,o=this;if(e&&"object"==typeof e||(e={duration:e,lazy:arguments[1]}),i=(s=o).options,V.each(s.scales,function(e){ct.removeBox(s,e)}),i=Wt(B.global,B[s.config.type],i),s.options=s.config.options=i,s.ensureScalesHaveIDs(),s.buildOrUpdateScales(),s.tooltip._options=i.tooltips,s.tooltip.initialize(),Ct._invalidate(o),!1!==Ct.notify(o,"beforeUpdate")){o.tooltip._data=o.data;var r=o.buildOrUpdateControllers();for(t=0,n=o.data.datasets.length;t<n;t++)o.getDatasetMeta(t).controller.buildOrUpdateElements();o.updateLayout(),
o.options.animation&&o.options.animation.duration&&V.each(r,function(e){e.reset()}),o.updateDatasets(),o.tooltip.initialize(),o.lastActive=[],Ct.notify(o,"afterUpdate"),o._layers.sort(Ht("z","_idx")),o._bufferedRender?o._bufferedRequest={duration:e.duration,easing:e.easing,lazy:e.lazy}:o.render(e)}},updateLayout:function(){var t=this;!1!==Ct.notify(t,"beforeLayout")&&(ct.update(this,this.width,this.height),t._layers=[],V.each(t.boxes,function(e){e._configure&&e._configure(),t._layers.push.apply(t._layers,e._layers())},t),t._layers.forEach(function(e,t){e._idx=t}),Ct.notify(t,"afterScaleUpdate"),Ct.notify(t,"afterLayout"))},updateDatasets:function(){if(!1!==Ct.notify(this,"beforeDatasetsUpdate")){for(var e=0,t=this.data.datasets.length;e<t;++e)this.updateDataset(e);Ct.notify(this,"afterDatasetsUpdate")}},updateDataset:function(e){var t=this.getDatasetMeta(e),n={meta:t,index:e};!1!==Ct.notify(this,"beforeDatasetUpdate",[n])&&(t.controller._update(),Ct.notify(this,"afterDatasetUpdate",[n]
))},render:function(e){var t=this;e&&"object"==typeof e||(e={duration:e,lazy:arguments[1]});var n=t.options.animation,s=Ft(e.duration,n&&n.duration),i=e.lazy;if(!1!==Ct.notify(t,"beforeRender")){var o=function(e){Ct.notify(t,"afterRender"),V.callback(n&&n.onComplete,[e],t)};if(n&&s){var r=new q({numSteps:s/16.66,easing:e.easing||n.easing,render:function(e,t){var n=V.easing.effects[t.easing],s=t.currentStep,i=s/t.numSteps;e.draw(n(i),i,s)},onAnimationProgress:n.onProgress,onAnimationComplete:o});Z.addAnimation(t,r,s,i)}else t.draw(),o(new q({numSteps:0,chart:t}));return t}},draw:function(e){var t,n,s=this;if(s.clear(),V.isNullOrUndef(e)&&(e=1),s.transition(e),!(s.width<=0||s.height<=0)&&!1!==Ct.notify(s,"beforeDraw",[e])){for(n=s._layers,t=0;t<n.length&&n[t].z<=0;++t)n[t].draw(s.chartArea);for(s.drawDatasets(e);t<n.length;++t)n[t].draw(s.chartArea);s._drawTooltip(e),Ct.notify(s,"afterDraw",[e])}},transition:function(e){for(var t=0,n=(this.data.datasets||[]).length;t<n;++t
)this.isDatasetVisible(t)&&this.getDatasetMeta(t).controller.transition(e);this.tooltip.transition(e)},_getSortedDatasetMetas:function(e){var t,n,s=[];for(t=0,n=(this.data.datasets||[]).length;t<n;++t)e&&!this.isDatasetVisible(t)||s.push(this.getDatasetMeta(t));return s.sort(Ht("order","index")),s},_getSortedVisibleDatasetMetas:function(){return this._getSortedDatasetMetas(!0)},drawDatasets:function(e){var t,n;if(!1!==Ct.notify(this,"beforeDatasetsDraw",[e])){for(n=(t=this._getSortedVisibleDatasetMetas()).length-1;0<=n;--n)this.drawDataset(t[n],e);Ct.notify(this,"afterDatasetsDraw",[e])}},drawDataset:function(e,t){var n={meta:e,index:e.index,easingValue:t};!1!==Ct.notify(this,"beforeDatasetDraw",[n])&&(e.controller.draw(t),Ct.notify(this,"afterDatasetDraw",[n]))},_drawTooltip:function(e){var t=this.tooltip,n={tooltip:t,easingValue:e};!1!==Ct.notify(this,"beforeTooltipDraw",[n])&&(t.draw(),Ct.notify(this,"afterTooltipDraw",[n]))},getElementAtEvent:function(e){return Je.modes.single(this
,e)},getElementsAtEvent:function(e){return Je.modes.label(this,e,{intersect:!0})},getElementsAtXAxis:function(e){return Je.modes["x-axis"](this,e,{intersect:!0})},getElementsAtEventForMode:function(e,t,n){var s=Je.modes[t];return"function"==typeof s?s(this,e,n):[]},getDatasetAtEvent:function(e){return Je.modes.dataset(this,e,{intersect:!0})},getDatasetMeta:function(e){var t=this.data.datasets[e];t._meta||(t._meta={});var n=t._meta[this.id];return n||(n=t._meta[this.id]={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:t.order||0,index:e}),n},getVisibleDatasetCount:function(){for(var e=0,t=0,n=this.data.datasets.length;t<n;++t)this.isDatasetVisible(t)&&e++;return e},isDatasetVisible:function(e){var t=this.getDatasetMeta(e);return"boolean"==typeof t.hidden?!t.hidden:!this.data.datasets[e].hidden},generateLegend:function(){return this.options.legendCallback(this)},destroyDatasetMeta:function(e){var t=this.id,n=this.data.datasets[e],
s=n._meta&&n._meta[t];s&&(s.controller.destroy(),delete n._meta[t])},destroy:function(){var e,t,n=this,s=n.canvas;for(n.stop(),e=0,t=n.data.datasets.length;e<t;++e)n.destroyDatasetMeta(e);s&&(n.unbindEvents(),V.canvas.clear(n),Et.releaseContext(n.ctx),n.canvas=null,n.ctx=null),Ct.notify(n,"destroy"),delete jt.instances[n.id]},toBase64Image:function(){return this.canvas.toDataURL.apply(this.canvas,arguments)},initToolTip:function(){this.tooltip=new Dt({_chart:this,_chartInstance:this,_data:this.data,_options:this.options.tooltips},this)},bindEvents:function(){var t=this,n=t._listeners={},s=function(){t.eventHandler.apply(t,arguments)};V.each(t.options.events,function(e){Et.addEventListener(t,e,s),n[e]=s}),t.options.responsive&&(s=function(){t.resize()},Et.addEventListener(t,"resize",s),n.resize=s)},unbindEvents:function(){var n=this,e=n._listeners;e&&(delete n._listeners,V.each(e,function(e,t){Et.removeEventListener(n,t,e)}))},updateHoverStyle:function(e,t,n){var s,i,o,
r=n?"set":"remove";for(i=0,o=e.length;i<o;++i)(s=e[i])&&this.getDatasetMeta(s._datasetIndex).controller[r+"HoverStyle"](s);"dataset"===t&&this.getDatasetMeta(e[0]._datasetIndex).controller["_"+r+"DatasetHoverStyle"]()},eventHandler:function(e){var t=this,n=t.tooltip;if(!1!==Ct.notify(t,"beforeEvent",[e])){t._bufferedRender=!0,t._bufferedRequest=null;var s=t.handleEvent(e);n&&(s=n._start?n.handleEvent(e):s|n.handleEvent(e)),Ct.notify(t,"afterEvent",[e]);var i=t._bufferedRequest;return i?t.render(i):s&&!t.animating&&(t.stop(),t.render({duration:t.options.hover.animationDuration,lazy:!0})),t._bufferedRender=!1,t._bufferedRequest=null,t}},handleEvent:function(e){var t,n=this,s=n.options||{},i=s.hover;return n.lastActive=n.lastActive||[],"mouseout"===e.type?n.active=[]:n.active=n.getElementsAtEventForMode(e,i.mode,i),V.callback(s.onHover||s.hover.onHover,[e.native,n.active],n),"mouseup"!==e.type&&"click"!==e.type||s.onClick&&s.onClick.call(n,e.native,n.active),
n.lastActive.length&&n.updateHoverStyle(n.lastActive,i.mode,!1),n.active.length&&i.mode&&n.updateHoverStyle(n.active,i.mode,!0),t=!V.arrayEquals(n.active,n.lastActive),n.lastActive=n.active,t}}),jt.instances={};var zt=jt;function Yt(){throw new Error("This method is not implemented: either no adapter can be found or an incomplete integration was provided.")}function Xt(e){this.options=e||{}}(jt.Controller=jt).types={},V.configMerge=Wt,V.scaleMerge=Ut,V.extend(Xt.prototype,{formats:Yt,parse:Yt,format:Yt,add:Yt,diff:Yt,startOf:Yt,endOf:Yt,_create:function(e){return e}}),Xt.override=function(e){V.extend(Xt.prototype,e)};var Kt={_date:Xt},qt={formatters:{values:function(e){return V.isArray(e)?e:""+e},linear:function(e,t,n){var s=3<n.length?n[2]-n[1]:n[1]-n[0];1<Math.abs(s)&&e!==Math.floor(e)&&(s=e-Math.floor(e));var i=V.log10(Math.abs(s)),o="";if(0!==e)if(Math.max(Math.abs(n[0]),Math.abs(n[n.length-1]))<1e-4){var r=V.log10(Math.abs(e)),a=Math.floor(r)-Math.floor(i);a=Math.max(Math.min(a,20
),0),o=e.toExponential(a)}else{var c=-1*Math.floor(i);c=Math.max(Math.min(c,20),0),o=e.toFixed(c)}else o="0";return o},logarithmic:function(e,t,n){var s=e/Math.pow(10,Math.floor(V.log10(e)));return 0===e?"0":1===s||2===s||5===s||0===t||t===n.length-1?e.toExponential():""}}},Zt=V.isArray,Qt=V.isNullOrUndef,Jt=V.valueOrDefault,$t=V.valueAtIndexOrDefault;function en(e,t,n){var s,i=e.getTicks().length,o=Math.min(t,i-1),r=e.getPixelForTick(o),a=e._startPixel,c=e._endPixel;if(!(n&&(s=1===i?Math.max(r-a,c-r):0===t?(e.getPixelForTick(1)-r)/2:(r-e.getPixelForTick(o-1))/2,(r+=o<t?s:-s)<a-1e-6||c+1e-6<r)))return r}function tn(e){return e.drawTicks?e.tickMarkLength:0}function nn(e){var t,n;return e.display?(t=V.options._parseFont(e),n=V.options.toPadding(e.padding),t.lineHeight+n.height):0}function sn(e,t){return V.extend(V.options._parseFont({fontFamily:Jt(t.fontFamily,e.fontFamily),fontSize:Jt(t.fontSize,e.fontSize),fontStyle:Jt(t.fontStyle,e.fontStyle),lineHeight:Jt(t.lineHeight,e.lineHeight)})
,{color:V.options.resolve([t.fontColor,e.fontColor,B.global.defaultFontColor])})}function on(e){var t=sn(e,e.minor);return{minor:t,major:e.major.enabled?sn(e,e.major):t}}function rn(e){var t,n,s,i=[];for(n=0,s=e.length;n<s;++n)void 0!==(t=e[n])._index&&i.push(t);return i}function an(e,t,n,s){var i,o,r,a,c=Jt(n,0),l=Math.min(Jt(s,e.length),e.length),p=0;for(t=Math.ceil(t),s&&(t=(i=s-n)/Math.floor(i/t)),a=c;a<0;)p++,a=Math.round(c+p*t);for(o=Math.max(c,0);o<l;o++)r=e[o],o===a?(r._index=o,p++,a=Math.round(c+p*t)):delete r.label}B._set("scale",{display:!0,position:"left",offset:!1,gridLines:{display:!0,color:"rgba(0,0,0,0.1)",lineWidth:1,drawBorder:!0,drawOnChartArea:!0,drawTicks:!0,tickMarkLength:10,zeroLineWidth:1,zeroLineColor:"rgba(0,0,0,0.25)",zeroLineBorderDash:[],zeroLineBorderDashOffset:0,offsetGridLines:!1,borderDash:[],borderDashOffset:0},scaleLabel:{display:!1,labelString:"",padding:{top:4,bottom:4}},ticks:{beginAtZero:!1,minRotation:0,maxRotation:50,mirror:!1,padding:0,
reverse:!1,display:!0,autoSkip:!0,autoSkipPadding:0,labelOffset:0,callback:qt.formatters.values,minor:{},major:{}}});var cn=X.extend({zeroLineIndex:0,getPadding:function(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}},getTicks:function(){return this._ticks},_getLabels:function(){var e=this.chart.data;return this.options.labels||(this.isHorizontal()?e.xLabels:e.yLabels)||e.labels||[]},mergeTicksOptions:function(){},beforeUpdate:function(){V.callback(this.options.beforeUpdate,[this])},update:function(e,t,n){var s,i,o,r,a,c=this,l=c.options.ticks,p=l.sampleSize;if(c.beforeUpdate(),c.maxWidth=e,c.maxHeight=t,c.margins=V.extend({left:0,right:0,top:0,bottom:0},n),c._ticks=null,c.ticks=null,c._labelSizes=null,c._maxLabelLines=0,c.longestLabelWidth=0,c.longestTextCache=c.longestTextCache||{},c._gridLineItems=null,c._labelItems=null,c.beforeSetDimensions(),c.setDimensions(),c.afterSetDimensions(),c.beforeDataLimits(),
c.determineDataLimits(),c.afterDataLimits(),c.beforeBuildTicks(),r=c.buildTicks()||[],(!(r=c.afterBuildTicks(r)||r)||!r.length)&&c.ticks)for(r=[],s=0,i=c.ticks.length;s<i;++s)r.push({value:c.ticks[s],major:!1});return a=p<(c._ticks=r).length,o=c._convertTicksToLabels(a?function(e,t){for(var n=[],s=e.length/t,i=0,o=e.length;i<o;i+=s)n.push(e[Math.floor(i)]);return n}(r,p):r),c._configure(),c.beforeCalculateTickRotation(),c.calculateTickRotation(),c.afterCalculateTickRotation(),c.beforeFit(),c.fit(),c.afterFit(),c._ticksToDraw=l.display&&(l.autoSkip||"auto"===l.source)?c._autoSkip(r):r,a&&(o=c._convertTicksToLabels(c._ticksToDraw)),c.ticks=o,c.afterUpdate(),c.minSize},_configure:function(){var e,t,n=this,s=n.options.ticks.reverse;n.isHorizontal()?(e=n.left,t=n.right):(e=n.top,t=n.bottom,s=!s),n._startPixel=e,n._endPixel=t,n._reversePixels=s,n._length=t-e},afterUpdate:function(){V.callback(this.options.afterUpdate,[this])},beforeSetDimensions:function(){V.callback(
this.options.beforeSetDimensions,[this])},setDimensions:function(){var e=this;e.isHorizontal()?(e.width=e.maxWidth,e.left=0,e.right=e.width):(e.height=e.maxHeight,e.top=0,e.bottom=e.height),e.paddingLeft=0,e.paddingTop=0,e.paddingRight=0,e.paddingBottom=0},afterSetDimensions:function(){V.callback(this.options.afterSetDimensions,[this])},beforeDataLimits:function(){V.callback(this.options.beforeDataLimits,[this])},determineDataLimits:V.noop,afterDataLimits:function(){V.callback(this.options.afterDataLimits,[this])},beforeBuildTicks:function(){V.callback(this.options.beforeBuildTicks,[this])},buildTicks:V.noop,afterBuildTicks:function(e){return Zt(e)&&e.length?V.callback(this.options.afterBuildTicks,[this,e]):(this.ticks=V.callback(this.options.afterBuildTicks,[this,this.ticks])||this.ticks,e)},beforeTickToLabelConversion:function(){V.callback(this.options.beforeTickToLabelConversion,[this])},convertTicksToLabels:function(){var e=this.options.ticks;this.ticks=this.ticks.map(
e.userCallback||e.callback,this)},afterTickToLabelConversion:function(){V.callback(this.options.afterTickToLabelConversion,[this])},beforeCalculateTickRotation:function(){V.callback(this.options.beforeCalculateTickRotation,[this])},calculateTickRotation:function(){var e,t,n,s,i,o,r,a=this,c=a.options,l=c.ticks,p=a.getTicks().length,d=l.minRotation||0,u=l.maxRotation,h=d;!a._isVisible()||!l.display||u<=d||p<=1||!a.isHorizontal()?a.labelRotation=d:(t=(e=a._getLabelSizes()).widest.width,n=e.highest.height-e.highest.offset,s=Math.min(a.maxWidth,a.chart.width-t),t+6>(i=c.offset?a.maxWidth/p:s/(p-1))&&(i=s/(p-(c.offset?.5:1)),o=a.maxHeight-tn(c.gridLines)-l.padding-nn(c.scaleLabel),r=Math.sqrt(t*t+n*n),h=V.toDegrees(Math.min(Math.asin(Math.min((e.highest.height+6)/i,1)),Math.asin(Math.min(o/r,1))-Math.asin(n/r))),h=Math.max(d,Math.min(u,h))),a.labelRotation=h)},afterCalculateTickRotation:function(){V.callback(this.options.afterCalculateTickRotation,[this])},beforeFit:function(){V.callback(
this.options.beforeFit,[this])},fit:function(){var e=this,t=e.minSize={width:0,height:0},n=e.chart,s=e.options,i=s.ticks,o=s.scaleLabel,r=s.gridLines,a=e._isVisible(),c="bottom"===s.position,l=e.isHorizontal();if(l?t.width=e.maxWidth:a&&(t.width=tn(r)+nn(o)),l?a&&(t.height=tn(r)+nn(o)):t.height=e.maxHeight,i.display&&a){var p=on(i),d=e._getLabelSizes(),u=d.first,h=d.last,g=d.widest,v=d.highest,m=.4*p.minor.lineHeight,f=i.padding;if(l){var _=0!==e.labelRotation,y=V.toRadians(e.labelRotation),w=Math.cos(y),b=Math.sin(y),T=b*g.width+w*(v.height-(_?v.offset:0))+(_?0:m);t.height=Math.min(e.maxHeight,t.height+T+f);var S,E,C=e.getPixelForTick(0)-e.left,A=e.right-e.getPixelForTick(e.getTicks().length-1);_?(S=c?w*u.width+b*u.offset:b*(u.height-u.offset),E=c?b*(h.height-h.offset):w*h.width+b*h.offset):(S=u.width/2,E=h.width/2),e.paddingLeft=Math.max((S-C)*e.width/(e.width-C),0)+3,e.paddingRight=Math.max((E-A)*e.width/(e.width-A),0)+3}else{var I=i.mirror?0:g.width+f+m;t.width=Math.min(e.maxWidth,
t.width+I),e.paddingTop=u.height/2,e.paddingBottom=h.height/2}}e.handleMargins(),l?(e.width=e._length=n.width-e.margins.left-e.margins.right,e.height=t.height):(e.width=t.width,e.height=e._length=n.height-e.margins.top-e.margins.bottom)},handleMargins:function(){var e=this;e.margins&&(e.margins.left=Math.max(e.paddingLeft,e.margins.left),e.margins.top=Math.max(e.paddingTop,e.margins.top),e.margins.right=Math.max(e.paddingRight,e.margins.right),e.margins.bottom=Math.max(e.paddingBottom,e.margins.bottom))},afterFit:function(){V.callback(this.options.afterFit,[this])},isHorizontal:function(){var e=this.options.position;return"top"===e||"bottom"===e},isFullWidth:function(){return this.options.fullWidth},getRightValue:function(e){if(Qt(e))return NaN;if(("number"==typeof e||e instanceof Number)&&!isFinite(e))return NaN;if(e)if(this.isHorizontal()){if(void 0!==e.x)return this.getRightValue(e.x)}else if(void 0!==e.y)return this.getRightValue(e.y);return e},_convertTicksToLabels:function(e){
var t,n,s;for(this.ticks=e.map(function(e){return e.value}),this.beforeTickToLabelConversion(),t=this.convertTicksToLabels(e)||this.ticks,this.afterTickToLabelConversion(),n=0,s=e.length;n<s;++n)e[n].label=t[n];return t},_getLabelSizes:function(){var e=this._labelSizes;return e||(this._labelSizes=e=function(e,t,n,s){var i,o,r,a,c,l,p,d,u,h,g,v,m,f,_,y=n.length,w=[],b=[],T=[];for(i=0;i<y;++i){if(a=n[i].label,c=n[i].major?t.major:t.minor,e.font=l=c.string,p=s[l]=s[l]||{data:{},gc:[]},d=c.lineHeight,u=h=0,Qt(a)||Zt(a)){if(Zt(a))for(o=0,r=a.length;o<r;++o)g=a[o],Qt(g)||Zt(g)||(u=V.measureText(e,p.data,p.gc,u,g),h+=d)}else u=V.measureText(e,p.data,p.gc,u,a),h=d;w.push(u),b.push(h),T.push(d/2)}function S(e){return{width:w[e]||0,height:b[e]||0,offset:T[e]||0}}return f=s,_=y,V.each(f,function(e){var t,n=e.gc,s=n.length/2;if(_<s){for(t=0;t<s;++t)delete e.data[n[t]];n.splice(0,s)}}),v=w.indexOf(Math.max.apply(null,w)),m=b.indexOf(Math.max.apply(null,b)),{first:S(0),last:S(y-1),widest:S(v),
highest:S(m)}}(this.ctx,on(this.options.ticks),this.getTicks(),this.longestTextCache),this.longestLabelWidth=e.widest.width),e},_parseValue:function(e){var t,n,s,i;return Zt(e)?(t=+this.getRightValue(e[0]),n=+this.getRightValue(e[1]),s=Math.min(t,n),i=Math.max(t,n)):(t=void 0,n=e=+this.getRightValue(e),i=s=e),{min:s,max:i,start:t,end:n}},_getScaleLabel:function(e){var t=this._parseValue(e);return void 0!==t.start?"["+t.start+", "+t.end+"]":+this.getRightValue(e)},getLabelForIndex:V.noop,getPixelForValue:V.noop,getValueForPixel:V.noop,getPixelForTick:function(e){var t=this.options.offset,n=this._ticks.length,s=1/Math.max(n-(t?0:1),1);return e<0||n-1<e?null:this.getPixelForDecimal(e*s+(t?s/2:0))},getPixelForDecimal:function(e){return this._reversePixels&&(e=1-e),this._startPixel+e*this._length},getDecimalForPixel:function(e){var t=(e-this._startPixel)/this._length;return this._reversePixels?1-t:t},getBasePixel:function(){return this.getPixelForValue(this.getBaseValue())},
getBaseValue:function(){var e=this.min,t=this.max;return this.beginAtZero?0:e<0&&t<0?t:0<e&&0<t?e:0},_autoSkip:function(e){var t,n,s,i,o=this.options.ticks,r=this._length,a=o.maxTicksLimit||r/this._tickSize()+1,p=o.major.enabled?function(e){var t,n,s=[];for(t=0,n=e.length;t<n;t++)e[t].major&&s.push(t);return s}(e):[],c=p.length,l=p[0],d=p[c-1];if(a<c)return function(e,t,n){var s,i,o=0,r=t[0];for(n=Math.ceil(n),s=0;s<e.length;s++)i=e[s],s===r?(i._index=s,r=t[++o*n]):delete i.label}(e,p,c/a),rn(e);if(s=function(e,t,n,s){var i,o,r,a,c=function(e){var t,n,s=e.length;if(s<2)return!1;for(n=e[0],t=1;t<s;++t)if(e[t]-e[t-1]!==n)return!1;return n}(p),l=(t.length-1)/s;if(!c)return Math.max(l,1);for(r=0,a=(i=V.math._factorize(c)).length-1;r<a;r++)if((o=i[r])>l)return o;return Math.max(l,1)}(0,e,0,a),0<c){for(t=0,n=c-1;t<n;t++)an(e,s,p[t],p[t+1]);return i=1<c?(d-l)/(c-1):null,an(e,s,V.isNullOrUndef(i)?0:l-i,l),an(e,s,d,V.isNullOrUndef(i)?e.length:d+i),rn(e)}return an(e,s),rn(e)},_tickSize:function(
){var e=this.options.ticks,t=V.toRadians(this.labelRotation),n=Math.abs(Math.cos(t)),s=Math.abs(Math.sin(t)),i=this._getLabelSizes(),o=e.autoSkipPadding||0,r=i?i.widest.width+o:0,a=i?i.highest.height+o:0;return this.isHorizontal()?r*s<a*n?r/n:a/s:a*s<r*n?a/n:r/s},_isVisible:function(){var e,t,n,s=this.chart,i=this.options.display;if("auto"!==i)return!!i;for(e=0,t=s.data.datasets.length;e<t;++e)if(s.isDatasetVisible(e)&&((n=s.getDatasetMeta(e)).xAxisID===this.id||n.yAxisID===this.id))return!0;return!1},_computeGridLineItems:function(e){var t,n,s,i,o,r,a,c,l,p,d,u,h,g,v,m,f,_=this,y=_.chart,w=_.options,b=w.gridLines,T=w.position,S=b.offsetGridLines,E=_.isHorizontal(),C=_._ticksToDraw,A=C.length+(S?1:0),I=tn(b),R=[],L=b.drawBorder?$t(b.lineWidth,0,0):0,O=L/2,P=V._alignPixel,x=function(e){return P(y,e,L)};for("top"===T?(t=x(_.bottom),a=_.bottom-I,l=t-O,d=x(e.top)+O,h=e.bottom):"bottom"===T?(t=x(_.top),d=e.top,h=x(e.bottom)-O,a=t+O,l=_.top+I):"left"===T?(t=x(_.right),r=_.right-I,c=t-O,p=x(
e.left)+O,u=e.right):(t=x(_.left),p=e.left,u=x(e.right)-O,r=t+O,c=_.left+I),n=0;n<A;++n)s=C[n]||{},Qt(s.label)&&n<C.length||(n===_.zeroLineIndex&&w.offset===S?(g=b.zeroLineWidth,v=b.zeroLineColor,m=b.zeroLineBorderDash||[],f=b.zeroLineBorderDashOffset||0):(g=$t(b.lineWidth,n,1),v=$t(b.color,n,"rgba(0,0,0,0.1)"),m=b.borderDash||[],f=b.borderDashOffset||0),void 0!==(i=en(_,s._index||n,S))&&(o=P(y,i,g),E?r=c=p=u=o:a=l=d=h=o,R.push({tx1:r,ty1:a,tx2:c,ty2:l,x1:p,y1:d,x2:u,y2:h,width:g,color:v,borderDash:m,borderDashOffset:f})));return R.ticksLength=A,R.borderValue=t,R},_computeLabelItems:function(){var e,t,n,s,i,o,r,a,c,l,p,d,u=this.options,h=u.ticks,g=u.position,v=h.mirror,m=this.isHorizontal(),f=this._ticksToDraw,_=on(h),y=h.padding,w=tn(u.gridLines),b=-V.toRadians(this.labelRotation),T=[];for("top"===g?(o=this.bottom-w-y,r=b?"left":"center"):"bottom"===g?(o=this.top+w+y,r=b?"right":"center"):"left"===g?(i=this.right-(v?0:w)-y,r=v?"left":"right"):(i=this.left+(v?0:w)+y,r=v?"right":"left")
,e=0,t=f.length;e<t;++e)s=(n=f[e]).label,Qt(s)||(a=this.getPixelForTick(n._index||e)+h.labelOffset,l=(c=n.major?_.major:_.minor).lineHeight,p=Zt(s)?s.length:1,m?(i=a,d="top"===g?((b?1:.5)-p)*l:(b?0:.5)*l):(o=a,d=(1-p)*l/2),T.push({x:i,y:o,rotation:b,label:s,font:c,textOffset:d,textAlign:r}));return T},_drawGrid:function(e){var t=this,n=t.options.gridLines;if(n.display){var s,i,o,r,a,c=t.ctx,l=t.chart,p=V._alignPixel,d=n.drawBorder?$t(n.lineWidth,0,0):0,u=t._gridLineItems||(t._gridLineItems=t._computeGridLineItems(e));for(o=0,r=u.length;o<r;++o)s=(a=u[o]).width,i=a.color,s&&i&&(c.save(),c.lineWidth=s,c.strokeStyle=i,c.setLineDash&&(c.setLineDash(a.borderDash),c.lineDashOffset=a.borderDashOffset),c.beginPath(),n.drawTicks&&(c.moveTo(a.tx1,a.ty1),c.lineTo(a.tx2,a.ty2)),n.drawOnChartArea&&(c.moveTo(a.x1,a.y1),c.lineTo(a.x2,a.y2)),c.stroke(),c.restore());if(d){var h,g,v,m,f=d,_=$t(n.lineWidth,u.ticksLength-1,1),y=u.borderValue;t.isHorizontal()?(h=p(l,t.left,f)-f/2,g=p(l,t.right,_)+_/2,v=m=y
):(v=p(l,t.top,f)-f/2,m=p(l,t.bottom,_)+_/2,h=g=y),c.lineWidth=d,c.strokeStyle=$t(n.color,0),c.beginPath(),c.moveTo(h,v),c.lineTo(g,m),c.stroke()}}},_drawLabels:function(){if(this.options.ticks.display){var e,t,n,s,i,o,r,a,c=this.ctx,l=this._labelItems||(this._labelItems=this._computeLabelItems());for(e=0,n=l.length;e<n;++e){if(o=(i=l[e]).font,c.save(),c.translate(i.x,i.y),c.rotate(i.rotation),c.font=o.string,c.fillStyle=o.color,c.textBaseline="middle",c.textAlign=i.textAlign,r=i.label,a=i.textOffset,Zt(r))for(t=0,s=r.length;t<s;++t)c.fillText(""+r[t],0,a),a+=o.lineHeight;else c.fillText(r,0,a);c.restore()}}},_drawTitle:function(){var e=this,t=e.ctx,n=e.options,s=n.scaleLabel;if(s.display){var i,o,r=Jt(s.fontColor,B.global.defaultFontColor),a=V.options._parseFont(s),c=V.options.toPadding(s.padding),l=a.lineHeight/2,p=n.position,d=0;if(e.isHorizontal())i=e.left+e.width/2,o="bottom"===p?e.bottom-l-c.bottom:e.top+l+c.top;else{var u="left"===p;i=u?e.left+l+c.top:e.right-l-c.top,
o=e.top+e.height/2,d=u?-.5*Math.PI:.5*Math.PI}t.save(),t.translate(i,o),t.rotate(d),t.textAlign="center",t.textBaseline="middle",t.fillStyle=r,t.font=a.string,t.fillText(s.labelString,0,0),t.restore()}},draw:function(e){this._isVisible()&&(this._drawGrid(e),this._drawTitle(),this._drawLabels())},_layers:function(){var e=this,t=e.options,n=t.ticks&&t.ticks.z||0,s=t.gridLines&&t.gridLines.z||0;return e._isVisible()&&n!==s&&e.draw===e._draw?[{z:s,draw:function(){e._drawGrid.apply(e,arguments),e._drawTitle.apply(e,arguments)}},{z:n,draw:function(){e._drawLabels.apply(e,arguments)}}]:[{z:n,draw:function(){e.draw.apply(e,arguments)}}]},_getMatchingVisibleMetas:function(t){var n=this,s=n.isHorizontal();return n.chart._getSortedVisibleDatasetMetas().filter(function(e){return(!t||e.type===t)&&(s?e.xAxisID===n.id:e.yAxisID===n.id)})}});cn.prototype._draw=cn.prototype.draw;var ln=cn,pn=V.isNullOrUndef,dn=ln.extend({determineDataLimits:function(){var e,t=this._getLabels(),n=this.options.ticks,
s=n.min,i=n.max,o=0,r=t.length-1;void 0!==s&&0<=(e=t.indexOf(s))&&(o=e),void 0!==i&&0<=(e=t.indexOf(i))&&(r=e),this.minIndex=o,this.maxIndex=r,this.min=t[o],this.max=t[r]},buildTicks:function(){var e=this._getLabels(),t=this.minIndex,n=this.maxIndex;this.ticks=0===t&&n===e.length-1?e:e.slice(t,n+1)},getLabelForIndex:function(e,t){var n=this.chart;return n.getDatasetMeta(t).controller._getValueScaleId()===this.id?this.getRightValue(n.data.datasets[t].data[e]):this._getLabels()[e]},_configure:function(){var e=this.options.offset,t=this.ticks;ln.prototype._configure.call(this),this.isHorizontal()||(this._reversePixels=!this._reversePixels),t&&(this._startValue=this.minIndex-(e?.5:0),this._valueRange=Math.max(t.length-(e?0:1),1))},getPixelForValue:function(e,t,n){var s,i,o;return pn(t)||pn(n)||(e=this.chart.data.datasets[n].data[t]),pn(e)||(s=this.isHorizontal()?e.x:e.y),(void 0!==s||void 0!==e&&isNaN(t))&&(i=this._getLabels(),e=V.valueOrDefault(s,e),t=-1!==(o=i.indexOf(e))?o:t,isNaN(t)&&(
t=e)),this.getPixelForDecimal((t-this._startValue)/this._valueRange)},getPixelForTick:function(e){var t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e],e+this.minIndex)},getValueForPixel:function(e){var t=Math.round(this._startValue+this.getDecimalForPixel(e)*this._valueRange);return Math.min(Math.max(t,0),this.ticks.length-1)},getBasePixel:function(){return this.bottom}});dn._defaults={position:"bottom"};var un=V.noop,hn=V.isNullOrUndef,gn=ln.extend({getRightValue:function(e){return"string"==typeof e?+e:ln.prototype.getRightValue.call(this,e)},handleTickRangeOptions:function(){var e=this,t=e.options.ticks;if(t.beginAtZero){var n=V.sign(e.min),s=V.sign(e.max);n<0&&s<0?e.max=0:0<n&&0<s&&(e.min=0)}var i=void 0!==t.min||void 0!==t.suggestedMin,o=void 0!==t.max||void 0!==t.suggestedMax;void 0!==t.min?e.min=t.min:void 0!==t.suggestedMin&&(null===e.min?e.min=t.suggestedMin:e.min=Math.min(e.min,t.suggestedMin)),void 0!==t.max?e.max=t.max:void 0!==t.suggestedMax&&(
null===e.max?e.max=t.suggestedMax:e.max=Math.max(e.max,t.suggestedMax)),i!==o&&e.min>=e.max&&(i?e.max=e.min+1:e.min=e.max-1),e.min===e.max&&(e.max++,t.beginAtZero||e.min--)},getTickLimit:function(){var e,t=this.options.ticks,n=t.stepSize,s=t.maxTicksLimit;return n?e=Math.ceil(this.max/n)-Math.floor(this.min/n)+1:(e=this._computeTickLimit(),s=s||11),s&&(e=Math.min(s,e)),e},_computeTickLimit:function(){return Number.POSITIVE_INFINITY},handleDirectionalChanges:un,buildTicks:function(){var e=this,t=e.options.ticks,n=e.getTickLimit(),f={maxTicks:n=Math.max(2,n),min:t.min,max:t.max,precision:t.precision,stepSize:V.valueOrDefault(t.fixedStepSize,t.stepSize)},s=e.ticks=function(e,t){var n,s,i,o,r=[],a=f.stepSize,c=a||1,l=f.maxTicks-1,p=f.min,d=f.max,u=f.precision,h=t.min,g=t.max,v=V.niceNum((g-h)/l/c)*c;if(v<1e-14&&hn(p)&&hn(d))return[h,g];(o=Math.ceil(g/v)-Math.floor(h/v))>l&&(v=V.niceNum(o*v/l/c)*c),a||hn(u)?n=Math.pow(10,V._decimalPlaces(v)):(n=Math.pow(10,u),v=Math.ceil(v*n)/n),
s=Math.floor(h/v)*v,i=Math.ceil(g/v)*v,a&&(!hn(p)&&V.almostWhole(p/v,v/1e3)&&(s=p),!hn(d)&&V.almostWhole(d/v,v/1e3)&&(i=d)),o=(i-s)/v,o=V.almostEquals(o,Math.round(o),v/1e3)?Math.round(o):Math.ceil(o),s=Math.round(s*n)/n,i=Math.round(i*n)/n,r.push(hn(p)?s:p);for(var m=1;m<o;++m)r.push(Math.round((s+m*v)*n)/n);return r.push(hn(d)?i:d),r}(0,e);e.handleDirectionalChanges(),e.max=V.max(s),e.min=V.min(s),t.reverse?(s.reverse(),e.start=e.max,e.end=e.min):(e.start=e.min,e.end=e.max)},convertTicksToLabels:function(){this.ticksAsNumbers=this.ticks.slice(),this.zeroLineIndex=this.ticks.indexOf(0),ln.prototype.convertTicksToLabels.call(this)},_configure:function(){var e,t=this.getTicks(),n=this.min,s=this.max;ln.prototype._configure.call(this),this.options.offset&&t.length&&(n-=e=(s-n)/Math.max(t.length-1,1)/2,s+=e),this._startValue=n,this._endValue=s,this._valueRange=s-n}}),vn={position:"left",ticks:{callback:qt.formatters.linear}};function mn(e,t,n,s){var i,o,r,a,c,l,p=e.options,d=(r=t,
a=p.stacked,l=[(c=n).type,void 0===a&&void 0===c.stack?c.index:"",c.stack].join("."),void 0===r[l]&&(r[l]={pos:[],neg:[]}),r[l]),u=d.pos,h=d.neg,g=s.length;for(i=0;i<g;++i)o=e._parseValue(s[i]),isNaN(o.min)||isNaN(o.max)||n.data[i].hidden||(u[i]=u[i]||0,h[i]=h[i]||0,p.relativePoints?u[i]=100:o.min<0||o.max<0?h[i]+=o.min:u[i]+=o.max)}function fn(e,t,n){var s,i,o=n.length;for(s=0;s<o;++s)i=e._parseValue(n[s]),isNaN(i.min)||isNaN(i.max)||t.data[s].hidden||(e.min=Math.min(e.min,i.min),e.max=Math.max(e.max,i.max))}var _n=gn.extend({determineDataLimits:function(){var e,t,n,s,i=this,o=i.options,r=i.chart.data.datasets,a=i._getMatchingVisibleMetas(),c=o.stacked,l={},p=a.length;if(i.min=Number.POSITIVE_INFINITY,i.max=Number.NEGATIVE_INFINITY,void 0===c)for(e=0;!c&&e<p;++e)c=void 0!==(t=a[e]).stack;for(e=0;e<p;++e)n=r[(t=a[e]).index].data,c?mn(i,l,t,n):fn(i,t,n);V.each(l,function(e){s=e.pos.concat(e.neg),i.min=Math.min(i.min,V.min(s)),i.max=Math.max(i.max,V.max(s))}),i.min=V.isFinite(i.min
)&&!isNaN(i.min)?i.min:0,i.max=V.isFinite(i.max)&&!isNaN(i.max)?i.max:1,i.handleTickRangeOptions()},_computeTickLimit:function(){var e;return this.isHorizontal()?Math.ceil(this.width/40):(e=V.options._parseFont(this.options.ticks),Math.ceil(this.height/e.lineHeight))},handleDirectionalChanges:function(){this.isHorizontal()||this.ticks.reverse()},getLabelForIndex:function(e,t){return this._getScaleLabel(this.chart.data.datasets[t].data[e])},getPixelForValue:function(e){return this.getPixelForDecimal((+this.getRightValue(e)-this._startValue)/this._valueRange)},getValueForPixel:function(e){return this._startValue+this.getDecimalForPixel(e)*this._valueRange},getPixelForTick:function(e){var t=this.ticksAsNumbers;return e<0||e>t.length-1?null:this.getPixelForValue(t[e])}}),yn=vn;_n._defaults=yn;var wn=V.valueOrDefault,bn=V.math.log10,Tn={position:"left",ticks:{callback:qt.formatters.logarithmic}};function Sn(e,t){return V.isFinite(e)&&0<=e?e:t}var En=ln.extend({determineDataLimits:function(
){var e,t,n,s,i,o,r=this,a=r.options,c=r.chart,l=c.data.datasets,p=r.isHorizontal();function d(e){return p?e.xAxisID===r.id:e.yAxisID===r.id}r.min=Number.POSITIVE_INFINITY,r.max=Number.NEGATIVE_INFINITY,r.minNotZero=Number.POSITIVE_INFINITY;var u=a.stacked;if(void 0===u)for(e=0;e<l.length;e++)if(t=c.getDatasetMeta(e),c.isDatasetVisible(e)&&d(t)&&void 0!==t.stack){u=!0;break}if(a.stacked||u){var h={};for(e=0;e<l.length;e++){var g=[(t=c.getDatasetMeta(e)).type,void 0===a.stacked&&void 0===t.stack?e:"",t.stack].join(".");if(c.isDatasetVisible(e)&&d(t))for(void 0===h[g]&&(h[g]=[]),i=0,o=(s=l[e].data).length;i<o;i++){var v=h[g];n=r._parseValue(s[i]),isNaN(n.min)||isNaN(n.max)||t.data[i].hidden||n.min<0||n.max<0||(v[i]=v[i]||0,v[i]+=n.max)}}V.each(h,function(e){if(0<e.length){var t=V.min(e),n=V.max(e);r.min=Math.min(r.min,t),r.max=Math.max(r.max,n)}})}else for(e=0;e<l.length;e++)if(t=c.getDatasetMeta(e),c.isDatasetVisible(e)&&d(t))for(i=0,o=(s=l[e].data).length;i<o;i++)n=r._parseValue(s[i]),
isNaN(n.min)||isNaN(n.max)||t.data[i].hidden||n.min<0||n.max<0||(r.min=Math.min(n.min,r.min),r.max=Math.max(n.max,r.max),0!==n.min&&(r.minNotZero=Math.min(n.min,r.minNotZero)));r.min=V.isFinite(r.min)?r.min:null,r.max=V.isFinite(r.max)?r.max:null,r.minNotZero=V.isFinite(r.minNotZero)?r.minNotZero:null,this.handleTickRangeOptions()},handleTickRangeOptions:function(){var e=this,t=e.options.ticks;e.min=Sn(t.min,e.min),e.max=Sn(t.max,e.max),e.min===e.max&&(0!==e.min&&null!==e.min?(e.min=Math.pow(10,Math.floor(bn(e.min))-1),e.max=Math.pow(10,Math.floor(bn(e.max))+1)):(e.min=1,e.max=10)),null===e.min&&(e.min=Math.pow(10,Math.floor(bn(e.max))-1)),null===e.max&&(e.max=0!==e.min?Math.pow(10,Math.floor(bn(e.min))+1):10),null===e.minNotZero&&(0<e.min?e.minNotZero=e.min:e.max<1?e.minNotZero=Math.pow(10,Math.floor(bn(e.max))):e.minNotZero=1)},buildTicks:function(){var e=this,t=e.options.ticks,n=!e.isHorizontal(),s={min:Sn(t.min),max:Sn(t.max)},i=e.ticks=function(e,t){var n,s,i=[],o=wn(e.min,
Math.pow(10,Math.floor(bn(t.min)))),r=Math.floor(bn(t.max)),a=Math.ceil(t.max/Math.pow(10,r));0===o?(n=Math.floor(bn(t.minNotZero)),s=Math.floor(t.minNotZero/Math.pow(10,n)),i.push(o),o=s*Math.pow(10,n)):(n=Math.floor(bn(o)),s=Math.floor(o/Math.pow(10,n)));for(var c=n<0?Math.pow(10,Math.abs(n)):1;i.push(o),10==++s&&(s=1,c=0<=++n?1:c),o=Math.round(s*Math.pow(10,n)*c)/c,n<r||n===r&&s<a;);var l=wn(e.max,o);return i.push(l),i}(s,e);e.max=V.max(i),e.min=V.min(i),t.reverse?(n=!n,e.start=e.max,e.end=e.min):(e.start=e.min,e.end=e.max),n&&i.reverse()},convertTicksToLabels:function(){this.tickValues=this.ticks.slice(),ln.prototype.convertTicksToLabels.call(this)},getLabelForIndex:function(e,t){return this._getScaleLabel(this.chart.data.datasets[t].data[e])},getPixelForTick:function(e){var t=this.tickValues;return e<0||e>t.length-1?null:this.getPixelForValue(t[e])},_getFirstTickValue:function(e){var t=Math.floor(bn(e));return Math.floor(e/Math.pow(10,t))*Math.pow(10,t)},_configure:function(){
var e=this,t=e.min,n=0;ln.prototype._configure.call(e),0===t&&(t=e._getFirstTickValue(e.minNotZero),n=wn(e.options.ticks.fontSize,B.global.defaultFontSize)/e._length),e._startValue=bn(t),e._valueOffset=n,e._valueRange=(bn(e.max)-bn(t))/(1-n)},getPixelForValue:function(e){var t=0;return(e=+this.getRightValue(e))>this.min&&0<e&&(t=(bn(e)-this._startValue)/this._valueRange+this._valueOffset),this.getPixelForDecimal(t)},getValueForPixel:function(e){var t=this.getDecimalForPixel(e);return 0===t&&0===this.min?0:Math.pow(10,this._startValue+(t-this._valueOffset)*this._valueRange)}}),Cn=Tn;En._defaults=Cn;var An=V.valueOrDefault,In=V.valueAtIndexOrDefault,Rn=V.options.resolve,Ln={display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,color:"rgba(0,0,0,0.1)",lineWidth:1,borderDash:[],borderDashOffset:0},gridLines:{circular:!1},ticks:{showLabelBackdrop:!0,backdropColor:"rgba(255,255,255,0.75)",backdropPaddingY:2,backdropPaddingX:2,callback:qt.formatters.linear},pointLabels:{
display:!0,fontSize:10,callback:function(e){return e}}};function On(e){var t=e.ticks;return t.display&&e.display?An(t.fontSize,B.global.defaultFontSize)+2*t.backdropPaddingY:0}function Pn(e,t,n,s,i){return e===s||e===i?{start:t-n/2,end:t+n/2}:e<s||i<e?{start:t-n,end:t}:{start:t,end:t+n}}function xn(e,t,n,s){var i,o,r=n.y+s/2;if(V.isArray(t))for(i=0,o=t.length;i<o;++i)e.fillText(t[i],n.x,r),r+=s;else e.fillText(t,n.x,r)}function kn(e){return V.isNumber(e)?e:0}var Mn=gn.extend({setDimensions:function(){var e=this;e.width=e.maxWidth,e.height=e.maxHeight,e.paddingTop=On(e.options)/2,e.xCenter=Math.floor(e.width/2),e.yCenter=Math.floor((e.height-e.paddingTop)/2),e.drawingArea=Math.min(e.height-e.paddingTop,e.width)/2},determineDataLimits:function(){var i=this,n=i.chart,o=Number.POSITIVE_INFINITY,r=Number.NEGATIVE_INFINITY;V.each(n.data.datasets,function(e,t){if(n.isDatasetVisible(t)){var s=n.getDatasetMeta(t);V.each(e.data,function(e,t){var n=+i.getRightValue(e);isNaN(n
)||s.data[t].hidden||(o=Math.min(n,o),r=Math.max(n,r))})}}),i.min=o===Number.POSITIVE_INFINITY?0:o,i.max=r===Number.NEGATIVE_INFINITY?0:r,i.handleTickRangeOptions()},_computeTickLimit:function(){return Math.ceil(this.drawingArea/On(this.options))},convertTicksToLabels:function(){var t=this;gn.prototype.convertTicksToLabels.call(t),t.pointLabels=t.chart.data.labels.map(function(){var e=V.callback(t.options.pointLabels.callback,arguments,t);return e||0===e?e:""})},getLabelForIndex:function(e,t){return+this.getRightValue(this.chart.data.datasets[t].data[e])},fit:function(){var e=this.options;e.display&&e.pointLabels.display?function(e){var t,n,s,i=V.options._parseFont(e.options.pointLabels),o={l:0,r:e.width,t:0,b:e.height-e.paddingTop},r={};e.ctx.font=i.string,e._pointLabelSizes=[];var a,c,l,p=e.chart.data.labels.length;for(t=0;t<p;t++){s=e.getPointPosition(t,e.drawingArea+5),a=e.ctx,c=i.lineHeight,l=e.pointLabels[t],n=V.isArray(l)?{w:V.longestText(a,a.font,l),h:l.length*c}:{
w:a.measureText(l).width,h:c},e._pointLabelSizes[t]=n;var d=e.getIndexAngle(t),u=V.toDegrees(d)%360,h=Pn(u,s.x,n.w,0,180),g=Pn(u,s.y,n.h,90,270);h.start<o.l&&(o.l=h.start,r.l=d),h.end>o.r&&(o.r=h.end,r.r=d),g.start<o.t&&(o.t=g.start,r.t=d),g.end>o.b&&(o.b=g.end,r.b=d)}e.setReductions(e.drawingArea,o,r)}(this):this.setCenterPoint(0,0,0,0)},setReductions:function(e,t,n){var s=t.l/Math.sin(n.l),i=Math.max(t.r-this.width,0)/Math.sin(n.r),o=-t.t/Math.cos(n.t),r=-Math.max(t.b-(this.height-this.paddingTop),0)/Math.cos(n.b);s=kn(s),i=kn(i),o=kn(o),r=kn(r),this.drawingArea=Math.min(Math.floor(e-(s+i)/2),Math.floor(e-(o+r)/2)),this.setCenterPoint(s,i,o,r)},setCenterPoint:function(e,t,n,s){var i=this,o=i.width-t-i.drawingArea,r=e+i.drawingArea,a=n+i.drawingArea,c=i.height-i.paddingTop-s-i.drawingArea;i.xCenter=Math.floor((r+o)/2+i.left),i.yCenter=Math.floor((a+c)/2+i.top+i.paddingTop)},getIndexAngle:function(e){var t=this.chart,n=(e*(360/t.data.labels.length)+((t.options||{}).startAngle||0))%360
;return(n<0?n+360:n)*Math.PI*2/360},getDistanceFromCenterForValue:function(e){if(V.isNullOrUndef(e))return NaN;var t=this.drawingArea/(this.max-this.min);return this.options.ticks.reverse?(this.max-e)*t:(e-this.min)*t},getPointPosition:function(e,t){var n=this.getIndexAngle(e)-Math.PI/2;return{x:Math.cos(n)*t+this.xCenter,y:Math.sin(n)*t+this.yCenter}},getPointPositionForValue:function(e,t){return this.getPointPosition(e,this.getDistanceFromCenterForValue(t))},getBasePosition:function(e){var t=this.min,n=this.max;return this.getPointPositionForValue(e||0,this.beginAtZero?0:t<0&&n<0?n:0<t&&0<n?t:0)},_drawGrid:function(){var e,n,t,s=this,i=s.ctx,o=s.options,r=o.gridLines,a=o.angleLines,c=An(a.lineWidth,r.lineWidth),l=An(a.color,r.color);if(o.pointLabels.display&&function(e){var t,n,s,i,o=e.ctx,r=e.options,a=r.pointLabels,c=On(r),l=e.getDistanceFromCenterForValue(r.ticks.reverse?e.min:e.max),p=V.options._parseFont(a);o.save(),o.font=p.string,o.textBaseline="middle";for(
var d=e.chart.data.labels.length-1;0<=d;d--){var u=0===d?c/2:0,h=e.getPointPosition(d,l+u+5),g=In(a.fontColor,d,B.global.defaultFontColor);o.fillStyle=g;var v=e.getIndexAngle(d),m=V.toDegrees(v);o.textAlign=0===(i=m)||180===i?"center":i<180?"left":"right",t=m,n=e._pointLabelSizes[d],s=h,90===t||270===t?s.y-=n.h/2:(270<t||t<90)&&(s.y-=n.h),xn(o,e.pointLabels[d],h,p.lineHeight)}o.restore()}(s),r.display&&V.each(s.ticks,function(e,t){0!==t&&(n=s.getDistanceFromCenterForValue(s.ticksAsNumbers[t]),function(e,t,n,s){var i,o=e.ctx,r=t.circular,a=e.chart.data.labels.length,c=In(t.color,s-1),l=In(t.lineWidth,s-1);if((r||a)&&c&&l){if(o.save(),o.strokeStyle=c,o.lineWidth=l,o.setLineDash&&(o.setLineDash(t.borderDash||[]),o.lineDashOffset=t.borderDashOffset||0),o.beginPath(),r)o.arc(e.xCenter,e.yCenter,n,0,2*Math.PI);else{i=e.getPointPosition(0,n),o.moveTo(i.x,i.y);for(var p=1;p<a;p++)i=e.getPointPosition(p,n),o.lineTo(i.x,i.y)}o.closePath(),o.stroke(),o.restore()}}(s,r,n,t))}),a.display&&c&&l){
for(i.save(),i.lineWidth=c,i.strokeStyle=l,i.setLineDash&&(i.setLineDash(Rn([a.borderDash,r.borderDash,[]])),i.lineDashOffset=Rn([a.borderDashOffset,r.borderDashOffset,0])),e=s.chart.data.labels.length-1;0<=e;e--)n=s.getDistanceFromCenterForValue(o.ticks.reverse?s.min:s.max),t=s.getPointPosition(e,n),i.beginPath(),i.moveTo(s.xCenter,s.yCenter),i.lineTo(t.x,t.y),i.stroke();i.restore()}},_drawLabels:function(){var n=this,s=n.ctx,i=n.options.ticks;if(i.display){var o,r,e=n.getIndexAngle(0),a=V.options._parseFont(i),c=An(i.fontColor,B.global.defaultFontColor);s.save(),s.font=a.string,s.translate(n.xCenter,n.yCenter),s.rotate(e),s.textAlign="center",s.textBaseline="middle",V.each(n.ticks,function(e,t){(0!==t||i.reverse)&&(o=n.getDistanceFromCenterForValue(n.ticksAsNumbers[t]),i.showLabelBackdrop&&(r=s.measureText(e).width,s.fillStyle=i.backdropColor,s.fillRect(-r/2-i.backdropPaddingX,-o-a.size/2-i.backdropPaddingY,r+2*i.backdropPaddingX,a.size+2*i.backdropPaddingY)),s.fillStyle=c,
s.fillText(e,0,-o))}),s.restore()}},_drawTitle:V.noop}),Nn=Ln;Mn._defaults=Nn;var Bn=V._deprecated,Dn=V.options.resolve,Fn=V.valueOrDefault,Un=Number.MIN_SAFE_INTEGER||-9007199254740991,Wn=Number.MAX_SAFE_INTEGER||9007199254740991,Vn={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},Gn=Object.keys(Vn);function Hn(e,t){return e-t}function jn(e){return V.valueOrDefault(e.time.min,e.ticks.min)}function zn(e){return V.valueOrDefault(e.time.max,e.ticks.max)}function Yn(e,t,n,s){var i=function(e,t,n){for(var s,i,o,r=0,a=e.length-1;0<=r&&r<=a;){if(i=e[(s=r+a>>1)-1]||null,o=e[s],!i)return{lo:null,hi:o};if(o[t]<n)r=s+1;else{if(!(i[t]>n))return{lo:i,hi:o};a=s-1}}return{lo:o,hi:null}}(e,t,n),
o=i.lo?i.hi?i.lo:e[e.length-2]:e[0],r=i.lo?i.hi?i.hi:e[e.length-1]:e[1],a=r[t]-o[t],c=a?(n-o[t])/a:0,l=(r[s]-o[s])*c;return o[s]+l}function Xn(e,t){var n=e._adapter,s=e.options.time,i=s.parser,o=i||s.format,r=t;return"function"==typeof i&&(r=i(r)),V.isFinite(r)||(r="string"==typeof o?n.parse(r,o):n.parse(r)),null!==r?+r:(i||"function"!=typeof o||(r=o(t),V.isFinite(r)||(r=n.parse(r))),r)}function Kn(e,t){if(V.isNullOrUndef(t))return null;var n=e.options.time,s=Xn(e,e.getRightValue(t));return null===s||n.round&&(s=+e._adapter.startOf(s,n.round)),s}function qn(e,t,n,s){var i,o,r,a=Gn.length;for(i=Gn.indexOf(e);i<a-1;++i)if(r=(o=Vn[Gn[i]]).steps?o.steps:Wn,o.common&&Math.ceil((n-t)/(r*o.size))<=s)return Gn[i];return Gn[a-1]}function Zn(l,e,t){var n,s,i=[],o={},r=e.length;for(n=0;n<r;++n)o[s=e[n]]=n,i.push({value:s,major:!1});return 0!==r&&t?function(e,t,n,s){var i,o,r=l._adapter,a=+r.startOf(t[0].value,s),c=t[t.length-1].value;for(i=a;i<=c;i=+r.add(i,1,s))0<=(o=n[i])&&(t[o].major=!0)
;return t}(0,i,o,t):i}var Qn=ln.extend({initialize:function(){this.mergeTicksOptions(),ln.prototype.initialize.call(this)},update:function(){var e=this.options,t=e.time||(e.time={}),n=this._adapter=new Kt._date(e.adapters.date);return Bn("time scale",t.format,"time.format","time.parser"),Bn("time scale",t.min,"time.min","ticks.min"),Bn("time scale",t.max,"time.max","ticks.max"),V.mergeIf(t.displayFormats,n.formats()),ln.prototype.update.apply(this,arguments)},getRightValue:function(e){return e&&void 0!==e.t&&(e=e.t),ln.prototype.getRightValue.call(this,e)},determineDataLimits:function(){var e,t,n,s,i,o,r,a=this,c=a.chart,l=a._adapter,p=a.options,d=p.time.unit||"day",u=Wn,h=Un,g=[],v=[],m=[],f=a._getLabels();for(e=0,n=f.length;e<n;++e)m.push(Kn(a,f[e]));for(e=0,n=(c.data.datasets||[]).length;e<n;++e)if(c.isDatasetVisible(e))if(i=c.data.datasets[e].data,V.isObject(i[0]))for(v[e]=[],t=0,s=i.length;t<s;++t)o=Kn(a,i[t]),g.push(o),v[e][t]=o;else v[e]=m.slice(0),r||(g=g.concat(m),r=!0
);else v[e]=[];m.length&&(u=Math.min(u,m[0]),h=Math.max(h,m[m.length-1])),g.length&&(g=1<n?function(e){var t,n,s,i={},o=[];for(t=0,n=e.length;t<n;++t)i[s=e[t]]||(i[s]=!0,o.push(s));return o}(g).sort(Hn):g.sort(Hn),u=Math.min(u,g[0]),h=Math.max(h,g[g.length-1])),u=Kn(a,jn(p))||u,h=Kn(a,zn(p))||h,u=u===Wn?+l.startOf(Date.now(),d):u,h=h===Un?+l.endOf(Date.now(),d)+1:h,a.min=Math.min(u,h),a.max=Math.max(u+1,h),a._table=[],a._timestamps={data:g,datasets:v,labels:m}},buildTicks:function(){var e,t,n,s,i,o,r,a,c,l=this,p=l.min,d=l.max,u=l.options,h=u.ticks,g=u.time,v=l._timestamps,m=[],f=l.getLabelCapacity(p),_=h.source,y=u.distribution;for(v="data"===_||"auto"===_&&"series"===y?v.data:"labels"===_?v.labels:function(e,t,n,s){var i,o=e._adapter,r=e.options,a=r.time,c=a.unit||qn(a.minUnit,t,n,s),l=Dn([a.stepSize,a.unitStepSize,1]),p="week"===c&&a.isoWeekday,d=t,u=[];if(p&&(d=+o.startOf(d,"isoWeek",p)),d=+o.startOf(d,p?"day":c),o.diff(n,t,c)>1e5*l
)throw t+" and "+n+" are too far apart with stepSize of "+l+" "+c;for(i=d;i<n;i=+o.add(i,l,c))u.push(i);return i!==n&&"ticks"!==r.bounds||u.push(i),u}(l,p,d,f),"ticks"===u.bounds&&v.length&&(p=v[0],d=v[v.length-1]),p=Kn(l,jn(u))||p,d=Kn(l,zn(u))||d,e=0,t=v.length;e<t;++e)(n=v[e])>=p&&n<=d&&m.push(n);return l.min=p,l.max=d,l._unit=g.unit||(h.autoSkip?qn(g.minUnit,l.min,l.max,f):function(e,t,n,s,i){var o,r;for(o=Gn.length-1;o>=Gn.indexOf(n);o--)if(r=Gn[o],Vn[r].common&&e._adapter.diff(i,s,r)>=t-1)return r;return Gn[n?Gn.indexOf(n):0]}(l,m.length,g.minUnit,l.min,l.max)),l._majorUnit=h.major.enabled&&"year"!==l._unit?function(e){for(var t=Gn.indexOf(e)+1,n=Gn.length;t<n;++t)if(Vn[Gn[t]].common)return Gn[t]}(l._unit):void 0,l._table=function(e,t,n,s){if("linear"===y||!e.length)return[{time:t,pos:0},{time:n,pos:1}];var i,o,r,a,c,l=[],p=[t];for(i=0,o=e.length;i<o;++i)(a=e[i])>t&&a<n&&p.push(a);for(p.push(n),i=0,o=p.length;i<o;++i)c=p[i+1],r=p[i-1],a=p[i],void 0!==r&&void 0!==c&&Math.round((
c+r)/2)===a||l.push({time:a,pos:i/(o-1)});return l}(l._timestamps.data,p,d),l._offsets=(s=l._table,i=m,c=a=0,u.offset&&i.length&&(o=Yn(s,"time",i[0],"pos"),a=1===i.length?1-o:(Yn(s,"time",i[1],"pos")-o)/2,r=Yn(s,"time",i[i.length-1],"pos"),c=1===i.length?r:(r-Yn(s,"time",i[i.length-2],"pos"))/2),{start:a,end:c,factor:1/(a+1+c)}),h.reverse&&m.reverse(),Zn(l,m,l._majorUnit)},getLabelForIndex:function(e,t){var n=this._adapter,s=this.chart.data,i=this.options.time,o=s.labels&&e<s.labels.length?s.labels[e]:"",r=s.datasets[t].data[e];return V.isObject(r)&&(o=this.getRightValue(r)),i.tooltipFormat?n.format(Xn(this,o),i.tooltipFormat):"string"==typeof o?o:n.format(Xn(this,o),i.displayFormats.datetime)},tickFormatFunction:function(e,t,n,s){var i=this._adapter,o=this.options,r=o.time.displayFormats,a=r[this._unit],c=this._majorUnit,l=r[c],p=n[t],d=o.ticks,u=c&&l&&p&&p.major,h=i.format(e,s||(u?l:a)),g=u?d.major:d.minor,v=Dn([g.callback,g.userCallback,d.callback,d.userCallback]);return v?v(h,t,n
):h},convertTicksToLabels:function(e){var t,n,s=[];for(t=0,n=e.length;t<n;++t)s.push(this.tickFormatFunction(e[t].value,t,e));return s},getPixelForOffset:function(e){var t=this._offsets,n=Yn(this._table,"time",e,"pos");return this.getPixelForDecimal((t.start+n)*t.factor)},getPixelForValue:function(e,t,n){var s=null;if(void 0!==t&&void 0!==n&&(s=this._timestamps.datasets[n][t]),null===s&&(s=Kn(this,e)),null!==s)return this.getPixelForOffset(s)},getPixelForTick:function(e){var t=this.getTicks();return 0<=e&&e<t.length?this.getPixelForOffset(t[e].value):null},getValueForPixel:function(e){var t=this._offsets,n=this.getDecimalForPixel(e)/t.factor-t.end,s=Yn(this._table,"pos",n,"time");return this._adapter._create(s)},_getLabelSize:function(e){var t=this.options.ticks,n=this.ctx.measureText(e).width,s=V.toRadians(this.isHorizontal()?t.maxRotation:t.minRotation),i=Math.cos(s),o=Math.sin(s),r=Fn(t.fontSize,B.global.defaultFontSize);return{w:n*i+r*o,h:n*o+r*i}},getLabelWidth:function(e){
return this._getLabelSize(e).w},getLabelCapacity:function(e){var t=this.options.time,n=t.displayFormats,s=n[t.unit]||n.millisecond,i=this.tickFormatFunction(e,0,Zn(this,[e],this._majorUnit),s),o=this._getLabelSize(i),r=Math.floor(this.isHorizontal()?this.width/o.w:this.height/o.h);return this.options.offset&&r--,0<r?r:1}});Qn._defaults={position:"bottom",distribution:"linear",bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,displayFormat:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{autoSkip:!1,source:"auto",major:{enabled:!1}}};var Jn={category:dn,linear:_n,logarithmic:En,radialLinear:Mn,time:Qn},$n={datetime:"MMM D, YYYY, h:mm:ss a",millisecond:"h:mm:ss.SSS a",second:"h:mm:ss a",minute:"h:mm a",hour:"hA",day:"MMM D",week:"ll",month:"MMM YYYY",quarter:"[Q]Q - YYYY",year:"YYYY"};Kt._date.override("function"==typeof s?{_id:"moment",formats:function(){return $n},parse:function(e,t){return"string"==typeof e&&"string"==typeof t?e=s(e,t):e instanceof s||(e=s(e))
,e.isValid()?e.valueOf():null},format:function(e,t){return s(e).format(t)},add:function(e,t,n){return s(e).add(t,n).valueOf()},diff:function(e,t,n){return s(e).diff(s(t),n)},startOf:function(e,t,n){return e=s(e),"isoWeek"===t?e.isoWeekday(n).valueOf():e.startOf(t).valueOf()},endOf:function(e,t){return s(e).endOf(t).valueOf()},_create:function(e){return s(e)}}:{}),B._set("global",{plugins:{filler:{propagate:!0}}});var es={dataset:function(e){var t=e.fill,n=e.chart,s=n.getDatasetMeta(t),i=s&&n.isDatasetVisible(t)&&s.dataset._children||[],o=i.length||0;return o?function(e,t){return t<o&&i[t]._view||null}:null},boundary:function(e){var n=e.boundary,t=n?n.x:null,s=n?n.y:null;return V.isArray(n)?function(e,t){return n[t]}:function(e){return{x:null===t?e.x:t,y:null===s?e.y:s}}}};function ts(e,t,n){var s,i=e._model||{},o=i.fill;if(void 0===o&&(o=!!i.backgroundColor),!1===o||null===o)return!1;if(!0===o)return"origin";if(s=parseFloat(o,10),isFinite(s)&&Math.floor(s)===s
)return"-"!==o[0]&&"+"!==o[0]||(s=t+s),!(s===t||s<0||n<=s)&&s;switch(o){case"bottom":return"start";case"top":return"end";case"zero":return"origin";case"origin":case"start":case"end":return o;default:return!1}}function ns(e,t,n){var s,i=e[t].fill,o=[t];if(!n)return i;for(;!1!==i&&-1===o.indexOf(i);){if(!isFinite(i))return i;if(!(s=e[i]))return!1;if(s.visible)return i;o.push(i),i=s.fill}return!1}function ss(e){return e&&!e.skip}function is(e,t,n,s,i){var o,r,a,c;if(s&&i){for(e.moveTo(t[0].x,t[0].y),o=1;o<s;++o)V.canvas.lineTo(e,t[o-1],t[o]);if(void 0===n[0].angle)for(e.lineTo(n[i-1].x,n[i-1].y),o=i-1;0<o;--o)V.canvas.lineTo(e,n[o],n[o-1],!0);else for(r=n[0].cx,a=n[0].cy,c=Math.sqrt(Math.pow(n[0].x-r,2)+Math.pow(n[0].y-a,2)),o=i-1;0<o;--o)e.arc(r,a,c,n[o].angle,n[o-1].angle,!0)}}function os(e,t,n,s,i,o){var r,a,c,l,p,d,u,h,g=t.length,v=s.spanGaps,m=[],f=[],_=0,y=0;for(e.beginPath(),r=0,a=g;r<a;++r)p=n(l=t[c=r%g]._view,c,s),d=ss(l),u=ss(p),o&&void 0===h&&d&&(a=g+(h=r+1)),d&&u?(_=m.push(l),
y=f.push(p)):_&&y&&(v?(d&&m.push(l),u&&f.push(p)):(is(e,m,f,_,y),_=y=0,m=[],f=[]));is(e,m,f,_,y),e.closePath(),e.fillStyle=i,e.fill()}var rs={id:"filler",afterDatasetsUpdate:function(e,t){var n,s,i,o,r,a,c,l,p=(e.data.datasets||[]).length,d=t.propagate,u=[];for(s=0;s<p;++s)o=null,(i=(n=e.getDatasetMeta(s)).dataset)&&i._model&&i instanceof _e.Line&&(o={visible:e.isDatasetVisible(s),fill:ts(i,s,p),chart:e,el:i}),n.$filler=o,u.push(o);for(s=0;s<p;++s)(o=u[s])&&(o.fill=ns(u,s,d),o.boundary=((l=o).el._scale||{}).getPointPositionForValue?function(e){var t,n,s,i,o,r=e.el._scale,a=r.options,c=r.chart.data.labels.length,l=e.fill,p=[];if(!c)return null;for(t=a.ticks.reverse?r.max:r.min,n=a.ticks.reverse?r.min:r.max,s=r.getPointPositionForValue(0,t),i=0;i<c;++i)o="start"===l||"end"===l?r.getPointPositionForValue(i,"start"===l?t:n):r.getBasePosition(i),a.gridLines.circular&&(o.cx=s.x,o.cy=s.y,o.angle=r.getIndexAngle(i)-Math.PI/2),p.push(o);return p}(l):function(e){var t,n=e.el._model||{},
s=e.el._scale||{},i=e.fill,o=null;if(isFinite(i))return null;if("start"===i?o=void 0===n.scaleBottom?s.bottom:n.scaleBottom:"end"===i?o=void 0===n.scaleTop?s.top:n.scaleTop:void 0!==n.scaleZero?o=n.scaleZero:s.getBasePixel&&(o=s.getBasePixel()),null!=o){if(void 0!==o.x&&void 0!==o.y)return o;if(V.isFinite(o))return{x:(t=s.isHorizontal())?o:null,y:t?null:o}}return null}(l),o.mapper=(c=void 0,a=(r=o).fill,!(c="dataset")===a?null:(isFinite(a)||(c="boundary"),es[c](r))))},beforeDatasetsDraw:function(e){var t,n,s,i,o,r,a,c=e._getSortedVisibleDatasetMetas(),l=e.ctx;for(n=c.length-1;0<=n;--n)(t=c[n].$filler)&&t.visible&&(i=(s=t.el)._view,o=s._children||[],r=t.mapper,a=i.backgroundColor||B.global.defaultColor,r&&a&&o.length&&(V.canvas.clipArea(l,e.chartArea),os(l,o,r,i,a,s._loop),V.canvas.unclipArea(l)))}},as=V.rtl.getRtlAdapter,cs=V.noop,ls=V.valueOrDefault;function ps(e,t){return e.usePointStyle&&e.boxWidth>t?t:e.boxWidth}B._set("global",{legend:{display:!0,position:"top",align:"center",
fullWidth:!0,reverse:!1,weight:1e3,onClick:function(e,t){var n=t.datasetIndex,s=this.chart,i=s.getDatasetMeta(n);i.hidden=null===i.hidden?!s.data.datasets[n].hidden:null,s.update()},onHover:null,onLeave:null,labels:{boxWidth:40,padding:10,generateLabels:function(n){var s=n.data.datasets,e=n.options.legend||{},i=e.labels&&e.labels.usePointStyle;return n._getSortedDatasetMetas().map(function(e){var t=e.controller.getStyle(i?0:void 0);return{text:s[e.index].label,fillStyle:t.backgroundColor,hidden:!n.isDatasetVisible(e.index),lineCap:t.borderCapStyle,lineDash:t.borderDash,lineDashOffset:t.borderDashOffset,lineJoin:t.borderJoinStyle,lineWidth:t.borderWidth,strokeStyle:t.borderColor,pointStyle:t.pointStyle,rotation:t.rotation,datasetIndex:e.index}},this)}}},legendCallback:function(e){var t,n,s,i=document.createElement("ul"),o=e.data.datasets;for(i.setAttribute("class",e.id+"-legend"),t=0,n=o.length;t<n;t++)(s=i.appendChild(document.createElement("li"))).appendChild(document.createElement(
"span")).style.backgroundColor=o[t].backgroundColor,o[t].label&&s.appendChild(document.createTextNode(o[t].label));return i.outerHTML}});var ds=X.extend({initialize:function(e){V.extend(this,e),this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1},beforeUpdate:cs,update:function(e,t,n){var s=this;return s.beforeUpdate(),s.maxWidth=e,s.maxHeight=t,s.margins=n,s.beforeSetDimensions(),s.setDimensions(),s.afterSetDimensions(),s.beforeBuildLabels(),s.buildLabels(),s.afterBuildLabels(),s.beforeFit(),s.fit(),s.afterFit(),s.afterUpdate(),s.minSize},afterUpdate:cs,beforeSetDimensions:cs,setDimensions:function(){var e=this;e.isHorizontal()?(e.width=e.maxWidth,e.left=0,e.right=e.width):(e.height=e.maxHeight,e.top=0,e.bottom=e.height),e.paddingLeft=0,e.paddingTop=0,e.paddingRight=0,e.paddingBottom=0,e.minSize={width:0,height:0}},afterSetDimensions:cs,beforeBuildLabels:cs,buildLabels:function(){var t=this,n=t.options.labels||{},e=V.callback(n.generateLabels,[t.chart],t)||[]
;n.filter&&(e=e.filter(function(e){return n.filter(e,t.chart.data)})),t.options.reverse&&e.reverse(),t.legendItems=e},afterBuildLabels:cs,beforeFit:cs,fit:function(){var e=this,t=e.options,s=t.labels,n=t.display,i=e.ctx,o=V.options._parseFont(s),r=o.size,a=e.legendHitBoxes=[],c=e.minSize,l=e.isHorizontal();if(l?(c.width=e.maxWidth,c.height=n?10:0):(c.width=n?10:0,c.height=e.maxHeight),n){if(i.font=o.string,l){var p=e.lineWidths=[0],d=0;i.textAlign="left",i.textBaseline="middle",V.each(e.legendItems,function(e,t){var n=ps(s,r)+r/2+i.measureText(e.text).width;(0===t||p[p.length-1]+n+2*s.padding>c.width)&&(d+=r+s.padding,p[p.length-(0<t?0:1)]=0),a[t]={left:0,top:0,width:n,height:r},p[p.length-1]+=n+s.padding}),c.height+=d}else{var u=s.padding,h=e.columnWidths=[],g=e.columnHeights=[],v=s.padding,m=0,f=0;V.each(e.legendItems,function(e,t){var n=ps(s,r)+r/2+i.measureText(e.text).width;0<t&&f+r+2*u>c.height&&(v+=m+s.padding,h.push(m),g.push(f),f=m=0),m=Math.max(m,n),f+=r+u,a[t]={left:0,top:0,
width:n,height:r}}),v+=m,h.push(m),g.push(f),c.width+=v}e.width=c.width,e.height=c.height}else e.width=c.width=e.height=c.height=0},afterFit:cs,isHorizontal:function(){return"top"===this.options.position||"bottom"===this.options.position},draw:function(){var g=this,n=g.options,v=n.labels,e=B.global,m=e.defaultColor,f=e.elements.line,_=g.height,y=g.columnHeights,w=g.width,b=g.lineWidths;if(n.display){var T,S=as(n.rtl,g.left,g.minSize.width),E=g.ctx,t=ls(v.fontColor,e.defaultFontColor),s=V.options._parseFont(v),C=s.size;E.textAlign=S.textAlign("left"),E.textBaseline="middle",E.lineWidth=.5,E.strokeStyle=t,E.fillStyle=t,E.font=s.string;var A=ps(v,C),I=g.legendHitBoxes,R=function(e,t){switch(n.align){case"start":return v.padding;case"end":return e-t;default:return(e-t+v.padding)/2}},L=g.isHorizontal();T=L?{x:g.left+R(w,b[0]),y:g.top+v.padding,line:0}:{x:g.left+v.padding,y:g.top+R(_,y[0]),line:0},V.rtl.overrideTextDirection(g.ctx,n.textDirection);var O=C+v.padding;V.each(g.legendItems,
function(e,t){var n=E.measureText(e.text).width,s=A+C/2+n,i=T.x,o=T.y;S.setWidth(g.minSize.width),L?0<t&&i+s+v.padding>g.left+g.minSize.width&&(o=T.y+=O,T.line++,i=T.x=g.left+R(w,b[T.line])):0<t&&o+O>g.top+g.minSize.height&&(i=T.x=i+g.columnWidths[T.line]+v.padding,T.line++,o=T.y=g.top+R(_,y[T.line]));var r,a,c,l,p,d,u,h=S.x(i);!function(e,t,n){if(!(isNaN(A)||A<=0)){E.save();var s=ls(n.lineWidth,f.borderWidth);if(E.fillStyle=ls(n.fillStyle,m),E.lineCap=ls(n.lineCap,f.borderCapStyle),E.lineDashOffset=ls(n.lineDashOffset,f.borderDashOffset),E.lineJoin=ls(n.lineJoin,f.borderJoinStyle),E.lineWidth=s,E.strokeStyle=ls(n.strokeStyle,m),E.setLineDash&&E.setLineDash(ls(n.lineDash,f.borderDash)),v&&v.usePointStyle){var i=A*Math.SQRT2/2,o=S.xPlus(e,A/2),r=t+C/2;V.canvas.drawPoint(E,n.pointStyle,i,o,r,n.rotation)}else E.fillRect(S.leftForLtr(e,A),t,A,C),0!==s&&E.strokeRect(S.leftForLtr(e,A),t,A,C);E.restore()}}(h,o,e),I[t].left=S.leftForLtr(h,I[t].width),I[t].top=o,r=h,a=o,c=e,l=n,p=C/2,d=S.xPlus(
r,A+p),u=a+p,E.fillText(c.text,d,u),c.hidden&&(E.beginPath(),E.lineWidth=2,E.moveTo(d,u),E.lineTo(S.xPlus(d,l),u),E.stroke()),L?T.x+=s+v.padding:T.y+=O}),V.rtl.restoreTextDirection(g.ctx,n.textDirection)}},_getLegendItemAt:function(e,t){var n,s,i;if(e>=this.left&&e<=this.right&&t>=this.top&&t<=this.bottom)for(i=this.legendHitBoxes,n=0;n<i.length;++n)if(e>=(s=i[n]).left&&e<=s.left+s.width&&t>=s.top&&t<=s.top+s.height)return this.legendItems[n];return null},handleEvent:function(e){var t,n=this.options,s="mouseup"===e.type?"click":e.type;if("mousemove"===s){if(!n.onHover&&!n.onLeave)return}else{if("click"!==s)return;if(!n.onClick)return}t=this._getLegendItemAt(e.x,e.y),"click"===s?t&&n.onClick&&n.onClick.call(this,e.native,t):(n.onLeave&&t!==this._hoveredItem&&(this._hoveredItem&&n.onLeave.call(this,e.native,this._hoveredItem),this._hoveredItem=t),n.onHover&&t&&n.onHover.call(this,e.native,t))}});function us(e,t){var n=new ds({ctx:e.ctx,options:t,chart:e});ct.configure(e,n,t),ct.addBox(e,
n),e.legend=n}var hs={id:"legend",_element:ds,beforeInit:function(e){var t=e.options.legend;t&&us(e,t)},beforeUpdate:function(e){var t=e.options.legend,n=e.legend;t?(V.mergeIf(t,B.global.legend),n?(ct.configure(e,n,t),n.options=t):us(e,t)):n&&(ct.removeBox(e,n),delete e.legend)},afterEvent:function(e,t){var n=e.legend;n&&n.handleEvent(t)}},gs=V.noop;B._set("global",{title:{display:!1,fontStyle:"bold",fullWidth:!0,padding:10,position:"top",text:"",weight:2e3}});var vs=X.extend({initialize:function(e){V.extend(this,e),this.legendHitBoxes=[]},beforeUpdate:gs,update:function(e,t,n){var s=this;return s.beforeUpdate(),s.maxWidth=e,s.maxHeight=t,s.margins=n,s.beforeSetDimensions(),s.setDimensions(),s.afterSetDimensions(),s.beforeBuildLabels(),s.buildLabels(),s.afterBuildLabels(),s.beforeFit(),s.fit(),s.afterFit(),s.afterUpdate(),s.minSize},afterUpdate:gs,beforeSetDimensions:gs,setDimensions:function(){var e=this;e.isHorizontal()?(e.width=e.maxWidth,e.left=0,e.right=e.width):(
e.height=e.maxHeight,e.top=0,e.bottom=e.height),e.paddingLeft=0,e.paddingTop=0,e.paddingRight=0,e.paddingBottom=0,e.minSize={width:0,height:0}},afterSetDimensions:gs,beforeBuildLabels:gs,buildLabels:gs,afterBuildLabels:gs,beforeFit:gs,fit:function(){var e,t=this.options,n=this.minSize={},s=this.isHorizontal();t.display?(e=(V.isArray(t.text)?t.text.length:1)*V.options._parseFont(t).lineHeight+2*t.padding,this.width=n.width=s?this.maxWidth:e,this.height=n.height=s?e:this.maxHeight):this.width=n.width=this.height=n.height=0},afterFit:gs,isHorizontal:function(){var e=this.options.position;return"top"===e||"bottom"===e},draw:function(){var e=this.ctx,t=this.options;if(t.display){var n,s,i,o=V.options._parseFont(t),r=o.lineHeight,a=r/2+t.padding,c=0,l=this.top,p=this.left,d=this.bottom,u=this.right;e.fillStyle=V.valueOrDefault(t.fontColor,B.global.defaultFontColor),e.font=o.string,this.isHorizontal()?(s=p+(u-p)/2,i=l+a,n=u-p):(s="left"===t.position?p+a:u-a,i=l+(d-l)/2,n=d-l,c=Math.PI*(
"left"===t.position?-.5:.5)),e.save(),e.translate(s,i),e.rotate(c),e.textAlign="center",e.textBaseline="middle";var h=t.text;if(V.isArray(h))for(var g=0,v=0;v<h.length;++v)e.fillText(h[v],0,g,n),g+=r;else e.fillText(h,0,0,n);e.restore()}}});function ms(e,t){var n=new vs({ctx:e.ctx,options:t,chart:e});ct.configure(e,n,t),ct.addBox(e,n),e.titleBlock=n}var fs={},_s=rs,ys=hs,ws={id:"title",_element:vs,beforeInit:function(e){var t=e.options.title;t&&ms(e,t)},beforeUpdate:function(e){var t=e.options.title,n=e.titleBlock;t?(V.mergeIf(t,B.global.title),n?(ct.configure(e,n,t),n.options=t):ms(e,t)):n&&(ct.removeBox(e,n),delete e.titleBlock)}};for(var bs in fs.filler=_s,fs.legend=ys,fs.title=ws,zt.helpers=V,function(){function p(e,t,n){var s;return"string"==typeof e?(s=parseInt(e,10),-1!==e.indexOf("%")&&(s=s/100*t.parentNode[n])):s=e,s}function d(e){return null!=e&&"none"!==e}function t(e,t,n){var s=document.defaultView,i=V._getParentNode(e),o=s.getComputedStyle(e)[t],r=s.getComputedStyle(i)[t],
a=d(o),c=d(r),l=Number.POSITIVE_INFINITY;return a||c?Math.min(a?p(o,e,n):l,c?p(r,i,n):l):"none"}V.where=function(e,t){if(V.isArray(e)&&Array.prototype.filter)return e.filter(t);var n=[];return V.each(e,function(e){t(e)&&n.push(e)}),n},V.findIndex=Array.prototype.findIndex?function(e,t,n){return e.findIndex(t,n)}:function(e,t,n){n=void 0===n?e:n;for(var s=0,i=e.length;s<i;++s)if(t.call(n,e[s],s,e))return s;return-1},V.findNextWhere=function(e,t,n){V.isNullOrUndef(n)&&(n=-1);for(var s=n+1;s<e.length;s++){var i=e[s];if(t(i))return i}},V.findPreviousWhere=function(e,t,n){V.isNullOrUndef(n)&&(n=e.length);for(var s=n-1;0<=s;s--){var i=e[s];if(t(i))return i}},V.isNumber=function(e){return!isNaN(parseFloat(e))&&isFinite(e)},V.almostEquals=function(e,t,n){return Math.abs(e-t)<n},V.almostWhole=function(e,t){var n=Math.round(e);return n-t<=e&&e<=n+t},V.max=function(e){return e.reduce(function(e,t){return isNaN(t)?e:Math.max(e,t)},Number.NEGATIVE_INFINITY)},V.min=function(e){return e.reduce(
function(e,t){return isNaN(t)?e:Math.min(e,t)},Number.POSITIVE_INFINITY)},V.sign=Math.sign?function(e){return Math.sign(e)}:function(e){return 0==(e=+e)||isNaN(e)?e:0<e?1:-1},V.toRadians=function(e){return e*(Math.PI/180)},V.toDegrees=function(e){return e*(180/Math.PI)},V._decimalPlaces=function(e){if(V.isFinite(e)){for(var t=1,n=0;Math.round(e*t)/t!==e;)t*=10,n++;return n}},V.getAngleFromPoint=function(e,t){var n=t.x-e.x,s=t.y-e.y,i=Math.sqrt(n*n+s*s),o=Math.atan2(s,n);return o<-.5*Math.PI&&(o+=2*Math.PI),{angle:o,distance:i}},V.distanceBetweenPoints=function(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))},V.aliasPixel=function(e){return e%2==0?0:.5},V._alignPixel=function(e,t,n){var s=e.currentDevicePixelRatio,i=n/2;return Math.round((t-i)*s)/s+i},V.splineCurve=function(e,t,n,s){var i=e.skip?t:e,o=t,r=n.skip?t:n,a=Math.sqrt(Math.pow(o.x-i.x,2)+Math.pow(o.y-i.y,2)),c=Math.sqrt(Math.pow(r.x-o.x,2)+Math.pow(r.y-o.y,2)),l=a/(a+c),p=c/(a+c),d=s*(l=isNaN(l)?0:l),u=s*(
p=isNaN(p)?0:p);return{previous:{x:o.x-d*(r.x-i.x),y:o.y-d*(r.y-i.y)},next:{x:o.x+u*(r.x-i.x),y:o.y+u*(r.y-i.y)}}},V.EPSILON=Number.EPSILON||1e-14,V.splineCurveMonotone=function(e){var t,n,s,i,o,r,a,c,l,p=(e||[]).map(function(e){return{model:e._model,deltaK:0,mK:0}}),d=p.length;for(t=0;t<d;++t)if(!(s=p[t]).model.skip){if(n=0<t?p[t-1]:null,(i=t<d-1?p[t+1]:null)&&!i.model.skip){var u=i.model.x-s.model.x;s.deltaK=0!==u?(i.model.y-s.model.y)/u:0}!n||n.model.skip?s.mK=s.deltaK:!i||i.model.skip?s.mK=n.deltaK:this.sign(n.deltaK)!==this.sign(s.deltaK)?s.mK=0:s.mK=(n.deltaK+s.deltaK)/2}for(t=0;t<d-1;++t)s=p[t],i=p[t+1],s.model.skip||i.model.skip||(V.almostEquals(s.deltaK,0,this.EPSILON)?s.mK=i.mK=0:(o=s.mK/s.deltaK,r=i.mK/s.deltaK,(c=Math.pow(o,2)+Math.pow(r,2))<=9||(a=3/Math.sqrt(c),s.mK=o*a*s.deltaK,i.mK=r*a*s.deltaK)));for(t=0;t<d;++t)(s=p[t]).model.skip||(n=0<t?p[t-1]:null,i=t<d-1?p[t+1]:null,n&&!n.model.skip&&(l=(s.model.x-n.model.x)/3,s.model.controlPointPreviousX=s.model.x-l,
s.model.controlPointPreviousY=s.model.y-l*s.mK),i&&!i.model.skip&&(l=(i.model.x-s.model.x)/3,s.model.controlPointNextX=s.model.x+l,s.model.controlPointNextY=s.model.y+l*s.mK))},V.nextItem=function(e,t,n){return n?t>=e.length-1?e[0]:e[t+1]:t>=e.length-1?e[e.length-1]:e[t+1]},V.previousItem=function(e,t,n){return n?t<=0?e[e.length-1]:e[t-1]:t<=0?e[0]:e[t-1]},V.niceNum=function(e,t){var n=Math.floor(V.log10(e)),s=e/Math.pow(10,n);return(t?s<1.5?1:s<3?2:s<7?5:10:s<=1?1:s<=2?2:s<=5?5:10)*Math.pow(10,n)},V.requestAnimFrame="undefined"==typeof window?function(e){e()}:window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){return window.setTimeout(e,1e3/60)},V.getRelativePosition=function(e,t){var n,s,i=e.originalEvent||e,o=e.target||e.srcElement,r=o.getBoundingClientRect(),a=i.touches;a&&0<a.length?(n=a[0].clientX,s=a[0].clientY):(n=i.clientX,s=i.clientY);var c=parseFloat(
V.getStyle(o,"padding-left")),l=parseFloat(V.getStyle(o,"padding-top")),p=parseFloat(V.getStyle(o,"padding-right")),d=parseFloat(V.getStyle(o,"padding-bottom")),u=r.right-r.left-c-p,h=r.bottom-r.top-l-d;return{x:n=Math.round((n-r.left-c)/u*o.width/t.currentDevicePixelRatio),y:s=Math.round((s-r.top-l)/h*o.height/t.currentDevicePixelRatio)}},V.getConstraintWidth=function(e){return t(e,"max-width","clientWidth")},V.getConstraintHeight=function(e){return t(e,"max-height","clientHeight")},V._calculatePadding=function(e,t,n){return-1<(t=V.getStyle(e,t)).indexOf("%")?n*parseInt(t,10)/100:parseInt(t,10)},V._getParentNode=function(e){var t=e.parentNode;return t&&"[object ShadowRoot]"===t.toString()&&(t=t.host),t},V.getMaximumWidth=function(e){var t=V._getParentNode(e);if(!t)return e.clientWidth;var n=t.clientWidth,s=n-V._calculatePadding(t,"padding-left",n)-V._calculatePadding(t,"padding-right",n),i=V.getConstraintWidth(e);return isNaN(i)?s:Math.min(s,i)},V.getMaximumHeight=function(e){
var t=V._getParentNode(e);if(!t)return e.clientHeight;var n=t.clientHeight,s=n-V._calculatePadding(t,"padding-top",n)-V._calculatePadding(t,"padding-bottom",n),i=V.getConstraintHeight(e);return isNaN(i)?s:Math.min(s,i)},V.getStyle=function(e,t){return e.currentStyle?e.currentStyle[t]:document.defaultView.getComputedStyle(e,null).getPropertyValue(t)},V.retinaScale=function(e,t){var n=e.currentDevicePixelRatio=t||"undefined"!=typeof window&&window.devicePixelRatio||1;if(1!==n){var s=e.canvas,i=e.height,o=e.width;s.height=i*n,s.width=o*n,e.ctx.scale(n,n),s.style.height||s.style.width||(s.style.height=i+"px",s.style.width=o+"px")}},V.fontString=function(e,t,n){return t+" "+e+"px "+n},V.longestText=function(e,t,n,s){var i=(s=s||{}).data=s.data||{},o=s.garbageCollect=s.garbageCollect||[];s.font!==t&&(i=s.data={},o=s.garbageCollect=[],s.font=t),e.font=t;var r,a,c,l,p,d=0,u=n.length;for(r=0;r<u;r++)if(null!=(l=n[r])&&!0!==V.isArray(l))d=V.measureText(e,i,o,d,l);else if(V.isArray(l))for(a=0,
c=l.length;a<c;a++)null==(p=l[a])||V.isArray(p)||(d=V.measureText(e,i,o,d,p));var h=o.length/2;if(h>n.length){for(r=0;r<h;r++)delete i[o[r]];o.splice(0,h)}return d},V.measureText=function(e,t,n,s,i){var o=t[i];return o||(o=t[i]=e.measureText(i).width,n.push(i)),s<o&&(s=o),s},V.numberOfLabelLines=function(e){var t=1;return V.each(e,function(e){V.isArray(e)&&e.length>t&&(t=e.length)}),t},V.color=T?function(e){return e instanceof CanvasGradient&&(e=B.global.defaultColor),T(e)}:function(e){return console.error("Color.js not found!"),e},V.getHoverColor=function(e){return e instanceof CanvasPattern||e instanceof CanvasGradient?e:V.color(e).saturate(.5).darken(.1).rgbString()}}(),zt._adapters=Kt,zt.Animation=q,zt.animationService=Z,zt.controllers=ze,zt.DatasetController=te,zt.defaults=B,zt.Element=X,zt.elements=_e,zt.Interaction=Je,zt.layouts=ct,zt.platform=Et,zt.plugins=Ct,zt.Scale=ln,zt.scaleService=At,zt.Ticks=qt,zt.Tooltip=Dt,zt.helpers.each(Jn,function(e,t){
zt.scaleService.registerScaleType(t,e,e._defaults)}),fs)fs.hasOwnProperty(bs)&&zt.plugins.register(fs[bs]);zt.platform.initialize();var Ts=zt;return"undefined"!=typeof window&&(window.Chart=zt),(zt.Chart=zt).Legend=fs.legend._element,zt.Title=fs.title._element,zt.pluginService=zt.plugins,zt.PluginBase=zt.Element.extend({}),zt.canvasHelpers=zt.helpers.canvas,zt.layoutService=zt.layouts,zt.LinearScaleBase=gn,zt.helpers.each(["Bar","Bubble","Doughnut","Line","PolarArea","Radar","Scatter"],function(n){zt[n]=function(e,t){return new zt(e,zt.helpers.merge(t||{},{type:n.charAt(0).toLowerCase()+n.slice(1)}))}}),Ts}),function o(r,a,c){function l(n,e){if(!a[n]){if(!r[n]){var t="function"==typeof require&&require;if(!e&&t)return t(n,!0);if(p)return p(n,!0);var s=new Error("Cannot find module '"+n+"'");throw s.code="MODULE_NOT_FOUND",s}var i=a[n]={exports:{}};r[n][0].call(i.exports,function(e){var t=r[n][1][e];return l(t||e)},i,i.exports,o,r,a,c)}return a[n].exports}for(
var p="function"==typeof require&&require,e=0;e<c.length;e++)l(c[e]);return l}({1:[function(e,t,n){},{}],2:[function(n,e,t){e.exports=function(e){function s(e){r.decorate(e,"afterDataLimits",function(e,t){e&&e(t),r.adjustScaleRange(t)})}function t(s){return function(e,t){var n=e.annotation.options.drawTime;r.elements(e).filter(function(e){return s===(e.options.drawTime||n)}).forEach(function(e){e.transition(t).draw()})}}var i=e.helpers,r=n("./helpers.js")(e),o=n("./events.js")(e),a=e.Annotation.types;return{beforeInit:function(e){var t=e.options,n=e.annotation={elements:{},options:r.initConfig(t.annotation||{}),onDestroy:[],firstRun:!0,supported:!1};e.ensureScalesHaveIDs(),t.scales&&(n.supported=!0,i.each(t.scales.xAxes,s),i.each(t.scales.yAxes,s))},beforeUpdate:function(s){var i=s.annotation;if(i.supported){i.firstRun?i.firstRun=!1:i.options=r.initConfig(s.options.annotation||{});var o=[];i.options.annotations.forEach(function(e){var t=e.id||r.objectId();if(!i.elements[t]&&a[e.type]){
var n=new a[e.type]({id:t,options:e,chartInstance:s});n.initialize(),i.elements[t]=n,e.id=t,o.push(t)}else i.elements[t]&&o.push(t)}),Object.keys(i.elements).forEach(function(e){-1===o.indexOf(e)&&(i.elements[e].destroy(),delete i.elements[e])})}},afterScaleUpdate:function(e){r.elements(e).forEach(function(e){e.configure()})},beforeDatasetsDraw:t("beforeDatasetsDraw"),afterDatasetsDraw:t("afterDatasetsDraw"),afterDraw:t("afterDraw"),afterInit:function(t){var e=t.annotation.options.events;if(i.isArray(e)&&0<e.length){var n=t.chart.canvas,s=o.dispatcher.bind(t);o.collapseHoverEvents(e).forEach(function(e){i.addEvent(n,e,s),t.annotation.onDestroy.push(function(){i.removeEvent(n,e,s)})})}},destroy:function(e){for(var t=e.annotation.onDestroy;0<t.length;)t.pop()()}}}},{"./events.js":4,"./helpers.js":5}],3:[function(e,t,n){t.exports=function(e){var t=e.helpers;return e.Element.extend({initialize:function(){this.hidden=!1,this.hovering=!1,this._model=t.clone(this._model)||{},
this.setDataLimits()},destroy:function(){},setDataLimits:function(){},configure:function(){},inRange:function(){},getCenterPoint:function(){},getWidth:function(){},getHeight:function(){},getArea:function(){},draw:function(){}})}},{}],4:[function(t,e,n){e.exports=function(e){function p(e){var t=!1,n=e.filter(function(e){switch(e){case"mouseenter":case"mouseover":case"mouseout":case"mouseleave":return!(t=!0);default:return!0}});return t&&-1===n.indexOf("mousemove")&&n.push("mousemove"),n}var d=e.helpers,u=t("./helpers.js")(e);return{dispatcher:function(o){var e=this.annotation,t=u.elements(this),n=d.getRelativePosition(o,this.chart),s=u.getNearestItems(t,n),i=p(e.options.events),r=e.options.dblClickSpeed,a=[],c=u.getEventHandlerName(o.type),l=(s||{}).options;if("mousemove"===o.type&&(s&&!s.hovering?["mouseenter","mouseover"].forEach(function(e){var t=u.getEventHandlerName(e),n=u.createMouseEvent(e,o);s.hovering=!0,"function"==typeof l[t]&&a.push([l[t],n,s])}):s||t.forEach(function(s){if(
s.hovering){s.hovering=!1;var i=s.options;["mouseout","mouseleave"].forEach(function(e){var t=u.getEventHandlerName(e),n=u.createMouseEvent(e,o);"function"==typeof i[t]&&a.push([i[t],n,s])})}})),s&&-1<i.indexOf("dblclick")&&"function"==typeof l.onDblclick){if("click"===o.type&&"function"==typeof l.onClick)return clearTimeout(s.clickTimeout),s.clickTimeout=setTimeout(function(){delete s.clickTimeout,l.onClick.call(s,o)},r),o.stopImmediatePropagation(),void o.preventDefault();"dblclick"===o.type&&s.clickTimeout&&(clearTimeout(s.clickTimeout),delete s.clickTimeout)}s&&"function"==typeof l[c]&&0===a.length&&a.push([l[c],o,s]),0<a.length&&(o.stopImmediatePropagation(),o.preventDefault(),a.forEach(function(e){e[0].call(e[2],e[1])}))},collapseHoverEvents:p}}},{"./helpers.js":5}],5:[function(e,t,n){function s(){}function a(e){var t=e.annotation.elements;return Object.keys(t).map(function(e){return t[e]})}function i(){return Math.random().toString(36).substr(2,6)}function o(e){return null!=e&&(
"number"==typeof e?isFinite(e):!!e)}function c(t,n,s){t["$"+n]||(t[n]?(t["$"+n]=t[n].bind(t),t[n]=function(){var e=[t["$"+n]].concat(Array.prototype.slice.call(arguments));return s.apply(t,e)}):t[n]=function(){var e=[void 0].concat(Array.prototype.slice.call(arguments));return s.apply(t,e)})}function l(e,t){e.forEach(function(e){(t?e[t]:e)()})}function p(e){return"on"+e[0].toUpperCase()+e.substring(1)}function d(t,n){try{return new MouseEvent(t,n)}catch(e){try{var s=document.createEvent("MouseEvent");return s.initMouseEvent(t,n.canBubble,n.cancelable,n.view,n.detail,n.screenX,n.screenY,n.clientX,n.clientY,n.ctrlKey,n.altKey,n.shiftKey,n.metaKey,n.button,n.relatedTarget),s}catch(e){var i=document.createEvent("Event");return i.initEvent(t,n.canBubble,n.cancelable),i}}}t.exports=function(t){var r=t.helpers;return{initConfig:function(e){return e=r.configMerge(t.Annotation.defaults,e),r.isArray(e.annotations)&&e.annotations.forEach(function(e){e.label=r.configMerge(
t.Annotation.labelDefaults,e.label)}),e},elements:a,callEach:l,noop:s,objectId:i,isValid:o,decorate:c,adjustScaleRange:function(e){var t,n,s,i,o,r=(t=e.id,n=a(e.chart),s=e.min,i=e.max,{min:(o=n.filter(function(e){return!!e._model.ranges[t]}).map(function(e){return e._model.ranges[t]})).map(function(e){return Number(e.min)}).reduce(function(e,t){return isFinite(t)&&!isNaN(t)&&t<e?t:e},s),max:o.map(function(e){return Number(e.max)}).reduce(function(e,t){return isFinite(t)&&!isNaN(t)&&e<t?t:e},i)});void 0===e.options.ticks.min&&void 0===e.options.ticks.suggestedMin&&(e.min=r.min),void 0===e.options.ticks.max&&void 0===e.options.ticks.suggestedMax&&(e.max=r.max),e.handleTickRangeOptions&&e.handleTickRangeOptions()},getNearestItems:function(e,i){var o=Number.POSITIVE_INFINITY;return e.filter(function(e){return e.inRange(i.x,i.y)}).reduce(function(e,t){var n=t.getCenterPoint(),s=r.distanceBetweenPoints(i,n);return s<o?(e=[t],o=s):s===o&&e.push(t),e},[]).sort(function(e,t){var n=e.getArea(),
s=t.getArea();return s<n||n<s?n-s:e._index-t._index}).slice(0,1)[0]},getEventHandlerName:p,createMouseEvent:d}}},{}],6:[function(e,t,n){var s=e("chart.js");(s="function"==typeof s?s:window.Chart).Annotation=s.Annotation||{},s.Annotation.drawTimeOptions={afterDraw:"afterDraw",afterDatasetsDraw:"afterDatasetsDraw",beforeDatasetsDraw:"beforeDatasetsDraw"},s.Annotation.defaults={drawTime:"afterDatasetsDraw",dblClickSpeed:350,events:[],annotations:[]},s.Annotation.labelDefaults={backgroundColor:"rgba(0,0,0,0.8)",fontFamily:s.defaults.global.defaultFontFamily,fontSize:s.defaults.global.defaultFontSize,fontStyle:"bold",fontColor:"#fff",xPadding:6,yPadding:6,cornerRadius:6,position:"center",xAdjust:0,yAdjust:0,enabled:!1,content:null},s.Annotation.Element=e("./element.js")(s),s.Annotation.types={line:e("./types/line.js")(s),box:e("./types/box.js")(s)};var i=e("./annotation.js")(s);t.exports=i,s.pluginService.register(i)},{"./annotation.js":2,"./element.js":3,"./types/box.js":7,
"./types/line.js":8,"chart.js":1}],7:[function(t,e,n){e.exports=function(e){var u=t("../helpers.js")(e);return e.Annotation.Element.extend({setDataLimits:function(){var e=this._model,t=this.options,n=this.chartInstance,s=n.scales[t.xScaleID],i=n.scales[t.yScaleID],o=n.chartArea;if(e.ranges={},o){var r=0,a=0;s&&(r=u.isValid(t.xMin)?t.xMin:s.getPixelForValue(o.left),a=u.isValid(t.xMax)?t.xMax:s.getPixelForValue(o.right),e.ranges[t.xScaleID]={min:Math.min(r,a),max:Math.max(r,a)}),i&&(r=u.isValid(t.yMin)?t.yMin:i.getPixelForValue(o.bottom),a=u.isValid(t.yMax)?t.yMax:i.getPixelForValue(o.top),e.ranges[t.yScaleID]={min:Math.min(r,a),max:Math.max(r,a)})}},configure:function(){var e=this._model,t=this.options,n=this.chartInstance,s=n.scales[t.xScaleID],i=n.scales[t.yScaleID],o=n.chartArea;e.clip={x1:o.left,x2:o.right,y1:o.top,y2:o.bottom};var r,a,c=o.left,l=o.top,p=o.right,d=o.bottom;s&&(r=u.isValid(t.xMin)?s.getPixelForValue(t.xMin):o.left,a=u.isValid(t.xMax)?s.getPixelForValue(t.xMax
):o.right,c=Math.min(r,a),p=Math.max(r,a)),i&&(r=u.isValid(t.yMin)?i.getPixelForValue(t.yMin):o.bottom,a=u.isValid(t.yMax)?i.getPixelForValue(t.yMax):o.top,l=Math.min(r,a),d=Math.max(r,a)),e.left=c,e.top=l,e.right=p,e.bottom=d,e.borderColor=t.borderColor,e.borderWidth=t.borderWidth,e.backgroundColor=t.backgroundColor},inRange:function(e,t){var n=this._model;return n&&e>=n.left&&e<=n.right&&t>=n.top&&t<=n.bottom},getCenterPoint:function(){var e=this._model;return{x:(e.right+e.left)/2,y:(e.bottom+e.top)/2}},getWidth:function(){var e=this._model;return Math.abs(e.right-e.left)},getHeight:function(){var e=this._model;return Math.abs(e.bottom-e.top)},getArea:function(){return this.getWidth()*this.getHeight()},draw:function(){var e=this._view,t=this.chartInstance.chart.ctx;t.save(),t.beginPath(),t.rect(e.clip.x1,e.clip.y1,e.clip.x2-e.clip.x1,e.clip.y2-e.clip.y1),t.clip(),t.lineWidth=e.borderWidth,t.strokeStyle=e.borderColor,t.fillStyle=e.backgroundColor;var n=e.right-e.left,s=e.bottom-e.top
;t.fillRect(e.left,e.top,n,s),t.strokeRect(e.left,e.top,n,s),t.restore()}})}},{"../helpers.js":5}],8:[function(t,e,n){e.exports=function(e){function d(t){var n=(t.x2-t.x1)/(t.y2-t.y1),s=t.x1||0;this.m=n,this.b=s,this.getX=function(e){return n*(e-t.y1)+s},this.getY=function(e){return(e-s)/n+t.y1},this.intersects=function(e,t,n){n=n||.001;var s=this.getY(e),i=this.getX(t);return(!isFinite(s)||Math.abs(t-s)<n)&&(!isFinite(i)||Math.abs(e-i)<n)}}var u=e.helpers,h=t("../helpers.js")(e),g="horizontal";return e.Annotation.Element.extend({setDataLimits:function(){var e=this._model,t=this.options;e.ranges={},e.ranges[t.scaleID]={min:t.value,max:t.endValue||t.value}},configure:function(){var e,t,n=this._model,s=this.options,i=this.chartInstance,o=i.chart.ctx,r=i.scales[s.scaleID];if(r&&(e=h.isValid(s.value)?r.getPixelForValue(s.value):NaN,t=h.isValid(s.endValue)?r.getPixelForValue(s.endValue):e),!isNaN(e)){var a=i.chartArea;n.clip={x1:a.left,x2:a.right,y1:a.top,y2:a.bottom},this.options.mode==g?(
n.x1=a.left,n.x2=a.right,n.y1=e,n.y2=t):(n.y1=a.top,n.y2=a.bottom,n.x1=e,n.x2=t),n.line=new d(n),n.mode=s.mode,n.labelBackgroundColor=s.label.backgroundColor,n.labelFontFamily=s.label.fontFamily,n.labelFontSize=s.label.fontSize,n.labelFontStyle=s.label.fontStyle,n.labelFontColor=s.label.fontColor,n.labelXPadding=s.label.xPadding,n.labelYPadding=s.label.yPadding,n.labelCornerRadius=s.label.cornerRadius,n.labelPosition=s.label.position,n.labelXAdjust=s.label.xAdjust,n.labelYAdjust=s.label.yAdjust,n.labelEnabled=s.label.enabled,n.labelContent=s.label.content,o.font=u.fontString(n.labelFontSize,n.labelFontStyle,n.labelFontFamily);var c=o.measureText(n.labelContent).width,l=o.measureText("M").width,p=function(e,t,n,s,i){var o=e.line,r={},a=0,c=0;switch(!0){case"vertical"==e.mode&&"top"==e.labelPosition:c=i+e.labelYAdjust,a=t/2+e.labelXAdjust,r.y=e.y1+c,r.x=(isFinite(o.m)?o.getX(r.y):e.x1)-a;break;case"vertical"==e.mode&&"bottom"==e.labelPosition:c=n+i+e.labelYAdjust,a=t/2+e.labelXAdjust,
r.y=e.y2-c,r.x=(isFinite(o.m)?o.getX(r.y):e.x1)-a;break;case e.mode==g&&"left"==e.labelPosition:a=s+e.labelXAdjust,c=-n/2+e.labelYAdjust,r.x=e.x1+a,r.y=o.getY(r.x)+c;break;case e.mode==g&&"right"==e.labelPosition:a=t+s+e.labelXAdjust,c=-n/2+e.labelYAdjust,r.x=e.x2-a,r.y=o.getY(r.x)+c;break;default:r.x=(e.x1+e.x2-t)/2+e.labelXAdjust,r.y=(e.y1+e.y2-n)/2+e.labelYAdjust}return r}(n,c,l,n.labelXPadding,n.labelYPadding);n.labelX=p.x-n.labelXPadding,n.labelY=p.y-n.labelYPadding,n.labelWidth=c+2*n.labelXPadding,n.labelHeight=l+2*n.labelYPadding,n.borderColor=s.borderColor,n.borderWidth=s.borderWidth,n.borderDash=s.borderDash||[],n.borderDashOffset=s.borderDashOffset||0}},inRange:function(e,t){var n=this._model;return n.line&&n.line.intersects(e,t,this.getHeight())||n.labelEnabled&&n.labelContent&&e>=n.labelX&&e<=n.labelX+n.labelWidth&&t>=n.labelY&&t<=n.labelY+n.labelHeight},getCenterPoint:function(){return{x:(this._model.x2+this._model.x1)/2,y:(this._model.y2+this._model.y1)/2}},
getWidth:function(){return Math.abs(this._model.right-this._model.left)},getHeight:function(){return this._model.borderWidth||1},getArea:function(){return Math.sqrt(Math.pow(this.getWidth(),2)+Math.pow(this.getHeight(),2))},draw:function(){var e=this._view,t=this.chartInstance.chart.ctx;e.clip&&(t.save(),t.beginPath(),t.rect(e.clip.x1,e.clip.y1,e.clip.x2-e.clip.x1,e.clip.y2-e.clip.y1),t.clip(),t.lineWidth=e.borderWidth,t.strokeStyle=e.borderColor,t.setLineDash&&t.setLineDash(e.borderDash),t.lineDashOffset=e.borderDashOffset,t.beginPath(),t.moveTo(e.x1,e.y1),t.lineTo(e.x2,e.y2),t.stroke(),e.labelEnabled&&e.labelContent&&(t.beginPath(),t.rect(e.clip.x1,e.clip.y1,e.clip.x2-e.clip.x1,e.clip.y2-e.clip.y1),t.clip(),t.fillStyle=e.labelBackgroundColor,u.drawRoundedRectangle(t,e.labelX,e.labelY,e.labelWidth,e.labelHeight,e.labelCornerRadius),t.fill(),t.font=u.fontString(e.labelFontSize,e.labelFontStyle,e.labelFontFamily),t.fillStyle=e.labelFontColor,t.textAlign="center",t.textBaseline="middle",
t.fillText(e.labelContent,e.labelX+e.labelWidth/2,e.labelY+e.labelHeight/2)),t.restore())}})}},{"../helpers.js":5}]},{},[6]);var AdminNavigation={left:function(e){AdminNavigation.nextLevel(AdminNavigation.LEFT,e)},left_double:function(e){AdminNavigation.nextEpisode(AdminNavigation.LEFT,e)},right:function(e){AdminNavigation.nextLevel(AdminNavigation.RIGHT,e)},right_double:function(e){AdminNavigation.nextEpisode(AdminNavigation.RIGHT,e)},nextLevel:function(e,t){if(cleverapps.administrator.adminLevels.getActive()){var n=cleverapps.administrator.adminLevels.next(e);void 0!==n?(cleverapps.administrator.adminLevels.setActive(n),t()):AdminNavigation.nextEpisode(e,t,AdminNavigation.suggestedLevelAfterScroll(e))}else t()},nextEpisode:function(e,t,n){var s=cleverapps.administrator.adminEpisodes.next(e);void 0!==s?cleverapps.administrator.adminEpisodes.setActive(s,t,n):t()},suggestedLevelAfterScroll:function(e){return e===AdminNavigation.RIGHT?AdminLevels.FIRST_LEVEL:AdminLevels.LAST_LEVEL},
RIGHT:1,LEFT:-1},Administrator=function(){this.adminEpisodes=new AdminEpisodes(this),this.adminLevels=new AdminLevels(this),this.adminDetails=new AdminDetails;var e="cleverapps/res/"+cleverapps.config.name+"/levels";if("match3"===cleverapps.config.type&&(e="match3/res/levels"),this.adminGitButtons=new GitButtons(e),this.simpleMethaDataProvider=new SimpleMethaDataProvider,this.log=new AdminLog,AdminLevelsChart.PrepareChart(),AdminLanguage.IsAvailable()){var t={};cleverapps.Settings.getAvailableLanguages().forEach(function(e){t[e]=new AdminLanguage(this,e,cleverapps.settings.language===e)}.bind(this)),this.adminLanguages=t}};Administrator.prototype.run=function(){this.adminEpisodes.reset()},Administrator.prototype.updateGooglesheets=function(t){cleverapps.RestClient.get("/googlesheetcommands/update",{},function(e){t(e.result),this.adminGitButtons.checkStatus()}.bind(this),function(){t("network error")}.bind(this),3e4)},Administrator.prototype.setLanguage=function(t,n){
var s=cleverapps.settings.language;this.adminLanguages&&s!==t&&cleverapps.metha.display({focus:"SetAdminLanguage",action:function(e){this.adminLanguages[s].unselect(),this.adminLanguages[t].select(),cleverapps.settings.setLanguage(t),this.reloadActiveEpisode(function(){e(),n&&n()})}.bind(this)})},Administrator.prototype.reloadActiveEpisode=function(e){this.adminEpisodes.reset(),e()},Administrator.prototype.scrambleGotoRow=function(e){if(e){var t="https://docs.google.com/spreadsheets/d/1e7g86FZWbm1oYqlg15ex8-TCyraMEoCVBEbyQKIr_XM/edit#gid=%{gid}&range=%{row}:%{row}";t=(t=t.replace("%{gid}",{en:0,ru:1497319862,fr:2132465089,it:1727839938,de:1616900791,es:797836458,nl:737846155,ja:957913327,pl:858975559,ko:47567512,pt:1954520613}[cleverapps.settings.language])).replaceAll("%{row}",e),window.open(t,"_blank").focus()}};var AdminEpisode=function(e){cleverapps.EventEmitter.call(this),cleverapps.extend(this,e)};AdminEpisode.prototype=Object.create(cleverapps.EventEmitter.prototype),(
AdminEpisode.prototype.constructor=AdminEpisode).getAddMoreEpisode=function(){return new AdminEpisode({extra:!0,episodeNo:"#addMoreEpisode"})},AdminEpisode.create=function(e,t){var n=new AdminEpisode({index:e});return n.setEpisodeNo(t),n},AdminEpisode.prototype.setEpisodeNo=function(e){var t=parseInt(e);cleverapps.extend(this,{name:e,episodeNo:e,start:t*Episode.LEVELS_PER_EPISODE,end:(t+1)*Episode.LEVELS_PER_EPISODE-1}),this.onUpdate()},AdminEpisode.prototype.isAddMoreEpisode=function(){return void 0!==this.extra},AdminEpisode.prototype.isNumeric=function(){return parseInt(this.episodeNo)===this.episodeNo},AdminEpisode.prototype.isCurrent=function(){return this.episodeNo===cleverapps.user.episode},AdminEpisode.prototype.onClick=function(e){this.isAddMoreEpisode()?cleverapps.administrator.adminEpisodes.createNew(e):cleverapps.administrator.adminEpisodes.setActive(this,e)},AdminEpisode.prototype.setDebug=function(e){this.debug!==e&&(this.debug=e,this.trigger("change:debug"))},
AdminEpisode.prototype.inProgress=function(){return AdminEpisode.InProgress(this.episodeNo)},AdminEpisode.prototype.getBundle=function(){return bundles[Episode.BundleId(this.episodeNo)]},AdminEpisode.InProgress=function(e,t){if(e&&!/[^0-9]/.test(e)){var n=Episode.BundleId(e,t);return bundles[n].levelsAmount<15}},AdminEpisode.prototype.select=function(){this.selected=!0,this.trigger("select")},AdminEpisode.prototype.unselect=function(){this.selected=!1,this.trigger("unselect")},AdminEpisode.prototype.hover=function(){this.isAddMoreEpisode()||cleverapps.administrator.adminEpisodes.hover(this)},AdminEpisode.prototype.unhover=function(){cleverapps.administrator.adminEpisodes.unhover(this)},AdminEpisode.prototype.onUpdate=function(){this.trigger("update")},AdminEpisode.DEBUG_DISABLED=1;var AdminEpisodes=function(e){this.administrator=e,cleverapps.EventEmitter.call(this),this.onUpdateHoverEpisodeListener=function(){},this.onUpdateEpisodeListener=function(){}}
;AdminEpisodes.prototype=Object.create(cleverapps.EventEmitter.prototype),(AdminEpisodes.prototype.constructor=AdminEpisodes).prototype.updateDebugs=function(){var o=!1,r=-1;this.episodes.slice(0,this.episodes.length-1).forEach(function(e,t){var n=cleverapps.isNumber(e.episodeNo),s=e.getBundle();if(s){var i=s.debug;(n&&o||n&&r<parseInt(e.episodeNo)-1)&&(i=AdminEpisode.DEBUG_DISABLED),n&&i&&(o=!0),(s.levelsAmount<Episode.LEVELS_PER_EPISODE||!n)&&(i=AdminEpisode.DEBUG_DISABLED),n&&(r=parseInt(e.episodeNo)),e.setDebug(i)}})},AdminEpisodes.prototype.next=function(e){var t=this.episodes.indexOf(this.active)+e;if(void 0!==this.episodes[t]&&!this.episodes[t].isAddMoreEpisode())return this.episodes[t]},AdminEpisodes.prototype.updateIndexes=function(){this.episodes.forEach(function(e,t){void 0!==e.index&&(e.index=t)})},AdminEpisodes.prototype.getInsertionIndex=function(e){for(var t=0;t<this.total;){var n=this.episodes[t].episodeNo;if(0<=AdminEpisodes.EPISODE_NUMBERS_COMPARATOR(n,e))break;t++}
return t},AdminEpisodes.prototype.insertToArray=function(e){var t=this.getInsertionIndex(e),n=AdminEpisode.create(t,e);this.episodes.splice(t,0,n),this.episodesByName[e]=n,this.total=this.episodes.length-1,this.updateIndexes(),this.updateDebugs(),this.trigger("insert",n)},AdminEpisodes.prototype.removeFromArray=function(e){var t=this.episodesByName[e],n=t.index;this.episodes.splice(n,1),t.purge(),this.total=this.episodes.length-1,delete this.episodesByName[e],this.updateIndexes(),this.updateDebugs(),this.trigger("remove",t)},AdminEpisodes.prototype.renameInArray=function(e,t){var n=this.episodesByName[e],s=n.index;this.episodes.splice(s,1),delete this.episodesByName[e],this.total=this.episodes.length-1;var i=this.getInsertionIndex(t);n.setEpisodeNo(t),n.index=i,this.episodes.splice(i,0,n),this.episodesByName[t]=n,this.total=this.episodes.length-1,this.updateIndexes(),this.updateDebugs(),this.trigger("rename",n,e)},AdminEpisodes.prototype.createNew=function(t){var n=parseInt(
this.episodes[this.total-1].episodeNo)+1,e={language:cleverapps.settings.language},s=function(e){this.saveToStorage(n,e.data),this.insertToArray(n),levels.episodes.reset(),this.setActive(this.episodesByName[n],t),cleverapps.administrator.log.createEntry({type:AdminLog.CREATE_EPISODE,episodeNo:n})}.bind(this);cleverapps.RestClient.post("/admin/newepisode/"+n,e,s,function(e){cleverapps.Notification.create(e.errorMessage||"Create episode error"),t()})},AdminEpisodes.prototype.remove=function(n,s){var e={language:cleverapps.settings.language},i=this.episodesByName[n],t=function(e){this.removeFromStorage(n),this.removeFromArray(n),levels.episodes.reset();var t=this.episodes[Math.max(0,i.index-1)];t&&!t.isAddMoreEpisode()?this.setActive(t,s):s(),cleverapps.administrator.log.createEntry({type:AdminLog.DELETE_EPISODE,episodeNo:n})}.bind(this);cleverapps.RestClient.post("/admin/removeepisode/"+n,e,t,function(e){cleverapps.Notification.create(e.errorMessage||"Remove episode error"),s()})},
AdminEpisodes.prototype.copy=function(n,s){var e={language:cleverapps.settings.language},t=function(e){var t=e.episodeNo;this.saveToStorage(t,e.data),this.insertToArray(t),levels.episodes.reset(),this.setActive(this.episodesByName[t],s),cleverapps.administrator.log.createEntry({type:AdminLog.COPY_EPISODE,episodeNo:n,newEpisodeNo:t})}.bind(this);cleverapps.RestClient.post("/admin/copyepisode/"+n,e,t,function(e){cleverapps.Notification.create(e.errorMessage||"Copy episode error"),s()})},AdminEpisodes.prototype.rename=function(t,n,s){var e={language:cleverapps.settings.language,newEpisodeNo:n},i=(this.episodesByName[t],function(e){this.removeFromStorage(t),this.saveToStorage(n,e.data),this.renameInArray(t,n),levels.episodes.reset(),cleverapps.administrator.adminLevels.reset(s),cleverapps.administrator.log.createEntry({type:AdminLog.RENAME_EPISODE,episodeNo:t,newEpisodeNo:n})}.bind(this));cleverapps.RestClient.post("/admin/renameepisode/"+t,e,i,function(e){cleverapps.Notification.create(
e.errorMessage||"Rename episode error"),s()})},AdminEpisodes.prototype.upload=function(e,n){var t={language:cleverapps.settings.language,content:e},s=this.getActive(),i=function(e){var t=e.episodeNo;this.saveToStorage(t,e.data),cleverapps.administrator.adminLevels.reset(n)}.bind(this);cleverapps.RestClient.post("/admin/uploadepisode/"+s.episodeNo,t,i,function(e){cleverapps.Notification.create(e.errorMessage||"Upload episode error"),n()})},AdminEpisodes.prototype.setDebug=function(t,n){var e={language:cleverapps.settings.language,params:{debug:t}},s=this.getActive(),i=function(e){this.saveToStorage(s.episodeNo,e.data),this.updateDebugs(),cleverapps.administrator.log.createEntry({type:AdminLog.EPISODE_SET_DEBUG,episodeNo:s.episodeNo,debug:t}),n()}.bind(this);cleverapps.RestClient.post("/admin/updateparams/"+s.episodeNo,e,i,function(e){cleverapps.Notification.create(e.errorMessage||"Upload episode params error"),n()})},AdminEpisodes.prototype.getActive=function(){return this.active},
AdminEpisodes.prototype.setActive=function(e,t,n){this.active!==e?(void 0!==this.active&&this.active.unselect(),this.active=e,this.active.select(),cleverapps.config.adminMode&&cleverapps.setUrlHash({adminEpisode:this.active.episodeNo}),cleverapps.administrator.adminLevels.reset(t,n),cleverapps.administrator.log.onChangeEpisode(e),this.trigger("setActive",e)):t&&t()},AdminEpisodes.prototype.hover=function(e){this.hoverEpisode!==e&&(this.hoverEpisode=e,this.onUpdateHoverEpisodeListener())},AdminEpisodes.prototype.unhover=function(e){this.hoverEpisode===e&&(delete this.hoverEpisode,this.onUpdateHoverEpisodeListener())},AdminEpisodes.prototype.reset=function(){delete this.hoverEpisode;var e=AdminEpisodes.GetEpisodeNames(cleverapps.settings.language);levels.episodes.reset();for(var t=[],n={},s=0;s<e.length;s++){var i=e[s],o=AdminEpisode.create(s,i);t.push(o),n[i]=o}this.total=t.length;var r=AdminEpisode.getAddMoreEpisode();n[r.episodeNo]=r,t.push(r),this.episodes=t,this.episodesByName=n,
this.updateDebugs(),this.trigger("reset");var a=cleverapps.getRequestParameters(window.location.hash),c=a.adminEpisode,l=void 0!==a.adminLevel?a.adminLevel:cleverapps.user.level,p=this.episodesByName[c]||this.episodesByName[cleverapps.user.episode];p&&this.setActive(p,function(){},l)},AdminEpisodes.prototype.getGuessedEpisode=function(e){return this.episodesByName[e]},AdminEpisodes.prototype.update=function(){this.episodes.forEach(function(e){e.onUpdate()})},AdminEpisodes.GetEpisodeNames=function(t){var e=cleverapps.values(bundles).filter(function(e){return void 0!==e.episodeNo});"board"===cleverapps.config.type&&(e=e.filter(function(e){return e.language===t}));var n=e.map(function(e){return e.episodeNo});return n=n.sort(AdminEpisodes.EPISODE_NUMBERS_COMPARATOR)},AdminEpisodes.prototype.updateFromServer=function(s){var t={language:cleverapps.settings.language,episodes:[]};this.episodes.forEach(function(e){e.isAddMoreEpisode()||t.episodes.push(e.episodeNo)});var e=function(e){
var t=e.added,n=e.removed;Object.keys(t).forEach(function(e){this.saveToStorage(e,t[e])}.bind(this)),n.forEach(function(e){this.removeFromStorage(e)}.bind(this)),(0<Object.keys(t).length||0<n.length)&&this.reset(),s()}.bind(this);cleverapps.RestClient.post("/admin/loadepisodeschanges/",t,e,function(e){cleverapps.Notification.create(e.errorMessage||"Load episodes changes error"),s()})},AdminEpisodes.SaveToStorage=function(e,t){var n=Episode.BundleId(e),s=n+".json",i=n+"/levels.json";bundles[n]&&bundles[n].debug;cc.loader.cache[s]={levels:t};var o=(cc.loader.cache[i]=t).levels||t,r={storage:!0,episodeNo:e,levelsAmount:o.length,jsons:{levels:i},urls:{json:s},hard:[],tricky:[]};o.forEach(function(e,t){Array.isArray(e)&&(e=e[e.length-1]),e.hard&&r.hard.push(t),e.tricky&&r.tricky.push(t)}),r.debug=o.length<Episode.LEVELS_PER_EPISODE||t.debug||!cleverapps.isNumber(e),"board"===cleverapps.config.type&&(r.language=cleverapps.settings.language),bundles[n]=r,cleverapps.bundleLoader.loadBundle(n)}
,AdminEpisodes.prototype.saveToStorage=function(e,t){var n=Episode.BundleId(e),s=bundles[n]&&bundles[n].debug;AdminEpisodes.SaveToStorage(e,t),s!==bundles[n].debug&&this.updateDebugs(),this.onUpdateEpisodeListener(e),this.episodesByName[e]&&this.episodesByName[e].onUpdate(),this.administrator.adminGitButtons.checkStatus(),this.administrator.simpleMethaDataProvider&&this.administrator.simpleMethaDataProvider.reset()},AdminEpisodes.prototype.removeFromStorage=function(e){var t=Episode.BundleId(e);delete bundles[t],delete cleverapps.bundleLoader.handles[t],this.onUpdateEpisodeListener(e),this.administrator.adminGitButtons.checkStatus(),this.administrator.simpleMethaDataProvider&&this.administrator.simpleMethaDataProvider.reset()},AdminEpisodes.prototype.scrollToEp=function(e){this.trigger("scrollToEp",e)},AdminEpisodes.prototype.gatherDifficultyData=function(s){var i={},o=[],r={},n=0,a=function(e){if(++n!==this.episodes.length)if(e.isNumeric()&&!e.debug){var t=new Episode(e.episodeNo)
;t.loadData(),t.whenLoaded(function(){r[t.episodeNo]=t.getLastVersionHashes(),t.destructor(),a(this.episodes[n])}.bind(this),!0)}else a(this.episodes[n]);else!function(){for(var e in r){var n=0,t=r[e];t.forEach(function(e){var t=i[e]||0;n+=1/(1-t/100)}),o.push({Episode:e,Difficulty:Math.round(100*(1-1/(n/t.length)))})}s(o)}()}.bind(this);cleverapps.RestClient.get(DataSource.ReleaseAdminPath("epdifficulty/get"),{},function(e){e.error?console.log("Failed getting difficulty statistics",e.error):(e.forEach(function(e){i[e.hash]=e.difficulty}),a(this.episodes[0]))}.bind(this),function(e){console.log("Error getting difficulty statistics",e)})},AdminEpisodes.EPISODE_NUMBERS_COMPARATOR=function(e,t){var n=parseInt(e),s=parseInt(t);return n!==e?-1:s!==t?1:n===s?(e+"").localeCompare(t+""):n-s};var AdminLevel=function(e){cleverapps.EventEmitter.call(this),cleverapps.extend(this,e)};AdminLevel.prototype=Object.create(cleverapps.EventEmitter.prototype),(AdminLevel.prototype.constructor=AdminLevel
).createFromData=function(e,t){Array.isArray(t)&&(t=t[t.length-1]);var n=JSON.parse(JSON.stringify(t));return new AdminLevel(cleverapps.extend({},n,e,{content:n}))},AdminLevel.getAddMoreLevel=function(){return new AdminLevel({addMoreLevel:!0})},AdminLevel.prototype.setDragEpisode=function(e){var t=this.originalEpisodeNo;e&&(t=e.episodeNo),this.episodeNo!==t&&(this.episodeNo=t,this.trigger("updateEpisode"))},AdminLevel.prototype.setDifficulty=function(e){this.difficulty=e,this.trigger("changeDifficulty")},AdminLevel.prototype.setLevelNo=function(e){this.levelNo!==e&&(this.levelNo=e,this.onUpdate())},AdminLevel.prototype.getHint=function(){return this.hint?this.words.reduce(function(e,t){return e+t.length},0)+" - "+this.words.length:"solitaire"===cleverapps.config.type&&this.screens?"["+this.screens.map(function(e){return e.length}).join("-")+"]-"+this.hand.num:"differences"===cleverapps.config.type?"x "+this.differences.length+" - "+this.rate:this.levelNo},
AdminLevel.prototype.getFeatures=function(){var n=[];if("solitaire"===cleverapps.config.type&&this.screens){var s=function(e){var t;return e.feature&&"mouse"!==e.feature&&(t=e.feature),e.marks&&-1!==e.marks.indexOf("magnet")&&(t="magnet"),t&&-1===n.indexOf(t)?t:void 0};this.screens.forEach(function(e){e.forEach(function(e){var t;((t=s(e))&&n.push(t),e.innerCard)&&((t=s(e.innerCard))&&n.push(t))})})}if("match3"===cleverapps.config.type){var e=function(e){var n={};return e.forEach(function(e){e.forEach(function(e){if(e&&e.bundleId){var t=e.bundleId();Array.isArray(t)||(t=[t]),t.forEach(function(e){n[e]=!0})}})}),Object.keys(n)};n=(n=n.concat(e(this.gameField.cells),e(this.gameField.floor))).filter(function(e){return bundles.admin.frames["feature_"+e]}),(n=cleverapps.unique(n)).sort(function(e,t){var n=AdminLevel.MATCH3_FEATUREBUNDLES_ORDER.indexOf(e),s=AdminLevel.MATCH3_FEATUREBUNDLES_ORDER.indexOf(t);return n<0?(console.error("Unknown priority for "+e),1):s<0?(console.error(
"Unknown priority for "+t),-1):n-s})}return n.slice(0,3)},AdminLevel.prototype.isAddMoreLevel=function(){return void 0!==this.addMoreLevel},AdminLevel.prototype.handleDragEnd=function(){if(this.dragging){delete cleverapps.administrator.adminLevels.draggingLevel,this.dragging=!1;var t=new WaitWindow;cleverapps.administrator.adminLevels.moveLevel({toEpisodeNo:this.episodeNo,toLevelNo:this.levelNo,fromEpisodeNo:this.originalEpisodeNo,fromLevelNo:this.originalLevelNo,callback:function(){if(t.close(),this.onceDragFinished){var e=this.onceDragFinished;this.onceDragFinished=void 0,e()}}.bind(this)}),this.trigger("stopDrag"),delete this.originalEpisodeNo,delete this.originalLevelNo,this.onUpdate()}},AdminLevel.prototype.handleDragMove=function(e){this.dragging||cleverapps.metha.display({focus:"AdminLevelDrag",action:function(e){this.dragging=!0,this.originalLevelNo=this.levelNo,this.originalEpisodeNo=this.episodeNo,this.onceDragFinished=e,(
cleverapps.administrator.adminLevels.draggingLevel=this).trigger("startDrag"),this.onUpdate()}.bind(this)}),this.dragging&&this.levelNo!==e&&cleverapps.administrator.adminLevels.dragLevel(this,e)},AdminLevel.prototype.moveToSlot=function(e){this.dragging||this.trigger("moveToSlot",e)},AdminLevel.prototype.isHard=function(){return!0===this.hard},AdminLevel.prototype.isTricky=function(){return!0===this.tricky},AdminLevel.prototype.isCurrent=function(){return+this.episodeNo===cleverapps.user.episode&&this.levelNo===cleverapps.user.level},AdminLevel.prototype.toggleHard=function(){var e=!this.hard;e&&this.tricky&&this.toggleTricky(),this.updateContent({hard:e},function(){this.hard=e,this.trigger("change:hard"),["tripeaks","scramble"].includes(cleverapps.config.name)&&cleverapps.administrator.adminLevels.updateLevels(),cleverapps.administrator.log.createEntry({type:AdminLog.TOGGLE_HARD,levelNo:this.levelNo,episodeNo:this.episodeNo,madeHard:e})}.bind(this))},
AdminLevel.prototype.toggleTricky=function(){var e=!this.tricky;e&&this.hard&&this.toggleHard(),this.updateContent({tricky:e},function(){this.tricky=e,this.trigger("change:tricky"),cleverapps.administrator.adminLevels.updateLevels(),cleverapps.administrator.log.createEntry({type:AdminLog.TOGGLE_TRICKY,levelNo:this.levelNo,episodeNo:this.episodeNo,madeTricky:e})}.bind(this))},AdminLevel.prototype.onClick=function(e){if(this.isAddMoreLevel()){if(0<=["board","differences"].indexOf(cleverapps.config.type))return void e();if(cleverapps.isNumber(cleverapps.administrator.adminEpisodes.active.episodeNo)&&cleverapps.administrator.adminLevels.levels.length>Episode.LEVELS_PER_EPISODE){var t="Episode already has "+cleverapps.administrator.adminLevels.levels.length+" levels bigger than "+Episode.LEVELS_PER_EPISODE;return cleverapps.Notification.create(t),void e()}var n=this.getBlankContent();cleverapps.administrator.adminLevels.createNew(n,e)}else cleverapps.administrator.adminLevels.setActive(this
),e()},AdminLevel.prototype.onUpdate=function(){this.trigger("update")},AdminLevel.prototype.select=function(){this.selected=!0,LevelManager.getInstance().setLevel({episodeNo:this.episodeNo,levelNo:this.levelNo}),this.trigger("select"),this.trigger("change:hard")},AdminLevel.prototype.unselect=function(){this.selected=!1,this.trigger("unselect"),this.trigger("change:hard")},AdminLevel.prototype.getContent=function(){return this.content},AdminLevel.prototype.updateContent=function(e,t){cleverapps.extend(this.content,e),LevelManager.getInstance().update(this.content),LevelManager.getInstance().save(t)},AdminLevel.prototype.saveComments=function(e){this.comments=e,this.updateContent({comments:e},function(){this.trigger("change:comment",e),cleverapps.administrator.log.createEntry({type:AdminLog.ANNOTAION_CHAGE,levelNo:this.levelNo,episodeNo:this.episodeNo})}.bind(this))},AdminLevel.prototype.editLevel=function(){"scramble"!==cleverapps.config.name?(AdministratorScene.close(),
cleverapps.config.editorMode=!0,LevelManager.getInstance().editLevel()):this.findRowInGoogleSheets(function(e){cleverapps.administrator.scrambleGotoRow(e)})},AdminLevel.prototype.getBlankContent=function(){return"solitaire"===cleverapps.config.type?{hard:!1,hand:{num:1,difficulty:1},screens:[[{x:0,y:0}]]}:"match3"===cleverapps.config.type?{hard:!1,moves:1,score:1,stars:10,colors:["a"],bundles:[],field:["...","...","..."],floor:["   ","   ","   "],goals:[]}:"merge"===cleverapps.config.type?{visibleBox:{width:.38,height:.48},map:["00000000000000000000000000000000000000000000000000000000000000000000000000000000","00000000000000000000000000000000000000000000000000000000000000000000000000000000","00000000000000000000000000000000000000000000000000000000000000000000000000000000","00000000000000000000000000000000000000000000000000000000000000000000000000000000","00000000000000000000000000000000000000000000000000000000000000000000000000000000",
"00000000000000000000000000000000000000000000000000000000000000000000000000000000","00000000000000000000000000000000000000000000000000000000000000000000000000000000","00000000000000000000000000000000000000000000000000000000000000000000000000000000","00000000000000000000000000000000000000000000000000000000000000000000000000000000","00000000000000000000000000000000000000000000000000000000000000000000000000000000","00000000000000000000000000000000000000000000000000000000000000000000000000000000","00000000000000000000000000000000000000000000000000000000000000000000000000000000","00000000000000000000000000000000000000000000000000000000000000000000000000000000","00000000000000000000000000000000000000000000000000000000000000000000000000000000","00000000000000000000000000000000000000000000000000000000000000000000000000000000","00000000000000000000000000000000000000000000000000000000000000000000000000000000","00000000000000000000000000000000000000000000000000000000000000000000000000000000",
"00000000000000000000000000000000000000000000000000000000000000000000000000000000","00000000000000000000000000000000000000000000000000000000000000000000000000000000","00000000000000000000000000000000000000000000000000000000000000000000000000000000","00000000000000000000000000000000000000000000000000000000000000000000000000000000","00000000000000000000000000000000000000000000000000000000000000000000000000000000","00000000000000000000000000000000000000000000000000000000000000000000000000000000","00000000000000000000000000000000000000000000000000000000000000000000000000000000","00000000000000000000000000000000000000000000000000000000000000000000000000000000","00000000000000000000000000000000000000000000000000000000000000000000000000000000","00000000000000000000000000000000000000000000000000000000000000000000000000000000","00000000000000000000000000000000000000000000000000000000000000000000000000000000","00000000000000000000000000000000000000000000000000000000000000000000000000000000",
"00000000000000000000000000000000000000000000000000000000000000000000000000000000","00000000000000000000000000000000000000000000000000000000000000000000000000000000","00000000000000000000000000000000000000000000000000000000000000000000000000000000","00000000000000000000000000000000000000000000000000000000000000000000000000000000","00000000000000000000000000000000000000000000000000000000000000000000000000000000","00000000000000000000000000000000000000000000000000000000000000000000000000000000","00000000000000000000000000000000000000000000000000000000000000000000000000000000","00000000000000000000000000000000000000000000000000000000000000000000000000000000","00000000000000000000000000000000000000000000000000000000000000000000000000000000","00000000000000000000000000000000000000000000000000000000000000000000000000000000","00000000000000000000000000000000000000000000000000000000000000000000000000000000","00000000000000000000000000000000000000001000000000000000000000000000000000000000",
"00000000000000000000000000000000000000000000000000000000000000000000000000000000","00000000000000000000000000000000000000000000000000000000000000000000000000000000","00000000000000000000000000000000000000000000000000000000000000000000000000000000","00000000000000000000000000000000000000000000000000000000000000000000000000000000","00000000000000000000000000000000000000000000000000000000000000000000000000000000","00000000000000000000000000000000000000000000000000000000000000000000000000000000","00000000000000000000000000000000000000000000000000000000000000000000000000000000","00000000000000000000000000000000000000000000000000000000000000000000000000000000","00000000000000000000000000000000000000000000000000000000000000000000000000000000","00000000000000000000000000000000000000000000000000000000000000000000000000000000","00000000000000000000000000000000000000000000000000000000000000000000000000000000","00000000000000000000000000000000000000000000000000000000000000000000000000000000",
"00000000000000000000000000000000000000000000000000000000000000000000000000000000","00000000000000000000000000000000000000000000000000000000000000000000000000000000","00000000000000000000000000000000000000000000000000000000000000000000000000000000","00000000000000000000000000000000000000000000000000000000000000000000000000000000","00000000000000000000000000000000000000000000000000000000000000000000000000000000","00000000000000000000000000000000000000000000000000000000000000000000000000000000","00000000000000000000000000000000000000000000000000000000000000000000000000000000","00000000000000000000000000000000000000000000000000000000000000000000000000000000","00000000000000000000000000000000000000000000000000000000000000000000000000000000","00000000000000000000000000000000000000000000000000000000000000000000000000000000","00000000000000000000000000000000000000000000000000000000000000000000000000000000","00000000000000000000000000000000000000000000000000000000000000000000000000000000",
"00000000000000000000000000000000000000000000000000000000000000000000000000000000","00000000000000000000000000000000000000000000000000000000000000000000000000000000","00000000000000000000000000000000000000000000000000000000000000000000000000000000","00000000000000000000000000000000000000000000000000000000000000000000000000000000","00000000000000000000000000000000000000000000000000000000000000000000000000000000","00000000000000000000000000000000000000000000000000000000000000000000000000000000","00000000000000000000000000000000000000000000000000000000000000000000000000000000","00000000000000000000000000000000000000000000000000000000000000000000000000000000","00000000000000000000000000000000000000000000000000000000000000000000000000000000","00000000000000000000000000000000000000000000000000000000000000000000000000000000","00000000000000000000000000000000000000000000000000000000000000000000000000000000","00000000000000000000000000000000000000000000000000000000000000000000000000000000",
"00000000000000000000000000000000000000000000000000000000000000000000000000000000","00000000000000000000000000000000000000000000000000000000000000000000000000000000","00000000000000000000000000000000000000000000000000000000000000000000000000000000"],field:[]}:void 0},AdminLevel.prototype.getHumanNumber=function(){return this.isAddMoreLevel()?"":cleverapps.humanReadableNumber(this.episodeNo,this.levelNo)},AdminLevel.prototype.findRowInGoogleSheets=function(t){cleverapps.RestClient.post("/admin/findrowingooglesheets",{language:cleverapps.settings.language,hint:this.hint,words:this.words},function(e){e.error?(console.log("Error response: ",e),cleverapps.Notification.create(e.error),t()):t(e.row)}.bind(this))},AdminLevel.MATCH3_FEATUREBUNDLES=["shark","wall","dirt_maker","moves_cell","colorcookieman","candle","cookieman","ice_block_maker","gingerbread_house","petards","clock","crab_maker","syrup","waffle","ice_maker","color_bomb","bomb","color_container","dog","lollipop","cake","fish_cell"
,"truffle","firework_cell","firefly_jar","donut_box","mouse","burst","small_petard","cannon","ice_cream_maker","muffin","dragon","rug","dirty_honey","crab_decorator","rabbit","muffin","ice_block","flower_cell","dirt_decorator","blanket","nut","bag","ice","gum_decorator","chain_decorator","transporter","grass_tile","box"],AdminLevel.MATCH3_FEATUREBUNDLES_ORDER=[],AdminLevel.MATCH3_FEATUREBUNDLES.forEach(function(e){AdminLevel.MATCH3_FEATUREBUNDLES_ORDER.push(e),AdminLevel.MATCH3_FEATUREBUNDLES_ORDER.push(e+"_reskin")});var AdminLevels=function(e){cleverapps.EventEmitter.call(this),this.levels=[],this.episodeStatistics=new EpisodeStatistics,this.versions=new LevelVersions,this.onReadyListeners=[],this.ready=!1,this.episodeStatistics.whenReady(this.onStatisticsLoaded.bind(this)),e.adminEpisodes.onUpdateHoverEpisodeListener=this.onUpdateEpisodesHover.bind(this)};AdminLevels.prototype=Object.create(cleverapps.EventEmitter.prototype),(AdminLevels.prototype.constructor=AdminLevels
).prototype.onUpdateEpisodesHover=function(){this.draggingLevel&&this.draggingLevel.setDragEpisode(cleverapps.administrator.adminEpisodes.hoverEpisode)},AdminLevels.prototype.addLevel=function(e){this.levels.splice(e.levelNo,0,e);for(var t=0;t<this.levels.length;t++)this.levels[t].isAddMoreLevel()||(this.levels[t].levelNo=t);this.trigger("addLevel",e)},AdminLevels.prototype.makeCurrent=function(e){cleverapps.user.level=parseInt(e.levelNo),cleverapps.user.episode=parseInt(e.episodeNo),cleverapps.user.save(),this.trigger("updateSlots"),this.update(),cleverapps.administrator.adminEpisodes.update()},AdminLevels.prototype.update=function(){this.levels.forEach(function(e){e.onUpdate()})},AdminLevels.prototype.copyLevel=function(e){var t=cleverapps.administrator.adminEpisodes.getActive(),n=t.episodeNo,s=e.levelNo,i={language:cleverapps.settings.language},o=function(e){cleverapps.administrator.adminEpisodes.saveToStorage(n,e.episode),cleverapps.administrator.adminEpisodes.getActive(
)===t&&this.loadData(function(e){this.addLevel(this.createLevel(e,s)),this.episodeStatistics.reset(e)}.bind(this)),cleverapps.administrator.log.createEntry({type:AdminLog.COPY_LEVEL,episodeNo:n,levelNo:s})}.bind(this);cleverapps.RestClient.post("/admin/copylevel/"+n+"/"+e.levelNo,i,o,function(e){cleverapps.Notification.create(e.errorMessage||"Copy level error")})},AdminLevels.prototype.moveLevel=function(t){var e={toEpisodeNo:(t=t||{}).toEpisodeNo,toLevelNo:t.toLevelNo,fromEpisodeNo:t.fromEpisodeNo,fromLevelNo:t.fromLevelNo,language:cleverapps.settings.language},n=function(e){cleverapps.administrator.adminEpisodes.saveToStorage(t.fromEpisodeNo,e.fromEpisode),e.toEpisode&&cleverapps.administrator.adminEpisodes.saveToStorage(t.toEpisodeNo,e.toEpisode),e.toEpisode?this.reset(t.callback):(t.callback(),this.updateLevels(),this.loadData(function(e){this.episodeStatistics.reset(e)}.bind(this))),cleverapps.administrator.log.createEntry({type:AdminLog.MOVE_LEVEL,toEpisodeNo:t.toEpisodeNo,
toLevelNo:t.toLevelNo,fromEpisodeNo:t.fromEpisodeNo,fromLevelNo:t.fromLevelNo})}.bind(this),s=function(e){cleverapps.Notification.create(e.errorMessage||"Move level error"),this.reset(t.callback)}.bind(this);cleverapps.RestClient.post("/admin/movelevel/",e,n,s)},AdminLevels.prototype.updateLevels=function(){this.levels.forEach(function(e){e.onUpdate()})},AdminLevels.prototype.dragLevel=function(e,t){this.levels.splice(e.levelNo,1),this.levels.splice(t,0,e),this.levels.forEach(function(e,t){e.setLevelNo(t)})},AdminLevels.prototype.getStatistics=function(){},AdminLevels.prototype.createNew=function(e,t){var n=this.levels.length-1,s=cleverapps.administrator.adminEpisodes.getActive(),i=s.episodeNo;e.levelNo=n,e.episodeNo=i;var o={blankContent:e},r=function(e){cleverapps.administrator.adminEpisodes.saveToStorage(i,e.data),cleverapps.administrator.adminEpisodes.getActive()===s&&this.loadData(function(e){this.addLevel(this.createLevel(e,n)),this.episodeStatistics.reset(e)}.bind(this)),
cleverapps.administrator.log.createEntry({type:AdminLog.CREATE_LEVEL,episodeNo:i,levelNo:n}),t()}.bind(this);cleverapps.RestClient.post("/admin/newlevel/"+i+"/"+n,o,r,function(e){cleverapps.Notification.create(e.error||"Create level error"),t()})},AdminLevels.prototype.removeActive=function(t){var n=this.active.levelNo,s=this.active.episodeNo,i=cleverapps.administrator.adminEpisodes.getActive(),e=function(e){cleverapps.administrator.adminEpisodes.saveToStorage(s,e.data),cleverapps.administrator.adminEpisodes.getActive()===i?this.reset(t):t(),cleverapps.administrator.log.createEntry({type:AdminLog.DELETE_LEVEL,episodeNo:s,levelNo:n})}.bind(this);cleverapps.RestClient.post("/admin/removelevel/"+s+"/"+n,{},e,function(e){cleverapps.Notification.create(e.error||"Delete level error"),t()})},AdminLevels.FIRST_LEVEL=0,AdminLevels.LAST_LEVEL=1,AdminLevels.prototype.onStatisticsLoaded=function(e){this.whenReady(function(){e.forEach(function(e){
this.levels[e.levelNo]&&this.levels[e.levelNo].setDifficulty(e.difficulty)},this)}.bind(this)),this.trigger("statisticsLoaded",e)},AdminLevels.prototype.reset=function(n,s){void 0!==cleverapps.administrator.adminEpisodes.getActive().episodeNo&&(this.setActive(void 0),this.ready=!1,this.loadData(function(e){this.updateData(e);var t=this.levels[0];s&&(t=s===AdminLevels.LAST_LEVEL?this.levels[this.levels.length-2]:this.levels[s]),t&&!t.addMoreLevel&&this.setActive(t),n&&n(),this.runOnReadyListeners(),this.ready=!0,this.episodeStatistics.reset(e),this.trigger("statisticsReset")}.bind(this)))},AdminLevels.prototype.runOnReadyListeners=function(){var e=this.onReadyListeners;this.onReadyListeners=[],e.forEach(function(e){e(this.data)},this)},AdminLevels.prototype.whenReady=function(e){this.ready?e():this.onReadyListeners.push(e)},AdminLevels.prototype.next=function(e){var t=this.levels.indexOf(this.active)+e;if(void 0!==this.levels[t]&&!this.levels[t].isAddMoreLevel())return this.levels[t]},
AdminLevels.prototype.createLevel=function(e,t){var n=cleverapps.administrator.adminEpisodes.getActive(),s=e.getLevelHashes(t),i=e.getMaxVersion(e.getLevelVersions(t));return AdminLevel.createFromData({levelNo:t,episodeNo:n.episodeNo,hashes:s,version:i},e.getLevels()[t])},AdminLevels.prototype.updateData=function(e){cleverapps.administrator.adminEpisodes.getActive();var t=e.getLevels();this.levels=[];for(var n=0;n<100&&t[n];n++)this.levels.push(this.createLevel(e,n));this.levels.push(AdminLevel.getAddMoreLevel()),this.versions.reset(),this.trigger("reset")},AdminLevels.prototype.getActive=function(){return this.active},AdminLevels.prototype.setActive=function(e){this.active!==e&&(void 0!==this.active&&this.active.unselect(),this.active=e,cleverapps.config.adminMode&&cleverapps.setUrlHash({adminEpisode:this.active?this.active.episodeNo:void 0,adminLevel:this.active?this.active.levelNo:void 0}),void 0!==e&&(e.select(),this.trigger("chartUpdate",e),this.trigger("updateSlots")),
cleverapps.administrator.adminDetails.reset())},AdminLevels.prototype.loadData=function(e){var t=cleverapps.administrator.adminEpisodes.getActive();if(t){var n=new Episode(t.episodeNo);n.loadData(),n.whenLoaded(function(){t===cleverapps.administrator.adminEpisodes.getActive()&&(e(n),n.destructor())}.bind(this),!0)}},AdminLevels.prototype.download=function(e){this.loadData(function(e){var t=JSON.stringify(e.getContent(),void 0,4),n=cleverapps.administrator.adminEpisodes.getActive(),s=Episode.BundleId(n.episodeNo)+".json";this.trigger("downloadLevels",{fileName:s,data:t})}.bind(this)),e()},AdminLevels.prototype.upload=function(e,n){var t=e.target.files[0];if(t.name.indexOf(".json")<0)return cleverapps.Notification.create("Error - File must be json format"),void n();var s=new FileReader;s.onload=function(e){var t=e.target.result;cleverapps.administrator.adminEpisodes.upload(t,n)}.bind(this),s.readAsText(t)};var LevelVersions=function(){};LevelVersions.prototype.reset=function(){}
;var DataSource=function(){cleverapps.EventEmitter.call(this),this.data={},this.ready=!1,this.onReadyListeners=[]};DataSource.prototype=Object.create(cleverapps.EventEmitter.prototype),(DataSource.prototype.constructor=DataSource).prototype.purge=function(){cleverapps.EventEmitter.prototype.purge.apply(this,arguments),this.onReadyListeners=[]},DataSource.prototype.calculateData=function(e,t){this.data=e,t()},DataSource.ReleaseAdminPath=function(e){return projects[projectName].basic.deployment+"/"+projectName+"-rest/admin/"+e},DataSource.prototype.reset=function(e){this.ready=!1,this.data={},this.options=e,this.trigger("reset"),e&&this.calculateData(e,function(){this.options===e?(this.ready=!0,this.runOnReadyListeners()):console.log("received old result")}.bind(this))},DataSource.prototype.runOnReadyListeners=function(){this.onReadyListeners.forEach(function(e){e(this.data)},this)},DataSource.prototype.getData=function(){return this.data},DataSource.prototype.whenReady=function(t,e){
this.onReadyListeners.push(t),this.ready&&t(this.data);var n={clear:function(){var e=this.onReadyListeners.indexOf(t);0<=e&&this.onReadyListeners.splice(e,1)}.bind(this)};return e instanceof cc.Node&&e.registerCleanupCallback(n.clear),n};var EpisodeStatistics=function(){DataSource.call(this)};EpisodeStatistics.prototype=Object.create(DataSource.prototype),(EpisodeStatistics.prototype.constructor=EpisodeStatistics).prototype.calculateData=function(t,n){var s=t.getHashes();if(0===Object.keys(s).length)return this.data=[],void n();var e=Object.keys(s).join(",");"merge"!==cleverapps.config.type&&cleverapps.RestClient.get(DataSource.ReleaseAdminPath("basic/")+e,{},function(e){this.data=this.processData(t,s,e),n()}.bind(this),function(){console.log("Error getting statistics for episode",t)})},EpisodeStatistics.prototype.baseParams=function(t,e){var n={};return e.forEach(function(e){cleverapps.extend(e,t[e.hash]),n[e.levelNo+"_"+e.version]=e}),n},
EpisodeStatistics.prototype.getLevelData=function(e,t,n){var s=Object.keys(e.getLevelVersions(t)).map(function(e){return parseInt(e)}).sort().reverse().map(function(e){return n[t+"_"+e]}).find(function(e){return e});return s||(s={levelNo:t,version:-1,difficulty:0,hints:0,minutes:0}),s.difficulty&&(s.difficulty=Math.round(s.difficulty)),s.hints&&(s.hints=Math.round(s.hints)),s.currentVersion=e.getMaxVersion(e.getLevelVersions(t)),s},EpisodeStatistics.prototype.processData=function(n,e,s){return s=this.baseParams(e,s),n.getLevels().map(function(e,t){return this.getLevelData(n,t,s)}.bind(this))};var LevelStatistics=function(){DataSource.call(this)};LevelStatistics.prototype=Object.create(DataSource.prototype),(LevelStatistics.prototype.constructor=LevelStatistics).prototype.calculateData=function(s,i){var o=s.hashes,e=Object.keys(o).join(",");"merge"!==cleverapps.config.type&&cleverapps.RestClient.get(DataSource.ReleaseAdminPath("basic/")+e,{},function(e){if(0===(e=e.sort(function(e,t){
return parseInt(o[t.hash].version)-parseInt(o[e.hash].version)})).length)return this.data={},this.addPredictionData(s),void i();var t=this.data=e[0];for(var n in this.data)this.data[n]=Math.round(this.data[n]);t.version=o[t.hash].version,t.version===s.version&&delete t.version,delete t.hash,this.addPredictionData(s),i()}.bind(this),function(){console.log("Error getting statistics for level",s),this.data={},this.addPredictionData(s),i()}.bind(this))},LevelStatistics.prototype.addPredictionData=function(e){if(e.rate&&(this.data.rate=e.rate),"stacks"===cleverapps.config.subtype){this.data.wordsNo=e.words.length,this.data.letters=e.words.reduce(function(e,t){return e+t.length},0),this.data.hardness=BlockMixer.predictHardness(e.words),cleverapps.Random.seed(0);for(var t=new BlockMixer({quick:!0}),n=0;n<10;n++){var s=t.mix(e.words,{details:!0}),i=t.calculate(s);if(-1!==i){this.data.operations=Math.round(i);break}}}};var AdminDetails=function(){cleverapps.EventEmitter.call(this),
this.statistics=new LevelStatistics};AdminDetails.prototype=Object.create(cleverapps.EventEmitter.prototype),(AdminDetails.prototype.constructor=AdminDetails).prototype.reset=function(){var e=cleverapps.administrator.adminLevels.getActive();this.statistics.reset(e),this.trigger("reset")};var AdminLog=function(){cleverapps.EventEmitter.call(this),this.entries=[],this.lastId=0,this.inUpdate=!1,this.targetEpisode=void 0,this.setUpdates()};AdminLog.prototype=Object.create(cleverapps.EventEmitter.prototype),(AdminLog.prototype.constructor=AdminLog).prototype.setUpdates=function(){setInterval(function(){if(cleverapps.environment.isAdministratorScene()&&0!==this.lastId){var e=this.getUpdatedEntries().map(function(e){return e.id}),t=[];e.length&&t.push("toupdate="+e),void 0!==this.targetEpisode&&t.push("episode="+this.targetEpisode),this.requestServerLogs("/admin/log/getnew/"+this.lastId+"?"+t.join("&"))}}.bind(this),AdminLog.UPDATE_INTERVAL)},AdminLog.prototype.getUpdatedEntries=function(){
var e=this.entries.filter(function(e){return e.updatedEntry&&(Date.now()-e.date)/864e5<1});e.sort(function(e,t){return t.id-e.id});var n=[];return e.forEach(function(t){n.some(function(e){return t.type===e.type&&t.userName===e.userName&&JSON.stringify(t.params)===JSON.stringify(e.params)})||n.push(t)}),n},AdminLog.prototype.createEntry=function(e){var t=new AdminLogEntry(e);if(!t.filter||t.filter())return t.save(function(){this.pushEntry(t)}.bind(this)),t},AdminLog.prototype.checkAmount=function(){for(;this.entries.length>AdminLog.MAX_AMOUNT;){this.entries.shift().remove()}},AdminLog.prototype.pushEntry=function(e){this.findEntryById(e.id)||(this.entries.push(e),this.trigger("addLogEntry",e),this.checkAmount(),this.lastId=e.id)},AdminLog.prototype.findEntryById=function(e){for(var t=0;t<this.entries.length;t++)if(this.entries[t].id===e)return this.entries[t]},AdminLog.prototype.parseServeData=function(e){e.forEach(function(e){var t={id:e.id,type:e.type,userName:e.username,
date:new Date(e.event)},n=this.findEntryById(t.id);if(n)n.updateData(t,!0);else{if(cleverapps.extend(t,JSON.parse(e.data)),-1===Object.keys(AdminLog.ACTIONS).indexOf(""+t.type))return console.log("Unknown adminlog type received, please refresh the app!"),void(this.lastId=t.id);var s=new AdminLogEntry(t);this.pushEntry(s)}},this)},AdminLog.prototype.loadLastEntries=function(){this.requestServerLogs("/admin/log/getlast/"+AdminLog.MAX_AMOUNT+(void 0!==this.targetEpisode?"/"+this.targetEpisode:""))},AdminLog.prototype.requestServerLogs=function(e){this.inUpdate||(this.inUpdate=!0,cleverapps.RestClient.get(e,{},function(e){this.inUpdate=!1,this.parseServeData(e)}.bind(this),function(e){this.inUpdate=!1,console.log("Error loading admin logs",e)}.bind(this)))},AdminLog.prototype.toggleMode=function(){this.inUpdate||(void 0!==this.targetEpisode?this.targetEpisode=void 0:this.targetEpisode=cleverapps.administrator.adminEpisodes.getActive().episodeNo,this.clearEntries(),this.loadLastEntries())},
AdminLog.prototype.clearEntries=function(){for(;0<this.entries.length;){this.entries.shift().remove()}},AdminLog.prototype.onChangeEpisode=function(e){void 0!==this.targetEpisode&&this.targetEpisode!==e.episodeNo&&(this.targetEpisode=e.episodeNo,this.clearEntries(),this.loadLastEntries())},AdminLog.MAX_AMOUNT=25,AdminLog.UPDATE_INTERVAL=1e4;var AdminLogEntry=function(e){cleverapps.EventEmitter.call(this),this.log=cleverapps.administrator.log,this.loadData(e)};AdminLogEntry.prototype=Object.create(cleverapps.EventEmitter.prototype),(AdminLogEntry.prototype.constructor=AdminLogEntry).prototype.save=function(t){if(this.inSaveNow)this.needSave=t;else{this.inSaveNow=!0,this.needSave=void 0;var e=function(e){e.result?(e.result.insertId&&(this.id=e.result.insertId),t&&t()):(cleverapps.Notification.create("Error saving to log"),console.log(e,this.data)),this.inSaveNow=!1,this.needSave&&this.save(this.needSave)}.bind(this);cleverapps.RestClient.post("/admin/log/",this.getInfo(),e,e)}},
AdminLogEntry.prototype.loadData=function(e){this.id=e.id,this.type=e.type,this.date=e.date||new Date,this.userName=e.userName||cleverapps.friends.getPlayer().name;var t=AdminLog.ACTIONS[e.type];for(var n in cleverapps.extend(this,t),this.params={},t.params)void 0===e[n]&&console.error("Undefined param "+n+" in type "+this.type+" action"),this.params[n]=e[n]},AdminLogEntry.prototype.getInfo=function(){return{id:this.id,type:this.type,date:this.date.getTime(),userName:this.userName,params:this.params}},AdminLogEntry.prototype.updateData=function(e,t){(e=e||{}).date&&e.date.getTime()===this.date.getTime()||(this.date=e.date||new Date,t?this.trigger("updateLogEntry"):this.save(function(){this.trigger("updateLogEntry")}.bind(this)))},AdminLogEntry.prototype.remove=function(){this.trigger("deleteLogEntry")},AdminLog.MOVE_LEVEL=0,AdminLog.TOGGLE_HARD=1,AdminLog.RENAME_EPISODE=2,AdminLog.EDIT_LEVEL=3,AdminLog.CREATE_EPISODE=4,AdminLog.CREATE_LEVEL=5,AdminLog.COPY_EPISODE=6,
AdminLog.COPY_LEVEL=7,AdminLog.ANNOTAION_CHAGE=8,AdminLog.DELETE_EPISODE=9,AdminLog.CREATE_LEVEL_VERSION=10,AdminLog.GIT_PUSH=11,AdminLog.GIT_REVERT=12,AdminLog.EPISODE_SET_DEBUG=13,AdminLog.DELETE_LEVEL=14,AdminLog.TOGGLE_TRICKY=15,AdminLog.ACTIONS={},AdminLog.ACTIONS[AdminLog.MOVE_LEVEL]={params:{toEpisodeNo:void 0,toLevelNo:void 0,fromEpisodeNo:void 0,fromLevelNo:void 0},filter:function(){return this.params.toEpisodeNo!==this.params.fromEpisodeNo||this.params.toLevelNo!==this.params.fromLevelNo},getMessage:function(){return this.params.toEpisodeNo!==this.params.fromEpisodeNo?"Move episode "+this.params.fromEpisodeNo+" level "+this.params.fromLevelNo+" to episode "+this.params.toEpisodeNo:"Episode "+this.params.fromEpisodeNo+", move level "+this.params.fromLevelNo+" to "+this.params.toLevelNo}},AdminLog.ACTIONS[AdminLog.TOGGLE_HARD]={params:{levelNo:void 0,episodeNo:void 0,madeHard:void 0},getMessage:function(){return"Episode "+this.params.episodeNo+", level "+this.params.levelNo+(
this.params.madeHard?" make hard":" remove hard")}},AdminLog.ACTIONS[AdminLog.TOGGLE_TRICKY]={params:{levelNo:void 0,episodeNo:void 0,madeTricky:void 0},getMessage:function(){return"Episode "+this.params.episodeNo+", level "+this.params.levelNo+(this.params.madeTricky?" make tricky":" remove tricky")}},AdminLog.ACTIONS[AdminLog.RENAME_EPISODE]={params:{episodeNo:void 0,newEpisodeNo:void 0},filter:function(){return this.params.episodeNo!==this.params.newEpisodeNo},getMessage:function(){return"Episode "+this.params.episodeNo+" rename to "+this.params.newEpisodeNo}},AdminLog.ACTIONS[AdminLog.EDIT_LEVEL]={updatedEntry:!0,params:{episodeNo:void 0,levelNo:void 0},getMessage:function(){return"Edit episode "+this.params.episodeNo+" level "+this.params.levelNo}},AdminLog.ACTIONS[AdminLog.CREATE_EPISODE]={params:{episodeNo:void 0},getMessage:function(){return"Create episode "+this.params.episodeNo}},AdminLog.ACTIONS[AdminLog.CREATE_LEVEL]={params:{episodeNo:void 0,levelNo:void 0},
getMessage:function(){return"Create episode "+this.params.episodeNo+" level "+this.params.levelNo}},AdminLog.ACTIONS[AdminLog.COPY_EPISODE]={params:{episodeNo:void 0,newEpisodeNo:void 0},getMessage:function(){return"Copy episode "+this.params.episodeNo+" to "+this.params.newEpisodeNo}},AdminLog.ACTIONS[AdminLog.COPY_LEVEL]={params:{episodeNo:void 0,levelNo:void 0},getMessage:function(){return"Copy episode "+this.params.episodeNo+" level "+this.params.levelNo}},AdminLog.ACTIONS[AdminLog.ANNOTAION_CHAGE]={params:{episodeNo:void 0,levelNo:void 0},getMessage:function(){return"Episode "+this.params.episodeNo+" level "+this.params.levelNo+" change annotation"}},AdminLog.ACTIONS[AdminLog.DELETE_EPISODE]={params:{episodeNo:void 0},getMessage:function(){return"Delete episode "+this.params.episodeNo}},AdminLog.ACTIONS[AdminLog.CREATE_LEVEL_VERSION]={params:{episodeNo:void 0,levelNo:void 0,version:void 0},getMessage:function(){
return"Episode "+this.params.episodeNo+" level "+this.params.levelNo+", create version "+this.params.version}},AdminLog.ACTIONS[AdminLog.GIT_PUSH]={params:{data:void 0},getMessage:function(){return"string"==typeof this.params.data?"Push "+this.params.data:"Push "+this.params.data.newFiles.concat(this.params.data.changedFiles).join(", ")}},AdminLog.ACTIONS[AdminLog.GIT_REVERT]={params:{data:void 0},getMessage:function(){return"string"==typeof this.params.data?"Revert "+this.params.data:"Revert "+this.params.data.newFiles.concat(this.params.data.changedFiles).join(", ")}},AdminLog.ACTIONS[AdminLog.EPISODE_SET_DEBUG]={params:{episodeNo:void 0,debug:void 0},getMessage:function(){return"Episode "+this.params.episodeNo+" set debug: "+this.params.debug}},AdminLog.ACTIONS[AdminLog.DELETE_LEVEL]={params:{episodeNo:void 0,levelNo:void 0},getMessage:function(){return"Episode "+this.params.episodeNo+" delete level "+this.params.levelNo}};var AdminLanguage=function(e,t,n){
cleverapps.EventEmitter.call(this),this.language=t,this.selected=n,e.adminEpisodes.onUpdateEpisodeListener=this.onUpdateEpisode.bind(this)};AdminLanguage.prototype=Object.create(cleverapps.EventEmitter.prototype),(AdminLanguage.prototype.constructor=AdminLanguage).prototype.onClick=function(){this.selected||cleverapps.administrator.setLanguage(this.language)},AdminLanguage.prototype.select=function(){this.selected=!0,this.trigger("select")},AdminLanguage.prototype.unselect=function(){this.selected=!1,this.trigger("unselect")},AdminLanguage.prototype.inProgress=function(){return void 0!==this.inProgressCache||(this.inProgressCache=AdminEpisodes.GetEpisodeNames(this.language).find(function(e){return AdminEpisode.InProgress(e,this.language)}.bind(this))),this.inProgressCache},AdminLanguage.prototype.onUpdateEpisode=function(){cleverapps.settings.language===this.language&&delete this.inProgressCache},AdminLanguage.IsAvailable=function(){return"board"===cleverapps.config.type}
;var AdminQuickNavigation={episodeNo:void 0,levelNo:void 0,suggestions:[],go:function(t){var n=AdminQuickNavigation.episodeNo,s=AdminQuickNavigation.levelNo;if(AdminQuickNavigation.episodeNo=void 0,AdminQuickNavigation.levelNo=void 0,isNaN(n)||isNaN(s))t();else{var e=cleverapps.administrator.adminEpisodes.episodes.filter(function(e){return e.episodeNo===n})[0];e?cleverapps.administrator.adminEpisodes.setActive(e,function(){var e=cleverapps.administrator.adminLevels.levels[s];cleverapps.administrator.adminLevels.setActive(e),cleverapps.administrator.adminEpisodes.scrollToEp(n),t()}.bind(this)):t()}},isMostlyDigits:function(e){if(0===e.length)return!1;for(var t=0,n=0;n<e.length;n++)"0"<=e[n]&&e[n]<="9"&&t++;return 0<t&&t>=e.length-1},handle:function(e,t){AdminQuickNavigation.suggestions=[],this.isMostlyDigits(e)||"board"!==cleverapps.config.type?t(this.handleNumber(e)):this.handleText(e,t)},handleText:function(e,t){cleverapps.RestClient.get("/admin/search/levelword/"+e,{},function(e){
AdminQuickNavigation.suggestions=e||[],t(0<e.length)},function(e){cleverapps.Notification.create("Search level error"),console.log("Search error",e),t(!1)})},handleNumber:function(e){var t=parseInt(e),n=""+t;if(e===n)this.setHumanReadableNumber(t);else{var s=e.replace(n,"");this.set(n,parseInt(s)||0)}return!0},setHumanReadableNumber:function(e){this.set(Math.floor((e-1)/Episode.LEVELS_PER_EPISODE),(e-1)%Episode.LEVELS_PER_EPISODE)},set:function(e,t){AdminQuickNavigation.episodeNo=this.checkEp(e),AdminQuickNavigation.levelNo=this.checkLvl(t)},checkLvl:function(e){return Math.max(0,Math.min(e,cleverapps.administrator.adminLevels.levels.length-2))},checkEp:function(e){return Math.max(0,Math.min(e,cleverapps.administrator.adminEpisodes.total-1))}},SimpleMethaDataProvider=function(){this.reset()};SimpleMethaDataProvider.prototype.reset=function(){this.data=void 0},SimpleMethaDataProvider.prototype.getData=function(){if(this.data)return this.data;if(!["scramble","tripeaks"].includes(
cleverapps.config.name))return this.data={};var s={},e=function(e,t,n){s[e+"_"+t]={text:"BG"+n,icon:bundles.admin.frames.feature_bg,tooltip:Messages.has("background_name_"+n)?Messages.get("background_name_"+n):""}};e(0,0,0);for(var t=Math.min(2*cleverapps.simple.bgsAmount,Episodes.calcAmountEpisodes()),n=0,i=0,o=0;o<t&&i<cleverapps.simple.bgsAmount;o++)for(var r=Episode.BundleId(o),a=bundles[r],c=0;c<Episode.LEVELS_PER_EPISODE;c++)n>=cleverapps.simple.getRequiredStars(i)&&(n=0,e(o,c,++i)),n+=a.hard.includes(c)?3:1;return this.data=s},SimpleMethaDataProvider.prototype.getEvents=function(e,t){var n=this.getData()[e+"_"+t];return n?[n]:[]};var AdminConfig={difficulty:{match3:[{bottom:60,top:95}],solitaire:[{bottom:60,top:85},{episode:10,bottom:65,top:92}]},getConfig:function(e){var t,n=AdminConfig[e][cleverapps.config.type];if(n)return n.forEach(function(e){(!e.episode||e.episode<=cleverapps.administrator.adminEpisodes.getActive().episodeNo)&&(t=e)}),t}},AdminFBProducts=function(){
this.batchesMap=[],this.productsToUpdate=[],this.onChangeStatus=function(){}};AdminFBProducts.prototype.setUpdateData=function(e,t){this.productsToUpdate=e,this.langsToUpdate=t},AdminFBProducts.prototype.processUpdate=function(){this.productsToUpdate=[],this.langsToUpdate=[],cleverapps.metha.display({focus:"AdminFBProductsWindow",actions:[function(e){new AdminFBProductsWindow(this),cleverapps.metha.onceNoWindowsListener=e}.bind(this),function(e){this.productsToUpdate.length&&this.langsToUpdate.length&&this.makeRequest(),e()}.bind(this)]})},AdminFBProducts.prototype.makeRequest=function(){this.onChangeStatus();var e=function(e){cleverapps.Notification.create("Failed fetching fb products data"),console.log(e),this.onChangeStatus()}.bind(this);cleverapps.RestClient.get("/admin/fbproducts/"+this.productsToUpdate+"/"+this.langsToUpdate,{},this.updateProducts.bind(this),e)},AdminFBProducts.prototype.updateProducts=function(e){var n=this.createBatches(e);n.forEach(function(e,t){FB.api("",
"post",{batch:e},function(e){e.error?(console.log("Error updating batch "+t,e.error),console.log(this.batchesMap[t])):this.parseBatchResponse(e,t),t===n.length-1&&(cleverapps.Notification.create("Finished fb products cache update"),this.onChangeStatus())}.bind(this))},this)},AdminFBProducts.prototype.parseBatchResponse=function(e,t){var i=this.batchesMap[t];e.forEach(function(e,t){var n=JSON.parse(e.body);if(200!==e.code)console.log("Error updating "+i[t],n.error);else if(n.error||!n.description){var s=n.error;s||(s="website"===n.type?n.title:"empty description"),console.log("Error updating "+i[t],s)}else n.image||console.log("No image for "+i[t]+", possible wrong size (200x200 required)")})},AdminFBProducts.prototype.createBatches=function(e){this.batchesMap=[];var r=[],a=[],c=function(e){this.batchesMap[r.length]||(this.batchesMap[r.length]=[]),this.batchesMap[r.length].push(e)}.bind(this),t=function(e,t){for(var n in e)for(var s in e[n]){var i=(t?"staging ":"production ")+n+"/"+s,
o=e[n][s];c(i),a.push({method:"post",relative_url:"/",body:"scrape=true&id="+encodeURIComponent(o)}),50===a.length&&(r.push(a),a=[])}};return t(e.prod),t(e.stand,!0),a.length&&r.push(a),r};var AdministratorScene=cleverapps.FixedWidthScene.extend({ctor:function(){this._super(cleverapps.Environment.SCENE_ADMINISTRATOR),this.mode=AdministratorScene.MODES.HORIZONTAL,this.nodes={},this.nodes.adminEpisodes=new AdminEpisodesView(cleverapps.administrator.adminEpisodes),this.nodes.adminLevels=new AdminLevelsView(cleverapps.administrator.adminLevels);var e=cleverapps.UI.getSceneSize().width-this.nodes.adminEpisodes.width-this.nodes.adminLevels.width;this.nodes.adminDetails=new AdminDetailsView(cleverapps.administrator.adminDetails,{width:e}),this.createGlobalButtons();var t=new cleverapps.Layout(cleverapps.values(this.nodes),{direction:cleverapps.UI.HORIZONTAL});t.setAnchorPoint2(0,1),t.setPositionRound(0,this.height),this.scene.addChild(t),this.calcMode()},closeAction:function(){
AdministratorScene.close(),cleverapps.config.adminMode=!1,cleverapps.setUrlHash({adminEpisode:void 0,adminLevel:void 0,playLevel:void 0}),Game.currentGame=void 0,cleverapps.FixedWidthScene.prototype.closeAction.call(this)},calcMode:function(){var e=AdministratorScene.MODES.HORIZONTAL;this.mode!==e&&(this.mode=e,cleverapps.values(this.nodes).forEach(function(e){e.switchMode(this.mode)},this))},setBackground:function(){var e=cc.director.getWinSize(),t=this.background=new cc.LayerColor(new cc.Color(255,255,255,255),e.width,e.height);t.setAnchorPoint(.5,.5),t.setPositionRound(0,-cleverapps.UI.getSceneOffsetY()),t.setLocalZOrder(-10),this.updateBackgroundScale(),this.scene.addChild(t)},createGlobalButtons:function(){this.adminGitButtons=new GitButtonsView(cleverapps.administrator.adminGitButtons),this.nodes.adminDetails.addChild(this.adminGitButtons),this.createProductsCacheButton()},createProductsCacheButton:function(){if("undefined"!=typeof FB&&FB.api){var e=new AdminFbProductsButton(
new AdminFBProducts);e.setPositionRound(cleverapps.styles.AdminFbProductsButton),this.nodes.adminDetails.addChild(e)}}});AdministratorScene.BUNDLES=function(){var e=["admin","game"];return e=e.concat(AdminLevelMiniature.bundles.match3()).concat(AdminLevelMaxiature.bundles.match3()),cleverapps.unique(e)},AdministratorScene.close=function(){Game.currentGame&&Game.currentGame instanceof FakeGame&&Game.currentGame.stop()},AdministratorScene.open=function(t){levels.episodes.onAddEpisode=function(){},cleverapps.metha.display({focus:"administrator",actions:[function(e){cleverapps.administrator.adminEpisodes.updateFromServer(e)},function(e){cleverapps.scenes.replaceScene(new AdministratorScene,e),cleverapps.config.adminMode=!0},function(e){t?cleverapps.administrator.reloadActiveEpisode(e):e()}]})},function(){var n=cleverapps.getRequestParameters(location.hash);n.adminEpisode&&(cleverapps.isLocalhost()||cleverapps.isStagingHost())&&(cleverapps.Plot.onStartup=function(e,t){if(
cleverapps.config.adminMode=!0,n.playLevel){if(t)return cleverapps.metha.getMainScene();LevelManager.getInstance().setLevel({episodeNo:n.adminEpisode,levelNo:n.adminLevel||0}),LevelManager.getInstance().episode.whenLoaded(function(){LevelManager.getInstance().playLevel(e)})}else{if(t)return AdministratorScene;cleverapps.scenes.replaceScene(new AdministratorScene(cleverapps.administrator),e)}})}(),AdministratorScene.IS_WIDE=!0,AdministratorScene.MODES={HORIZONTAL:0,VERTICAL:1},cleverapps.styles.COLORS=cleverapps.overrideColors(cleverapps.styles.COLORS,{ADMIN_TEXT_COLOR:new cc.Color(89,144,221,255)});var AdminLevelAnnotation={};AdminLevelAnnotation.Passive=cc.Node.extend({ctor:function(e,t){this._super(),this.adminLevel=cleverapps.administrator.adminLevels.getActive();var n=cleverapps.styles.AdminLevelAnnotation;this.setContentSize2(e-cleverapps.styles.AdminLevelAnnotation.padding.x,Math.max(n.minHeight,t)),this.setAnchorPoint2(),this.createBg(),this.createContent(),this.custom()},
custom:function(){this.reset(),this.adminLevel.on("change:comment",this.reset.bind(this),this)},reset:function(){var e=this.adminLevel.comments||"";""!==e?(this.setVisible(!0),this.text.setString(e),this.text.setPositionRound(this.text.width/2,this.text.height/2),this.content.setContentSize2(this.text.getContentSize()),this.scroll.updateInnerContent()):this.setVisible(!1)},createBg:function(){this.bg=cleverapps.UI.createScale9Sprite(bundles.admin.frames.tool_tip_bg,cleverapps.UI.Scale9Rect.TwoPixelXY),this.bg.setContentSize(this.getContentSize()),this.bg.setPositionRound(this.width/2,this.height/2),this.addChild(this.bg,-1)},createContent:function(){var e=this.content=new cc.Node;this.createTxt();var t=cleverapps.styles.AdminLevelAnnotation.scroll,n=this.scroll=new cleverapps.UI.ScrollView(e,{childrenVisibility:cleverapps.UI.ScrollView.CHILDREN_VISIBILITY_NONE});n.setContentSize(this.width,this.height-t.paddingY),n.setPositionRound(this.width/2,this.height/2),n.setBarPadding(t.bar),
this.addChild(n,-1)},createTxt:function(){var e=cleverapps.styles.AdminLevelAnnotation,t=this.text=cleverapps.UI.generateTTFText(this.adminLevel.comments||"",cleverapps.styles.FONTS.ADMIN_TOOLTIP_TEXT);t.setHorizontalAlignment(cc.TEXT_ALIGNMENT_LEFT),t.setDimensions(this.width-e.textPadding.x,0),this.content.addChild(t),this.content.setContentSize2(t.getContentSize()),t.setPositionRound(t.width/2,t.height/2)}}),AdminLevelAnnotation.Active=AdminLevelAnnotation.Passive.extend({ctor:function(){var e=cc.director.getRunningScene().nodes.adminDetails.width,t=cleverapps.styles.AdminLevelAnnotation;this._super(e,t.active.height),this.setCascadeOpacityEnabled(!0),this.setOpacity(0),this.runAction(new cc.Sequence(new cc.FadeIn(.2),new cc.CallFunc(function(){this.text.setFocus()}.bind(this)))),this.setEvents()},custom:function(){var e=AdminLevelAnnotation.EMOJI.map(function(e){var t=cleverapps.UI.generateTTFText(e,cleverapps.styles.FONTS.ADMIN_TOOLTIP_TEXT);return cleverapps.UI.applyHover(t),
cleverapps.UI.onClick(t,function(){this.text.setString(this.text.getString().slice(0,this.text._renderCmd._edTxt.selectionStart)+e+this.text.getString().slice(this.text._renderCmd._edTxt.selectionStart))}.bind(this),{swallowTouches:!1}),t},this),t=this.emoji=new cleverapps.Layout(e,{direction:cleverapps.UI.HORIZONTAL});this.addChild(t),t.setPositionRound(cleverapps.styles.AdminLevelAnnotation.emoji)},createTxt:function(){var e=cleverapps.styles.AdminLevelAnnotation,t=this.text=new cc.EditBox(cc.size(this.width-e.textPadding.x,this.height-e.textPadding.y));t.setMaxLength(-1),t.baseTxt=this.adminLevel.comments||"",t.setString(t.baseTxt),t.setDelegate(this),t.stayOnTop(!0),t.setTouchEnabled(),t.setFontColor(new cc.Color(cleverapps.styles.FONTS.ADMIN_TOOLTIP_TEXT.color)),t.setFontSize(cleverapps.styles.FONTS.ADMIN_TOOLTIP_TEXT.size),t.setFontName(cleverapps.UI.getFontName()),this.content.addChild(t)},editBoxEditingDidBegin:function(e){},editBoxEditingDidEnd:function(e){
this.lock||this.finish()},editBoxTextChanged:function(e,t){},editBoxReturn:function(e){this.runAction(new cc.CallFunc(function(){this.text.shiftPressed||this.finish()}.bind(this)))},finish:function(){if(this.visible){var e=this.text.getString().trim();this.text.baseTxt!==e&&(this.text.baseTxt=e,this.adminLevel.saveComments(e)),this.stopAllActions(),this.runAction(new cc.Sequence(new cc.FadeOut(.2),new cc.Hide,new cc.RemoveSelf))}},setEvents:function(){cc.eventManager.addListener({event:cc.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:!1,onTouchBegan:function(e){if(this.isDisplayed()){var t=this.convertTouchToNodeSpace(e);return cc.rectContainsPoint(cc.rect(0,0,this.width,this.height),t)||cc.rectContainsPoint(this.emoji.getBoundingBox(),t)?this.lock=!0:(this.finish(),!1)}}.bind(this),onTouchEnded:function(){this.lock=!1}.bind(this)},this),this.text._renderCmd._edTxt&&this.text._renderCmd._edTxt.addEventListener("keypress",function(e){this.text.shiftPressed=e.shiftKey}.bind(this))}}),
cleverapps.overrideFonts(cleverapps.styles.FONTS,{ADMIN_TOOLTIP_TEXT:{size:17,color:cleverapps.styles.COLORS.COLOR_BROWN}}),cleverapps.styles.AdminLevelAnnotation={minHeight:100,textPadding:{x:40,y:20},scroll:{paddingY:10,bar:{cornerPadding:10,sidePadding:10}},text:{x:{align:"left",dx:0},y:{align:"center",dy:0}},emoji:{x:{align:"left",dx:20},y:{align:"top",dy:22}},padding:{x:40},active:{height:110}},AdminLevelAnnotation.EMOJI=[""];var AdminDataView=cleverapps.Layout.AsyncChild.extend({ctor:function(e,n){this._super(),this.availableWidth=e;var t=cleverapps.administrator.adminDetails.statistics;if(t.ready){var s=this.createData(t.getData());this.reshape(s)}else cleverapps.administrator.adminLevels.getActive()&&(this.layout=this.createAnnotation(0),this.reshape(this.layout)),t.whenReady(this.createListener(function(e){this.clearData();var t=this.createData(e);this.reshape(t),n.reshapeContent()}.bind(this)),this);t.on("reset",this.clearData.bind(this),this)},clearData:function(){
this.layout&&(this.layout.removeFromParent(!0),this.layout=void 0)},createData:function(s){var i=cleverapps.styles.AdminDataView,e=new cleverapps.Layout(Object.keys(s).map(function(e){var t=cleverapps.UI.generateOnlyText(e+": ",cleverapps.styles.FONTS.ADMIN_DATA_TEXT);t.setDimensions(i.keyWidth,0);var n=cleverapps.UI.generateImageText(s[e]+"",cleverapps.styles.FONTS.ADMIN_DATA_TEXT);return n.setDimensions(i.valueWidth,0),new cleverapps.Layout([t,n],{direction:cleverapps.UI.HORIZONTAL})}.bind(this)),{direction:cleverapps.UI.VERTICAL,margin:i.rowsMargin});return this.layout=new cleverapps.Layout([e,this.createAnnotation(e.height)],{direction:cleverapps.UI.HORIZONTAL}),this.layout},createAnnotation:function(e){var t=cleverapps.styles.AdminDataView,n=this.availableWidth-t.valueWidth-t.keyWidth;return new AdminLevelAnnotation.Passive(n,e)}});cleverapps.overrideFonts(cleverapps.styles.FONTS,{ADMIN_DATA_TEXT:{name:"formal",size:18,color:cleverapps.styles.COLORS.BLACK}}),
cleverapps.styles.AdminDataView={rowsMargin:2,keyWidth:100,valueWidth:100,annotation:{x:{align:"right"},y:{align:"center"}}};var AdminDebugButton=cleverapps.UI.Button.extend({ctor:function(){var e=cleverapps.styles.AdminDebugButton;this._super({button_png:bundles.admin.frames.regular_button,button_on_png:bundles.admin.frames.regular_button_on,button_off_png:bundles.admin.frames.disabled_button,content:new cc.Sprite(bundles.admin.frames.release_icon),contentPadding:0,contentOffset:{y:0},width:e.width,height:e.height,onClicked:this.onPressed.bind(this)}),this.adminLevels=cleverapps.administrator.adminLevels,this.adminEpisodes=cleverapps.administrator.adminEpisodes,this.adminEpisodes.on("setActive",this.onChangeEpisode.bind(this),this),this.adminLevels.on("reset",this.update.bind(this),this),this.update()},onPressed:function(){cleverapps.metha.display({focus:"ToggleDebug",action:function(e){var t=this.adminEpisodes.getActive().getBundle();cleverapps.administrator.adminEpisodes.setDebug(
!t.debug,function(){this.update(),e()}.bind(this))}.bind(this)})},onChangeEpisode:function(e){this.episodeUpdateHandler&&this.episodeUpdateHandler.clear(),this.episodeUpdateHandler=e.on("change:debug",this.update.bind(this),this)},update:function(){var e=this.adminEpisodes.getActive();e&&e.getBundle()?(this.visible=!0,this.content.setSpriteFrame(bundles.admin.frames[e.debug?"debug_icon":"release_icon"]),e.debug===AdminEpisode.DEBUG_DISABLED?this.disable():this.enable()):this.visible=!1}});cleverapps.styles.AdminDebugButton={width:45,height:45};var AdminLevelMiniature={generate:function(t){var e=AdminLevelMiniature.default(),n=AdminLevelMiniature[cleverapps.config.name]||AdminLevelMiniature[cleverapps.config.type];if(n)try{var s=n(t);cleverapps.UI.fitToBox(s,cleverapps.styles.AdminLevelMiniature),e.addChild(s),s.setPositionRound(e.width/2,e.height/2)}catch(e){console.log("Error in level miniature "+cleverapps.humanReadableNumber(t.episodeNo,t.levelNo),e)}return e},merge:function(e){
var t=new Map2d(e.content.map,{visibleBox:e.content.visibleBox,waterBorder:0});t.layers=[[[]],[[]],t.layers[Map2d.LAYER_GROUND],[[]],[[]]],new FakeGame(e).map=t;var n=new Map2dView(t),s=new cc.Sprite(bundles.tiles.frames.water);s.setScale(Math.min(n.width/s.width,n.height,s.height));var i=new cc.Node;return i.setContentSize2(n.width,n.height),i.setAnchorPoint2(),s.setPositionRound({align:"center"},{align:"center"}),n.setPositionRound({align:"center"},{align:"center"}),i.addChild(s),i.addChild(n),i},default:function(){var e=cleverapps.UI.createScale9Sprite(bundles.admin.frames.lvl_miniature_bg);return e.setContentSize2(cleverapps.styles.AdminLevelMiniature.bg),e},solitaire:function(e){CardView.viewCache={};new FakeGame(e);var n=new Screen(0);cleverapps.flags.introDisabled=!0,cleverapps.flags.disableControl=!0,e.screens[0].forEach(function(e){var t=CardFactory.Create(e);t.canClick=function(){return!1},n.addCard(t)}),n.sortCards(),n.visible=!0,n.screenFlipNormalize();var t=new ScreenView(
n,{hasNext:!1,isLast:!1});return t.children.forEach(function(e){e.x-=t.width/2,e.y-=t.height/2}),cleverapps.UI.wrap(t,{considerRotation:!0}),cleverapps.flags.disableControl=!1,cleverapps.flags.introDisabled=!1,CardView.viewCache={},t},scramble:function(e){var t=cleverapps.UI.generateOnlyText(e.hint,cleverapps.styles.FONTS.ADMIN_DATA_TEXT);return t.setHorizontalAlignment(cc.TEXT_ALIGNMENT_LEFT),t.setVerticalAlignment(cc.VERTICAL_TEXT_ALIGNMENT_TOP),t.setDimensions(cleverapps.styles.AdminLevelMiniature.width,cleverapps.styles.AdminLevelMiniature.height/2),t},differences:function(e){var i=new cc.Node;i.setContentSize2(cleverapps.styles.AdminLevelMiniature),i.setAnchorPoint2();var o=new cc.Sprite(bundles.admin.frames.loading_png);i.addChild(o),o.setPositionRound(i.width/2,i.height/2);var t=new FakeGame(e),r=Differences.GetLevelBundleName(t.level);return bundles[r]&&cleverapps.bundleLoader.loadBundle(r,{onSuccess:function(){var e=new cc.Sprite(bundles[r].urls.a),t=e.width,n=e.height,
s=new cc.Sprite(bundles[r].urls.a,cc.rect((t-n)/2,0,n,n));cleverapps.UI.fitToBox(s,cleverapps.styles.AdminLevelMiniature),i.addChild(s),s.setPositionRound(i.width/2,i.height/2),o.removeFromParent()}}),i},board:function(e){var t=e.words.map(function(e,t){return t+1+". "+e}).join("\n");return cleverapps.UI.generateOnlyText(t,cleverapps.styles.FONTS.ADMIN_DATA_TEXT)},bundles:{match3:function(){var e=[];return"undefined"!=typeof Editor&&(e=e.concat(Editor.BUNDLES.filter(function(e){return bundles[e]}))),e}},match3:function(e){var t=new FakeGame(e),n=AdminLevelMiniature._match3(t,e);return n.registerCleanupCallback(function(){Game.currentGame===t&&delete Game.currentGame}),n},_match3:function(e,t){var n=e.field;t.gameField=n;var s=new cc.Node;s.setAnchorPoint2(.5,.5);var i=new cc.Node;i.setAnchorPoint(.5,.5),s.addChild(i);var o=new FloorView;o.setLocalZOrder(-1),s.addChild(o),n.onTileAdded=function(e){var t=new(e.getViewClass())(e);o.addChild(t),t.scale=1},n.onCellAdded=function(e){
var t=new(e.getViewClass())(e);i.addChild(t),t.scale=1},n.onBackgroundAdded=o.addBackground.bind(o),n.load(t),cleverapps.UI.wrap(o),cleverapps.UI.wrap(i);var r=i.getContentSize();s.setContentSize(r),o.setPositionRound(r.width/2,r.height/2),i.setPositionRound(r.width/2,r.height/2);for(var a=0;a<Field.SIZE;a++)for(var c=0;c<Field.SIZE;c++)n.cells[a][c]&&(n.cells[a][c].onAfterExplodeListener=function(){}),n.floor[a][c]&&(n.floor[a][c].onAfterExplodeListener=function(){});return s}};cleverapps.styles.AdminLevelMiniature={width:125,height:125,bg:{width:135,height:135}};var AdminLevelMaxiature={generate:function(t,e){e=e||{};var n=AdminLevelMaxiature[cleverapps.config.name]||AdminLevelMaxiature[cleverapps.config.type];if(void 0!==t&&n)try{return n(t,e)}catch(e){console.log("Error in level maxiature "+cleverapps.humanReadableNumber(t.episodeNo,t.levelNo),e)}return AdminLevelMaxiature.default()},bundles:{match3:function(){for(var e=["enemies"],t=0;bundles["enemy"+t];)e.push("enemy"+t),t++
;return e}},default:function(){return new cc.Sprite(bundles.admin.frames.loading_png)},merge:function(e){var t=new Map2d(e.content.map,{visibleBox:e.content.visibleBox,waterBorder:0});return new FakeGame(e).map=t,MergeEditor.InsertDefaults(t,e.content.field),new Map2dView(t)},solitaire:function(n){var t=function(e){var t=AdminLevel.createFromData({},n.getContent());return t.screens=[e],AdminLevelMiniature.solitaire(t)},e=n.screens.map(t),i=[],s=function(s){if(s!==h){i.forEach(function(e,t){var n=new cc.Sprite(t===s?bundles.admin.frames.lvl_selected_bg:bundles.admin.frames.lvl_bg);e.tile.setSpriteFrame(n.getSpriteFrame())});var e=t(n.screens[s]);cleverapps.UI.fitToBox(e,g),e.setPositionRound(u.getPosition()),u.parent.addChild(e),u.removeFromParent(),u=e,h=s}};if(1<n.screens.length)for(var o=cleverapps.styles.AdminLevelMaxiature.tiles,r=0;r<n.screens.length;r++){e[r].scale=.25;var a=0===r?bundles.admin.frames.lvl_selected_bg:bundles.admin.frames.lvl_bg,c=cleverapps.UI.createScale9Sprite(
a,cleverapps.UI.Scale9Rect.TwoPixelXY);c.setContentSize2(o);var l=cleverapps.UI.generateImageText(r+1,cleverapps.styles.FONTS.ADMIN_LEVEL_TEXT);l.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER),e[r].setPositionRound(c.width/2,c.height/2),cleverapps.UI.fitToBox(e[r],o.fitTo),c.addChild(e[r]);var p=new cleverapps.Layout([l,c],{direction:cleverapps.UI.VERTICAL,margin:o.margins.vertical});p.tile=c,i.push(p),cleverapps.UI.onClick(p,s.bind(this,r)),cleverapps.UI.applyHover(p)}var d=new cleverapps.Layout(i,{direction:cleverapps.UI.HORIZONTAL,margin:cleverapps.styles.AdminLevelMaxiature.tiles.margins.horizontal}),u=t(n.screens[0]),h=0,g={width:u.width*u.scaleX,height:u.height*u.scaleY};return CardView.viewCache={},new cleverapps.Layout([d,u],{direction:cleverapps.UI.VERTICAL,margin:cleverapps.styles.AdminLevelMaxiature.tiles.margins.vertical})},scramble:function(e){var t=e.words,n=new FakeGame(e),s=GameSceneBase.ChooseStyling(n.level),i=new cc.Node;if(e.hint){
var o=cleverapps.UI.generateImageText(e.hint,cleverapps.styles.FONTS.MAXIATURE_LABEL);i.addChild(o),i.setContentSize2(o.width,1.5*o.height),i.setAnchorPoint2(),o.setPositionRound({align:"center"},{align:"top"})}return new cleverapps.Layout([i].concat(t.map(function(e,t){var n=new cleverapps.Layout(e.split("").map(function(e){var t=new cc.Sprite(s.bgImage),n=new CharView(e.toUpperCase(),{noBg:!0});return n.setPositionRound(t.width/2,t.height/2),t.addChild(n),t}),{direction:cleverapps.UI.HORIZONTAL,margin:cleverapps.styles.AdminLevelMaxiature.scramble.margin.x});return n.setLocalZOrder(-t),n})),{direction:cleverapps.UI.TOP_TO_BOTTOM,margin:cleverapps.styles.AdminLevelMaxiature.scramble.margin.y})},differences:function(n,s){var i=new cc.Node;i.setContentSize2(cleverapps.styles.AdminLevelMaxiature.bg),i.setAnchorPoint2();var o=new cc.Sprite(bundles.admin.frames.loading_png);i.addChild(o),o.setPositionRound(i.width/2,i.height/2);var e=new FakeGame(n),r=Differences.GetLevelBundleName(e.level
);return bundles[r]&&cleverapps.bundleLoader.loadBundle(r,{onSuccess:function(){var e=[new cc.Sprite(bundles[r].urls.a),new cc.Sprite(bundles[r].urls.b)];n.differences.forEach(function(o,r){e.forEach(function(e){var t=cleverapps.UI.createScale9Sprite(bundles.admin.frames.area_selection,cleverapps.UI.Scale9Rect.TwoPixelXY);e.addChild(t);var n=PhotoViews.FrameSizeAndPos(new DifferenceArea(o));t.setContentSize(n),t.setPositionRound(n);var s=new cc.Sprite(bundles.admin.frames.number_bg);s.setPositionRound(t.x-t.width/2,t.y+t.height/2),$(s).styles(cleverapps.styles.AdminLevelMaxiature.label),t.parent.addChild(s);var i=cleverapps.UI.generateImageText(r+1+"",cleverapps.styles.FONTS.MAXIATURE_LABEL);i.setPositionRound(s.width/2,s.height/2),s.addChild(i)})});var t=new cleverapps.Layout(e,{direction:cleverapps.UI.VERTICAL,margin:cleverapps.styles.AdminLevelMaxiature.tiles.margins.vertical});s.enlarge||cleverapps.UI.fitToBox(t,cleverapps.styles.AdminLevelMaxiature.bg),i.addChild(t),
t.setPositionRound(i.width/2,i.height/2),o.removeFromParent()}}),i},board:function(e){return AdminLevelMiniature.board(e)},match3:function(e){var t=AdminLevelMiniature.match3(e),n=new GoalsController(Game.currentGame,t),s=n.goalsView;return s.setPositionRound(t.width/2,t.height+.6*s.height),s.rotation=0,cleverapps.values(n.viewByType).forEach(function(e){e.rotation=0}),cleverapps.UI.wrap(t),t}};cleverapps.overrideFonts(cleverapps.styles.FONTS,{MAXIATURE_LABEL:{name:"formal",size:40,color:cleverapps.styles.COLORS.COLOR_BROWN}}),cleverapps.styles.AdminLevelMaxiature={bg:{width:500,height:670},scramble:{offset:{x:{align:"left",dx:100},y:{align:"top",dy:-100}},margin:{x:-10,y:-30}},tiles:{width:160,height:210,fitTo:{width:150,height:200},margins:{vertical:10,horizontal:26}},label:{offsetX:10,offsetY:-10}};var AdminLevelView=cc.Node.extend({ctor:function(e,t){this._super(),this.adminLevel=e,this.adminLevelsView=t,this.setAnchorPoint2(),this.setContentSize2(cleverapps.styles.AdminLevelView),
this.createBg(),this.createContent(),this.createControls(),this.createTipIcon();var n=cleverapps.styles.AdminLevelView;this.flagsPanel=new AdminLevelFlagsPanel(e),this.flagsPanel.setPositionRound(n.flagsPanel),this.addChild(this.flagsPanel),e.on("select",this.select.bind(this),this),e.selected&&this.select(),e.on("unselect",this.unselect.bind(this),this),cleverapps.UI.onClick(this,this.onClick.bind(this),{swallowTouches:!1,ignoreOnTouchMoved:!0}),cleverapps.UI.applyHover(this),cleverapps.config.changeLevelsDisabled||cleverapps.UI.onDrag(this,{onDragMove:this.onDragMove.bind(this),onDragEnd:this.onDragEnd.bind(this),followPointer:!0,swallowTouches:!0,dragMinDist:n.dragMinDist}),e.on("changeDifficulty",this.updateDifficultyBar.bind(this),this),e.on("startDrag",this.startDrag.bind(this),this),e.on("stopDrag",this.stopDrag.bind(this),this),e.on("update",this.onUpdate.bind(this),this),e.on("moveToSlot",this.moveToSlot.bind(this),this),this.updateDifficultyBar(),this.updateCurrentIndicators(
)},onClick:function(){cleverapps.metha.display({focus:"AdminLevelClick",action:function(e){this.adminLevel.onClick(e)}.bind(this)})},onDragMove:function(){var e=this.adminLevelsView.getNearestSlotIndex(this.parent.convertToWorldSpace(this.getPosition()));this.adminLevel.handleDragMove(e)},onDragEnd:function(){this.adminLevel.handleDragEnd()},startDrag:function(){this._oldZOrder=this.getLocalZOrder(),this.setLocalZOrder(100),this._oldParent=this.getParent(),this.replaceParentSamePlace(cc.director.getRunningScene().scene),this.controls.setVisible(!1),this.setRotation(10),this.updateCurrentIndicators()},stopDrag:function(){this.setLocalZOrder(this._oldZOrder),this.replaceParentSamePlace(this._oldParent),this.controls.setVisible(!0),this.setRotation(0),this.updateCurrentIndicators()},moveToSlot:function(e){this.replaceParentSamePlace(e),this.stopActionByTag(AdminLevelView.MOVE_ACTION_TAG);var t=cc.p(e.width/2,e.height/2);cleverapps.administrator.adminLevels.draggingLevel?this.runAction(
new cc.MoveTo(.3,t)).setTag(AdminLevelView.MOVE_ACTION_TAG):this.setPositionRound(t)},onUpdate:function(){this.updateCurrentIndicators(),this.flagsPanel.updateFlags()},createTipIcon:function(){var t=new cc.Sprite(bundles.admin.frames.tool_tip_button);t.setPositionRound(cleverapps.styles.AdminLevelView.tip),this.addChild(t),t.setVisible(this.adminLevel.comments),this.adminLevel.on("change:comment",function(e){t.setVisible(""!==e)},this)},updateDifficultyBar:function(){var e=cleverapps.styles.AdminLevelView;if(this.difficultyBar&&(this.difficultyBar.removeFromParent(),delete this.difficultyBar),void 0!==this.adminLevel.difficulty){var t=this.adminLevel.difficulty,n=t<50?255:Math.floor(255-255*(2*t-100)/100),s=50<t?255:Math.floor(1.5*t*255/100),i=new cc.Color(s,n,0,255);this.difficultyBar=new cc.Scale9Sprite(bundles.admin.frames.difficulty_bar),this.difficultyBar.setAnchorPoint2(0,.5),this.difficultyBar.setColor(i),this.difficultyBar.setContentSize2(Math.floor(e.difficulty.width*t/100),
Math.floor(e.difficulty.height)),this.addChild(this.difficultyBar,1),this.difficultyBar.setPositionRound(e.difficulty.x,this.miniature.y-this.miniature.height/2),this.difficultyBar.setScaleX(0),this.difficultyBar.runAction(new cc.ScaleTo(.5,1,1).easing(cc.easeOut(2)))}},createBg:function(){var e=this.adminLevel.selected?bundles.admin.frames.lvl_selected_bg:bundles.admin.frames.lvl_bg,t=this.bg=cleverapps.UI.createScale9Sprite(e,cleverapps.UI.Scale9Rect.TwoPixelXY);t.setContentSize2(this.getContentSize()),t.setPositionRound(this.width/2,this.height/2),this.addChild(t)},createContent:function(){var e=cleverapps.styles.AdminLevelView,t=this.miniature=AdminLevelMiniature.generate(this.adminLevel);this.addChild(t),t.setPositionRound(e.miniature);var n=Game.currentGame;t.registerCleanupCallback(function(){n&&n.stop()});var s=this.adminLevel.getFeatures();if(0<s.length){var i=new cleverapps.Layout(s.map(function(e){return new cc.Sprite(bundles.admin.frames["feature_"+e])}),{
direction:cleverapps.UI.HORIZONTAL});this.addChild(i),i.setPositionRound(e.features)}var o=cleverapps.styles.FONTS.ADMIN_LEVEL_TEXT,r=this.adminLevel.getHint();cleverapps.UI.ImageFont.IsApplicable(o,r)?this.text=new cleverapps.UI.ImageFont(r,o):this.text=cleverapps.UI.generateOnlyText(r,o);var a=this.text;a.setDimensions(e.text.width,0),a.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER),a.fitTo(void 0,e.text.height),this.addChild(a),a.setPositionRound(e.text)},createControls:function(){var s=cleverapps.styles.AdminLevelView.controls;this.buttons=AdminLevelView.BUTTONS.filter(function(e){return!(e.available&&!e.available())}.bind(this)).map(function(e){var t=new cc.Sprite(e.icon);t.setScale(s.scale);var n=new cleverapps.UI.Button({button_png:bundles.admin.frames.regular_button,button_on_png:bundles.admin.frames.regular_button_on,content:t,fitTo:!1,contentOffset:{y:0},width:s.width,height:s.height,onClicked:function(){e.action(this.adminLevel)}.bind(this)});return n.visible=!1,n}.bind(
this));var e=this.controls=new cleverapps.Layout(this.buttons,{direction:cleverapps.UI.HORIZONTAL,margin:s.margin});e.setPositionRound(s),this.addChild(e)},updateCurrentIndicators:function(){this.removeCurrentFlag(),this.adminLevel.isCurrent()&&!this.adminLevel.dragging&&this.addCurrentFlag()},removeCurrentFlag:function(){this.currentFlag&&(this.currentFlag.removeFromParent(),delete this.currentFlag)},addCurrentFlag:function(){this.currentFlag=new cc.Sprite(bundles.admin.frames.current_arrow),this.addChild(this.currentFlag),this.currentFlag.setScale(.7),this.currentFlag.setPositionRound(cleverapps.styles.AdminLevelView.currentFlag)},select:function(){this.text.setFont(cleverapps.styles.FONTS.ADMIN_LEVEL_TEXT_SELECTED),this.bg.setSpriteFrame(new cc.Sprite(bundles.admin.frames.lvl_selected_bg).getSpriteFrame());var e=this.buttons.map(function(e){return new cc.Sequence(new cc.DelayTime(.05),new cc.CallFunc(function(){e.visible=!0,e.opacity=0,e.runAction(new cc.FadeIn(.2))}))})
;this.buttonsAction=this.runAction(new cc.Sequence(e)),this.setScale(1)},unselect:function(){this.text.setFont(cleverapps.styles.FONTS.ADMIN_LEVEL_TEXT),this.bg.setSpriteFrame(new cc.Sprite(bundles.admin.frames.lvl_bg).getSpriteFrame()),this.buttonsAction&&!this.buttonsAction.isDone()&&this.stopAction(this.buttonsAction),this.buttons.forEach(function(e){e.visible=!1})},onMouseOver:function(){!this.adminLevel.selected&&this.setScale(1.05)},onMouseOut:function(){this.setScale(1)}});AdminLevelView.MOVE_ACTION_TAG="moveAction",AdminLevelView.BUTTONS=[{icon:bundles.admin.frames.copy_icon,available:function(){return!cleverapps.config.changeLevelsDisabled},action:function(e){cleverapps.administrator.adminLevels.copyLevel(e)}},{icon:bundles.admin.frames.edit_icon,available:function(){return cleverapps.config.levelEditor},action:function(e){e.editLevel()}},{icon:bundles.admin.frames.play_icon,action:function(){AdministratorScene.close(),cleverapps.metha.display({focus:"AdminPlayLevel",
action:function(e){LevelManager.getInstance().playLevel(e)}})}}],AdminLevelView.create=function(e,t){return e.isAddMoreLevel()?new AddLevelView(e):new AdminLevelView(e,t)},cleverapps.overrideFonts(cleverapps.styles.FONTS,{ADMIN_LEVEL_TEXT_SELECTED:{name:"formal",size:21},ADMIN_LEVEL_TEXT:{name:"formal",size:21,color:cleverapps.styles.COLORS.ADMIN_TEXT_COLOR}}),cleverapps.styles.AdminLevelView={width:148,height:220,dragMinDist:20,difficulty:{width:130,height:5,x:5},controls:{scale:.85,height:45,width:45,margin:4,x:{align:"center"},y:{align:"bottom",dy:-52}},hardLevel:{x:{align:"left",dx:6},y:{align:"top",dy:-6}},tip:{x:{align:"right",dx:-10},y:{align:"bottom",dy:80}},miniature:{x:{align:"center"},y:{align:"top",dy:-5}},features:{x:{align:"center"},y:{align:"bottom",dy:20}},text:{width:140,height:36,x:{align:"center"},y:{align:"bottom",dy:7}},currentFlag:{x:{align:"left",dx:25},y:{align:"top",dy:28}},flagsPanel:{x:{align:"right",dx:0},y:{align:"top",dy:33}}}
;var AddLevelView=AdminLevelView.extend({ctor:function(e){cc.Node.prototype.ctor.call(this),this.adminLevel=e,this.setContentSize2(cleverapps.styles.AddLevelView),this.setAnchorPoint2();var t=cleverapps.UI.createScale9Sprite(bundles.admin.frames.selected_button,cleverapps.UI.Scale9Rect.TwoPixelXY);t.setContentSize2(this.getContentSize()),t.setPositionRound(this.width/2,this.height/2),this.addChild(t);var n=new cc.Sprite(bundles.admin.frames.plus_button);n.setPositionRound(this.width/2,this.height/2),this.addChild(n),cleverapps.UI.onClick(this,this.onClick.bind(this)),cleverapps.UI.applyHover(this)},onMouseOver:function(){this.setScale(1.05)},onMouseOut:function(){this.setScale(1)}});cleverapps.styles.AddLevelView={width:146,height:200};var AdminLevelsView=cc.Node.extend({ctor:function(e,t){this._super(),this.adminLevels=e,this.mode=t;var n=cc.director.getWinSize();this.setContentSize2(cleverapps.styles.AdminLevelsView.width,n.height),this.setAnchorPoint2(),this.adminLevels.on("reset",
this.reset.bind(this),this),this.adminLevels.on("addLevel",this.addLevel.bind(this),this),this.adminLevels.on("downloadLevels",this.downloadLevels.bind(this),this);var s=[],i=this.log=new AdminLogView;s.push(cleverapps.UI.wrapWithPadding(i,{x:0,y:cleverapps.styles.AdminLevelsView.logPadding})),this.scroll=this.createScroll(),s.push(this.scroll);var o=[];if(cleverapps.administrator.adminLanguages){var r=this.getLanguagesList();o.push(r)}var a=this.getTransmittingDataButtons();o.push(a);var c=new cleverapps.Layout(o,{direction:cleverapps.UI.HORIZONTAL});c.setContentSize2(this.width,a.height),s.push(c);var l=this.getChartWrapper();s.push(l);var p=new cleverapps.Layout(s,{direction:cleverapps.UI.VERTICAL});p.setAnchorPoint2(0,1),p.setPositionRound(0,this.height),this.addChild(p),a.setPositionRound(cleverapps.styles.AdminLevelsView.transmittingDataButtons.position),this.reset()},getChartWrapper:function(){var t=new cc.Node;t.setAnchorPoint2(),t.setContentSize2(this.width,
cleverapps.styles.AdminLevelsView.chart.height);var n=void 0,e=function(e){n=new AdminLevelsChart(e,t),cleverapps.UI.fitToBox(n,t.getContentSize()),n.setPositionRound(t.width/2,t.height/2),t.addChild(n)}.bind(this);return this.adminLevels.on("statisticsLoaded",e,this),this.adminLevels.episodeStatistics.ready&&e(this.adminLevels.episodeStatistics.getData()),this.adminLevels.on("statisticsReset",function(){n&&(n.removeFromParent(!0),n=void 0)},this),t},reset:function(){this.levelsList&&(this.levelsList.removeFromParent(!0),delete this.levelsList),this.levelsList=this.getLevelsList(),this.scroll.setInnerContent(this.levelsList),this.scroll.scrollTo(cleverapps.UI.ScrollView.SCROLLS.UPPER_LEFT)},getLevelsList:function(){var i=new cc.Node;return i.setAnchorPoint2(),this.slots=[],this.adminLevels.levels.forEach(function(e,t){var n=new AdminLevelSlotView(e);n.setPositionRound(this.alignInTheGrid(t)),i.addChild(n),this.slots.push(n);var s=AdminLevelView.create(e,this);s.setPositionRound(
n.width/2,n.height/2),n.addChild(s),e.isAddMoreLevel()||e.on("update",function(){this.slots[e.levelNo].updateAdminLevel(e)}.bind(this),i)}.bind(this)),cleverapps.UI.wrap(i),i},createScroll:function(){var e=new cleverapps.UI.ScrollView;return e.setContentSize2(this.width,cleverapps.styles.AdminLevelsView.levels.height),e.setLocalZOrder(-1),e},addLevel:function(){this.reset()},getNearestSlotIndex:function(e){for(var t=this.levelsList.convertToNodeSpace(e),n=Number.MAX_VALUE,s=0,i=0;i<this.slots.length-1;i++){var o=this.slots[i],r=cc.pDistance(t,o.getPosition());r<n&&(n=r,s=i)}return s},getLanguagesList:function(){var e=cleverapps.styles.AdminLevelsView.languageBlock,t=(e.width+e.margin-2*e.padding.x)/cleverapps.config.languages.length-e.margin,n=cleverapps.values(cleverapps.administrator.adminLanguages).map(function(e){return new AdminLanguageView(e,{width:t})});return new cleverapps.Layout(n,{direction:cleverapps.UI.HORIZONTAL,margin:e.margin,padding:e.padding})},
getTransmittingDataButtons:function(){var t=cleverapps.styles.AdminLevelsView.transmittingDataButtons,e=[];e.push({icon:bundles.admin.frames.download_icon,action:function(){cleverapps.metha.display({focus:"DownloadLevels",action:function(e){this.adminLevels.download(e)}.bind(this)})}.bind(this)}),e.push({icon:bundles.admin.frames.upload_icon,action:function(){cleverapps.metha.display({focus:"UploadLevels",action:function(t){var e=document.createElement("input");e.setAttribute("type","file"),e.setAttribute("id","uploadLevels"),e.style.display="none",document.body.appendChild(e),e.click(),e.addEventListener("change",function(e){this.adminLevels.upload(e,t)}.bind(this))}.bind(this)})}.bind(this)}),"scramble"===cleverapps.config.name&&e.push({icon:bundles.admin.frames.update_icon,action:function(){cleverapps.metha.display({focus:"AdminUpdateGooglesheetsWindow",action:function(e){new AdminUpdateGooglesheetsWindow,cleverapps.metha.onceNoWindowsListener=e}.bind(this)})}.bind(this)}),e.push({
icon:bundles.admin.frames.update_diff_icon,action:function(e){cleverapps.metha.display({focus:"updateDifficultyDocs",action:function(e){var t=new WaitWindow("Updating...");cleverapps.metha.onceNoWindowsListener=e;var n=cleverapps.waitNoMore(8e3,cleverapps.once(function(){t.close()}.bind(this)));cleverapps.administrator.adminEpisodes.gatherDifficultyData(function(e){cleverapps.RestClient.post("/admin/epdifficulty/upload/",e,function(e){e.error?console.log("Failed uploading difficulty statistics",e.error):console.log("Updated difficulty docs https://docs.google.com/spreadsheets/d/1CSamhReQazPJb7p8hEwuf2ntUTTrxjSz5Dkb_JRI54Q"),n()},function(e){console.log("Error uploading difficulty statistics",e),n()})})}.bind(this)})}});var n=[new AdminDebugButton].concat(e.map(function(e){return new cleverapps.UI.Button({button_png:bundles.admin.frames.regular_button,button_on_png:bundles.admin.frames.regular_button_on,button_off_png:bundles.admin.frames.disabled_button,content:new cc.Sprite(e.icon),
contentOffset:{y:0},contentPadding:0,width:t.width,height:t.height,onClicked:e.action})}.bind(this)));return new cleverapps.Layout(n,{direction:cleverapps.UI.HORIZONTAL,margin:t.margin})},downloadLevels:function(e){var t=e.data,n=e.fileName,s=document.createElement("a");s.setAttribute("href","data:text/json;charset=utf-8,"+encodeURIComponent(t)),s.setAttribute("download",n),s.style.display="none",document.body.appendChild(s),s.click(),document.body.removeChild(s)},switchMode:function(e){this.reset(e)},alignInTheGrid:function(e){var t=cleverapps.styles.AdminLevelsView,n=t.marginCol,s=t.marginRow,i=t.width,o=t.cellSize,r=Math.floor(i/(o.width+n)),a=e%r,c=Math.floor(e/r);return cc.p(o.width/2+a*(o.width+n),(this.levelsList?this.levelsList.height:0)-o.height/2-c*(o.height+s)-t.paddingTop)}});cleverapps.styles.AdminLevelsView={paddingTop:50,marginCol:10,marginRow:40,logPadding:10,levels:{height:800},chart:{height:300},width:780,cellSize:{width:140,height:220},languageBlock:{width:530,
margin:2,padding:{x:0,y:10}},transmittingDataButtons:{margin:2,width:45,height:45,position:{x:{align:"right"},y:{align:"center"}}}};var AdminLevelsChart=cc.Sprite.extend({ctor:function(e,t){this.load(),this.prepareData(e),this.wrapper=t,this._super(this.createChart()),this.points.length&&(cleverapps.administrator.adminLevels.on("chartUpdate",function(){cleverapps.administrator.adminLevels.ready&&this.setCurrentLvl()}.bind(this),this),this.setControls()),this.registerCleanupCallback(this.removeChart.bind(this))},prepareData:function(e){var t=0,n={};e.forEach(function(e){n[e.levelNo]=!0,e.levelNo>t&&(t=e.levelNo)});for(var s=0;s<t;s++)n[s]||e.push({level:s,difficulty:0,hints:0});e.sort(function(e,t){return e.levelNo-t.levelNo}),this.labels=e.map(function(e){return e.levelNo}),this.prepareDataSets(e)},prepareDataSets:function(e){this.dataSets={},this.dataSets.difficulty={label:"Difficulty",fromZero:!0,data:e.map(function(e){return e.difficulty})},this.dataSets.hints={label:"Hints",
data:e.map(function(e){return e.hints||0})},-1!==["board","solitaire"].indexOf(cleverapps.config.type)&&(this.dataSets.minutes={label:"Minutes",fromZero:!0,data:e.map(function(e){return e.minutes||0})}),Object.keys(this.dataSets).forEach(function(e){this.dataSets[e].active=-1!==this.activeSets.indexOf(e)},this)},removeChart:function(){this.chart&&(this.chart.destroy(),delete this.chart);var e=document.getElementById("adminlevelschart");e&&e.parentNode.removeChild(e)},createChart:function(){this.removeChart();var e=document.getElementById("adminlevelschart");e||(e=document.createElement("canvas"),document.body.appendChild(e)),e.id="adminlevelschart",e.height=this.wrapper.height,e.width=this.wrapper.width,this.chart=new Chart(e.getContext("2d"),{type:"line",data:{labels:this.labels,datasets:this.getDataSets()},options:{scales:{yAxes:this.getYAxes()},responsive:!1,animation:{duration:0},hover:{animationDuration:0},responsiveAnimationDuration:0,tooltips:{position:"custom",displayColors:!1,
callbacks:this.getToolTipCallbacks(),bodyFontStyle:"bold"},annotation:this.getAnnotations()}});var n=this.chart.currentDevicePixelRatio;return this.points=this.chart.getDatasetMeta(0).data.map(function(e){var t=e.getCenterPoint();return cc.p(t.x*n,t.y*n)}),this.legentBoxes=this.chart.legend.legendHitBoxes.map(function(e){return cc.rect(e.left*n,(this.chart.height-e.top-e.height)*n,e.width*n,e.height*n)},this),e},setCurrentLvl:function(){this.setSpriteFrame(new cc.Sprite(this.createChart()).getSpriteFrame()),this.save()},getAnnotations:function(){var e=AdminConfig.getConfig("difficulty");if(e&&-1!==this.activeSets.indexOf("difficulty"))return{annotations:[{type:"line",mode:"horizontal",scaleID:"y-axis-0",value:e.top,borderColor:"tomato",borderWidth:1},{type:"line",mode:"horizontal",scaleID:"y-axis-0",value:e.bottom,borderColor:"tomato",borderWidth:1}]}},getDataSets:function(){var n=[];this.labels.forEach(function(e){n.push(
cleverapps.administrator.adminLevels.active&&e===cleverapps.administrator.adminLevels.active.levelNo?10:3)});var e=function(e,t){return{label:e.label,fill:!1,hidden:!e.active,backgroundColor:this.getColor(t),borderColor:this.getColor(t),data:e.data,yAxisID:"y-axis-"+t,radius:n}}.bind(this),t=[],s=0;for(var i in this.dataSets)t.push(e(this.dataSets[i],s++));return t},getYAxes:function(){var e,t,n,s=!0,i=!0,o=[],r=0;for(var a in this.dataSets)o.push((e=r++,t=this.dataSets[a],void 0,n={display:t.active,position:i?"left":"right",id:"y-axis-"+e,gridLines:{drawOnChartArea:s},ticks:{beginAtZero:t.fromZero}},t.active&&(s=!1,i=!i),n));return o},getColor:function(e){var t=["rgb(255, 99, 132)","rgb(54, 162, 235)","rgb(125, 32, 223)","rgb(249, 228, 6)","rgb(130, 223, 32)"];return t[e%t.length]},getToolTipCallbacks:function(){var s=function(s){return function(e,t){var n=Array.isArray(e)?e[0].xLabel:e.xLabel;return t.datasets[s].label+": "+t.datasets[s].data[n]}.bind(this)}.bind(this),i=[
"beforeBody","beforeLabel","afterLabel","afterBody","beforeFooter","footer","afterFooter"],o={},r=0;return cleverapps.values(this.dataSets).forEach(function(e,t){var n=i[r];e.active&&n&&(o[n]=s(t),r++)}),o.label=function(){},o},toggleActiveData:function(e){var t=cleverapps.values(this.dataSets)[e];t.active=!t.active,this.activeSets=[];var n=0;for(var s in this.dataSets)e===n++&&(this.dataSets[s].active=!this.dataSets[s].active),this.dataSets[s].active&&this.activeSets.push(s);this.save(),this.setCurrentLvl()},setControls:function(){var s=function(e){for(var t=0,n=9999,s=0;s<this.points.length;s++){var i=Math.abs(this.points[s].x-e.x);i<n&&(n=i,t=s)}return t}.bind(this),i=function(e){var t=this.chart.chartArea,n=this.chart.currentDevicePixelRatio;return cc.rectContainsPoint(cc.rect(t.left*n,0,t.right*n,t.bottom*n),e)}.bind(this),o=function(e){for(var t in this.legentBoxes)if(cc.rectContainsPoint(this.legentBoxes[t],e))return this.toggleActiveData(t),!0}.bind(this)
;cc.eventManager.addListener({event:cc.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:!0,onTouchBegan:function(e){var t=this.convertTouchToNodeSpace(e);if(i(t)){var n=cleverapps.administrator.adminLevels.levels[s(t)];return n&&!n.isAddMoreLevel()&&cleverapps.administrator.adminLevels.setActive(n),!0}return o(t)}.bind(this)},this)},save:function(){cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.ADMIN_CHART,this.activeSets)},load:function(){this.activeSets=cleverapps.DataLoader.load(cleverapps.DataLoaderTypes.ADMIN_CHART)||["difficulty","hints"]}});AdminLevelsChart.PrepareChart=function(){Chart.plugins.register({beforeDraw:function(e){var t=e.chart.ctx;t.fillStyle="white",t.fillRect(0,0,e.chart.width,e.chart.height)}}),Chart.pluginService.register({beforeRender:function(e){if(e.getDatasetMeta(0).data.length&&cleverapps.administrator.adminLevels.active){var t=e.getDatasetMeta(0).data[cleverapps.administrator.adminLevels.active.levelNo];t&&(e.pluginTooltip=new Chart.Tooltip({
_chart:e.chart,_chartInstance:e,_data:e.data,_options:e.options.tooltips,_active:[t]}),e.options.tooltips.enabled=!1)}},afterDraw:function(e){e.pluginTooltip&&(e.options.tooltips.enabled=!0,e.pluginTooltip.initialize(),e.pluginTooltip.update(),e.pluginTooltip.pivot(),e.pluginTooltip.draw(),e.options.tooltips.enabled=!1)}}),Chart.Tooltip.positioners.custom=function(e){if(!e.length||!e[0]||!cleverapps.administrator.adminLevels.active)return!1;for(var t=[],n=0;n<e[0]._chart.data.datasets.length;n++){var s=e[0]._chart.getDatasetMeta(n).data[cleverapps.administrator.adminLevels.active.levelNo].getCenterPoint();e[0]._chart.data.datasets[n].hidden||t.push(cc.p(s.x,s.y))}return t.length?(t.sort(function(e,t){return e.y>t.y?1:-1}),t[0]):{x:-1e3,y:0}}.bind(this)};var AdminLevelFlagsPanel=cleverapps.Layout.AsyncChild.extend({ctor:function(e,t){this._super(),this.adminLevel=e,(this.maxi=t)||this.setScale(.8),this.updateFlags(),e.on("update",this.updateFlags.bind(this),this),e.on("change:hard",
this.updateFlags.bind(this),this),AdminConfig.getConfig("difficulty")&&e.on("changeDifficulty",this.updateFlags.bind(this),this)},updateFlags:function(){if(this.removeAllChildren(),!this.adminLevel.dragging){var e=this.listBoostersBefore().concat(this.listBoosters()).concat(this.addGun()).concat(cleverapps.administrator.simpleMethaDataProvider.getEvents(parseInt(this.adminLevel.episodeNo),this.adminLevel.levelNo)).map(function(e){var t=new cc.Sprite(bundles.admin.frames.yellow_flag),n=new cc.Sprite(e.icon);return n.setPositionRound(t.width/2,t.height/2),t.addChild(n),cleverapps.UI.fitToBox(n,{width:.8*t.width,height:.8*t.height}),e.tooltip&&cleverapps.tooltipManager.create(t,{text:e.tooltip,position:cleverapps.styles.UI.Tooltip.LOCATION.below,size:cleverapps.styles.UI.Tooltip.SIZE.short}),t});this.adminLevel.hard&&e.push(new cc.Sprite(bundles.admin.frames.hard_level_mark)),this.adminLevel.tricky&&e.push(new cc.Sprite(bundles.admin.frames.tricky_level_mark));var t=AdminConfig.getConfig(
"difficulty");t&&(this.adminLevel.difficulty<t.bottom||this.adminLevel.difficulty>t.top)&&e.push(new cc.Sprite(bundles.admin.frames.attention_icon));var n=cleverapps.styles.AdminLevelFlagsPanel,s=new cleverapps.Layout(this.maxi?e.reverse():e,{direction:this.maxi?cleverapps.UI.HORIZONTAL:cleverapps.UI.VERTICAL,margin:n.margin});this.reshape(s)}},listBoostersBefore:function(){return[BoostersBefore.TYPE_COMBO,BoostersBefore.TYPE_MOVES,BoostersBefore.TYPE_MULTICOLOR,BoostersBefore.TYPE_MAGNET,BoostersBefore.TYPE_DICE,BoostersBefore.TYPE_TWO_JOKERS,BoostersBefore.TYPE_HIGHLIGHT,BoostersBefore.TYPE_EYE,BoostersBefore.TYPE_HINT].filter(function(e){return void 0!==e&&this.isDiscoveredHere(BoostersBeforeConfig[e].available)&&BoostersBeforeConfig[e].icon}.bind(this)).map(function(e){return cleverapps.extend({},BoostersBeforeConfig[e],{icon:this.getBoosterIcon(e,!0)})},this)},listBoosters:function(){var e=[];return"scramble"===cleverapps.config.name?e=[HintBooster,ShuffleBooster
]:"match3"===cleverapps.config.type?e=[CellBooster,LineBooster,ColorBooster]:"board"===cleverapps.config.type?e=[HintBooster]:"solitaire"===cleverapps.config.type?e=[WildcardBooster]:"differences"===cleverapps.config.name&&(e=[BrushBooster,DiscoverBooster]),e.filter(function(e){return this.isDiscoveredHere(e.AVAILABLE||"undefined"!=typeof BaseBooster&&BaseBooster.AVAILABLE[e.ID])}.bind(this)).map(function(e){return{icon:this.getBoosterIcon(e.ID),tooltip:e.name}},this)},addGun:function(){return this.isDiscoveredHere(Gun.AVAILABLE)?[{icon:bundles.admin.frames.gun_icon}]:[]},isDiscoveredHere:function(e){return void 0===e.level&&(e.level=0),void 0===e.episode&&(e.episode=0),parseInt(this.adminLevel.episodeNo)===e.episode&&this.adminLevel.levelNo===e.level},getBoosterIcon:function(e,t){var n={};return t?(n[BoostersBefore.TYPE_COMBO]=bundles.admin.frames.heroes_png,n[BoostersBefore.TYPE_MOVES]=bundles.admin.frames.moves_png,
n[BoostersBefore.TYPE_MULTICOLOR]=bundles.admin.frames.multicolor_png,n[BoostersBefore.TYPE_MAGNET]=bundles.admin.frames.magnet_png,n[BoostersBefore.TYPE_DICE]=bundles.admin.frames.dice_png,n[BoostersBefore.TYPE_TWO_JOKERS]=bundles.admin.frames.joker_png,n[BoostersBefore.TYPE_HIGHLIGHT]=bundles.admin.frames.highlight,n[BoostersBefore.TYPE_EYE]=bundles.admin.frames.eye,n[BoostersBefore.TYPE_HINT]=bundles.admin.frames.hint):("undefined"!=typeof HintBooster&&(n[HintBooster.ID]=bundles.admin.frames.hint_icon_png),"undefined"!=typeof ShuffleBooster&&(n[ShuffleBooster.ID]=bundles.admin.frames.shuffle_png),"undefined"!=typeof CellBooster&&(n[CellBooster.ID]=bundles.admin.frames.cellbooster),"undefined"!=typeof LineBooster&&(n[LineBooster.ID]=bundles.admin.frames.linebooster),"undefined"!=typeof ColorBooster&&(n[ColorBooster.ID]=bundles.admin.frames.colorbooster),"undefined"!=typeof WildcardBooster&&(n[WildcardBooster.ID]=bundles.admin.frames.wildcard_png),"undefined"!=typeof BrushBooster&&(
n[BrushBooster.ID]=bundles.admin.frames.pot),"undefined"!=typeof DiscoverBooster&&(n[DiscoverBooster.ID]=bundles.admin.frames.hat)),n[e]}});cleverapps.styles.AdminLevelFlagsPanel={margin:10};var AdminEpisodeView=cc.Node.extend({ctor:function(e){this.episode=e,this.createButton(),this._super(),this.setContentSize2(this.button.getContentSize()),this.setAnchorPoint2(),this.button.setPositionRound(this.width/2,this.height/2),this.addChild(this.button),this.createIndicator(),this.updateCurrentIndicators(),e.on("select",this.select.bind(this),this),e.on("unselect",this.unselect.bind(this),this),e.selected&&this.select(),this.button.onMouseOver=function(){this.button.setScale(1.05*this.button.baseScale||1.05),e.hover()}.bind(this),this.button.onMouseOut=function(){this.button.setScale(void 0===this.button.baseScale?1:this.button.baseScale),e.unhover()}.bind(this),e.on("update",this.onUpdateEpisode.bind(this),this),e.on("change:debug",this.onUpdateEpisode.bind(this),this),this.onUpdateEpisode(
)},createButton:function(){var e=cleverapps.styles.AdminEpisodeView;this.episode.isAddMoreEpisode()&&(e=cleverapps.overrideStyles(e,e.plus,!0));var t=cleverapps.UI.ImageFont.IsApplicable(cleverapps.styles.FONTS.ADMIN_TEXT,this.getTitle())?cleverapps.UI.generateImageText(this.getTitle(),cleverapps.styles.FONTS.ADMIN_TEXT):cleverapps.UI.generateOnlyText(this.getTitle(),cleverapps.styles.FONTS.ADMIN_TEXT);t.fitTo(e.width);var n=this.button=new cleverapps.UI.Button({button_png:e.image,button_on_png:e.image,button_off_png:e.image,content:t,width:e.width,onClicked:function(){cleverapps.metha.display({focus:"adminEpisodeClick",action:this.episode.onClick.bind(this.episode)})}.bind(this),swallowTouches:!1,ignoreOnTouchMoved:!0});n.text=t,this.episode.isAddMoreEpisode()||(n.text.baseFontSize=n.text.getFontSize())},getTitle:function(){return this.episode.isAddMoreEpisode()?"":this.episode.isNumeric()?this.episode.episodeNo+". "+(this.episode.start+1)+"-"+(this.episode.end+1
):this.episode.episodeNo+""},createIndicator:function(){var e=this.indicator=new cc.Sprite(bundles.admin.frames.in_process);e.setVisible(this.episode.inProgress()),e.setPositionRound(cleverapps.styles.AdminEpisodeView.indicator),this.button.addChild(e)},updateCurrentIndicators:function(){this.episode.isCurrent()?this.currentFlag||this.addCurrentFlag():this.currentFlag&&(this.currentFlag.removeFromParent(!0),delete this.currentFlag)},addCurrentFlag:function(){this.currentFlag=new cc.Sprite(bundles.admin.frames.current_arrow),this.button.addChild(this.currentFlag),this.currentFlag.setPositionRound(cleverapps.styles.AdminEpisodeView.currentFlag),this.currentFlag.setVisible(this.episode.isCurrent())},updateAverageDifficulty:function(){if(this.avgDifficulty&&this.avgDifficulty.removeFromParent(!0),this.episode.selected&&!this.episode.debug){var n=cleverapps.styles.AdminEpisodeView.avgDifficulty,s=this.avgDifficulty=cleverapps.UI.generateImageText("",
cleverapps.styles.FONTS.ADMIN_TEXT_SELECTED);this.button.addChild(s);var e=function(){var e=cleverapps.values(cleverapps.administrator.adminLevels.episodeStatistics.data),t=0;e.forEach(function(e){t+=1/(1-e.difficulty/100)}),s.setString(Math.round(100*(1-1/(t/e.length)))),s.fitTo(void 0,n.height),s.setPositionRound(n)}.bind(this);cleverapps.administrator.adminLevels.on("statisticsLoaded",e,s),cleverapps.administrator.adminLevels.episodeStatistics.ready&&e(),cleverapps.administrator.adminLevels.on("statisticsReset",function(){s.setString("")},s)}},onUpdateEpisode:function(){this.episode.isAddMoreEpisode()||(cleverapps.UI.ImageFont.intertypeSetString({textObj:this.button.text,string:this.getTitle(),font:cleverapps.styles.FONTS.ADMIN_TEXT,recreateFunc:function(){var e=this.button.getPosition();this.button.removeFromParent(!0),this.createButton(),this.button.setPositionRound(e),this.button.text.setFont(cleverapps.styles.FONTS.ADMIN_TEXT_SELECTED),this.addChild(this.button)}.bind(this)}),
this.indicator.setVisible(this.episode.inProgress()),this.updateCurrentIndicators(),this.updateBackgroundImage())},select:function(){this.button.text.setFont(cleverapps.styles.FONTS.ADMIN_TEXT_SELECTED),this.button.text.setFontSize(this.button.text.baseFontSize),this.updateBackgroundImage(),this.showMenu()},unselect:function(){this.button.text.setFont(cleverapps.styles.FONTS.ADMIN_TEXT),this.button.text.setFontSize(this.button.text.baseFontSize),this.updateBackgroundImage(),this.hideMenu()},updateBackgroundImage:function(){var e=bundles.admin.frames.regular_button;this.episode.selected?e=bundles.admin.frames.selected_button:this.episode.debug&&(e=bundles.admin.frames.disabled_button),this.button.setBackgroundImage(e),this.updateAverageDifficulty()},showMenu:function(){if(!this.menu){var n=cleverapps.styles.AdminEpisodeView.menu,e=AdminEpisodeView.BUTTONS.map(function(e){var t=new cc.Sprite(e.icon);return t.setScale(n.scale),new cleverapps.UI.Button({
button_png:bundles.admin.frames.regular_button,button_on_png:bundles.admin.frames.regular_button_on,content:t,fitTo:!1,contentOffset:{y:0},width:n.width,height:n.height,onClicked:e.action.bind(this)})}.bind(this));this.menu=new cleverapps.Layout(e,{direction:cleverapps.UI.HORIZONTAL,margin:n.margin}),this.addChild(this.menu),this.menu.setPositionRound(n),cleverapps.UI.wrap(this)}},hideMenu:function(){this.menu&&(this.menu.removeFromParent(),delete this.menu),this.button.setPositionRound(this.button.x,this.button.height/2),cleverapps.UI.wrap(this)}});AdminEpisodeView.BUTTONS=[{icon:bundles.admin.frames.copy_icon,action:function(){cleverapps.metha.display({focus:"CopyEpisode",action:function(e){cleverapps.administrator.adminEpisodes.copy(this.episode.episodeNo,e)}.bind(this)})}},{icon:bundles.admin.frames.edit_icon,action:function(){console.log(this.episode);var n=this.episode.episodeNo,s=function(t){t=cleverapps.castType(t),cleverapps.metha.distract({focus:"EditEpisodeNameDistract",
action:function(e){n!==t?cleverapps.administrator.adminEpisodes.rename(n,t,e):e()}})};cleverapps.metha.display({focus:"EditEpisodeName",action:function(e){if(!cc.sys.isNative||cc.sys.isWebView&&cc.sys.OS_IOS===cc.sys.os){var t=window.prompt(n+" new episode name",n);null!==t?s(t):e()}else new PromptWindow({callback:s,text:n}),cleverapps.metha.onceNoWindowsListener=e}})}},{icon:bundles.admin.frames.delete_icon,action:function(){cleverapps.metha.display({focus:"deleteEpisode",action:function(e){confirm("Delete episode "+this.episode.episodeNo+"?")?cleverapps.administrator.adminEpisodes.remove(this.episode.episodeNo,e):e()}.bind(this)})}}],cleverapps.styles.AdminEpisodeView={width:200,image:bundles.admin.frames.regular_button,indicator:{x:{align:"right",dx:-5},y:{align:"top",dy:-5}},menu:{margin:10,scale:.85,height:45,width:45,x:{align:"center"},y:{align:"bottom",dy:-56}},plus:{image:bundles.admin.frames.plus_button,width:67},currentFlag:{x:{align:"left",dx:4},y:{align:"center",dy:0}},
avgDifficulty:{x:{align:"right",dx:-5},y:{align:"top",dy:-5},height:12}};var AdminEpisodesView=cc.Node.extend({ctor:function(e,t){this._super(),this.adminEpisodes=e,this.mode=t;var n=cc.director.getWinSize();this.setContentSize2(cleverapps.styles.AdminEpisodesView.width,n.height),this.setAnchorPoint2(),this.createQuickNavigation(),this.adminEpisodes.on("reset",this.reset.bind(this),this),this.adminEpisodes.on("setActive",this.reshape.bind(this),this),this.adminEpisodes.on("insert",this.insert.bind(this),this),this.adminEpisodes.on("remove",this.remove.bind(this),this),this.adminEpisodes.on("rename",this.rename.bind(this),this),this.adminEpisodes.on("scrollToEp",this.scrollByEpisodeNo.bind(this),this),this.reset(),this.scrollByEpisodeNo(cleverapps.user.episode)},reset:function(){var e;this.scroll&&(e=this.scroll.innerContent.height/2+this.scroll.innerContent.getPosition().y,this.scroll.removeFromParent(!0)),this.viewsByEpisodeNo={};var t=this.adminEpisodes.episodes.map(function(e){
return this.viewsByEpisodeNo[e.episodeNo]=new AdminEpisodeView(e)},this),n=this.container=new cleverapps.Layout(t.reverse(),{direction:cleverapps.UI.VERTICAL,margin:cleverapps.styles.AdminEpisodesView.margin}),s=this.quickNavigation.y-this.quickNavigation.height/2-cleverapps.styles.AdminEpisodesView.margin,i=new cleverapps.UI.ScrollView(void 0,{childrenVisibility:cleverapps.UI.ScrollView.CHILDREN_VISIBILITY_LINEAR});i.setInnerContent(n),i.setContentSize2(this.width,s),this.addChild(i),i.setAnchorPoint2(0,0),i.setPositionRound(0,0),this.scroll=i,void 0!==e&&this.scroll.scrollToPoint(cc.p(-this.scroll.innerContent.x,this.scroll.innerContent.height/2-e))},reshape:function(){if(this.container){var e=this.scroll.innerContent.height/2+this.scroll.innerContent.getPosition().y;this.container.reshape(),this.scroll&&(this.scroll.updateInnerContent(),this.scroll.scrollToPoint(cc.p(-this.scroll.innerContent.x,this.scroll.innerContent.height/2-e)))}},sortViews:function(){
this.adminEpisodes.episodes.slice().reverse().map(function(e){this.container.reorderChild(this.viewsByEpisodeNo[e.episodeNo])},this),this.container.sortAllChildren(),this.reshape()},insert:function(e){var t=this.viewsByEpisodeNo[e.episodeNo]=new AdminEpisodeView(e);t.x=this.container.width/2,this.container.addChild(t),this.sortViews()},remove:function(e){this.viewsByEpisodeNo[e.episodeNo].removeFromParent(),delete this.viewsByEpisodeNo[e.episodeNo],this.sortViews()},rename:function(e,t){var n=this.viewsByEpisodeNo[t];delete this.viewsByEpisodeNo[t],this.viewsByEpisodeNo[e.episodeNo]=n,this.sortViews()},scrollByEpisodeNo:function(e){var t=this.viewsByEpisodeNo[e];t&&this.scroll.scrollTo(t)},switchMode:function(e){this.reset(e)},createQuickNavigation:function(){var e=this.quickNavigation=new AdminQuickNavigationView;e.setPositionRound(cleverapps.styles.AdminEpisodesView.quickNavigation),e.setLocalZOrder(1),this.addChild(e)}});cleverapps.overrideFonts(cleverapps.styles.FONTS,{ADMIN_TEXT:{
size:21,name:"formal"},ADMIN_TEXT_SELECTED:{size:21,color:cleverapps.styles.COLORS.ADMIN_TEXT_COLOR,name:"formal"}}),cleverapps.styles.AdminEpisodesView={margin:10,width:240,quickNavigation:{x:{align:"center"},y:{align:"top",dy:-5}}};var AdminUpdateGooglesheetsWindow=Window.extend({onWindowLoaded:function(e){this.options=e,this._super({noBackground:!0,closeButton:!1,noTitleBg:!0,name:"adminupdategooglesheetswindow",content:this.getContent()}),cleverapps.administrator.updateGooglesheets(this.createListener(this.generateInfo.bind(this)))},generateTextRow:function(e){var t=cleverapps.styles.AdminUpdateGooglesheetsWindow,n=[],s=cleverapps.UI.generateTTFText(e,cleverapps.styles.FONTS.ADMIN_GOOGLESHEETS_TEXT);if(s.setDimensions(t.scroll.width-t.viewButton.width-t.viewButton.margin,0),s.setHorizontalAlignment(cc.TEXT_ALIGNMENT_LEFT),n.push(s),0<=e.indexOf("row:")){var i=parseInt(e.substr(e.indexOf("row:")+4)),o=new cleverapps.UI.Button({button_png:bundles.admin.frames.regular_button,
button_on_png:bundles.admin.frames.regular_button_on,font:cleverapps.styles.FONTS.ADMIN_GOOGLESHEETS_VIEW_BUTTON_TEXT,text:"view",width:t.viewButton.width,height:t.viewButton.height,onClicked:function(){cleverapps.administrator.scrambleGotoRow(i)}.bind(this)});n.push(o)}else{var r=new cc.Node;r.setContentSize2(t.viewButton.width,0),n.push(r)}return new cleverapps.Layout(n,{direction:cleverapps.UI.HORIZONTAL,margin:t.viewButton.margin})},generateInfo:function(e){var t=cleverapps.styles.AdminUpdateGooglesheetsWindow;this.loading.removeFromParent();var n="Aborting writing jsons",s=e;if(0<=e.indexOf(n)){var i="Writing jsons...\n";s=(s=s.substr(s.indexOf(i)+i.length)).substr(0,s.indexOf(n))}this.inputDiv=document.createElement("textarea"),this.inputDiv.type="text",this.inputDiv.value=s,document.body.appendChild(this.inputDiv);for(var o=e.split("\n"),r=[],a=o.length-1;0<=a;a--)r.push(this.generateTextRow(o[a]));var c=new cleverapps.Layout(r,{direction:cleverapps.UI.VERTICAL,margin:0}),
l=new cleverapps.UI.ScrollView(c);l.setContentSize2(t.scroll),l.setPositionRound(t.scroll),this.content.addChild(l);var p=new cleverapps.UI.Button({button_png:bundles.admin.frames.regular_button,button_on_png:bundles.admin.frames.regular_button_on,font:cleverapps.styles.FONTS.ADMIN_GOOGLESHEETS_BUTTON_TEXT,text:"copy to clipboard",width:t.copyButton.width,height:t.copyButton.height,onClicked:function(){this.inputDiv.select(),document.execCommand("copy")}.bind(this)});p.setPositionRound(t.copyButton),this.content.addChild(p)},onClose:function(){this.inputDiv&&(this.inputDiv.remove(),this.inputDiv=void 0)},getContent:function(){var e=cleverapps.styles.AdminUpdateGooglesheetsWindow,t=this.content=cleverapps.UI.createScale9Sprite(bundles.admin.frames.lvl_bg);t.setContentSize2(e.content),this.loading=new cc.Sprite(bundles.admin.frames.loading_png),this.loading.runAction(new cc.RepeatForever(new cc.RotateBy(5,360))),this.loading.setPositionRound(t.width/2,t.height/2),t.addChild(this.loading)
;var n=new cleverapps.UI.Button({button_png:bundles.admin.frames.delete_button,button_on_png:bundles.admin.frames.delete_button,onClicked:this.close.bind(this)});return n.setPositionRound(e.closeButton),t.addChild(n),t}});cleverapps.overrideFonts(cleverapps.styles.FONTS,{ADMIN_GOOGLESHEETS_BUTTON_TEXT:{size:30,color:cleverapps.styles.COLORS.WHITE},ADMIN_GOOGLESHEETS_VIEW_BUTTON_TEXT:{size:22,color:cleverapps.styles.COLORS.WHITE},ADMIN_GOOGLESHEETS_TEXT:{size:22,color:cleverapps.styles.COLORS.ADMIN_TEXT_COLOR}}),cleverapps.styles.AdminUpdateGooglesheetsWindow={content:{width:750,height:800},viewButton:{width:68,height:36,margin:15},copyButton:{width:200,height:60,margin:50,x:{align:"center"},y:{align:"bottom",dy:50}},scroll:{width:700,height:620,x:{align:"center"},y:{align:"top",dy:-30}},closeButton:{x:{align:"right",dx:20},y:{align:"top",dy:20}}};var AdminDetailsView=cc.Node.extend({ctor:function(e,t){this._super(),this.adminDetails=e;var n=cc.director.getWinSize()
;this.setContentSize2(t.width,n.height),this.setAnchorPoint2(),this.createControls(),this.addKeyboardNavigation(),this.adminDetails.on("reset",this.reset.bind(this),this),this.reset()},wrapWithBg:function(e,t){var n=cleverapps.styles.AdminDetailsView,s=n.bgPadding.y,i=t&&t.paddingBottom||n.bgPadding.y;if(e.innerNode)return e.setContentSize2(this.width-2*n.padding.x,Math.max(e.innerNode.height*e.innerNode.scaleY,n.minHeight)+s+i),e;var o=cleverapps.UI.createScale9Sprite(bundles.admin.frames.lvl_bg);return o.setContentSize2(this.width-2*n.padding.x,Math.max(e.height*e.scaleY,n.minHeight)+s+i),o.addChild(e),e.setAnchorPoint(.5,0),e.setPositionRound(o.width/2,i),o.innerNode=e,o},reset:function(){this.layout&&this.layout.removeFromParent(!0);var e=cleverapps.styles.AdminDetailsView,t=this.width-2*e.padding.x-2*e.bgPadding.x,n=this.dataView=this.wrapWithBg(new AdminDataView(t,this)),s=cleverapps.administrator.adminLevels.getActive(),i=AdminLevelMaxiature.generate(s);if(Game.currentGame){
var o=Game.currentGame;i.registerCleanupCallback(function(){o.stop()})}cleverapps.UI.fitToBox(i,{width:t,height:this.calcMaxiatureHeight()});var r=this.maxiatureWithBg=this.wrapWithBg(i,{paddingBottom:e.bgPadding.paddingBottom});if(s){var a=new AdminLevelFlagsPanel(s,!0);if(a.setPositionRound(cleverapps.styles.AdminDetailsView.events),r.addChild(a),"differences"===cleverapps.config.name){var c=this.createEnlargeButton(s);r.addChild(c),c.setPositionRound(cleverapps.styles.AdminDetailsView.enlarge)}}var l=new cleverapps.Layout([n,r],{direction:cleverapps.UI.VERTICAL,margin:cleverapps.styles.AdminDetailsView.layout.margin});this.addChild(l),l.setAnchorPoint(.5,1),l.setPositionRound(this.width/2,this.height-cleverapps.styles.AdminDetailsView.menuPadding),this.layout=l,this.buttons.reset(s)},calcMaxiatureHeight:function(){var e=cleverapps.styles.AdminDetailsView,t=this.buttons.getBoundingBox().y+this.buttons.getBoundingBox().height,n=this.height-e.menuPadding-2*e.padding.y-t
;return n-=2*e.layout.margin+this.dataView.height,n-=e.bgPadding.paddingBottom+e.bgPadding.y},reshapeContent:function(){var e=cleverapps.styles.AdminDetailsView;this.wrapWithBg(this.dataView),cleverapps.UI.fitToBox(this.maxiatureWithBg.innerNode,{width:this.width-2*e.padding.x-2*e.bgPadding.x,height:this.calcMaxiatureHeight()}),this.wrapWithBg(this.maxiatureWithBg,{paddingBottom:e.bgPadding.paddingBottom}),this.layout.reshape(),this.layout.setAnchorPoint(.5,1),this.layout.setPositionRound(this.width/2,this.height-cleverapps.styles.AdminDetailsView.menuPadding)},switchMode:function(e){this.reset(e)},createEnlargeButton:function(i){var o=function(){this.elarged&&(cc.eventManager.removeListener(this.elarged.onClick),this.elarged.runAction(new cc.RemoveSelf),delete this.elarged)}.bind(this),e=function(){o();var n=this.elarged=AdminLevelMaxiature.generate(i,{enlarge:!0}),e=cc.director.getRunningScene().scene;e.addChild(n),n.setPositionRound(e.width/2,e.height/2),cleverapps.UI.wrap(n)
;var t=cleverapps.UI.createScale9Sprite(bundles.admin.frames.lvl_bg),s=cleverapps.styles.AdminDetailsView.bgPadding.paddingBottom;t.setContentSize(n.width+s,n.height+s),n.addChild(t,-1),t.setPositionRound(n.width/2,n.height/2),n.onClick=cc.eventManager.addListener({event:cc.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:!0,onTouchBegan:function(e){var t=n.convertTouchToNodeSpace(e);return cc.rectContainsPoint(cc.rect(0,0,n.width,n.height),t)||o(),!0}},n)}.bind(this);return this.elarged&&e(),new cleverapps.UI.Button({button_png:bundles.admin.frames.enlarge_button,button_on_png:bundles.admin.frames.enlarge_button,onClicked:e})},createControls:function(){this.buttons=new AdminDetailControls,this.addChild(this.buttons),this.buttons.setPositionRound(cleverapps.styles.AdminDetailsView.buttons)},addKeyboardNavigation:function(){var n=function(e){cleverapps.metha.display({focus:"hotKeyPress",action:e})};cc.eventManager.addListener({event:cc.EventListener.KEYBOARD,onKeyPressed:function(e){if(
e===cc.KEY.left&&cleverapps.keyboardController.isPressed(cc.KEY.ctrl))n(function(e){AdminNavigation.nextEpisode(AdminNavigation.LEFT,e)});else if(e===cc.KEY.right&&cleverapps.keyboardController.isPressed(cc.KEY.ctrl))n(function(e){AdminNavigation.nextEpisode(AdminNavigation.RIGHT,e)});else if(e===cc.KEY.enter&&cleverapps.keyboardController.isPressed(cc.KEY.ctrl))cleverapps.administrator.adminLevels.getActive().editLevel();else if(e===cc.KEY.h){var t=cleverapps.administrator.adminLevels.getActive();t&&t.toggleHard()}else e===cc.KEY.left?n(function(e){AdminNavigation.nextLevel(AdminNavigation.LEFT,e)}):e===cc.KEY.right?n(function(e){AdminNavigation.nextLevel(AdminNavigation.RIGHT,e)}):e===cc.KEY.enter&&n(function(e){LevelManager.getInstance().playLevel(e)})}.bind(this)},this)}});cleverapps.styles.AdminDetailsView={minHeight:50,padding:{x:10,y:0},bgPadding:{x:10,y:10,paddingBottom:40},events:{x:{align:"right",dx:0},y:{align:"bottom",dy:0}},enlarge:{x:{align:"right",dx:5},y:{align:"top",
dy:25}},buttons:{x:{align:"center"},y:{align:"bottom",dy:30}},menuPadding:140,layout:{margin:20}};var AdminDetailControls=cleverapps.Layout.extend({ctor:function(){this.createActionButtons(),this.createNavigationButtons(),this._super([this.navigationButtons,this.actionButtons],{direction:cleverapps.UI.VERTICAL,margin:cleverapps.styles.AdminDetailControls.rowMargin})},createButton:function(e){var t=cleverapps.styles.AdminDetailControls,n=new cc.Sprite(e.icon),s=new cleverapps.UI.Button({clickThrottle:1,button_png:bundles.admin.frames.regular_button,button_on_png:bundles.admin.frames.regular_button_on,button_off_png:bundles.admin.frames.disabled_button,content:n,contentOffset:{y:0},contentPadding:15*resolutionScale,width:t.width,height:t.height,onClicked:e.action});return s.icon=n,s},createActionButtons:function(){var e=this.createDetailsButtons();e.push(this.createButton({icon:bundles.admin.frames.play_icon,action:function(){AdministratorScene.close(),cleverapps.metha.display({
focus:"AdminPlayLevel",action:function(e){LevelManager.getInstance().playLevel(e)}})}})),cleverapps.config.levelEditor&&e.push(this.createButton({icon:bundles.admin.frames.edit_icon,action:function(){cleverapps.administrator.adminLevels.getActive().editLevel()}})),-1===["differences"].indexOf(cleverapps.config.name)&&e.push(this.createButton({icon:bundles.admin.frames.delete_icon,action:function(){var t=cleverapps.administrator.adminLevels.getActive();!t&&t.isAddMoreLevel()||cleverapps.metha.display({focus:"deleteLevel",action:function(e){confirm("Delete level "+t.getHumanNumber()+"?")?cleverapps.administrator.adminLevels.removeActive(e):e()}.bind(this)})}})),this.actionButtons=new cleverapps.Layout(e,{direction:cleverapps.UI.HORIZONTAL,margin:cleverapps.styles.AdminDetailControls.colMargin})},createNavigationButtons:function(){var e=["left_double","left","right","right_double"].map(function(e){return this.createButton({icon:bundles.admin.frames[e],action:function(){
cleverapps.metha.display({focus:"AdminNavigation",action:AdminNavigation[e]})}})}.bind(this));this.navigationButtons=new cleverapps.Layout(e,{direction:cleverapps.UI.HORIZONTAL,margin:cleverapps.styles.AdminDetailControls.colMargin})},createDetailsButtons:function(){var s=this.createButton({icon:bundles.admin.frames.annotation_icon,action:function(){if(!s.annotation||!s.annotation.visible){var e=s.annotation=new AdminLevelAnnotation.Active,t=cc.director.getRunningScene();t.scene.addChild(e);var n={x:t.nodes.adminDetails.x,y:this.y+this.height/2+e.height/2+5*resolutionScale};e.setPositionRound(n)}}.bind(this)}),t=this.makeCurrentButton=this.createButton({icon:bundles.admin.frames.current_icon,action:function(){cleverapps.metha.display({focus:"MakeCurrent",action:function(e){var t=cleverapps.administrator.adminLevels.getActive();if(!cleverapps.isNumber(t.episodeNo))return cleverapps.Notification.create("Can set current only number episode"),void e()
;cleverapps.administrator.adminLevels.makeCurrent(t),e()}})}});t.updateIcon=function(){var e=cleverapps.administrator.adminEpisodes.getActive();cleverapps.isNumber(e.episodeNo)?t.enable():t.disable(),cleverapps.UI.convertToGrayScale(t.icon,!t.disabled)};var n=this.createButton({icon:bundles.admin.frames.hard_icon,action:function(){cleverapps.administrator.adminLevels.getActive().toggleHard()}});n.updateIcon=function(){var e=cleverapps.administrator.adminLevels.getActive();cleverapps.UI.convertToGrayScale(n.icon,e.isHard())},this.hardButton=n;var e=[s,t,n];if("stacks"===cleverapps.config.subtype){var i=this.createButton({icon:bundles.admin.frames.tricky_level_mark,action:function(){cleverapps.administrator.adminLevels.getActive().toggleTricky()}});i.updateIcon=function(){var e=cleverapps.administrator.adminLevels.getActive();cleverapps.UI.convertToGrayScale(i.icon,e.isTricky())},this.trickyButton=i,e.push(this.trickyButton)}return e},reset:function(e){void 0!==e?(
this.actionButtons.setVisible(!0),this.hardButton.updateIcon(),e.on("change:hard",function(){this.hardButton.updateIcon()}.bind(this),this),this.trickyButton&&(this.trickyButton.updateIcon(),e.on("change:tricky",function(){this.trickyButton.updateIcon()}.bind(this),this)),this.makeCurrentButton.updateIcon()):this.actionButtons.setVisible(!1)}});cleverapps.styles.AdminDetailControls={height:60,width:60,colMargin:5,rowMargin:10};var AdminLanguageView=cc.Sprite.extend({ctor:function(e,t){this.adminLanguage=e,this._super(bundles.admin.frames["admin_"+e.language]);var n=cleverapps.UI.createScale9Sprite(bundles.admin.frames.selected_button);n.setContentSize(this.getContentSize()),this.addChild(n,-1),n.setPositionRound(this.width/2,this.height/2),t.width&&this.width>t.width&&cleverapps.UI.fitToBox(this,{width:t.width,height:this.height}),this.baseScale=this.scale,this.createIndicator(),e.on("select",this.select.bind(this),this),e.on("unselect",this.unselect.bind(this),this),
cleverapps.UI.onClick(this,e.onClick.bind(e)),cleverapps.UI.applyHover(this),this.setOpacity(e.selected?255:AdminLanguageView.OPACITY)},createIndicator:function(){var e=this.indicator=new cc.Sprite(bundles.admin.frames.in_process);e.setVisible(this.adminLanguage.inProgress()),e.setPositionRound(cleverapps.styles.AdminLanguageView.indicator),this.addChild(e)},select:function(){this.setOpacity(255)},unselect:function(){this.setOpacity(AdminLanguageView.OPACITY)}});cleverapps.styles.AdminLanguageView={indicator:{x:{align:"right",dx:-5},y:{align:"center",dy:0}}},AdminLanguageView.OPACITY=40;var AdminLevelDragShadow=cc.Scale9Sprite.extend({ctor:function(e){this.adminLevel=e;var t=cc.spriteFrameCache.getSpriteFrame(bundles.admin.frames.selected_button),n=t.getRect();this._super(t,cc.rect(n.width/2-1,n.height/2-1,2,2)),this.setContentSize2(cleverapps.styles.AdminLevelsView.cellSize),this.setLocalZOrder(-2),this.createText(),e.on("updateEpisode",this.onUpdateEpisode.bind(this),this)},
createText:function(){this.text&&this.text.removeFromParent();var e=this.adminLevel.originalEpisodeNo,t=this.adminLevel.episodeNo,n="";e!==t&&(n="To episode:\n"+t);var s=this.text=cleverapps.UI.generateOnlyText(n,cleverapps.styles.FONTS.ADMIN_LEVEL_TEXT);s.setPositionRound(this.width/2,this.height/2),s.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER),this.addChild(s)},onUpdateEpisode:function(){this.createText()}}),AdminLevelSlotView=cc.Node.extend({ctor:function(e){this._super(),this.setAnchorPoint2(),this.setLocalZOrder(AdminLevelSlotView.BASE_ZORDER),this.adminLevel=e,this.updateAdminLevelListeners();var t=cleverapps.styles.AdminLevelSlotView;this.setContentSize2(t),this.createLevelNo(),this.setZOrder()},createLevelNo:function(){var e=cleverapps.styles.AdminLevelSlotView;this.levelNo=cleverapps.UI.generateImageText(this.adminLevel.getHumanNumber(),this.getFont()),this.addChild(this.levelNo),this.levelNo.setPositionRound(e.text),this.levelNo.setVisible(
!this.adminLevel.isAddMoreLevel())},getFont:function(){var e=cleverapps.styles.FONTS.ADMIN_LEVEL_NO_TEXT;return this.adminLevel.selected&&(e=cleverapps.styles.FONTS.ADMIN_LEVEL_NO_SELECTED_TEXT),e},updateAdminLevel:function(e){this.adminLevel=e,this.updateAdminLevelListeners(),this.removeDragShadow(),e.dragging&&this.addDragShadow(),this.adminLevel.moveToSlot(this),this.updateBg()},updateAdminLevelListeners:function(){this.selectHandler&&(this.selectHandler.clear(),this.unselectHandler.clear()),this.selectHandler=this.adminLevel.on("select",this.updateBg.bind(this),this),this.unselectHandler=this.adminLevel.on("unselect",this.updateBg.bind(this),this)},addDragShadow:function(){this.removeDragShadow(),this.dragShadow=new AdminLevelDragShadow(this.adminLevel),this.dragShadow.setPositionRound(this.width/2,this.height/2),this.addChild(this.dragShadow)},removeDragShadow:function(){this.dragShadow&&(this.dragShadow.removeFromParent(),delete this.dragShadow)},setZOrder:function(){
this.adminLevel.selected?this.setLocalZOrder(AdminLevelSlotView.BASE_ZORDER+1):this.setLocalZOrder(AdminLevelSlotView.BASE_ZORDER)},updateBg:function(){this.levelNo.setVisible(!this.adminLevel.isAddMoreLevel()),this.adminLevel.isAddMoreLevel()||(this.levelNo.setString(this.adminLevel.getHumanNumber()),this.levelNo.setFont(this.getFont()),this.setZOrder())}});AdminLevelSlotView.BASE_ZORDER=-1,cleverapps.styles.AdminLevelSlotView={width:148,height:220,text:{x:{align:"center"},y:{align:"top",dy:20}}},cleverapps.overrideFonts(cleverapps.styles.FONTS,{ADMIN_LEVEL_NO_TEXT:{name:"formal",size:21,color:new cc.Color(227,223,223,255)},ADMIN_LEVEL_NO_SELECTED_TEXT:{name:"formal",size:21,color:cleverapps.styles.COLORS.ADMIN_TEXT_COLOR}});var AdminQuickNavigationView=cc.Node.extend({ctor:function(){this._super();var e=cleverapps.styles.AdminQuickNavigationView;this.setContentSize2(e),this.setAnchorPoint2();var t=cleverapps.UI.createScale9Sprite(bundles.admin.frames.lvl_bg);t.setContentSize2(
this.getContentSize()),this.addChild(t),t.setPositionRound(this.width/2,this.height/2),this.createContent()},createContent:function(){var e=this.createEditBox();this.addChild(e),e.setPositionRound(this.width/2,this.height/2)},createEditBox:function(){var e=cleverapps.UI.createScale9Sprite(bundles.admin.frames.navigation_level_episode,cleverapps.UI.Scale9Rect.TwoPixelXY);e.setContentSize2(cleverapps.styles.AdminQuickNavigationView.editBox);var t=cleverapps.UI.generateOnlyText("Go to:",cleverapps.styles.FONTS.ADMIN_TEXT_SELECTED);return t.setOpacity(70),e.addChild(t),t.setPosition(e.width/2,e.height/2),e.label=t,cleverapps.UI.onClick(e,function(){var e="Level no";"stacks"===cleverapps.config.subtype&&(e+=" or hint");var n=window.prompt(e,AdminQuickNavigation.levelNo);n&&cleverapps.metha.display({focus:"QuickNavigation",action:function(t){AdminQuickNavigation.handle(n,function(e){e?0<AdminQuickNavigation.suggestions.length?(this.showSuggestions(),t()):AdminQuickNavigation.go(t):t()}.bind(
this))}.bind(this)})}.bind(this)),cleverapps.UI.applyHover(e),e},showSuggestions:function(){this.suggest||this.createSuggestions();var e=cleverapps.styles.AdminQuickNavigationView.suggest,t=AdminQuickNavigation.suggestions.map(function(e){return this.createEntry(e)},this),n=new cleverapps.Layout(t,{direction:cleverapps.UI.VERTICAL,margin:e.margin});this.suggest.scroll.setInnerContent(n);var s=n.height<e.height?n.height:e.height;this.suggest.scroll.setContentSize(e.width,s),this.suggest.setContentSize2(this.suggest.scroll.width,this.suggest.scroll.height+e.paddingY),this.suggest.bg.setContentSize2(this.suggest.getContentSize()),this.suggest.scroll.setPositionRound(this.suggest.width/2,this.suggest.height/2),this.suggest.setVisible(!0)},createSuggestions:function(){this.suggest=new cc.Node,this.suggest.setAnchorPoint2(),this.suggest.setAnchorPoint(.5,1);var t=cc.director.getRunningScene().scene;t.addChild(this.suggest);var e={x:this.x,y:this.y-this.height/2};e=t.convertToNodeSpace(
this.parent.convertToWorldSpace(e)),this.suggest.setPositionRound(e);var n=this.suggest.bg=cleverapps.UI.createScale9Sprite(bundles.admin.frames.lvl_bg);n.setAnchorPoint2(0,0),this.suggest.addChild(n,-1);var s=this.suggest.scroll=new cleverapps.UI.ScrollView;s.setBarPadding(cleverapps.styles.AdminQuickNavigationView.suggest.scroll),this.suggest.addChild(s,-1),this.suggest.setVisible(!1),cc.eventManager.addListener({event:cc.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:!1,onTouchBegan:function(e){if(!this.suggest.isDisplayed())return!1;cc.rectContainsPoint(this.suggest.getBoundingBox(),t.convertTouchToNodeSpace(e))||this.suggest.setVisible(!1)}.bind(this)},this.suggest)},createEntry:function(t){var e=cleverapps.styles.AdminQuickNavigationView.suggest.entry,n=new cc.Node;n.setAnchorPoint2();var s=cleverapps.UI.generateTTFText(t.keywords,cleverapps.styles.FONTS.ADMIN_LOG_FONT);s.setAnchorPoint(0,.5),n.addChild(s);var i=cleverapps.UI.generateTTFText("Ep "+t.episodeNo+" lvl "+t.levelNo,
cleverapps.styles.FONTS.ADMIN_LOG_FONT);i.setOpacity(150),i.setAnchorPoint(1,.5),n.addChild(i),s.setDimensions(e.width-i.width,0),s.setHorizontalAlignment(cc.TEXT_ALIGNMENT_LEFT),n.setContentSize2(e.width,Math.max(s.height,e.height)),s.setPositionRound(0,n.height/2),i.setPositionRound(n.width,n.height/2);var o=cleverapps.UI.createScale9Sprite(bundles.admin.frames.log_entry_separator,cleverapps.UI.Scale9Rect.TwoPixelXY);return o.setContentSize(o.width,n.width),o.setRotation(90),n.addChild(o),o.setPositionRound(n.width/2,0),cleverapps.UI.applyHover(n),cleverapps.UI.onClick(n,function(){var e=function(){cleverapps.metha.display({focus:"moveToFoundLvl",action:function(e){AdminQuickNavigation.set(t.episodeNo,t.levelNo),AdminQuickNavigation.go(e)}})};t.lang&&cleverapps.settings.language!==t.lang?cleverapps.administrator.setLanguage(t.lang,e):e()},{ignoreOnTouchMoved:!0,swallowTouches:!1}),n}});cleverapps.styles.AdminQuickNavigationView={width:200,height:55,suggest:{margin:8,paddingY:20,
width:220,height:300,entry:{width:185,height:25},scroll:{cornerPadding:10,sidePadding:12}},editBox:{width:150,height:40}};var AdminLogView=cc.Node.extend({ctor:function(){this._super(),this.log=cleverapps.administrator.log,this.views=[],this.setAnchorPoint2(),this.setContentSize2(cleverapps.styles.AdminLogView),this.createContent(),this.addFrame(),this.addModeToggle(),this.log.on("addLogEntry",this.addEntry.bind(this),this),this.log.loadLastEntries(),cleverapps.UI.applyHover(this)},addEntry:function(e){var t=this.createEntry(e);t.x=this.width/2,this.content.addChild(t),this.updateContent()},updateContent:function(){this.content.reshape(),this.scroll.updateInnerContent(),this.mouseOver||this.scroll.scrollToPercent(100)},addFrame:function(){var e=new cleverapps.UI.createScale9Sprite(bundles.admin.frames.log_bg);e.setContentSize(this.getContentSize()),this.addChild(e,1),e.setPositionRound(this.width/2,this.height/2)},addModeToggle:function(){var e=cleverapps.UI.generateOnlyText(
void 0!==this.log.targetEpisode?"EPISODE":"ALL",cleverapps.styles.FONTS.ADMIN_TEXT_SELECTED);this.addChild(e,1),e.setPositionRound(cleverapps.styles.AdminLogView.mode),cleverapps.UI.onClick(e,function(){cleverapps.administrator.log.toggleMode(),e.setString(void 0!==this.log.targetEpisode?"EPISODE":"ALL"),e.setPositionRound(cleverapps.styles.AdminLogView.mode)}.bind(this)),cleverapps.UI.applyHover(e)},createContent:function(){var e=this.log.entries.map(function(e){return this.createEntry(e)},this),t=this.content=new cleverapps.Layout(e,{direction:cleverapps.UI.VERTICAL}),n=this.scroll=new cleverapps.UI.ScrollView(t);n.setContentSize(this.getContentSize()),n.setBarPadding(cleverapps.styles.AdminLogView.scroll),this.addChild(n,-1),n.setPositionRound(this.width/2,this.height/2),n.scrollToPercent(100)},createEntry:function(e){var t=new AdminLogEntryView(e,this);return t.x=this.width/2,this.views.push(t),t},onMouseOver:function(){},onMouseOut:function(){}});cleverapps.styles.AdminLogView={
width:780,height:150,scroll:{cornerPadding:10,sidePadding:10},mode:{x:{align:"right",dx:-5},y:{align:"bottom",dy:-22}}};var AdminLogEntryView=cleverapps.Layout.extend({ctor:function(e,t){this.entry=e,this.logView=t,this._super(this.createContentItems(),{direction:cleverapps.UI.HORIZONTAL,margin:cleverapps.styles.AdminLogEntryView.margin}),this.addBg(),this.addAuthor(),e.on("deleteLogEntry",this.delete.bind(this),this),e.on("updateLogEntry",this.updateEntry.bind(this),this)},addBg:function(){if(this.logView.views.length%2==0){var e=cleverapps.UI.createScale9Sprite(bundles.admin.frames.lvl_bg);e.setContentSize(this.getContentSize()),e.setPositionRound(e.width/2,this.height/2),this.addChild(e,-1)}},addAuthor:function(){var e=cleverapps.UI.generateOnlyText(this.entry.userName,cleverapps.styles.FONTS.ADMIN_LOG_FONT);e.setOpacity(70),this.addChild(e),e.setPositionRound(this.width-e.width/2-cleverapps.styles.AdminLogEntryView.authorPadding,this.height/2)},createContentItems:function(){
var e=cleverapps.styles.AdminLogEntryView,t=this.dateTxt=cleverapps.UI.generateImageText(this.entry.date.toLocaleString("ru").replace(",",""),cleverapps.styles.FONTS.ADMIN_LOG_FONT),n=new cc.Node;n.setAnchorPoint2(),n.setContentSize2(e.dateWidth,e.entryHeight),n.addChild(t),t.setPositionRound(n.width/2,n.height/2);var s=cleverapps.UI.createScale9Sprite(bundles.admin.frames.log_entry_separator,cleverapps.UI.Scale9Rect.TwoPixelXY);s.setContentSize(s.width,e.entryHeight);var i=this.entry.getMessage();i.length>e.maxMsgLength&&(i=i.substr(0,e.maxMsgLength)+"...");var o=cleverapps.UI.generateOnlyText(i,cleverapps.styles.FONTS.ADMIN_LOG_FONT);o.setDimensions(e.msgWidth-e.msgPadding,0),o.setHorizontalAlignment(cc.TEXT_ALIGNMENT_LEFT),o.fitTo(void 0,e.entryHeight);var r=new cc.Node;return r.setAnchorPoint2(),r.setContentSize2(e.msgWidth,e.entryHeight),r.addChild(o),o.setPositionRound(o.width/2,r.height/2),[n,s,r]},delete:function(){this.removeFromParent(),this.logView.updateContent()},
updateEntry:function(){this.dateTxt.setString(this.entry.date.toLocaleString("ru").replace(",",""))}});cleverapps.overrideFonts(cleverapps.styles.FONTS,{ADMIN_LOG_FONT:{name:"formal",size:15,color:cleverapps.styles.COLORS.BLACK}}),cleverapps.styles.AdminLogEntryView={maxMsgLength:200,dateWidth:160,msgWidth:600,msgPadding:80,entryHeight:36,margin:5,authorPadding:20};var AdminFbProductsButton=cc.Node.extend({ctor:function(e){this._super(),this.setAnchorPoint2(),this.adminFBProducts=e,this.adminFBProducts.onChangeStatus=this.createListener(this.changeStatus.bind(this));var t=cleverapps.styles.AdminFbProductsButton;this.button=new cleverapps.UI.Button({button_png:bundles.admin.frames.regular_button,button_on_png:bundles.admin.frames.regular_button_on,content:new cc.Sprite(bundles.admin.frames.fbProduct_icon),fitTo:!1,contentOffset:{y:0},width:t.width,height:t.height,onClicked:this.process.bind(this)}),this.addChild(this.button),this.setContentSize2(this.button.getContentSize()),
this.button.setPositionRound(this.width/2,this.height/2)},process:function(){this.adminFBProducts.processUpdate()},changeStatus:function(){this.loading?(this.loading.runAction(new cc.RemoveSelf),delete this.loading,this.button.setVisible(!0)):(this.button.setVisible(!1),this.loading=new cc.Sprite(bundles.git.frames.loading),cleverapps.UI.fitToBox(this.loading,this.getContentSize()),this.addChild(this.loading),this.loading.runAction(new cc.RepeatForever(new cc.RotateBy(5,360))),this.loading.setPositionRound(this.width/2,this.height/2))}});cleverapps.styles.AdminFbProductsButton={width:40,height:40,x:{align:"left",dx:10},y:{align:"top",dy:-20}};var AdminFBProductsWindow=Window.extend({ctor:function(){this.editorWindow=!0,this._super.apply(this,arguments)},onWindowLoaded:function(e){this.adminFBProducts=e,this._super({noBackground:!0,closeButton:!1,noTitleBg:!0,name:"GitInfoWindow",content:this.getContent(),buttons:this.getButtons()})},getContent:function(){
var e=cleverapps.styles.AdminFBProductsWindow,t=[this.createLangs(),this.createProducts()],n=new cleverapps.Layout(t,{direction:cleverapps.UI.VERTICAL,margin:e.contentMargin,y:e.contentOffsetY}),s=cleverapps.UI.createScale9Sprite(bundles.admin.frames.lvl_bg);return s.setContentSize2(n.width+e.bg.padding.x,n.height+e.bg.padding.y),s.addChild(n),n.setPositionRound(s.width/2,s.height/2),s},createProducts:function(){var e=this.productItems=[];for(var t in cleverapps.config.products){var n=cleverapps.config.products[t];Messages.has(n.title)&&e.push(this.createOneProduct(n))}var s=Math.round(e.length/2),i=[new cleverapps.Layout(e.slice(0,s),{direction:cleverapps.UI.VERTICAL}),new cleverapps.Layout(e.slice(s),{direction:cleverapps.UI.VERTICAL})],o=cleverapps.styles.AdminFBProductsWindow.products,r=new cleverapps.Layout(i,{direction:cleverapps.UI.HORIZONTAL,margin:o.columnsMargin,align:cleverapps.UI.ALIGN_END}),a=new cleverapps.UI.ScrollView(r);a.setContentSize2(o.width,Math.min(r.height,
o.height)),a.scrollToDefault();var c=cleverapps.UI.createScale9Sprite(bundles.admin.frames.selected_button);return c.setContentSize2(a.width+o.framePadding,a.height+o.framePadding),c.addChild(a,-1),a.setPositionRound(c.width/2,c.height/2),this.addGroupToggle(c,this.productItems,!1),c},createOneProduct:function(e){var t=cleverapps.styles.AdminFBProductsWindow.products.product,n=[];if(e.image){var s=new cleverapps.Layout.AsyncChild;n.push(s),s.setContentSize2(t.img);var i=new cc.Sprite(e.image);i.addEventListener("load",function(){cleverapps.UI.fitToBox(i,t.img),s.reshape(i)},i)}var o=cleverapps.UI.generateTTFText(e.title,cleverapps.styles.FONTS.ADMIN_PRODUCTS);o.setDimensions(t.titleWidth,0),o.fitTo(void 0,t.height),n.push(o);var r=cleverapps.UI.generateTTFText(e.key,cleverapps.styles.FONTS.ADMIN_PRODUCTS_ID);r.setDimensions(t.idWidth,0),r.setOpacity(160),n.push(r);var a=new cleverapps.Layout(n,{direction:cleverapps.UI.HORIZONTAL,margin:t.margin}),c=new cc.Node;return c.setAnchorPoint2(
),c.setContentSize2(t),a.setPositionRound(t),c.addChild(a),c.id=e.id.facebook,c.selected=!1,this.makeItemTogglable(c),c},createLangs:function(){var e=this.langs=cleverapps.Settings.getAvailableLanguages().map(function(e){return this.createOneLang(e)},this),t=[new cleverapps.Layout(e.slice(0,10),{direction:cleverapps.UI.HORIZONTAL})];e.slice(10).length&&t.unshift(new cleverapps.Layout(e.slice(10),{direction:cleverapps.UI.HORIZONTAL}));var n=new cleverapps.Layout(t,{direction:cleverapps.UI.VERTICAL,align:cleverapps.UI.ALIGN_START});return this.addGroupToggle(n,this.langs,!0),n},createOneLang:function(e){var t=cleverapps.styles.AdminFBProductsWindow.langs.lang,n=cleverapps.UI.generateTTFText(e,cleverapps.styles.FONTS.ADMIN_PRODUCTS),s=cleverapps.UI.createScale9Sprite(bundles.admin.frames.selected_button);return s.id=e,s.setContentSize2(t),s.addChild(n),n.setPositionRound(s.width/2,s.height/2),s.selected=!0,this.makeItemTogglable(s),s},makeItemTogglable:function(t){
var n=cleverapps.UI.createScale9Sprite(bundles.admin.frames.lvl_selected_bg);n.setOpacity(180),n.setContentSize2(1.02*t.width,t.height),n.setPositionRound(t.width/2,t.height/2),t.addChild(n,-1),n.setVisible(t.selected),t.toggle=function(e){t.selected="boolean"==typeof e?e:!t.selected,n.setVisible(t.selected)},cleverapps.UI.onClick(t,t.toggle,{noThrottle:!0,ignoreOnTouchMoved:!0,swallowTouches:!1})},addGroupToggle:function(e,t,n){var s=cleverapps.UI.generateTTFText("Toggle all",cleverapps.styles.FONTS.GIT_INFO_TEXT);s.selected=n,e.addChild(s),s.setPositionRound(cleverapps.styles.AdminFBProductsWindow.toggle),cleverapps.UI.applyHover(s),cleverapps.UI.onClick(s,function(){s.selected=!s.selected,t.forEach(function(e){e.toggle(s.selected)},this)}.bind(this))},getButtons:function(){var e=cleverapps.styles.AdminFBProductsWindow.buttons;return[new cleverapps.UI.Button({button_png:bundles.git.frames.regular_button,button_on_png:bundles.git.frames.regular_button_on,
font:cleverapps.styles.FONTS.GIT_INFO_BUTTON_TEXT,text:"confirm",width:e.width,height:e.height,onClicked:function(){var e=function(e){return e.filter(function(e){return e.selected}).map(function(e){return e.id})},t=e(this.langs),n=e(this.productItems);this.adminFBProducts.setUpdateData(n,t),this.close()}.bind(this)}),new cleverapps.UI.Button({button_png:bundles.git.frames.regular_button,button_on_png:bundles.git.frames.regular_button_on,font:cleverapps.styles.FONTS.GIT_INFO_BUTTON_TEXT,text:"cancel",width:e.width,height:e.height,onClicked:this.close.bind(this)})]}});cleverapps.overrideFonts(cleverapps.styles.FONTS,{ADMIN_PRODUCTS:{size:20,color:cleverapps.styles.COLORS.BLACK},ADMIN_PRODUCTS_ID:{size:14,color:cleverapps.styles.COLORS.BLACK}}),cleverapps.styles.AdminFBProductsWindow={contentMargin:45,contentOffsetY:100,bg:{padding:{x:60,y:100}},toggle:{x:{align:"center"},y:{align:"top",anchor:"center",dy:15}},products:{columnsMargin:20,height:650,width:600,framePadding:10,product:{
width:285,height:40,titleWidth:140,idWidth:100,margin:5,x:{align:"left"},y:{align:"center"},img:{width:36,height:36}}},langs:{lang:{width:50,height:30}},buttons:{width:150,height:70}};var ToolModel=function(){this.opened=!1,this.path=[],this.onChange=function(){},this.add(cleverapps.Tool),cc.director.getRunningScene()instanceof GameSceneBase&&this.add(cleverapps.Tool.game)};ToolModel.prototype.getActive=function(){var t=this.path[this.path.length-1],e=Object.keys(t).map(function(e){return{key:e,icon:t[e].icon,action:this.clickItem.bind(this,e)}},this);return 1<this.path.length&&e.unshift({key:"back",action:this.goBack.bind(this)}),e},ToolModel.prototype.clickItem=function(e){var t=this.path[this.path.length-1][e];t.action&&t.icon&&(t=t.action);var n="function"==typeof t?t.call(this):t;void 0!==n&&this.add(n)},ToolModel.prototype.add=function(e){this.path.push(e),this.onChange()},ToolModel.prototype.goBack=function(){this.path.pop(),this.onChange()},ToolModel.prototype.toggle=function(
){this.opened=!this.opened};var ToolMenu=cc.Scale9Sprite.extend({ctor:function(){this._super(),this.model=new ToolModel,cleverapps.UI.onClick(this,this.toggle.bind(this),{ignoreOnTouchMoved:!0}),this.setMenu(),this.showOrHide(this.model.opened),this.model.onChange=this.setMenu.bind(this)},toggle:function(){this.model.toggle(),this.showOrHide(this.model.opened)},setMenu:function(){for(var e=this.model.getActive(),s=cleverapps.styles.ToolMenu,t=e.map(function(e){var t=cleverapps.UI.generateOnlyText(e.key,cleverapps.styles.FONTS.TOOL_MENU_TEXT,{});t.setDimensions(0,0),e.icon&&(cleverapps.UI.fitToBox(e.icon,{height:50,width:200}),t=new cleverapps.Layout([e.icon,t],{direction:cleverapps.UI.HORIZONTAL}));var n=new cc.MenuItemLabel(t,e.action);return n.height*=s.scaleY,n}),n=new cc.Menu(t),i=cc.director.getWinSize(),o=t[0].width,r=t[0].height,a=1;a<t.length;a++)r+=t[a].height,o<t[a].width&&(o=t[a].width);if(o*=1.6,r*=1.3,n.setContentSize2(o,r),n.width>i.width){var c=i.width/n.width;n.width*=c
,n.height*=c,n.children.forEach(function(e){e.setScale(c)})}if(n.alignItemsVertically(),n.height>i.height){var l=new cleverapps.UI.ScrollView(n,{childrenVisibility:cleverapps.UI.ScrollView.CHILDREN_VISIBILITY_NONE,direction:cleverapps.UI.ScrollView.DIR_VERTICAL});l.setContentSize(n.width,i.height),l.scrollToDefault(),n=l}this.setContentSize(n.getContentSize()),this.setPositionRound(this.width/2+s.x,i.height/2),n.setAnchorPoint2(.5,.5),n.setPositionRound(this.width/2,this.height/2),this.addChild(n),this.menu&&this.menu.removeFromParent(),this.menu=n},showOrHide:function(e){var t=cleverapps.styles.ToolMenu;e?(this.setPositionRound(this.width/2+t.x,this.y),this.setRotation(0)):(this.setPositionRound(-this.height/2+t.toggle.x,this.y),this.setRotation(-90)),this.menu.visible=e}});ToolMenu.LIST_ACTIVE_MENU=[],cleverapps.styles.DECORATORS=cleverapps.overrideStyles(cleverapps.styles.DECORATORS,{TOOL_MENU_TEXT_STROKE:{color:cleverapps.styles.COLORS.BLACK,size:1}}),cleverapps.overrideFonts(
cleverapps.styles.FONTS,{TOOL_MENU_TEXT:{size:30,color:cleverapps.styles.COLORS.WHITE,stroke:cleverapps.styles.DECORATORS.TOOL_MENU_TEXT_STROKE}}),cc.sys.isMobile&&(cleverapps.styles.DECORATORS=cleverapps.overrideStyles(cleverapps.styles.DECORATORS,{TOOL_MENU_TEXT_STROKE:{color:cleverapps.styles.COLORS.BLACK,size:10}}),cleverapps.overrideFonts(cleverapps.styles.FONTS,{TOOL_MENU_TEXT:{size:90,color:cleverapps.styles.COLORS.WHITE,stroke:cleverapps.styles.DECORATORS.TOOL_MENU_TEXT_STROKE}})),cleverapps.styles.ToolMenu={x:-20,toggle:{x:50},scaleY:.8};var HomeTool={setInt:function(e,t,n,s){for(var i=cleverapps.home;!i.isCompleted()&&(i.currentFurnitureId!==e||i.getMaxFurniture().stage!==t);){for(var o=i.getMaxFurniture();!o.canBeUpgraded()&&!levels.user.isPassedAll();){var r=new Episode(levels.user.episode).getLevel(levels.user.level);cleverapps.home.earnStars(cleverapps.home.amountLevelStars(r)),levels.user.incLevel()}var a=this.calcNextProgress(o);if(n&&a.furnitureId===e&&a.stage===t
)break;this.moveNext()}s()},set:function(e,t,n,s){var i=cleverapps.home;this.reset(),this.setInt(e,t,n,function(){i.save(),i.tasks.reset(),cleverapps.user.save(),s()})},calcNextProgress:function(e){return e.stage+1===e.stages.length?{furnitureId:e.id+1,stage:0}:{furnitureId:e.id,stage:e.stage+1}},moveNext:function(){var e=cleverapps.home;cleverapps.home.stars=0;var t=e.getMaxFurniture();t.nextStage()||(t.choices&&(t.choice=0),e.currentFurnitureId=e.getNextId())},reset:function(){var e=cleverapps.home;e.furniture.forEach(function(e){e.stage=0,e.choice=void 0}),e.stars=0,e.currentFurnitureId=e.firstFurnitureId(),cleverapps.user.level=0,cleverapps.user.episode=0}},FarmTool={set:function(e,t,n){var s=cleverapps.farm;for(s._earnKeys=s.earnKeys,s.earnKeys=function(e){this.keys[e]=(this.keys[e]||0)+1}.bind(s),this.reset();!s.isCompleted()&&(s.currentBuildingId!==e||s.getBuilding().currentQuestId!==t);){for(var i=s.getBuilding(),o=i.getQuest();!o.isCompleted();){
var r=s.findBuildingForActiveItem();cleverapps.user.incLevel(),r.levelUp()}var a=this.calcNextProgress(i);if(n&&a.buildingId===e&&a.questId===t)break;this.moveNext()}delete s.justCollectedDialogue,s.save(),cleverapps.user.save(),levels.episodes.setCurrentEpisode(cleverapps.user.episode),s.earnKeys=s._earnKeys,delete s._earnKeys},calcNextProgress:function(e){return e.currentQuestId+1===e.quests.length?{buildingId:e.id+1,questId:0}:{buildingId:e.id,questId:e.currentQuestId+1}},moveNext:function(){var t=cleverapps.farm;t.getBuilding().getQuest().items.forEach(function(e){t.keys[e.name]-=e.amount}),this.nextQuest(t.getBuilding())||t.currentBuildingId++},nextQuest:function(e){return e.currentQuestId++,void 0!==e.getQuest()||!(e.open=!0)},reset:function(){Farm.Reset(),cleverapps.user.level=0,cleverapps.user.episode=0}},displayToolWindow=function(t){return function(){cleverapps.metha.display({focus:"ToolWindow",action:function(e){t(),cleverapps.windows.isActive(
)?cleverapps.metha.onceNoWindowsListener=e:e()}})}},splitEntriesInParts=function(e,n){var s={},i={};return e.forEach(function(e,t){i[e.name]=n.bind(void 0,e,t),30===Object.keys(i).length&&(s["part"+Object.keys(s).length]=i,i={})}),Object.keys(i).length&&(s["part"+Object.keys(s).length]=i),s},dialogues=function(){var e,s=function(n,s){s=s||{},cleverapps.metha.display({focus:"ToolDialogue",actions:[function(e){var t=["dialogues"];s.bundle&&t.push(s.bundle),cleverapps.bundleLoader.loadBundles(t,{onSuccess:e,blocked:!0})},function(e){var t=new Dialogue(n,{showUp:!0,autoClose:!0});new DialogueView(t,{}),t.on("afterClose",e),t.run()}]})},t=function(n){var e={};return Object.keys(n).forEach(function(t){e[t]=function(){var e=n[t];e.options?s(e.steps,e.options):s(e)}}),e},n={persons:t(function(){var e={},t=cleverapps.styles.DialogueView.persons;for(var n in t){var s=t[n];if(s.styles.json)if(cc.loader.getRes(s.styles.json)){var i=cc.loader.getRes(s.styles.json).animations;for(var o in i
)e[n+" <"+o+">"]={text:"Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet. Lorem ipsum dolor sit amet.",person:cleverapps.overrideStyles(s,{animation:o},!0)}}else console.log("Not loaded character: "+n,s.styles.json);else console.log("No json for character: "+n,s)}return e}()),plot:t(function(){var e={};for(var t in cleverapps.styles.dialogues){var n=cleverapps.styles.dialogues[t].dialogue;e[t]=n}return e}())};return cleverapps.styles.comicses&&(n.comics=(e={},Object.keys(cleverapps.styles.comicses).forEach(function(t){e[t]=function(){cleverapps.metha.display({focus:"ToolComics",actions:[function(e){ComicsScene.showComics(e,cleverapps.styles.comicses[t])},function(e){cleverapps.metha.gotoMainScene(e)}]})}}),e)),n};cleverapps.Tool={wysiwyg:function(){cleverapps.wysiwyg||void 0===Wysiwyg||(cleverapps.wysiwyg=new Wysiwyg),WysiwygScene.open(cleverapps.wysiwyg),Game.currentGame&&Game.currentGame.stop&&Game.currentGame.stop()},knockout:{setCups:function(){
var e=cleverapps.metha.getMainObject().knockoutGame;if(e){var t=parseInt(window.prompt("Set cups",e.cups));isNaN(t)||(e.cups=t,e.save(),cleverapps.refreshScene())}}},homefix:{fromStart:function(){var e=cleverapps.home;e&&HomeTool.set(e.firstFurnitureId(),0,!1,function(){cleverapps.refreshScene()})},gotoFurniture:function(){var e=cleverapps.home;if(!e)return[];return splitEntriesInParts(e.readConfig().items,function(e){HomeTool.set(e.id,0,!1,function(){cleverapps.refreshScene()})})},nextFurniture:function(){var e=cleverapps.home;e.isCompleted()||HomeTool.set(e.getNextId(),0,!0,function(){cleverapps.refreshScene()})},nextStage:function(){var e=cleverapps.home;if(!e.isCompleted()){var t=HomeTool.calcNextProgress(e.getMaxFurniture());HomeTool.set(t.furnitureId,t.stage,!0,function(){cleverapps.refreshScene()})}},passAll:function(){var e=cleverapps.home;HomeTool.set(e.furniture[e.furniture.length-1].id,0,!1,function(){cleverapps.refreshScene()})},lastLevel:function(){var e=cleverapps.home
;HomeTool.set(e.furniture[e.furniture.length-1].id,0,!0,function(){cleverapps.refreshScene()})},add20Stars:function(){cleverapps.home.earnStars(20)}},farm:{gotoBuilding:function(){var s=cleverapps.farm;if(!s)return[];return splitEntriesInParts(s.readConfig().items,function(e,t){Farm.Reset();var n=Farm.GetBuildingProgress(t,0);s.load(n),s.save(),cleverapps.refreshScene()})},nextBuilding:function(){var t=cleverapps.farm;t.isCompleted()||(FarmTool.set(t.currentBuildingId+1,0,!0),cleverapps.metha.display({focus:"ToolMoveNext",action:function(e){t.moveNext(e)}}))},nextQuest:function(){var t=cleverapps.farm;if(!t.isCompleted()){var e=FarmTool.calcNextProgress(t.getBuilding());FarmTool.set(e.buildingId,e.questId,!0),cleverapps.metha.display({focus:"ToolMoveNext",action:function(e){t.moveNext(e)}})}},passAll:function(){var e=cleverapps.farm;FarmTool.set(e.buildings.length,0),cleverapps.refreshScene()},listQuestItems:function(){var s=cleverapps.farm;if(s&&s.getBuilding()&&s.getBuilding(
).getQuest()){var e={},t=s.getBuilding().getQuest(),i=s.keys;return t.items.forEach(function(n){e[n.name]=function(){var e=i[n.name]||0,t=parseInt(window.prompt(n.name+" "+e+"/"+n.amount,e));isNaN(t)||(i[n.name]=t,s.save())}}),e}},setItems:function(){var i=cleverapps.farm,e=window.prompt("Enter required items \n e.g. coke=2,mentos=5");e&&e.replace(/ /g,"").split(",").forEach(function(e){var t=e.indexOf("="),n=e.substr(0,t),s=parseInt(e.substr(t+1));i.keys[n]=s,i.save()})},addCurrentQuestItems:function(n){var e=cleverapps.farm,t=e.getBuilding().getQuest();if(t){var s=e.keys;t.items.forEach(function(e,t){s[e.name]||(s[e.name]=0),s[e.name]<e.amount&&(s[e.name]=e.amount),!0===n&&0===t&&s[e.name]--})}e.save()},addAllItems:function(){var n={};cleverapps.farm.buildings.forEach(function(e){if(!n[e.provides]){n[e.provides]=!0;for(var t=0;t<1e3;t++)cleverapps.farm.keys[e.provides]=1e3}}),cleverapps.farm.save()},lastLevel:function(){var e=cleverapps.farm;FarmTool.set(e.buildings.length,0,!0),
cleverapps.refreshScene()},inspectByBuildings:function(){return splitEntriesInParts(cleverapps.farm.buildings,function(e){for(var t=[],n=1;n<=100;n++){var s=[0,0,0];if(0===e.id&&1===n)s=[3,0,0];else{cleverapps.Random.seed(1e4*e.id+n);for(var i=0;i<3;i++){var o=cleverapps.Random.nextDouble();o<cleverapps.farm.probabilities[0]?s[0]++:o<cleverapps.farm.probabilities[1]?s[1]++:s[2]++}}t.push(s)}console.log(e.name,t)})},inspect:function(){var p=[],d={},u={},h=[],g=cleverapps.farm;if(g){var e=0;g.buildings.forEach(function(c){var l=p.push({})-1;p[l][c.name]={},void 0===u[c.name]&&(u[c.name]=0),c.quests.forEach(function(o){var r=0,a={};p[l][c.name][Messages.get(o.title)]={perItems:{}},o.items.forEach(function(e){void 0===d[e.name]&&(d[e.name]=0);for(var t={},n=0;d[e.name]<e.amount;){n++,r++;var s=g.findProperBuilding(e);void 0===u[s.name]&&(u[s.name]=0),u[s.name]++;var i=s.provides;void 0===d[i]?d[i]=1:d[i]++,void 0===t[i]?t[i]=1:t[i]++,void 0===a[i]?a[i]=1:a[i]++}n||h.push(
e.name+" - "+Messages.get(o.title)+" ("+c.name+")"),d[e.name]-=e.amount,p[l][c.name][Messages.get(o.title)].perItems[e.name]={earnedOnItem:cleverapps.clone(t),levelsOnItem:n}}.bind(g)),p[l][c.name][Messages.get(o.title)].earnedOnQuest=cleverapps.clone(a),p[l][c.name][Messages.get(o.title)].levelsOnQuest=r,e+=r,p[l][c.name][Messages.get(o.title)].total=cleverapps.clone(d)}.bind(g))}.bind(g)),p.push({total:cleverapps.clone(d),skippedItems:h,totalLvls:e}),p.forEach(function(e){console.log(e)}),console.log("Print clock to get json data"),clock=JSON.stringify(p)}}},simple:{reset:function(){cleverapps.simple.stars=0,cleverapps.simple.current=0,cleverapps.simple.save(),cleverapps.refreshScene()},moveNext:function(){cleverapps.user.incLevel(),cleverapps.simple.earnStars(cleverapps.simple.getRequiredStars()-cleverapps.simple.stars-3,!0),cleverapps.simple.earnStars(3),cleverapps.metha.onFocusLostListenerPlacements()},moveTo:function(){for(var e=[],t=0;t<cleverapps.simple.bgsAmount;t++)e.push({
name:Messages.has("background_name_"+t)?Messages.get("background_name_"+t):"UNNAMED_"+t});return splitEntriesInParts(e,function(e,t){cleverapps.simple.current=t,cleverapps.simple.stars=0,cleverapps.simple.save(),cleverapps.refreshScene()})},passAll:function(){cleverapps.simple.current=cleverapps.simple.bgsAmount-1,cleverapps.simple.save(),cleverapps.refreshScene()},add1:function(){cleverapps.simple.earnStars(1,!0)},add10:function(){cleverapps.simple.earnStars(10,!0)}},ABtests:{betOrLives:function(){if(!cleverapps.ABTest.ACTIVE_TEST||"betorlives"!==cleverapps.ABTest.ACTIVE_TEST.name)return{NOTRUNNING:function(){}};return{}}},UI:{dialogues:dialogues,skins:function(){var t={};return Object.keys(cleverapps.SkinManager.SKINS).forEach(function(e){t[e]=function(){cleverapps.eventManager.events=cleverapps.eventManager.events.filter(function(e){return!e.features.some(function(e){return cleverapps.SkinManager.SKINS[e]})}),"default"!==e&&cleverapps.eventManager.events.push({features:[e],
start:new Date(Date.now()).toISOString(),finish:new Date(Date.now()+cleverapps.parseInterval("1 day")).toISOString()}),cleverapps.eventManager.setCurrentFeatures()}}),t},windows:{selectFriendWindow:displayToolWindow(function(){new SelectFriendWindow("askLives",function(e,t){})}),newLeague:displayToolWindow(function(){levels.episodes.episodes[levels.user.episode]&&new NewLeagueWindow(levels.episodes.episodes[levels.user.episode].levels[levels.user.level])}),rateWindow:displayToolWindow(function(){new RateWindow}),championWindow:displayToolWindow(function(){new ChampionWindow(levels.episodes.episodes[levels.user.episode].levels[levels.user.level])}),beatFriendWindow:displayToolWindow(function(){var e=cleverapps.friends.listIds();if(0<e.length&&levels.episodes.episodes[levels.user.episode]){var t=e[Math.floor(Math.random()*e.length)];new BeatFriendWindow(t,levels.episodes.episodes[levels.user.episode].levels[0])}}),victoryWindow:displayToolWindow(function(){if(
levels.episodes.episodes[levels.user.episode]){var e=levels.episodes.episodes[levels.user.episode].levels[levels.user.level];if(!Game.currentGame){var t=levels.episodes.episodes[levels.user.episode].getLevelContent(levels.user.level);e.content=t,new Game(e)}new VictoryWindow({level:e,score:1e3,stars:3,game:Game.currentGame,callback:function(){}})}}),miniGameWindow:displayToolWindow(function(){cleverapps.periodicBonus.unlock();var e=cleverapps.clone(cleverapps.periodicBonus.getReward(),!0);new MiniGameWindow(e)}),startEpisodeWindow:displayToolWindow(function(){new StartEpisodeWindow(levels.episodes.getCurrentEpisode())}),finishEpisodeWindow:displayToolWindow(function(){new FinishEpisodeWindow({episode:levels.episodes.getCurrentEpisode()})}),finisherWindow:displayToolWindow(function(){new FinisherWindow}),fbConnectWindow:displayToolWindow(function(){new FbConnectWindow(function(){},function(){},{errorMessage:"messages:FbConnectWindow.TryAgain"})}),loseWindow:displayToolWindow(function(){
new LoseWindow(function(){})}),movesFromFriend:displayToolWindow(function(){HelpFromFriendsWindow.create(HelpFromFriendsWindow.TYPES.addmoves,function(){})}),movesFromVideo:displayToolWindow(function(){HelpFromFriendsWindow.create(HelpFromFriendsWindow.TYPES.addmovesvideo,function(){})}),livesFromVideo:displayToolWindow(function(){HelpFromFriendsWindow.create(HelpFromFriendsWindow.TYPES.addlivesvideo,function(){})}),coinsFromVideo:displayToolWindow(function(){HelpFromFriendsWindow.create(HelpFromFriendsWindow.TYPES.addcoinsvideo,function(){})}),waitWindow:displayToolWindow(function(){new WaitWindow}),promotionWindow:displayToolWindow(function(){var e=cleverapps.promotion.getFirstAvailable();e&&new PromotionWindow(e)}),reloadWindow:displayToolWindow(function(){new ReloadWindow}),tutorialFinishWindow:function(){new TutorialFinishWindow},stuckWindow:displayToolWindow(function(){var e=levels.progress.getStuckFriends();if(0<e.length)return new StuckWindow(e)}),
newVersionWindow:displayToolWindow(function(){new NewVersionWindow}),helpByFiveAttemptsWindow:displayToolWindow(function(){new HelpByFiveAttemptsWindow}),packWindow:displayToolWindow(function(){new PackWindow}),packWindow1:displayToolWindow(function(){cleverapps.packManager.used=0,new PackWindow}),packWindow2:displayToolWindow(function(){cleverapps.packManager.used=1,new PackWindow}),packWindow3:displayToolWindow(function(){cleverapps.packManager.used=2,new PackWindow}),bountyWindow:displayToolWindow(function(){new BountyWindow}),tempgoodsFinish:displayToolWindow(function(){new TempGoodFinishWindow(cleverapps.TempGoods.UNLIMITED_LIVES)}),allDone:displayToolWindow(function(){new AllDoneWindow})},rewardWindows:{StarChestWindow:displayToolWindow(function(){new StarChestWindow}),DailyTaskRewardWindow:displayToolWindow(function(){cleverapps.dailyTasks.whenStart=-1,cleverapps.dailyTasks.processResults();var e=cleverapps.dailyTasks.getActiveTasks();e.length&&new DailyTaskRewardWindow(
e[Math.floor(Math.random()*e.length)])}),MiniGameRewardWindow:displayToolWindow(function(){new MiniGameRewardWindow(cleverapps.clone(cleverapps.periodicBonus.getReward(),!0))}),RewardWindow:displayToolWindow(function(){var e,t={gold:100};if(cleverapps.lives&&(t.unlimitedLives="1 day"),"solitaire"===cleverapps.config.type?e=[BoostersBefore.TYPE_MAGNET,BoostersBefore.TYPE_DICE,BoostersBefore.TYPE_TWO_JOKERS]:"stacks"===cleverapps.config.subtype?e=[BoostersBefore.TYPE_HIGHLIGHT,BoostersBefore.TYPE_EYE,BoostersBefore.TYPE_HINT]:"match3"===cleverapps.config.type?e=[BoostersBefore.TYPE_COMBO,BoostersBefore.TYPE_MOVES,BoostersBefore.TYPE_MULTICOLOR]:"merge"===cleverapps.config.type&&(delete t.unlimitedLives,t.wands=10,t.coins=100),e){t.boosters={};for(var n=0;n<e.length;n++)t.boosters[e[n]]=1}new RewardWindow({reward:t})}),CookieJarRewardWindow:displayToolWindow(function(){new RewardWindow({title:"messages:ExtraWindow.Reward.Title",text:"messages:ExtraWindow.Reward.Text",reward:{
gold:cleverapps.CookieJar.FULL_REWARD}})}),HeroLevelRewardWindow:displayToolWindow(function(){new RewardWindow({reward:{herolevels:["a3","b5"]}})})},saleWindows:function(){var e={};return Favorite.ListProducts().forEach(function(n){e["FavoriteSaleWindow_"+n]=displayToolWindow(function(){var e=Favorite.CalcFavorite;Favorite.CalcFavorite=function(){return n};var t=new Mission(Mission.TYPE_FAVORITE_SALE);t.duration="1 day",new FavoriteSaleWindow(t),Favorite.CalcFavorite=e})}.bind(this)),e},cardSkins:function(){var t={};return CardSkins.All_SKINS.forEach(function(e){2!==e.id&&(t[cleverapps.cardSkins.selectedSkinId===e.id?" "+e.title:e.title]=function(){cleverapps.cardSkins.setSelectedSkin(e.id),cleverapps.refreshScene()})}),t.resetCardSkins=function(){cleverapps.cardSkins.selectedSkinId=1,cleverapps.cardSkins.availableSkins=[],cleverapps.cardSkins.save()},t}},ADS:{cacheRewarded:function(){RewardedAdsManager.prototype.canCache=function(e){return!0},
cleverapps.rewardedAdsManager.cacheNextAd(RewardedAdsManager.REWARDED)},playRewarded:function(){cleverapps.rewardedAdsManager.play(RewardedAdsManager.REWARDED,function(){console.log("REWARDED!")})},cacheInterstitial:function(){RewardedAdsManager.INTERSTITIAL_REWARD_INTERVAL="1 second",RewardedAdsManager.INTERSTITIAL_INTERVAL="1 second",RewardedAdsManager.prototype.canCache=function(e){return!0},cleverapps.rewardedAdsManager.cacheNextAd(RewardedAdsManager.INTERSTITIAL)},playInterstitial:function(){cleverapps.rewardedAdsManager.play(RewardedAdsManager.INTERSTITIAL,function(){console.log("REWARDED INTERSTITIAL!")})},fake_rewarded_off:function(){VideoAds.prototype.isAvailable=function(){return!1}}},Debug:{resolution:function(){var e=Object.keys(resolutions).sort(function(e,t){return resolutions[e].scale-resolutions[t].scale}),t={},n=cleverapps.settings.calcResolution();return e.forEach(function(e){e!==n?t[e]=function(){cleverapps.settings.setManualResolution(e)}:t[e+" [CURRENT]"]=function(
){}}),t},atlas:function(){var n=function(e){var t="";if(cleverapps.isLocalhost()){var n=new URL(location.href);n.hash="",t=n.href}window.open(t+bundles[e].urls.png,"_blank").focus()},t={};if(["main","game","windows","letters_ja","treasuresearch","xmas","homefix_windows"].forEach(function(e){bundles[e]&&!bundles[e].injectTo&&(t[e]=n.bind(this,e))}),"match3"===cleverapps.config.type){var e=["nut","ice","cookieman","box","gingerbread_house","color_container","colorcookieman","crab_maker","bag","dog","rug","waffle","truffle","candle","lollipop","color_bomb","ice_block","transporter","firefly_jar","shark","moves_cell","small_petard","ice_block_maker","syrup","figure_dragon"];"riddles"===cleverapps.config.name?e.concat(["mouse","dirt_maker","burst","rabbit","bomb","ice_cream_maker","petards","dragon","donut_box","cake","muffin","ice_maker","clock","cannon","wall","blanket"]):"heroes"===cleverapps.config.name&&e.concat(["starter_pack","dirt_maker","burst","rabbit","mouse","bomb",
"ice_cream_maker","dragon","donut_box","cake","bomb","muffin"]),e=e.concat(e.map(function(e){return e+"_reskin"})),t.features=function(){var t={};return e.forEach(function(e){bundles[e]&&!bundles[e].injectTo&&(t[e]=n.bind(this,e))}),t}}if(cleverapps.metha.getType()===Metha.FARM){for(var s=[],i=0;i<100;i++){if(!bundles[r="person"+i])break;s.push({name:r+" "+Messages.get(r)})}t.characters=splitEntriesInParts(s,function(e){n(e.name.split(" ")[0])})}else if(cleverapps.config.rpg){var o=[];for(i=0;i<100;i++){var r;if(!bundles[r="enemy"+i])break;o.push(r)}t.enemies=function(){var t={};return o.forEach(function(e){t[e]=n.bind(this,e)}),t}}return t},compensateCheck:function(){cleverapps.Tool.compensateCheck=!0},browserLanguage:function(){alert("System: "+cc.sys.language+" navigator: "+navigator.language)},clearLocalStorage:function(){cc.sys.OS_IOS===cc.sys.os&&cc.sys.isNative&&webkitMessage("localStorage",{action:"clear"}),cleverapps.DataLoader.cleanAll(),cleverapps.DataLoader.enabled=!1,
cleverapps.DataLoader.resetClientSession(),cleverapps.metha.display({name:"waitReload",action:function(e){new WaitWindow}})},printAllLetters:function(){var t={};cleverapps.values(Messages.dictionary).forEach(function(e){Array.isArray(e)||(e=[e]),e.forEach(function(e){e.split("").forEach(function(e){t[e.toLowerCase()]=!0})})}),t=Object.keys(t).sort().join(""),console.log(t.length),console.log(t)},reset:function(){cleverapps.Tool.Debug.clearLocalStorage();var e=cc.sys.OS_IOS===cc.sys.os&&cc.sys.isNative;setTimeout(function(){window.location.reload()},e?500:4e4),cleverapps.metha.display({name:"waitReload",action:function(e){new WaitWindow}}),cleverapps.Tool.resetShare&&cleverapps.Tool.resetShare(),cleverapps.Synchronizer.ACCUMULATE_TIMEOUT=1,levels.user.level=0,levels.user.episode=0,levels.user.initializeNewPlayerGold(),levels.user.progressCompare=0,levels.user.progress=0,levels.user.save(!0);var n=levels.user.id;cleverapps.metha.getType()===Metha.FARM&&cleverapps.farm.reset(),
cleverapps.metha.getType()===Metha.HOMEFIX&&cleverapps.home.reset(),cleverapps.simple&&cleverapps.simple.reset(),cleverapps.knockout&&cleverapps.metha.getMainObject().knockoutGame.reset();var t=cleverapps.once(function(){levels.reset(),cleverapps.synchronizer.onceSyncCompletedListener=s}),s=cleverapps.once(function(){if(cleverapps.settings=new cleverapps.Settings(!0),cleverapps.periodicBonus=new cleverapps.MiniGame(!0),cleverapps.periodicBonus.save(!0),levels.user=new levels.User(!0),levels.user.id=n,cleverapps.user=levels.user,cleverapps.boostersCounter&&(cleverapps.boostersCounter=new cleverapps.BoostersCounter(!0),cleverapps.boostersCounter.save(!0)),cleverapps.bonusRoundChest&&(cleverapps.bonusRoundChest=new cleverapps.BonusRoundChest(!0),cleverapps.bonusRoundChest.save(!0)),cleverapps.promotion&&cleverapps.promotion.reset(),cleverapps.starChest&&(cleverapps.starChest=new cleverapps.StarChest(!0),cleverapps.starChest.save(!0)),cleverapps.packManager&&(
cleverapps.packManager=new PackManager(!0),cleverapps.packManager.save(!0)),cleverapps.unitSyncer&&(cleverapps.unitSyncer.save=function(){},cleverapps.unitSyncer.reset()),Game.currentGame&&Game.currentGame.storeSave&&(Game.currentGame.storeSave=function(){}),cleverapps.forces.reset(),cleverapps.GameSaver&&cleverapps.GameSaver.reset(),cleverapps.missionManager.reset(),cleverapps.friends.reset(),levels.episodes.reset(),levels.episodes.setCurrentEpisode(levels.user.episode),cleverapps.config.results){for(var e=0;e<levels.episodes.getAmountEpisodes();e++){levels.episodes.setCurrentEpisode(e);var t=levels.episodes.getCurrentEpisode();t&&(cleverapps.userresult.reset(t.episodeNo),t.friendsResults.reset())}levels.progress.reset()}cleverapps.serverFlags&&cleverapps.serverFlags.reset(),cleverapps.tempGoods&&cleverapps.tempGoods.reset(),cleverapps.lives&&cleverapps.lives.reset(),cleverapps.gun&&cleverapps.gun.reset(),cleverapps.cardSkins&&cleverapps.cardSkins.reset(),
cleverapps.synchronizer._syncOut.onTasksEmptyListener=function(){window.location.reload()}});cleverapps.synchronizer._syncOut.onTasksEmptyListener=t},forces:{shownForces:function(){var e=Object.keys(Forces).filter(function(e){return"object"==typeof Forces[e]&&cleverapps.forces.isShown(Forces[e].id)}),t={};return e.forEach(function(e){t["X__"+e]=function(){cleverapps.forces.clearForce(Forces[e].id),this.goBack()}}),t},markAllShown:function(){cleverapps.forces.isRunningForce()&&cleverapps.forces.closeRunningForce(),Object.keys(Forces).forEach(function(e){"object"==typeof Forces[e]&&void 0!==Forces[e].id&&cleverapps.forces.saveForce(Forces[e].id)})},clearAll:function(){Object.keys(Forces).forEach(function(e){"object"==typeof Forces[e]&&void 0!==Forces[e].id&&cleverapps.forces.clearForce(Forces[e].id)})}},resetWindows:{packWindow:function(){cleverapps.packManager.whenBuy=0,cleverapps.packManager.whenPopup=0,cleverapps.packManager.save()},promotionWindow:function(){
cleverapps.promotion.nextTime=Date.now(),cleverapps.promotion.createdTime=0,cleverapps.promotion.save()},resetPlacements:function(){cleverapps.placements.resetAllPlacements()}},resetDailyLevel:function(){cleverapps.dailyLevel.reset(),cleverapps.refreshScene()},resetBonusRound:function(){cleverapps.bonusRoundChest.unlock()},throwError:function(){throw"Tool Error"},resetShare:function(){Object.keys(cleverapps.ShareBonus.SHARES).forEach(function(e){var t=new cleverapps.ShareBonus(cleverapps.ShareBonus.SHARES[e]);cleverapps.DataLoader.save(t.storageKey,Date.now()-1e4*t.interval)}),cleverapps.DataLoader.remove(cleverapps.DataLoaderTypes.HELP_FROM_FRIENDS)},screenshots:function(){if(cleverapps.screenshotsMode=!0,cc.director.setDisplayStats(!1),cc.eventManager.addCustomListener(cc.game.EVENT_SHOW,function(){cc.director.setDisplayStats(!1)}),!cc.sys.isNative){for(var e=window.document.body,t=e.getElementsByClassName("container"),n=0;n<t.length;n++)console.log(t.item(n)),e.removeChild(t.item(n)
);var s=e.getElementsByClassName("expand");for(n=0;n<s.length;n++)console.log(s.item(n)),e.removeChild(s.item(n));var i=window.document.getElementById("commits");i&&i.parentNode.removeChild(i)}cleverapps.refreshScene()},hideStats:function(){cc.director.setDisplayStats(!1),cc.eventManager.addCustomListener(cc.game.EVENT_SHOW,function(){cc.director.setDisplayStats(!1)})},diffMaps:function(){if("differences"===cleverapps.config.name){for(var e=function(e,t){var n="http://differences-staging.labsystech.ru/cleverapps/private/differences/diffmaps/"+e+"/"+t+".png";window.open(n,"_blank").focus()},t={},n=0;n<levels.Episodes.getAmountEpisodes();n++){for(var s={},i=0;i<15;i++)s[i]=e.bind(void 0,n,i);t[n]=s}return t}},sendPush:function(){cleverapps.LocalPushes.TIMEOUT_THRESHOLD="1 second";var e=cleverapps.parseInterval("2 seconds");cc.sys.os===cc.sys.OS_IOS&&cc.sys.isNative&&cc.sys.isWebView&&(e=cleverapps.parseInterval("1 minute")),cleverapps.localPushes.sendPush(
cleverapps.LocalPushes.TYPES.LETS_PLAY,e)},debugSlots:function(){cleverapps.Spine.debugSlots=!0,cleverapps.refreshScene()},debugBones:function(){cleverapps.Spine.debugBones=!0,cleverapps.refreshScene()},browserName:function(){cleverapps.Notification.create((new UAParser).getBrowser().name)},islandsInfo:function(){cleverapps.flags.islandsInfoEnabled=!0,cleverapps.refreshScene()},gamePlayer:function(){var e={},t=function(e){var t=GamePlayer.instance||GamePlayer.Create(cc.director.getRunningScene().level.content);t.stop(),t.play({actions:e.actions})};return e.step=t.bind(void 0,{actions:1}),e.start=t.bind(void 0,{actions:100}),e.stop=function(){GamePlayer.instance&&GamePlayer.instance.stop()},e},debugFont:function(){var o=function(e){return{name:"default",fnt:!0,size:e,color:cleverapps.styles.COLORS.WHITE,stroke:cleverapps.styles.DECORATORS.IMAGE_FONT_STROKE}},r="x0123456789/2+3-4",e=[20,25,30,35,40,45,50,55,60,65].map(function(e){var t,n,s=(t=e,cleverapps.UI.generateOnlyText(r,o(t))),i=(
n=e,cleverapps.UI.generateImageText(r,o(n)));return new cleverapps.Layout([i,s],{direction:cleverapps.UI.HORIZONTAL,margin:20})}),t=new cleverapps.Layout(e,{direction:cleverapps.UI.VERTICAL,margin:20}),n=cc.director.getRunningScene().scene;n.addChild(t),t.setPositionRound(n.width/2,n.height-t.height/2-100)},printProductsForCrm:function(){for(var i={},e=0;e<RewardsConfig.Packs.length;e++){var t="starterPack0",n="Starter pack";1===e?(t="starterPack",n="Super pack"):2===e&&(t="starterPack2",n="Mega pack"),i[t]={name:n},cleverapps.extend(i[t],RewardsConfig.Packs[e])}Object.keys(cleverapps.PaymentsManager.PRODUCTS).filter(function(e){return"merge"===cleverapps.config.type&&-1!==["gold500","gold1800","gold3800","gold6000","gold25000"].indexOf(e)||!(!cleverapps.lives&&-1!==e.indexOf("ives"))&&(void 0===i[e]&&(-1!==e.indexOf("Pack")||void 0!==cleverapps.PaymentsManager.PRODUCTS[e].compensateReward))}).forEach(function(e){var t=cleverapps.PaymentsManager.PRODUCTS[e],n=t.title.replace(
"messages:","");if(Messages.has(n)){var s=Messages.get(n);i[e]={name:s},cleverapps.extend(i[e],t.compensateReward||t.reward)}}),cleverapps.values(i).forEach(function(t){t.boosters&&(Object.keys(t.boosters).forEach(function(e){t["booster"+e]=t.boosters[e]}),t.boosters=void 0),t.worker&&(t.worker=cleverapps.parseInterval(t.worker)/36e5),t.unlimitedLives&&(t.unlimitedLives=cleverapps.parseInterval(t.unlimitedLives)/36e5),t.energy&&(t.lives=t.energy,t.energy=void 0)}),console.log(JSON.stringify(i,void 0,4))}},SOCIAL:{share:function(){var e=cleverapps.ShareBonus.cycleShareData("victory",{episodeNo:levels.user.episode,levelNo:cleverapps.Random.random(100,200),score:cleverapps.Random.random(1e3,1e4)});cleverapps.social.shareDialog(e,function(e){e===cleverapps.Social.CODE_SUCCEED?console.log("Success"):(console.log("Failed"),console.log(e))})},inviteFriends:function(){cleverapps.social.inviteFriends({title:"Hello",message:"test test invite message"},function(e,t){
cleverapps.Notification.create("code: "+e+"\n"+JSON.stringify(t)),console.log(e),console.log(t)})},listFriends:function(){cleverapps.social.listFriends(function(e,t){t.forEach(function(e){console.log(JSON.stringify(e))})})},aboutMe:function(){cleverapps.social.aboutMe(function(e,t){console.log("CODE"),console.log(e),console.log(JSON.stringify(t))})},testSchedule:function(){console.log("sendPush: "+1.1*cleverapps.parseInterval(cleverapps.LocalPushes.TIMEOUT_THRESHOLD)),cleverapps.localPushes.sendPush(cleverapps.LocalPushes.TYPES.BOUNTY,1.1*cleverapps.parseInterval(cleverapps.LocalPushes.TIMEOUT_THRESHOLD))},testCancel:function(){console.log("cancelPush"),cleverapps.localPushes.cancelPush(cleverapps.LocalPushes.TYPES.BOUNTY)}},Navigation:{pass_level:function(){if(cleverapps.metha.getType()===Metha.FARM){if(cleverapps.farm.isCompleted())return;if(cleverapps.farm.getBuilding().getQuest().isCompleted())cleverapps.metha.display({focus:"ToolMoveNext",action:function(e){
cleverapps.farm.moveNext(e)}});else{var e=cleverapps.farm.findBuildingForActiveItem();e&&e.levelUp()}cleverapps.environment.isMainScene()||cleverapps.refreshScene()}else{if(levels.user.isPassedAll())return;var t=levels.episodes.episodes[cleverapps.environment.episodeNo],n=t.getCurrentLevel();n&&(cleverapps.config.results&&cleverapps.userresult.updateLevel(t.episodeNo,n.levelNo,Math.floor(1e3*Math.random()),1),levels.user.incLevel()),cleverapps.refreshScene()}},pass_episode:function(){if(!levels.user.isPassedAll()){for(var e=levels.episodes.episodes[cleverapps.environment.episodeNo];e.getCurrentLevel()&&e.getCurrentLevel().levelNo<e.levelsPerEpisode;)levels.user.incLevel();cleverapps.refreshScene()}},pass_all:function(){var n=function(e){var t=e.getCurrentLevel();if(cleverapps.metha.getType()!==Metha.HOSE){if(e.episodeNo!==cleverapps.user.episode)return;t=e.levels[cleverapps.user.level]}return t};cleverapps.metha.display({focus:"ToolPassAll",action:function(e){for(
;!levels.user.isPassedAll();){for(var t=levels.episodes.getCurrentEpisode();n(t)&&n(t).levelNo<t.levelsPerEpisode;)levels.user.incLevel();levels.episodes.nextEpisode()}cleverapps.refreshScene()}})},goto_episode:function(){cleverapps.Tool.Navigation.goto_level("goto_episode")},goto_level:function(n){var s=function(e){if("goto_episode"===n&&0<=parseInt(e)&&(e=15*parseInt(e)+1),e){e=parseInt(e)-1,levels.user.level=e%Episode.LEVELS_PER_EPISODE,levels.user.episode=Math.floor(e/Episode.LEVELS_PER_EPISODE),levels.user.progress=0;var t=levels.episodes.getAmountEpisodes();levels.user.episode>=t&&(levels.user.episode=t,levels.user.level=0,levels.user.progress=e-levels.user.getHumanReadableNumber()+1),levels.user.save(),cleverapps.DataLoader.processSaveQueue(),levels.episodes.reset(),levels.episodes.setCurrentEpisode(levels.user.episode),"undefined"!=typeof match3&&match3&&match3.heroes&&match3.heroes.checkAvailableToOpen(),cleverapps.sideBar.refreshAllIcons(),cleverapps.refreshScene()}};if(
!cc.sys.isNative||cc.sys.isWebView&&cc.sys.OS_IOS===cc.sys.os){var e=window.prompt("level number",15);s(e)}else cleverapps.metha.display({focus:"Prompt",action:function(e){new PromptWindow({callback:s,text:"Level"}),cleverapps.metha.onceNoWindowsListener=e;var t=cc.director.getRunningScene();t.toolMenu&&t.toolMenu.toggle()}})}},gold:function(){var e={add1000:function(){levels.user.setGold(levels.user.gold+1e3)},addExp1000:function(){levels.user.setExp(1e3)}};return"merge"===cleverapps.config.type&&["rubies","coins","wands"].forEach(function(t){e[t+"1000"]=function(){var e={code:t,getData:function(){return{value:1e3}}};Game.currentGame.harvest(e)}}),e.reset=function(){if("merge"===cleverapps.config.type){var e=Game.currentGame.harvested;for(var t in e.items){var n=e.get(t);e.take(t,-n)}}levels.user.setGold(0)},e},boosters:function(){var e={},t=function(e,t){cleverapps.boostersCounter.add(e,t)};return"match3"===cleverapps.config.type&&(e.add10Combos=t.bind(this,BoostersBefore.TYPE_COMBO,
10),e.add10Moves=t.bind(this,BoostersBefore.TYPE_MOVES,10),e.add10Multicolors=t.bind(this,BoostersBefore.TYPE_MULTICOLOR,10),e.add1Combos=t.bind(this,BoostersBefore.TYPE_COMBO,1),e.add1Moves=t.bind(this,BoostersBefore.TYPE_MOVES,1),e.add1Multicolors=t.bind(this,BoostersBefore.TYPE_MULTICOLOR,1)),"solitaire"===cleverapps.config.type&&(e.add10Jokers=t.bind(this,WildcardBooster.ID,10),e.add10Magnets=t.bind(this,BoostersBefore.TYPE_MAGNET,10),e.add10Dices=t.bind(this,BoostersBefore.TYPE_DICE,10),e.add10TwoJokers=t.bind(this,BoostersBefore.TYPE_TWO_JOKERS,10),e.add1Jokers=t.bind(this,WildcardBooster.ID,1),e.add1Magnets=t.bind(this,BoostersBefore.TYPE_MAGNET,1),e.add1Dices=t.bind(this,BoostersBefore.TYPE_DICE,1),e.add1TwoJokers=t.bind(this,BoostersBefore.TYPE_TWO_JOKERS,1)),"scramble"===cleverapps.config.name&&(e.add10Flashlights=t.bind(this,BoostersBefore.TYPE_HIGHLIGHT,10),e.add10Eyes=t.bind(this,BoostersBefore.TYPE_EYE,10),e.add10Loupes=t.bind(this,BoostersBefore.TYPE_HINT,10),
e.add1Flashlights=t.bind(this,BoostersBefore.TYPE_HIGHLIGHT,1),e.add1Eyes=t.bind(this,BoostersBefore.TYPE_EYE,1),e.add1Loupes=t.bind(this,BoostersBefore.TYPE_HINT,1)),e.reset=function(){Object.keys(cleverapps.boostersCounter.data).forEach(function(e){cleverapps.boostersCounter.setAmount(e,0)}),cleverapps.boostersCounter.save()},e},lives:{add5:function(){cleverapps.lives.setAmount(cleverapps.Lives.MAX_REGEN_AMOUNT)},add1:function(){cleverapps.lives.setAmount(cleverapps.lives.amount+1)},addUnlimitedLives:function(){var n=function(e){cleverapps.tempGoods.buyGood(cleverapps.TempGoods.UNLIMITED_LIVES,cleverapps.parseInterval(e)),cleverapps.lives.onBuyUnlimitedLivesListener()};if(cc.sys.isNative)cleverapps.metha.display({focus:"Prompt",action:function(e){new PromptWindow({text:"Time",callback:n,defaultVal:"5 seconds"}),cleverapps.metha.onceNoWindowsListener=e;var t=cc.director.getRunningScene();t.toolMenu&&t.toolMenu.toggle()}});else{var e=window.prompt("unlimited time","5 seconds")
;null!==e&&n(e)}},reset:function(){cleverapps.tempGoods.resetGood(cleverapps.TempGoods.UNLIMITED_LIVES),cleverapps.lives.setAmount(0)},reset_help_from_friends:function(){cleverapps.DataLoader.save(cleverapps.DataLoaderTypes.HELP_FROM_FRIENDS,{})},rewarded_ads_available:function(){cleverapps.rewardedAdsManager.isAvailable=function(){return!0}}},start_pack:function(){cleverapps.packManager.whenStart=Date.now(),cleverapps.packManager.whenPopup=-1,cleverapps.packManager.used=0,cleverapps.packManager.save()},piggyBank:{stop:function(){cleverapps.piggyBank.stop()},start:function(){var e=cleverapps.sideBar.defaultIcons.filter(function(e){return e instanceof PiggyBankIcon}).pop();-1===cleverapps.sideBar.icons.indexOf(e)&&(cleverapps.piggyBank.when=void 0,cleverapps.piggyBank.active=!1,cleverapps.piggyBank.save(),cleverapps.piggyBank.isActive()&&cleverapps.sideBar.addIcon(e))},reset:function(){cleverapps.piggyBank.level=0,cleverapps.piggyBank.amount=cleverapps.piggyBank.getBaseAmount(),
cleverapps.piggyBank.save()}},dailyTasks:{regenerate:function(){if(cleverapps.dailyTasks.provider||(cleverapps.dailyTasks.provider=new cleverapps.DailyTasksProvider),this.hasOwnProperty("dailyTasksIteration"))this.dailyTasksIteration++;else{this.dailyTasksIteration=0;var e=cleverapps.dailyTasks.provider.getActiveTasksList();this.dailyTasks={},["low","mid","hard"].forEach(function(t){this.dailyTasks[t]=e.filter(function(e){return e[t]})}.bind(this))}var n=[];(["low","mid","hard"].forEach(function(e){var t=void 0;0<this.dailyTasks[e].length&&(t=this.dailyTasks[e][this.dailyTasksIteration%this.dailyTasks[e].length].createTask(e)),n.push(t)}.bind(this)),cleverapps.dailyTasks.tasks=n,cleverapps.dailyTasks.startGeneratedTasks(),0<cleverapps.windows.list.length&&cleverapps.windows.list[cleverapps.windows.list.length-1]instanceof DailyTasksWindow)&&cleverapps.windows.list[cleverapps.windows.list.length-1].close();cleverapps.metha.display({focus:"DailyTasksWindow",action:function(e){
new DailyTasksWindow,cleverapps.metha.onceNoWindowsListener=e}})},finish:function(){var e=cleverapps.dailyTasks.getActiveTasks();if(0<e.length){var t=e[0];t.addProgress(t.goal,t.data)}},add_1:function(){var e=cleverapps.dailyTasks.getActiveTasks();if(0<e.length){var t=e[0];t.addProgress(1,t.data)}}},subscriptions:{get:function(){cleverapps.subscription&&cleverapps.subscription.isActive()&&!levels.user.haveTmpId()&&cleverapps.subscription.getAsync(function(e,t){console.log("get user subscription",e,JSON.stringify(t))})},reactivate:function(){cleverapps.subscription&&cleverapps.subscription.reactivate(function(){cleverapps.Tool.subscriptions.get()})},changeToWeek:function(){cleverapps.subscription.isActive()&&"facebook"===cleverapps.User.calcSource()&&plugin.FacebookAgent.getInstance().canvas.pay({action:"change_subscription",subscription_id:cleverapps.subscription.id,product:Product.Create("subsWeek").id.facebook},function(){cleverapps.Tool.subscriptions.get()})},changeToMonth:function(
){cleverapps.subscription.isActive()&&"facebook"===cleverapps.User.calcSource()&&plugin.FacebookAgent.getInstance().canvas.pay({action:"change_subscription",subscription_id:cleverapps.subscription.id,product:Product.Create("subsMonth").id.facebook},function(){cleverapps.Tool.subscriptions.get()})},activate_buy_free:function(){cleverapps.subscription.toolDebugWithoutPayment=!0},deactivate_buy_free:function(){cleverapps.subscription.toolDebugWithoutPayment=!1},cancel:function(){cleverapps.subscription&&cleverapps.subscription.cancel(function(){cleverapps.Tool.subscriptions.get()})}},tournament:function(){var e=function(){MissionManager.AVAILABLE={episode:0,level:1}},o=function(){var t=Missions.SEMAPHORE_CLASSIC|Missions.SEMAPHORE_BACKGROUND|Missions.SEMAPHORE_LANTERN|Missions.SEMAPHORE_MERGE_EVENTS;return cleverapps.missionManager.missions.find(function(e){return e.isRunning()&&e.semaphore&t&&e.finishTime()>Date.now()+5e3})},c=function(){var t=Missions.SEMAPHORE_CLASSIC
;return cleverapps.missionManager.missions.find(function(e){return e.isRunning()&&e.semaphore&t&&e.finishTime()>Date.now()+5e3})},l=function(e){if(e){e.started=Date.now()-cleverapps.parseInterval(e.duration)+5e3,e.onUpdateState(),cleverapps.missionManager.save()}},t=function(e){var t=cleverapps.missionManager.getRunningMission(Missions[e].semaphore);t&&cleverapps.missionManager.remove(t)},n={};return"undefined"!=typeof match3&&(-1!==cleverapps.missionManager.listAvailableTypes().indexOf(Mission.TYPE_COMBO)&&(n.startMagic=function(){t(Mission.TYPE_COMBO),e(),cleverapps.missionManager.add(Mission.TYPE_COMBO)}),-1!==cleverapps.missionManager.listAvailableTypes().indexOf(Mission.TYPE_BURN_NEARBY)&&(n.startTulpan=function(){t(Mission.TYPE_BURN_NEARBY),e(),cleverapps.missionManager.add(Mission.TYPE_BURN_NEARBY)}),-1!==cleverapps.missionManager.listAvailableTypes().indexOf(Mission.TYPE_COLLECT_MARK)&&(n.startRose=function(){t(Mission.TYPE_COLLECT_MARK),e(),cleverapps.missionManager.add(
Mission.TYPE_COLLECT_MARK)}),-1!==cleverapps.missionManager.listAvailableTypes().indexOf(Mission.TYPE_LANTERN)&&(n.startLantern=function(){t(Mission.TYPE_LANTERN),e(),cleverapps.missionManager.add(Mission.TYPE_LANTERN)},n.setLanternLevel=function(){var e=cleverapps.missionManager.findByType(Mission.TYPE_LANTERN);if(e){var t=parseInt(window.prompt("Lantern level (0..."+Lantern.getMaxStreak()+"):")),n=!1;isNaN(t)||0<=t&&t<=Lantern.getMaxStreak()&&(n=!0,e.logic.lantern.streak=e.logic.lantern.savedStreak=t,e.logic.lantern.save()),n||alert("INCORRECT LEVEL")}else alert(" ! No active lantern mission ! ")})),"solitaire"===cleverapps.config.type&&-1!==cleverapps.missionManager.listAvailableTypes().indexOf(Mission.TYPE_LETTER)&&(n.startRuby=function(){t(Mission.TYPE_LETTER),e(),cleverapps.missionManager.add(Mission.TYPE_LETTER)}),-1!==cleverapps.missionManager.listAvailableTypes().indexOf(Mission.TYPE_TREASURE_SEARCH)&&(n.startTreasureSearch=function(){t(Mission.TYPE_TREASURE_SEARCH),e(),
cleverapps.missionManager.add(Mission.TYPE_TREASURE_SEARCH)},n.viewTreasureSearchField=function(){var e=cleverapps.missionManager.findByType(Mission.TYPE_TREASURE_SEARCH);if(e){for(var t="",n=0;n<TreasureSearch.HEIGHT;n++){for(var s=0;s<TreasureSearch.WIDTH;s++)e.details.field[TreasureSearch.HEIGHT-n-1][s]===TreasureSearch.ELEMENT_GEM?t+="*":t+="-";t+="\n"}alert("TreasureSearch unopened keys/flowers:\n"+t)}else alert(" ! No active treasureSearch mission ! ")},n.add20Shovels=function(){var e=cleverapps.missionManager.getRunningMission(Missions.SEMAPHORE_BACKGROUND);e&&e.updateCurrency(20)}),-1!==cleverapps.missionManager.listAvailableTypes().indexOf(Mission.TYPE_STICKERS_COLLECTION)&&(n.startStickersCollection=function(){t(Mission.TYPE_STICKERS_COLLECTION),e(),cleverapps.missionManager.add(Mission.TYPE_STICKERS_COLLECTION)},n.add10Gems=function(){var e=cleverapps.missionManager.getRunningMission(Missions.SEMAPHORE_BACKGROUND);e&&e.updateCurrency(10)}),"merge"===cleverapps.config.type&&(
n.startEnergyFeast=function(){t(Mission.TYPE_ENERGY_FEAST),e(),cleverapps.missionManager.add(Mission.TYPE_ENERGY_FEAST)}),"merge"!==cleverapps.config.type&&"match3"!==cleverapps.config.type||(n.startBattlePass=function(){t(Mission.TYPE_BATTLEPASS),e(),cleverapps.missionManager.add(Mission.TYPE_BATTLEPASS)},n.addBattlePassStars=function(){var e=parseInt(prompt("enter stars amount"));e&&(cleverapps.missionManager.findByType(Mission.TYPE_BATTLEPASS)&&cleverapps.missionManager.dispatchEvent(Mission.EVENT_UNIT_BUILT,{amount:e}))},n.setBattlePassLevel=function(){for(var e={},t=function(e){var t=cleverapps.missionManager.findByType(Mission.TYPE_BATTLEPASS);if(t){for(var n=t.battlePass.getCurrentTask().level;n<e;++n)t.battlePass.goNextLevel();t.battlePass.save(),cleverapps.sideBar.resetByClassName(MissionIcon)}},n=0,s=BattlePass.getLevels().length;n<s;++n)e["level "+(n+1)]=t.bind(null,n);return e.finish=t.bind(null,BattlePass.getLevels().length),e},n.dropAllRewardsButLast=function(){
var e=cleverapps.missionManager.findByType(Mission.TYPE_BATTLEPASS);e&&(e.battlePass.levelsToPremReward.splice(0,e.battlePass.levelsToPremReward.length-1),e.battlePass.levelsToReward.splice(0,e.battlePass.levelsToReward.length-1),e.battlePass.save())},n.resetBattlePass=function(){var e=cleverapps.missionManager.findByType(Mission.TYPE_BATTLEPASS);e&&(e.battlePass.load({}),e.battlePass.save(),cleverapps.sideBar.resetByClassName(MissionIcon))}),n.win_place=function(){var e=window.prompt("Enter the place (1-5): ");if(e){if(t=e,(n=Math.floor(Number(t)))!==1/0&&String(n)===t){var t,n,s=parseInt(e);if(!(s<1||5<s)){for(var i=0;i<cleverapps.missionManager.missions.length;i++){var o=cleverapps.missionManager.missions[i].runningCompetition;if(o){if(1===s)cleverapps.missionManager.missions[i].update(1e3);else{var r=o.results;if(r.sort(function(e,t){return t.amount-e.amount}),r[s-2].amount-r[s-1].amount<2)for(var a=0;a<s-1;a++)o.updatePlayerResult(r[a].id,r[a].amount+2*(s-1-a))
;cleverapps.missionManager.missions[i].update(Math.max(0,r[s-2].amount-cleverapps.missionManager.missions[i].result-1))}o.stop()}}l(c())}}}},n.win_1_native=function(){var e=c();e&&(e.getResults().length&&e.update(1e3),l(e))},n.lose=function(){for(var e=!1,t=0;t<cleverapps.missionManager.missions.length;t++){var n=cleverapps.missionManager.missions[t].getResults();if(n.length){for(var s=0,i=0;i<n.length;i++)n[i].player&&(s=i);5<=s?cleverapps.missionManager.missions[t].update(Math.max(1,cleverapps.missionManager.missions[t].result)-cleverapps.missionManager.missions[t].result):cleverapps.missionManager.missions[t].update(-1e3),e=!0}}e&&l(o())},"board"===cleverapps.config.type&&(n.startLetter=function(){t(Mission.TYPE_LETTER),cleverapps.missionManager.add(Mission.TYPE_LETTER)}),n.finish=function(){var e=o();e&&l(e)},n.stop=function(){var e=o();e&&t(e.type)},n},paymentsHistory:{add500:function(){cleverapps.paymentsHistory.addPayment(Product.Create("gold500"))},add1800:function(){
cleverapps.paymentsHistory.addPayment(Product.Create("gold1800"))},add6000:function(){cleverapps.paymentsHistory.addPayment(Product.Create("gold6000"))},add25000:function(){cleverapps.paymentsHistory.addPayment(Product.Create("gold25000"))},resetPaymentsHistory:function(){cleverapps.DataLoader.remove(cleverapps.DataLoaderTypes.PAYMENTS_HISTORY),cleverapps.DataLoader.remove(cleverapps.DataLoaderTypes.PACK),cleverapps.DataLoader.remove(cleverapps.DataLoaderTypes.PIGGY_BANK),cleverapps.paymentsHistory.load()}},displayFuturePromos:function(){var e=function(e){if(e){var t=[],n=new Date;for(var s in e){var i=e[s];if(i.start)n<=new Date(i.start)&&t.push(i)}0===t.length?console.log(" --- No promos in future --- "):(t.sort(function(e,t){return t<e?1:e<t?-1:0}),console.log(" --- Promos in future: ",t))}else console.log(" --- Error getting schedule.json --- ")}.bind(this);cleverapps.RestClient.get("/community/schedule",{},e,function(e){console.log(" --- Error getting schedule.json --- ",e)})},
audio:{currentSceneDelay:function(){var e=cc.director.getRunningScene().getAudioStyles();e?console.log("### Current scene delay: "+e.delay):console.log("### No audio styles for scene")},setSceneDelay:function(){var e=parseFloat(window.prompt("Delay",1));if(isNaN(e))console.log("### Wrong value");else{var t=cc.director.getRunningScene();t.getAudioStyles()?t instanceof GameSceneBase?(cleverapps.styles.GameScene.sound.delay=e,console.log("#### GameSceneBase set to "+e)):t instanceof cleverapps.FixedWidthScene&&(cleverapps.styles.FixedWidthScene.sound.delay=e,console.log("#### FixedWidthScene set to "+e)):console.log("#### No audio styles for current scene")}}},events:function(){var s={},t=[];return cleverapps.eventManager.events.forEach(function(e){var n=new Event(e);(t=t.filter(function(e){var t=new Event(e);return JSON.stringify(n.features.slice(0).sort())!==JSON.stringify(t.features.slice(0).sort())})).push(e)}),t.forEach(function(e){var t=new Event(e),
n=cleverapps.eventManager.isEventApplicable(t);s[function(e,t){var n=new Event(e).features.join(", "),s=e.networks||e.trueData&&e.trueData.networks;if(s){var i="["+s[0];i+=s[1]?", "+s[1]:"",i+=s[2]?"...":"",n=(i+="] ")+n}return n=t?" "+n+" ("+new Date(e.finish).toLocaleDateString("ru",{day:"numeric",month:"numeric",hour:"numeric",minute:"numeric"})+")":n}(e,n)]=function(){e.toolApplicable=!n,e.toolApplicable?(e.trueData={start:e.start,finish:e.finish,networks:e.networks},e.start=new Date(Date.now()+300*cleverapps.parseInterval("1 minute")-cleverapps.parseInterval("1 second")).toISOString(),e.finish=new Date(Date.now()+300*cleverapps.parseInterval("1 minute")+cleverapps.parseInterval("1 hour")).toISOString(),delete e.networks):e.trueData&&(e.start=e.trueData.start,e.finish=e.trueData.finish,e.networks=e.trueData.networks,delete e.trueData),cleverapps.refreshScene()}}),s},friendRequests:{create:function(){levels.friendRequests.listAvailableTypes().forEach(function(e){
var t=levels.FriendRequest.SYSTEM_ID,n=cleverapps.friends.listFriends()[0];n&&n.id&&(t=n.id);var s={id:"__"+Math.floor(1e15*Math.random()),from:t,type:e};levels.friendRequests.notProcessed.push(levels.FriendRequest.createFriendRequest(s)),levels.friendRequests.save(),levels.friendRequests.onNewListener()})},clear:function(){levels.friendRequests.notProcessed=[],levels.friendRequests.save()}},dailyCup:{setStars:function(){cleverapps.dailyCup.stars=parseInt(window.prompt("Enter stars","10")),cleverapps.dailyCup.save(),cleverapps.dailyCup.runUpdateListeners()},setPlayers:function(){DailyCup.DEBUG_PLAYERS_AMOUNT=parseInt(window.prompt("Enter amount of players","10")),cleverapps.dailyCup.players=cleverapps.dailyCup.players.filter(function(e){return e.player}),cleverapps.dailyCup.preparePlayersData(),cleverapps.dailyCup.runUpdateListeners()},setPlace:function(){var e=parseInt(window.prompt("Enter place","1"))-1;if(!isNaN(e)){var t,n=cleverapps.dailyCup.players.filter(function(e){
return!e.player});if(n.length)t=e>=n.length?n[n.length-1].amount-1:n[e].amount+1,cleverapps.dailyCup.stars=t;cleverapps.dailyCup.save(),cleverapps.dailyCup.runUpdateListeners()}}},bonusWorld:{gotoLevel:function(){var e=cleverapps.missionManager.getRunningMission(Missions.SEMAPHORE_BONUS_WORLD);if(e){var t=parseInt(window.prompt("level number",15))-1;if(!isNaN(t)){for(var n=e.details.receivedRewards||{},s=0;s<RewardsConfig.BonusWorld.length;s++)RewardsConfig.BonusWorld[s].level>=t&&delete n[RewardsConfig.BonusWorld[s].level];var i=e.details;i.receivedRewards=n,e.update(t-e.result,i),cleverapps.refreshScene()}}}},slotMachine:{setPayline:function(){if("slotmachine"===cleverapps.environment.scene){var t={c:"coin",cs:"coins",b1:"booster_1",b2:"booster_2",b3:"booster_3"},e="Enter 3 elements, separated by comma";for(var n in t)e=e+"\n "+n+": "+t[n];SlotMachine.PREDEFINED_PAYLINE=window.prompt(e,"c,c,c").replace(/ /g,"").split(",").map(function(e){return t[e]})}},resetPayline:function(){
delete SlotMachine.PREDEFINED_PAYLINE}}},cleverapps.refreshScene=function(){var e=function(e){var t=cc.director.getRunningScene();t.refreshFromTool=!0,t instanceof MainScene||cleverapps.environment.isMethaScene()?cleverapps.metha.gotoMainScene(e):void 0!==EditorScene&&t instanceof EditorScene?EditorScene.open({level:t.level,callback:e}):t instanceof GameScene?cleverapps.config.editorMode?(e(),LevelManager.getInstance().setLevel({levelNo:cleverapps.environment.levelNo,episodeNo:cleverapps.environment.episodeNo}),LevelManager.getInstance().editLevel()):(Game.currentGame&&Game.currentGame.stop(),"merge"===cleverapps.config.type?cleverapps.metha.gotoMainScene(e):cleverapps.metha.wantsToPlay(e)):"undefined"!=typeof HeroesScene&&t instanceof HeroesScene?cleverapps.scenes.replaceScene(new HeroesScene,e):t instanceof DailyCupScene?cleverapps.scenes.replaceScene(new DailyCupScene,e):t instanceof BonusWorldScene&&cleverapps.metha.gotoMainScene(function(){cleverapps.scenes.replaceScene(
new BonusWorldScene(cleverapps.missionManager.getRunningMission(Missions.SEMAPHORE_BONUS_WORLD)),e)})};cleverapps.metha.isFocused()?cleverapps.metha.distract({focus:"sceneRefresh",action:e}):cleverapps.metha.display({focus:"sceneRefresh",action:e})},WorldMap.prototype._onTouchEnded=WorldMap.prototype.onTouchEnded,WorldMap.prototype.onTouchEnded=function(){if(this.clickedBuilding&&!this.pinchZooming&&cleverapps.keyboardController.isPressed(cc.KEY.j))if(cleverapps.metha.getType()===Metha.FARM){Farm.Reset();var e=Farm.GetBuildingProgress(this.clickedBuilding.building.id,0);cleverapps.farm.load(e),cleverapps.farm.save(),cleverapps.refreshScene()}else cleverapps.metha.getType()===Metha.HOMEFIX&&HomeTool.set(this.clickedBuilding.building.id,0,!1,function(){cleverapps.refreshScene()});else WorldMap.prototype._onTouchEnded.apply(this,arguments)};var PromptWindow=Window.extend({onWindowLoaded:function(t){var e=this.getContent(t);this._super({name:"promptwindow",content:e,closeButton:!0,button:{
width:150,text:"OK",onPressed:function(){var e=this.editBox.getString();t.callback(e),this.close()}.bind(this)}}),this.editBox.attachWithIME()},getContent:function(e){var t=new cc.Node,n=new ccui.TextField,s=new cc.Color(0,0,0,255);return n.setTextColor(s),n.setPlaceHolderColor(s),this.editBox=n,t.addChild(n),n.setFontSize(60),n.setPlaceHolder(e.text),e.defaultVal&&n.setString("5 seconds"),t}});cleverapps.Recorder={init:function(){cleverapps.Recorder.canvas||(cleverapps.Recorder.canvas=document.getElementById("gameCanvas"))},start:function(e,s){cleverapps.Recorder.init(),navigator.getUserMedia({audio:{echoCancellation:!1,autoGainControl:!1,noiseSuppression:!1,latency:0,channelCount:2}},function(t){var n=cleverapps.Recorder.canvas.captureStream(30),e=new MediaStream([n.getVideoTracks()[0],t.getAudioTracks()[0]]);cleverapps.Recorder.recorder=new MediaRecorder(e,{mimeType:cleverapps.Recorder.MIME_TYPE,audioBitsPerSecond:128e3,videoBitsPerSecond:84e5}),cleverapps.Recorder.recordedBlobs=[],
cleverapps.Recorder.recorder.ondataavailable=function(e){cleverapps.Recorder.recordedBlobs.push(e.data)},cleverapps.Recorder.recorder.onstop=function(e){console.log("Recorder stopped: ",e),n.getTracks().forEach(function(e){e.stop()}),t.getTracks().forEach(function(e){e.stop()})},cleverapps.Recorder.recorder.onstart=function(e){s.frameCapture&&cleverapps.Recorder.captureFrames(s.frameCapture)},cleverapps.Recorder.recorder.start(10)},function(e){console.log(e.message)}),e&&e()},pause:function(e){cleverapps.Recorder.recorder&&(cleverapps.Recorder.recorder.pause(),console.log("Recorder paused...")),e&&e()},resume:function(e){cleverapps.Recorder.recorder&&(cleverapps.Recorder.recorder.resume(),console.log("Recorder resumed...")),e&&e()},stop:function(t){if(cleverapps.Recorder.recorder){cleverapps.Recorder.recorder.stop();var e=new Blob(cleverapps.Recorder.recordedBlobs,{type:cleverapps.Recorder.MIME_TYPE}),n=new FileReader;n.readAsDataURL(e),n.onload=function(e){
cleverapps.Recorder.data&&cleverapps.Recorder.data.data?cleverapps.Recorder.data.data.push(e.target.result):cleverapps.Recorder.data={data:[e.target.result]},cleverapps.Recorder.ext=".webm",t()}}},captureFrames:function(i){var o=0,r=function(){if("recording"===cleverapps.Recorder.recorder.state){o++,(!i.amount||o<i.amount)&&setTimeout(r,i.frequency);var e=i.baseName+"_frames",t=o+"_frame_"+i.baseName+".jpg",n=i.path+e+"/"+t,s={data:cleverapps.Recorder.canvas.toDataURL("image/jpeg",.9)};this.post("/recorder/"+n,s,void 0,void 0,12e4)}}.bind(this);r()},screenshot:function(){cleverapps.Recorder.init();var e=cleverapps.Recorder.canvas.toDataURL("image/jpeg",.9);cleverapps.Recorder.data={data:e},cleverapps.Recorder.ext=".jpg"},save:function(e,t,n,s){var i=e+"/"+t+cleverapps.Recorder.ext,o=cleverapps.extend(cleverapps.clone(cleverapps.Recorder.data),n||{});this.post("/recorder/"+i,o,s,void 0,12e4),cleverapps.Recorder.data=void 0,cleverapps.Recorder.ext=void 0},runTransform:function(e){
e.crf=23,this.post("/recorder/transform",e)},post:function(e,t,n,s,i){cleverapps.config.workerTaskId&&0!==e.indexOf("http")&&(e="http://localhost:3201"+e),t.project=cleverapps.config.name,t.workerTaskId=cleverapps.config.workerTaskId,cleverapps.RestClient.post(e,t,n,s,i)}},cleverapps.Recorder.MIME_TYPE='video/webm;codecs="vp8,opus"';var CocosTransitions={init:function(){var e;cc.NodeGrid=cc.Node.extend({grid:null,_target:null,_gridRect:null,ctor:function(e){cc.Node.prototype.ctor.call(this),void 0===e&&(e=cc.rect()),this._gridRect=e},getGrid:function(){return this.grid},setGrid:function(e){this.grid=e},setGridRect:function(e){this._gridRect=e},getGridRect:function(){return this._gridRect},setTarget:function(e){this._target=e},_createRenderCmd:function(){return cc._renderType===cc.game.RENDER_TYPE_WEBGL?new cc.NodeGrid.WebGLRenderCmd(this):new cc.Node.CanvasRenderCmd(this)}}),(e=cc.NodeGrid.prototype).grid,e.target,cc.defineGetterSetter(e,"target",null,e.setTarget),
cc.NodeGrid.create=function(){return new cc.NodeGrid},function(){cc.NodeGrid.WebGLRenderCmd=function(e){cc.Node.WebGLRenderCmd.call(this,e),this._needDraw=!1,this._gridBeginCommand=new cc.CustomRenderCmd(this,this.onGridBeginDraw),this._gridEndCommand=new cc.CustomRenderCmd(this,this.onGridEndDraw)};var e=cc.NodeGrid.WebGLRenderCmd.prototype=Object.create(cc.Node.WebGLRenderCmd.prototype);e.constructor=cc.NodeGrid.WebGLRenderCmd,e.visit=function(e){var t=this._node;if(t._visible){e=e||this.getParentRenderCmd(),t._parent&&t._parent._renderCmd&&(this._curLevel=t._parent._renderCmd._curLevel+1);var n=cc.current_stack;n.stack.push(n.top),this._syncStatus(e),n.top=this._stackMatrix,cc.renderer.pushRenderCommand(this._gridBeginCommand),t._target&&t._target.visit();var s=t._children;if(s&&0<s.length){var i=s.length;t.sortAllChildren();for(var o=0;o<i;o++){var r=s[o];r&&r.visit()}}cc.renderer.pushRenderCommand(this._gridEndCommand),this._dirtyFlag=0,n.top=n.stack.pop()}},
e.onGridBeginDraw=function(){var e=this._node.grid;e&&e._active&&e.beforeDraw()},e.onGridEndDraw=function(){var e=this._node.grid;e&&e._active&&e.afterDraw(this._node)}}(),cc.GridBase=cc.Class.extend({_active:!1,_reuseGrid:0,_gridSize:null,_gridRect:null,_texture:null,_step:null,_grabber:null,_isTextureFlipped:!1,_shaderProgram:null,_directorProjection:0,_dirty:!1,ctor:function(e,t,n,s){cc.sys._checkWebGLRenderMode(),this._active=!1,this._reuseGrid=0,this._gridSize=null,this._gridRect=new cc.rect,this._texture=null,this._step=cc.p(0,0),this._grabber=null,this._isTextureFlipped=!1,this._shaderProgram=null,this._directorProjection=0,this._dirty=!1,void 0!==e&&this.initWithSize(e,t,n,s)},isActive:function(){return this._active},setActive:function(e){if(!(this._active=e)){var t=cc.director,n=t.getProjection();t.setProjection(n)}},getReuseGrid:function(){return this._reuseGrid},setReuseGrid:function(e){this._reuseGrid=e},getGridSize:function(){return cc.size(this._gridSize.width,
this._gridSize.height)},setGridSize:function(e){this._gridSize.width=parseInt(e.width),this._gridSize.height=parseInt(e.height)},setGridRect:function(e){this._gridRect=e},getGridRect:function(){return this._gridRect},getStep:function(){return cc.p(this._step.x,this._step.y)},setStep:function(e){this._step.x=e.x,this._step.y=e.y},isTextureFlipped:function(){return this._isTextureFlipped},setTextureFlipped:function(e){this._isTextureFlipped!==e&&(this._isTextureFlipped=e,this.calculateVertexPoints())},initWithSize:function(e,t,n,s){if(!t){var i=cc.director.getWinSizeInPixels(),o=cc.NextPOT(i.width),r=cc.NextPOT(i.height),a=new Uint8Array(o*r*4);if(!a)return cc.log("cocos2d: CCGrid: not enough memory."),!1;if((t=new cc.Texture2D).initWithData(a,cc.Texture2D.PIXEL_FORMAT_RGBA8888,o,r,i),!t)return cc.log("cocos2d: CCGrid: error creating texture"),!1}if(n=n||!1,this._active=!1,this._reuseGrid=0,this._gridSize=e,this._texture=t,this._isTextureFlipped=n,void 0===s||cc._rectEqualToZero(s)){
var c=this._texture.getContentSize();s=new cc.rect(0,0,c.width,c.height)}return this._gridRect=s,this._step.x=this._gridRect.width/e.width,this._step.y=this._gridRect.height/e.height,this._grabber=new cc.Grabber,!!this._grabber&&(this._grabber.grab(this._texture),this._shaderProgram=cc.shaderCache.programForKey(cc.SHADER_POSITION_TEXTURE),this.calculateVertexPoints(),!0)},beforeDraw:function(){this._directorProjection=cc.director.getProjection();var e=cc.director.getWinSizeInPixels();gl.viewport(0,0,e.width,e.height),this._grabber.beforeRender(this._texture)},afterDraw:function(e){this._grabber.afterRender(this._texture),cc.director.setViewport(),cc.glBindTexture2D(this._texture),this.beforeBlit(),this.blit(e),this.afterBlit()},beforeBlit:function(){},afterBlit:function(){},blit:function(){cc.log("cc.GridBase.blit(): Shall be overridden in subclass.")},reuse:function(){cc.log("cc.GridBase.reuse(): Shall be overridden in subclass.")},calculateVertexPoints:function(){cc.log(
"cc.GridBase.calculateVertexPoints(): Shall be overridden in subclass.")},set2DProjection:function(){var e=cc.director.getWinSizeInPixels();cc._renderContext.viewport(0,0,e.width,e.height),cc.kmGLMatrixMode(cc.KM_GL_PROJECTION),cc.kmGLLoadIdentity();var t=cc.math.Matrix4.createOrthographicProjection(0,e.width,0,e.height,-1,1);cc.kmGLMultMatrix(t),cc.kmGLMatrixMode(cc.KM_GL_MODELVIEW),cc.kmGLLoadIdentity(),cc.setProjectionMatrixDirty()}}),cc.GridBase.create=function(e,t,n,s){return new cc.GridBase(e,t,n,s)},cc.Grid3D=cc.GridBase.extend({_texCoordinates:null,_vertices:null,_originalVertices:null,_indices:null,_texCoordinateBuffer:null,_verticesBuffer:null,_indicesBuffer:null,_needDepthTestForBlit:!1,_oldDepthTestValue:!1,_oldDepthWriteValue:!1,ctor:function(e,t,n,s){cc.GridBase.prototype.ctor.call(this),this._texCoordinates=null,this._vertices=null,this._originalVertices=null,this._indices=null,this._texCoordinateBuffer=null,this._verticesBuffer=null,this._indicesBuffer=null,
this._matrix=new cc.math.Matrix4,this._matrix.identity(),void 0!==e&&this.initWithSize(e,t,n,s)},vertex:function(e){return this.getVertex(e)},getVertex:function(e){e.x===(0|e.x)&&e.y===(0|e.y)||cc.log("cc.Grid3D.vertex() : Numbers must be integers");var t=0|3*(e.x*(this._gridSize.height+1)+e.y),n=this._vertices;return new cc.Vertex3F(n[t],n[t+1],n[t+2])},originalVertex:function(e){return this.getOriginalVertex(e)},getOriginalVertex:function(e){e.x===(0|e.x)&&e.y===(0|e.y)||cc.log("cc.Grid3D.originalVertex() : Numbers must be integers");var t=0|3*(e.x*(this._gridSize.height+1)+e.y),n=this._originalVertices;return new cc.Vertex3F(n[t],n[t+1],n[t+2])},setVertex:function(e,t){e.x===(0|e.x)&&e.y===(0|e.y)||cc.log("cc.Grid3D.setVertex() : Numbers must be integers");var n=0|3*(e.x*(this._gridSize.height+1)+e.y),s=this._vertices;s[n]=t.x,s[n+1]=t.y,s[n+2]=t.z,this._dirty=!0},beforeBlit:function(){if(this._needDepthTestForBlit){var e=cc._renderContext;this._oldDepthTestValue=e.isEnabled(
e.DEPTH_TEST),this._oldDepthWriteValue=e.getParameter(e.DEPTH_WRITEMASK),e.enable(e.DEPTH_TEST),e.depthMask(!0)}},afterBlit:function(){if(this._needDepthTestForBlit){var e=cc._renderContext;this._oldDepthTestValue?e.enable(e.DEPTH_TEST):e.disable(e.DEPTH_TEST),e.depthMask(this._oldDepthWriteValue)}},blit:function(e){var t=this._gridSize.width*this._gridSize.height,n=e._renderCmd._worldTransform;this._matrix.mat[0]=n.a,this._matrix.mat[4]=n.c,this._matrix.mat[12]=n.tx,this._matrix.mat[1]=n.b,this._matrix.mat[5]=n.d,this._matrix.mat[13]=n.ty,this._shaderProgram.use(),this._shaderProgram._setUniformForMVPMatrixWithMat4(this._matrix);var s=cc._renderContext,i=this._dirty;s.enableVertexAttribArray(cc.VERTEX_ATTRIB_POSITION),s.enableVertexAttribArray(cc.VERTEX_ATTRIB_TEX_COORDS),s.bindBuffer(s.ARRAY_BUFFER,this._verticesBuffer),i&&s.bufferData(s.ARRAY_BUFFER,this._vertices,s.DYNAMIC_DRAW),s.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION,3,s.FLOAT,!1,0,0),s.bindBuffer(s.ARRAY_BUFFER,
this._texCoordinateBuffer),i&&s.bufferData(s.ARRAY_BUFFER,this._texCoordinates,s.DYNAMIC_DRAW),s.vertexAttribPointer(cc.VERTEX_ATTRIB_TEX_COORDS,2,s.FLOAT,!1,0,0),s.bindBuffer(s.ELEMENT_ARRAY_BUFFER,this._indicesBuffer),i&&s.bufferData(s.ELEMENT_ARRAY_BUFFER,this._indices,s.STATIC_DRAW),s.drawElements(s.TRIANGLES,6*t,s.UNSIGNED_SHORT,0),i&&(this._dirty=!1),cc.incrementGLDraws(1)},reuse:function(){if(0<this._reuseGrid){for(var e=this._originalVertices,t=this._vertices,n=0,s=this._vertices.length;n<s;n++)e[n]=t[n];--this._reuseGrid}},calculateVertexPoints:function(){var e=cc._renderContext,t=this._texture.pixelsWidth,n=this._texture.pixelsHeight,s=this._texture.getContentSizeInPixels().height,i=this._gridSize,o=(i.width+1)*(i.height+1);this._vertices=new Float32Array(3*o),this._texCoordinates=new Float32Array(2*o),this._indices=new Uint16Array(i.width*i.height*6),this._verticesBuffer&&e.deleteBuffer(this._verticesBuffer),this._verticesBuffer=e.createBuffer(),
this._texCoordinateBuffer&&e.deleteBuffer(this._texCoordinateBuffer),this._texCoordinateBuffer=e.createBuffer(),this._indicesBuffer&&e.deleteBuffer(this._indicesBuffer),this._indicesBuffer=e.createBuffer();var r,a,c,l=this._indices,p=this._texCoordinates,d=this._isTextureFlipped,u=this._vertices;for(r=0;r<i.width;++r)for(a=0;a<i.height;++a){var h=a*i.width+r,g=r*this._step.x+this._gridRect.x,v=g+this._step.x,m=a*this._step.y+this._gridRect.y,f=m+this._step.y,_=r*(i.height+1)+a,y=(r+1)*(i.height+1)+a,w=(r+1)*(i.height+1)+(a+1),b=r*(i.height+1)+(a+1);l[6*h]=_,l[6*h+1]=y,l[6*h+2]=b;var T=[3*_,3*(l[6*h+3]=y),3*(l[6*h+4]=w),3*(l[6*h+5]=b)],S=[{x:g,y:m,z:0},{x:v,y:m,z:0},{x:v,y:f,z:0},{x:g,y:f,z:0}],E=[2*_,2*y,2*w,2*b],C=[cc.p(g,m),cc.p(v,m),cc.p(v,f),cc.p(g,f)];for(c=0;c<4;++c)u[T[c]]=S[c].x,u[T[c]+1]=S[c].y,u[T[c]+2]=S[c].z,p[E[c]]=C[c].x/t,p[E[c]+1]=d?(s-C[c].y)/n:C[c].y/n}this._originalVertices=new Float32Array(this._vertices),e.bindBuffer(e.ARRAY_BUFFER,this._verticesBuffer),
e.bufferData(e.ARRAY_BUFFER,this._vertices,e.DYNAMIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,this._texCoordinateBuffer),e.bufferData(e.ARRAY_BUFFER,this._texCoordinates,e.DYNAMIC_DRAW),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this._indicesBuffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,this._indices,e.STATIC_DRAW),this._dirty=!0},setNeedDepthTestForBlit:function(e){this._needDepthTestForBlit=e},getNeedDepthTestForBlit:function(){return this._needDepthTestForBlit}}),cc.Grid3D.create=function(e,t,n){return new cc.Grid3D(e,t,n)},cc.TiledGrid3D=cc.GridBase.extend({_texCoordinates:null,_vertices:null,_originalVertices:null,_indices:null,_texCoordinateBuffer:null,_verticesBuffer:null,_indicesBuffer:null,ctor:function(e,t,n,s){cc.GridBase.prototype.ctor.call(this),this._texCoordinates=null,this._vertices=null,this._originalVertices=null,this._indices=null,this._texCoordinateBuffer=null,this._verticesBuffer=null,this._indicesBuffer=null,this._matrix=new cc.math.Matrix4,this._matrix.identity(),
void 0!==e&&this.initWithSize(e,t,n,s)},tile:function(e){return this.getTile(e)},getTile:function(e){e.x===(0|e.x)&&e.y===(0|e.y)||cc.log("cc.TiledGrid3D.tile() : Numbers must be integers");var t=4*(this._gridSize.height*e.x+e.y)*3,n=this._vertices;return new cc.Quad3(new cc.Vertex3F(n[t],n[t+1],n[t+2]),new cc.Vertex3F(n[t+3],n[t+4],n[t+5]),new cc.Vertex3F(n[t+6],n[t+7],n[t+8]),new cc.Vertex3F(n[t+9],n[t+10],n[t+11]))},getOriginalTile:function(e){e.x===(0|e.x)&&e.y===(0|e.y)||cc.log("cc.TiledGrid3D.originalTile() : Numbers must be integers");var t=4*(this._gridSize.height*e.x+e.y)*3,n=this._originalVertices;return new cc.Quad3(new cc.Vertex3F(n[t],n[t+1],n[t+2]),new cc.Vertex3F(n[t+3],n[t+4],n[t+5]),new cc.Vertex3F(n[t+6],n[t+7],n[t+8]),new cc.Vertex3F(n[t+9],n[t+10],n[t+11]))},originalTile:function(e){return this.getOriginalTile(e)},setTile:function(e,t){e.x===(0|e.x)&&e.y===(0|e.y)||cc.log("cc.TiledGrid3D.setTile() : Numbers must be integers");var n=12*(this._gridSize.height*e.x+e.y)
,s=this._vertices;s[n]=t.bl.x,s[n+1]=t.bl.y,s[n+2]=t.bl.z,s[n+3]=t.br.x,s[n+4]=t.br.y,s[n+5]=t.br.z,s[n+6]=t.tl.x,s[n+7]=t.tl.y,s[n+8]=t.tl.z,s[n+9]=t.tr.x,s[n+10]=t.tr.y,s[n+11]=t.tr.z,this._dirty=!0},blit:function(e){var t=this._gridSize.width*this._gridSize.height,n=e._renderCmd._worldTransform;this._matrix.mat[0]=n.a,this._matrix.mat[4]=n.c,this._matrix.mat[12]=n.tx,this._matrix.mat[1]=n.b,this._matrix.mat[5]=n.d,this._matrix.mat[13]=n.ty,this._shaderProgram.use(),this._shaderProgram._setUniformForMVPMatrixWithMat4(this._matrix);var s=cc._renderContext,i=this._dirty;s.enableVertexAttribArray(cc.VERTEX_ATTRIB_POSITION),s.enableVertexAttribArray(cc.VERTEX_ATTRIB_TEX_COORDS),s.bindBuffer(s.ARRAY_BUFFER,this._verticesBuffer),i&&s.bufferData(s.ARRAY_BUFFER,this._vertices,s.DYNAMIC_DRAW),s.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION,3,s.FLOAT,!1,0,this._vertices),s.bindBuffer(s.ARRAY_BUFFER,this._texCoordinateBuffer),i&&s.bufferData(s.ARRAY_BUFFER,this._texCoordinates,s.DYNAMIC_DRAW),
s.vertexAttribPointer(cc.VERTEX_ATTRIB_TEX_COORDS,2,s.FLOAT,!1,0,this._texCoordinates),s.bindBuffer(s.ELEMENT_ARRAY_BUFFER,this._indicesBuffer),i&&s.bufferData(s.ELEMENT_ARRAY_BUFFER,this._indices,s.STATIC_DRAW),s.drawElements(s.TRIANGLES,6*t,s.UNSIGNED_SHORT,0),i&&(this._dirty=!1),cc.incrementGLDraws(1)},reuse:function(){if(0<this._reuseGrid){for(var e=this._vertices,t=this._originalVertices,n=0;n<e.length;n++)t[n]=e[n];--this._reuseGrid}},calculateVertexPoints:function(){var e=this._texture.pixelsWidth,t=this._texture.pixelsHeight,n=this._texture.getContentSizeInPixels().height,s=this._gridSize,i=s.width*s.height;this._vertices=new Float32Array(12*i),this._texCoordinates=new Float32Array(8*i),this._indices=new Uint16Array(6*i);var o=cc._renderContext;this._verticesBuffer&&o.deleteBuffer(this._verticesBuffer),this._verticesBuffer=o.createBuffer(),this._texCoordinateBuffer&&o.deleteBuffer(this._texCoordinateBuffer),this._texCoordinateBuffer=o.createBuffer(),
this._indicesBuffer&&o.deleteBuffer(this._indicesBuffer),this._indicesBuffer=o.createBuffer();var r,a,c=0,l=this._step,p=this._vertices,d=this._texCoordinates,u=this._isTextureFlipped;for(r=0;r<s.width;r++)for(a=0;a<s.height;a++){var h=r*l.x,g=h+l.x,v=a*l.y,m=v+l.y;p[12*c]=h,p[12*c+1]=v,p[12*c+2]=0,p[12*c+3]=g,p[12*c+4]=v,p[12*c+5]=0,p[12*c+6]=h,p[12*c+7]=m,p[12*c+8]=0,p[12*c+9]=g,p[12*c+10]=m,p[12*c+11]=0;var f=v,_=m;u&&(f=n-v,_=n-m),d[8*c]=h/e,d[8*c+1]=f/t,d[8*c+2]=g/e,d[8*c+3]=f/t,d[8*c+4]=h/e,d[8*c+5]=_/t,d[8*c+6]=g/e,d[8*c+7]=_/t,c++}var y=this._indices;for(r=0;r<i;r++)y[6*r+0]=4*r+0,y[6*r+1]=4*r+1,y[6*r+2]=4*r+2,y[6*r+3]=4*r+1,y[6*r+4]=4*r+2,y[6*r+5]=4*r+3;this._originalVertices=new Float32Array(this._vertices),o.bindBuffer(o.ARRAY_BUFFER,this._verticesBuffer),o.bufferData(o.ARRAY_BUFFER,this._vertices,o.DYNAMIC_DRAW),o.bindBuffer(o.ARRAY_BUFFER,this._texCoordinateBuffer),o.bufferData(o.ARRAY_BUFFER,this._texCoordinates,o.DYNAMIC_DRAW),o.bindBuffer(o.ELEMENT_ARRAY_BUFFER,
this._indicesBuffer),o.bufferData(o.ELEMENT_ARRAY_BUFFER,this._indices,o.DYNAMIC_DRAW),this._dirty=!0}}),cc.TiledGrid3D.create=function(e,t,n){return new cc.TiledGrid3D(e,t,n)},cc.Grabber=cc.Class.extend({_FBO:null,_oldFBO:null,_oldClearColor:null,_gl:null,ctor:function(){cc.sys._checkWebGLRenderMode(),this._gl=cc._renderContext,this._oldClearColor=[0,0,0,0],this._oldFBO=null,this._FBO=this._gl.createFramebuffer()},grab:function(e){var t=this._gl;this._oldFBO=t.getParameter(t.FRAMEBUFFER_BINDING),t.bindFramebuffer(t.FRAMEBUFFER,this._FBO),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e._webTextureObj,0),t.checkFramebufferStatus(t.FRAMEBUFFER)!==t.FRAMEBUFFER_COMPLETE&&cc.log("Frame Grabber: could not attach texture to frmaebuffer"),t.bindFramebuffer(t.FRAMEBUFFER,this._oldFBO)},beforeRender:function(e){var t=this._gl;this._oldFBO=t.getParameter(t.FRAMEBUFFER_BINDING),t.bindFramebuffer(t.FRAMEBUFFER,this._FBO),this._oldClearColor=t.getParameter(
t.COLOR_CLEAR_VALUE),t.clearColor(0,0,0,0),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT)},afterRender:function(e){var t=this._gl;t.bindFramebuffer(t.FRAMEBUFFER,this._oldFBO),t.colorMask(!0,!0,!0,!0)},destroy:function(){this._gl.deleteFramebuffer(this._FBO)}}),cc.GridAction=cc.ActionInterval.extend({_gridSize:null,_gridNodeTarget:null,ctor:function(e,t){cc.sys._checkWebGLRenderMode(),cc.ActionInterval.prototype.ctor.call(this),this._gridSize=cc.size(0,0),t&&this.initWithDuration(e,t)},_cacheTargetAsGridNode:function(e){this._gridNodeTarget=e},clone:function(){var e=new cc.GridAction,t=this._gridSize;return e.initWithDuration(this._duration,cc.size(t.width,t.height)),e},startWithTarget:function(e){cc.ActionInterval.prototype.startWithTarget.call(this,e),cc.renderer.childrenOrderDirty=!0,this._cacheTargetAsGridNode(e);var t=this.getGrid(),n=this._gridNodeTarget.getGrid();if(n&&0<n.getReuseGrid()){var s=n.getGridSize();n.isActive(
)&&s.width===this._gridSize.width&&s.height===this._gridSize.height&&n.reuse()}else n&&n.isActive()&&n.setActive(!1),this._gridNodeTarget.setGrid(t),this._gridNodeTarget.getGrid().setActive(!0)},reverse:function(){return new cc.ReverseTime(this)},initWithDuration:function(e,t){return!!cc.ActionInterval.prototype.initWithDuration.call(this,e)&&(this._gridSize.width=t.width,this._gridSize.height=t.height,!0)},getGrid:function(){cc.log("cc.GridAction.getGrid(): it should be overridden in subclass.")}}),cc.gridAction=function(e,t){return new cc.GridAction(e,t)},cc.GridAction.create=cc.gridAction,cc.Grid3DAction=cc.GridAction.extend({getGrid:function(){return new cc.Grid3D(this._gridSize,void 0,void 0,this._gridNodeTarget.getGridRect())},getGridRect:function(){return this._gridNodeTarget.getGridRect()},vertex:function(e){return this.getVertex(e)},getVertex:function(e){return this.target.grid.getVertex(e)},originalVertex:function(e){return this.getOriginalVertex(e)},
getOriginalVertex:function(e){return this.target.grid.originalVertex(e)},setVertex:function(e,t){this.target.grid.setVertex(e,t)}}),cc.grid3DAction=function(e,t){return new cc.Grid3DAction(e,t)},cc.Grid3DAction.create=cc.grid3DAction,cc.TiledGrid3DAction=cc.GridAction.extend({tile:function(e){return this.getTile(e)},getTile:function(e){return this.target.grid.tile(e)},originalTile:function(e){return this.getOriginalTile(e)},getOriginalTile:function(e){return this.target.grid.originalTile(e)},setTile:function(e,t){this.target.grid.setTile(e,t)},getGrid:function(){return new cc.TiledGrid3D(this._gridSize,void 0,void 0,this._gridNodeTarget.getGridRect())}}),cc.tiledGrid3DAction=function(e,t){return new cc.TiledGrid3DAction(e,t)},cc.TiledGrid3DAction.create=cc.tiledGrid3DAction,cc.StopGrid=cc.ActionInstant.extend({startWithTarget:function(e){cc.ActionInstant.prototype.startWithTarget.call(this,e),cc.renderer.childrenOrderDirty=!0;var t=this.target.grid;t&&t.isActive()&&t.setActive(!1)}}),
cc.stopGrid=function(){return new cc.StopGrid},cc.StopGrid.create=cc.stopGrid,cc.ReuseGrid=cc.ActionInstant.extend({_times:null,ctor:function(e){cc.ActionInstant.prototype.ctor.call(this),void 0!==e&&this.initWithTimes(e)},initWithTimes:function(e){return this._times=e,!0},startWithTarget:function(e){cc.ActionInstant.prototype.startWithTarget.call(this,e),cc.renderer.childrenOrderDirty=!0,this.target.grid&&this.target.grid.isActive()&&this.target.grid.setReuseGrid(this.target.grid.getReuseGrid()+this._times)}}),cc.reuseGrid=function(e){return new cc.ReuseGrid(e)},cc.ReuseGrid.create=cc.reuseGrid,cc.Waves3D=cc.Grid3DAction.extend({_waves:0,_amplitude:0,_amplitudeRate:0,ctor:function(e,t,n,s){cc.GridAction.prototype.ctor.call(this),void 0!==s&&this.initWithDuration(e,t,n,s)},getAmplitude:function(){return this._amplitude},setAmplitude:function(e){this._amplitude=e},getAmplitudeRate:function(){return this._amplitudeRate},setAmplitudeRate:function(e){this._amplitudeRate=e},
initWithDuration:function(e,t,n,s){return!!cc.Grid3DAction.prototype.initWithDuration.call(this,e,t)&&(this._waves=n,this._amplitude=s,this._amplitudeRate=1,!0)},update:function(e){for(var t=this._gridSize,n=this._amplitude,s=cc.p(0,0),i=this._amplitudeRate,o=this._waves,r=0;r<t.width+1;++r)for(var a=0;a<t.height+1;++a){s.x=r,s.y=a;var c=this.originalVertex(s);c.z+=Math.sin(Math.PI*e*o*2+.01*(c.y+c.x))*n*i,this.setVertex(s,c)}}}),cc.waves3D=function(e,t,n,s){return new cc.Waves3D(e,t,n,s)},cc.Waves3D.create=cc.waves3D,cc.FlipX3D=cc.Grid3DAction.extend({ctor:function(e){void 0!==e?cc.GridAction.prototype.ctor.call(this,e,cc.size(1,1)):cc.GridAction.prototype.ctor.call(this)},initWithDuration:function(e){return cc.Grid3DAction.prototype.initWithDuration.call(this,e,cc.size(1,1))},initWithSize:function(e,t){return 1!==e.width||1!==e.height?(cc.log("Grid size must be (1,1)"),!1):cc.Grid3DAction.prototype.initWithDuration.call(this,t,e)},update:function(e){var t=Math.PI*e,n=Math.sin(t);t/=2
;var s=Math.cos(t),i=new cc.Vertex3F,o=cc.p(0,0);o.x=o.y=1;var r=this.originalVertex(o);o.x=o.y=0;var a,c,l,p,d,u=this.originalVertex(o),h=r.x,g=u.x;g<h?(c=cc.p(0,0),l=cc.p(0,1),p=cc.p(1,0),d=cc.p(1,1),a=h):(p=cc.p(0,0),d=cc.p(0,1),c=cc.p(1,0),l=cc.p(1,1),a=g),i.x=a-a*s,i.z=Math.abs(parseFloat(a*n/4));var v=this.originalVertex(c);v.x=i.x,v.z+=i.z,this.setVertex(c,v),(v=this.originalVertex(l)).x=i.x,v.z+=i.z,this.setVertex(l,v),(v=this.originalVertex(p)).x-=i.x,v.z-=i.z,this.setVertex(p,v),(v=this.originalVertex(d)).x-=i.x,v.z-=i.z,this.setVertex(d,v)}}),cc.flipX3D=function(e){return new cc.FlipX3D(e)},cc.FlipX3D.create=cc.flipX3D,cc.FlipY3D=cc.FlipX3D.extend({ctor:function(e){void 0!==e?cc.GridAction.prototype.ctor.call(this,e,cc.size(1,1)):cc.GridAction.prototype.ctor.call(this)},update:function(e){var t=Math.PI*e,n=Math.sin(t);t/=2;var s=Math.cos(t),i=new cc.Vertex3F,o=cc.p(0,0);o.x=o.y=1;var r=this.originalVertex(o);o.x=o.y=0;var a,c,l,p,d,u=this.originalVertex(o),h=r.y,g=u.y;g<h?(
c=cc.p(0,0),l=cc.p(0,1),p=cc.p(1,0),d=cc.p(1,1),a=h):(l=cc.p(0,0),c=cc.p(0,1),d=cc.p(1,0),p=cc.p(1,1),a=g),i.y=a-a*s,i.z=Math.abs(parseFloat(a*n)/4);var v=this.originalVertex(c);v.y=i.y,v.z+=i.z,this.setVertex(c,v),(v=this.originalVertex(l)).y-=i.y,v.z-=i.z,this.setVertex(l,v),(v=this.originalVertex(p)).y=i.y,v.z+=i.z,this.setVertex(p,v),(v=this.originalVertex(d)).y-=i.y,v.z-=i.z,this.setVertex(d,v)}}),cc.flipY3D=function(e){return new cc.FlipY3D(e)},cc.FlipY3D.create=cc.flipY3D,cc.Lens3D=cc.Grid3DAction.extend({_position:null,_radius:0,_lensEffect:0,_concave:!1,_dirty:!1,ctor:function(e,t,n,s){cc.GridAction.prototype.ctor.call(this),this._position=cc.p(0,0),void 0!==s&&this.initWithDuration(e,t,n,s)},getLensEffect:function(){return this._lensEffect},setLensEffect:function(e){this._lensEffect=e},setConcave:function(e){this._concave=e},getPosition:function(){return this._position},setPosition:function(e){cc.pointEqualToPoint(e,this._position)||(this._position.x=e.x,this._position.y=e.y,
this._dirty=!0)},initWithDuration:function(e,t,n,s){return!!cc.Grid3DAction.prototype.initWithDuration.call(this,e,t)&&(this.setPosition(n),this._radius=s,this._lensEffect=.7,this._dirty=!0)},update:function(e){if(this._dirty){for(var t,n,s,i,o,r=this._gridSize.width,a=this._gridSize.height,c=this._radius,l=this._lensEffect,p=cc.p(0,0),d=cc.p(0,0),u=0;u<r+1;++u)for(var h=0;h<a+1;++h)p.x=u,p.y=h,t=this.originalVertex(p),d.x=this._position.x-t.x,d.y=this._position.y-t.y,(n=cc.pLength(d))<c&&(0===(o=(n=c-n)/c)&&(o=.001),s=Math.log(o)*l,i=Math.exp(s)*c,0<(n=cc.pLength(d))&&(d.x=d.x/n,d.y=d.y/n,d.x=d.x*i,d.y=d.y*i,t.z+=cc.pLength(d)*l)),this.setVertex(p,t);this._dirty=!1}}}),cc.lens3D=function(e,t,n,s){return new cc.Lens3D(e,t,n,s)},cc.Lens3D.create=cc.lens3D,cc.Ripple3D=cc.Grid3DAction.extend({_position:null,_radius:0,_waves:0,_amplitude:0,_amplitudeRate:0,ctor:function(e,t,n,s,i,o){cc.GridAction.prototype.ctor.call(this),this._position=cc.p(0,0),void 0!==o&&this.initWithDuration(e,t,n,s,i
,o)},getPosition:function(){return this._position},setPosition:function(e){this._position.x=e.x,this._position.y=e.y},getAmplitude:function(){return this._amplitude},setAmplitude:function(e){this._amplitude=e},getAmplitudeRate:function(){return this._amplitudeRate},setAmplitudeRate:function(e){this._amplitudeRate=e},initWithDuration:function(e,t,n,s,i,o){return!!cc.Grid3DAction.prototype.initWithDuration.call(this,e,t)&&(this.setPosition(n),this._radius=s,this._waves=i,this._amplitude=o,this._amplitudeRate=1,!0)},update:function(e){for(var t,n,s=this._gridSize.width,i=this._gridSize.height,o=cc.p(0,0),r=this._radius,a=this._waves,c=this._amplitude,l=this._amplitudeRate,p=cc.p(0,0),d=0;d<s+1;++d)for(var u=0;u<i+1;++u){if(o.x=d,o.y=u,t=this.originalVertex(o),p.x=this._position.x-t.x,p.y=this._position.y-t.y,(n=cc.pLength(p))<r){n=r-n;var h=Math.pow(n/r,2);t.z+=Math.sin(e*Math.PI*a*2+.1*n)*c*l*h}this.setVertex(o,t)}}}),cc.ripple3D=function(e,t,n,s,i,o){return new cc.Ripple3D(e,t,n,s,i,o)}
,cc.Ripple3D.create=cc.ripple3D,cc.Shaky3D=cc.Grid3DAction.extend({_randRange:0,_shakeZ:!1,ctor:function(e,t,n,s){cc.GridAction.prototype.ctor.call(this),void 0!==s&&this.initWithDuration(e,t,n,s)},initWithDuration:function(e,t,n,s){return!!cc.Grid3DAction.prototype.initWithDuration.call(this,e,t)&&(this._randRange=n,this._shakeZ=s,!0)},update:function(e){for(var t,n=this._gridSize.width,s=this._gridSize.height,i=this._randRange,o=this._shakeZ,r=cc.p(0,0),a=0;a<n+1;++a)for(var c=0;c<s+1;++c)r.x=a,r.y=c,(t=this.originalVertex(r)).x+=cc.rand()%(2*i)-i,t.y+=cc.rand()%(2*i)-i,o&&(t.z+=cc.rand()%(2*i)-i),this.setVertex(r,t)}}),cc.shaky3D=function(e,t,n,s){return new cc.Shaky3D(e,t,n,s)},cc.Shaky3D.create=cc.shaky3D,cc.Liquid=cc.Grid3DAction.extend({_waves:0,_amplitude:0,_amplitudeRate:0,ctor:function(e,t,n,s){cc.GridAction.prototype.ctor.call(this),void 0!==s&&this.initWithDuration(e,t,n,s)},getAmplitude:function(){return this._amplitude},setAmplitude:function(e){this._amplitude=e},
getAmplitudeRate:function(){return this._amplitudeRate},setAmplitudeRate:function(e){this._amplitudeRate=e},initWithDuration:function(e,t,n,s){return!!cc.Grid3DAction.prototype.initWithDuration.call(this,e,t)&&(this._waves=n,this._amplitude=s,this._amplitudeRate=1,!0)},update:function(e){for(var t,n=this._gridSize.width,s=this._gridSize.height,i=cc.p(0,0),o=this._waves,r=this._amplitude,a=this._amplitudeRate,c=1;c<n;++c)for(var l=1;l<s;++l)i.x=c,i.y=l,(t=this.originalVertex(i)).x=t.x+Math.sin(e*Math.PI*o*2+.01*t.x)*r*a,t.y=t.y+Math.sin(e*Math.PI*o*2+.01*t.y)*r*a,this.setVertex(i,t)}}),cc.liquid=function(e,t,n,s){return new cc.Liquid(e,t,n,s)},cc.Liquid.create=cc.liquid,cc.Waves=cc.Grid3DAction.extend({_waves:0,_amplitude:0,_amplitudeRate:0,_vertical:!1,_horizontal:!1,ctor:function(e,t,n,s,i,o){cc.GridAction.prototype.ctor.call(this),void 0!==o&&this.initWithDuration(e,t,n,s,i,o)},getAmplitude:function(){return this._amplitude},setAmplitude:function(e){this._amplitude=e},
getAmplitudeRate:function(){return this._amplitudeRate},setAmplitudeRate:function(e){this._amplitudeRate=e},initWithDuration:function(e,t,n,s,i,o){return!!cc.Grid3DAction.prototype.initWithDuration.call(this,e,t)&&(this._waves=n,this._amplitude=s,this._amplitudeRate=1,this._horizontal=i,this._vertical=o,!0)},update:function(e){for(var t,n=this._gridSize.width,s=this._gridSize.height,i=cc.p(0,0),o=this._vertical,r=this._horizontal,a=this._waves,c=this._amplitude,l=this._amplitudeRate,p=0;p<n+1;++p)for(var d=0;d<s+1;++d)i.x=p,i.y=d,t=this.originalVertex(i),o&&(t.x=t.x+Math.sin(e*Math.PI*a*2+.01*t.y)*c*l),r&&(t.y=t.y+Math.sin(e*Math.PI*a*2+.01*t.x)*c*l),this.setVertex(i,t)}}),cc.waves=function(e,t,n,s,i,o){return new cc.Waves(e,t,n,s,i,o)},cc.Waves.create=cc.waves,cc.Twirl=cc.Grid3DAction.extend({_position:null,_twirls:0,_amplitude:0,_amplitudeRate:0,ctor:function(e,t,n,s,i){cc.GridAction.prototype.ctor.call(this),this._position=cc.p(0,0),void 0!==i&&this.initWithDuration(e,t,n,s,i)},
getPosition:function(){return this._position},setPosition:function(e){this._position.x=e.x,this._position.y=e.y},getAmplitude:function(){return this._amplitude},setAmplitude:function(e){this._amplitude=e},getAmplitudeRate:function(){return this._amplitudeRate},setAmplitudeRate:function(e){this._amplitudeRate=e},initWithDuration:function(e,t,n,s,i){return!!cc.Grid3DAction.prototype.initWithDuration.call(this,e,t)&&(this.setPosition(n),this._twirls=s,this._amplitude=i,this._amplitudeRate=1,!0)},update:function(e){for(var t,n,s,i,o=this._position,r=this._gridSize.width,a=this._gridSize.height,c=cc.p(0,0),l=.1*this._amplitude*this._amplitudeRate,p=this._twirls,d=cc.p(0,0),u=0;u<r+1;++u)for(var h=0;h<a+1;++h)c.x=u,c.y=h,t=this.originalVertex(c),d.x=u-r/2,d.y=h-a/2,n=cc.pLength(d)*Math.cos(Math.PI/2+e*Math.PI*p*2)*l,s=Math.sin(n)*(t.y-o.y)+Math.cos(n)*(t.x-o.x),i=Math.cos(n)*(t.y-o.y)-Math.sin(n)*(t.x-o.x),t.x=o.x+s,t.y=o.y+i,this.setVertex(c,t)}}),cc.twirl=function(e,t,n,s,i){
return new cc.Twirl(e,t,n,s,i)},cc.Twirl.create=cc.twirl,cc.ShakyTiles3D=cc.TiledGrid3DAction.extend({_randRange:0,_shakeZ:!1,ctor:function(e,t,n,s){cc.GridAction.prototype.ctor.call(this),void 0!==s&&this.initWithDuration(e,t,n,s)},initWithDuration:function(e,t,n,s){return!!cc.TiledGrid3DAction.prototype.initWithDuration.call(this,e,t)&&(this._randRange=n,this._shakeZ=s,!0)},update:function(e){for(var t=this._gridSize,n=this._randRange,s=cc.p(0,0),i=0;i<t.width;++i)for(var o=0;o<t.height;++o){s.x=i,s.y=o;var r=this.originalTile(s);r.bl.x+=cc.rand()%(2*n)-n,r.br.x+=cc.rand()%(2*n)-n,r.tl.x+=cc.rand()%(2*n)-n,r.tr.x+=cc.rand()%(2*n)-n,r.bl.y+=cc.rand()%(2*n)-n,r.br.y+=cc.rand()%(2*n)-n,r.tl.y+=cc.rand()%(2*n)-n,r.tr.y+=cc.rand()%(2*n)-n,this._shakeZ&&(r.bl.z+=cc.rand()%(2*n)-n,r.br.z+=cc.rand()%(2*n)-n,r.tl.z+=cc.rand()%(2*n)-n,r.tr.z+=cc.rand()%(2*n)-n),this.setTile(s,r)}}}),cc.shakyTiles3D=function(e,t,n,s){return new cc.ShakyTiles3D(e,t,n,s)},cc.ShakyTiles3D.create=cc.shakyTiles3D,
cc.ShatteredTiles3D=cc.TiledGrid3DAction.extend({_randRange:0,_once:!1,_shatterZ:!1,ctor:function(e,t,n,s){cc.GridAction.prototype.ctor.call(this),void 0!==s&&this.initWithDuration(e,t,n,s)},initWithDuration:function(e,t,n,s){return!!cc.TiledGrid3DAction.prototype.initWithDuration.call(this,e,t)&&(this._once=!1,this._randRange=n,this._shatterZ=s,!0)},update:function(e){if(!1===this._once){for(var t,n=this._gridSize,s=this._randRange,i=cc.p(0,0),o=0;o<n.width;++o)for(var r=0;r<n.height;++r)i.x=o,i.y=r,(t=this.originalTile(i)).bl.x+=cc.rand()%(2*s)-s,t.br.x+=cc.rand()%(2*s)-s,t.tl.x+=cc.rand()%(2*s)-s,t.tr.x+=cc.rand()%(2*s)-s,t.bl.y+=cc.rand()%(2*s)-s,t.br.y+=cc.rand()%(2*s)-s,t.tl.y+=cc.rand()%(2*s)-s,t.tr.y+=cc.rand()%(2*s)-s,this._shatterZ&&(t.bl.z+=cc.rand()%(2*s)-s,t.br.z+=cc.rand()%(2*s)-s,t.tl.z+=cc.rand()%(2*s)-s,t.tr.z+=cc.rand()%(2*s)-s),this.setTile(i,t);this._once=!0}}}),cc.shatteredTiles3D=function(e,t,n,s){return new cc.ShatteredTiles3D(e,t,n,s)},
cc.ShatteredTiles3D.create=cc.shatteredTiles3D,cc.Tile=function(e,t,n){this.position=e||cc.p(0,0),this.startPosition=t||cc.p(0,0),this.delta=n||cc.p(0,0)},cc.ShuffleTiles=cc.TiledGrid3DAction.extend({_seed:0,_tilesCount:0,_tilesOrder:null,_tiles:null,ctor:function(e,t,n){cc.GridAction.prototype.ctor.call(this),this._tilesOrder=[],this._tiles=[],void 0!==n&&this.initWithDuration(e,t,n)},initWithDuration:function(e,t,n){return!!cc.TiledGrid3DAction.prototype.initWithDuration.call(this,e,t)&&(this._seed=n,this._tilesOrder.length=0,!(this._tiles.length=0))},shuffle:function(e,t){for(var n=t-1;0<=n;n--){var s=0|cc.rand()%(n+1),i=e[n];e[n]=e[s],e[s]=i}},getDelta:function(e){var t=this._gridSize,n=e.width*t.height+e.height;return cc.size(this._tilesOrder[n]/t.height-e.width,this._tilesOrder[n]%t.height-e.height)},placeTile:function(e,t){var n=this.originalTile(e),s=this.target.grid.getStep(),i=t.position;n.bl.x+=i.x*s.x,n.bl.y+=i.y*s.y,n.br.x+=i.x*s.x,n.br.y+=i.y*s.y,n.tl.x+=i.x*s.x,
n.tl.y+=i.y*s.y,n.tr.x+=i.x*s.x,n.tr.y+=i.y*s.y,this.setTile(e,n)},startWithTarget:function(e){cc.TiledGrid3DAction.prototype.startWithTarget.call(this,e);var t=this._gridSize;this._tilesCount=t.width*t.height;for(var n=this._tilesOrder,s=n.length=0;s<this._tilesCount;++s)n[s]=s;this.shuffle(n,this._tilesCount);for(var i=this._tiles,o=i.length=0,r=cc.size(0,0),a=0;a<t.width;++a)for(var c=0;c<t.height;++c)i[o]=new cc.Tile,i[o].position=cc.p(a,c),i[o].startPosition=cc.p(a,c),r.width=a,r.height=c,i[o].delta=this.getDelta(r),++o},update:function(e){for(var t,n=0,s=this._gridSize,i=this._tiles,o=cc.p(0,0),r=0;r<s.width;++r)for(var a=0;a<s.height;++a)o.x=r,o.y=a,(t=i[n]).position.x=t.delta.width*e,t.position.y=t.delta.height*e,this.placeTile(o,t),++n}}),cc.shuffleTiles=function(e,t,n){return new cc.ShuffleTiles(e,t,n)},cc.ShuffleTiles.create=cc.shuffleTiles,cc.FadeOutTRTiles=cc.TiledGrid3DAction.extend({testFunc:function(e,t){var n=this._gridSize.width*t,s=this._gridSize.height*t
;return n===this._gridSize.width&&s===this._gridSize.height?0:n+s===0?1:Math.pow((e.x+e.y)/(n+s),6)},turnOnTile:function(e){this.setTile(e,this.originalTile(e))},turnOffTile:function(e){this.setTile(e,new cc.Quad3)},transformTile:function(e,t){var n=this.originalTile(e),s=this.target.grid.getStep();n.bl.x+=s.x/2*(1-t),n.bl.y+=s.y/2*(1-t),n.br.x-=s.x/2*(1-t),n.br.y+=s.y/2*(1-t),n.tl.x+=s.x/2*(1-t),n.tl.y-=s.y/2*(1-t),n.tr.x-=s.x/2*(1-t),n.tr.y-=s.y/2*(1-t),this.setTile(e,n)},update:function(e){for(var t,n=this._gridSize,s=cc.p(0,0),i=0;i<n.width;++i)for(var o=0;o<n.height;++o)s.x=i,s.y=o,0===(t=this.testFunc(s,e))?this.turnOffTile(s):t<1?this.transformTile(s,t):this.turnOnTile(s)}}),cc.fadeOutTRTiles=function(e,t){return new cc.FadeOutTRTiles(e,t)},cc.FadeOutTRTiles.create=cc.fadeOutTRTiles,cc.FadeOutBLTiles=cc.FadeOutTRTiles.extend({testFunc:function(e,t){var n=this._gridSize.width*(1-t),s=this._gridSize.height*(1-t);return n+s===0?0:e.x+e.y===0?1:Math.pow((n+s)/(e.x+e.y),6)}}),
cc.fadeOutBLTiles=function(e,t){return new cc.FadeOutBLTiles(e,t)},cc.FadeOutBLTiles.create=cc.fadeOutBLTiles,cc.FadeOutUpTiles=cc.FadeOutTRTiles.extend({testFunc:function(e,t){var n=this._gridSize.height*t;return n===this._gridSize.height?0:0===n?1:Math.pow(e.y/n,6)},transformTile:function(e,t){var n=this.originalTile(e),s=this.target.grid.getStep();n.bl.y+=s.y/2*(1-t),n.br.y+=s.y/2*(1-t),n.tl.y-=s.y/2*(1-t),n.tr.y-=s.y/2*(1-t),this.setTile(e,n)}}),cc.fadeOutUpTiles=function(e,t){return new cc.FadeOutUpTiles(e,t)},cc.FadeOutUpTiles.create=cc.fadeOutUpTiles,cc.FadeOutDownTiles=cc.FadeOutUpTiles.extend({testFunc:function(e,t){var n=this._gridSize.height*(1-t);return 0===n?0:0===e.y?1:Math.pow(n/e.y,6)}}),cc.fadeOutDownTiles=function(e,t){return new cc.FadeOutDownTiles(e,t)},cc.FadeOutDownTiles.create=cc.fadeOutDownTiles,cc.TurnOffTiles=cc.TiledGrid3DAction.extend({_seed:null,_tilesCount:0,_tilesOrder:null,ctor:function(e,t,n){cc.GridAction.prototype.ctor.call(this),this._tilesOrder=[],
void 0!==t&&this.initWithDuration(e,t,n)},initWithDuration:function(e,t,n){return!!cc.TiledGrid3DAction.prototype.initWithDuration.call(this,e,t)&&(this._seed=n||0,!(this._tilesOrder.length=0))},shuffle:function(e,t){for(var n=t-1;0<=n;n--){var s=0|cc.rand()%(n+1),i=e[n];e[n]=e[s],e[s]=i}},turnOnTile:function(e){this.setTile(e,this.originalTile(e))},turnOffTile:function(e){this.setTile(e,new cc.Quad3)},startWithTarget:function(e){cc.TiledGrid3DAction.prototype.startWithTarget.call(this,e),this._tilesCount=this._gridSize.width*this._gridSize.height;for(var t=this._tilesOrder,n=t.length=0;n<this._tilesCount;++n)t[n]=n;this.shuffle(t,this._tilesCount)},update:function(e){for(var t,n=0|e*this._tilesCount,s=this._gridSize,i=cc.p(0,0),o=this._tilesOrder,r=0;r<this._tilesCount;r++)t=o[r],i.x=0|t/s.height,i.y=t%(0|s.height),r<n?this.turnOffTile(i):this.turnOnTile(i)}}),cc.turnOffTiles=function(e,t,n){return new cc.TurnOffTiles(e,t,n)},cc.TurnOffTiles.create=cc.turnOffTiles,
cc.WavesTiles3D=cc.TiledGrid3DAction.extend({_waves:0,_amplitude:0,_amplitudeRate:0,ctor:function(e,t,n,s){cc.GridAction.prototype.ctor.call(this),void 0!==s&&this.initWithDuration(e,t,n,s)},getAmplitude:function(){return this._amplitude},setAmplitude:function(e){this._amplitude=e},getAmplitudeRate:function(){return this._amplitudeRate},setAmplitudeRate:function(e){this._amplitudeRate=e},initWithDuration:function(e,t,n,s){return!!cc.TiledGrid3DAction.prototype.initWithDuration.call(this,e,t)&&(this._waves=n,this._amplitude=s,this._amplitudeRate=1,!0)},update:function(e){for(var t,n=this._gridSize,s=this._waves,i=this._amplitude,o=this._amplitudeRate,r=cc.p(0,0),a=0;a<n.width;a++)for(var c=0;c<n.height;c++)r.x=a,r.y=c,(t=this.originalTile(r)).bl.z=Math.sin(e*Math.PI*s*2+.01*(t.bl.y+t.bl.x))*i*o,t.br.z=t.bl.z,t.tl.z=t.bl.z,t.tr.z=t.bl.z,this.setTile(r,t)}}),cc.wavesTiles3D=function(e,t,n,s){return new cc.WavesTiles3D(e,t,n,s)},cc.WavesTiles3D.create=cc.wavesTiles3D,
cc.JumpTiles3D=cc.TiledGrid3DAction.extend({_jumps:0,_amplitude:0,_amplitudeRate:0,ctor:function(e,t,n,s){cc.GridAction.prototype.ctor.call(this),void 0!==s&&this.initWithDuration(e,t,n,s)},getAmplitude:function(){return this._amplitude},setAmplitude:function(e){this._amplitude=e},getAmplitudeRate:function(){return this._amplitudeRate},setAmplitudeRate:function(e){this._amplitudeRate=e},initWithDuration:function(e,t,n,s){return!!cc.TiledGrid3DAction.prototype.initWithDuration.call(this,e,t)&&(this._jumps=n,this._amplitude=s,this._amplitudeRate=1,!0)},update:function(e){for(var t,n=Math.sin(Math.PI*e*this._jumps*2)*this._amplitude*this._amplitudeRate,s=Math.sin(Math.PI*(e*this._jumps*2+1))*this._amplitude*this._amplitudeRate,i=this._gridSize,o=this.target.grid,r=cc.p(0,0),a=0;a<i.width;a++)for(var c=0;c<i.height;c++)r.x=a,r.y=c,t=o.originalTile(r),(a+c)%2==0?(t.bl.z+=n,t.br.z+=n,t.tl.z+=n,t.tr.z+=n):(t.bl.z+=s,t.br.z+=s,t.tl.z+=s,t.tr.z+=s),o.setTile(r,t)}}),cc.jumpTiles3D=function(e,t,
n,s){return new cc.JumpTiles3D(e,t,n,s)},cc.JumpTiles3D.create=cc.jumpTiles3D,cc.SplitRows=cc.TiledGrid3DAction.extend({_rows:0,_winSize:null,ctor:function(e,t){cc.GridAction.prototype.ctor.call(this),void 0!==t&&this.initWithDuration(e,t)},initWithDuration:function(e,t){return this._rows=t,cc.TiledGrid3DAction.prototype.initWithDuration.call(this,e,cc.size(1,t))},update:function(e){for(var t,n,s=this._gridSize,i=this._winSize.width,o=cc.p(0,0),r=0;r<s.height;++r)n=1,(o.y=r)%2==0&&(n=-1),(t=this.originalTile(o)).bl.x+=n*i*e,t.br.x+=n*i*e,t.tl.x+=n*i*e,t.tr.x+=n*i*e,this.setTile(o,t)},startWithTarget:function(e){cc.TiledGrid3DAction.prototype.startWithTarget.call(this,e),this._winSize=cc.director.getWinSizeInPixels()}}),cc.splitRows=function(e,t){return new cc.SplitRows(e,t)},cc.SplitRows.create=cc.splitRows,cc.SplitCols=cc.TiledGrid3DAction.extend({_cols:0,_winSize:null,ctor:function(e,t){cc.GridAction.prototype.ctor.call(this),void 0!==t&&this.initWithDuration(e,t)},
initWithDuration:function(e,t){return this._cols=t,cc.TiledGrid3DAction.prototype.initWithDuration.call(this,e,cc.size(t,1))},update:function(e){for(var t,n,s=this._gridSize.width,i=this._winSize.height,o=cc.p(0,0),r=0;r<s;++r)n=1,(o.x=r)%2==0&&(n=-1),(t=this.originalTile(o)).bl.y+=n*i*e,t.br.y+=n*i*e,t.tl.y+=n*i*e,t.tr.y+=n*i*e,this.setTile(o,t);cc.renderer.childrenOrderDirty=!0},startWithTarget:function(e){cc.TiledGrid3DAction.prototype.startWithTarget.call(this,e),this._winSize=cc.director.getWinSizeInPixels()}}),cc.splitCols=function(e,t){return new cc.SplitCols(e,t)},cc.SplitCols.create=cc.splitCols,cc.PageTurn3D=cc.Grid3DAction.extend({getGrid:function(){var e=new cc.Grid3D(this._gridSize,void 0,void 0,this._gridNodeTarget.getGridRect());return e.setNeedDepthTestForBlit(!0),e},clone:function(){var e=new cc.PageTurn3D;return e.initWithDuration(this._duration,this._gridSize),e},update:function(e){for(var t=Math.max(0,e-.25),n=-100-t*t*500,s=Math.sqrt(e),
i=.5<s?Math.PI/2*s:Math.PI/2*(1-s),o=(2-e)*Math.PI,r=Math.sin(i),a=Math.cos(i),c=this._gridSize,l=cc.p(0,0),p=0;p<=c.width;++p)for(var d=0;d<=c.height;++d){l.x=p,l.y=d;var u=this.getOriginalVertex(l);u.x-=this.getGridRect().x;var h=Math.sqrt(u.x*u.x+(u.y-n)*(u.y-n)),g=h*r,v=Math.asin(u.x/h)/r,m=Math.cos(v);v<=Math.PI?u.x=g*Math.sin(v):u.x=0,u.y=h+n-g*(1-m)*r,u.z=g*(1-m)*a,u.x=u.z*Math.sin(o)+u.x*Math.cos(o),u.z=u.z*Math.cos(o)-u.x*Math.cos(o),u.z/=7,u.z<.5&&(u.z=.5),u.x+=this.getGridRect().x,this.setVertex(l,u)}}}),cc.pageTurn3D=function(e,t){return new cc.PageTurn3D(e,t)},cc.PageTurn3D.create=cc.pageTurn3D,cc.ProgressTimer=cc.Node.extend({_type:null,_percentage:0,_sprite:null,_midPoint:null,_barChangeRate:null,_reverseDirection:!1,_className:"ProgressTimer",ctor:function(e){cc.Node.prototype.ctor.call(this),this._type=cc.ProgressTimer.TYPE_RADIAL,this._percentage=0,this._midPoint=cc.p(0,0),this._barChangeRate=cc.p(0,0),this._reverseDirection=!1,this._sprite=null,
e&&this.initWithSprite(e)},onEnter:function(){this._super(),cc._renderType===cc.game.RENDER_TYPE_WEBGL&&(this._renderCmd.initCmd(),this._renderCmd._updateProgress())},cleanup:function(){cc._renderType===cc.game.RENDER_TYPE_WEBGL&&this._renderCmd.releaseData(),this._super()},getMidpoint:function(){return cc.p(this._midPoint.x,this._midPoint.y)},setMidpoint:function(e){this._midPoint=cc.pClamp(e,cc.p(0,0),cc.p(1,1))},getBarChangeRate:function(){return cc.p(this._barChangeRate.x,this._barChangeRate.y)},setBarChangeRate:function(e){this._barChangeRate=cc.pClamp(e,cc.p(0,0),cc.p(1,1))},getType:function(){return this._type},getPercentage:function(){return this._percentage},getSprite:function(){return this._sprite},setPercentage:function(e){this._percentage!==e&&(this._percentage=cc.clampf(e,0,100),this._renderCmd._updateProgress())},setOpacityModifyRGB:function(e){},isOpacityModifyRGB:function(){return!1},isReverseDirection:function(){return this._reverseDirection},setColor:function(e){
this._sprite.color=e,this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.colorDirty)},setOpacity:function(e){this._sprite.opacity=e,this._renderCmd.setDirtyFlag(cc.Node._dirtyFlags.opacityDirty)},getColor:function(){return this._sprite.color},getOpacity:function(){return this._sprite.opacity},setReverseProgress:function(e){this._reverseDirection!==e&&(this._reverseDirection=e,this._renderCmd.resetVertexData())},setSprite:function(e){this._sprite!==e&&((this._sprite=e)?(this.setContentSize(e.width,e.height),e.ignoreAnchorPointForPosition(!0)):this.setContentSize(0,0),this._renderCmd.resetVertexData())},setType:function(e){e!==this._type&&(this._type=e,this._renderCmd.resetVertexData())},setReverseDirection:function(e){this._reverseDirection!==e&&(this._reverseDirection=e,this._renderCmd.resetVertexData())},initWithSprite:function(e){return this.percentage=0,this.setAnchorPoint(.5,.5),this._type=cc.ProgressTimer.TYPE_RADIAL,this._reverseDirection=!1,this.midPoint=cc.p(.5,.5),
this.barChangeRate=cc.p(1,1),this.setSprite(e),this._renderCmd.resetVertexData(),!0},_createRenderCmd:function(){return cc._renderType===cc.game.RENDER_TYPE_CANVAS?new cc.ProgressTimer.CanvasRenderCmd(this):new cc.ProgressTimer.WebGLRenderCmd(this)}}),(e=cc.ProgressTimer.prototype).midPoint,cc.defineGetterSetter(e,"midPoint",e.getMidpoint,e.setMidpoint),e.barChangeRate,cc.defineGetterSetter(e,"barChangeRate",e.getBarChangeRate,e.setBarChangeRate),e.type,cc.defineGetterSetter(e,"type",e.getType,e.setType),e.percentage,cc.defineGetterSetter(e,"percentage",e.getPercentage,e.setPercentage),e.sprite,cc.defineGetterSetter(e,"sprite",e.getSprite,e.setSprite),e.reverseDir,cc.defineGetterSetter(e,"reverseDir",e.isReverseDirection,e.setReverseDirection),cc.ProgressTimer.create=function(e){return new cc.ProgressTimer(e)},cc.ProgressTimer.TEXTURE_COORDS_COUNT=4,cc.ProgressTimer.TEXTURE_COORDS=75,cc.ProgressTimer.TYPE_RADIAL=0,cc.ProgressTimer.TYPE_BAR=1,function(){
cc.ProgressTimer.CanvasRenderCmd=function(e){cc.Node.CanvasRenderCmd.call(this,e),this._needDraw=!0,this._PI180=Math.PI/180,this._barRect=cc.rect(0,0,0,0),this._origin=cc.p(0,0),this._radius=0,this._startAngle=270,this._endAngle=270,this._counterClockWise=!1,this._canUseDirtyRegion=!0};var e=cc.ProgressTimer.CanvasRenderCmd.prototype=Object.create(cc.Node.CanvasRenderCmd.prototype);e.constructor=cc.ProgressTimer.CanvasRenderCmd,e.rendering=function(e,t,n){var s=e||cc._renderContext,i=s.getContext(),o=this._node,r=o._sprite,a=r._renderCmd._textureCoord,c=r._renderCmd._displayedOpacity/255;if(0!==a.width&&0!==a.height&&r._texture&&a.validRect&&0!==c){s.setTransform(this._worldTransform,t,n),s.setCompositeOperation(r._blendFuncStr),s.setGlobalAlpha(c);var l=r._rect,p=r._offsetPosition,d=p.x,u=-p.y-l.height,h=l.width,g=l.height;if(s.save(),r._flippedX&&(d=-d-h,i.scale(-1,1)),r._flippedY&&(u=p.y,i.scale(1,-1)),o._type===cc.ProgressTimer.TYPE_BAR){var v=this._barRect;i.beginPath(),i.rect(v.x
,v.y,v.width,v.height),i.clip(),i.closePath()}else if(o._type===cc.ProgressTimer.TYPE_RADIAL){var m=this._origin.x,f=this._origin.y;i.beginPath(),i.arc(m,f,this._radius,this._PI180*this._startAngle,this._PI180*this._endAngle,this._counterClockWise),i.lineTo(m,f),i.clip(),i.closePath()}var _=(r._renderCmd._textureToRender||r._texture).getHtmlElementObj();r._renderCmd._colorized?i.drawImage(_,0,0,a.width,a.height,d,u,h,g):i.drawImage(_,a.renderX,a.renderY,a.width,a.height,d,u,h,g),s.restore(),cc.g_NumberOfDraws++}},e.releaseData=function(){},e.resetVertexData=function(){},e._updateProgress=function(){this.setDirtyFlag(cc.Node._dirtyFlags.contentDirty);var e=this._node,t=e._sprite,n=t.width,s=t.height,i=e._midPoint;if(e._type===cc.ProgressTimer.TYPE_RADIAL){this._radius=Math.round(Math.sqrt(n*n+s*s));var o,r,a=!1,c=this._origin;c.x=n*i.x,c.y=-s*i.y,e._reverseDirection?o=(r=270)-3.6*e._percentage:(o=-90,r=3.6*e._percentage-90),t._flippedX&&(c.x-=n*(2*e._midPoint.x),o=-o,r=-r,o-=180,r-=180,
a=!a),t._flippedY&&(c.y+=s*(2*e._midPoint.y),a=!a,o=-o,r=-r),this._startAngle=o,this._endAngle=r,this._counterClockWise=a}else{var l=e._barChangeRate,p=e._percentage/100,d=this._barRect,u=cc.size(n*(1-l.x),s*(1-l.y)),h=cc.size((n-u.width)*p,(s-u.height)*p),g=cc.size(u.width+h.width,u.height+h.height),v=cc.p(n*i.x,s*i.y),m=v.x-g.width/2;.5<i.x&&g.width/2>=n-v.x&&(m=n-g.width);var f=v.y-g.height/2;.5<i.y&&g.height/2>=s-v.y&&(f=s-g.height),d.x=0;var _=1;t._flippedX&&(d.x-=g.width,_=-1),0<m&&(d.x+=m*_),d.y=0;var y=1;t._flippedY&&(d.y+=g.height,y=-1),0<f&&(d.y-=f*y),d.width=g.width,d.height=-g.height}},e._syncStatus=function(e){var t=this._node;if(t._sprite){var n=cc.Node._dirtyFlags,s=this._dirtyFlag,i=e?e._node:null;i&&i._cascadeColorEnabled&&e._dirtyFlag&n.colorDirty&&(s|=n.colorDirty),i&&i._cascadeOpacityEnabled&&e._dirtyFlag&n.opacityDirty&&(s|=n.opacityDirty),e&&e._dirtyFlag&n.transformDirty&&(s|=n.transformDirty),this._dirtyFlag=s;var o=t._sprite._renderCmd,r=o._dirtyFlag,
a=r&n.colorDirty,c=r&n.opacityDirty;a&&(o._syncDisplayColor(),o._dirtyFlag=o._dirtyFlag&n.colorDirty^o._dirtyFlag,this._dirtyFlag=this._dirtyFlag&n.colorDirty^this._dirtyFlag),c&&(o._syncDisplayOpacity(),o._dirtyFlag=o._dirtyFlag&n.opacityDirty^o._dirtyFlag,this._dirtyFlag=this._dirtyFlag&n.opacityDirty^this._dirtyFlag),(a||c)&&o._updateColor(),s&n.transformDirty&&this.transform(e),s&n.orderDirty&&(this._dirtyFlag=this._dirtyFlag&n.orderDirty^this._dirtyFlag)}},e.updateStatus=function(){var e=this._node;if(e._sprite){var t=cc.Node._dirtyFlags,n=this._dirtyFlag,s=e._sprite._renderCmd,i=s._dirtyFlag,o=i&t.colorDirty,r=i&t.opacityDirty;o&&(s._updateDisplayColor(),s._dirtyFlag=s._dirtyFlag&t.colorDirty^s._dirtyFlag,this._dirtyFlag=this._dirtyFlag&t.colorDirty^this._dirtyFlag),r&&(s._updateDisplayOpacity(),s._dirtyFlag=s._dirtyFlag&t.opacityDirty^s._dirtyFlag,this._dirtyFlag=this._dirtyFlag&t.opacityDirty^this._dirtyFlag),(o||r)&&s._updateColor(),n&t.transformDirty&&this.transform(
this.getParentRenderCmd(),!0),n&t.contentDirty&&this._notifyRegionStatus&&this._notifyRegionStatus(cc.Node.CanvasRenderCmd.RegionStatus.Dirty),this._dirtyFlag=0}}}(),cc.ProgressTo=cc.ActionInterval.extend({_to:0,_from:0,ctor:function(e,t){cc.ActionInterval.prototype.ctor.call(this),this._to=0,void(this._from=0)!==t&&this.initWithDuration(e,t)},initWithDuration:function(e,t){return!!cc.ActionInterval.prototype.initWithDuration.call(this,e)&&(this._to=t,!0)},clone:function(){var e=new cc.ProgressTo;return e.initWithDuration(this._duration,this._to),e},reverse:function(){return cc.log("cc.ProgressTo.reverse(): reverse hasn't been supported."),null},startWithTarget:function(e){cc.ActionInterval.prototype.startWithTarget.call(this,e),this._from=e.percentage},update:function(e){this.target instanceof cc.ProgressTimer&&(this.target.percentage=this._from+(this._to-this._from)*e)}}),cc.progressTo=function(e,t){return new cc.ProgressTo(e,t)},cc.ProgressTo.create=cc.progressTo,
cc.ProgressFromTo=cc.ActionInterval.extend({_to:0,_from:0,ctor:function(e,t,n){cc.ActionInterval.prototype.ctor.call(this),this._to=0,void(this._from=0)!==n&&this.initWithDuration(e,t,n)},initWithDuration:function(e,t,n){return!!cc.ActionInterval.prototype.initWithDuration.call(this,e)&&(this._to=n,this._from=t,!0)},clone:function(){var e=new cc.ProgressFromTo;return e.initWithDuration(this._duration,this._from,this._to),e},reverse:function(){return cc.progressFromTo(this._duration,this._to,this._from)},startWithTarget:function(e){cc.ActionInterval.prototype.startWithTarget.call(this,e)},update:function(e){this.target instanceof cc.ProgressTimer&&(this.target.percentage=this._from+(this._to-this._from)*e)}}),cc.progressFromTo=function(e,t,n){return new cc.ProgressFromTo(e,t,n)},cc.ProgressFromTo.create=cc.progressFromTo,function(){cc.ProgressTimer.WebGLRenderCmd=function(e){cc.Node.WebGLRenderCmd.call(this,e),this._needDraw=!0,this._progressDirty=!0,this._bl=cc.p(),this._tr=cc.p(),
this.initCmd()};var e=cc.ProgressTimer.WebGLRenderCmd.prototype=Object.create(cc.Node.WebGLRenderCmd.prototype);e.constructor=cc.ProgressTimer.WebGLRenderCmd,e.transform=function(e,t){this.originTransform(e,t);var n=this._node._sprite;n._renderCmd.transform(this,t);var s=n._offsetPosition.x,i=s+n._rect.width,o=n._offsetPosition.y,r=o+n._rect.height,a=this._worldTransform;this._bl.x=s*a.a+o*a.c+a.tx,this._bl.y=s*a.b+o*a.d+a.ty,this._tr.x=i*a.a+r*a.c+a.tx,this._tr.y=i*a.b+r*a.d+a.ty,this._updateProgressData()},e.rendering=function(e){var t=this._node,n=e||cc._renderContext;if(0!==this._vertexDataCount&&t._sprite){this._shaderProgram.use(),this._shaderProgram._updateProjectionUniform();var s=t._sprite._blendFunc;cc.glBlendFunc(s.src,s.dst),cc.glBindTexture2D(t._sprite.texture),n.bindBuffer(n.ARRAY_BUFFER,this._vertexWebGLBuffer),n.enableVertexAttribArray(cc.VERTEX_ATTRIB_POSITION),n.enableVertexAttribArray(cc.VERTEX_ATTRIB_COLOR),n.enableVertexAttribArray(cc.VERTEX_ATTRIB_TEX_COORDS),
this._vertexDataDirty&&(n.bufferSubData(n.ARRAY_BUFFER,0,this._float32View),this._vertexDataDirty=!1);var i=cc.V3F_C4B_T2F.BYTES_PER_ELEMENT;n.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION,3,n.FLOAT,!1,i,0),n.vertexAttribPointer(cc.VERTEX_ATTRIB_COLOR,4,n.UNSIGNED_BYTE,!0,i,12),n.vertexAttribPointer(cc.VERTEX_ATTRIB_TEX_COORDS,2,n.FLOAT,!1,i,16),t._type===cc.ProgressTimer.TYPE_RADIAL?n.drawArrays(n.TRIANGLE_FAN,0,this._vertexDataCount):t._type===cc.ProgressTimer.TYPE_BAR&&(t._reverseDirection?(n.drawArrays(n.TRIANGLE_STRIP,0,this._vertexDataCount/2),n.drawArrays(n.TRIANGLE_STRIP,4,this._vertexDataCount/2),cc.g_NumberOfDraws++):n.drawArrays(n.TRIANGLE_STRIP,0,this._vertexDataCount)),cc.g_NumberOfDraws++}},e._syncStatus=function(e){var t=this._node;if(t._sprite){var n=cc.Node._dirtyFlags,s=this._dirtyFlag,i=e?e._node:null;i&&i._cascadeColorEnabled&&e._dirtyFlag&n.colorDirty&&(s|=n.colorDirty),i&&i._cascadeOpacityEnabled&&e._dirtyFlag&n.opacityDirty&&(s|=n.opacityDirty),
e&&e._dirtyFlag&n.transformDirty&&(s|=n.transformDirty),this._dirtyFlag=s;var o=t._sprite._renderCmd,r=o._dirtyFlag,a=(s|r)&n.colorDirty,c=(s|r)&n.opacityDirty;a&&(o._syncDisplayColor(),o._dirtyFlag=o._dirtyFlag&n.colorDirty^o._dirtyFlag,this._dirtyFlag=this._dirtyFlag&n.colorDirty^this._dirtyFlag),c&&(o._syncDisplayOpacity(),o._dirtyFlag=o._dirtyFlag&n.opacityDirty^o._dirtyFlag,this._dirtyFlag=this._dirtyFlag&n.opacityDirty^this._dirtyFlag),(a||c)&&this._updateColor(),s&n.transformDirty&&this.transform(e),s&n.textureDirty&&(this._updateProgressData(),this._dirtyFlag=this._dirtyFlag&n.textureDirty^this._dirtyFlag),o._dirtyFlag=0}},e.updateStatus=function(){var e=this._node;if(e._sprite){var t=cc.Node._dirtyFlags,n=this._dirtyFlag,s=e._sprite._renderCmd,i=s._dirtyFlag,o=(n|i)&t.colorDirty,r=(n|i)&t.opacityDirty;o&&(s._updateDisplayColor(),s._dirtyFlag=s._dirtyFlag&t.colorDirty^s._dirtyFlag,this._dirtyFlag=this._dirtyFlag&t.colorDirty^this._dirtyFlag),r&&(s._updateDisplayOpacity(),
s._dirtyFlag=s._dirtyFlag&t.opacityDirty^s._dirtyFlag,this._dirtyFlag=this._dirtyFlag&t.opacityDirty^this._dirtyFlag),(o||r)&&this._updateColor(),n&t.transformDirty&&this.transform(this.getParentRenderCmd(),!0),n&t.orderDirty&&(this._dirtyFlag=this._dirtyFlag&t.orderDirty^this._dirtyFlag),n&t.textureDirty&&(this._updateProgressData(),this._dirtyFlag=this._dirtyFlag&t.textureDirty^this._dirtyFlag)}},e.releaseData=function(){if(this._vertexData){var e=this._vertexWebGLBuffer;setTimeout(function(){cc._renderContext.deleteBuffer(e)},.1),this._vertexWebGLBuffer=null,this._vertexData=null,this._float32View=null,this._vertexArrayBuffer=null,this._vertexDataCount=0}},e.initCmd=function(){if(!this._vertexData){this._vertexWebGLBuffer=cc._renderContext.createBuffer();var e=cc.V3F_C4B_T2F.BYTES_PER_ELEMENT;this._vertexArrayBuffer=new ArrayBuffer(8*e),this._float32View=new Float32Array(this._vertexArrayBuffer),this._vertexData=[];for(var t=0;t<8;t++)this._vertexData[t]=new cc.V3F_C4B_T2F(null,null
,null,this._vertexArrayBuffer,t*e);gl.bindBuffer(gl.ARRAY_BUFFER,this._vertexWebGLBuffer),gl.bufferData(gl.ARRAY_BUFFER,this._float32View,gl.DYNAMIC_DRAW),this._vertexDataCount=0,this._vertexDataDirty=!0,this._shaderProgram=cc.shaderCache.programForKey(cc.SHADER_SPRITE_POSITION_TEXTURECOLOR)}},e.resetVertexData=function(){this._vertexDataCount=0},e._updateProgressData=function(){var e=this._node._type;e===cc.ProgressTimer.TYPE_RADIAL?this._updateRadial():e===cc.ProgressTimer.TYPE_BAR&&this._updateBar(),this._vertexDataDirty=!0},e._updateProgress=function(){this.setDirtyFlag(cc.Node._dirtyFlags.textureDirty)},e._updateBar=function(){var e=this._node;if(e._sprite){var t,n=e._percentage/100,s=e._barChangeRate,i=cc.pMult(cc.p(1-s.x+n*s.x,1-s.y+n*s.y),.5),o=cc.pSub(e._midPoint,i),r=cc.pAdd(e._midPoint,i);o.x<0&&(r.x+=-o.x,o.x=0),1<r.x&&(o.x-=r.x-1,r.x=1),o.y<0&&(r.y+=-o.y,o.y=0),1<r.y&&(o.y-=r.y-1,r.y=1),this._reverseDirection?(t=this._vertexData,this._vertexDataCount||(
this._vertexDataCount=8,this._textureCoordFromAlphaPoint(t[0].texCoords,0,1),this._vertexFromAlphaPoint(t[0].vertices,0,1),this._textureCoordFromAlphaPoint(t[1].texCoords,0,0),this._vertexFromAlphaPoint(t[1].vertices,0,0),this._textureCoordFromAlphaPoint(t[6].texCoords,1,1),this._vertexFromAlphaPoint(t[6].vertices,1,1),this._textureCoordFromAlphaPoint(t[7].texCoords,1,0),this._vertexFromAlphaPoint(t[7].vertices,1,0)),this._textureCoordFromAlphaPoint(t[2].texCoords,o.x,r.y),this._vertexFromAlphaPoint(t[2].vertices,o.x,r.y),this._textureCoordFromAlphaPoint(t[3].texCoords,o.x,o.y),this._vertexFromAlphaPoint(t[3].vertices,o.x,o.y),this._textureCoordFromAlphaPoint(t[4].texCoords,r.x,r.y),this._vertexFromAlphaPoint(t[4].vertices,r.x,r.y),this._textureCoordFromAlphaPoint(t[5].texCoords,r.x,o.y),this._vertexFromAlphaPoint(t[5].vertices,r.x,o.y)):(this._vertexDataCount||(this._vertexDataCount=4),t=this._vertexData,this._textureCoordFromAlphaPoint(t[0].texCoords,o.x,r.y),
this._vertexFromAlphaPoint(t[0].vertices,o.x,r.y),this._textureCoordFromAlphaPoint(t[1].texCoords,o.x,o.y),this._vertexFromAlphaPoint(t[1].vertices,o.x,o.y),this._textureCoordFromAlphaPoint(t[2].texCoords,r.x,r.y),this._vertexFromAlphaPoint(t[2].vertices,r.x,r.y),this._textureCoordFromAlphaPoint(t[3].texCoords,r.x,o.y),this._vertexFromAlphaPoint(t[3].vertices,r.x,o.y)),this._updateColor()}},e._updateRadial=function(){var e=this._node;if(e._sprite){var t,n,s=e._midPoint,i=e._percentage/100,o=2*cc.PI*(e._reverseDirection?i:1-i),r=cc.p(s.x,1),a=cc.pRotateByAngle(r,s,o),c=0;if(0===i)n=r,c=0;else if(1===i)n=r,c=4;else{var l=cc.FLT_MAX,p=cc.ProgressTimer.TEXTURE_COORDS_COUNT;for(t=0;t<=p;++t){var d=(t+(p-1))%p,u=this._boundaryTexCoord(t%p),h=this._boundaryTexCoord(d);0===t?h=cc.pLerp(u,h,1-s.x):4===t&&(u=cc.pLerp(u,h,1-s.x));var g=cc.p(0,0);if(cc.pLineIntersect(u,h,s,a,g)){if(!(0!==t&&4!==t||0<=g.x&&g.x<=1))continue;0<=g.y&&g.y<l&&(l=g.y,c=t)}}n=cc.pAdd(s,cc.pMult(cc.pSub(a,s),l))}var v=!0
;this._vertexDataCount!==c+3&&(v=!1,this._vertexDataCount=c+3),this._updateColor();var m=this._vertexData;if(!v)for(this._textureCoordFromAlphaPoint(m[0].texCoords,s.x,s.y),this._vertexFromAlphaPoint(m[0].vertices,s.x,s.y),this._textureCoordFromAlphaPoint(m[1].texCoords,r.x,r.y),this._vertexFromAlphaPoint(m[1].vertices,r.x,r.y),t=0;t<c;t++){var f=this._boundaryTexCoord(t);this._textureCoordFromAlphaPoint(m[t+2].texCoords,f.x,f.y),this._vertexFromAlphaPoint(m[t+2].vertices,f.x,f.y)}this._textureCoordFromAlphaPoint(m[this._vertexDataCount-1].texCoords,n.x,n.y),this._vertexFromAlphaPoint(m[this._vertexDataCount-1].vertices,n.x,n.y)}},e._boundaryTexCoord=function(e){if(e<cc.ProgressTimer.TEXTURE_COORDS_COUNT){var t=cc.ProgressTimer.TEXTURE_COORDS;return this._node._reverseDirection?cc.p(t>>7-(e<<1)&1,t>>7-(1+(e<<1))&1):cc.p(t>>1+(e<<1)&1,t>>(e<<1)&1)}return cc.p(0,0)},e._textureCoordFromAlphaPoint=function(e,t,n){var s=this._node._sprite;if(!s)return e.u=0,void(e.v=0)
;var i=s._renderCmd._vertices,o=i[1],r=i[2],a=cc.p(o.u,o.v),c=cc.p(r.u,r.v);if(s.textureRectRotated){var l=t;t=n,n=l}e.u=a.x*(1-t)+c.x*t,e.v=a.y*(1-n)+c.y*n},e._vertexFromAlphaPoint=function(e,t,n){e.x=this._bl.x*(1-t)+this._tr.x*t,e.y=this._bl.y*(1-n)+this._tr.y*n,e.z=this._node._vertexZ},e._updateColor=function(){var e=this._node._sprite;if(this._vertexDataCount&&e){var t=this._displayedColor,n=e._renderCmd._displayedColor,s=n.r,i=n.g,o=n.b,r=e._renderCmd._displayedOpacity/255;e._opacityModifyRGB&&(s*=r,i*=r,o*=r),t.r=s,t.g=i,t.b=o,t.a=e._renderCmd._displayedOpacity;for(var a=this._vertexData,c=0,l=this._vertexDataCount;c<l;++c)a[c].colors=t;this._vertexDataDirty=!0}}}(),cc.SCENE_FADE=4208917214,cc.TRANSITION_ORIENTATION_LEFT_OVER=0,cc.TRANSITION_ORIENTATION_RIGHT_OVER=1,cc.TRANSITION_ORIENTATION_UP_OVER=0,cc.TRANSITION_ORIENTATION_DOWN_OVER=1,cc.TransitionSceneOriented=cc.TransitionScene.extend({_orientation:0,ctor:function(e,t,n){cc.TransitionScene.prototype.ctor.call(this),
null!=n&&this.initWithDuration(e,t,n)},initWithDuration:function(e,t,n){return cc.TransitionScene.prototype.initWithDuration.call(this,e,t)&&(this._orientation=n),!0}}),cc.TransitionSceneOriented.create=function(e,t,n){return new cc.TransitionSceneOriented(e,t,n)},cc.TransitionRotoZoom=cc.TransitionScene.extend({ctor:function(e,t){cc.TransitionScene.prototype.ctor.call(this),t&&this.initWithDuration(e,t)},onEnter:function(){cc.TransitionScene.prototype.onEnter.call(this),this._inScene.attr({scale:.001,anchorX:.5,anchorY:.5}),this._outScene.attr({scale:1,anchorX:.5,anchorY:.5});var e=cc.sequence(cc.spawn(cc.scaleBy(this._duration/2,.001),cc.rotateBy(this._duration/2,720)),cc.delayTime(this._duration/2));this._outScene.runAction(e),this._inScene.runAction(cc.sequence(e.reverse(),cc.callFunc(this.finish,this)))}}),cc.TransitionRotoZoom.create=function(e,t){return new cc.TransitionRotoZoom(e,t)},cc.TransitionJumpZoom=cc.TransitionScene.extend({ctor:function(e,t){
cc.TransitionScene.prototype.ctor.call(this),t&&this.initWithDuration(e,t)},onEnter:function(){cc.TransitionScene.prototype.onEnter.call(this);var e=cc.director.getWinSize();this._inScene.attr({scale:.5,x:e.width,y:0,anchorX:.5,anchorY:.5}),this._outScene.anchorX=.5,this._outScene.anchorY=.5;var t=cc.jumpBy(this._duration/4,cc.p(-e.width,0),e.width/4,2),n=cc.scaleTo(this._duration/4,1),s=cc.scaleTo(this._duration/4,.5),i=cc.sequence(s,t),o=cc.sequence(t,n),r=cc.delayTime(this._duration/2);this._outScene.runAction(i),this._inScene.runAction(cc.sequence(r,o,cc.callFunc(this.finish,this)))}}),cc.TransitionJumpZoom.create=function(e,t){return new cc.TransitionJumpZoom(e,t)},cc.TransitionMoveInL=cc.TransitionScene.extend({ctor:function(e,t){cc.TransitionScene.prototype.ctor.call(this),t&&this.initWithDuration(e,t)},onEnter:function(){cc.TransitionScene.prototype.onEnter.call(this),this.initScenes();var e=this.action();this._inScene.runAction(cc.sequence(this.easeActionWithAction(e),
cc.callFunc(this.finish,this)))},initScenes:function(){this._inScene.setPosition(-cc.director.getWinSize().width,0)},action:function(){return cc.moveTo(this._duration,cc.p(0,0))},easeActionWithAction:function(e){return new cc.EaseOut(e,2)}}),cc.TransitionMoveInL.create=function(e,t){return new cc.TransitionMoveInL(e,t)},cc.TransitionMoveInR=cc.TransitionMoveInL.extend({ctor:function(e,t){cc.TransitionMoveInL.prototype.ctor.call(this),t&&this.initWithDuration(e,t)},initScenes:function(){this._inScene.setPosition(cc.director.getWinSize().width,0)}}),cc.TransitionMoveInR.create=function(e,t){return new cc.TransitionMoveInR(e,t)},cc.TransitionMoveInT=cc.TransitionMoveInL.extend({ctor:function(e,t){cc.TransitionMoveInL.prototype.ctor.call(this),t&&this.initWithDuration(e,t)},initScenes:function(){this._inScene.setPosition(0,cc.director.getWinSize().height)}}),cc.TransitionMoveInT.create=function(e,t){return new cc.TransitionMoveInT(e,t)},cc.TransitionMoveInB=cc.TransitionMoveInL.extend({
ctor:function(e,t){cc.TransitionMoveInL.prototype.ctor.call(this),t&&this.initWithDuration(e,t)},initScenes:function(){this._inScene.setPosition(0,-cc.director.getWinSize().height)}}),cc.TransitionMoveInB.create=function(e,t){return new cc.TransitionMoveInB(e,t)},cc.ADJUST_FACTOR=.5,cc.TransitionSlideInL=cc.TransitionScene.extend({ctor:function(e,t){cc.TransitionScene.prototype.ctor.call(this),t&&this.initWithDuration(e,t)},_sceneOrder:function(){this._isInSceneOnTop=!1},onEnter:function(){cc.TransitionScene.prototype.onEnter.call(this),this.initScenes();var e=this.action(),t=this.action(),n=cc.sequence(this.easeActionWithAction(e),cc.callFunc(this.finish,this)),s=this.easeActionWithAction(t);this._inScene.runAction(n),this._outScene.runAction(s)},initScenes:function(){this._inScene.setPosition(-cc.director.getWinSize().width+cc.ADJUST_FACTOR,0)},action:function(){return cc.moveBy(this._duration,cc.p(cc.director.getWinSize().width-cc.ADJUST_FACTOR,0))},easeActionWithAction:function(e){
return new cc.EaseInOut(e,2)}}),cc.TransitionSlideInL.create=function(e,t){return new cc.TransitionSlideInL(e,t)},cc.TransitionSlideInR=cc.TransitionSlideInL.extend({ctor:function(e,t){cc.TransitionSlideInL.prototype.ctor.call(this),t&&this.initWithDuration(e,t)},_sceneOrder:function(){this._isInSceneOnTop=!0},initScenes:function(){this._inScene.setPosition(cc.director.getWinSize().width-cc.ADJUST_FACTOR,0)},action:function(){return cc.moveBy(this._duration,cc.p(-(cc.director.getWinSize().width-cc.ADJUST_FACTOR),0))}}),cc.TransitionSlideInR.create=function(e,t){return new cc.TransitionSlideInR(e,t)},cc.TransitionShrinkGrow=cc.TransitionScene.extend({ctor:function(e,t){cc.TransitionScene.prototype.ctor.call(this),t&&this.initWithDuration(e,t)},onEnter:function(){cc.TransitionScene.prototype.onEnter.call(this),this._inScene.attr({scale:.001,anchorX:2/3,anchorY:.5}),this._outScene.attr({scale:1,anchorX:1/3,anchorY:.5});var e=cc.scaleTo(this._duration,.01),t=cc.scaleTo(this._duration,1)
;this._inScene.runAction(cc.sequence(this.easeActionWithAction(t),cc.callFunc(this.finish,this))),this._outScene.runAction(this.easeActionWithAction(e))},easeActionWithAction:function(e){return new cc.EaseOut(e,2)}}),cc.TransitionShrinkGrow.create=function(e,t){return new cc.TransitionShrinkGrow(e,t)},cc.TransitionFade=cc.TransitionScene.extend({_color:null,ctor:function(e,t,n){cc.TransitionScene.prototype.ctor.call(this),this._color=cc.color(),t&&this.initWithDuration(e,t,n)},onEnter:function(){cc.TransitionScene.prototype.onEnter.call(this);var e=new cc.LayerColor(this._color);this._inScene.visible=!1,this.addChild(e,2,cc.SCENE_FADE);var t=this.getChildByTag(cc.SCENE_FADE),n=cc.sequence(cc.fadeIn(this._duration/2),cc.callFunc(this.hideOutShowIn,this),cc.fadeOut(this._duration/2),cc.callFunc(this.finish,this));t.runAction(n)},onExit:function(){cc.TransitionScene.prototype.onExit.call(this),this.removeChildByTag(cc.SCENE_FADE,!1)},initWithDuration:function(e,t,n){
return n=n||cc.color.BLACK,cc.TransitionScene.prototype.initWithDuration.call(this,e,t)&&(this._color.r=n.r,this._color.g=n.g,this._color.b=n.b,this._color.a=0),!0}}),cc.TransitionFade.create=function(e,t,n){return new cc.TransitionFade(e,t,n)},cc.TransitionCrossFade=cc.TransitionScene.extend({ctor:function(e,t){cc.TransitionScene.prototype.ctor.call(this),t&&this.initWithDuration(e,t)},onEnter:function(){cc.TransitionScene.prototype.onEnter.call(this);var e=cc.color(0,0,0,0),t=cc.director.getWinSize(),n=new cc.LayerColor(e),s=new cc.RenderTexture(t.width,t.height);s.sprite.anchorX=.5,s.sprite.anchorY=.5,s.attr({x:t.width/2,y:t.height/2,anchorX:.5,anchorY:.5}),s.begin(),this._inScene.visit(),s.end();var i=new cc.RenderTexture(t.width,t.height);i.setPosition(t.width/2,t.height/2),i.sprite.anchorX=i.anchorX=.5,i.sprite.anchorY=i.anchorY=.5,i.begin(),this._outScene.visit(),i.end(),s.sprite.setBlendFunc(cc.ONE,cc.ONE),i.sprite.setBlendFunc(cc.SRC_ALPHA,cc.ONE_MINUS_SRC_ALPHA),n.addChild(s)
,n.addChild(i),s.sprite.opacity=255,i.sprite.opacity=255;var o=cc.sequence(cc.fadeTo(this._duration,0),cc.callFunc(this.hideOutShowIn,this),cc.callFunc(this.finish,this));i.sprite.runAction(o),this.addChild(n,2,cc.SCENE_FADE)},onExit:function(){this.removeChildByTag(cc.SCENE_FADE,!1),cc.TransitionScene.prototype.onExit.call(this)},visit:function(){cc.Node.prototype.visit.call(this)},draw:function(){}}),cc.TransitionCrossFade.create=function(e,t){return new cc.TransitionCrossFade(e,t)},cc.TransitionTurnOffTiles=cc.TransitionScene.extend({_gridProxy:null,ctor:function(e,t){cc.TransitionScene.prototype.ctor.call(this),this._gridProxy=new cc.NodeGrid,t&&this.initWithDuration(e,t)},_sceneOrder:function(){this._isInSceneOnTop=!1},onEnter:function(){cc.TransitionScene.prototype.onEnter.call(this),this._gridProxy.setTarget(this._outScene),this._gridProxy.onEnter();var e=cc.director.getWinSize(),t=0|12*(e.width/e.height),n=cc.turnOffTiles(this._duration,cc.size(t,12)),
s=this.easeActionWithAction(n);this._gridProxy.runAction(cc.sequence(s,cc.callFunc(this.finish,this),cc.stopGrid()))},visit:function(){this._inScene.visit(),this._gridProxy.visit()},easeActionWithAction:function(e){return e}}),cc.TransitionTurnOffTiles.create=function(e,t){return new cc.TransitionTurnOffTiles(e,t)},cc.TransitionSplitCols=cc.TransitionScene.extend({_gridProxy:null,_switchTargetToInscene:function(){this._gridProxy.setTarget(this._inScene)},ctor:function(e,t){cc.TransitionScene.prototype.ctor.call(this),this._gridProxy=new cc.NodeGrid,t&&this.initWithDuration(e,t)},onEnter:function(){cc.TransitionScene.prototype.onEnter.call(this),this._gridProxy.setTarget(this._outScene),this._gridProxy.onEnter();var e=this.action(),t=cc.sequence(e,cc.callFunc(this._switchTargetToInscene,this),e.reverse());this._gridProxy.runAction(cc.sequence(this.easeActionWithAction(t),cc.callFunc(this.finish,this),cc.stopGrid()))},onExit:function(){this._gridProxy.setTarget(null),
this._gridProxy.onExit(),cc.TransitionScene.prototype.onExit.call(this)},visit:function(){this._gridProxy.visit()},easeActionWithAction:function(e){return new cc.EaseInOut(e,3)},action:function(){return cc.splitCols(this._duration/2,3)}}),cc.TransitionSplitCols.create=function(e,t){return new cc.TransitionSplitCols(e,t)},cc.TransitionSplitRows=cc.TransitionSplitCols.extend({ctor:function(e,t){cc.TransitionSplitCols.prototype.ctor.call(this),t&&this.initWithDuration(e,t)},action:function(){return cc.splitRows(this._duration/2,3)}}),cc.TransitionSplitRows.create=function(e,t){return new cc.TransitionSplitRows(e,t)},cc.TransitionFadeTR=cc.TransitionScene.extend({_gridProxy:null,ctor:function(e,t){cc.TransitionScene.prototype.ctor.call(this),this._gridProxy=new cc.NodeGrid,t&&this.initWithDuration(e,t)},_sceneOrder:function(){this._isInSceneOnTop=!1},onEnter:function(){cc.TransitionScene.prototype.onEnter.call(this),this._gridProxy.setTarget(this._outScene),this._gridProxy.onEnter()
;var e=cc.director.getWinSize(),t=0|12*(e.width/e.height),n=this.actionWithSize(cc.size(t,12));this._gridProxy.runAction(cc.sequence(this.easeActionWithAction(n),cc.callFunc(this.finish,this),cc.stopGrid()))},visit:function(){this._inScene.visit(),this._gridProxy.visit()},easeActionWithAction:function(e){return e},actionWithSize:function(e){return cc.fadeOutTRTiles(this._duration,e)}}),cc.TransitionFadeTR.create=function(e,t){return new cc.TransitionFadeTR(e,t)},cc.TransitionFadeBL=cc.TransitionFadeTR.extend({ctor:function(e,t){cc.TransitionFadeTR.prototype.ctor.call(this),t&&this.initWithDuration(e,t)},actionWithSize:function(e){return cc.fadeOutBLTiles(this._duration,e)}}),cc.TransitionFadeBL.create=function(e,t){return new cc.TransitionFadeBL(e,t)},cc.TransitionFadeUp=cc.TransitionFadeTR.extend({ctor:function(e,t){cc.TransitionFadeTR.prototype.ctor.call(this),t&&this.initWithDuration(e,t)},actionWithSize:function(e){return new cc.FadeOutUpTiles(this._duration,e)}}),
cc.TransitionFadeUp.create=function(e,t){return new cc.TransitionFadeUp(e,t)},cc.TransitionFadeDown=cc.TransitionFadeTR.extend({ctor:function(e,t){cc.TransitionFadeTR.prototype.ctor.call(this),t&&this.initWithDuration(e,t)},actionWithSize:function(e){return cc.fadeOutDownTiles(this._duration,e)}}),cc.TransitionFadeDown.create=function(e,t){return new cc.TransitionFadeDown(e,t)},cc.SCENE_RADIAL=49153,cc.TransitionProgress=cc.TransitionScene.extend({_to:0,_from:0,_sceneToBeModified:null,_className:"TransitionProgress",ctor:function(e,t){cc.TransitionScene.prototype.ctor.call(this),t&&this.initWithDuration(e,t)},_setAttrs:function(e,t,n){e.attr({x:t,y:n,anchorX:.5,anchorY:.5})},onEnter:function(){cc.TransitionScene.prototype.onEnter.call(this),this._setupTransition();var e=cc.director.getWinSize(),t=new cc.RenderTexture(e.width,e.height);t.sprite.anchorX=.5,t.sprite.anchorY=.5,this._setAttrs(t,e.width/2,e.height/2),t.clear(0,0,0,1),t.begin(),this._sceneToBeModified.visit(),t.end(),
this._sceneToBeModified===this._outScene&&this.hideOutShowIn();var n=this._progressTimerNodeWithRenderTexture(t),s=cc.sequence(cc.progressFromTo(this._duration,this._from,this._to),cc.callFunc(this.finish,this));n.runAction(s),this.addChild(n,2,cc.SCENE_RADIAL)},onExit:function(){this.removeChildByTag(cc.SCENE_RADIAL,!0),cc.TransitionScene.prototype.onExit.call(this)},_setupTransition:function(){this._sceneToBeModified=this._outScene,this._from=100,this._to=0},_progressTimerNodeWithRenderTexture:function(e){return cc.log("cc.TransitionProgress._progressTimerNodeWithRenderTexture(): should be overridden in subclass"),null},_sceneOrder:function(){this._isInSceneOnTop=!1}}),cc.TransitionProgress.create=function(e,t){return new cc.TransitionProgress(e,t)},cc.TransitionProgressRadialCCW=cc.TransitionProgress.extend({ctor:function(e,t){cc.TransitionProgress.prototype.ctor.call(this),t&&this.initWithDuration(e,t)},_progressTimerNodeWithRenderTexture:function(e){var t=cc.director.getWinSize(),
n=new cc.ProgressTimer(e.sprite);return cc._renderType===cc.game.RENDER_TYPE_WEBGL&&(n.sprite.flippedY=!0),n.type=cc.ProgressTimer.TYPE_RADIAL,n.reverseDir=!1,n.percentage=100,this._setAttrs(n,t.width/2,t.height/2),n}}),cc.TransitionProgressRadialCCW.create=function(e,t){return new cc.TransitionProgressRadialCCW(e,t)},cc.TransitionProgressRadialCW=cc.TransitionProgress.extend({ctor:function(e,t){cc.TransitionProgress.prototype.ctor.call(this),t&&this.initWithDuration(e,t)},_progressTimerNodeWithRenderTexture:function(e){var t=cc.director.getWinSize(),n=new cc.ProgressTimer(e.sprite);return cc._renderType===cc.game.RENDER_TYPE_WEBGL&&(n.sprite.flippedY=!0),n.type=cc.ProgressTimer.TYPE_RADIAL,n.reverseDir=!0,n.percentage=100,this._setAttrs(n,t.width/2,t.height/2),n}}),cc.TransitionProgressRadialCW.create=function(e,t){var n=new cc.TransitionProgressRadialCW;return null!==n&&n.initWithDuration(e,t)?n:new cc.TransitionProgressRadialCW(e,t)},
cc.TransitionProgressHorizontal=cc.TransitionProgress.extend({ctor:function(e,t){cc.TransitionProgress.prototype.ctor.call(this),t&&this.initWithDuration(e,t)},_progressTimerNodeWithRenderTexture:function(e){var t=cc.director.getWinSize(),n=new cc.ProgressTimer(e.sprite);return cc._renderType===cc.game.RENDER_TYPE_WEBGL&&(n.sprite.flippedY=!0),n.type=cc.ProgressTimer.TYPE_BAR,n.midPoint=cc.p(1,0),n.barChangeRate=cc.p(1,0),n.percentage=100,this._setAttrs(n,t.width/2,t.height/2),n}}),cc.TransitionProgressHorizontal.create=function(e,t){return new cc.TransitionProgressHorizontal(e,t)},cc.TransitionProgressVertical=cc.TransitionProgress.extend({ctor:function(e,t){cc.TransitionProgress.prototype.ctor.call(this),t&&this.initWithDuration(e,t)},_progressTimerNodeWithRenderTexture:function(e){var t=cc.director.getWinSize(),n=new cc.ProgressTimer(e.sprite);return cc._renderType===cc.game.RENDER_TYPE_WEBGL&&(n.sprite.flippedY=!0),n.type=cc.ProgressTimer.TYPE_BAR,n.midPoint=cc.p(0,0),
n.barChangeRate=cc.p(0,1),n.percentage=100,this._setAttrs(n,t.width/2,t.height/2),n}}),cc.TransitionProgressVertical.create=function(e,t){return new cc.TransitionProgressVertical(e,t)},cc.TransitionProgressInOut=cc.TransitionProgress.extend({ctor:function(e,t){cc.TransitionProgress.prototype.ctor.call(this),t&&this.initWithDuration(e,t)},_progressTimerNodeWithRenderTexture:function(e){var t=cc.director.getWinSize(),n=new cc.ProgressTimer(e.sprite);return cc._renderType===cc.game.RENDER_TYPE_WEBGL&&(n.sprite.flippedY=!0),n.type=cc.ProgressTimer.TYPE_BAR,n.midPoint=cc.p(.5,.5),n.barChangeRate=cc.p(1,1),n.percentage=0,this._setAttrs(n,t.width/2,t.height/2),n},_sceneOrder:function(){this._isInSceneOnTop=!1},_setupTransition:function(){this._sceneToBeModified=this._inScene,this._from=0,this._to=100}}),cc.TransitionProgressInOut.create=function(e,t){return new cc.TransitionProgressInOut(e,t)},cc.TransitionProgressOutIn=cc.TransitionProgress.extend({ctor:function(e,t){
cc.TransitionProgress.prototype.ctor.call(this),t&&this.initWithDuration(e,t)},_progressTimerNodeWithRenderTexture:function(e){var t=cc.director.getWinSize(),n=new cc.ProgressTimer(e.sprite);return cc._renderType===cc.game.RENDER_TYPE_WEBGL&&(n.sprite.flippedY=!0),n.type=cc.ProgressTimer.TYPE_BAR,n.midPoint=cc.p(.5,.5),n.barChangeRate=cc.p(1,1),n.percentage=100,this._setAttrs(n,t.width/2,t.height/2),n}}),cc.TransitionProgressOutIn.create=function(e,t){return new cc.TransitionProgressOutIn(e,t)},cc.TransitionPageTurn=cc.TransitionScene.extend({ctor:function(e,t,n){cc.TransitionScene.prototype.ctor.call(this),this._gridProxy=new cc.NodeGrid,this.initWithDuration(e,t,n)},_back:!0,_gridProxy:null,_className:"TransitionPageTurn",initWithDuration:function(e,t,n){return this._back=n,cc.TransitionScene.prototype.initWithDuration.call(this,e,t),!0},actionWithSize:function(e){return this._back?cc.reverseTime(cc.pageTurn3D(this._duration,e)):cc.pageTurn3D(this._duration,e)},onEnter:function(){
cc.TransitionScene.prototype.onEnter.call(this);var e,t,n=cc.director.getWinSize();n.width>n.height?(e=16,t=12):(e=12,t=16);var s=this.actionWithSize(cc.size(e,t)),i=this._gridProxy;this._back?(i.setTarget(this._inScene),i.onEnter(),this._inScene.visible=!1,i.runAction(cc.sequence(s,cc.callFunc(this.finish,this),cc.stopGrid())),this._inScene.runAction(cc.show())):(i.setTarget(this._outScene),i.onEnter(),i.runAction(cc.sequence(s,cc.callFunc(this.finish,this),cc.stopGrid())))},visit:function(){this._back?this._outScene.visit():this._inScene.visit(),this._gridProxy.visit()},_sceneOrder:function(){this._isInSceneOnTop=this._back}}),cc.TransitionPageTurn.create=function(e,t,n){return new cc.TransitionPageTurn(e,t,n)}}},HomefixHelper={repair:function(e,o){var t=e.furnitureId,n=e.videoInProgress,r=e.showTasksWindow,a=e.choice,c=e.clickVariants,s=e.zoomTo,l=e.initAction;HomeTool.set(t,0,!1,function(){var i=cleverapps.home.getFurnitureById(t);i.setChoice(a),i.showChoice(a),
ScenarioHelper.reloadMainScene(function(){setTimeout(function(){l&&l(),cc.director.getRunningScene().map.scrollTo(i,!0,function(){s&&(cc.director.getRunningScene().map.setZoom(.7),cc.director.getRunningScene().map.zoomTo({zoom:2.1,timeout:s.timeout}))}),$(FingerView).hide(),n?cleverapps.Recorder.resume():cleverapps.Recorder.start(),cleverapps.home.stars+=100;var e=function(){var e=void 0;if(r){var t=(e=new HomeTasksWindow).window.children[1].children[0].children[0].getChildren().slice(-1)[0].children[2].children[0],n=cc.director.getRunningScene().scene.convertToNodeSpace(t.convertToWorldSpace(cc.p(t.width,t.height)));FingerControl.pointToLocation(cc.director.getRunningScene().scene,{x:n.x,y:n.y})}else{var s=(e=new BuildingInfoWindow(i)).children[0];FingerControl.pointToLocation(s,{x:s.children[4].x,y:s.children[4].y})}setTimeout(function(){e.close(),cleverapps.metha.distract({focus:"homefixNewTask",action:function(e){i.stage=i.amountStages()-1,cleverapps.home.moveNext(i,e),setTimeout(
function(){HomefixHelper.makeChoice(a,c,function(){var e=$(HomeTasksWindow).get(0);cleverapps.windows.remove(e),setTimeout(o,500)})},300)}.bind(this)})}.bind(this),1500)},t=$(HomeTasksIcon).get(0);setTimeout(function(){r?FingerControl.pointToLocation(t,{x:t.width/2,y:t.height/2}):FingerControl.pointToLocation(cc.director.getRunningScene().scene,{x:cleverapps.UI.getSceneSize().width/2+40,y:cleverapps.UI.getSceneSize().height/2})},s?s.fingerShowTimeout:0),setTimeout(function(){cleverapps.metha.isFocused()?cleverapps.metha.distract({focus:"HomeTasksWindow",action:e}):cleverapps.metha.display({focus:"HomeTasksWindow",action:e})}.bind(this),s?s.showTasksTimeout:1500)},8e3)})})},makeChoice:function(t,e,n){var s=$(MakeChoiceWindow).get(),i=cc.director.getRunningScene().scene,o=new FingerViewEx;i.addChild(o);var r=s.choices[t],a=i.convertToNodeSpace(r.convertToWorldSpace(cc.p(r.x,r.y)));o.setLocalZOrder(999),o.fadeIn({x:a.x,y:a.y}),o.delay(.4),e&&e.forEach(function(t){var e=s.choices[t]
;a=i.convertToNodeSpace(e.convertToWorldSpace(cc.p(e.width/2,e.height/2))),o.moveTo({x:a.x,y:a.y}),o.press(),o.addAction(function(e){s.selectChoice(t),cleverapps.audio.playSound(bundles.main.urls.click_effect),e()}),o.unPress()});var c=s.window.children[0].children[0].children[2];a=i.convertToNodeSpace(c.convertToWorldSpace(cc.p(c.width/2,c.height/2))),o.moveTo({x:a.x,y:a.y}),o.press(),o.addAction(function(e){cleverapps.audio.playSound(bundles.main.urls.click_effect),e()}),o.unPress(),o.delay(.2),o.addAction(function(e){s.makeChoice(t),e()}),o.fadeOut(),o.run({looped:!1,onFinish:function(){o.removeFromParent(),n()}})}},KnockoutHelper={overrides:[],initWeeklyCup:function(e){var t=ScenarioHelper.getTablePlayers(e.language,8,1),n=t.filter(function(e){return e.player})[0],s=ScenarioHelper.getAvatarPostfix(e.language);cleverapps.friends.player.avatar=bundles.screenshots.frames["avatar_"+n.place+s],cleverapps.weeklyCup.reloading=!0,cleverapps.weeklyCup.stars=n.amount,n.id=cleverapps.user.id,
cleverapps.weeklyCup.players=t,cleverapps.weeklyCup.preparePlayersData(),cleverapps.weeklyCup.players.forEach(function(e){e.avatar=bundles.screenshots.frames["avatar_"+e.place+s]}),cleverapps.weeklyCup.finished=!1,cleverapps.weeklyCup.timeFinish=Date.now()+cleverapps.parseInterval("5 minutes")+cleverapps.parseInterval("38 seconds"),cleverapps.weeklyCup.timeout=new cleverapps.LongTimeout(function(){}.bind(this),cleverapps.parseInterval("5 minutes")+cleverapps.parseInterval("38 seconds")),cleverapps.weeklyCup.runUpdateListeners()},initRumble:function(o){var e=ScenarioHelper.getPlayerNames(o.language),r=e[0],a=ScenarioHelper.getAvatarPostfix(o.language),t=Rumble.prototype.preparePlayers;this.overrides.push(function(){Rumble.prototype.preparePlayers=t}),Rumble.prototype.preparePlayers=function(){var i={};return e.forEach(function(e,t){var n=t+1,s=bundles.screenshots.frames["avatar_"+n+a];e!==r||o.preserveUser||(cleverapps.friends.player.name=e,cleverapps.friends.player.avatar=s),i[n]={
id:n,name:e,avatar:s}}),i};var n=Rumble.prototype.init;this.overrides.push(function(){Rumble.prototype.init=n}),Rumble.prototype.init=function(e){e([])},cleverapps.metha.getMainObject().knockoutGame.rumble=new Rumble},openKnockoutWindow:function(e,t){for(var n=0;n<e.roundsPlayed;n++){cleverapps.metha.getMainObject().knockoutGame.rumble.getCurrentRound().calcWinners(GameBase.OUTCOME_VICTORY),cleverapps.metha.getMainObject().knockoutGame.rumble.moveNextRound()}var s=KnockoutWindow.prototype.runPlayCountdown;this.overrides.push(function(){KnockoutWindow.prototype.runPlayCountdown=s}),KnockoutWindow.prototype.runPlayCountdown=function(){t&&t(),s.call(this)};var i=GridPlayerView.prototype.runWinAnimation;this.overrides.push(function(){GridPlayerView.prototype.runWinAnimation=i}),GridPlayerView.prototype.runWinAnimation=function(e){i.call(this,e,!1,.5)},cleverapps.metha.display({focus:"scenariosKnockoutWindow",action:function(e){new KnockoutWindow(cleverapps.metha.getMainObject(
).knockoutGame.rumble),e()}})},restoreOverrides:function(){0!==this.overrides.length&&(delete cleverapps.metha.getMainObject().knockoutGame.rumble,this.overrides.forEach(function(e){e()}))}},JSQuery=function(e){this.selector=e,this.objects=[],this.add(e)};JSQuery.prototype.add=function(e){if(e.node)return this.objects.push(e.node),this.objects;var t=[e.root||cc.director.getRunningScene()],n=0,s=e.Class;for(Array.isArray(s)||(s=[s]);n<t.length;){var i=t[n++];s.some(function(e){return i instanceof e})&&this.objects.push(i),i.getChildren().forEach(function(e){t.push(e)})}return this.objects},JSQuery.prototype.empty=function(e){return 0===this.objects.length},JSQuery.prototype.get=function(e){return this.objects[e||0]},JSQuery.getNumber=function(e,t){return Array.isArray(e)?e[1]*t/2:e},JSQuery.prototype.hide=function(){return this.objects.forEach(function(e){e.visible=!1}),this.objects},JSQuery.prototype.show=function(){return this.objects.forEach(function(e){e.visible=!0}),this.objects},
JSQuery.prototype.styles=function(t){var n=cleverapps.UI.getSceneSize();return this.objects.forEach(function(e){t.visible&&(e.visible=t.visible),t.x&&(e.x=JSQuery.getNumber(t.x,n.width)),t.y&&(e.y=JSQuery.getNumber(t.y,n.height)),t.offsetX&&(e.x+=JSQuery.getNumber(t.offsetX,n.width)),t.offsetY&&(e.y+=JSQuery.getNumber(t.offsetY,n.height)),t.scale&&(e.scale=t.scale),t.removed&&e.removeFromParent()}),this.objects},JSQuery.prototype.filter=function(e){return Object.create(JSQuery.prototype,{objects:{value:this.objects.filter(e)}})};var $=function(e){return e instanceof JSQuery?e:e instanceof cc.Node?new JSQuery({node:e}):e.Class?new JSQuery(e):new JSQuery({Class:e})},Scenarios={},ScenarioHelper={getName:function(e){for(var t in Scenarios)if(Scenarios[t]===e)return t},reloadMainScene:function(t){var e=function(e){cleverapps.metha.gotoMainScene(function(){e(),t()})};cleverapps.metha.isFocused()?cleverapps.metha.distract({focus:"reloadMain",action:e}):cleverapps.metha.display({
focus:"reloadMain",action:e})},setLevel:function(e){levels.user.level=(e-1)%Episode.LEVELS_PER_EPISODE,levels.user.episode=Math.floor((e-1)/Episode.LEVELS_PER_EPISODE),levels.user.save(),cleverapps.DataLoader.processSaveQueue(),levels.episodes.reset(),levels.episodes.setCurrentEpisode(levels.user.episode)},getAvatarPostfix:function(e){return 0<=["it","es","pt"].indexOf(e)?"_it":0<=["ja","zh","ar","ko","tr"].indexOf(e)?"_"+e:""},getPlayerNames:function(e){var t={de:["Mila","Stephan","Susanne","Mia","Clara","Monica","Anna","Sofia"],en:["Amy","Paul","Helen","Mary","Gina","Stacy","Victoria","Emma"],es:["Sofa","Juan","Valentina","Isabella","Valeria","Luciana","Jimena","Mariana"],fr:["Madeline","Hugo","Margot","Noelle","Marie","Camille","Justine","Sophie"],it:["Flavia","Alessandro","Gianna","Letizia","Nina","Francesca","Daniela","Brigita"],ja:["","","","","","","",""],nl:["Camille","Andreas","Susanne","Mia","Clara","Monica","Anna","Sofia"],ru:["","",""
,""," ","",". ",""],ar:["","","","","","","",""],ko:["","","","","","","",""],lv:["Jeena","Jnis","Dagmra","Lidija","Kristne","Jadviga","Ingrda","Broislava"],pl:["Zuzanna","Franciszek","Lena","Aleksandra","Alicja","Milena","Milena","Ada"],pt:["Cludia","Bruno","Giselle","Daniela","Antonina","Fernanda","Izabela","Jasmim"],tr:["Beyza","Yusuf","Damla","Gkek","Aytrk","Miray","Zeynep","Eda"],zh:["","","","","","","",""]};return t[e]||t.en},getYourName:function(e){var t={de:"Sie",en:"You",es:"T",fr:"Vous",it:"Tu",ja:"",nl:"You",ru:""};return t[e]||t.en},getTablePlayers:function(e,t,n,s){for(var i=ScenarioHelper.getPlayerNames(e),o=[],r=0;r<t;r++){var a={id:r+1,place:r+1,text:i[r],amount:578-Math.pow(r,3)};(n===a.id||!n&&1===a.id)&&(a.player=!0),s&&(a.avatar=bundles.screenshots.frames["avatar_"+(r+1)+ScenarioHelper.getAvatarPostfix(e)]),o.push(a)}return o},runScenarios:function(e
,d){d=d||{};var t=new ActionPlayer;cleverapps.screenshotsMode=!0;var u={video:[],audio:d.audio,fadeDuration:1.5,transition:{duration:1,default:"circleopen",sequence:[]}},n=d.languages||cleverapps.config.languages,s=d.sizes,i=d.onLanguageChanged||function(e,t){t()},h=0,g=n.length*Object.keys(s).length;n.forEach(function(p){cleverapps.bundleLoader.loadBundle("language_"+p),t.add(function(n){cleverapps.settings.setLanguage(p);var e=function(e){var t=cleverapps.wait(2,function(){cleverapps.metha.isFocused()&&cleverapps.metha.freeFocus("afterChangeLanguage"),n(),e()});i(p,t),Messages.preload(p,t)};cleverapps.metha.isFocused()?cleverapps.metha.distract({focus:"afterChangeLanguage",action:e}):cleverapps.metha.display({focus:"afterChangeLanguage",action:e})}),Object.keys(s).forEach(function(c){var l=s[c];t.add(function(e){cleverapps.styles.SCENE_MIN_WIDTH=600,cleverapps.styles.SCENE_MAX_WIDTH=2990,cleverapps.setupDesignResolution({width:l.width/window.devicePixelRatio,
height:l.height/window.devicePixelRatio}),setTimeout(e,100)}),e.forEach(function(e){var r=ScenarioHelper.getName(e),a={};t.add(function(t){ScenarioHelper.getData(r,p,d,function(e){console.log("Data for "+r,e),a=e,t()})}),t.add(function(t){var e=cleverapps.clone(d);cleverapps.override(e,{resolutionName:c,language:p});var n=d.path,s=d.name||r.toLowerCase(),i=l.width+"x"+l.height;n=n.replace("%{name}",cleverapps.config.name).replace("%{lang}",p),0<=(s=s.replace("%{name}",cleverapps.config.name).replace("%{lang}",p)).indexOf("%{resolution}")?s=s.replace("%{resolution}",i):s+="_"+i,console.log("Generating "+c.toLowerCase()+" for "+p+": "+s);var o=TransitionAnimation.animate;(0,Scenarios[r])(a,e,function(){if(d.previewMode||!d.video||d.video===ScenarioHelper.VIDEO_ACTION.NO_SAVE)t();else{var e={processed:++h,total:g};cleverapps.Recorder.save(n,s,e,function(e){d.video===ScenarioHelper.VIDEO_ACTION.SAVE&&(u.video.push(e),
u.transition.sequence=a.ffmpeg&&a.ffmpeg.transition&&a.ffmpeg.transition.sequence||u.transition.sequence),TransitionAnimation.animate=o,t()})}})})})})}),d.video!==ScenarioHelper.VIDEO_ACTION.SAVE||d.previewMode||t.add(function(e){console.log("Run transform..."),cleverapps.Recorder.runTransform(u),e()}),d.callback&&t.add(function(e){e(),d.callback()}),t.play()},getData:function(e,t,s,i){var n="";cleverapps.isLocalhost()||(n=cleverapps.config.deployment+"/");var o=[n+"cleverapps/levels/tool/scenario/scenarios/"+cleverapps.config.type+"/data/"+e+"/settings.json",n+"cleverapps/levels/tool/scenario/scenarios/"+cleverapps.config.type+"/data/"+e+"/"+t+".json",n+"cleverapps/levels/tool/scenario/scenarios/"+cleverapps.config.name+"/data/"+e+"/settings.json",n+"cleverapps/levels/tool/scenario/scenarios/"+cleverapps.config.name+"/data/"+e+"/"+t+".json"];if("board"===cleverapps.config.type){var r="undefined"==typeof Scramble?"regular":"scramble";o.unshift(
n+"cleverapps/levels/tool/scenario/scenarios/"+cleverapps.config.type+"/data/"+e+"/levelformat/"+r+"/"+t+".json")}var a=cleverapps.wait(o.length,function(){var n={};o.forEach(function(e){var t=cc.loader.getRes(e);t&&(t[cleverapps.config.name]&&"differences"!==cleverapps.config.name&&(t=t[cleverapps.config.name]),n=cleverapps.override(n,t))}),cleverapps.bundleLoader.loadBundles(ScenarioHelper.listBundles(e,s),{onSuccess:function(){i(n)}})});o.forEach(function(e){cc.loader.load(e,a)})},listBundles:function(e,t){var n=["screenshots","loading_scene_backgrounds","browser_resources","ads_scale","ads_title","ads_finger","ads_counter","ads_bar","ads_tree","ads_logo","ads_words_list","ads_transition","ads_words_result","ads_exclamations"];return"tripeaks"===cleverapps.config.name?n.push("card_skins"):"adventure"===cleverapps.config.name?n=n.concat(["dialogues","main","loading_scene"]):"runes"===cleverapps.config.name?n=n.concat(["dialogues","game_background_2"]
):"mergeriddles"===cleverapps.config.name?n=n.concat(["dialogues","loading_scene"]):"mergeheroes"===cleverapps.config.name?n=n.concat(["dialogues","loading_scene"]):"riddles"===cleverapps.config.name?n=n.concat(["dialogues","game_background_2"]):"heroes"===cleverapps.config.name?n=n.concat(["dialogues","person5","person2"]):"scramble"===cleverapps.config.name&&(n=n.concat(["game_background_hard","game_background_2","game_background","game_background_bonus","ads_keypad_letters","ads_keypad"])),"ads"===e&&n.push(AdsSkins.getBundle()),t.video!==ScenarioHelper.VIDEO_ACTION.NO_VIDEO&&n.push("video_ads"),n},VIDEO_ACTION:{NO_VIDEO:"no_video",NO_SAVE:"no_save",SAVE:"save"}},GamePlayer=function(e,t){cleverapps.EventEmitter.call(this),this.level=e||Game.currentGame.level.content,this.options=t||{};var n=cc.director.getRunningScene();this.scene=n.scene,this.game=Game.currentGame,this.finger=new FingerViewEx(this.options.finger),n.addChild(this.finger),this.finger.setLocalZOrder(999),
GamePlayer.instance=this};GamePlayer.prototype=Object.create(cleverapps.EventEmitter.prototype),(GamePlayer.prototype.constructor=GamePlayer).prototype.play=function(s,e){var i=this.player=new ActionPlayer,t="number"==typeof s||Array.isArray(s)?s:s.actions;if("number"==typeof t){var n=t;t=[];for(var o=0;o<n;o++)t.push("any")}(this.actions=t).forEach(function(t,e){var n=s.delay||0;0===e&&(n+=s.initialDelay||0),i.add(ActionPlayer.delay(n)),i.add(function(e){"string"==typeof t&&-1!==t.indexOf("fingerFadeOut")?(this.fingerFadeOut(e),this.finger.isShown=!1):this.playAction(t,e)}.bind(this))}.bind(this)),i.play(e)},GamePlayer.prototype.stop=function(){this.player&&this.player.stop(),this.finger&&this.finger.removeFromParent()},GamePlayer.prototype.playAction=function(e,t){t()},GamePlayer.prototype.fingerRelax=function(e,t){this.finger.relax(e),this.finger.runOnce(t)},GamePlayer.prototype.fingerFadeOut=function(e){this.finger.fadeOut(),this.finger.runOnce(e)},GamePlayer.Create=function(e,t){
var n=BoardPlayer;return"tripeaks"===cleverapps.config.name?n=SolitairePlayer:"scramble"===cleverapps.config.name?n=ScramblePlayer:"differences"===cleverapps.config.name?n=DifferencesPlayer:"match3"===cleverapps.config.type?n=Match3Player:"merge"===cleverapps.config.type&&(n=MergeCraftPlayer),new n(e,t)};var BoardPlayer=function(e,t){GamePlayer.call(this,e,t),this.keypadView=Game.currentGame.keypad.getAdsKeypadView(),this.finger.setPositionRound(0,0),this.finger.relaxPosition={y:-this.finger.finger.height}};BoardPlayer.prototype=Object.create(GamePlayer.prototype),(BoardPlayer.prototype.constructor=BoardPlayer).prototype.playAction=function(e,t){"hint"===e.type?this.pressButton($(AdsHintButton).get(),t):"shuffle"===e.type?this.pressButton($(AdsShuffleButton).get(),t):this.openWordAction(e,t)},BoardPlayer.prototype.pressButton=function(t,e){var n=t.getParent().convertToWorldSpace(t.getPosition());this.finger.moveTo(n),this.finger.press(),this.finger.unPress(),this.finger.addAction(
function(e){t.click(e)}),this.finger.runOnce(e)},BoardPlayer.prototype.openWordAction=function(e,t){var n;if(e.letters)n=e.letters.map(function(e){return"stacks"===cleverapps.config.subtype?Game.currentGame.keypad.field[e.x][e.y].symbol:Game.currentGame.keypad.letters[e.index].symbol}).join("");else{var s=Game.currentGame.board.getUndiscoveredWords();n=(s=(s=cleverapps.Random.shuffle(s.slice())).filter(function(e){return Game.currentGame.keypad.findWordIndexes(e)}))[0]}n?this.openWord(n,1===Game.currentGame.board.getUndiscoveredWords().length,t):t()},BoardPlayer.prototype.openWord=function(e,t,n){var s=Game.currentGame.keypad.findWordIndexes(e);s?(s.forEach(function(t,e){var n=t.onLocateView().getPosition(),s=cc.director.getRunningScene().convertToNodeSpace(this.keypadView.convertToWorldSpace(n));0!==e||this.finger.isShown||(this.finger.fadeIn(s),this.finger.isShown=!0),this.finger.moveTo(s),0===e&&(this.finger.press(),this.finger.addAction(function(e){Game.currentGame.keypad.swipe(),
e()}.bind(this)),this.finger.delay(.2)),this.finger.addAction(function(e){Game.currentGame.keypad.touchBegan(t),this.keypadView.pathNode.clear(),e()}.bind(this))}.bind(this)),this.finger.unPress(),this.finger.addAction(function(e){Game.currentGame.keypad.touchEnded(),e()}.bind(this)),this.finger.delay(.2),t?this.fingerRelax(1,n):this.finger.runOnce(n)):n()};var DifferencesPlayer=function(e,t){GamePlayer.call(this,e,t),this.scene=cc.director.getRunningScene(),this.areas=Game.currentGame.areas,this.finger.relaxPosition={y:-this.finger.finger.height},this.scene.photos.imageA.imageId="a",this.scene.photos.imageB.imageId="b",this.photos=[this.scene.photos.imageB,this.scene.photos.imageA]};DifferencesPlayer.prototype=Object.create(GamePlayer.prototype),(DifferencesPlayer.prototype.constructor=DifferencesPlayer).prototype.playAction=function(e,t){if("relax"===e)this.fingerRelax(1,t);else if("number"==typeof e)this.discover(this.areas[e],t);else for(var n=0;n<this.areas.length;n++){
var s=this.areas[n];if(!s.discovered)return void this.discover(s,t)}},DifferencesPlayer.prototype.discover=function(e,t){var n={x:e.x,y:e.y},s=this.scene.convertToNodeSpace(this.photos[0].convertToWorldSpace(n));if(!this.finger.isShown){var i=this.scene.convertToNodeSpace(this.scene.photos.convertToWorldSpace({x:this.scene.photos.width/2,y:this.scene.photos.height/2}));this.finger.fadeIn(cc.p(i.x-cleverapps.styles.FingerView.deltaXforCircle,i.y),cc.p(i.x,0)),this.finger.delay(.1),this.finger.isShown=!0}this.finger.moveZigzag(s),s=this.scene.convertToNodeSpace(this.photos[1].convertToWorldSpace(n)),this.finger.moveTo(s),this.finger.press(),this.finger.addAction(function(e){this.scene.photos.onClick(this.photos[0].imageId,n);var t=this.photos[0];this.photos[0]=this.photos[1],this.photos[1]=t,e()}.bind(this)),this.finger.unPress(),this.finger.runOnce(t)};var Match3Player=function(e,t){GamePlayer.call(this,e,t);var n=Game.currentGame.getAdsFieldView&&Game.currentGame.getAdsFieldView()
;this.fieldView=n&&n.fieldView||cc.director.getRunningScene().fieldView,this.finger.relaxPosition=cc.director.getRunningScene().convertToNodeSpace(this.fieldView.convertToWorldSpace({x:this.fieldView.width/2,y:0})),this.finger.relaxEasing=cc.easeExponentialOut(),(Match3Player.instance=this).on("prepareForMove",this.prepareForMove.bind(this))};Match3Player.prototype=Object.create(GamePlayer.prototype),(Match3Player.prototype.constructor=Match3Player).prototype.playAction=function(c,l){if(!this.finger.isShown){var e=cleverapps.styles.ScenarioMatch3Player.startPositionOffset;return this.finger.fadeIn(cc.p(this.finger.relaxPosition.x-cleverapps.styles.FingerView.deltaXforCircle,e.y),{x:this.finger.relaxPosition.x,y:e.y}),this.finger.isShown=!0,void this.finger.runOnce(this.playAction.bind(this,c,l))}var t=function(){if(c.start&&c.finish)this.swapTwoTiles({start:c.start,dir:{row:c.finish.y-c.start.y,col:c.finish.x-c.start.x}},l);else if(-1!==c.indexOf("_")){
var e=Game.currentGame.field.findValidMove(!0),t=c.split("_").map(function(e){return parseInt(e)}),n=t[0],s=t[1],i=t[2],o=t[3],r=e.filter(function(e){return e.start.x===n&&e.start.y===s&&e.dir.row===i&&e.dir.col===o});this.swapTwoTiles(r[0]||e[0],l)}else{var a=this.findMove();this.swapTwoTiles(a,l)}}.bind(this);Game.counter.isActive()?this.waiter=cleverapps.wait(1,t):t()},Match3Player.prototype.swapTwoTiles=function(i,e){[function(t){this.finger.moveTo(t),this.finger.delay(.1),this.finger.press(),this.finger.addAction(function(e){this.fieldView.onTouchBegan(new cc.Touch(t.x,t.y,0)),e()}.bind(this))}.bind(this),function(t){this.finger.moveTo(t),this.finger.addAction(function(e){this.fieldView.onTouchMoved(new cc.Touch(t.x,t.y,0)),e()}.bind(this)),this.finger.unPress(),this.finger.addAction(function(e){this.fieldView.onTouchEnded(new cc.Touch(t.x,t.y,0)),e()}.bind(this))}.bind(this)].forEach(function(e,t){var n=0,s=0;0!==t&&(n=i.dir.col,s=i.dir.row),e(this.cellPosition(i.start.x+n,
i.start.y+s))},this),this.fingerRelax(1,e)},Match3Player.prototype.cellPosition=function(e,t){return this.finger.convertToNodeSpace(this.fieldView.convertToWorldSpace(BaseCellView.alignInTheGrid(e,t)))},Match3Player.prototype.prepareForMove=function(){this.waiter&&this.waiter()},Match3Player.prototype.findMove=function(){var e=Game.currentGame.field.findValidMove(!0),a=[];e.forEach(function(e){for(var t in Game.currentGame.goals.elements){var s=Game.currentGame.goals.elements[t];if(!s.done){var n=Game.currentGame.field.cells[e.start.y+e.dir.row][e.start.x+e.dir.col];Game.currentGame.field.swap(e.start,n,!0);var i=Game.currentGame.field.findAllShapes(e.start)[0];if(i){var o=0,r=0;i.cells.forEach(function(t){var e=Game.currentGame.field.floor[t.y][t.x];e&&e.getGoalId&&s.type===e.getGoalId()&&o++,t.getGoalId&&s.type===t.getGoalId()&&o++;var n=Game.currentGame.EATERS;n&&n.forEach(function(e){t.getColor&&e.getAcceptedColors()[0]===t.getColor()&&o++}),t.forNeighbor(function(t){!i.cells.some(
function(e){return e.x===t.x&&e.y===t.y})&&t.getGoalId&&s.type===t.getGoalId()&&r++})}),(0<o||0<r)&&a.push({move:e,shape:i,goalsAmount:o,boomGoalsAmount:r}),Game.currentGame.field.swap(e.start,n,!0)}else Game.currentGame.field.swap(e.start,n,!0)}}});var s=a.sort(function(e,t){return 10*t.goalsAmount+t.boomGoalsAmount-(10*e.goalsAmount+e.boomGoalsAmount)}).map(function(e){return e.move})[0];if(s);else{var i=0;e.forEach(function(e){var t=Game.currentGame.field.cells[e.start.y+e.dir.row][e.start.x+e.dir.col];Game.currentGame.field.swap(e.start,t,!0);var n=Game.currentGame.field.findAllShapes(e.start)[0];n&&n.cells.length>i&&(i=n.cells.length,s=e),Game.currentGame.field.swap(e.start,t,!0)})}return s||e[0]},cleverapps.styles.ScenarioMatch3Player={startPositionOffset:{y:-100}};var MergeCraftPlayer=function(e,t){GamePlayer.call(this,e,t);var n=cleverapps.styles.MergeCraftPlayer;this.map=Game.currentGame.map,this.mapView=this.map.getAdsMapView(),this.finger.replaceParent(
this.mapView.animations),this.finger.setLocalZOrder(10),this.finger.setAdditionalTransform({a:1,b:0,c:0,d:1,tx:n.fingerOffset.x,ty:n.fingerOffset.y}),this.actionsDone=0};MergeCraftPlayer.prototype=Object.create(GamePlayer.prototype),(MergeCraftPlayer.prototype.constructor=MergeCraftPlayer).prototype.playAction=function(e,t){if(Game.currentGame.counter.isActive())setTimeout(this.playAction.bind(this,e,t),50);else{console.log(e);var n=function(e){return e.type&&-1===["show_finger","zoom_to","delay"].indexOf(e.type)};if(this.options.progressChanged&&n(e))var s=function(){t(),this.options.progressChanged(++this.actionsDone/this.actions.filter(n).length)}.bind(this);else s=t;if("finish"===e)this.finger.fadeOut(),this.finger.runOnce(s);else if("show_finger"===e.type){var i=this.mapView.getCell(Map2d.LAYER_WATER,e.position.x,e.position.y)||this.mapView.getCell(Map2d.LAYER_GROUND,e.position.x,e.position.y)||this.mapView.getCell(Map2d.LAYER_UNITS,e.position.x,e.position.y);this.finger.fadeIn(
i.getPosition()),this.finger.runOnce(s)}else if("zoom_to"===e.type)this.mapView.scroll.zoomTo(e.zoom,MergeScene.SCROLL_TO_DURATION),s();else if("scroll_to"===e.type){var o=this.mapView.alignInIsometricGrid(e.cellPosition.x,e.cellPosition.y);this.mapView.scroll.scrollTo(o,void 0,s)}else if("delay"===e.type)this.finger.delay(e.delay),this.finger.runOnce(s);else if("move"===e.type)this.moveUnit(e.units,s);else if("pixel_collect"===e.type){o=Game.currentGame.adsPixelViews[e.pixelId];this.fingerClickAction(o,function(){o.collect()},{callback:s})}else if("pressed_sidebar_icon"===e.type){var r=this.finger.finger.parent;o=cleverapps.sideBar.getIconToClickOn(e.iconName,e.missionType);this.finger.finger.replaceParentSamePlace(o.parent,{keepScale:!0});var a=cleverapps.wait(2,s);this.fingerClickAction(o,function(){var e=o.getScale();o.runAction(new cc.Sequence(new cc.CallFunc(function(){o.iconView.model.onPressed(),setTimeout(function(){this.finger.finger.replaceParentSamePlace(r,{keepScale:!0}),
a()}.bind(this),200)}.bind(this)),new cc.ScaleTo(.1,.9*e),new cc.ScaleTo(.3,e).easing(cc.easeBackOut())))}.bind(this),{callback:a,doNotFollowFinger:!0})}else if(e.type===Merge.MERGE)cleverapps.config.wysiwygMode&&cleverapps.flags.wysiwyg.automerge?s():this.moveUnit(e.units,s);else if(e.type===Merge.START_MINING)this.startMining(e,s);else if(-1!==[Merge.HARVEST,Merge.COMPLETE_MINING].indexOf(e.type)){var c=this.map.getUnit(e.units[0].x,e.units[0].y),l=this.mapView.getCell(Map2d.LAYER_UNITS,c.x,c.y);this.fingerClickAction(l,c.handleClick.bind(c),{callback:s})}else if(e.type===Merge.PRIZE_HARVESTED||"chestopened"===e.type){c=this.map.getUnit(e.units[0].x,e.units[0].y),l=this.mapView.getCell(Map2d.LAYER_UNITS,c.x,c.y);this.fingerClickAction(l,function(){e.prizes&&(c.findComponent(Chest)?c.findComponent(Chest).listPrize=function(){return e.prizes}:c.prizes=e.prizes.map(function(e){return new Unit(e)})),c.handleClick()},{callback:s})}else if(e.type===Merge.MINE){l=this.mapView.getCell(
Map2d.LAYER_UNITS,e.units[0].x,e.units[0].y);this.fingerClickAction(l,function(){this.mapView.scroll.scrollTo(l,MergeScene.SCROLL_TO_DURATION),this.finger.dislodge(.5,cleverapps.styles.MergeCraftPlayer.fingerDislodgedPos)}.bind(this),{callback:s})}else s()}},MergeCraftPlayer.prototype.startMining=function(n,e){var s=cleverapps.styles.MergeCraftPlayer;cleverapps.metha.compound(e,[function(e){var t=this.mapView.getCell(Map2d.LAYER_UNITS,n.units[0].x,n.units[0].y);this.fingerClickAction(t,function(){this.getUnitView(t).handleClick(),this.finger.dislodge(.5,s.fingerDislodgedPos),setTimeout(e,1e3)}.bind(this))}.bind(this),function(e){var t=$(UseEnergyButton).get();t?this.fingerClickAction(t,function(){t.settings.onClicked(),this.finger.dislodge(.5,s.fingerDislodgedPos),setTimeout(e,1e3)}.bind(this)):setTimeout(e,500)}.bind(this),function(e){var t=$(UseGoldButton).get();t?this.fingerClickAction(t,function(){t.settings.onClicked(),this.finger.dislodge(.5,s.fingerDislodgedPos),setTimeout(e,1e3
)}.bind(this)):setTimeout(e,Worker.MINING_ANIMATION_TIME)}.bind(this)])},MergeCraftPlayer.prototype.moveUnit=function(s,e){var t=cleverapps.styles.MergeCraftPlayer,i=2<s.length,o=i&&this.map.getUnit(s[1].x,s[1].y)&&this.map.getUnit(s[2].x,s[2].y)&&this.map.getUnit(s[1].x,s[1].y).code===this.map.getUnit(s[2].x,s[2].y).code?this.map.getUnit(s[1].x,s[1].y).code:void 0,n=i?this.findCell(s[0],o,s.slice(1)):s[0],r=this.map.getUnit(n.x,n.y),a=this.mapView.getCell(Map2d.LAYER_UNITS,n.x,n.y).getPosition();this.finger.addAction(function(e){this.keepFingerInCenter(n,this.finger.getMoveDuration(a),e)}.bind(this)),this.finger.moveTo(a),this.finger.press();var c=void 0;this.finger.addAction(function(e){var t=i?this.findCell(s[0],o,s.slice(1)):s[0],n=this.mapView.getCell(Map2d.LAYER_UNITS,t.x,t.y);(c=this.getUnitView(n)).handleDragStart(),setTimeout(e,300)}.bind(this)),this.finger.addAction(function(e){c.setLocalZOrder(-1),this.finger.scheduleUpdate(),this.finger.update=function(e){if(e.setPosition(
this.finger.finger.x,this.finger.finger.y),this.finger.pressed){var t=this.mapView.getCellByCoordinates(this.finger.finger);e.unit.handleDragMove(t.x,t.y)}}.bind(this,c),e()}.bind(this));var l=i?this.findCell(s[1],o):s[1],p=this.mapView.getCell(Map2d.LAYER_UNITS,l.x,l.y),d=p.getPosition(),u=cc.p(d);if(i){var h=this.mapView.getCell(Map2d.LAYER_UNITS,s[s.length-1].x,s[s.length-1].y).getPosition();u.x=(d.x+h.x)/2+t.mergeOffset.x*(a.x>d.x?1:-1),u.y=(d.y+h.y)/2+t.mergeOffset.y*(a.y>d.y?1:-1)}i&&r&&r.stage===Families[r.code].units.length-2?this.finger.addAction(function(e){this.mapView.scroll.scrollTo(p,this.finger.getMoveDuration(u)),e()}.bind(this)):this.finger.addAction(function(e){this.keepFingerInCenter(l,this.finger.getMoveDuration(u),e)}.bind(this)),this.finger.moveTo(u),this.finger.unPress(),this.finger.addAction(function(e){c.setLocalZOrder(0),this.finger.unscheduleUpdate();var t=this.mapView.getCellByCoordinates(d);c.unit.handleDragMove(t.x,t.y),c.unit.handleDragEnd(),e()}.bind(
this)),this.finger.dislodge(i?1.5:.5,t.fingerDislodgedPos),this.finger.runOnce(e)},MergeCraftPlayer.prototype.fingerClickAction=function(e,t,n){var s=(this.finger.finger.parent!==this.finger?this.finger.finger:this.mapView.animations).getRelativeCoordinates(e);n.doNotFollowFinger||this.finger.addAction(function(e){this.keepFingerInCenter(this.mapView.getCellByCoordinates(s),this.finger.getMoveDuration(s),e)}.bind(this)),this.finger.moveTo(s),this.finger.press(),this.finger.addAction(function(e){t(),e()}),this.finger.unPress(),this.finger.runOnce(n.callback)},MergeCraftPlayer.prototype.findCell=function(e,t,n){for(var s=[{x:0,y:0},{x:-1,y:0},{x:-1,y:-1},{x:0,y:-1},{x:1,y:-1},{x:1,y:0},{x:1,y:1},{x:0,y:1},{x:-1,y:1}],i=0;i<s.length;i++){var o=e.x+s[i].x,r=e.y+s[i].y;if(!(n&&0<n.filter(function(e){return e.x===o&&e.y===r}).length)){var a=this.map.getUnit(o,r);if(!t||!a||a.code===t){var c=this.mapView.getCell(Map2d.LAYER_UNITS,o,r),l=c?this.getUnitView(c):void 0;if(a&&c&&l)return new cc.p(
o,r)}}}return e},MergeCraftPlayer.prototype.keepFingerInCenter=function(e,t,n){var s=this.mapView.convertToNodeSpace(this.finger.convertToWorldSpace(this.finger.getFingerPosition())),i=this.mapView.getCellByCoordinates(s);if(2<Math.sqrt(Math.pow(i.x-e.x,2)+Math.pow(i.y-e.y,2))){var o=this.mapView.alignInIsometricGrid(e.x,e.y);this.mapView.scroll.scrollTo(o,t),setTimeout(n,400*t)}else n()},MergeCraftPlayer.prototype.getUnitView=function(e){for(var t,n=0;n<e.children.length;n++)if(e.children[n]instanceof UnitView){t=e.children[n];break}return t},cleverapps.styles.MergeCraftPlayer={fingerOffset:{x:30,y:-21},mergeOffset:{x:22,y:27},fingerDislodgedPos:{x:100,y:-100}};var ScramblePlayer=function(e,t){BoardPlayer.call(this,e,t),this.finger.replaceParent(this.keypadView.getParent()),this.finger.relaxPosition={y:cleverapps.styles.ScenarioScramblePlayer.relaxedFinger.offsetY}};ScramblePlayer.prototype=Object.create(BoardPlayer.prototype),(ScramblePlayer.prototype.constructor=ScramblePlayer
).prototype.openWord=function(e,t,n){var s=Game.currentGame.keypad.findWordIndexes(e);s?(s.forEach(function(t,e){var n=BaseBlockView.alignInTheGrid(t.x,t.y),s=this.finger.parent.convertToNodeSpace(this.keypadView.lettersContainer.convertToWorldSpace(n));0!==e||this.finger.isShown||(this.finger.fadeIn(s),this.finger.isShown=!0),this.finger.moveTo(s),0===e?(this.finger.press({noCircle:!0}),this.finger.addAction(function(e){Game.currentGame.keypad.touchBegan(t),e()}.bind(this))):this.finger.addAction(function(e){Game.currentGame.keypad.push(t),e()}.bind(this))},this),this.finger.unPress(),this.finger.addAction(function(e){Game.currentGame.keypad.touchEnded(),e()}.bind(this)),this.fingerRelax(.15*(s.length+4),n)):n()},cleverapps.styles.ScenarioScramblePlayer={relaxedFinger:{offsetY:-100}};var SolitairePlayer=function(e,t){GamePlayer.call(this,e,t),Hand.JOKER_POSITION_IN_HAND=0,this.cardTableView=$(CardTableView).get(),this.handView=$(HandView).get(),this.comboView=$(ComboView).get(),
this.finger.relaxPosition={x:this.scene.width+this.finger.finger.width}};SolitairePlayer.prototype=Object.create(GamePlayer.prototype),(SolitairePlayer.prototype.constructor=SolitairePlayer).prototype.playAction=function(e,t){var n=Card.parse(e);"hand"===e?this.playHandCard(t):"finish"===e?this.fingerFadeOut(function(){setTimeout(t,500)}):"relax"===e?this.fingerRelax(1,t):n?this.playTableCard(n,t):this.playAnyAction(t)},SolitairePlayer.prototype.playAnyAction=function(e){var t=Game.currentGame,n=t.open.getCurrentCard(),s=n&&t.table.listMissed(n)||[];s=cleverapps.Random.shuffle(s.slice());var i=t.hand.stack;0<s.length?this.playTableCard(s[0],e):0<i.length?this.playHandCard(this.playAnyAction.bind(this,e)):e()},SolitairePlayer.prototype.playTableCard=function(n,s){console.log("tableCards",this.game.table.getScreen().cards.filter(function(e){return e.isOpen()}).map(function(e){return Card.VALUES[e.value]+e.suit}));var i=5e3,o=function(){var e=this.getOpenedCardView(n);if(
!e&&this.getCardView(n)&&0<i)return i-=100,void setTimeout(o,100);var t=function(){this.game.table.cardClicked(e.card)}.bind(this);this.fingerAction(e,t,s,SolitairePlayer.SETTINGS.extraMove)}.bind(this);o()},SolitairePlayer.prototype.getOpenedCardView=function(e){return this.getCardView(e,!0)},SolitairePlayer.prototype.getCardView=function(t,n){return t=Card.parse(t),this.cardTableView.getChildren()[0].getChildren().filter(function(e){for(;e.innerCardView;)e=e.innerCardView;return e.card&&e.card.value===t.value&&e.card.suit===t.suit&&(!n||e.card.isOpen())})[0]},SolitairePlayer.prototype.playHandCard=function(e){var t=this.handView.cardViews[this.handView.cardViews.length-1],n=function(){this.game.shiftCard()}.bind(this);this.fingerAction(t,n,e)},SolitairePlayer.prototype.fingerAction=function(e,t,n,s){var i=this.scene.getRelativeCoordinates(e);0===this.finger.finger.opacity&&this.finger.fadeIn(i),this.finger.moveTo(i),this.finger.press(),this.finger.addAction(function(e){t(),e()}),
this.finger.unPress(),s&&this.finger.moveTo(s),this.finger.runOnce(n)},SolitairePlayer.SETTINGS={extraMove:!1,durations:{combo:.7,lockOpen:2.2,extraCards:1,fillHand:.8}};var FingerControl={pointToLocation:function(e,t,n){var s=new FingerViewEx;e.addChild(s),s.setLocalZOrder(999),s.fadeIn(t),s.delay(.5),s.press(),s.addAction(function(e){cleverapps.audio.playSound(bundles.main.urls.click_effect),e()}),s.unPress(),s.fadeOut(),s.run({looped:!1,onFinish:function(){s.removeFromParent(),n&&n()}})},pointTo:function(e,t,n,s){var i=cc.director.getRunningScene().scene,o=i.getRelativeCoordinates(e),r=new FingerViewEx;i.addChild(r),r.setLocalZOrder(999),r.fadeIn({x:o.x,y:o.y}),r.delay(.5),r.press(),r.addAction(function(e){t&&t(),e()}),r.unPress(),r.addAction(function(e){n&&n(),e()}),r.fadeOut(),r.run({looped:!1,onFinish:function(){r.removeFromParent(),s&&s()}})}};FingerControl.MainScene={pressPlayButton:function(e){var t=$(PlayButtonView).get();FingerControl.pointTo(t,function(){
t.button&&t.button.onTouchBegan(),cleverapps.audio.playSound(bundles.main.urls.click_effect)},function(){t.button&&t.button.onTouchEnded()},function(){e()})},pressCurrentLevel:function(e){FingerControl.MainScene.pressLevel(levels.user.level,e)},pressLevel:function(n,s){$(PagesView).get().container.getChildren().forEach(function(e){if(e.pageNo===levels.user.episode){var t=e.levelViews[n];FingerControl.pointTo(t,function(){t.onTouchBegan(),cleverapps.audio.playSound(bundles.main.urls.click_effect)},function(){t.onTouchEnded()},function(){s()})}})},pressToolbarItem:function(t,n){$(ToolbarView).get().itemsViews.forEach(function(e){e.toolbarItem instanceof t&&FingerControl.pointTo(e,function(){e.toolbarItem.onClick(),n()})})}},FingerControl.VictoryWindow={pressButton:function(e,t,n){var s=$(e).get();FingerControl.pointTo(s,function(){t&&s.action(),n()})}},FingerControl.BeatFriendWindow={pressButton:function(e,t){var n=$(e).get();FingerControl.pointTo(n,function(){n.action(),t()})}},
FingerControl.LeadersWindow={pressTab:function(e,t){var n=cleverapps.windows.currentWindow();n&&FingerControl.pointTo(n.tabs.buttonsById[e],function(){n.tabs.activateTab(e),t()})}};var FingerViewEx=FingerView.extend({ctor:function(e){e=e||{},cleverapps.environment.isGameScene()&&0<=["board","match3"].indexOf(cleverapps.config.type)&&"scramble"!==cleverapps.config.name&&(e.pathColor=cleverapps.styles.COLORS.PATH_COLOR,"match3"===cleverapps.config.type&&(cleverapps.bundleLoader.isLoaded("screenshots")?cleverapps.overrideStyles(cleverapps.styles.Path,{image:bundles.screenshots.frames.line_png}):e.pathColor=void 0)),this._super(e),e.image||(this.finger.setTexture(),this.noCircle=!0),this.moveSpeed=FingerViewEx.MOVE_SPEED[cleverapps.config.name]||FingerViewEx.MOVE_SPEED[cleverapps.config.type]||FingerViewEx.MOVE_SPEED.default},getMoveDuration:function(e){var t=cc.pDistance(e,this.finger)/this.moveSpeed;return t=(t+.3)/(t+1.3),this.isRelaxed&&(t=.3),t},moveTo:function(s){this.addAction(
function(e){var t=this.getMoveDuration(s),n=void 0;n="scramble"!==cleverapps.config.name||this.isRelaxed?"tripeaks"!==cleverapps.config.name||this.isRelaxed?"mergecraft"!==cleverapps.config.name||this.isRelaxed?new cc.MoveTo(t,s).easing(cc.easeExponentialInOut()):new cc.MoveTo(t,s).easing(cc.easeQuadraticActionInOut()):new cc.MoveTo(t,s).easing(cc.easeInOut(3)):new cc.MoveTo(t,s),this.finger.runAction(new cc.Sequence(n,new cc.CallFunc(function(){this.pressed&&this.pathNode&&this.pathNode.push(s),this.isRelaxed=!1,e()}.bind(this))))}.bind(this))},relax:function(s,e){this.addAction(function(e){var t=0,n=0;this.relaxPosition&&(t="number"==typeof this.relaxPosition.x?this.relaxPosition.x:this.finger.x,n="number"==typeof this.relaxPosition.y?this.relaxPosition.y:this.finger.y),this.finger.runAction(new cc.Sequence(new cc.MoveTo(s,cc.p(t,n)).easing(this.relaxEasing||cc.easeCircleActionOut()),new cc.CallFunc(function(){this.isRelaxed=!0,e()}.bind(this))))}.bind(this))},moveZigzag:function(l){
this.addAction(function(e){var t=this.finger.getPosition(),o=function(e,t){return cc.p((e.x+t.x)/2,(e.y+t.y)/2)},n=function(e,t,n){var s=o(e,t),i=-1/((t.y-e.y)/(t.x-e.x));return cc.p(s.x+Math.cos(Math.atan(i))*n,s.y+Math.sin(Math.atan(i))*n)},s=.618*Math.sqrt(Math.pow(l.x-t.x,2)+Math.pow(l.y-t.y,2)),i=.618*-s,r=o(t,l),a=n(t,r,s),c=n(r,l,i);this.finger.runAction(new cc.Sequence(new cc.BezierTo(1.3,[t,a,r]).easing(cc.easeSineIn()),new cc.BezierTo(.8,[r,c,l]).easing(cc.easeQuinticActionOut()),new cc.CallFunc(function(){e()}.bind(this))))}.bind(this))},dislodge:function(t,n,s){this.addAction(function(e){this.finger.runAction(new cc.Sequence(new cc.MoveBy(t,n).easing(cc.easeQuarticActionOut()),new cc.CallFunc(function(){s&&s(),e()}.bind(this))))}.bind(this))},press:function(e){(e=e||{}).noCircle=this.noCircle,this._super(e)}});FingerViewEx.MOVE_SPEED={default:750,board:1200,match3:900,merge:400,tripeaks:1e3,scramble:2200},cleverapps.Tool.game={win:function(){
var e=cc.director.getRunningScene(),t=e.game;e instanceof GameSceneBase&&t&&t.win()},gun:function(){cleverapps.gun.isAvailable()&&cleverapps.metha.display({focus:"toolGun",control:cleverapps.gun.getControls(),action:function(e){cleverapps.gun.onExecute(e)}})}},function(){var e=cleverapps.getRequestParameters(location.hash);if(e.importUserId&&(cleverapps.isLocalhost()||cleverapps.isStagingHost())){var n=e.importUserId,s=e.stand;cleverapps.FakeFacebook.prototype.isLoggedIn=cleverapps.BaseFB.prototype.isLoggedIn=function(){return!0},Subscription.prototype.getLeftTime=function(){return cleverapps.parseInterval(Subscription.REWARD_INTERVAL)},cleverapps.DataLoader.resetClientSession=function(){cleverapps.DataLoader.alerted=!0,cleverapps.DataLoader.enabled=!1,cleverapps.DataLoader.corrupted=!1},ExitControlButton.isAvailableAtSceneSuper=ExitControlButton.isAvailableAtScene,ExitControlButton.isAvailableAtScene=function(){return!cleverapps.environment.isMainScene(
)&&ExitControlButton.isAvailableAtSceneSuper()},"merge"!==cleverapps.config.type||e.loadQuests||(Quests.prototype.create=function(){}),-1!==["differences","olympics"].indexOf(cleverapps.config.name)&&(KnockoutGame.prototype.checkConnection=function(e){e()}),cleverapps.Synchronizer.prototype._sync=function(){cleverapps.Synchronizer.prototype._sync=function(){},cleverapps.Synchronizer.prototype.showClientSessionExpiredWindow=function(){};var e=(s?projects[cleverapps.config.name].basic.stand.deployment+"/":projects[cleverapps.config.name].basic.deployment+"/")+cleverapps.config.name+"-rest/importsync/"+n,t={version:cleverapps.config.version};cleverapps.RestClient.post(e,t,function(e){if(!e.sync)throw"No user data - "+n;cleverapps.synchronizer._loadedSync=e.sync,e.settings&&e.settings.language&&(cleverapps.settings.setLanguage(e.settings.language),Messages.preload(e.settings.language,function(){})),cleverapps.synchronizer._syncIn.process()}),Object.keys(Forces).forEach(function(e){
"object"==typeof Forces[e]&&void 0!==Forces[e].id&&cleverapps.forces.shownForces.push(Forces[e].id)}),cleverapps.flags.norest=!0,cleverapps.flags.nologin=!0}}}();var LevelViewEditor=LevelView.extend({onPressed:function(){LevelManager.getInstance().setLevel({episodeNo:this.level.episodeNo,levelNo:this.level.levelNo}),LevelManager.getInstance().editLevel()}});LevelViewEditor.generateLevelId=LevelView.generateLevelId;var Chooser=cc.Node.extend({ctor:function(e,t){this._super(),this.table=e,this.options=t||{},this.onSelect=function(e,t){},this.onBeforeSelect=function(e,t){};var n=[];for(var s in this.initViews={},e){var i=e[s];this.initViews[s]=i,this.addChildForKey(i,s),n.push(i)}for(var o=this.options.columns||8,r=[],a=0;a<n.length;a+=o)r.push(n.slice(a,a+o));r.reverse();var c=r.map(function(e){return e[0]}),l=cleverapps.UI.arrangeWithMargins(c,{direction:cleverapps.UI.VERTICAL}),p=0;if(r.forEach(function(e){var t=e[0],n=cleverapps.UI.arrangeWithMargins(e,{margin:this.options.margin,
direction:cleverapps.UI.HORIZONTAL,y:t.y});p<n&&(p=n)}.bind(this)),this.setAnchorPoint(.5,.5),this.setContentSize(p,l),this.setLocalZOrder(100),this.options.bg){var d=cleverapps.UI.createScale9Sprite(this.options.bg);d.setContentSize(this.getContentSize()),d.setPosition(this.width/2,this.height/2),d.setLocalZOrder(-1),this.addChild(d)}this.options.removeOnAsideClick&&cc.eventManager.addListener({event:cc.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:!1,onTouchBegan:function(e){var t=this.convertTouchToNodeSpace(e);if(!cc.rectContainsPoint(cc.rect(0,0,this.width,this.height),t))return this.removeFromParent(),!1}.bind(this)},this)},setSelected:function(e){this.selected&&(this.removeSelection(this.selected),this.subChooser&&this.subChooser.removeFromParent()),void 0!==(this.selected=e)&&this.showSelected(e)},showSelected:function(e){var t=this.table[e];this.options.scaleSelected?t.setScale(this.options.scaleSelected):(t.selection=new cc.Sprite(
bundles.editor?bundles.editor.frames.editor_select:bundles.avatar.frames.avatar_frame),t.selection.setScale(Math.max(t.height,t.width)/t.selection.height),t.selection.setPosition(t.width/2,t.height/2),t.selection.setLocalZOrder(4),t.addChild(t.selection))},removeSelection:function(e){var t=this.table[e];this.options.scaleSelected?t.setScale(1):(t.selection.removeFromParent(),delete t.selection)},addChildForKey:function(n,s){this.addChild(n),this.options.noControl||cc.eventManager.addListener({event:cc.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:!0,onTouchBegan:function(e){if(!this.visible)return!1;var t=n.convertTouchToNodeSpace(e);return cc.rectContainsPoint(cc.rect(0,0,n.width,n.height),t)?(this.runAction(new cc.Sequence(new cc.DelayTime(0),new cc.CallFunc(function(){if(this.onBeforeSelect.call(this,s,n),!this.disabled){if(this.selected&&s===this.selected)return this.removeSelection(this.selected),this.selected=void 0,void(this.subChooser&&this.subChooser.removeFromParent())
;this.setSelected(s),this.onSelect.call(this,s,n)}}.bind(this)))),!0):(n===this.initViews[s]&&s===this.selected&&(this.subChooser&&this.subChooser.removeFromParent(),this.setSelected(s)),!1)}.bind(this)},n)}}),TabMenu=cc.Node.extend({ctor:function(e,t){this._super(),this.table=e,this.buttonByPage={};var n=Object.keys(this.table).map(function(e,t){var n=new cleverapps.UI.Button({button_png:bundles.editor.frames.editor_tabs_button_off,button_on_png:bundles.editor.frames.editor_tabs_button_off,button_off_png:bundles.editor.frames.editor_tabs_button_off,text:e,font:cleverapps.styles.FONTS.EDITOR_TEXT,width:cleverapps.styles.EditorTabMenu.buttons.width,onClicked:function(){this.setActive(e)}.bind(this)});return n.text.setColor(cc.color(101,147,216,255)),this.addChild(n),this.buttonByPage[e]=n,0===t&&(n.button_png=new cc.Sprite(bundles.editor.frames.editor_tabs_button_on),n.setBright(!0)),n},this),s=cleverapps.UI.arrangeWithMargins(n,{direction:cleverapps.UI.HORIZONTAL,
y:cleverapps.styles.EditorTabMenu.buttons.y,margin:cleverapps.styles.EditorTabMenu.buttons.margin});for(var i in this.setAnchorPoint(.5,.5),this.setContentSize(s,n[0].height),this.table)this.addChild(this.table[i]),this.table[i].alignment||this.table[i].setPositionRound(this.width/2,this.height/2),this.table[i].setVisible(!1);if(this.active=void 0,this.setActive(Object.keys(this.table)[0]),t&&t.background){var o=new cc.Scale9Sprite(t.background);o.setContentSize(cleverapps.styles.EditorTabMenu.bg),o.setPositionRound(cleverapps.styles.EditorTabMenu.bg),o.setAnchorPoint2(),this.addChild(o,-1)}},getCurrentView:function(){if(this.active)return this.table[this.active]},setActive:function(e){this.active&&(this.getCurrentView().setVisible(!1),this.buttonByPage[this.active].button_png=new cc.Sprite(bundles.editor.frames.editor_tabs_button_off),this.buttonByPage[this.active].setBright(!1)),this.active=e,this.getCurrentView().setVisible(!0),this.buttonByPage[e].button_png=new cc.Sprite(
bundles.editor.frames.editor_tabs_button_on),this.buttonByPage[this.active].setBright(!0)}});cleverapps.styles.EditorTabMenu={buttons:{width:230,y:200,margin:10},bg:{width:486,height:740,x:{align:"center"},y:{align:"center",dy:-160}}};var IncDecBlock=cc.Node.extend({ctor:function(t){this._super(),this.setCascadeOpacityEnabled(!0);var n=cleverapps.UI.generateTTFText("",cleverapps.styles.FONTS.EDITOR_TEXT);t.color&&n.setColor(t.color),this.addChild(n),this.number=n;var e=t.radius||cleverapps.styles.EditorIncDecBlock.radius;t.onChange&&cleverapps.UI.onClick(n,function(){var e=window.prompt("",n.getString());e&&t.onChange(parseInt(e))}),t.rate=t.rate||1;var s=this.decButton=new cleverapps.UI.Button({button_png:bundles.editor.frames.editor_button_off,button_on_png:bundles.editor.frames.editor_button_on,button_off_png:bundles.editor.frames.editor_button_off,content:new cc.Sprite(t.decIcon||bundles.editor.frames.editor_minus_icon),noThrottle:!0,hint:t.hint,onClicked:function(){
t.onDec&&t.onDec(),t.onChange&&t.onChange(this.getValue()-t.rate)}.bind(this)});s.setPosition(-e,cleverapps.styles.EditorIncDecBlock.yOffset),this.addChild(s);var i=this.incButton=new cleverapps.UI.Button({button_png:bundles.editor.frames.editor_button_off,button_on_png:bundles.editor.frames.editor_button_on,button_off_png:bundles.editor.frames.editor_button_off,content:new cc.Sprite(t.incIcon||bundles.editor.frames.editor_plus_icon),noThrottle:!0,hint:t.hint,onClicked:function(){t.onInc&&t.onInc(),t.onChange&&t.onChange(this.getValue()+t.rate)}.bind(this)});i.setPosition(e,cleverapps.styles.EditorIncDecBlock.yOffset),this.addChild(i),t.value&&this.setValue(t.value),t.buttonsScale&&(i.setScale(t.buttonsScale),i.baseScale=t.buttonsScale,s.setScale(t.buttonsScale),s.baseScale=t.buttonsScale)},getValue:function(){var e=this.number.getString(),t=void 0!==this.autoValue?this.autoValue:0;return"auto"===e?t:parseInt(this.number.getString())},setValue:function(e,t){t&&(this.autoValue=e)
;var n=t&&cleverapps.styles.FONTS.INCDECBLOCK_AUTO_TEXT||cleverapps.styles.FONTS.EDITOR_TEXT;e=t?"auto":e,cleverapps.UI.ImageFont.intertypeSetString({textObj:this.number,string:e,font:n,recreateFunc:function(){this.number.removeFromParent(),this.number=cleverapps.UI.generateTTFText(e,n),this.addChild(this.number)}.bind(this)})}});cleverapps.styles.EditorIncDecBlock={radius:70,yOffset:5};var Slider=ccui.Slider.extend({ctor:function(){this._super(),this.setTouchEnabled(!0),this.setScale9Enabled(!0),this.loadBarTexture(bundles.editor.frames.editor_slider,ccui.Widget.PLIST_TEXTURE),this.loadSlidBallTextures(bundles.editor.frames.editor_slider_pointer,bundles.editor.frames.editor_slider_pointer,"",ccui.Widget.PLIST_TEXTURE),this.loadProgressBarTexture(bundles.editor.frames.editor_slider,ccui.Widget.PLIST_TEXTURE),this.percentChangeCallback=void 0,this.incPercentCallback=void 0,this.decPercentCallback=void 0,this.addEventListener(function(e,t){
t===ccui.Slider.EVENT_PERCENT_CHANGED&&this.percentChangeCallback&&this.percentChangeCallback(e)},this)},onTouchBegan:function(e,t){var n=ccui.Slider.prototype.onTouchBegan.call(this,e,t),s=this.convertTouchToNodeSpace(e),i=this.visible&&cc.rectContainsPoint(cc.rect(0,0,this.width,this.height),s);if(!this._hit&&this._touchBeganPosition&&i){var o=this._slidBallNormalRenderer.convertToNodeSpace(this._touchBeganPosition);0<o.x&&this.incPercentCallback&&this.incPercentCallback(),o.x<0&&this.decPercentCallback&&this.decPercentCallback()}return n}});Level.prototype.edit=function(){cleverapps.metha.display({focus:"LevelPressedEditor",actions:[function(e){this.load(e)}.bind(this),function(e){this.loadStatistics(e)}.bind(this),function(e){EditorScene.open({level:this,callback:e})}.bind(this)]})},Level.prototype.loadStatistics=function(t){if("merge"!==cleverapps.config.type){var n=this.episode.getLevelHashes(this.levelNo),e=Object.keys(n).join(",");this.playedProductionMaxVersion=-1
;var s=function(e){e.forEach(function(e){this.playedProductionMaxVersion=Math.max(this.playedProductionMaxVersion,parseInt(n[e.hash].version))}.bind(this)),t()}.bind(this);cleverapps.RestClient.get(DataSource.ReleaseAdminPath("basic/")+e,{},s)}else t()},"undefined"!=typeof Loader&&void 0===Loader.prototype._loadNext&&(Loader.prototype._loadNext=Loader.prototype.loadNext,Loader.prototype.loadNext=function(e,t,n){if(cleverapps.environment.isEditorScene()){var s;if(n[0]===Loader.WILDCARD)return(s=new EditorRandomCell(t,e)).load(n,this),s;if(n[0]===BombCell.CODES[0]&&n[2]===Loader.WILDCARD)return(s=new EditorBombRandomCell(t,e)).load(n,this),s;if(n[0]===FireworkCell.CODES[0]&&n[2]===Loader.WILDCARD)return(s=new EditorFireworkRandomCell(t,e)).load(n,this),s;if(n[0]===WaffleCell.CODES[0]&&n[1]===Loader.WILDCARD)return(s=new EditorWaffleRandomCell(t,e)).load(n,this),s;if(n[0]===TruffleCell.CODES[0]&&(n[2]===Loader.WILDCARD||n[1]===Loader.WILDCARD))return(s=new EditorTruffleRandomCell(t,e,n[1]
)).load(n,this),s;if(n[0]===LollipopCell.CODES[0]&&n[1]===Loader.WILDCARD)return(s=new EditorLollipopRandomCell(t,e)).load(n,this),s;if(n[0]===BagDecoratorCell.CODES[0]&&n[1]===Loader.WILDCARD)return(s=new EditorBagDecoratorRandomCell(t,e)).load(n,this),s;if(n[0]===ColorCookieManCell.CODES[0]&&n[1]===Loader.WILDCARD)return(s=new EditorColorCookieManRandomCell(t,e)).load(n,this),s;if(n[0]===ColorBombCell.CODES[0]&&n[2]===Loader.WILDCARD)return(s=new EditorColorBombRandomCell(t,e)).load(n,this),s;if(n[0]===SmallPetardCell.CODES[0]&&n[2]===Loader.WILDCARD)return(s=new EditorSmallPetardRandomCell(t,e)).load(n,this),s}return this._loadNext(e,t,n)});var EditorScene=GameSceneBase.extend({ctor:function(e){if(cleverapps.config.editorMode&&cleverapps.environment.setScene(cleverapps.Environment.SCENE_EDITOR),LevelManager.getInstance().updateLoadedLevel(e),this.level=e,this.game=new Game(e),cleverapps.FixedWidthScene.prototype.ctor.call(this,cleverapps.Environment.SCENE_EDITOR),
this.editor=new Editor,Editor.currentEditor=this.editor,Game.currentGame.started=!0,"undefined"!=typeof EditorController)new EditorController(this.editor,this);else{var t=new EditorView(this.editor);this.scene.addChild(t)}this.editor.load(),this.addSideBar()},closeAction:function(){EditorScene.close()},initPool:function(){},saveCellSkin:function(){this.level.content.cellSkins=this.editor.cellSkins},addSideBar:function(){if("merge"===cleverapps.config.type){var e=new SideBarView;e.setPositionRound(this.scene.width/2,this.scene.height/2),e.setLocalZOrder(1),this.scene.addChild(e)}}});EditorScene.BUNDLES=function(e){var t=GameScene.BUNDLES(void 0,e),n=Editor.BUNDLES.filter(function(e){return bundles[e]});return cleverapps.unique(t.concat(n).concat(["editor"]))},EditorScene.close=function(){return void 0!==UnitsChooser&&UnitsChooser.currentChooser&&(UnitsChooser.currentChooser.stop(),UnitsChooser.currentChooser=void 0),Game.currentGame&&(Game.currentGame.stop(),Game.currentGame=void 0),
cleverapps.config.adminMode?(cleverapps.config.editorMode=!1,void AdministratorScene.open(!0)):cleverapps.config.wysiwygMode?(cleverapps.config.editorMode=!1,void WysiwygScene.open(cleverapps.wysiwyg,cleverapps.wysiwyg.hierarchy.selectedItem?cleverapps.wysiwyg.hierarchy.selectedItem.id:void 0)):void cleverapps.metha.display({focus:"EditorSceneClose",action:cleverapps.metha.gotoMainScene})},EditorScene.open=function(e){var t;e.level?t=e.level:(LevelManager.getInstance().setLevel({episodeNo:e.episodeNo,levelNo:e.levelNo}),t=LevelManager.getInstance().level),cleverapps.config.editorMode=!0,e.callback?cleverapps.scenes.replaceScene(new EditorScene(t),e.callback):cleverapps.metha.display({focus:"EditorSceneOpen",action:function(e){cleverapps.scenes.replaceScene(new EditorScene(t),e)}})},EditorScene.IS_WIDE=!0;var EditorBase=function(){this.loading=!0,this.history=[]};EditorBase.prototype.save=function(){if(!this.loading&&this.prepareEdit()){var e=LevelManager.getInstance(),t=e.level
;e.update(this.getSaveData()),e.save(function(){t.logEntry?t.logEntry.updateData():t.logEntry=cleverapps.administrator.log.createEntry({type:AdminLog.EDIT_LEVEL,episodeNo:e.level.episodeNo,levelNo:e.level.levelNo})})}},EditorBase.prototype.getSaveData=function(){var e={hard:this.hard};return this.creationTime&&(e.creationTime=this.creationTime),e},EditorBase.prototype.load=function(){var e=LevelManager.getInstance().level;void 0===LevelManager.getInstance().version&&LevelManager.getInstance().setVersion(LevelManager.getInstance().getMaxVersion()),this.setHardMode(!!e.content.hard),e.content.creationTime&&(this.creationTime=e.content.creationTime),this._load(e.content),this.resetHistory(),this.loading=!1},EditorBase.prototype.prepareEdit=function(){return this.loading||LevelManager.getInstance().prepareEdit()},EditorBase.prototype.setHardMode=function(e){this.hard=e},EditorBase.prototype.undoHistory=function(){this.history.reverse(),this.history.forEach(function(e){e()}),
this.resetHistory()},EditorBase.prototype.resetHistory=function(){this.history=[]},EditorBase.prototype.clear=function(){this.save()};var EditorViewBase=cc.Node.extend({ctor:function(e){this._super(),this.editor=e;var t=cc.director.getWinSize();if(this.setContentSize(t.width,t.height),this.setAnchorPoint(.5,.5),this.setPosition(t.width/2,t.height/2),"merge"!==cleverapps.config.type){var n=new EditorLevelView(e);this.addChild(n)}if("merge"!==cleverapps.config.type){var s=new EditorControlsView(e);this.addChild(s)}}});cleverapps.overrideFonts(cleverapps.styles.FONTS,{EDITOR_GREEN_TEXT:{size:40,color:cleverapps.styles.COLORS.GREEN},EDITOR_TEXT:{size:30,color:cleverapps.styles.COLORS.WHITE},EDITOR_BLUE_TEXT:{size:22,color:cc.color(101,147,216,255)}});var LevelManager=function(){this.needSave=!1,this.saveListeners=[]};LevelManager.prototype.updateLoadedLevel=function(){this.levelVersions=this.episode.getLevelVersions(this.level.levelNo)},LevelManager.prototype.setLevel=function(e){
this.episode&&this.episode.destructor(),cleverapps.bundleLoader.clearUnusedResources(),e.copyData=!0,this.episode=new Episode(e.episodeNo,e.levelNo,e),this.level=this.episode.getLevel(),this.level.load(this.updateLoadedLevel.bind(this),!0),this.setVersion(void 0),levels.episodes.setCurrentEpisode(this.episode.episodeNo)},LevelManager.getInstance=function(){return LevelManager.currentManager?LevelManager.currentManager:LevelManager.currentManager=new LevelManager},LevelManager.prototype.playLevel=function(t){if(levels.episodes&&levels.episodes.reset(),cleverapps.config.adminMode&&cleverapps.setUrlHash({playLevel:!0}),levels.episodes.setCurrentEpisode(this.episode.episodeNo),cleverapps.isKnockoutGame()){var n=cleverapps.metha.getMainObject().knockoutGame;return n.isRumble()||(n.rumble=new Rumble),void n.rumble.whenInitialize(function(e){e?this.level.play(t):n.onRumbleInitFailed()}.bind(this))}this.level.play(t)},LevelManager.prototype.editLevel=function(){this.level.edit()},
LevelManager.prototype.setVersion=function(e){this.version=e},LevelManager.prototype.getMaxVersion=function(){return this.episode.getMaxVersion(this.episode.getLevelVersions(this.level.levelNo))},LevelManager.prototype.prepareEdit=function(){return void 0===this.version?(this.showAlertMessage("Unknown version."),!1):this.version<this.getMaxVersion()?(this.showAlertMessage("You must edit last version."),!1):this.version!==this.level.playedProductionMaxVersion||(confirm("Create new version for edit.")&&(this.createNewVersion(),this.editLevel()),!1)},LevelManager.prototype.showAlertMessage=cleverapps.throttle(100,function(e){alert(e)}),LevelManager.prototype.createNewVersion=function(){var e=this.getMaxVersion();if(e>this.level.playedProductionMaxVersion)this.showAlertMessage("Level hasn't played on production yet. You can't increase version!");else{var t=cleverapps.clone(this.levelVersions[e],!0);t.creationTime=(new Date).toString(),this.setVersion(e+1),this.update(t),this.save(function(
){cleverapps.administrator.log.createEntry({type:AdminLog.CREATE_LEVEL_VERSION,episodeNo:t.episodeNo,levelNo:t.levelNo,version:t.version})})}},LevelManager.prototype.resetLevel=function(){this.update(cleverapps.clone(this.episode.getLevels(),!0)[this.level.levelNo]),this.save()},LevelManager.prototype.update=function(e){e.episodeNo=cleverapps.castType(this.level.episodeNo),e.levelNo=this.level.levelNo,e.version=this.version||this.getMaxVersion(),this.levelVersions[e.version]=e,this.episode.getLevels()[e.levelNo]=cleverapps.values(this.levelVersions)},LevelManager.prototype.saveToStorage=function(e){var t=this.episode.getLevels();cleverapps.extend(t[this.level.levelNo],e),cleverapps.administrator?cleverapps.administrator.adminEpisodes.saveToStorage(this.episode.episodeNo,t):AdminEpisodes.SaveToStorage(this.episode.episodeNo,t)},LevelManager.prototype.save=function(e){if(e&&this.saveListeners.push(e),this.inSaveNow)this.needSave=!0;else{this.inSaveNow=!0,this.needSave=!1
;var t=this.saveListeners;this.saveListeners=[];var n=cleverapps.values(this.levelVersions);1===n.length&&(n=n[0]);var s="/levels/edit/"+this.level.episodeNo+"/"+this.level.levelNo;cleverapps.RestClient.post(s,n,function(){this.saveToStorage(n),t.forEach(cleverapps.callFunc),this.inSaveNow=!1,this.needSave&&this.save()}.bind(this),function(e){this.inSaveNow=!1,this.needSave&&this.save(),cleverapps.Notification.create(e.errorMessage||"Failure edit level")}.bind(this))}};var EditorLevelView=cc.Node.extend({ctor:function(){this._super();var e=cc.director.getWinSize();this.setPosition(e.width/2,e.height+cleverapps.styles.EditorLevelView.y);var t=cleverapps.UI.generateTTFText("LevelNo:",cleverapps.styles.FONTS.EDITOR_TEXT);this.levelNo=new IncDecBlock({onChange:this.gotoNewLevel.bind(this),incIcon:bundles.editor.frames.editor_arrow_right,decIcon:bundles.editor.frames.editor_arrow_left}),cleverapps.UI.wrap(this.levelNo);var n=new cleverapps.Layout([t,this.levelNo],{
direction:cleverapps.UI.HORIZONTAL,margin:cleverapps.styles.EditorLevelView.margin});this.addChild(n),this.levelNo.setValue(LevelManager.getInstance().level.getHumanReadableNumber())},gotoNewLevel:function(e){if(1<e&&e--,!(e<0||e>=levels.episodes.amountEpisodes*Episode.LEVELS_PER_EPISODE)){var t=Math.floor(e/Episode.LEVELS_PER_EPISODE);if("string"==typeof LevelManager.getInstance().level.episodeNo){t=LevelManager.getInstance().level.episodeNo;var n=LevelManager.getInstance().episode.content;if(e>=(n=Array.isArray(n)?n:n.levels).length)return}LevelManager.getInstance().setVersion(void 0),LevelManager.getInstance().setLevel({episodeNo:t,levelNo:e%Episode.LEVELS_PER_EPISODE}),LevelManager.getInstance().editLevel()}}});cleverapps.styles.EditorLevelView={y:-40,margin:10};var EditorControlsView=cc.Node.extend({ctor:function(n){this._super();var e=cleverapps.UI.getSceneSize();this.setPosition(e.width+cleverapps.styles.EditorControlsView.x,e.height/2),this.setLocalZOrder(25);var t={
play:function(){cleverapps.metha.display({focus:"EditorPlayLevel",actions:[function(e){setTimeout(e,500)},function(e){LevelManager.getInstance().playLevel(e)}]})},clear:function(){confirm("Clear level?")&&n.clear()},undo:function(){n.undoHistory()}},s="tripeaks"===cleverapps.config.name?this.listControlsCompact(t):t,i=Object.keys(s).map(function(e){return s[e].compact?new cleverapps.UI.Button({content:new cc.Sprite(s[e].icon),button_png:bundles.editor.frames.editor_button_off,button_on_png:bundles.editor.frames.editor_button_on,button_off_png:bundles.editor.frames.editor_button_off,onClicked:s[e].action.bind(this),width:70,height:70,hint:e}):new cleverapps.UI.Button({button_png:bundles.editor.frames.editor_button,button_on_png:bundles.editor.frames.editor_button,button_off_png:bundles.editor.frames.editor_button,text:e.toUpperCase(),font:cleverapps.styles.FONTS.EDITOR_TEXT,onClicked:s[e].bind(this),width:cleverapps.styles.EditorControlsView.button.width})}),o=!1
;cc.eventManager.addListener({event:cc.EventListener.KEYBOARD,onKeyPressed:function(e,t){e===cc.KEY.ctrl&&(o=!0),e===cc.KEY.z&&o&&n.undoHistory()}.bind(this),onKeyReleased:function(e,t){e===cc.KEY.ctrl&&(o=!1)}.bind(this)},this),i.reverse(),i.forEach(function(e){this.addChild(e)},this),cleverapps.UI.arrangeWithMargins(i,{margin:cleverapps.styles.EditorControlsView.margin})},listControlsCompact:function(e){return{play:{compact:!0,icon:bundles.editor.frames.editor_play_icon,action:e.play},clear:{compact:!0,icon:bundles.editor.frames.editor_clear_icon,action:e.clear},undo:{compact:!0,icon:bundles.editor.frames.editor_undo_icon,action:e.undo}}}});cleverapps.styles.EditorControlsView={x:-100,margin:20,button:{width:200}},cleverapps.isStaging();var TaskManager=function(){this.localWaitingList=[],this.scheduleUpdates()};TaskManager.prototype.addTask=function(e,t){var n=new WorkerTask(e,t);this.isScheduledTask(n,function(e){e?cleverapps.Notification.create("Already scheduled task "+n.code
):n.start(function(){this.localWaitingList.push(n),t.onCreated&&t.onCreated()}.bind(this))}.bind(this))},TaskManager.prototype.removeTask=function(e){var t=this.localWaitingList.indexOf(e);-1!==t&&this.localWaitingList.splice(t,1)},TaskManager.prototype.isScheduledTask=function(t,n){if(t instanceof WorkerTask||(t=new WorkerTask(t.type,t.params)),this.localWaitingList.some(function(e){return e.type===t.type&&e.code===t.code&&e.options.project===t.options.project}))n(!0);else{var e=cleverapps.RestClient.createQueryString({code:t.code,type:t.type,project:t.options.project});cleverapps.RestClient.get(TaskManager.GetRestFullPath("/tasks/ispending?"+e),{},function(e){n(e)}.bind(this),function(e){console.log("Taskmanager ispending fail",e),n(!0)})}},TaskManager.prototype.scheduleUpdates=function(){setInterval(this.update.bind(this),TaskManager.CHECK_INTERVAL)},TaskManager.prototype.update=function(){var e=this.localWaitingList.map(function(e){return e.dbId})
;e.length&&cleverapps.RestClient.get(TaskManager.GetRestFullPath("/tasks/getfinished?"+cleverapps.RestClient.createQueryString({ids:e})),{},function(t){var n=[];this.localWaitingList.forEach(function(e){t[e.dbId]&&n.push(e)}),n.forEach(function(e){e.complete(t[e.dbId])})}.bind(this),function(e){console.log("Taskmanager update fail",e)})},TaskManager.GetRestFullPath=function(e){return(cleverapps.isLocalhost()?"http://localhost:3200":"https://stands.labsystech.ru/taskmanager-rest")+e},TaskManager.CHECK_INTERVAL=1e4;var WorkerTask=function(e,t){this.type=e,this.params=t,this.options={},this.dbId=void 0,this.crateTypeValues()};WorkerTask.prototype.crateTypeValues=function(){switch(this.type){case WorkerTask.TYPES.ADVIDEO:this.code=this.params.scenario,this.options.project=cleverapps.config.name;break;default:this.code=""}},WorkerTask.prototype.start=function(t){var e=cleverapps.RestClient.createQueryString({code:this.code,type:this.type});cleverapps.RestClient.post(
TaskManager.GetRestFullPath("/tasks/create?"+e),{options:this.options},function(e){this.dbId=e.insertId,t()}.bind(this),function(e){console.log("Failed scheduling task "+this.code,e.errorMessage||e.error),this.failed()}.bind(this))},WorkerTask.prototype.complete=function(e){cleverapps.taskManager.removeTask(this),this.params.onComplete&&this.params.onComplete(e)},WorkerTask.prototype.failed=function(){cleverapps.taskManager.removeTask(this),this.params.onFailed&&this.params.onFailed()},WorkerTask.TYPES={},WorkerTask.TYPES.ADVIDEO="advideo";var MergeEditor=function(){EditorBase.call(this);var e=Game.currentGame.level;this.map=Game.currentGame.map=new EditorMap2d(e.content.map,{visibleBox:e.content.visibleBox,regions:e.content.regions,decorators:e.content.decorators}),this.fogs=new EditorFogs(this,e.content.regions),MergeEditor.InsertDefaults(this.map,e.content.field),this.chooser=new UnitsChooser,this.gitButtons=new GitButtons("cleverapps/res/"+cleverapps.config.name+"/levels"),
this.gitButtons.checkStatus(),this.regions=new RegionsUnits,this.decorators=new DecoratorUnits};MergeEditor.prototype=Object.create(EditorBase.prototype),(MergeEditor.prototype.constructor=MergeEditor).InsertDefaults=function(i,e){e.forEach(function(e){e=Fogs.ReadMapUnit(e);var t=new Unit(e),n=e.x,s=e.y;t.setPosition(n,s),i.add(Map2d.LAYER_UNITS,n,s,t),t.clear()})},MergeEditor.prototype._load=function(e){},MergeEditor.prototype.increaseSize=function(e){var t=80,n=80;"editor"===Game.currentGame.level.episode.episodeNo&&(t=80,n=110);var s=Game.currentGame.level.content;if(!((r=s.map).length>=n&&r[0].length>=t)){for(var i=Math.floor((t-r[0].length)/2),o=Math.floor((n-r.length)/2),r=[],a=[],c=0;c<n;c++){r.push(""),a.push("");for(var l=0;l<t;l++)r[c]+=Map2d.TILE_WATER+"",a[c]+="."}for(c=0;c<s.map.length;c++)c+o<0||c+o>=r.length||(r[c+o]=r[c].substr(0,i)+s.map[c]+r[c+o].substr(i),r[c+o]=r[c+o].substr(0,t));s.map=r,s.field.forEach(function(e){e.x+=i,e.y+=o}),Object.keys(s.regions).forEach(
function(e){var t=s.regions[e];t.positions.forEach(function(e){e.x+=i,e.y+=o}),t.head&&(t.head.x+=i,t.head.y+=o)}),cleverapps.metha.whenFreeFocus(function(){this.map.saveLevel()}.bind(this))}},(Editor=MergeEditor).BUNDLES=["merge","admin","episode_editor"];var MergeEditorView=EditorViewBase.extend({ctor:function(e){this._super(e);var t=this.chooser=new UnitsChooserView;MergeEditorView.addSlideHandler(t),this.addChild(t);var n=this.map=new EditorMapComponent({width:this.width-t.width,height:this.height});MergeEditorView.addSlideHandler(n),this.addChild(n);var s=new GitButtonsView(this.editor.gitButtons);this.addChild(s),this.layoutControl=new EditorLayoutControls(this.onChangeLayout.bind(this)),this.addChild(this.layoutControl),Game.currentGame.onShowUp=function(e){e()}},onChangeLayout:function(e){this.map.onSlide(-e),this.chooser.onSlide(e)}});MergeEditorView.addSlideHandler=function(e){e.onSlide=function(e){var t=cleverapps.UI.getSceneSize(),n=this.width,s=[0,this.baseWidth,t.width],
i=this.width<s[1]?0:this.width>s[1]?2:1,o=s[i=Math.max(0,Math.min(2,i+e))];n<o&&(this.setContentSize2(o,this.height),this.visible=!0);var r=(o-n)/2;"right"===this.alignment.x.align&&(r=(n-o)/2),this.stopAllActions(),this.runAction(cc.sequence(cc.moveBy(.2,r,0).easing(cc.easeIn(1)),cc.callFunc(function(){this.visible=0<o,this.setContentSize2(o,this.height),this.setPositionRound(this.alignment)}.bind(this))))}},EditorView=MergeEditorView,cleverapps.overrideStyles(cleverapps.styles.GitButtonsView,{position:{x:{align:"right",dx:-690},y:{align:"top",dy:-20}}});var EditorLayoutControls=cleverapps.Layout.extend({ctor:function(t){var e=[{icon:bundles.admin.frames.left_double,delta:-2},{icon:bundles.admin.frames.left,delta:-1},{icon:bundles.admin.frames.right,delta:1},{icon:bundles.admin.frames.right_double,delta:2}].map(function(e){return AdminDetailControls.prototype.createButton.call(this,{icon:e.icon,action:t.bind(this,e.delta)})},this);this._super(e,{direction:cleverapps.UI.HORIZONTAL,
margin:cleverapps.styles.EditorLayoutControls.margin}),this.setPositionRound(cleverapps.styles.EditorLayoutControls.position)}});cleverapps.styles.EditorLayoutControls={button:{width:60,height:60},margin:10,position:{x:{align:"right",dx:-390},y:{align:"top",dy:-20}}};var EditorMap2dBase=function(e){Map2d.apply(this,arguments)};EditorMap2dBase.prototype=Object.create(Map2d.prototype),(EditorMap2dBase.prototype.constructor=EditorMap2dBase).prototype.containsCell=function(e,t){return"object"==typeof e&&(t=e.y,e=e.x),0<=e&&e<this.getWidth()&&0<=t&&t<this.getHeight()};var EditorMap2dBaseView=Map2dView.extend({ctor:function(e){this._super.apply(this,arguments),this.isVisiblePoint=function(e){return!0},this.highlight=new HighlightView({}),this.getCell(Map2d.LAYER_UNITS,0,0).addChild(this.highlight)},hasTouch:function(e){var t=this.convertTouchToNodeSpace(e);return this.isVisiblePoint(t)&&this._super(e)},getVisibleCellByCoordinates:function(e){var t=this.getCellByCoordinates(e);if(
this.map2d.containsCell(t)&&this.isVisiblePoint(e))return t},getStableLayers:function(){return[]},createView:function(e,t,n){var s=[];e instanceof EditorFogTile?s.push(new EditorFogTileView(e)):e instanceof Unit&&!e.isMultiCellBody()&&s.push(new EditorUnitView(e)),s.forEach(function(e){t.addChild(e)}),0===s.length&&this._super.apply(this,arguments),t.children.forEach(function(e){e instanceof HighlightView||e instanceof Map2dDecoratorView||cc.eventManager.removeListeners(e)})}}),EditorMap2d=function(e){EditorMap2dBase.apply(this,arguments)};EditorMap2d.prototype=Object.create(EditorMap2dBase.prototype),(EditorMap2d.prototype.constructor=EditorMap2d).prototype.produce=function(e,t,n){var s=Editor.currentEditor.chooser.active;if(void 0!==s){var i=s.template&&s.template.code;i&&!this.isGround(e,t)||(this.setPointer(e,t),s.decorator?Editor.currentEditor.decorators.produce(e,t,s,n):s.region?Editor.currentEditor.fogs.produce(e,t,s):i?this.produceUnit(e,t,s):this.produceMap(e,t,s),
this.saveLevel())}},EditorMap2d.prototype.produceMap=function(s,i,e){this.setValue(Map2d.LAYER_WATER,Iso.SAME,void 0),this.setValue(Map2d.LAYER_BORDERS,Iso.SAME,void 0),this.setValue(Map2d.LAYER_GROUND,Iso.SAME,void 0),this.setValue(Map2d.LAYER_UNITS,Iso.SAME,void 0),e.template===Map2d.TILE_WATER?(this.setValue(Map2d.LAYER_WATER,Iso.SAME,e.template),this.setValue(Map2d.LAYER_BORDERS,Iso.SAME,Map2d.TILE_BORDER)):[Map2d.TILE_GREEN_LEVEL_1,Map2d.TILE_GREEN_LEVEL_2].includes(e.template)&&this.setValue(Map2d.LAYER_GROUND,Iso.SAME,e.template);for(var o=-2;o<=2;o++)for(var r=-2;r<=2;r++)this.containsCell(s+r,i+o)&&this.layers.forEach(function(e,t){this.setPointer(s+r,i+o);var n=e[i+o][s+r];t===Map2d.LAYER_GROUND&&n===Map2d.TILE_GROW&&(n=Map2d.TILE_GREEN_LEVEL_1),this.setValue(t,Iso.SAME,n)}.bind(this));for(o=-3;o<=3;o++)for(r=-3;r<=3;r++)this.containsCell(s+r,i+o)&&this.constructGrowth(s+r,i+o)},EditorMap2d.prototype.produceUnit=function(e,t,n){this.setValue(Map2d.LAYER_UNITS,Iso.SAME,void 0)
;var s=new Unit(n.template);s.setPosition(e,t),this.add(Map2d.LAYER_UNITS,e,t,s),this.onAdd(Map2d.LAYER_UNITS,e,t,s)},EditorMap2d.prototype.saveLevel=cleverapps.timeredThrottle(cleverapps.parseInterval("1 seconds"),function(){var e=JSON.parse(JSON.stringify(LevelManager.getInstance().level.content));e.map=this.getLevelMap(),e.field=this.getLevelField(),e.regions=this.regions,e.decorators=this.decorators.getSaveInfo(),LevelManager.getInstance().update(e),LevelManager.getInstance().save(),Editor.currentEditor.gitButtons.checkStatus()}),EditorMap2d.prototype.getLevelMap=function(){for(var e=[],t=0;t<this.getHeight();t++){for(var n=[],s=0;s<this.getWidth();s++){var i=Map2d.TILE_WATER;(this.isGround(s,t)||this.layers[Map2d.LAYER_GROUND][t][s]===Map2d.TILE_GROW)&&(i=this.layers[Map2d.LAYER_GROUND][t][s]===Map2d.TILE_GREEN_LEVEL_2?Map2d.TILE_GREEN_LEVEL_2:Map2d.TILE_GREEN_LEVEL_1),n.push(i)}e.push(n.join(""))}return e},EditorMap2d.prototype.getLevelField=function(){for(var e=[],
t=0;t<this.getHeight();t++)for(var n=0;n<this.getWidth();n++){var s=this.getUnit(n,t);s&&s.isPersistent()&&e.push({x:n,y:t,code:s.code,stage:s.stage})}return e};var EditorMap2dView=EditorMap2dBaseView.extend({ctor:function(s){this._super.apply(this,arguments),cleverapps.UI.onClick(this,function(e){var t=this.getVisibleCellByCoordinates(e);if(t){var n=this.alignInIsometricGrid(t.x,t.y);s.produce(t.x,t.y,{dx:Math.round(e.x-n.x),dy:Math.round(e.y-n.y)})}}.bind(this),{swallowTouches:!1,ignoreOnTouchMoved:!0,clickThrottle:1}),cc.eventManager.addListener({event:cc.EventListener.MOUSE,onMouseMove:function(e){var t=this.convertTouchToNodeSpace(e),n=this.getVisibleCellByCoordinates(t),s=n&&n.x||0,i=n&&n.y||0;void 0!==Editor.currentEditor.chooser.active&&this.highlight.replaceParent(this.getCell(Map2d.LAYER_UNITS,s,i))}.bind(this)},this),this.addProduceListener(),s.on("setValue",this.onSetValue.bind(this),this)},onSetValue:function(e,t,n){var s=this.getCell(e,t,n);s.children.slice().forEach(
function(e){e instanceof HighlightView||e instanceof Map2dDecoratorView||e.removeFromParent()});var i=cc.p(this.map2d.pointer.x,this.map2d.pointer.y),o=this.map2d.layers[e][n][t];this.map2d.setPointer(t,n),this.createView(o,s,this.map2d),this.map2d.setPointer(i.x,i.y)},addProduceListener:function(){var s={},t=function(e){var t=this.getVisibleCellByCoordinates(this.convertTouchToNodeSpace(e));if(t){var n=t.x+"_"+t.y;s[n]||(this.map2d.produce(t.x,t.y),s[n]=!0)}}.bind(this);cc.eventManager.addListener({event:cc.EventListener.TOUCH_ONE_BY_ONE,onTouchBegan:function(e){if(cleverapps.keyboardController.isPressed(cc.KEY.ctrl)&&this.hasTouch(e))return s={},t(e),!0}.bind(this),onTouchMoved:function(e){this.hasTouch(e)&&t(e)}.bind(this),onTouchEnded:function(e){this.hasTouch(e)&&t(e),s={}}.bind(this)},this)}}),EditorMapComponent=cleverapps.UI.ScrollView.extend({ctor:function(e){var t=Editor.currentEditor,n=new EditorMap2dView(t.map);this._super(n,{
childrenVisibility:cleverapps.UI.ScrollView.CHILDREN_VISIBILITY_FULLCHECK,childrenVisibilityPadding:Math.max(cleverapps.styles.Map2dView.cell.width,cleverapps.styles.Map2dView.cell.height),outOfBoundaryScale:.25,inertialScrollFactor:.2}),this.setContentSize2(e.width,e.height),this.setPositionRound({align:"right"},{align:"center"}),this.baseWidth=this.width,this.scrollTo(cleverapps.UI.ScrollView.SCROLLS.CENTER),cc.eventManager.addListener(cc.EventListener.create({event:cc.EventListener.KEYBOARD,onKeyPressed:function(e){e===cc.KEY.ctrl&&(this.touchScrollDisabled=!0)}.bind(this),onKeyReleased:function(e){e===cc.KEY.ctrl&&(this.touchScrollDisabled=!1)}.bind(this)}),this),n.isVisiblePoint=this.isVisiblePoint.bind(this)}}),EditorUnitView=UnitView.extend({fogCreated:function(){},fogOpen:function(){},insertAdditionalView:function(){this.unit.chooser||this._super.apply(this,arguments)}}),UnitsChooser=function(){cleverapps.EventEmitter.call(this);(UnitsChooser.currentChooser=this
).episode=new Episode(Episode.Types.EDITOR,0);var e=this.episode.getLevel();e.load(),this.map=new UnitsChooserMap2d(e.content.map,{visibleBox:e.content.visibleBox}),MergeEditor.InsertDefaults(this.map,e.content.field),this.addUnits()};UnitsChooser.prototype=Object.create(cleverapps.EventEmitter.prototype),(UnitsChooser.prototype.constructor=UnitsChooser).prototype.select=function(e){if(this.active&&this.active!==e){var t=this.active;delete this.active,t.unselect()}this.active=e},UnitsChooser.prototype.unselect=function(e){this.active===e&&(this.active.unselect(),delete this.active)},UnitsChooser.prototype.stop=function(){this.stopped||(this.stopped=!0,this.map.stop())},UnitsChooser.prototype.addUnits=function(){for(var e=this.getUnitsGroups(),t=0,s=(Math.round(this.map.getWidth()/2),0),n=function(e){for(var t=[],n=0;n<this.map.getWidth();n++)this.map.isGround(n,e)&&t.push(cc.p(n,e));return t}.bind(this);s<e.length;){for(var i=e[s],o=void 0;t<this.map.getHeight();){var r=n(t);if(
r&&r.length>=i.groundUsed){o=r;break}t++}if(!o)return void console.log("No space for units "+i.code);for(var a,c=s+1,l=i.units.slice(),p=i.groundUsed;c<e.length&&(a=e[c],i.type===a.type||!(1<i.units.length||1<a.units.length));){var d=p+a.groundUsed+1;if(d>o.length)break;p=d,l=l.concat([void 0]).concat(a.units),c++}var u=Math.floor((o.length-p)/2);o=o.slice(u,u+p);s=0;l.forEach(function(e){var t=1;if(e){var n=e(o[s].x,o[s].y);t=n&&n.groundUsed||1}s+=t},this),t+=2,a&&a.type!==i.type&&t++,s=c}},UnitsChooser.prototype.getUnitsGroups=function(){var n=[];return Object.keys(Families).forEach(function(t){if(console.log("Has "+t),!["multiCellBody","specialoffer"].includes(t))if(bundles["unit_"+t]){var e=Families[t],s={code:t,type:e.type,layer:Map2d.LAYER_UNITS,units:[],groundUsed:0};cleverapps.rangeArray(0,e.units.length-1).forEach(function(e){var n=new Unit({code:t,stage:e});n.chooser=!0,UnitView.UnitIconFrame(n)||UnitView.UnitIconJson(n)?(n.groundUsed=Families[t].units[e].multicell?3:1,
s.groundUsed+=n.groundUsed,s.units.push(function(e,t){return n.setPosition(e,t),this.map.add(Map2d.LAYER_UNITS,e,t,n),n}.bind(this))):console.log("No frame for "+t+(e+1))}.bind(this)),n.push(s)}else console.log("No bundle!")}.bind(this)),n};var ChooserUnit=function(e){this.code=e.code,cleverapps.EventEmitter.call(this),this.selected=!1};ChooserUnit.prototype=Object.create(cleverapps.EventEmitter.prototype),(ChooserUnit.prototype.constructor=ChooserUnit).prototype.onClick=function(){this.selected?this.unselect():this.select()},ChooserUnit.prototype.select=function(){this.selected||(this.selected=!0,this.trigger("update"),Editor.currentEditor.chooser.select(this))},ChooserUnit.prototype.unselect=function(e){this.selected&&(this.selected=!1,this.trigger("update"),Editor.currentEditor.chooser.unselect(this))};var ChooserUnitIcon=cc.Scale9Sprite.extend({ctor:function(e){this._super(bundles.mergeui.frames.icon_background),this.unit=e,this.setContentSize2(cleverapps.styles.ChooserUnitIcon),
cleverapps.UI.applyHover(this),cleverapps.UI.onClick(this,e.onClick.bind(e),{clickThrottle:1}),e.on("update",this.update.bind(this),this),this.update()},update:function(){var e=this.unit.selected?bundles.mergeui.frames.icon_background_light:bundles.mergeui.frames.icon_background;this.setSpriteFrame(new cc.Sprite(e).getSpriteFrame())}});cleverapps.styles.ChooserUnitIcon={width:160,height:160};var UnitsChooserView=cleverapps.UI.ScrollView.extend({ctor:function(){var e=Editor.currentEditor.chooser,t=new UnitsChooserMap2dView(e.map);this._super(t,{childrenVisibility:cleverapps.UI.ScrollView.CHILDREN_VISIBILITY_FULLCHECK,childrenVisibilityPadding:Math.max(cleverapps.styles.Map2dView.cell.width,cleverapps.styles.Map2dView.cell.height),outOfBoundaryScale:.25,inertialScrollFactor:.2,zoom:!0});var n=cleverapps.UI.getSceneSize(),s=cleverapps.styles.UnitsChooserView;this.setContentSize2(s.width,n.height),this.setPositionRound({align:"left"},{align:"center"}),this.baseWidth=this.width,
this.scrollTo(cleverapps.UI.ScrollView.SCROLLS.CENTER),this.zoomHandler.setZoom(.8),t.isVisiblePoint=this.isVisiblePoint.bind(this)}});cleverapps.styles.UnitsChooserView={width:800};var UnitsChooserMap2d=function(e){EditorMap2dBase.apply(this,arguments)};UnitsChooserMap2d.prototype=Object.create(EditorMap2dBase.prototype),(UnitsChooserMap2d.prototype.constructor=UnitsChooserMap2d).prototype.onClick=function(e){var t=this.selected;this.selected&&this.selected.unselect(),cc.pointEqualToPoint(t,e)||this.select(e)},UnitsChooserMap2d.prototype.getTemplate=function(e){this.setPointer(e.x,e.y);var t=Map2d.TILE_WATER,n=this.getUnit(e.x,e.y);return n?t=n:this.getGround(Iso.SAME)===Map2d.TILE_GROW?t=Map2d.TILE_GREEN_LEVEL_1:this.isGround(e.x,e.y)&&(t=this.getGround(Iso.SAME)),t},UnitsChooserMap2d.prototype.select=function(e){this.selected={x:e.x,y:e.y,template:this.getTemplate(e),unselect:this.unselect.bind(this)},this.trigger("select",this.selected),Editor.currentEditor.chooser.select(
this.selected)},UnitsChooserMap2d.prototype.unselect=function(){if(this.selected){var e=this.selected;delete this.selected,this.trigger("unselect",e),Editor.currentEditor.chooser.unselect(e)}};var UnitsChooserMap2dView=EditorMap2dBaseView.extend({ctor:function(e){this._super.apply(this,arguments),cleverapps.UI.onClick(this,this.onClick.bind(this),{swallowTouches:!1,ignoreOnTouchMoved:!0}),e.on("select",this.select.bind(this),this),e.on("unselect",this.unselect.bind(this),this)},onClick:function(e){var t=this.getCellByCoordinates(e);t&&this.map2d.onClick(t)},select:function(e){this.highlight.replaceParent(this.getCell(Map2d.LAYER_UNITS,e.x,e.y))},unselect:function(){this.highlight.replaceParent(this.getCell(Map2d.LAYER_UNITS,0,0))},createView:function(e,t,n){this._super.apply(this,arguments),t.children.forEach(function(e){e instanceof UnitView&&e.sprite&&e.sprite.setOpacity(255)})}}),DecoratorUnit=function(e){ChooserUnit.call(this,e),this.decorator=!0}
;DecoratorUnit.prototype=Object.create(ChooserUnit.prototype),DecoratorUnit.prototype.constructor=DecoratorUnit;var DecoratorUnitIcon=ChooserUnitIcon.extend({ctor:function(e){this._super(e);var t=new cc.Sprite(bundles.map_decorators.frames[e.code]);t.setPositionRound(this.width/2,this.height/2),this.addChild(t);var n=cleverapps.UI.generateOnlyText(e.code.replace("decorator_",""),cleverapps.styles.FONTS.LIGHT_TITLE_TEXT);n.setPositionRound(cleverapps.styles.DecoratorUnitIcon.title),n.fitTo(this.width,0),this.addChild(n)}});cleverapps.styles.DecoratorUnitIcon={title:{x:{align:"center"},y:{align:"bottom",dy:-40}}};var DecoratorUnits=function(){cleverapps.EventEmitter.call(this);var e=Object.keys(bundles.map_decorators.frames);this.units=e.map(function(e){return new DecoratorUnit({code:e})})};DecoratorUnits.prototype=Object.create(cleverapps.EventEmitter.prototype),(DecoratorUnits.prototype.constructor=DecoratorUnits).prototype.getUnits=function(){return this.units},
DecoratorUnits.prototype.getUnitIcons=function(){return this.getUnits().map(function(e){return new DecoratorUnitIcon(e)})},DecoratorUnits.prototype.produce=function(e,t,n,s){Game.currentGame.map.decorators.add({x:e,y:t,code:n.code,dx:Math.round((s.dx||0)/resolutionScale),dy:Math.round((s.dy||0)/resolutionScale),rotation:0})},Map2dDecorators.prototype.getSaveInfo=function(){return this.decorators.map(function(e){return e.getSaveInfo()})},Map2dDecorators.prototype.add=function(e){var t=new Map2dDecorator(e);this.decorators.push(t),this.createView(t).select()},Map2dDecorators.prototype.remove=function(e){var t=this.decorators.indexOf(e);-1!==t?(this.decorators.splice(t,1),Game.currentGame.map.saveLevel()):cleverapps.Notification.create("Can't find decorator to delete")},Map2dDecorators.prototype.getViewClass=function(){return cleverapps.config.editorMode?EditorMap2dDecoratorView:Map2dDecoratorView},Map2dDecorator.prototype.getSaveInfo=function(){return{code:this.code,x:this.x,y:this.y,
dx:this.dx||0,dy:this.dy||0,rotation:this.rotation||0}},Map2dDecorator.prototype.updatePosition=function(e,t,n){this.dx=e,this.dy=t,this.rotation=n,Game.currentGame.map.saveLevel()},Map2dDecorator.prototype.getLayerIdSuper=Map2dDecorator.prototype.getLayerId,Map2dDecorator.prototype.getLayerId=function(){return cleverapps.environment.isEditorScene()?Map2d.LAYER_GROUND:this.getLayerIdSuper()};var EditorMap2dDecoratorView=Map2dDecoratorView.extend({ctor:function(e){this._super(e),cleverapps.UI.applyHover(this),cleverapps.UI.onClick(this,function(){cleverapps.keyboardController.isPressed(cc.KEY.Delete)?this.onDeletePressed(!0):window.debug===this?this.unselect():this.select()}.bind(this)),this.onDeletePressed=cleverapps.accumulate(0,this.onDeletePressed.bind(this))},onArrowPressed:function(){var e=Math.round((this.x-this.parent.width/2)/resolutionScale),t=Math.round((this.y-this.parent.height/2)/resolutionScale),n=Math.round(this.rotation);this.decorator.updatePosition(e,t,n)},
onDeletePressed:function(e){var t=e||confirm('Delete decorator "'+this.decorator.code+"'?");e||cleverapps.keyboardController.onKeyReleasedHandler(cc.KEY.Delete),t&&(window.debug===this&&this.unselect(),Game.currentGame.map.decorators.remove(this.decorator),this.removeFromParent())},select:function(){this.debugBorder({showPosition:!0})},unselect:function(){this.cleanupBorder()}}),EditorFogs=function(e,t,n){this.blocks={}};EditorFogs.prototype=Object.create(Fogs.prototype),(EditorFogs.prototype.constructor=EditorFogs).prototype.add=function(e,t,n){this.blocks[n].add(e,t)},EditorFogs.prototype.remove=function(e,t,n){this.blocks[n].remove(e,t)},EditorFogs.prototype.createFogBlock=function(e){this.blocks[e]||(this.blocks[e]=new EditorFogBlock(e,FogsConfig[e]||{}))},EditorFogs.prototype.removeFogBlock=function(e){delete this.blocks[e]},EditorFogs.prototype.renameFogBlock=function(e,t){var n=this.blocks[e];n.rename(t),delete this.blocks[e],this.blocks[t]=n},
EditorFogs.prototype.produce=function(e,t,n){var s=Game.currentGame.map,i=s.regions,o=cc.p(e,t),r=s.getFog(e,t),a=r&&r.fogBlock.id,c=n.code,l=i[c];if(l||(l=i[c]={positions:[]}),a===c&&n.head)r.isHead||(r.fogBlock.setHead(e,t),l.head=cc.p(e,t));else{if(r){this.remove(e,t,r.fogBlock.id);var p=i[a];p.positions=p.positions.filter(function(e){return!cc.pointEqualToPoint(e,o)}),cc.pointEqualToPoint(p.head,o)&&delete p.head}a!==n.code&&(this.add(e,t,n.code),l.positions.push(cc.p(e,t)),n.head&&this.produce(e,t,n))}},EditorFogs.prototype.createRegion=function(e){var t=Game.currentGame.map;t.regions[e]={positions:[]},t.saveLevel()},EditorFogs.prototype.renameRegion=function(e,t){var n=Game.currentGame.map;n.regions[t]=n.regions[e],delete n.regions[e],this.blocks[e].rename(t),this.blocks[t]=this.blocks[e],delete this.blocks[e],n.saveLevel()},EditorFogs.prototype.deleteRegion=function(e){var t=Game.currentGame.map;delete t.regions[e],this.hideBlock(e),t.saveLevel()},
EditorFogs.prototype.clearRegion=function(e){var t=Game.currentGame,n=t.map.regions,s=e.code;n[s].positions.forEach(function(e){this.blocks[s].remove(e.x,e.y)},this),n[s]={positions:[]},t.map.saveLevel()},EditorFogs.prototype.showBlock=function(n){this.blocks[n]=new EditorFogBlock(n,FogsConfig[n]||{});var s=Game.currentGame.map.regions[n]||{positions:[]};!s.head&&FogsConfig[n]&&0<s.positions.length&&(cleverapps.config.debugMode&&console.error("Error: head is not specified for region '"+n+"'"),s.head=cleverapps.Random.choose(s.positions)),s.positions.forEach(function(e){var t=s.head&&e.x===s.head.x&&e.y===s.head.y;this.blocks[n].add(e.x,e.y,t)},this),this.blocks[n].calcState()},EditorFogs.prototype.hideBlock=function(e){this.blocks[e].tiles.forEach(function(e){e.open()}),delete this.blocks[e]},EditorFogs.prototype.hide=function(){Object.keys(this.blocks).forEach(this.hideBlock.bind(this))},EditorFogs.prototype.getShowCodes=function(e){return e.isFog()?Object.keys(FogsConfig):[e.code]},
EditorFogs.prototype.select=function(e){if(this.selected!==e){var t=this.getShowCodes(e);cleverapps.substract(Object.keys(this.blocks),t).forEach(this.hideBlock.bind(this)),cleverapps.substract(t,Object.keys(this.blocks)).forEach(this.showBlock.bind(this));var n=this.getSelectedCode();this.selected=e,n&&this.blocks[n]&&this.blocks[n].updateTiles(),this.blocks[e.code].updateTiles()}},EditorFogs.prototype.getSelectedCode=function(){return this.selected&&this.selected.code},EditorFogs.prototype.unselect=function(e){this.selected===e&&(this.hide(),delete this.selected)};var EditorFogBlock=function(e,t){FogBlock.apply(this,arguments),this.updateTiles=cleverapps.accumulate(0,this.updateTiles.bind(this))};EditorFogBlock.prototype=Object.create(FogBlock.prototype),(EditorFogBlock.prototype.constructor=EditorFogBlock).prototype.calcState=function(){this.setState(FogBlock.UNAVAILABLE)},EditorFogBlock.prototype.add=function(e,t,n){var s=new EditorFogTile(e,t,this,n);this.tiles.push(s),
s.setTitleVisible(!1),this.updateTiles()},EditorFogBlock.prototype.setHead=function(e,t){for(var n=cc.p(e,t),s=0;s<this.tiles.length;s++)this.tiles[s].isHead=cc.pointEqualToPoint(n,this.tiles[s]),this.tiles[s].onUpdateState(this.state,!0)},EditorFogBlock.prototype.rename=function(e){this.id=cleverapps.castType(e),this.tiles.forEach(function(e){e.onUpdateTitle()})},EditorFogBlock.prototype.remove=function(e,t){var n=cc.p(e,t),s=this.tiles.findIndex(function(e){return cc.pointEqualToPoint(n,e)});-1!==s&&(this.tiles[s].open(),this.tiles.splice(s,1),this.updateTiles())},EditorFogBlock.prototype.updateTiles=function(){var n={};this.tiles.forEach(function(e,t){n[e.x+"_"+e.y]={index:t,x:e.x,y:e.y,tile:e},e.setTitleVisible(!1)}),this.brushTiles(n)},EditorFogBlock.prototype.brushTiles=function(s){var e=cleverapps.values(s);if(0!==e.length){var t=50<=e.length?EditorFogBlock.SHOW_TITLE_INTERVAL_BIG:EditorFogBlock.SHOW_TITLE_INTERVAL_SMALL,n=cc.getCenterPoint(e),i=cleverapps.values(Iso),o=[];if(
Editor.currentEditor.fogs.getSelectedCode()===this.id&&FogsConfig[this.id]){var r=cleverapps.values(s).filter(function(n){return i.some(function(e){var t=cc.p(n.x+e.x,n.y+e.y);return!s[t.x+"_"+t.y]})});r.forEach(function(e){e.tile.setTitleVisible(!0)}),o=o.concat(r)}n.dist=0;var a=[n];delete s[n.x+"_"+n.y];for(var c=0;c<a.length;){var l=a[c++],p=100;o.forEach(function(e){p=Math.min(p,cc.getDistanceChebyshev(e,l))}),t<=p&&(l.tile.setTitleVisible(!0),o.push(l)),i.forEach(function(e){var t=cc.p(l.x+e.x,l.y+e.y),n=s[t.x+"_"+t.y];n&&(delete s[t.x+"_"+t.y],a.push(n))})}this.brushTiles(s)}},EditorFogBlock.SHOW_TITLE_INTERVAL_SMALL=2,EditorFogBlock.SHOW_TITLE_INTERVAL_BIG=3;var EditorFogTile=function(e,t,n,s){this.onChangeTitleVisible=function(e){},this.onUpdateTitle=function(){},this.titleVisible=!0,FogTile.apply(this,arguments)};EditorFogTile.prototype=Object.create(FogTile.prototype),(EditorFogTile.prototype.constructor=EditorFogTile).prototype.open=function(){var e=Game.currentGame
;e.map.setPointer(this.x,this.y),e.map.setValue(Map2d.LAYER_FOG,Iso.SAME,void 0),this.fogBlock=void 0},EditorFogTile.prototype.setTitleVisible=function(e){this.titleVisible=e,this.onChangeTitleVisible(e)};var EditorFogTileView=FogTileView.extend({ctor:function(e){this._super.apply(this,arguments);var t=e.fogBlock,n=this.title=cleverapps.UI.generateTTFText(t.id,cleverapps.styles.FONTS.WINDOW_TEXT);n.setPositionRound(this.width/2,this.height/2),n.setVisible(e.titleVisible),this.addChild(n),this.setCascadeColorEnabled(!0),this.sprite.setOpacity(200),e.onChangeTitleVisible=this.createListener(this.setTitleVisible.bind(this)),e.onUpdateTitle=this.createListener(this.updateTitle.bind(this))},setTitleVisible:function(e){this.title.setVisible(e)},updateTitle:function(){this.title.setString(this.fogTile.fogBlock.id)},onUpdateState:function(e,t){this._super.apply(this,arguments);var n=cc.color(255,255,255,255);this.fogTile.isHead&&(n=cc.color(100,100,100,255)),this.setColor(n)}}),
RegionsWindow=Window.extend({onWindowLoaded:function(){var e=cleverapps.styles.RegionsWindow;this.tabsInfo=this.createTabs(),this._super({name:"RegionsWindow",content:this.createContent(),adjustToContent:!0,noBackground:!0,closeButton:!0,regularCloseButton:!0,extraWidth:2*e.contentOffsetX,contentOffsetX:e.contentOffsetX,foreground:bundles.windows.frames.window_foreground_png}),cleverapps.audio.playSound(bundles.main.urls.window_effect)},createTabs:function(){return{0:{text:"messages:RegionsWindow.Fogs",generator:this.createTab.bind(this,Editor.currentEditor.regions,{type:RegionUnit.TYPE_FOG})},1:{text:"messages:RegionsWindow.Regions",generator:this.createTab.bind(this,Editor.currentEditor.regions,{type:RegionUnit.TYPE_REGION})},2:{text:"messages:RegionsWindow.Decorators",generator:this.createTab.bind(this,Editor.currentEditor.decorators)}}},createContent:function(){var e=cleverapps.styles.RegionsWindow,t=this.content=cleverapps.UI.createScale9Sprite(bundles.windows.frames.window_bg_png
,cleverapps.styles.Window.Background.scale9);t.setAnchorPoint2(),t.setContentSize2(e.width,e.height);var n=this.tabs=new Tabs(this.tabsInfo,e.tabs);n.setAnchorPoint2(0,0),n.setPositionRound(e.tabs),t.addChild(n);var s=Editor.currentEditor.chooser.active,i=0;return s&&s.type===RegionUnit.TYPE_REGION&&(i=1),s&&s.decorator&&(i=2),n.activateTab(i),t},createTab:function(e,t){var n=cleverapps.styles.UnitsLibraryWindow;t=t||{},cleverapps.extend(t,{width:n.width-2*n.padding.x,height:n.height-2*n.padding.y});var s=new RegionsTab(e,t);return this.content.addChild(s),s}});RegionsWindow.prototype.listBundles=function(){return["orderswindow","admin"]},RegionsWindow.prototype.editorWindow=!0,cleverapps.styles.RegionsWindow={width:1680,height:950,contentOffsetX:80,padding:{x:60,y:34},tabs:{x:{align:"left",dx:-118},y:{align:"top",dy:-40},height:280}};var RegionUnit=function(e){ChooserUnit.call(this,e),this.type=e.type,this.region=!0,this.head=!1};RegionUnit.prototype=Object.create(
ChooserUnit.prototype),(RegionUnit.prototype.constructor=RegionUnit).prototype.isCreateUnit=function(){return this.code===RegionUnit.CODE_CREATE},RegionUnit.prototype.onClick=function(){this.isCreateUnit()?Editor.currentEditor.regions.createNewRegion():ChooserUnit.prototype.onClick.apply(this,arguments)},RegionUnit.prototype.select=function(){this.selected||(ChooserUnit.prototype.select.apply(this,arguments),Editor.currentEditor.fogs.select(this))},RegionUnit.prototype.unselect=function(e){this.selected&&(ChooserUnit.prototype.unselect.apply(this,arguments),Editor.currentEditor.fogs.unselect(this))},RegionUnit.prototype.isFog=function(){return this.type===RegionUnit.TYPE_FOG},RegionUnit.prototype.switchHead=function(){this.head=!this.head,this.trigger("update")},RegionUnit.CODE_CREATE="zzzzzzz___create",RegionUnit.TYPE_FOG="fog",RegionUnit.TYPE_REGION="region";var RegionsUnits=function(){cleverapps.EventEmitter.call(this);var e=Object.keys(FogsConfig);this.fogs=e.map(function(e){
return new RegionUnit({code:e,type:RegionUnit.TYPE_FOG})});var t=cleverapps.substract(Object.keys(Game.currentGame.map.regions),e).sort();t.push(RegionUnit.CODE_CREATE),this.units=t.map(function(e){return new RegionUnit({code:e,type:RegionUnit.TYPE_REGION})},this)};RegionsUnits.prototype=Object.create(cleverapps.EventEmitter.prototype),(RegionsUnits.prototype.constructor=RegionsUnits).prototype.getUnits=function(e){switch(e&&e.type){case RegionUnit.TYPE_REGION:return this.units;default:return this.fogs}},RegionsUnits.prototype.getUnitIcons=function(e){return this.getUnits(e).map(function(e){return new RegionUnitIcon(e)})},RegionsUnits.prototype.validateCode=function(e){return/[^a-z0-9_-]/.test(e)?"Invalid region code: "+e+". The region code must match the regex [a-z0-9_-]":Game.currentGame.map.regions[e]?"Region code "+e+" already exists":e?void 0:"Error: empty code"},RegionsUnits.prototype.createNewRegion=function(){var e=window.prompt("New region code"),t=this.validateCode(e);if(t
)cleverapps.Notification.create(t);else{var n=new RegionUnit({code:e,type:RegionUnit.TYPE_REGION});this.units.push(n),this.sort(),this.trigger("refresh"),Editor.currentEditor.fogs.createRegion(e),n.select()}},RegionsUnits.prototype.renameRegion=function(e){var t=e.code,n=window.prompt(e.code+" - new region code?");if(e.code!==n){var s=this.validateCode(n);s?cleverapps.Notification.create(s):(Editor.currentEditor.fogs.renameRegion(t,n),e.code=n,this.sort(),this.trigger("refresh"),e.select())}},RegionsUnits.prototype.deleteRegion=function(e){if(confirm('Delete region with code "'+e.code+"'?")){var t=this.units.indexOf(e);-1!==t?(Editor.currentEditor.fogs.deleteRegion(e.code),e.unselect(),this.units.splice(t,1),this.trigger("refresh")):cleverapps.Notification.create("Cant find unit with code "+e.code)}},RegionsUnits.prototype.clearRegion=function(e){confirm('Clear region with code "'+e.code+"'?")&&Editor.currentEditor.fogs.clearRegion(e)},RegionsUnits.prototype.sort=function(){
this.units.sort(function(e,t){return e.code.localeCompare(t.code)})};var RegionUnitIcon=ChooserUnitIcon.extend({ctor:function(e){this._super(e),this.createTitle()},update:function(){this._super(),this.unit.selected?this.showMenu():this.hideMenu(),this.updateHead()},showMenu:function(){var n=cleverapps.styles.RegionUnitIcon.menu,e=RegionUnit.MENU.filter(function(e){return!e.type||e.type===this.unit.type},this).map(function(e){var t;return e.icon?t=new cc.Sprite(e.icon):e.text&&(t=cleverapps.UI.generateTTFText(e.text,cleverapps.styles.FONTS.WINDOW_TEXT)),new cleverapps.UI.Button({button_png:bundles.admin.frames.regular_button,button_on_png:bundles.admin.frames.regular_button_on,content:t,fitTo:!1,contentOffset:{y:0},width:n.width,height:n.height,onClicked:e.action.bind(this)})}.bind(this));this.menu=new cleverapps.Layout(e,{direction:cleverapps.UI.HORIZONTAL,margin:n.margin}),this.addChild(this.menu),this.menu.setPositionRound(n)},hideMenu:function(){this.menu&&(
this.menu.removeFromParent(),delete this.menu)},createTitle:function(){if(this.unit.isCreateUnit()){var e=new cc.Sprite(bundles.admin.frames.plus_button);return e.setPositionRound(this.width/2,this.height/2),void this.addChild(e)}var t=this.title=cleverapps.UI.generateTTFText("fog\n"+this.unit.code.replace("fog",""),cleverapps.styles.FONTS.LIGHT_TITLE_TEXT);t.setPositionRound(this.width/2,this.height/2),t.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER),t.setDimensions(.9*this.width,0),t.fitTo(0,.9*this.height),this.addChild(t)},updateHead:function(){if(this.unit.type!==RegionUnit.TYPE_REGION&&(this.headTitle&&(this.headTitle.removeFromParent(),delete this.headTitle),this.unit.head)){var e=this.headTitle=cleverapps.UI.generateTTFText("H",cleverapps.styles.FONTS.LIGHT_TITLE_TEXT);e.setPositionRound(cleverapps.styles.RegionUnitIcon.headTitle),this.addChild(e)}}});cleverapps.styles.RegionUnitIcon={menu:{margin:10,height:45,width:45,x:{align:"center"},y:{align:"bottom",dy:-56}},headTitle:{
x:{align:"right",dx:-10},y:{align:"top",dy:-10}}},RegionUnit.MENU=[{id:"editHead",type:RegionUnit.TYPE_FOG,text:"H",action:function(){this.unit.switchHead()}},{id:"renameRegion",type:RegionUnit.TYPE_REGION,icon:bundles.admin.frames.edit_icon,action:function(){Editor.currentEditor.regions.renameRegion(this.unit)}},{id:"deleteRegion",type:RegionUnit.TYPE_REGION,icon:bundles.admin.frames.delete_icon,action:function(){Editor.currentEditor.regions.deleteRegion(this.unit)}},{id:"clearRegion",text:"C",action:function(){Editor.currentEditor.regions.clearRegion(this.unit)}}];var RegionsTab=cc.Node.extend({ctor:function(e,t){this._super(),this.setContentSize2(t),this.setAnchorPoint2(),this.setPositionRound({x:{align:"center"},y:{align:"center"}}),this.options=t,this.container=e,this.container.on("refresh",this.refresh.bind(this),this),this.refresh()},refresh:function(){this.content&&(this.content.removeFromParent(),delete this.content);var e=cleverapps.styles.RegionsTab,
t=this.container.getUnitIcons(this.options),n=this.grid=new cleverapps.GridLayout(t,{columns:6,direction:cleverapps.GridLayout.TOP_TO_BOTTOM,align:{y:cleverapps.GridLayout.ALIGN_END},padding:e.grid.padding,margin:e.grid.margin});if(n.setAnchorPoint2(),n.setPositionRound({x:{align:"center"},y:{align:"top"}}),n.height<=this.height)return this.addChild(n),void(this.content=n);var s=this.content=new cleverapps.UI.ScrollView(n,{childrenVisibility:cleverapps.UI.ScrollView.CHILDREN_VISIBILITY_NONE,direction:cleverapps.UI.ScrollView.DIR_VERTICAL,scrollBarEnabled:!1});s.setContentSize(this.width,this.height),s.scrollToDefault(),s.setAnchorPoint2(),s.setPositionRound(this.width/2,this.height/2),this.addChild(s)}});cleverapps.styles.RegionsTab={grid:{padding:{x:0,y:75},margin:{x:30,y:70}}},cleverapps.override(cleverapps.Tool,{UI:{windows:{levelUpWindow:displayToolWindow(function(){new LevelUpWindow}),startQuestWindow:displayToolWindow(function(){new StartQuestWindow(
Game.currentGame.quests.quests[0])}),finishQuestWindow:displayToolWindow(function(){new FinishQuestWindow(Game.currentGame.quests.quests[0])}),newRecipesWindow:displayToolWindow(function(){var e=Recipes.filter(function(e){return e.level===Game.currentGame.gameLevel.getLevel()}).map(function(e,t){return{title:e.code,code:"dishes",stage:t}});e.length&&new NewRecipesWindow(e)}),speedUpWindow:displayToolWindow(function(){var e=new Unit({code:"wood",stage:6,unbuilt:!0}),t=new Worker;t.setSpeedUpBonus(),t.assign(e,e.findComponent(Buildable).time),new SpeedUpWindow(t)}),buyIngredientsWindow:displayToolWindow(function(){new BuyIngredientsWindow({wheat:10,apple:3,candies:5})})}},minesweeper:{win:function(){var e=cc.director.getRunningScene().mineGame;e&&e.win()}},game:{tutorial:function(){var e={finishAll:function(){Game.currentGame.tutorial.finishAll()}};for(var t in MergeTutorials)e[t]=function(t){cleverapps.metha.display({focus:"quests",action:function(e){
Game.currentGame.tutorial.showTutorial(MergeTutorials[t],e)}})}.bind(null,t);return e},nextHero:function(){var e=Game.currentGame,t=e.unitsLibrary,n=t.getNextHero(),s=t.getCurrentHero(),i=e.map.listAvailableUnits().filter(function(e){return e.findComponent(MakesOrder)&&e.code===s})[0],o=e.map.findEmptySlot(i.x,i.y),r=new Unit({code:n,stage:Families[n].units.length-1});r.setPosition(o.x,o.y),e.map.add(Map2d.LAYER_UNITS,r.x,r.y,r),e.map.onAdd(Map2d.LAYER_UNITS,r.x,r.y,r),t.openUnit(r)},openFog:function(){var r=cc.director.getRunningScene(),a=Game.currentGame,c=a.unitsLibrary,l=a.fogs.blocks,e={},t=function(e){if(a.tutorial.finishAll(),l[e]){for(var t in l){var n=l[t],s=n.options||{};if(s.conditions=s.conditions||{},a.addWands(s.price),n.open(),s.conditions.level)for(;a.gameLevel.getLevel()<s.conditions.level;)a.gameLevel.setExp(a.gameLevel.nextLevelThreshold()),a.gameLevel.moveToNextLevel();if(s.conditions.hero&&!c.isHeroAvailable(s.conditions.hero)){var i=new Unit({
code:s.conditions.hero,stage:Families[s.conditions.hero].units.length-1}),o=r.map.getCellByCoordinates(r.scroll.getCurrentPosition());(o=a.map.findEmptySlot(o.x,o.y,i,{radius:0}))&&(i.setPosition(o.x,o.y),a.map.add(Map2d.LAYER_UNITS,o.x,o.y,i),a.map.onAdd(Map2d.LAYER_UNITS,o.x,o.y,i),a.onUnitAvailable(i))}if(t===e)break}a.counter.setTimeout(function(){a.quests.quests.forEach(function(e){e.setFresh(!1)})},1e3)}};for(var n in l)e[n]=t.bind(null,n);return e},resetBonusWorker:function(){Game.currentGame.workers.removeBonusWorker()},sendPixels:function(){Game.currentGame.unitsLibrary.listAvailableByType("fruit").length&&Game.currentGame.pixelsPlanner.sendPixels()},add10Wands:function(){Game.currentGame.addWands(10)},add1000Wands:function(){Game.currentGame.addWands(1e3)},toggleAnchorsMode:function(){window.keyboardAnchorsMode=!window.keyboardAnchorsMode},createUnit:function(){var o={};return Object.keys(Families).forEach(function(e){var t=Families[e].type||"other",n={};if(-1===[
"multiCellBody","specialoffer"].indexOf(e)){for(var s=0;s<Families[e].units.length;++s){var i={code:e,stage:s,unbuilt:!0};n[Unit.GetKey(i)]={icon:UnitView.getUnitImage(i),action:function(){var e=new Unit(this),t=cc.director.getRunningScene(),n=Game.currentGame,s=t.map.getCellByCoordinates(t.scroll.getCurrentPosition());(s=n.map.findEmptySlot(s.x,s.y,e,{radius:0}))&&(e.setPosition(s.x,s.y),n.map.add(Map2d.LAYER_UNITS,s.x,s.y,e),n.map.onAdd(Map2d.LAYER_UNITS,s.x,s.y,e),n.onUnitAvailable(e))}.bind(i)}}o[t]||(o[t]={}),o[t][e]=n}}),o},energyLottery:{refresh:function(){Game.currentGame.energyLottery.refresh(),Game.currentGame.energyLottery.refreshRound()},refreshRound:function(){Game.currentGame.energyLottery.refreshRound()}},quests:function(){var e=Game.currentGame.quests,t={};for(var n in QuestsConfig){var s=QuestsConfig[n].trigger,i=n.replace(/(?:_\d+)+/,"")||"other";t[i]||(t[i]={}),t[i][n]=e.create.bind(e,{unit:s&&s.unit})}return t},specialOffer:function(){
var e=cc.director.getRunningScene(),t=Game.currentGame.map,n=e.map.getCellByCoordinates(e.scroll.getCurrentPosition()),s=t.listUnitsFromPointByCircle(n.x,n.y)[0];if(s&&(n=t.findEmptySlot(n.x,n.y))){var i=new Unit({code:"specialoffer",stage:0,prize:s});i.setPosition(n.x,n.y),t.add(Map2d.LAYER_UNITS,n.x,n.y,i),t.onAdd(Map2d.LAYER_UNITS,n.x,n.y,i),i.findComponent(SpecialOffer).onAppearance()}},adsBarrel:function(){Game.currentGame&&Game.currentGame.barrelPlanner.inited&&Game.currentGame.barrelPlanner.checkTimeout&&(Game.currentGame.barrelPlanner.clear(),Game.currentGame.barrelPlanner.sendBarrel())}}});var AssetComponent=function(e,t){this.name=e,cleverapps.extend(this,t),cleverapps.EventEmitter.call(this)};AssetComponent.prototype=Object.create(cleverapps.EventEmitter.prototype),(AssetComponent.prototype.constructor=AssetComponent).prototype.moveToScene=function(e,t){this.trigger("componentMovedToScene",e,t)};var HierarchyItem=function(e){cleverapps.extend(this,e),this.properties||(
this.properties={}),this.children=[],this.processProperties(this.properties)};HierarchyItem.prototype.toJSON=function(){var e=cleverapps.extend({},this.properties);return delete e.isPreview,delete e.visible,delete e.isGameCapture,{id:this.id,type:this.type,parent:this.parentItem?this.parentItem.id:void 0,assetName:this.assetName,properties:e}},HierarchyItem.prototype.processProperties=function(t){t&&"object"==typeof t&&(t.isPreview=void 0,t.color&&t.color._val&&(t.color=new cc.Color((4278190080&t.color._val)>>>24,(16711680&t.color._val)>>16,(65280&t.color._val)>>8,255&t.color._val)),Object.keys(t).forEach(function(e){this.processProperties(t[e])}.bind(this)))},HierarchyItem.createScenario=function(e){return new HierarchyItem({type:HierarchyItem.TYPE.SCENARIO,id:e,properties:{caption:e,languages:["en"],resolution:Object.keys(Wysiwyg.VIDEO_SIZES)[0]}})},HierarchyItem.createClip=function(e,t){return new HierarchyItem({type:HierarchyItem.TYPE.CLIP,parentItem:t,id:t.id+"_"+e,properties:{
caption:e,duration:3e3}})},HierarchyItem.createDirectory=function(e){return new HierarchyItem({type:HierarchyItem.TYPE.DIRECTORY,id:e,properties:{caption:"cleverapps/res/"+cleverapps.config.name+"/"+e}})},HierarchyItem.prototype.onClick=function(){cleverapps.wysiwyg.hierarchy.selectItem(this)},HierarchyItem.prototype.onIconClick=function(){this.type!==HierarchyItem.TYPE.DIRECTORY&&cleverapps.wysiwyg.hierarchy.changeItemProperty(this,"visible",!this.properties.visible)},HierarchyItem.prototype.isSelected=function(){return cleverapps.wysiwyg.hierarchy.selectedItem===this},HierarchyItem.prototype.clone=function(e){var t=new HierarchyItem(this.toJSON());switch(t.type){case HierarchyItem.TYPE.SCENARIO:t.id="scenario_"+cleverapps.wysiwyg.hierarchy.getNewScenarioIndex(),t.properties.caption+="_copy";break;case HierarchyItem.TYPE.CLIP:t.id=e.id+"_clip_"+cleverapps.wysiwyg.hierarchy.getNewClipIndex(e),t.parentItem=e;break;case HierarchyItem.TYPE.COMPONENT:t.id=SceneComponent.ID++,t.parentItem=e
}return t},HierarchyItem.prototype.getLevel=function(){if(this.type===HierarchyItem.TYPE.DIRECTORY)return 0;for(var e=1,t=this.parentItem;t;)e++,t=t.parentItem;return e},HierarchyItem.TYPE={DIRECTORY:"directory",SCENARIO:"scenario",CLIP:"clip",COMPONENT:"component"};var SceneComponent=function(e){cleverapps.extend(this,e),SceneComponent.ID||(SceneComponent.ID=0),e.id&&e.id>=SceneComponent.ID&&(SceneComponent.ID=e.id+1),this.id=e.id||SceneComponent.ID++};SceneComponent.prototype=Object.create(cleverapps.EventEmitter.prototype),(SceneComponent.prototype.constructor=SceneComponent).prototype.handleClick=function(){var e=cleverapps.wysiwyg.hierarchy;e.selectItem(e.items.filter(function(e){return e.id===this.id}.bind(this))[0])},SceneComponent.prototype.change=function(e,t){cleverapps.wysiwyg.hierarchy.changeItemProperty(cleverapps.wysiwyg.hierarchy.selectedItem,e,t),cleverapps.wysiwyg.inspector.showItemProperties()};var AssetComponentView=cc.Node.extend({ctor:function(e){this._super(),
this.assetComponent=e;var s=cleverapps.styles.AssetComponentView;if(this.setAnchorPoint2(),this.setContentSize(s),this.assetComponent.preview.icon){var t=new cc.Sprite(this.assetComponent.preview.icon);t.setPositionRound(s.preview),this.addChild(t)}var n=this.componentFrame=new cc.Node;if(n.setAnchorPoint2(),n.setPositionRound(s.preview),n.setVisible(!1),this.addChild(n),this.assetComponent.preview.icon){var i=new cc.Sprite(this.assetComponent.preview.icon);i.setPositionRound(n.width/2,n.height/2),n.addChild(i)}var o=cleverapps.UI.createScale9Sprite(bundles.wysiwyg.frames.attach_frame);o.setAnchorPoint2(),o.setVisible(!1),this.addChild(o),cleverapps.UI.onDrag(this,{swallowTouches:!0,onTouchBegan:function(){this.componentFrame.replaceParentSamePlace(cc.director.getRunningScene().scene),this.componentFrame.setVisible(!0)}.bind(this),onDragMove:function(e){this.componentFrame.setPositionRound(this.componentFrame.parent.convertTouchToNodeSpace(e.touch));var t=this.findDragTarget(e);t?(
o.replaceParent(t.view),o.setContentSize(t.view.getContentSize()),o.setPositionRound(t.view.width/2,t.view.height/2),o.setVisible(!0)):(o.replaceParent(this),o.setVisible(!1))}.bind(this),onDragEnd:function(e){this.componentFrame.replaceParentSamePlace(this),this.componentFrame.setPositionRound(s.preview),this.componentFrame.setVisible(!1);var t=this.findDragTarget(e);if(t){var n=t.view.convertTouchToNodeSpace(e.touch);n.x=Math.round(n.x),n.y=Math.round(n.y),this.assetComponent.moveToScene(t.id,{x:{align:"center",dx:n.x-t.view.width/2},y:{align:"center",dy:n.y-t.view.height/2}})}else cleverapps.Notification.create("Please select clip in hierarchy and drag component to it");o.replaceParent(this),o.setVisible(!1)}.bind(this)}),cleverapps.UI.applyHover(this)},findDragTarget:function(s){var e=cc.director.getRunningScene().wysiwygPreviewView;if(void 0!==e.clipNodes&&1===e.clipNodes.length){var i=e.clipNodes[0],t=i.convertTouchToNodeSpace(s.touch);if(cc.rectContainsPoint(cc.rect(0,0,i.width,
i.height),t)){var o=void 0;return Object.keys(i.componentViews).forEach(function(e){var t=i.componentViews[e],n=t.convertTouchToNodeSpace(s.touch);cc.rectContainsPoint(cc.rect(0,0,t.width,t.height),n)&&(o={id:parseInt(e),view:t})}),o||{id:i.clip.id,view:i}}}}});cleverapps.styles.AssetComponentView={preview:{x:{align:"center"},y:{align:"center",dy:4}},width:110,height:110},cleverapps.overrideFonts(cleverapps.styles.FONTS,{ASSET_COMPONENT_TEXT:{size:18,color:cleverapps.styles.COLORS.BLACK,font:bundles.wysiwyg.urls.strict_font_ttf}});var SceneComponentView=cc.Node.extend({ctor:function(e,t){this._super(),this.sceneComponent=e,this.setAnchorPoint2();var n=e.properties,s=e.ctor(),i=this.componentInstance=new s(n,t);this.setPositionRound(n.position),n.height&&!n.width?this.setContentSize(i.width,n.height):!n.height&&n.width?this.setContentSize(n.width,i.height):this.setContentSize(i.getContentSize()),n.scale&&i.setScale(n.scale),n.rotation&&this.setRotation(n.rotation),
void 0!==n.zOrder&&this.setLocalZOrder(n.zOrder),!1===n.visible&&this.setVisible(!1),"number"==typeof n.disappearAfter&&0<n.disappearAfter&&setTimeout(function(){this.setVisible(!1)}.bind(this),n.disappearAfter),i.setPositionRound(this.width/2,this.height/2),this.addChild(i),cleverapps.UI.onClick(i,e.handleClick.bind(e)),i.nestedComponents=[]},updateItemTools:function(e){if(!this.componentInstance.disableTools){if(!this.tools){var t=this.tools=cleverapps.UI.createScale9Sprite(bundles.wysiwyg.frames.preview_frame);t.setAnchorPoint2(),t.setLocalZOrder(1e4),this.componentInstance.addChild(t);var n=this.changeWidthControl=new cc.Sprite(bundles.wysiwyg.frames.preview_control);n.setRotation(-90),n.setAnchorPoint2(),t.addChild(n);var s=this.changeWidthControlLeft=new cc.Sprite(bundles.wysiwyg.frames.preview_control);s.setRotation(90),s.setAnchorPoint2(),t.addChild(s);var i=this.changeHeightControl=new cc.Sprite(bundles.wysiwyg.frames.preview_control);i.setAnchorPoint2(),t.addChild(i)
;var o=this.changeHeightControlTop=new cc.Sprite(bundles.wysiwyg.frames.preview_control);o.setRotation(180),o.setAnchorPoint2(),t.addChild(o);var r,a=this.changeScaleControl=new cc.Sprite(bundles.wysiwyg.frames.preview_control);if(a.setRotation(-45),a.setAnchorPoint2(),t.addChild(a),this.componentInstance.customTools){var c=Object.keys(this.componentInstance.customTools).map(function(e){var t=this.componentInstance.customTools[e];return new cleverapps.UI.Button({button_png:bundles.buttons.frames.window_button_png,button_on_png:bundles.buttons.frames.window_button_on_png,button_off_png:bundles.buttons.frames.window_button_disabled_png,text:e,font:cleverapps.styles.FONTS.SCENE_COMPONENT_CUSTOM_TOOLS_TEXT,onClicked:t.action.bind(t)})},this),l=this.customTools=new cleverapps.Layout(c,{direction:cleverapps.UI.VERTICAL});l.setAnchorPoint2(.5,1),t.addChild(l)}var p=this.getParent();cleverapps.UI.onDrag(t,{swallowTouches:!0,onTouchBegan:function(){r=this.getPosition()}.bind(this),
onDragMove:function(e){this.setPositionRound({x:{align:"center",dx:r.x+e.dx-p.width/2},y:{align:"center",dy:r.y+e.dy-p.height/2}})}.bind(this),onDragEnd:function(e){this.sceneComponent.change("position",{x:{align:"center",dx:Math.round(r.x+e.dx)-p.width/2},y:{align:"center",dy:Math.round(r.y+e.dy)-p.height/2}})}.bind(this)});var d=function(e,t,n){cleverapps.UI.onDrag(e,{swallowTouches:!0,onTouchBegan:function(){r=this.getPosition()}.bind(this),onDragMove:function(e){this.tools.replaceParentSamePlace(p),this.tools.setVisible(!1),"width"===t?e.dy=0:e.dx=0,this.sceneComponent.change("position",{x:{align:"center",dx:Math.round(r.x+e.dx/2)-p.width/2},y:{align:"center",dy:Math.round(r.y+e.dy/2)-p.height/2}}),"width"===t?this.sceneComponent.change("width",Math.round(this.componentInstance.width+n*e.dx)):this.sceneComponent.change("height",Math.round(this.componentInstance.height+n*e.dy))}.bind(this),onDragEnd:function(){this.tools.removeFromParent()}.bind(this)})}.bind(this);d(n,"width",1),d(
s,"width",-1),d(i,"height",-1),d(o,"height",1),cleverapps.UI.onDrag(a,{swallowTouches:!0,onTouchBegan:function(){r=a.getPosition()}.bind(this),onDragMove:function(e){var t;if(this.tools.replaceParentSamePlace(p),this.tools.setVisible(!1),0<e.dx&&e.dy<0?t=Math.round(Math.min(e.dx,-e.dy)):e.dx<0&&0<e.dy&&(t=Math.round(Math.max(e.dx,-e.dy))),void 0!==t){var n=Math.min(this.componentInstance.height,this.componentInstance.width);this.sceneComponent.change("scale",Math.round(100*(n+t)/n)/100)}}.bind(this),onDragEnd:function(){this.tools.removeFromParent()}.bind(this)})}e&&!this.keyboardListener&&"keyboard"in cc.sys.capabilities&&(this.keyboardListener=cc.eventManager.addListener({event:cc.EventListener.KEYBOARD,onKeyPressed:function(e){var t={};t[cc.KEY.up]={x:0,y:1},t[cc.KEY.down]={x:0,y:-1},t[cc.KEY.left]={x:-1,y:0},t[cc.KEY.right]={x:1,y:0},t[e]&&this.sceneComponent.change("position",{x:{align:"center",dx:this.x+t[e].x-p.width/2},y:{align:"center",dy:this.y+t[e].y-p.height/2}})}.bind(this
)},this)),!e&&this.keyboardListener&&(cc.eventManager.removeListener(this.keyboardListener),delete this.keyboardListener);var u=cleverapps.styles.SceneComponentView;this.tools.setPositionRound(this.width/2,this.height/2),this.tools.setContentSize(this.getContentSize()),this.tools.setVisible(e),this.changeWidthControl.setPositionRound(u.changeWidth),this.changeWidthControlLeft.setPositionRound(u.changeWidthLeft),this.changeHeightControl.setPositionRound(u.changeHeight),this.changeHeightControlTop.setPositionRound(u.changeHeightTop),this.changeScaleControl.setPositionRound(u.changeScale),this.customTools&&this.customTools.setPositionRound(u.customTools)}}});cleverapps.overrideFonts(cleverapps.styles.FONTS,{SCENE_COMPONENT_CUSTOM_TOOLS_TEXT:{size:42,color:cleverapps.styles.COLORS.BLACK}}),cleverapps.styles.SceneComponentView={changeWidth:{x:{align:"right",dx:25},y:{align:"center"}},changeWidthLeft:{x:{align:"left",dx:-25},y:{align:"center"}},changeHeight:{x:{align:"center"},y:{
align:"bottom",dy:-25}},changeHeightTop:{x:{align:"center"},y:{align:"top",dy:25}},changeScale:{x:{align:"right",dx:15},y:{align:"bottom",dy:-15}},customTools:{x:{align:"center"},y:-20}};var HierarchyItemView=cc.Node.extend({ctor:function(e){this._super(),this.hierarchyItem=e;var t=cleverapps.styles.HierarchyItemView,n=t.width-t.levelIndent*this.hierarchyItem.getLevel();this.setAnchorPoint2(),this.setContentSize2(n,t.height);var s=this.icon=new cc.Sprite;s.setAnchorPoint2(),s.setPositionRound(t.icon),this.addChild(s),this.updateIcon();var i=this.hierarchyItem.properties.caption;if(this.hierarchyItem.type===HierarchyItem.TYPE.SCENARIO)i+=" (id: "+this.hierarchyItem.id+")";else if(this.hierarchyItem.type===HierarchyItem.TYPE.COMPONENT&&this.hierarchyItem.assetName){var o=this.hierarchyItem.assetName.replace("Ads","");i!==o&&(i+=" ("+o+")")}var r=this.text=cleverapps.UI.generateOnlyText(i,cleverapps.styles.FONTS.HIERARCHY_ITEM_TEXT);this.drawUnderline(r.width);var a=n-t.icon.width
;r.width>a&&r.fitTo(a),r.setDimensions(a,0),r.fitToHeight(t.height),r.setHorizontalAlignment(cc.TEXT_ALIGNMENT_LEFT),r.setAnchorPoint2(),r.setPositionRound(t.text),this.addChild(r),this.setSelected(e.isSelected()),cleverapps.UI.onClick(this.text,this.hierarchyItem.onClick.bind(this.hierarchyItem)),cleverapps.UI.onClick(this.icon,this.hierarchyItem.onIconClick.bind(this.hierarchyItem))},setSelected:function(e){this.text.setFontFillColor(e?cleverapps.styles.COLORS.BLACK:cleverapps.styles.COLORS.COLOR_VERY_DARK_GRAY),this.text._setUpdateTextureDirty()},drawUnderline:function(e){var t=cleverapps.styles.HierarchyItemView.line,n=this.line=new cc.DrawNode;n.setAnchorPoint2(),n.setContentSize2(e,t.height),n.setPositionRound(t),n.setVisible(!1),n.drawRect(cc.p(0,0),cc.p(n.width,n.height),cleverapps.styles.COLORS.COLOR_GRAY,n.height,cleverapps.styles.COLORS.COLOR_GRAY),this.addChild(n),cleverapps.UI.applyHover(this)},onMouseOver:function(){this.line&&!1===this.line.visible&&(
this.line.setVisible(!0),this.line.setScale(0),this.line.runAction(new cc.ScaleTo(.3,1)))},onMouseOut:function(){this.line&&!0===this.line.visible&&this.line.runAction(new cc.Sequence(new cc.ScaleTo(.3,0),new cc.CallFunc(function(){this.line.setVisible(!1)}.bind(this))))},updateIcon:function(){var e,t=0;switch(this.hierarchyItem.type){case HierarchyItem.TYPE.SCENARIO:e=bundles.wysiwyg.frames.scenario_item,t=!0===this.hierarchyItem.properties.visible?90:0;break;case HierarchyItem.TYPE.DIRECTORY:e=bundles.wysiwyg.frames.directory_item;break;case HierarchyItem.TYPE.CLIP:e=bundles.wysiwyg.frames.clip_item;break;case HierarchyItem.TYPE.COMPONENT:e=!1===this.hierarchyItem.properties.visible?bundles.wysiwyg.frames.component_item_hidden:bundles.wysiwyg.frames.component_item}this.icon.setSpriteFrame(e),this.icon.setRotation(t),cleverapps.UI.fitToBox(this.icon,cleverapps.styles.HierarchyItemView.icon)}});cleverapps.styles.HierarchyItemView={width:380,height:20,icon:{x:{align:"left",dx:4},y:{
align:"center",dy:2},width:18,height:14},text:{x:{align:"right"},y:{align:"center"}},line:{x:{align:"left",dx:18},y:{align:"bottom",dy:-2},height:1},levelIndent:40},cleverapps.overrideFonts(cleverapps.styles.FONTS,{HIERARCHY_ITEM_TEXT:{size:18,color:cleverapps.styles.COLORS.COLOR_VERY_DARK_GRAY,font:bundles.wysiwyg.urls.strict_font_ttf},SELECTED_HIERARCHY_ITEM_TEXT:{size:18,color:cleverapps.styles.COLORS.BLACK,font:bundles.wysiwyg.urls.strict_font_ttf}});var PropertyEditor=cleverapps.Layout.extend({ctor:function(e,n){var t=cleverapps.styles.PropertyEditor,s=cleverapps.UI.generateOnlyText(e.name,cleverapps.styles.FONTS.PROPERTY_EDITOR_TEXT);s.setDimensions(t.text.width,0),s.setLineHeight(t.editBox.height),s.setHorizontalAlignment(e.isBlock?cc.TEXT_ALIGNMENT_CENTER:cc.TEXT_ALIGNMENT_LEFT),s.setAnchorPoint2(),this.widgets=[],this.registerCleanupCallback(this.cleanup.bind(this));var i=[s];if(e.actions){var o=e.actions.map(function(e){var t=Object.keys(e)[0];return new cleverapps.UI.Button(
{button_png:bundles.wysiwyg.frames.button_off,button_on_png:bundles.wysiwyg.frames.button_on,button_off_png:bundles.wysiwyg.frames.button_off,font:cleverapps.styles.FONTS.PROPERTY_EDITOR_TEXT,text:t,onClicked:e[t].bind(n)})}.bind(this));i=[new cleverapps.Layout([s].concat(o),{direction:cleverapps.UI.HORIZONTAL,margin:t.margin})]}var r=0;e.getter?r=1:e.getters&&(r=e.getters.length);for(var a=0;a<r;a++){var c=t.editBox.width/r-t.margin,l=[];if(e.subNames){var p=cleverapps.UI.generateOnlyText(e.subNames[a],cleverapps.styles.FONTS.PROPERTY_EDITOR_TEXT);c-=p.width+t.margin,l.push(p)}var d=cc.size(c,e.largeField?t.editBox.large.height:t.editBox.height),u=e.getter?e.getter():e.getters[a](),h=void 0,g=!0;if("color"===e.type?(h=new ColorPicker({color:u,size:d}),g=!1):e.items?(h=new DropDown({size:d,value:u,availableItems:e.items,multiselect:e.multiselect,previewGenerator:e.getPreview}),e.items=void 0):((h=new cc.EditBox(d)).setMaxLength("number"===e.type?6:1e4),h.stayOnTop(!0),h.setString(
u?u.toString():""),h.setTouchEnabled(),h.setFontColor(new cc.Color(cleverapps.styles.COLORS.COLOR_BROWN)),h.setFontSize(20*resolutionScale)),h.setDelegate(n),h.customSetter=e.setter?e.setter:e.setters[a],g){var v=cleverapps.UI.createScale9Sprite(bundles.wysiwyg.frames.component);v.addChild(h),v.setContentSize(c,e.largeField?t.editBox.large.height:t.editBox.height),h.setPositionRound(v.width/2+t.text.offsetX,v.height/2),l.push(v)}else l.push(h);this.widgets.push(h),i.push(new cleverapps.Layout(l,{direction:cleverapps.UI.HORIZONTAL,margin:t.margin}))}this._super(i,{direction:cleverapps.UI.HORIZONTAL,margin:t.margin})},setVisible:function(t){cc.Node.prototype.setVisible.call(this,t),this.widgets.forEach(function(e){e.setVisible(t)})},cleanup:function(){this.widgets.forEach(function(e){e.cleanup&&e.cleanup()})}});cleverapps.overrideFonts(cleverapps.styles.FONTS,{PROPERTY_EDITOR_TEXT:{size:22,color:cleverapps.styles.COLORS.BLACK,font:bundles.wysiwyg.urls.strict_font_ttf}}),
cleverapps.styles.PropertyEditor={text:{width:150,offsetX:4},editBox:{width:290,height:24,large:{height:150}},margin:5};var DropDown=cc.Node.extend({ctor:function(e){this._super(),this.availableItems=e.availableItems,this.multiselect=e.multiselect,this.previewGenerator=e.previewGenerator,this.setContentSize(e.size),this.setAnchorPoint2();var t=cleverapps.styles.DropDown,n=cleverapps.UI.createSprite(bundles.wysiwyg.frames.dropdown);n.setPositionRound(t.expander),this.addChild(n),cleverapps.UI.onClick(this,this.toggleDropDown.bind(this)),this.setString(this.parseItems(e.value),!0)},toggleDropDown:function(){if(this.dropDownContent.visible)this.dropDownContent.setVisible(!1),$(cc.EditBox).show();else{var e=cleverapps.styles.DropDown;if(cc.director.getRunningScene().convertToNodeSpace(this.dropDownContent.convertToWorldSpace()).y<e.dropUp.yThreshold){var t=this.dropDownContent.getPosition();this.dropDownContent.setPositionRound(t.x,e.scroll.height+e.dropUp.dy),
this.parent.parent.parent.setLocalZOrder(1)}this.dropDownContent.setVisible(!0),$(cc.EditBox).hide()}},showValue:function(){if(this.shownValue&&this.shownValue.removeFromParent(),this.value){var e=this.multiselect?this.value.join(", "):this.value;22<e.length&&(e=e.substring(0,22)+"...");var t=this.shownValue=cleverapps.UI.generateOnlyText(e,cleverapps.styles.FONTS.DROP_DOWN_SELECTED_ITEM_TEXT);t.setDimensions(this.width,this.height),t.setHorizontalAlignment(cc.TEXT_ALIGNMENT_LEFT),t.setAnchorPoint2(),t.setPositionRound(this.width/2,this.height/2),this.addChild(t)}},setDelegate:function(e){this.delegate=e},getString:function(){return this.value},setString:function(e,t){if(this.multiselect&&!t)if("SELECT ALL"===e)this.value=this.parseItems(this.availableItems);else if("UNSELECT ALL"===e)this.value=[];else{var n=this.value.indexOf(e);-1===n?this.value.push(e):this.value.splice(n,1)}else this.value=e;this.showValue(),this.buildDropDownContent(),this.multiselect&&!t&&this.toggleDropDown()},
buildDropDownContent:function(){var o=cleverapps.styles.DropDown;this.dropDownContent&&this.dropDownContent.removeFromParent(),this.clickPastDropDown&&(cc.eventManager.removeListener(this.clickPastDropDown),this.clickPastDropDown=void 0);var r=this.width+(this.previewGenerator?o.preview.width:0),e=this.parseItems(this.availableItems);this.multiselect&&(e.push("SELECT ALL"),e.push("UNSELECT ALL"));var t=e.map(function(e){var t=this.previewGenerator&&this.previewGenerator(e),n=this.multiselect?-1!==this.value.indexOf(e):e===this.value,s=cleverapps.UI.generateOnlyText(e,n?cleverapps.styles.FONTS.DROP_DOWN_SELECTED_ITEM_TEXT:cleverapps.styles.FONTS.DROP_DOWN_ITEM_TEXT);s.setDimensions(r,0);var i=s;return t&&(cleverapps.UI.fitToBox(t,o.preview),s.setDimensions(r-o.preview.width-o.preview.margin,0),s.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER),i=new cleverapps.Layout([t,s],{direction:cleverapps.UI.HORIZONTAL,margin:o.preview.margin})),cleverapps.UI.onClick(i,function(){this.setString(e)
,this.delegate&&this.delegate.editBoxEditingDidEnd(this)}.bind(this)),i}.bind(this)),n=(e=new cleverapps.Layout(t.reverse(),{direction:cleverapps.UI.VERTICAL,align:cleverapps.UI.ALIGN_START}),o.scroll.height);e.height<n&&(n=e.height);var s=cleverapps.UI.createScale9Sprite(bundles.wysiwyg.frames.component,cleverapps.UI.Scale9Rect.TwoPixelXY);s.setContentSize2(r+2*o.scroll.bgPadding,n+2*o.scroll.bgPadding);var i=new cleverapps.UI.ScrollView(e);i.setContentSize2(r,n),i.setPositionRound(s.width/2,s.height/2),s.addChild(i);var a=this.dropDownContent=cleverapps.UI.createScale9Sprite(bundles.wysiwyg.frames.component);a.setContentSize2(r,s.height),s.setPositionRound(a.width/2,a.height/2),a.addChild(s),a.setVisible(!1),a.setAnchorPoint2(0,1),a.setPositionRound(this.width-r,0),this.addChild(a),this.clickPastDropDown=cc.eventManager.addListener({event:cc.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:!1,onTouchBegan:function(e){var t=a.convertTouchToNodeSpace(e),n=cc.rectContainsPoint(cc.rect(0,0,
a.width,a.height),t),s=this.convertTouchToNodeSpace(e),i=cc.rectContainsPoint(cc.rect(0,0,r,this.height),s);return!a.visible||n||i||this.toggleDropDown(),!0}.bind(this)},this)},parseItems:function(e){return"function"==typeof e?e():cleverapps.clone(e)}});cleverapps.overrideFonts(cleverapps.styles.FONTS,{DROP_DOWN_SELECTED_ITEM_TEXT:{size:20,color:cleverapps.styles.COLORS.BLACK,font:bundles.wysiwyg.urls.strict_font_ttf},DROP_DOWN_ITEM_TEXT:{size:20,color:cleverapps.styles.COLORS.COLOR_VERY_DARK_GRAY,font:bundles.wysiwyg.urls.strict_font_ttf}}),cleverapps.styles.DropDown={expander:{x:{align:"right",dx:-8},y:{align:"center"}},scroll:{height:500,bgPadding:2},preview:{width:90,height:90,margin:5},dropUp:{yThreshold:110,dy:30}};var ColorPicker=cc.Node.extend({ctor:function(e){this._super(),this.setAnchorPoint2(),this.options=e||{},this.color=this.options.color||cleverapps.styles.COLORS.WHITE,this.onChangeCallback=this.options.onChangeCallback||function(){},this.colorSprite=new cc.Sprite
;var t=this.createTexture();this.colorSprite.initWithTexture(t,cc.rect(0,0,this.options.size.width,this.options.size.height)),this.addChild(this.colorSprite),this.setContentSize2(this.colorSprite.getContentSize()),this.colorSprite.setPositionRound(this.width/2,this.height/2),cleverapps.UI.onClick(this,this.onClicked.bind(this))},setDelegate:function(e){this.delegate=e},getString:function(){return this.color},onClicked:function(){if(this.window)return this.closeWindow(),void $(cc.EditBox).show();$(cc.EditBox).hide();var e=cleverapps.styles.ColorPicker;this.window=new ColorPickerWindow(this.color,this.onChange.bind(this)),this.addChild(this.window),this.window.setPositionRound(-this.window.width/2-e.windowOffsetX,this.height/2),this.window.replaceParentSamePlace(cc.director.getRunningScene().scene),this.window.setLocalZOrder(10)},closeWindow:function(){this.window&&(this.window.removeFromParent(!0),delete this.window)},onExit:function(){this._super(),this.closeWindow()},
onChange:function(e){this.color=e,this.colorSprite.initWithTexture(this.createTexture(),cc.rect(0,0,this.options.size.width,this.options.size.height)),this.onChangeCallback(this.color),this.notifyDelegate()},notifyDelegate:cleverapps.throttle(100,function(){this.delegate&&this.delegate.editBoxEditingDidEnd(this)}),createTexture:function(){var e=cleverapps.styles.ColorPicker;return ColorPicker.CreateTextureByColor(e.width,e.height,this.color)}});ColorPicker.CreateTexture=function(e,t,n){for(var s=new cc.Texture2D,i=e*t*3,o=new Uint8Array(i),r=0;r<i;r++)o[r]=n(r);return s.initWithData(o,cc.Texture2D.PIXEL_FORMAT_RGB888,e,t,e*t),s},ColorPicker.CreateTextureByColor=function(e,t,n){return ColorPicker.CreateTexture(e,t,function(e){return e%3==0?n.r:e%3==1?n.g:e%3==2?n.b:void 0})},cleverapps.styles.ColorPicker={width:70,height:70,windowOffsetX:20};var ColorPickerWindow=cc.Node.extend({ctor:function(e,t){this._super(),this.setAnchorPoint2(),this.onChangeCallback=t,this.mainPaletteColors=[{
r:255,g:0,b:0},{r:255,g:0,b:255},{r:0,g:0,b:255},{r:0,g:255,b:255},{r:0,g:255,b:0},{r:255,g:255,b:0},{r:255,g:0,b:0}];var n=cleverapps.styles.ColorPickerWindow;this.createPalette(),this.createPaletteSlider(),this.createGradient(),this.createGradientSlider(),this.createRGBBoxes();var s=new cleverapps.Layout([this.gradientContainer,this.paletteContainer],{direction:cleverapps.UI.HORIZONTAL,margin:n.margin}),i=new cleverapps.Layout([this.rgbBoxesLayout,s],{direction:cleverapps.UI.VERTICAL,margin:n.editBox.margin,align:cleverapps.UI.ALIGN_START}),o=new cc.Scale9Sprite(bundles.wysiwyg.frames.window_bg);this.addChild(o),o.setContentSize2(i.width+2*n.bg.padding.x,i.height+2*n.bg.padding.y),this.setContentSize2(o.getContentSize()),o.setPositionRound(this.width/2,this.height/2),o.setLocalZOrder(-1),this.addChild(i),i.setPositionRound(this.width/2,this.height/2),this.setCurrentColor(e),this.createDragListener()},createDragListener:function(){var t;cleverapps.UI.onDrag(this,{swallowTouches:!0,
onTouchBegan:function(){t=this.getPosition()}.bind(this),onDragMove:function(e){this.setPositionRound(t.x+e.dx,t.y+e.dy)}.bind(this),onDragEnd:function(e){this.setPositionRound(t.x+e.dx,t.y+e.dy)}.bind(this)})},createRGBBoxLayout:function(e){var t=cleverapps.styles.ColorPickerWindow.editBox,n=new cc.EditBox(cc.size(t.width,t.height));n.setDelegate(this),n.stayOnTop(!0),n.setTouchEnabled(),n.setMaxLength(15),n.setFontColor(cleverapps.styles.COLORS.BLACK),n.setString("0"),n.setFontSize(20),n.maxLength=3;var s=cleverapps.UI.generateTTFText(e.toUpperCase(),cleverapps.styles.FONTS.PROPERTY_EDITOR_TEXT),i=new cc.Scale9Sprite(bundles.wysiwyg.frames.component);i.setContentSize2(n.width+2*t.bg.padding.x,n.height+2*t.bg.padding.y),i.addChild(n),n.setPositionRound(i.width/2,i.height/2);var o=new cleverapps.Layout([s,i],{margin:t.labelMargin,direction:cleverapps.UI.HORIZONTAL});return o.box=n,o},createRGBBoxes:function(){var e=cleverapps.styles.ColorPickerWindow.editBox,t=this.createRGBBoxLayout(
"r"),n=this.createRGBBoxLayout("g"),s=this.createRGBBoxLayout("b");this.rgbBoxesLayout=new cleverapps.Layout([t,n,s],{margin:e.margin,direction:cleverapps.UI.HORIZONTAL}),this.editBoxR=t.box,this.editBoxG=n.box,this.editBoxB=s.box},updateRGBBoxes:function(){this.editBoxR.setString(this.color.r.toString()),this.editBoxG.setString(this.color.g.toString()),this.editBoxB.setString(this.color.b.toString())},editBoxTextChanged:function(e){var t,n=parseInt(e.getString());isNaN(n)||(n=this.clamp(n,0,255),t=e===this.editBoxR?new cc.Color(n,this.color.g,this.color.b,255):e===this.editBoxG?new cc.Color(this.color.r,n,this.color.b,255):new cc.Color(this.color.r,this.color.g,n,255),this.setCurrentColor(t),this.onChangeCallback(this.color))},setCurrentColor:function(e){this.color=e,this.paletteColor=this.calcPaletteColor(),this.updatePaletteSlider(),this.updateGradient(),this.updateGradientSlider(),this.updateRGBBoxes()},calcPaletteColor:function(){for(var e=0;e<this.mainPaletteColors.length-1;e++
)for(var t=cleverapps.sign(this.mainPaletteColors[e+1].r-this.mainPaletteColors[e].r),n=cleverapps.sign(this.mainPaletteColors[e+1].g-this.mainPaletteColors[e].g),s=cleverapps.sign(this.mainPaletteColors[e+1].b-this.mainPaletteColors[e].b),i={r:this.mainPaletteColors[e].r,g:this.mainPaletteColors[e].g,b:this.mainPaletteColors[e].b};i.r!==this.mainPaletteColors[e+1].r||i.g!==this.mainPaletteColors[e+1].g||i.b!==this.mainPaletteColors[e+1].b;){if(this.calcColorPositionInGradient(i))return i;i.r+=t,i.g+=n,i.b+=s}},calcColorPositionInGradient:function(e){for(var t=function(e,t,n){var s=255-e,i=Math.round(t-t*e/255);if(!(n<i||s<n)){var o=256/(s-i+1),r=(s-n)*o;return[this.clamp(Math.floor(r),0,255),this.clamp(Math.ceil(r+o-1),0,255)]}}.bind(this),n=function(e){for(var t=e[0][0],n=e[0][1],s=0;s<e.length;s++)e[s][0]>t&&(t=e[s][0]),e[s][1]<n&&(n=e[s][1]);return n<t?void 0:Math.round((n+t)/2)},s=0;s<256;s++){var i=t(s,e.r,this.color.r),o=t(s,e.g,this.color.g),r=t(s,e.b,this.color.b);if(
void 0!==i&&void 0!==o&&void 0!==r){var a=n([i,o,r]);if(void 0!==a)return{line:s,pixel:a}}}},createGradientSlider:function(){this.gradientSlider=new cc.Sprite(bundles.wysiwyg.frames.component_item),this.gradientContainer.addChild(this.gradientSlider)},updateGradientSlider:function(){var e=this.calcColorPositionInGradient(this.paletteColor),t=e.pixel/255*this.gradientContainer.width,n=this.gradientContainer.height-e.line/255*this.gradientContainer.height;this.gradientSlider.setPositionRound(t,n)},createPaletteSlider:function(){this.paletteSlider=new cc.Node,this.paletteSlider.setAnchorPoint2();var e=new cc.Sprite(bundles.wysiwyg.frames.preview_control);e.setRotation(-90),e.setScale(.5);var t=new cc.Sprite(bundles.wysiwyg.frames.preview_control);t.setRotation(90),t.setScale(.5),this.paletteSlider.setContentSize2(this.paletteContainer.width,e.height),this.paletteSlider.addChild(e),this.paletteSlider.addChild(t),e.setPositionRound(e.width/2*e.scale,this.paletteSlider.height/2),
t.setPositionRound(this.paletteSlider.width-e.width/2*e.scale,this.paletteSlider.height/2),this.paletteContainer.addChild(this.paletteSlider),this.paletteSlider.setPositionRound(this.paletteContainer.width/2,0)},calcPaletteSliderPosition:function(){for(var e=function(e,t,n){var s=t<n?t:n;return s<=e&&e<=(s===t?n:t)},t=0;t<this.mainPaletteColors.length-1;t++){var n=this.mainPaletteColors[t],s=this.mainPaletteColors[t+1];if(e(this.paletteColor.r,n.r,s.r)&&e(this.paletteColor.g,n.g,s.g)&&e(this.paletteColor.b,n.b,s.b)){var i=(255*t+(Math.abs(this.paletteColor.r-n.r)+Math.abs(this.paletteColor.g-n.g)+Math.abs(this.paletteColor.b-n.b)))/(255*(this.mainPaletteColors.length-1)+1);return cc.p(this.paletteSlider.x,this.paletteContainer.height-i*this.paletteContainer.height)}}},calcPaletteColorByLine:function(e){var t=Math.trunc(e/255),n=this.mainPaletteColors[t],s=this.mainPaletteColors[t+1],i=e%255;return s||(s=n),{r:n.r+cleverapps.sign(s.r-n.r)*i,g:n.g+cleverapps.sign(s.g-n.g)*i,
b:n.b+cleverapps.sign(s.b-n.b)*i}},createPalette:function(){var s=cleverapps.styles.ColorPickerWindow.palette;this.paletteContainer=new cc.Node,this.paletteContainer.setAnchorPoint2();var e=255*(this.mainPaletteColors.length-1)+1,t=ColorPicker.CreateTexture(s.width,e,function(e){var t=Math.trunc(Math.trunc(e/3)/s.width),n=this.calcPaletteColorByLine(t);return e%3==0?n.r:e%3==1?n.g:e%3==2?n.b:void 0}.bind(this)),n=this.palette=new cc.Sprite;return n.initWithTexture(t,cc.rect(0,0,s.width,e)),n.setScale(s.height/n.height),this.paletteContainer.setContentSize2(n.width*n.scale,n.height*n.scale),this.paletteContainer.addChild(n),cc.eventManager.addListener({event:cc.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:!0,onTouchBegan:function(e){var t=this.paletteContainer.convertTouchToNodeSpace(e);if(cc.rectContainsPoint(cc.rect(0,0,this.paletteContainer.width,this.paletteContainer.height),t))return this.setPaletteColorByPoint(t),!0}.bind(this),onTouchMoved:function(e){
this.setPaletteColorByPoint(this.paletteContainer.convertTouchToNodeSpace(e))}.bind(this)},this.paletteContainer),n.setPositionRound(this.paletteContainer.width/2,this.paletteContainer.height/2),this.paletteContainer},setPaletteColorByPoint:function(e){e.y=this.clamp(e.y,0,this.paletteContainer.height),this.paletteSlider.setPositionY(e.y);var t=Math.trunc(this.paletteContainer.height-e.y)/this.paletteContainer.height*this.palette.height;this.paletteColor=this.calcPaletteColorByLine(t),this.updateGradientThrottled(),this.setColorByPoint(this.gradientSlider.getPosition())},setColorByPoint:function(e){e.x=this.clamp(e.x,0,this.gradientContainer.width),e.y=this.clamp(e.y,0,this.gradientContainer.height),this.gradientSlider.setPosition(e),this.color=this.calcColorByPoint(e),this.updateRGBBoxes(),this.onChangeCallback(new cc.Color(this.color.r,this.color.g,this.color.b,255))},calcGradientColorPart:function(e,t,n){var s=255-e,i=n-n*(e/255);return Math.round(s-t/255*(s-i))},
calcGradientColor:function(e,t){return{r:this.calcGradientColorPart(e,t,this.paletteColor.r),g:this.calcGradientColorPart(e,t,this.paletteColor.g),b:this.calcGradientColorPart(e,t,this.paletteColor.b)}},updatePaletteSlider:function(){this.paletteSlider.setPositionRound(this.calcPaletteSliderPosition())},updateGradientThrottled:cleverapps.throttle(50,function(){this.updateGradient()}),updateGradient:function(){var e=ColorPicker.CreateTexture(256,256,function(e){var t=Math.trunc(e/3),n=Math.trunc(t/256),s=t%256;return e%3==0?this.calcGradientColorPart(n,s,this.paletteColor.r):e%3==1?this.calcGradientColorPart(n,s,this.paletteColor.g):e%3==2?this.calcGradientColorPart(n,s,this.paletteColor.b):void 0}.bind(this));this.gradient.initWithTexture(e,cc.rect(0,0,256,256)),this.gradient.setScale(this.gradientContainer.width/this.gradient.width,this.gradientContainer.height/this.gradient.height)},clamp:function(e,t,n){return Math.min(Math.max(t,e),n)},calcColorByPoint:function(e){var t=Math.round(
this.clamp(e.x,0,this.gradient.width)/this.gradient.width*255),n=Math.round((this.gradient.height-this.clamp(e.y,0,this.gradient.height))/this.gradient.height*255);return this.calcGradientColor(n,t)},createGradient:function(){var e=cleverapps.styles.ColorPickerWindow.gradient;return this.gradientContainer=new cc.Node,this.gradientContainer.setAnchorPoint2(),this.gradientContainer.setContentSize2(e.width,e.height),this.gradient=new cc.Sprite,this.gradientContainer.addChild(this.gradient),this.gradient.setPositionRound(this.gradientContainer.width/2,this.gradientContainer.height/2),cc.eventManager.addListener({event:cc.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:!0,onTouchBegan:function(e){var t=this.gradientContainer.convertTouchToNodeSpace(e);if(cc.rectContainsPoint(cc.rect(0,0,this.gradientContainer.width,this.gradientContainer.height),t))return this.setColorByPoint(t),!0}.bind(this),onTouchMoved:function(e){var t=this.gradientContainer.convertTouchToNodeSpace(e)
;this.setColorByPoint(t)}.bind(this)},this.gradientContainer),this.gradientContainer}});cleverapps.styles.ColorPickerWindow={margin:20,gradient:{width:300,height:300},palette:{width:200,height:300},paletteSlider:{height:3},editBox:{width:50,height:25,margin:20,labelMargin:5,bg:{padding:{x:5,y:5}}},bg:{padding:{x:10,y:10}}};var func=function(){var e=new ColorPicker(new cc.Color(120,200,120,255),{size:cc.size(100,100)}),t=cc.director.getRunningScene().scene;t.addChild(e),e.setPositionRound(t.width/2,t.height/2),e.setLocalZOrder(100),window.test=e},ActionsPropertyEditor=function(e,t,n){this.property=e,this.onChangeValueCallback=n,this.value=cleverapps.override({scenario:"",scenarios:{}},t),this.propertyEditors=[{name:e.name,items:Object.keys(this.value.scenarios),getters:[function(){return this.value.scenario}.bind(this)],setters:[function(e){this.value.scenario=e}.bind(this)]},{name:e.name+"Preview",largeField:!0,getters:[function(){return this.value.scenarios[this.value.scenario]}.bind(
this)],setters:[function(e){this.value.scenarios[this.value.scenario]=e}.bind(this)]}].map(function(e){return new PropertyEditor(e,this)}.bind(this))};ActionsPropertyEditor.prototype.editBoxEditingDidEnd=function(e){e.customSetter(e.getString()),this.onChangeValueCallback(this.property.name,this.value)};var PositionPropertyEditor=function(e,t,n){this.property=e,this.onChangeValueCallback=n,this.value=cleverapps.override({x:{align:"center",dx:0},y:{align:"center",dy:0}},t),this.propertyEditors=[{name:e.name+" x",items:["left","center","right"],getters:[function(){return this.value.x.align}.bind(this),function(){return this.value.x.dx}.bind(this)],setters:[function(e){this.value.x.align=e}.bind(this),function(e){this.value.x.dx=parseInt(e)||0}.bind(this)],subNames:["align","dx"]},{name:e.name+" y",items:["top","center","bottom"],getters:[function(){return this.value.y.align}.bind(this),function(){return this.value.y.dy}.bind(this)],setters:[function(e){this.value.y.align=e}.bind(this),
function(e){this.value.y.dy=parseInt(e)||0}.bind(this)],subNames:["align","dy"]}].map(function(e){return new PropertyEditor(e,this)}.bind(this))};PositionPropertyEditor.prototype.editBoxEditingDidEnd=function(e){e.customSetter(e.getString()),this.onChangeValueCallback(this.property.name,this.value)};var EditBoxPropertyEditor=function(e,t,n){this.property=e,this.onChangeValueCallback=n,this.value=t||(e.multiselect?[]:""),this.propertyEditors=[{name:e.name,type:e.type,items:e.items,getPreview:e.getPreview,multiselect:e.multiselect,largeField:e.largeField,getter:function(){return this.value}.bind(this),setter:function(e){this.value=e}.bind(this)}].map(function(e){return new PropertyEditor(e,this)}.bind(this))};EditBoxPropertyEditor.prototype.editBoxEditingDidEnd=function(e){var t="number"===this.property.type?parseFloat(e.getString()):e.getString();e.customSetter(t),this.onChangeValueCallback(this.property.name,this.value)},EditBoxPropertyEditor.prototype.editBoxTextChanged=function(e,t){
"number"===this.property.type&&e.setString(t.trim().replace(/(?:\r\n|\r|\n)/g,""))};var LocalizedTextPropertyEditor=function(e,t,n){this.property=e,this.onChangeValueCallback=n,this.value=t||{};var s=cleverapps.wysiwyg.hierarchy.getSelectedScenario().properties.languages,i=[{name:e.name,actions:[{translate:function(){cleverapps.RestClient.post("/admin/translate",{text:{en:this.value.en,ru:this.value.ru},languages:s},function(e){this.onChangeValueCallback(this.property.name,e),cleverapps.wysiwyg.inspector.showItemProperties()}.bind(this))}.bind(this)},{clear:function(){this.value={},this.onChangeValueCallback(this.property.name,this.value),cleverapps.wysiwyg.inspector.showItemProperties()}.bind(this)}]}];s.forEach(function(t){i.push({name:t,getter:function(){return this.value[t]}.bind(this),setter:function(e){this.value[t]=e}.bind(this)})}.bind(this)),this.propertyEditors=i.map(function(e){return new PropertyEditor(e,this)}.bind(this))}
;LocalizedTextPropertyEditor.prototype.editBoxEditingDidEnd=function(e){e.customSetter(e.getString()),this.onChangeValueCallback(this.property.name,this.value)};var FontPropertyEditor=function(e,t,n){this.property=e,this.onChangeValueCallback=n,this.value=cleverapps.override({color:new cc.Color,size:40,stroke:{color:new cc.Color,size:0},shadow:{color:new cc.Color,blur:0,direction:{width:0,height:0}}},t),this.propertyEditors=[{name:e.name,isBlock:!0},{name:"size",getter:function(){return this.value.size}.bind(this),setter:function(e){this.value.size=e}.bind(this)},{name:"color",type:"color",getter:function(){return this.value.color}.bind(this),setter:function(e){return this.value.color=e}.bind(this)},{name:"Stroke width",getter:function(){return this.value.stroke.size}.bind(this),setter:function(e){this.value.stroke.size=e}.bind(this)},{name:"Stroke color",type:"color",getter:function(){return this.value.stroke.color}.bind(this),setter:function(e){return this.value.stroke.color=e}.bind(
this)},{name:"Shadow",getters:[function(){return this.value.shadow.blur}.bind(this),function(){return this.value.shadow.direction.width}.bind(this),function(){return this.value.shadow.direction.height}.bind(this)],setters:[function(e){this.value.shadow.blur=e}.bind(this),function(e){this.value.shadow.direction.width=e}.bind(this),function(e){this.value.shadow.direction.height=e}.bind(this)],subNames:["blur","w","h"]},{name:"Shadow color",type:"color",getter:function(){return this.value.shadow.color}.bind(this),setter:function(e){return this.value.shadow.color=e}.bind(this)},{name:"",isBlock:!0}].map(function(e){return new PropertyEditor(e,this)}.bind(this))};FontPropertyEditor.prototype.editBoxEditingDidEnd=function(e){var t=e.getString();e instanceof cc.EditBox&&(t=parseInt(t)),e.customSetter(t),this.onChangeValueCallback(this.property.name,this.value)};var ImagePropertyEditor=function(e,t,n){this.property=e,this.onChangeValueCallback=n,this.value=cleverapps.override({bundle:"",
image:""},t);var s={noImage:!0};this.property.bundles.forEach(function(t){t.endsWith("*")?Object.keys(bundles).filter(function(e){return e.startsWith(t.replace("*",""))}).forEach(function(t){Object.keys(bundles[t].frames).concat(Object.keys(bundles[t].urls)).forEach(function(e){s[e]=t})}):Object.keys(bundles[t].frames).forEach(function(e){s[e]=t})}.bind(this)),this.propertyEditors=[{name:e.name,items:Object.keys(s),getter:function(){return this.value.image}.bind(this),setter:function(e){this.value="noImage"===e?void 0:{image:e,bundle:s[e]}}.bind(this),getPreview:function(e){if("noImage"!==e&&cleverapps.bundleLoader.isLoaded(s[e])&&bundles[s[e]].frames[e])return new cc.Sprite(bundles[s[e]].frames[e])}}].map(function(e){return new PropertyEditor(e,this)}.bind(this))};ImagePropertyEditor.prototype.editBoxEditingDidEnd=function(e){e.customSetter(e.getString()),this.onChangeValueCallback(this.property.name,this.value)};var SpinePropertyEditor=function(e,t,n){this.property=e,
this.onChangeValueCallback=n;var s=cc.loader.getRes(bundles[t.bundle].jsons[t.json]);if(s||(s=cc.loader.getRes(bundles.main.jsons[t.json])),s){var i=Object.keys(s.animations);-1===i.indexOf(t.animation)&&(t.animation=i[0])}this.value=cleverapps.override({bundle:"",json:"",animation:"",idle:"",looped:!1},t);var o={};AdsSpine.BUNDLES.forEach(function(t){Object.keys(bundles[t].jsons).forEach(function(e){"atlas"!==e&&(o[e]=t)})}.bind(this));var r={name:"json",items:Object.keys(o),getter:function(){return this.value.json}.bind(this),setter:function(e){this.value.json=e,this.value.bundle=o[e]}.bind(this),getPreview:function(e){if(bundles[o[e]].jsons[e]){var t=cc.loader.getRes(bundles[o[e]].jsons[e]);if(t||(t=cc.loader.getRes(bundles.main.jsons[e])),t){var n=Object.keys(t.animations),s=new cleverapps.Spine(bundles[o[e]].jsons[e]);return s.setAnimation(0,n[n.length-1],!0),s}}}},a={name:"animation",items:i,getter:function(){return this.value.animation}.bind(this),setter:function(e){
this.value.animation=e}.bind(this)},c={name:"idle",items:[" "].concat(i),getter:function(){return this.value.idle}.bind(this),setter:function(e){this.value.idle=" "===e?void 0:e}.bind(this)},l={name:"looped",items:["true","false"],getter:function(){return this.value.looped.toString()}.bind(this),setter:function(e){this.value.looped="true"===e}.bind(this)};this.propertyEditors=[{name:"Spine",isBlock:!0},r,a,c,l,{name:"",isBlock:!0}].map(function(e){return new PropertyEditor(e,this)}.bind(this))};SpinePropertyEditor.prototype.editBoxEditingDidEnd=function(e){e.customSetter(e.getString()),this.onChangeValueCallback(this.property.name,this.value),cleverapps.wysiwyg.inspector.showItemProperties()};var SoundPropertyEditor=function(e,t,n){this.property=e,this.onChangeValueCallback=n,this.value=cleverapps.override({bundle:"",sound:""},t);var s={noSound:!0};this.property.bundles.forEach(function(t){Object.keys(bundles[t].urls).forEach(function(e){s[e]=t})}.bind(this)),this.propertyEditors=[{
name:e.name,items:Object.keys(s),getter:function(){return this.value.sound}.bind(this),setter:function(e){this.value="noSound"===e?void 0:{sound:e,bundle:s[e]}}.bind(this),getPreview:function(e){if("noSound"!==e){var t=new cc.Sprite(bundles.wysiwyg.frames.sound_icon);return cleverapps.UI.onClick(t,function(){cleverapps.audio.playSound(bundles[s[e]].urls[e])}),cleverapps.UI.applyHover(t),t}}}].map(function(e){return new PropertyEditor(e,this)}.bind(this))};SoundPropertyEditor.prototype.editBoxEditingDidEnd=function(e){e.customSetter(e.getString()),this.onChangeValueCallback(this.property.name,this.value)};var LevelPropertyEditor=function(e,t,n){this.property=e,this.onChangeValueCallback=n,this.value=t||0;var o={},s={};cleverapps.wysiwyg.episode.getLevels().forEach(function(e){var t=Array.isArray(e)?e[0]:e,n=this.getLevelDescription(t);o[n]=t.levelNo,s[t.levelNo]=n},this),this.propertyEditors=[{name:"level",items:Object.keys(o),getter:function(){return s[this.value]}.bind(this),
setter:function(e){this.value=o[e]}.bind(this),getPreview:function(e){var t=AdminLevelMiniature[cleverapps.config.name]||AdminLevelMiniature[cleverapps.config.type];if(t){var n=o[e],s=cleverapps.wysiwyg.episode.getLevel(n);s.content=cleverapps.wysiwyg.episode.getLevelContent(n);var i=t("merge"===cleverapps.config.type?s:s.content);return"match3"===cleverapps.config.type&&(s.content.gameField=void 0),-1===["board","differences","match3"].indexOf(cleverapps.config.type)&&cleverapps.UI.onClick(i,function(){cc.director.getRunningScene().scene.removeAllChildren(),EditorScene.open({episodeNo:Episode.Types.ADS,levelNo:n})}),i}}}].map(function(e){return new PropertyEditor(e,this)}.bind(this))};LevelPropertyEditor.prototype.getLevelDescription=function(e){return"stacks"===cleverapps.config.subtype?e.hint:"tripeaks"===cleverapps.config.name?"No:"+e.levelNo+" cards:"+e.screens.reduce(function(e,t){return e+t.length},0):e.levelNo},LevelPropertyEditor.prototype.editBoxEditingDidEnd=function(e){
e.customSetter(e.getString()),this.onChangeValueCallback(this.property.name,this.value)};var ColorPropertyEditor=function(e,t,n){this.property=e,this.onChangeValueCallback=n,t=t||{},this.value=t||{color:cleverapps.styles.COLORS.WHITE},this.propertyEditors=[{name:e.name,type:"color",getter:function(){return this.value.color}.bind(this),setter:function(e){return this.value.color=e}.bind(this)}].map(function(e){return new PropertyEditor(e,this)}.bind(this))};ColorPropertyEditor.prototype.editBoxEditingDidEnd=function(e){e.customSetter(e.getString()),this.onChangeValueCallback(this.property.name,this.value)};var ScreenshotsPropertyEditor=function(e,t,n){this.property=e,this.onChangeValueCallback=n,this.value=cleverapps.override({frequency:0,amount:0,video:1},t),this.propertyEditors=[{name:e.name,isBlock:!0},{name:"params",getters:[function(){return this.value.frequency}.bind(this),function(){return this.value.amount}.bind(this)],setters:[function(e){this.value.frequency=parseFloat(e)||0
}.bind(this),function(e){this.value.amount=parseInt(e)||0}.bind(this)],subNames:["freq","amount"]},{name:"video",items:["only frames","save"],getter:function(){return["only frames","save"][this.value.video]}.bind(this),setter:function(e){return this.value.video=["only frames","save"].indexOf(e)}.bind(this)}].map(function(e){return new PropertyEditor(e,this)}.bind(this))};ScreenshotsPropertyEditor.prototype.editBoxEditingDidEnd=function(e){e.customSetter(e.getString()),this.onChangeValueCallback(this.property.name,this.value)},Scenarios.wysiwygScenario=function(e,r,t){var n=new ActionPlayer;CocosTransitions.init();var s=cleverapps.settings.language;cleverapps.settings.setLanguage(r.language),n.add(function(e){if($(SceneControlButtonsView).hide(),$(cc.EditBox).hide(),cleverapps.audio.unmute(),r.emulator)e();else{var t={};r.frameCapture&&0<r.frameCapture.frequency&&(t.frameCapture=Object.assign({},r.frameCapture,{frequency:1e3*r.frameCapture.frequency,path:r.path,baseName:r.name.replace(
"%{lang}",r.language)+"_"+r.sizes[r.resolutionName].width+"x"+r.sizes[r.resolutionName].height})),cleverapps.Recorder.start(e,t)}});var a=[];r.clips.forEach(function(o){n.add(function(e){var t=r.scene||cc.director.getRunningScene(),n=o.properties;if(!r.preview&&n.sceneTransition&&cc["Transition"+n.sceneTransition]){var s=new cc.Scene;s.scene=cc.director.getRunningScene().scene,cc.director.runScene(new cc["Transition"+n.sceneTransition](n.transitionTime/1e3,s)),n.transitionSound&&cleverapps.audio.playSound(bundles[n.transitionSound.bundle].urls[n.transitionSound.sound]),t=s}var i=new ClipNode(o,{size:r.sizes.video,emulator:r.emulator,onComplete:e,transitionTime:n.transitionTime});i.setPositionRound(t.width/2,t.height/2),i.setScale(t.width/i.width),t.addChild(i),a.push(i)})});var i=function(e){e(),a.forEach(function(e){e.destroy(),e.removeFromParent()}),$(SceneControlButtonsView).show(),$(cc.EditBox).show(),setTimeout(t,1e3)};n.add(function(e){r.emulator?i(e):cleverapps.Recorder.stop(
i.bind(this,e))}),n.add(function(e){cleverapps.settings.setLanguage(s),cleverapps.audio.mute(),cleverapps.audio.eject(),e()}),n.play()};var Hierarchy=function(e){this.wysiwyg=e,cleverapps.EventEmitter.call(this),this.items=[],this.selectedItem=void 0,this.directories=[]};Hierarchy.prototype=Object.create(cleverapps.EventEmitter.prototype),(Hierarchy.prototype.constructor=Hierarchy).prototype.load=function(t){cleverapps.RestClient.get("/wysiwyg?directory="+this.wysiwyg.directory,{},function(e){this.directories=e.directories;var s={},n=[HierarchyItem.createDirectory(this.wysiwyg.directory)];cleverapps.values(e.content).forEach(function(e){e.forEach(function(e){var t=new HierarchyItem(e);s[e.id]=t,n.push(t)})}),n.forEach(function(t){if(t.parent&&(t.parentItem=s[t.parent],delete t.parent),t.type===HierarchyItem.TYPE.COMPONENT){var e=this.wysiwyg.assets.components.filter(function(e){return e.name===t.assetName})[0],n=new SceneComponent({id:t.id,ctor:e.ctor,properties:t.properties})
;this.wysiwyg.wysiwygPreview.registerComponent(n)}}.bind(this)),this.setItems(n),0<n.length&&this.selectItem(t?n.filter(function(e){return e.id===t})[0]:n[0])}.bind(this),function(e){console.log(e)})},Hierarchy.prototype.save=function(e,t){if(e.type!==HierarchyItem.TYPE.DIRECTORY){var n=[e.toJSON()],s=[e.id];this.items.map(function(e){return e.toJSON()}).forEach(function(e){-1!==s.indexOf(e.parent)&&(n.push(e),s.push(e.id))});var i={directory:this.wysiwyg.directory,name:e.id,content:cleverapps.clone(n,!0)};cleverapps.RestClient.post("/wysiwyg/edit",i,function(){this.wysiwyg.wysiwygMenubar.gitButtons.checkStatus(),t&&t()}.bind(this),function(e){console.log(e.errorMessage||"Failure edit ads")}.bind(this))}},Hierarchy.prototype.moveItemUpOrDown=function(e){if(this.selectedItem&&this.selectedItem.parentItem){var t=this.selectedItem.parentItem.children.slice().sort(function(e,t){return this.items.indexOf(e)-this.items.indexOf(t)}.bind(this)),n=t.indexOf(this.selectedItem),s=t[n+e]
;s&&this.swapItems(this.selectedItem,s)}},Hierarchy.prototype.swapItems=function(e,t){var n=this.items.indexOf(e),s=this.items.indexOf(t);if(s<n){var i=s;s=n,n=i,i=t,t=e}var o=this.items.splice(s,this.getCountOfChildren(t)+1);this.items.splice.apply(this.items,[n,0].concat(o)),this.save(this.getSelectedScenario()),this.trigger("rebuildItems")},Hierarchy.prototype.addItem=function(e,t){if(e.parentItem){var n=this.items.indexOf(e.parentItem)+this.getCountOfChildren(e.parentItem);this.items.splice(n+1,0,e),e.parentItem.children.push(e)}else this.items.push(e);t||(this.trigger("rebuildItems"),this.selectItem(e),this.save(this.getSelectedScenario()))},Hierarchy.prototype.setItems=function(e){this.items=[],e.forEach(function(e){this.addItem(e,!0)}.bind(this)),this.trigger("rebuildItems")},Hierarchy.prototype.removeItem=function(t){var e=this.getItemScenario(t);if(this.items.filter(function(e){return e.parentItem===t}).forEach(function(e){this.removeItem(e)}.bind(this)),t.parentItem){
var n=t.parentItem.children.indexOf(t);-1<n&&t.parentItem.children.splice(n,1)}var s=this.items.indexOf(t);-1!==s&&(this.items.splice(s,1),this.trigger("rebuildItems")),0<this.items.length&&this.selectItem(this.items[0]),HierarchyItem.TYPE.SCENARIO===t.type?cleverapps.RestClient.post("/wysiwyg/remove",{directory:this.wysiwyg.directory,name:t.id},function(){cleverapps.setUrlHash({scenarioId:void 0}),this.wysiwyg.wysiwygMenubar.gitButtons.checkStatus()}.bind(this),function(e){console.log(e.errorMessage||"Failure edit ads")}.bind(this)):this.save(e)},Hierarchy.prototype.selectItem=function(e){this.selectedItem=e,this.trigger("selectionChanged",e),cleverapps.setUrlHash({scenarioId:this.getItemScenario(e)?this.getItemScenario(e).id:void 0})},Hierarchy.prototype.changeItemProperty=function(e,t,n){JSON.stringify(e.properties[t])!==JSON.stringify(n)&&(console.log("PROPERTY VALUE CHANGED: "+t+" : "+JSON.stringify(e.properties[t])+" -> "+JSON.stringify(n)),e.properties[t]=cleverapps.clone(n,!0),
this.save(this.getItemScenario(e)),-1!==["caption","visible"].indexOf(t)&&this.trigger("rebuildItems"),this.trigger("itemPropertyChanged",e,t))},Hierarchy.prototype.getCountOfChildren=function(e){var t=0;return e.children.forEach(function(e){t++,t+=this.getCountOfChildren(e)}.bind(this)),t},Hierarchy.prototype.getSelectedScenario=function(){if(this.selectedItem){for(var e=this.selectedItem;e.parentItem;)e=e.parentItem;return e.type===HierarchyItem.TYPE.SCENARIO?e:void 0}},Hierarchy.prototype.getItemScenario=function(e){for(;e&&e.type!==HierarchyItem.TYPE.SCENARIO;)e=e.parentItem;return e},Hierarchy.prototype.getNewScenarioIndex=function(){for(var t=0;t++,0<this.items.filter(function(e){return!e.parentItem&&e.id==="scenario_"+t}).length;);return t},Hierarchy.prototype.getNewClipIndex=function(t){for(var n=0;n++,0<this.wysiwyg.hierarchy.items.filter(function(e){return e.parentItem===t&&e.id===e.parentItem.id+"_clip_"+n}.bind(this)).length;);return n},
Hierarchy.prototype.pasteItem=function(e){var s=void 0,i=function(e,t){var n=e.clone(t);e.type===HierarchyItem.TYPE.SCENARIO&&(s=n),this.addItem(n,!0),e.children.forEach(function(e){i(e,n)}.bind(this))}.bind(this);i(e,this.selectedItem);var t=this.selectedItem.id;this.save(s||this.getSelectedScenario(),function(){this.load(t)}.bind(this))};var Inspector=function(e){this.wysiwyg=e,cleverapps.EventEmitter.call(this),e.hierarchy.selectedItem&&this.showItemProperties(this.wysiwyg.hierarchy.selectedItem),this.wysiwyg.wysiwygPreview.on("previewShown",this.showItemProperties.bind(this))};Inspector.prototype=Object.create(cleverapps.EventEmitter.prototype),(Inspector.prototype.constructor=Inspector).prototype.showItemProperties=function(e){var t=[{name:"caption",type:"string"}];switch((e=e||this.wysiwyg.hierarchy.selectedItem).type){case HierarchyItem.TYPE.SCENARIO:t=t.concat([{name:"languages",type:"string",items:Wysiwyg.LANGUAGES,multiselect:!0},{name:"resolution",type:"string",
items:Object.keys(Wysiwyg.VIDEO_SIZES)},{name:"frameCapture",type:"frameCapture",items:Object.keys(Wysiwyg.VIDEO_SIZES)}]);break;case HierarchyItem.TYPE.CLIP:t=t.concat([{name:"bg",type:"image",bundles:["ads_backgrounds_*"]},{name:"bgPosition",type:"position"}]),e.parentItem.children[0].id!==e.id&&(t=t.concat([{name:"sceneTransition",type:"string",items:["none","ProgressInOut","ProgressOutIn","ProgressRadialCCW","ProgressRadialCW","ProgressVertical","ProgressHorizontal","CrossFade","Fade","FadeTR","JumpZoom","MoveInL","PageTurn","RotoZoom","SceneOriented","ShrinkGrow","SlideInL","SlideInR","TurnOffTiles","SplitCols","SlideInB","SlideInT"]},{name:"transitionTime",type:"number"},{name:"transitionSound",type:"sound",bundles:["ads_transition"]}]));break;case HierarchyItem.TYPE.COMPONENT:window[e.assetName]&&window[e.assetName].PROPERTIES&&(t=t.concat(window[e.assetName].PROPERTIES)),t=t.concat([{name:"position",type:"position"},{name:"height",type:"number"},{name:"width",type:"number"},{
name:"scale",type:"number"},{name:"rotation",type:"number"},{name:"delay",type:"number"},{name:"zOrder",type:"number"},{name:"disappearAfter",type:"number"}]);break;case HierarchyItem.TYPE.DIRECTORY:t=[]}this.trigger("fillProperties",t,cleverapps.clone(e.properties,!0)||{})},Inspector.prototype.propertyChanged=function(e,t){this.wysiwyg.hierarchy.changeItemProperty(this.wysiwyg.hierarchy.selectedItem,e,t)};var WysiwygPreview=function(e){this.wysiwyg=e,cleverapps.EventEmitter.call(this),this.componentsByIds={},this.wysiwyg.hierarchy.on("selectionChanged",this.showComponents.bind(this)),this.wysiwyg.hierarchy.on("itemPropertyChanged",this.itemPropertyChanged.bind(this)),this.enabled=!0};WysiwygPreview.prototype=Object.create(cleverapps.EventEmitter.prototype),(WysiwygPreview.prototype.constructor=WysiwygPreview).prototype.registerComponent=function(e){this.componentsByIds[e.id]=e},WysiwygPreview.prototype.showComponents=function(t){t&&(t.type===HierarchyItem.TYPE.DIRECTORY?(this.clear(),
this.enabled&&this.trigger("showDirectory",this.wysiwyg.hierarchy.items.filter(function(e){return e.type===HierarchyItem.TYPE.SCENARIO}))):(this.canvasSize=Wysiwyg.VIDEO_SIZES[cleverapps.wysiwyg.hierarchy.getSelectedScenario().properties.resolution]||Wysiwyg.VIDEO_SIZES.portrait_720x1080,this.enabled&&this.trigger("showLoading"),this.wysiwyg.prepareClips(t,function(e){this.clear(),this.enabled&&(this.trigger("showComponents",e),this.selectComponent(t)),this.trigger("previewShown",t)}.bind(this))))},WysiwygPreview.prototype.itemPropertyChanged=function(e){e.type===HierarchyItem.TYPE.COMPONENT?this.trigger("updateComponent",e):this.showComponents(cleverapps.wysiwyg.hierarchy.selectedItem)},WysiwygPreview.prototype.selectComponent=function(e){this.trigger("selectComponent",e)},WysiwygPreview.prototype.clear=function(){this.trigger("clearComponents")},WysiwygPreview.prototype.toggleState=function(){this.enabled=!this.enabled,this.showComponents(cleverapps.wysiwyg.hierarchy.selectedItem)}
;var WysiwygMenubar=function(e){this.wysiwyg=e,cleverapps.EventEmitter.call(this),this.copiedItem=void 0,this.wysiwyg.hierarchy.on("selectionChanged",this.updateTools.bind(this))};WysiwygMenubar.prototype=Object.create(cleverapps.EventEmitter.prototype),(WysiwygMenubar.prototype.constructor=WysiwygMenubar).prototype.updateTools=function(){var e=this.wysiwyg.hierarchy.selectedItem?this.wysiwyg.hierarchy.selectedItem.type:void 0;if(e&&e===HierarchyItem.TYPE.DIRECTORY)return this.trigger("updateTool","Add item",!0),this.trigger("updateTool","Copy",!1),this.trigger("updateTool","Paste",this.copiedItem&&this.copiedItem.type===HierarchyItem.TYPE.SCENARIO),this.trigger("updateTool","Delete item",!1),this.trigger("updateTool","IPhone preview",!1),this.trigger("updateTool","Fullscreen preview",!1),this.trigger("updateTool","Generate video",!0),void this.trigger("updateTool","Add scenario task",void 0);this.trigger("updateTool","Add item",e===HierarchyItem.TYPE.SCENARIO),this.trigger(
"updateTool","Copy",void 0!==e),this.copiedItem&&(e===HierarchyItem.TYPE.SCENARIO&&this.copiedItem.type===HierarchyItem.TYPE.CLIP||-1!==[HierarchyItem.TYPE.CLIP,HierarchyItem.TYPE.COMPONENT].indexOf(e)&&this.copiedItem.type===HierarchyItem.TYPE.COMPONENT)?this.trigger("updateTool","Paste",!0):this.trigger("updateTool","Paste",!1),this.trigger("updateTool","Delete item",void 0!==e),this.trigger("updateTool","IPhone preview",!0),this.trigger("updateTool","Fullscreen preview",!0),this.trigger("updateTool","Generate video",!0),this.trigger("updateTool","Add scenario task",void 0)},WysiwygMenubar.TOOLS=[{caption:"Add item",icon:bundles.wysiwyg.frames.plus,key:"a",processor:function(){var e=this.wysiwyg.hierarchy;if(e.selectedItem)if(e.selectedItem.type===HierarchyItem.TYPE.DIRECTORY){var t=HierarchyItem.createScenario("scenario_"+e.getNewScenarioIndex());e.addItem(t),e.addItem(HierarchyItem.createClip("clip_"+e.getNewClipIndex(e.getSelectedScenario()),t))
}else e.selectedItem.type===HierarchyItem.TYPE.SCENARIO&&e.addItem(HierarchyItem.createClip("clip_"+e.getNewClipIndex(e.getSelectedScenario()),e.selectedItem))}},{caption:"Copy",icon:bundles.wysiwyg.frames.copy,key:"c",processor:function(){this.copiedItem=this.wysiwyg.hierarchy.selectedItem,this.updateTools()}},{caption:"Paste",icon:bundles.wysiwyg.frames.paste,key:"v",processor:function(){this.wysiwyg.hierarchy.pasteItem(this.copiedItem),this.copiedItem=void 0,this.updateTools()}},{caption:"Delete item",icon:bundles.wysiwyg.frames.delete,key:"z",processor:function(){window.confirm("Selected item will be removed. Continue?")&&this.wysiwyg.hierarchy.removeItem(this.wysiwyg.hierarchy.selectedItem)}},{caption:"Move up",icon:bundles.wysiwyg.frames.move_up,key:"up",processor:function(){this.wysiwyg.hierarchy.moveItemUpOrDown(-1)}},{caption:"Move down",icon:bundles.wysiwyg.frames.move_down,key:"down",processor:function(){this.wysiwyg.hierarchy.moveItemUpOrDown(1)}},{caption:"IPhone preview",
icon:bundles.wysiwyg.frames.iphone_icon,key:"enter",processor:function(){var e=this.wysiwyg.hierarchy.getSelectedScenario();e&&e.type!==HierarchyItem.TYPE.DIRECTORY&&this.wysiwyg.previewVideo(e)}},{caption:"Fullscreen preview",icon:bundles.wysiwyg.frames.fullscreen_icon,key:"g",processor:function(){var e=this.wysiwyg.hierarchy.getSelectedScenario();e&&e.type!==HierarchyItem.TYPE.DIRECTORY&&this.wysiwyg.generateVideo(e,!0,function(){cleverapps.setupDesignResolution(),WysiwygScene.open(cleverapps.wysiwyg,e.id)})}},{caption:"Generate video",icon:bundles.wysiwyg.frames.video_icon,key:"g",processor:function(){var t=this.wysiwyg.hierarchy.selectedItem.type===HierarchyItem.TYPE.DIRECTORY?this.wysiwyg.hierarchy.selectedItem:this.wysiwyg.hierarchy.getSelectedScenario();if(t.type===HierarchyItem.TYPE.DIRECTORY){var e=new ActionPlayer;this.wysiwyg.hierarchy.items.filter(function(e){return e.type===HierarchyItem.TYPE.SCENARIO}).forEach(function(t){e.add(function(e){
this.wysiwyg.hierarchy.selectedItem=t,this.wysiwyg.generateVideo(t,!1,function(){cleverapps.setupDesignResolution(),WysiwygScene.open(cleverapps.wysiwyg,t.id,e)})}.bind(this))}.bind(this)),e.add(function(e){cleverapps.setupDesignResolution(),WysiwygScene.open(cleverapps.wysiwyg,t.id,e)}.bind(this)),e.play()}else this.wysiwyg.generateVideo(t,!1,function(){cleverapps.setupDesignResolution(),WysiwygScene.open(cleverapps.wysiwyg,t.id)})}},{caption:"Add scenario task",icon:bundles.wysiwyg.frames.plus,key:"t",exportMethods:["updateStatus","isLoadingTask"],processor:function(){var e=cleverapps.wysiwyg.hierarchy.selectedItem;if(e&&e.type!==HierarchyItem.TYPE.DIRECTORY){var t=cleverapps.wysiwyg.getCurrentScenario();cleverapps.taskManager.addTask(WorkerTask.TYPES.ADVIDEO,{scenario:cleverapps.wysiwyg.directory+"/"+t.id,onCreated:function(){this.trigger("updateTool","Add scenario task",!0)}.bind(this),onComplete:function(e){cleverapps.Notification.create("Finished recording "+t.properties.caption)
,console.log(t.properties.caption+" result:",e),this.trigger("updateTool","Add scenario task",!0)}.bind(this)})}},updateStatus:function(e){var t=cleverapps.wysiwyg.getCurrentScenario();if(t!==this.selectedScenario||!0===e){this.selectedScenario=t;var n=cleverapps.wysiwyg.hierarchy.selectedItem;if(!n||n.type===HierarchyItem.TYPE.DIRECTORY)return this.setLoadingState(!1),this.disable(),void this.setOpacity(100);this.setLoadingState(!0),this.setOpacity(255),this.isLoadingTask(function(e){e?this.setLoadingState(!0):(this.setLoadingState(!1),this.enable())}.bind(this))}},isLoadingTask:function(e){var t=cleverapps.wysiwyg.getCurrentScenario();if(!t)return!1;cleverapps.taskManager.isScheduledTask({type:WorkerTask.TYPES.ADVIDEO,params:{scenario:cleverapps.wysiwyg.directory+"/"+t.id}},e)}}];var Wysiwyg=function(e){this.assets=new Assets(this),this.hierarchy=new Hierarchy(this),this.wysiwygPreview=new WysiwygPreview(this),this.inspector=new Inspector(this),this.wysiwygMenubar=new WysiwygMenubar(
this),this.directory=e||Wysiwyg.DEFAULT_DIRECTORY,this.wysiwygMenubar.gitButtons=new GitButtons("cleverapps/res/"+cleverapps.config.name+"/"+this.directory),this.wysiwygMenubar.gitButtons.checkStatus(),this.hasChanges=!1,this.wysiwygMenubar.gitButtons.on("statusChanged",this.handleGitStatusChanged.bind(this)),cleverapps.setUrlHash({wysiwyg:!0,directory:this.directory})};Wysiwyg.prototype.handleGitStatusChanged=function(e){if(e===GitButtons.CAN_PUSH&&(this.hasChanges=!0),e===GitButtons.NO_CHANGES&&this.hasChanges){this.hasChanges=!1;var t=this.hierarchy.selectedItem.id;this.hierarchy.load(t)}},Wysiwyg.prototype.showUp=function(e){this.hierarchy.load(e)},Wysiwyg.prototype.addComponent=function(e,t,n){var s=this.hierarchy.items.filter(function(e){return e.id===t})[0];if(s&&s.type!==HierarchyItem.TYPE.SCENARIO){var i={position:n,scale:1,rotation:0,zOrder:0,caption:e.preview.caption,visible:!0};window[e.name]&&window[e.name].PROPERTIES&&window[e.name].PROPERTIES.forEach(function(e){
"function"==typeof e.value?i[e.name]=e.value():void 0!==e.value&&(i[e.name]=e.value)});var o=new SceneComponent({ctor:e.ctor,properties:i});this.wysiwygPreview.registerComponent(o);var r=new HierarchyItem({type:HierarchyItem.TYPE.COMPONENT,parentItem:s,id:o.id,assetName:e.name,properties:i});this.hierarchy.addItem(r)}},Wysiwyg.prototype.previewVideo=function(t){this.prepareClips(t,function(e){cc.director.getRunningScene().showInEmulator(Scenarios.wysiwygScenario,{preview:!0,language:t.properties.languages?t.properties.languages[0]:"en",sizes:{video:Wysiwyg.VIDEO_SIZES[t.properties.resolution]||Wysiwyg.VIDEO_SIZES.portrait_720x1080},clips:e})})},Wysiwyg.prototype.generateVideo=function(t,n,s){cc.director.getRunningScene().scene.removeAllChildren();var i=t.properties;this.prepareClips(t,function(e){ScenarioHelper.runScenarios([Scenarios.wysiwygScenario],{video:i.frameCapture&&!i.frameCapture.video?ScenarioHelper.VIDEO_ACTION.NO_SAVE:ScenarioHelper.VIDEO_ACTION.SAVE,
path:this.directory.replace(Wysiwyg.DEFAULT_DIRECTORY,"promo/ads")+"/"+i.caption.replace(" ","_")+"/",name:"video_%{lang}",sizes:{video:Wysiwyg.VIDEO_SIZES[i.resolution]},skin:t.id,languages:i.languages,previewMode:n,frameCapture:i.frameCapture,onLanguageChanged:function(e,t){this.loadEpisode(t)}.bind(this),clips:e,callback:s})}.bind(this))},Wysiwyg.prototype.prepareClips=function(e,t){var n=[],s=[],i=!1,o=function(e){return s=s.concat(this.getRequiredBundles(e.properties,e.assetName)),e.children.map(function(e){e.properties&&e.properties.isGame&&(i=!0),s=s.concat(this.getRequiredBundles(e.properties,e.assetName));var t=this.wysiwygPreview.componentsByIds[e.id];return t.components=o(e),t}.bind(this))}.bind(this);switch(e.type){case HierarchyItem.TYPE.SCENARIO:e.children.forEach(function(e){n.push({id:e.id,properties:e.properties,components:o(e)})});break;case HierarchyItem.TYPE.CLIP:n.push({id:e.id,properties:e.properties,components:o(e)});break;case HierarchyItem.TYPE.COMPONENT:for(
var r=e.parentItem;r.type!==HierarchyItem.TYPE.CLIP;)r=r.parentItem;n.push({id:r.id,properties:r.properties,components:o(r)})}cleverapps.bundleLoader.loadBundles(cleverapps.unique(s),{onSuccess:function(){i?this.loadEpisode(t.bind(this,n)):t(n)}.bind(this)})},Wysiwyg.prototype.getCurrentScenario=function(){if(this.hierarchy.selectedItem)switch(this.hierarchy.selectedItem.type){case HierarchyItem.TYPE.SCENARIO:return this.hierarchy.selectedItem;case HierarchyItem.TYPE.CLIP:return this.hierarchy.selectedItem.parentItem;case HierarchyItem.TYPE.COMPONENT:return this.hierarchy.selectedItem.parentItem.parentItem}},Wysiwyg.prototype.loadEpisode=function(e){e=cleverapps.wait(2,e);var t=new Episode(Episode.Types.ADS);t.loadData(),t.whenLoaded(function(){this.episode=t,e()}.bind(this)),bundles["extra_"+cleverapps.settings.language]?cleverapps.bundleLoader.loadBundles(["extra_"+cleverapps.settings.language],{onSuccess:e}):e()},Wysiwyg.prototype.getRequiredBundles=function(t,e){if(
!t||"object"!=typeof t)return[];var n=[];return e&&window[e].BUNDLES&&(n=window[e].BUNDLES),t.bundle&&n.push(t.bundle),Object.keys(t).forEach(function(e){n=n.concat(this.getRequiredBundles(t[e]))}.bind(this)),n},Wysiwyg.VIDEO_SIZES={portrait_720x1080:{width:720,height:1080},portrait_720x1280:{width:720,height:1280},portrait_1080x1350:{width:1080,height:1350},portrait_1200x1500:{width:1200,height:1500},portrait_1242x2208:{width:1242,height:2208},portrait_1284x2778:{width:1284,height:2778},portrait_1600x2560:{width:1600,height:2560},portrait_2048x2732:{width:2048,height:2732},square_1000x1000:{width:1e3,height:1e3},square_1080x1080:{width:1080,height:1080},square_1200x1200:{width:1200,height:1200},landscape_1200x628:{width:1200,height:628},landscape_1600x1200:{width:1600,height:1200},landscape_1920x886:{width:1920,height:886},landscape_1920x1080:{width:1920,height:1080},landscape_2160x1214:{width:2160,height:1214},landscape_2208x1242:{width:2208,height:1242},landscape_2560x1600:{
width:2560,height:1600},landscape_2732x2048:{width:2732,height:2048},landscape_2778x1284:{width:2778,height:1284}},Wysiwyg.LANGUAGES=["de","en","ru","es","fr","it","ja","nl","pt","ar","ko","tr","zh","pl","lv"],Wysiwyg.EVENTS={GAME_STARTED:"gameStarted",PROGRESS_CHANGED:"progressChanged",CLIP_COMPLETED:"clipCompleted",CLIP_STARTED:"clipStarted"},Wysiwyg.DEFAULT_DIRECTORY="wysiwyg";var WysiwygScene=cleverapps.FixedWidthScene.extend({ctor:function(e,t){this._super(cleverapps.Environment.SCENE_WYSIWYG),this.wysiwyg=e;var n=cc.director.getWinSize(),s=n.height-cleverapps.styles.AssetsView.height-cleverapps.styles.WysiwygMenubarView.height-2*cleverapps.styles.WysiwygScene.margin,i=n.width-cleverapps.styles.HierarchyView.width-cleverapps.styles.InspectorView.width,o=this.hierarchyView=new HierarchyView(this.wysiwyg.hierarchy,{height:s}),r=this.wysiwygPreviewView=new WysiwygPreviewView(this.wysiwyg.wysiwygPreview,{height:s,width:i}),a=this.inspectorView=new InspectorView(this.wysiwyg.inspector,
{height:s});o.setLocalZOrder(2),r.setLocalZOrder(1),a.setLocalZOrder(2);var c=new cleverapps.Layout([o,r,a],{direction:cleverapps.UI.HORIZONTAL}),l=new WysiwygMenubarView(this.wysiwyg.wysiwygMenubar),p=new AssetsView(cleverapps.wysiwyg.assets),d=new cleverapps.Layout([p,c,l],{direction:cleverapps.UI.VERTICAL,margin:cleverapps.styles.WysiwygScene.margin});if(d.setAnchorPoint2(0,0),d.setPositionRound(0,0),this.scene.addChild(d),this.wysiwyg.showUp(t),cleverapps.flags.reset(),1!==resolutionScale)throw"resolutionScale should be 1 to work with video in WYSIWYG"},setBackground:function(){this.background&&this.background.removeFromParent();var e=cc.director.getWinSize(),t=this.background=new cc.LayerColor(new cc.Color(255,255,255,255),e.width,e.height);t.setAnchorPoint(.5,.5),t.setPositionRound(0,-cleverapps.UI.getSceneOffsetY()),t.setLocalZOrder(-10),this.updateBackgroundScale(),this.scene.addChild(t)},showInEmulator:function(e,t){var n=cleverapps.styles.WysiwygScene.emulator,
s=t.sizes.video.width<t.sizes.video.height,i=n.width/(s?t.sizes.video.width:t.sizes.video.height),o=t.sizes.video.width*i,r=t.sizes.video.height*i,a=new cleverapps.UI.createScale9Sprite(bundles.wysiwyg.frames.emulator);a.setAnchorPoint2(),a.setPositionRound(this.width/2,this.height/2),a.setContentSize(n.width+n.padding.x,n.height+n.padding.y),s||a.setRotation(-90),this.addChild(a);var c=new cc.Sprite(bundles.wysiwyg.frames.delete);c.setPositionRound(n.closeButton),cleverapps.UI.applyHover(c),a.addChild(c);var l=this.emulatorScene=new cc.Node;l.setAnchorPoint2(),l.setPositionRound(n),l.setContentSize(o,r),s||l.setRotation(90),a.addChild(l),t.scene=l,t.emulator=!0,e({},t,function(){a.removeFromParent(),this.setBackground()}.bind(this)),cleverapps.UI.onClick(c,function(){a.removeFromParent()}),cleverapps.UI.onDrag(a,{onDragMove:function(e){a.setPositionRound(a.parent.convertTouchToNodeSpace(e.touch))}.bind(this),onDragEnd:function(){}})},closeAction:function(){cleverapps.audio.unmute(),
cleverapps.config.wysiwygMode=!1,Game.currentGame=void 0,cleverapps.FixedWidthScene.prototype.closeAction.call(this)},getAudioStyles:function(){return{res:void 0,delay:0}}});WysiwygScene.open=function(t,n,s){cleverapps.audio.mute(),cleverapps.metha.display({focus:"wysiwyg",action:function(e){cleverapps.config.wysiwygMode=!0,cleverapps.scenes.replaceScene(new WysiwygScene(t,n),function(){s&&s(),e()})}})},cleverapps.styles.WysiwygScene={margin:4,emulator:{padding:{x:40,y:100},width:375,height:812,x:{align:"center"},y:{align:"center",dy:-10},closeButton:{x:{align:"right",dx:-24},y:{align:"top",dy:-18}}}},WysiwygScene.BUNDLES=function(){return["wysiwyg","game"]},WysiwygScene.IS_WIDE=!0,function(){var o=cleverapps.getRequestParameters(location.hash);if(o.wysiwyg&&(cleverapps.isLocalhost()||cleverapps.isStagingHost())){cleverapps.config.workerTaskId=o.workerTaskId;o.generate&&o.scenarioId&&(cleverapps.config.nologin=!0),cleverapps.Plot.onStartup=function(e,t){if(t)return WysiwygScene
;cleverapps.wysiwyg||(cleverapps.wysiwyg=new Wysiwyg(o.directory));var n=cleverapps.wysiwyg;Game.currentGame&&(Game.currentGame.stop(),Game.currentGame=void 0),cleverapps.config.wysiwygMode=!0;var s=new WysiwygScene(n,o.scenarioId);if(cleverapps.scenes.replaceScene(s,e),o.generate&&o.scenarioId){var i=n.wysiwygPreview.on("previewShown",function(){i.clear(),n.generateVideo(n.hierarchy.getSelectedScenario(),!1,function(){var e;cleverapps.setupDesignResolution(),WysiwygScene.open(n,o.scenarioId),cleverapps.config.workerTaskId&&(e=cleverapps.waitNoMore(5e3,function(){window.close()}),cleverapps.RestClient.get("http://localhost:3201/chrome/close",{},e,e))})}.bind(this),s);cleverapps.setUrlHash({generate:void 0})}}}}();var WysiwygWindowBase=cc.Node.extend({ctor:function(e,t,n){this._super(),this.setContentSize2(t,n),this.setAnchorPoint2(),this.setLocalZOrder(10);var s=cleverapps.styles.WysiwygWindowBase,i=new cleverapps.UI.createScale9Sprite(bundles.wysiwyg.frames.window_bg)
;i.setAnchorPoint2(),i.setContentSize(t-s.bg.padding,n-s.bg.padding),i.setPositionRound(this.width/2,this.height/2),this.addChild(i,-1)},createScroll:function(e){this.scroll&&this.scroll.removeFromParent(!0);var t=this.scroll=new cleverapps.UI.ScrollView(void 0,{childrenVisibility:cleverapps.UI.ScrollView.CHILDREN_VISIBILITY_FULLCHECK}),n=cleverapps.styles.WysiwygWindowBase,s=this.height-n.topOffset;t.setInnerContent(e),t.setContentSize2(this.width,s),e.height<s&&t.centerNode.setPositionRound(t.width/2,s-e.height/2),t.setAnchorPoint2(0,0),t.setPositionRound(0,0),this.addChild(this.scroll)}});cleverapps.styles.WysiwygWindowBase={bg:{padding:8},topOffset:20},cleverapps.overrideFonts(cleverapps.styles.FONTS,{WYSIWYG_HEADER_TEXT:{size:20,color:cleverapps.styles.COLORS.COLOR_DARK_GRAY,font:bundles.wysiwyg.urls.strict_font_ttf}});var AssetsView=WysiwygWindowBase.extend({ctor:function(e){this._super("Assets",cc.director.getWinSize().width,cleverapps.styles.AssetsView.height),this.assets=e,
this.showComponents()},showComponents:function(){var e=cleverapps.styles.AssetsView,t=this.assets.components.map(function(e){return new AssetComponentView(e)}),n=new cleverapps.Layout(t,{direction:cleverapps.UI.HORIZONTAL,margin:e.components.margin}),s=new cleverapps.UI.ScrollView(void 0,{direction:cleverapps.UI.ScrollView.DIR_HORIZONTAL,childrenVisibility:cleverapps.UI.ScrollView.CHILDREN_VISIBILITY_LINEAR});s.setInnerContent(n),s.setContentSize2(this.getContentSize()),s.setAnchorPoint2(0,.5),s.setBarPadding(e.scroll),s.setPositionRound(e.components),this.addChild(s),s.scrollToDefault()}});cleverapps.styles.AssetsView={height:150,components:{margin:10,x:{align:"left",dx:30},y:{align:"center"}},scroll:{cornerPadding:10,sidePadding:10}};var ClipNode=cc.Node.extend({ctor:function(e,t){if(this._super(),this.options=t,this.clip=e,this.setAnchorPoint2(),this.setContentSize(t.size),t.preview||t.emulator){this.content=new cc.Node,this.content.setContentSize(t.size)
;var n=new cleverapps.UI.ScrollView(this.content,{scrollBarEnabled:!1});n.setContentSize(this.width+cleverapps.styles.ClipNode.scroll.padding,this.height+cleverapps.styles.ClipNode.scroll.padding),n.setPositionRound(this.width/2,this.height/2),this.addChild(n)}else this.content=this;this.eventBus=new cleverapps.EventEmitter;var s=e.properties.bg;if(s&&s.bundle&&bundles[s.bundle]&&bundles[s.bundle].urls[s.image]){var i=cleverapps.UI.createSprite(bundles[s.bundle].urls[s.image]);i.setScale(Math.max(t.size.width/i.width,t.size.height/i.height,1));var o=t.size.width/i.scale,r=t.size.height/i.scale;i.setTextureRect(cc.rect(i.width/2-o/2,i.height/2-r/2,o,r)),i.setAnchorPoint2(),e.properties.bgPosition?i.setPositionRound(e.properties.bgPosition):i.setPositionRound(this.width/2,this.height/2),i.setTag("clipBg"),this.content.addChild(i,-1)}if(this.componentViews={},this.createComponents(this.clip.components,this.content),t.preview){var a=cleverapps.UI.createScale9Sprite(
bundles.wysiwyg.frames.component_frame);a.setAnchorPoint2(),a.setContentSize(this.getContentSize()),a.setPositionRound(this.width/2,this.height/2),this.content.addChild(a)}t.onComplete&&this.eventBus.on(Wysiwyg.EVENTS.CLIP_COMPLETED,t.onComplete,this)},onEnter:function(){this._super(),this.options.preview||this.eventBus.trigger(Wysiwyg.EVENTS.CLIP_STARTED,this.options.transitionTime)},createComponents:function(e,t){e.sort(function(e,t){return e.properties.isGame?-1:t.properties.isGame?1:0}).forEach(function(e){e.properties.showOnEvent&&"none"!==e.properties.showOnEvent&&!this.options.preview?this.eventBus.on(e.properties.showOnEvent,function(){setTimeout(this.addNestedComponent.bind(this,e,t),e.properties.delay)}):e.properties.delay&&!this.options.preview?setTimeout(this.addNestedComponent.bind(this,e,t),e.properties.delay):this.addNestedComponent(e,t)}.bind(this))},addNestedComponent:function(e,t){e.properties.isPreview=this.options.preview;var n=new SceneComponentView(e,this.eventBus
);return e.properties.isGame&&(this.gameComponent=n.componentInstance),this.componentViews[e.id]=n,this.createComponents(e.components,n),t.addChild(n),t.componentInstance&&t.componentInstance.nestedComponents.push(n.componentInstance),n},redrawComponent:function(e){if(this.componentViews[e.id]){var t=this.componentViews[e.id].getParent();this.componentViews[e.id].removeFromParent();var i=function(e,t){var n=e.components.filter(function(e){return e.id===t});if(0<n.length)return n[0];for(var s=0;s<e.components.length;s++)if(n=i(e.components[s],t))return n};this.addNestedComponent(i(this.clip,e.id),t).updateItemTools(!0)}},selectComponent:function(n){Object.keys(this.componentViews).forEach(function(e){var t=parseInt(e);this.componentViews[t].updateItemTools(t===n.id)}.bind(this))},destroy:function(){this.gameComponent&&(this.gameComponent.cleanup(),this.gameComponent=void 0),this.eventBus.purge()}});cleverapps.styles.ClipNode={scroll:{padding:5}}
;var DirectoryView=cleverapps.Layout.extend({ctor:function(e){var t=cleverapps.styles.DirectoryView,n=cleverapps.wysiwyg.hierarchy,s=e.map(function(e){return new cleverapps.UI.Button({width:t.button.width,height:t.button.height,button_png:bundles.wysiwyg.frames.button_on,button_on_png:bundles.wysiwyg.frames.button_on,button_off_png:bundles.wysiwyg.frames.button_off,text:e.properties.caption,font:cleverapps.styles.FONTS.DIRECTORY_ITEM_TEXT,onClicked:function(){e.onClick(),n.trigger("rebuildItems")}})});s.unshift(new cleverapps.UI.Button({width:t.button.width,height:t.button.height,text:"Add new scenario",font:cleverapps.styles.FONTS.DIRECTORY_ITEM_TEXT,onClicked:function(){var e=HierarchyItem.createScenario("scenario_"+n.getNewScenarioIndex());n.addItem(e),n.addItem(HierarchyItem.createClip("clip_"+n.getNewClipIndex(n.getSelectedScenario()),e))}}));var i=new cleverapps.Layout(s.reverse(),{direction:cleverapps.UI.VERTICAL,margin:t.margin}),o=n.directories.map(function(e){
return new cleverapps.UI.Button({width:t.button.width,height:t.button.height,button_png:bundles.wysiwyg.frames.button_on,button_on_png:bundles.wysiwyg.frames.button_on,button_off_png:bundles.wysiwyg.frames.button_off,text:e,font:e===cleverapps.wysiwyg.directory?cleverapps.styles.FONTS.SELECTED_DIRECTORY_ITEM_TEXT:cleverapps.styles.FONTS.DIRECTORY_ITEM_TEXT,onClicked:function(){cleverapps.wysiwyg.directory=e,cleverapps.setUrlHash({wysiwyg:!0,directory:cleverapps.wysiwyg.directory,scenarioId:void 0}),n.load()}})});o.unshift(new cleverapps.UI.Button({width:t.button.width,height:t.button.height,text:"Add new directory",font:cleverapps.styles.FONTS.DIRECTORY_ITEM_TEXT,onClicked:function(){cleverapps.wysiwyg.directory=prompt("enter name for the new directory:")||"new_directory",cleverapps.setUrlHash({wysiwyg:!0,directory:cleverapps.wysiwyg.directory,scenarioId:void 0}),n.load()}}));var r=new cleverapps.Layout(o.reverse(),{direction:cleverapps.UI.VERTICAL,margin:t.margin});this._super([r,i],{
direction:cleverapps.UI.HORIZONTAL,margin:4*t.margin,align:cleverapps.UI.ALIGN_END})}});cleverapps.styles.DirectoryView={margin:10,button:{width:400,height:60}},cleverapps.overrideFonts(cleverapps.styles.FONTS,{DIRECTORY_ITEM_TEXT:{size:26,color:cleverapps.styles.COLORS.WHITE,font:bundles.wysiwyg.urls.strict_font_ttf}}),cleverapps.overrideFonts(cleverapps.styles.FONTS,{SELECTED_DIRECTORY_ITEM_TEXT:{size:26,color:cleverapps.styles.COLORS.BLACK,font:bundles.wysiwyg.urls.strict_font_ttf}});var HierarchyView=WysiwygWindowBase.extend({ctor:function(e,t){this._super("Hierarchy",cleverapps.styles.HierarchyView.width,t.height),this.hierarchy=e,this.hierarchy.on("rebuildItems",this.rebuildItems.bind(this),this),this.hierarchy.on("selectionChanged",this.selectHierarchyItem.bind(this),this),this.rebuildItems()},rebuildItems:function(){var e=cleverapps.styles.HierarchyView,t=!1,n=[];if(this.hierarchy.items.forEach(function(e){(t||-1!==[HierarchyItem.TYPE.SCENARIO,HierarchyItem.TYPE.DIRECTORY
].indexOf(e.type))&&n.push(e),e.type===HierarchyItem.TYPE.SCENARIO&&(t=!0===e.properties.visible)}.bind(this)),n.length){var s,i=[];n.forEach(function(e){e.type===HierarchyItem.TYPE.DIRECTORY?s=e:e.type===HierarchyItem.TYPE.SCENARIO?i.push({root:e,branch:[]}):i[i.length-1].branch.push(e)}),i.sort(function(e,t){return e.root.properties.caption<t.root.properties.caption?-1:e.root.properties.caption>t.root.properties.caption?1:0}),n=[s],i.forEach(function(e){n.push(e.root),e.branch.forEach(function(e){n.push(e)})})}this.hierarchyItemViews=[];var o=n.map(function(e){var t=new HierarchyItemView(e);return this.hierarchyItemViews.push(t),t}.bind(this));this.createScroll(new cleverapps.Layout(o.reverse(),{direction:cleverapps.UI.VERTICAL,margin:e.margin}))},selectHierarchyItem:function(t){this.hierarchyItemViews.forEach(function(e){e.setSelected(e.hierarchyItem===t)})}});cleverapps.styles.HierarchyView={margin:6,width:400};var InspectorView=WysiwygWindowBase.extend({ctor:function(e,t){
this._super("Inspector",cleverapps.styles.InspectorView.width,t.height),this.inspector=e,this.inspector.on("fillProperties",this.fillProperties.bind(this),this)},fillProperties:function(e,n){var t=cleverapps.styles.InspectorView,s=this.inspector.propertyChanged.bind(this.inspector),i=[];e.filter(function(e){return e.type}).forEach(function(e){var t=new InspectorView.EDITORS[e.type](e,n[e.name],s);i=i.concat(t.propertyEditors)}.bind(this)),this.createScroll(new cleverapps.Layout(i.reverse(),{direction:cleverapps.UI.VERTICAL,margin:t.margin}))}});InspectorView.EDITORS={string:EditBoxPropertyEditor,number:EditBoxPropertyEditor,font:FontPropertyEditor,localizedText:LocalizedTextPropertyEditor,position:PositionPropertyEditor,image:ImagePropertyEditor,spine:SpinePropertyEditor,sound:SoundPropertyEditor,level:LevelPropertyEditor,color:ColorPropertyEditor,actions:ActionsPropertyEditor,frameCapture:ScreenshotsPropertyEditor},cleverapps.styles.InspectorView={width:500,x:{align:"left",dx:-10},y:{
align:"top",dy:-60},margin:5};var WysiwygMenubarView=cc.Node.extend({ctor:function(e){this._super(),this.wysiwygMenubar=e;var t=cleverapps.styles.WysiwygMenubarView;this.setContentSize2(cc.director.getWinSize().width,t.height),this.setAnchorPoint2(),this.wysiwygMenubar.on("updateTool",this.updateTool.bind(this),this);var n=new GitButtonsView(this.wysiwygMenubar.gitButtons);n.setPositionRound(t.gitButtons),this.addChild(n),this.showTools(WysiwygMenubar.TOOLS),cc.eventManager.addListener({event:cc.EventListener.KEYBOARD,onKeyPressed:function(t){WysiwygMenubar.TOOLS.forEach(function(e){this.toolsByCaption[e.caption]&&!this.toolsByCaption[e.caption].disabled&&t===cc.KEY[e.key]&&cleverapps.keyboardController.isPressed(cc.KEY.ctrl)&&e.processor.apply(this.wysiwygMenubar)}.bind(this))}.bind(this)},this)},updateTool:function(e,t){this.toolsByCaption[e].updateStatus?this.toolsByCaption[e].updateStatus(t):t?this.toolsByCaption[e].enable():this.toolsByCaption[e].disable()},showTools:function(e){
var s=cleverapps.styles.WysiwygMenubarView;this.toolsByCaption={};var t=e.map(function(t){var n=new cleverapps.UI.Button({button_png:bundles.wysiwyg.frames.button_on,button_on_png:bundles.wysiwyg.frames.button_on,button_off_png:bundles.wysiwyg.frames.button_off,content:t.icon?new cc.Sprite(t.icon):cleverapps.UI.generateOnlyText(t.caption,cleverapps.styles.FONTS.WYSIWYG_BUTTON_TEXT),onClicked:t.processor.bind(this.wysiwygMenubar),width:t.icon?s.button.width:3*s.button.width,height:s.button.height,hint:"Generate video"!==t.caption?t.caption+" (Ctrl + "+t.key.toUpperCase()+")":void 0,hintPosition:cleverapps.styles.UI.Tooltip.LOCATION.below,fitTo:!1,loadingImg:bundles.git.frames.loading});return this.toolsByCaption[t.caption]=n,t.exportMethods&&t.exportMethods.forEach(function(e){n[e]=t[e].bind(n)}),n}.bind(this));this.leftButtons=new cleverapps.Layout(t.slice(0,6),{direction:cleverapps.UI.HORIZONTAL,margin:s.margin}),this.leftButtons.setPositionRound(s.leftButtons),this.addChild(
this.leftButtons),this.centerButtons=new cleverapps.Layout(t.slice(6),{direction:cleverapps.UI.HORIZONTAL,margin:s.margin}),this.centerButtons.setPositionRound(s.centerButtons),this.addChild(this.centerButtons)}});cleverapps.overrideFonts(cleverapps.styles.FONTS,{WYSIWYG_BUTTON_TEXT:{size:20,color:cleverapps.styles.COLORS.WHITE,font:bundles.wysiwyg.urls.strict_font_ttf}}),cleverapps.styles.WysiwygMenubarView={height:74,button:{width:60,height:60,icon:{width:40,height:40}},leftButtons:{x:{align:"left",dx:60},y:{align:"center"}},centerButtons:{x:{align:"center",dx:-45},y:{align:"center"}},gitButtons:{x:{align:"right",dx:-370},y:{align:"center"}},margin:10};var WysiwygPreviewView=WysiwygWindowBase.extend({ctor:function(e,t){this._super("Preview",t.width,t.height),this.wysiwygPreview=e;var n=this.canvas=new cc.Node;n.setAnchorPoint2(),this.addChild(n,-1),this.wysiwygPreview.on("clearComponents",this.clearComponents.bind(this),this),this.wysiwygPreview.on("showLoading",function(){
this.loading.setVisible(!0),this.changeCursor(!0)}.bind(this),this),this.wysiwygPreview.on("showComponents",this.showComponents.bind(this),this),this.wysiwygPreview.on("showDirectory",this.showDirectory.bind(this),this),this.wysiwygPreview.on("updateComponent",this.updateComponent.bind(this),this),this.wysiwygPreview.on("selectComponent",this.selectComponent.bind(this),this),this.loading=new cc.Sprite(bundles.wysiwyg.frames.loading),this.loading.runAction(new cc.RepeatForever(new cc.RotateBy(5,360))),this.loading.setPositionRound(this.width/2,this.height/2),this.loading.setVisible(!1),this.addChild(this.loading);var s=new cc.Sprite(bundles.wysiwyg.frames.component_item);s.setPositionRound(cleverapps.styles.WysiwygPreviewView.eye),cleverapps.UI.applyHover(s),cleverapps.UI.onClick(s,function(){e.toggleState(),s.setSpriteFrame(e.enabled?bundles.wysiwyg.frames.component_item:bundles.wysiwyg.frames.clip_item)}),this.addChild(s)},clearComponents:function(){this.directoryView&&(
this.directoryView.removeFromParent(),this.directoryView=void 0),this.canvas.removeAllChildren()},showDirectory:function(e){this.createScroll(new DirectoryView(e)),this.directoryView=this.scroll},showComponents:function(e){var t=cleverapps.styles.WysiwygPreviewView,n=this.wysiwygPreview.canvasSize,s=Math.min((this.width-t.padding.x)/n.width,(this.height-t.padding.y)/n.height);this.canvas.setContentSize2(n),this.canvas.setScale(s),this.canvas.setPositionRound(t),this.loading.setVisible(!1);var i=0,o=0;this.clipNodes=[],e.forEach(function(e){var t=new ClipNode(e,{size:this.canvas.getContentSize(),preview:!0});this.clipNodes.push(t),i+=t.width,t.height>o&&(o=t.height)}.bind(this));var r=new cleverapps.Layout(this.clipNodes,{direction:cleverapps.UI.HORIZONTAL});r.setScale(Math.min(this.canvas.width/i,this.canvas.height/o)),r.setPositionRound(this.canvas.width/2,this.canvas.height/2),this.canvas.addChild(r),setTimeout(function(){this.changeCursor(!1)}.bind(this),200)},
updateComponent:function(t){this.clipNodes.forEach(function(e){e.redrawComponent(t)})},selectComponent:function(t){this.clipNodes.forEach(function(e){e.selectComponent(t)})},changeCursor:function(e){!cc.sys.isNative&&"mouse"in cc.sys.capabilities&&(cc._canvas.style.cursor=e?"wait":"default")}});cleverapps.styles.WysiwygPreviewView={padding:{x:20,y:40},eye:{x:{align:"left",dx:10},y:{align:"top",dy:-10}},x:{align:"center"},y:{align:"center",dy:-16}};var AdsTitle=cc.Node.extend({ctor:function(e){this._super(),this.setAnchorPoint2(),e=e||"Title";var t=cc.director.getRunningScene().scene,n=cleverapps.styles.AdsTitle;if(n.type&&(n=cleverapps.overrideStyles(n,n[n.type],!0)),n.bg){var s=cleverapps.UI.createScale9Sprite(n.bg,cleverapps.UI.Scale9Rect.TwoPixelXY);s.setContentSize(t.width-n.bgPadding,n.height||s.height),this.setContentSize(s.getContentSize()),this.addChild(s),s.setPositionRound(this.width/2,this.height/2+n.bgOffsetY)}var i=cleverapps.UI.generateTTFText(e.toUpperCase(),
cleverapps.styles.FONTS.FB_ADS_TITLE_TEXT);i.fitTo((n.bg?this.width:t.width)-n.text.paddingX),i.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER),this.addChild(i),i.setPositionRound(n.text),this.setPositionRound(n),this.setLocalZOrder(n.zOrder||-1),cleverapps.UI.makeHideable(this,cleverapps.UI.VERTICAL)},onWin:function(){var e=cleverapps.styles.AdsTitle;e.hideOnWin&&this.runAction(new cc.Sequence(new cc.DelayTime(e.hideOnWin.delay),new cc.CallFunc(function(){this.hide()}.bind(this))))}});cleverapps.overrideFonts(cleverapps.styles.FONTS,{FB_ADS_TITLE_TEXT:{size:50,color:cleverapps.styles.COLORS.WHITE}}),cleverapps.styles.AdsTitle={x:{align:"center"},y:{align:"top",dy:-5},bg:bundles.ads_title.frames.autumn_bg,bgPadding:60,bgOffsetY:0,text:{x:{align:"center"},y:{align:"center"},paddingX:80}};var AdsProgressBar=cc.Node.extend({ctor:function(e,t){this._super();var n=(e=e||{}).listensEvents||[];this.setAnchorPoint2(),
this.type=e.type===AdsProgressBar.TYPES.IQ?AdsProgressBar.TYPES.IQ:AdsProgressBar.TYPES.COIN;var s=cleverapps.styles.AdsProgressBar,i=this.bar=new ScaledProgressBar(e.bar?bundles[e.bar.bundle].frames[e.bar.image]:s.bar_png);i.setDimension(s.bar.width,s.bar.height),i.setLocalZOrder(s.bar.zOrder);var o=cleverapps.UI.createScale9Sprite(e.barBg?bundles[e.barBg.bundle].frames[e.barBg.image]:s.bar_bg_png);if(o.setContentSize2(s.bar.width+2*s.barBg.padding.x,s.bar.height+2*s.barBg.padding.y),this.setContentSize2(o.getContentSize()),this.addChild(o),o.setPositionRound(this.width/2,this.height/2),this.addChild(i,1),i.setPositionRound(s.bar.x,s.bar.y),this.type===AdsProgressBar.TYPES.IQ){this.bar.setPercentage(38);var r=cleverapps.UI.generateOnlyText("IQ= "+2*this.bar.percentage,cleverapps.styles.FONTS.ADS_PROGRESSBAR_FONT);if(this.addChild(r),r.setLocalZOrder(2),r.setPositionRound(e.iconPosition),!e.isPreview)var a=setInterval(function(){
!this.bar.blocked&&25<this.bar.percentage&&this.bar.percentage<=98&&this.bar.animatedChange(-3),98<this.bar.percentage?(r.setString("IQ=200"),this.runAction(new cc.Sequence(new cc.ScaleTo(.4,1.2),new cc.ScaleTo(.3,1).easing(cc.easeBackOut()))),clearInterval(a)):r.setString((2*this.bar.percentage<100?"IQ= ":"IQ=")+Math.round(2*this.bar.percentage))}.bind(this),100)}else{var c=new cc.Sprite(e.icon?bundles[e.icon.bundle].frames[e.icon.image]:s.icon_png);this.addChild(c),e.iconPosition?(c.setScale(e.iconScale),c.setPositionRound(e.iconPosition)):(c.setScale(s.icon.scale),c.setPositionRound(s.icon)),c.setLocalZOrder(2)}this.setPositionRound(s),this.setLocalZOrder(-1),-1!==n.indexOf(Wysiwyg.EVENTS.PROGRESS_CHANGED)&&t.on(Wysiwyg.EVENTS.PROGRESS_CHANGED,this.incProgress.bind(this),this)},incProgress:function(e){if(this.type===AdsProgressBar.TYPES.IQ){this.bar.blocked=!0;this.bar.animatedChange(Math.round(124*e+76)/2-this.bar.percentage,function(){this.bar.blocked=!1}.bind(this))
}else this.bar.animatedChange(100*e-this.bar.percentage),cleverapps.audio.playSound(cleverapps.styles.AdsProgressBar.sound)}});AdsProgressBar.TYPES={COIN:"coin",IQ:"iq"},AdsProgressBar.BUNDLES=["ads_bar"],AdsProgressBar.PROPERTIES=[{name:"type",type:"string",items:cleverapps.values(AdsProgressBar.TYPES)},{name:"bar",type:"image",bundles:["ads_bar"],value:{image:"gray_bar",bundle:"ads_bar"}},{name:"barBg",type:"image",bundles:["ads_bar"],value:{image:"bar_bg_brown",bundle:"ads_bar"}},{name:"icon",type:"image",bundles:["ads_bar"],value:{image:"coin",bundle:"ads_bar"}},{name:"iconScale",type:"number",value:1},{name:"iconPosition",type:"position",value:{x:{align:"left",dx:-40},y:{align:"center"}}},{name:"listensEvents",type:"string",items:cleverapps.values(Wysiwyg.EVENTS),multiselect:!0,value:[Wysiwyg.EVENTS.PROGRESS_CHANGED]}],cleverapps.styles.FONTS=cleverapps.overrideFonts(cleverapps.styles.FONTS,{ADS_PROGRESSBAR_FONT:{size:70,color:new cc.Color(255,191,69,255),stroke:{
color:new cc.Color(204,120,4,255),size:2}}}),cleverapps.styles.AdsProgressBar={barBg:{padding:{x:1,y:2}},bar:{x:1,y:2,width:500,height:60,zOrder:-1},icon:{x:{align:"left",dx:-40},y:{align:"center"},scale:1.4}};var AdsScale=cc.Node.extend({ctor:function(e,t){this._super(),this.setAnchorPoint2();var n=this.styles=cleverapps.styles.AdsScale,s=(e=e||{}).listensEvents||[];e.type?n=this.styles=cleverapps.overrideStyles(n,n[e.type],!0):n.type&&(n=this.styles=cleverapps.overrideStyles(n,n[n.type],!0));var i,o=new cc.Sprite(n.base);if(this.setContentSize2(o.getContentSize()),this.addChild(o),o.setPositionRound(this.width/2,this.height/2+n.offsetY),n.pointer.json?(i=this.icon=new cleverapps.Spine(n.pointer.json),n.pointer.idleAnimation&&i.setAnimation(0,n.pointer.idleAnimation,!0),i.setVisible(!0)):i=this.icon=new cc.Sprite(n.pointer.icon),this.addChild(i),i.setPositionRound(n.pointer.startX,n.pointer.y+n.offsetY),n.bg){var r=cleverapps.UI.createScale9Sprite(n.bg.image);r.setContentSize2(n.bg),
this.addChild(r,-1),r.setPositionRound(this.width/2,this.height/2)}this.setScale(n.scale||1),this.setPositionRound(n),this.setLocalZOrder(-1),-1!==s.indexOf(Wysiwyg.EVENTS.PROGRESS_CHANGED)&&t.on(Wysiwyg.EVENTS.PROGRESS_CHANGED,this.incProgress.bind(this),this)},incProgress:function(e){var t=this.styles.pointer;this.icon.stopAllActions();var n=t.startX+(this.width-t.finishXOffset-t.startX)*e;if(t.json&&1===e){var s={x:n,y:this.icon.y};this.styles.triumphPosition&&((s=cleverapps.overrideStyles(s,this.styles.triumphPosition,!0)).y+=this.styles.offsetY),this.icon.setAnimation(0,t.name,!1),this.icon.runAction(new cc.Sequence(new cc.DelayTime(.2),new cc.MoveTo(.6,s.x,s.y),new cc.CallFunc(function(){this.icon.setCompleteListener(function(){t.triumphAnimation&&(this.icon.setAnimation(0,t.triumphAnimation,!1),cleverapps.audio.playSound(bundles.ads_scale.urls.electro_brain_effect))}.bind(this))}.bind(this))))}else this.icon.runAction(new cc.Spawn(new cc.MoveTo(.6,n,this.icon.y).easing(
cc.easeBackOut()),new cc.Sequence(new cc.ScaleTo(.4,1.2),new cc.ScaleTo(.1,1))))}});AdsScale.Create=function(e){return-1!==[AdsScale.TYPES.COLORED_CUPID,AdsScale.TYPES.SOLID_CUPID].indexOf(e)?new AdsScaleCupid:new AdsScale},cleverapps.styles.AdsScale={x:{align:"center"},y:{align:"top",dy:-250},base:bundles.ads_scale.frames.einstein_brown_bg,scale:1.15,offsetY:0,pointer:{json:bundles.ads_scale.jsons.brain_pointer,name:"brown",idleAnimation:"brown_idle",y:100,startX:100,finishXOffset:72},brownBrain:{triumphPosition:{x:573,y:144},pointer:{name:"brown",triumphAnimation:"brown_triumph"}},cuteBrain:{base:bundles.ads_scale.frames.cute_brain_bg,pointer:{json:bundles.ads_scale.jsons.brain_cute_pointer,name:"animation",idleAnimation:!1,finishXOffset:130}},whiteBrain:{base:bundles.ads_scale.frames.einstein_yellow_bg,triumphPosition:{x:573,y:144},pointer:{json:bundles.ads_scale.jsons.brain_pointer,name:"white",idleAnimation:"white_idle",triumphAnimation:"white_triumph"}},witch:{y:{align:"top",
dy:-200},base:bundles.ads_scale.frames.witch_bg,pointer:{json:bundles.ads_scale.jsons.witch_pointer_json,name:"animation",idleAnimation:!1,y:130,startX:20,finishXOffset:170}},xmas:{base:bundles.ads_scale.frames.xmas_bar,pointer:{json:!1,icon:bundles.ads_scale.frames.xmas_santa_bar,y:75,startX:60,finishXOffset:70}},coloredCupid:{pointer:{json:bundles.ads_scale.jsons.colorcupid_heart_json},zOrder:1,heart:{endOffset:{x:-65}}},solidCupid:{pointer:{json:bundles.ads_scale.jsons.solidcupid_heart_json}}},AdsScale.TYPES={WITCH:"witch",BROWN_BRAIN:"brownBrain",CUTE_BRAIN:"cuteBrain",WHITE_BRAIN:"whiteBrain",XMAS:"xmas",COLORED_CUPID:"coloredCupid",SOLID_CUPID:"solidCupid"},AdsScale.BUNDLES=["ads_scale"],AdsScale.PROPERTIES=[{name:"type",type:"string",items:cleverapps.values(AdsScale.TYPES)},{name:"listensEvents",type:"string",items:cleverapps.values(Wysiwyg.EVENTS),multiselect:!0,value:[Wysiwyg.EVENTS.PROGRESS_CHANGED]}];var AdsScaleCupid=AdsScale.extend({ctor:function(e,t){
cleverapps.overrideStyles(cleverapps.styles.AdsScale,cleverapps.styles.AdsScaleCupid),this._super(e),this.icon.setPositionRound(this.styles.cupid.x,this.styles.pointer.y+this.styles.offsetY),this.icon.setVisible(!1),this.icon.setLocalZOrder(1);var n=this.cupid=new cleverapps.Spine(this.styles.pointer.json);n.setAnimation(0,this.styles.cupid.shoot,!1),n.setTimeScale(0),this.addChild(n),n.setPositionRound(this.styles.cupid.x,this.styles.pointer.y+this.styles.offsetY);var s=this.heart=new cleverapps.Spine(this.styles.pointer.json);s.setAnimation(0,this.styles.heart.idle,!0),this.addChild(s),s.setPositionRound(this.styles.heart.x,this.styles.pointer.y+this.styles.offsetY),t.on(Wysiwyg.EVENTS.PROGRESS_CHANGED,this.incProgress.bind(this),this)},incProgress:function(e){this.icon.stopAllActions();var t=this.cupid.x+(this.heart.x-this.cupid.x)*e;1===e?this.icon.runAction(new cc.Sequence(new cc.MoveTo(.3,t,this.icon.y),new cc.CallFunc(function(){var e=cc.director.getRunningScene().scene
;this.heart.replaceParentSamePlace(e),this.heart.setScale(this.scale),this.heart.setLocalZOrder(2),this.hit(),cleverapps.audio.playSound(bundles.video_ads.urls.arrow_hit_effect);var t=this.styles.heart.endOffset;if(t){var n=t.x||0,s=t.y||0;this.heart.runAction(new cc.Spawn(new cc.Sequence(new cc.DelayTime(.32),new cc.MoveTo(1.2,e.width/2+n,e.height/2+s).easing(cc.easeExponentialInOut())),new cc.Sequence(new cc.DelayTime(1),new cc.CallFunc(function(){cleverapps.audio.playSound(bundles.video_ads.urls.valentine_victory_effect)}))))}}.bind(this)),new cc.RemoveSelf)):(cleverapps.audio.playSound(bundles.video_ads.urls.arrow_fly_effect),this.isFlyingArrow?this.icon.runAction(new cc.Spawn(new cc.MoveTo(.6,t,this.icon.y).easing(cc.easeBackOut()),new cc.Sequence(new cc.ScaleTo(.4,1.2),new cc.ScaleTo(.1,1)))):this.shoot(function(){this.icon.runAction(new cc.MoveTo(.6,t,this.icon.y))}.bind(this)))},shoot:function(e){this.cupid.setCompleteListener(function(){this.icon.setVisible(!0),
this.cupid.setCompleteListener(function(){}),this.cupid.setAnimation(0,this.styles.cupid.idle,!0),this.isFlyingArrow=!0,e&&e()}.bind(this)),this.cupid.setTimeScale(1)},hit:function(){this.setLocalZOrder(1),this.heart.setAnimationAndIdleAfter(this.styles.heart.shine,this.styles.heart.shineIdle)}});cleverapps.styles.AdsScaleCupid={base:bundles.ads_scale.frames.cupid_heart_scale,pointer:{y:70,idleAnimation:"fly"},cupid:{x:{align:"left",dx:-90},idle:"idle_cupid",shoot:"shoot"},heart:{x:{align:"right",dx:53},idle:"idle_heart",shine:"shine",shineIdle:"shine_idle"}};var AdsWordsList=cc.Node.extend({ctor:function(s,e){this._super(),this.setAnchorPoint2();var i=this.styles=cleverapps.styles.AdsWordsList;this.words=[],this.viewByWord={},this.properties=s,Game.currentGame.keypad.words.forEach(function(e){var t=cleverapps.UI.generateTTFText(e.toUpperCase(),s.font||cleverapps.styles.FONTS.SCENARIO_WORDS_LIST_TEXT),n=new cc.Scale9Sprite(bundles[s.wordBgImage.bundle].frames[s.wordBgImage.image])
;n.setCascadeOpacityEnabled(!0),n.setContentSize2(i.wordBg.width,i.wordBg.height),n.addChild(t),t.setPositionRound(n.width/2,n.height/2+s.textOffsetY),t.fitTo(n.width-2*i.word.padding),t.setLocalZOrder(10),n.text=t,this.words.push(n),this.viewByWord[e]=n}.bind(this));var t=new cleverapps.Layout(this.words.slice().reverse(),{direction:cleverapps.UI.VERTICAL,margin:i.margin});this.addChild(t),cleverapps.UI.wrap(this),t.setPositionRound(this.width/2,this.height/2),s.isPreview&&this.incProgress(0,Game.currentGame.keypad.words[0]),-1!==(s.listensEvents||[]).indexOf(Wysiwyg.EVENTS.PROGRESS_CHANGED)&&e.on(Wysiwyg.EVENTS.PROGRESS_CHANGED,this.incProgress.bind(this),this)},incProgress:function(e,t){var n=this.viewByWord[t];if(this.properties.discoverAnimation===AdsWordsList.DISCOVER_ANIMATIONS.TYPE_STRIKE){var s=new cleverapps.Spine(bundles.ads_words_list.jsons.strike_json);n.addChild(s),s.setPositionRound(cleverapps.styles.AdsWordsList.strike),s.setAnimationAndIdleAfter("animation","idle"),
n.runAction(new cc.FadeTo(.2,150))}else if(this.properties.discoverAnimation===AdsWordsList.DISCOVER_ANIMATIONS.TYPE_SCALE){var i=bundles[this.properties.wordBgImageDiscovered.bundle].frames[this.properties.wordBgImageDiscovered.image],o=new cc.Scale9Sprite(i);o.setContentSize2(n.getContentSize()),o.setScale(0),n.addChild(o),o.setPositionRound(n.width/2,n.height/2);var r=new cleverapps.Spine(bundles.ads_words_list.jsons.sparkles_json);n.addChild(r),r.setPositionRound(n.width/2,n.height/2),r.setAnimation(0,"animation",!1),r.setLocalZOrder(11),r.setCompleteListenerRemove(),o.runAction(new cc.Sequence(new cc.ScaleTo(.3,1).easing(cc.easeIn(3)),new cc.CallFunc(function(){n.setSpriteFrame(new cc.Sprite(i).getSpriteFrame()),this.properties.fontDiscovered&&n.text.setFont(this.properties.fontDiscovered),n.runAction(new cc.Sequence(new cc.ScaleTo(.15,1.15),new cc.ScaleTo(.3,.95),new cc.ScaleTo(.3,1)))}.bind(this))))}cleverapps.audio.playSound(cleverapps.styles.AdsWordsList.strike_effect),
cleverapps.audio.playSound(cleverapps.styles.AdsWordsList.sound)}});AdsWordsList.DISCOVER_ANIMATIONS={},AdsWordsList.DISCOVER_ANIMATIONS.TYPE_STRIKE="strike",AdsWordsList.DISCOVER_ANIMATIONS.TYPE_SCALE="scale",AdsWordsList.BUNDLES=["ads_words_list"],AdsWordsList.PROPERTIES=[{name:"wordBgImage",type:"image",bundles:["ads_words_list"],value:{image:"blackblue_word",bundle:"ads_words_list"}},{name:"wordBgImageDiscovered",type:"image",bundles:["ads_words_list"],value:{image:"blackblue_word",bundle:"ads_words_list"}},{name:"font",type:"font",value:cleverapps.styles.FONTS.SCENARIO_WORDS_LIST_TEXT},{name:"fontDiscovered",type:"font",value:cleverapps.styles.FONTS.SCENARIO_WORDS_LIST_TEXT},{name:"listensEvents",type:"string",items:cleverapps.values(Wysiwyg.EVENTS),multiselect:!0,value:[Wysiwyg.EVENTS.PROGRESS_CHANGED]},{name:"textOffsetY",type:"number",value:0},{name:"discoverAnimation",type:"string",value:AdsWordsList.DISCOVER_ANIMATIONS.TYPE_STRIKE,items:cleverapps.values(
AdsWordsList.DISCOVER_ANIMATIONS)}],cleverapps.styles.AdsWordsList={x:170,y:494,width:310,height:945,margin:10,wordBg:{width:200,height:60},word:{x:{align:"center"},y:{align:"center"},padding:5},strike:{x:{align:"center",dx:10},y:{align:"center"}},strike_effect:bundles.ads_words_list.urls.strike_effect},cleverapps.overrideFonts(cleverapps.styles.FONTS,{SCENARIO_WORDS_LIST_TEXT:{size:35,color:cleverapps.styles.COLORS.WHITE,shadow:{color:cleverapps.styles.COLORS.BLACK,direction:cc.size(0,-2),blur:2}}});var AdsAgeCounter=cc.Node.extend({ctor:function(e,t){this._super(),this.setAnchorPoint2();var n=(e=e||{}).listensEvents||[],s=cleverapps.styles.AdsAgeCounter;this.type=e.type,this.silent="yes"===e.silent,this.startAge=90,"ru"===cleverapps.settings.language&&(this.ages=[86,76,65,58,55,49,45,38,29,25,18]),this.finishAge=18,this.currentAge=this.startAge;var i,o=e.localizedPrefix&&e.localizedPrefix[cleverapps.settings.language]?e.localizedPrefix[cleverapps.settings.language]:e.ageCounterPrefix
,r=e.localizedPostfix&&e.localizedPostfix[cleverapps.settings.language]?e.localizedPostfix[cleverapps.settings.language]:e.ageCounterPostfix,a=cleverapps.UI.generateOnlyText(o.toUpperCase(),e.font),c=cleverapps.UI.generateOnlyText(r.toUpperCase(),e.font),l=this.age=cleverapps.UI.generateOnlyText(this.startAge,e.fontAge);if(this.type===AdsAgeCounter.TYPE_UNDERSCORE){var p=new cc.Sprite(bundles.ads_counter.frames.underscore_png);i=new cleverapps.Layout([p,l],{direction:cleverapps.UI.VERTICAL,margin:s.underscore.margin})}else{var d;this.type===AdsAgeCounter.TYPE_BRAIN?d=bundles.ads_counter.jsons.brain_json:this.type===AdsAgeCounter.TYPE_HEART&&(d=bundles.ads_counter.jsons.heart_json);var u=new cc.Node;u.setAnchorPoint2(),u.setContentSize2(s.brain),this.brain=new cleverapps.Spine(d),this.brain.setAnimation(0,"idle",!0),this.brain.addChild(l),l.setPositionRound(this.brain.width/2,this.brain.height/2),u.addChild(this.brain),this.brain.setPositionRound(u.width/2,u.height/2),i=u}
var h=new cleverapps.Layout([a,i,c],{direction:cleverapps.UI.HORIZONTAL,margin:s.margin});this.type===AdsAgeCounter.TYPE_UNDERSCORE&&(i.y+=s.underscore.offsetY),this.addChild(h),cleverapps.UI.wrap(this),h.setPositionRound(this.width/2,this.height/2),-1!==n.indexOf(Wysiwyg.EVENTS.PROGRESS_CHANGED)&&t.on(Wysiwyg.EVENTS.PROGRESS_CHANGED,this.incProgress.bind(this),this),t.on(Wysiwyg.EVENTS.CLIP_STARTED,this.showUp.bind(this),this)},showUp:function(){if(!this.silent){var e=this.getParent().getParent(),t=this.getParent().getLocalZOrder();this.getParent().setLocalZOrder(100);var n=this.getPosition(),s=this.getParent().convertToNodeSpace(e.convertToWorldSpace(cc.p(e.width/2,e.height/2)));this.setPositionRound(s),this.runAction(new cc.Sequence(new cc.DelayTime(1),new cc.MoveTo(.2,n).easing(cc.easeOut(2)),new cc.CallFunc(function(){this.getParent().setLocalZOrder(t)}.bind(this))))}},incProgress:function(e){this.ages?this.currentAge=this.ages[Math.round((this.ages.length-1)*e
)]:this.currentAge=Math.floor(this.startAge-(this.startAge-this.finishAge)*e),this.age.countToAnimation(this.currentAge,.4),this.age.runAction(new cc.Sequence(new cc.ScaleTo(.3,1.3),new cc.ScaleTo(.1,1))),1===e&&setTimeout(this.onProgressCompleted.bind(this),1e3)},onProgressCompleted:function(){if(this.brain){this.brain.setAnimation(0,"idle2",!1),this.getParent().setLocalZOrder(20);var e=this.getParent().getParent(),t=this.brain.getParent().convertToNodeSpace(e.convertToWorldSpace(cc.p(e.width/2,e.height/2)));this.brain.runAction(new cc.MoveTo(.8,t)),this.age.runAction(new cc.ScaleTo(.5,2)),this.type===AdsAgeCounter.TYPE_HEART&&(cleverapps.audio.playSound(bundles.ads_counter.urls.heartbeat_effect,{loop:!0}),setTimeout(function(){cleverapps.audio.cache[bundles.ads_counter.urls.heartbeat_effect].stop()},2500))}}});AdsAgeCounter.TYPE_UNDERSCORE="underscore",AdsAgeCounter.TYPE_BRAIN="brain",AdsAgeCounter.TYPE_HEART="heart",AdsAgeCounter.DEFAULT={localizedPrefix:{en:"Your brain is",
de:"Dein Gehirn ist",es:"Tu cerebro tiene",fr:"Votre cerveau a",it:"Il tuo cervello ha",ja:"",nl:"Je brein is",pt:"Seu crebro tem",ru:" "},localizedPostfix:{en:"years old",de:"Jahre alt",es:"aos",fr:"ans",it:"anni",ja:"",nl:"jaar oud",pt:"anos",ru:""}},cleverapps.overrideFonts(cleverapps.styles.FONTS,{ADS_AGE_COUNTER_TEXT:{size:40,color:cleverapps.styles.COLORS.WHITE},ADS_AGE_COUNTER_TEXT_AGE:{size:60,color:cleverapps.styles.COLORS.WHITE}}),AdsAgeCounter.BUNDLES=["ads_counter"],AdsAgeCounter.PROPERTIES=[{name:"localizedPrefix",type:"localizedText",value:AdsAgeCounter.DEFAULT.localizedPrefix},{name:"localizedPostfix",type:"localizedText",value:AdsAgeCounter.DEFAULT.localizedPostfix},{name:"type",type:"string",items:[AdsAgeCounter.TYPE_UNDERSCORE,AdsAgeCounter.TYPE_BRAIN,AdsAgeCounter.TYPE_HEART],value:AdsAgeCounter.TYPE_UNDERSCORE},{name:"font",type:"font",value:cleverapps.styles.FONTS.ADS_AGE_COUNTER_TEXT},{name:"fontAge",type:"font",
value:cleverapps.styles.FONTS.ADS_AGE_COUNTER_TEXT_AGE},{name:"listensEvents",type:"string",items:cleverapps.values(Wysiwyg.EVENTS),multiselect:!0,value:[Wysiwyg.EVENTS.PROGRESS_CHANGED]},{name:"silent",type:"string",items:["no","yes"],value:"no"}],cleverapps.styles.AdsAgeCounter={x:{align:"center"},y:{align:"top",dy:-300},underscore:{margin:-15,offsetY:10},brain:{width:130,height:130},margin:10};var AdsLogo=cleverapps.Spine.extend({ctor:function(e,t){e=e||{};var n=cleverapps.styles.AdsLogo;this._super(bundles.screenshots.jsons.logo_json),this.setLocalZOrder(99),this.setPositionRound(n);var s=n.name.idle&&(n.name.idle[e.language]||n.name.idle.en),i=n.name.start;if("differences"===cleverapps.config.type)i={en:"animation_en",ru:"animation"},s=void 0;else if("solitaire"===cleverapps.config.type)i={en:"animation",ru:"animation_ru"},s=void 0;else if("match3"===cleverapps.config.type)i={en:"logo_en",ru:"logo_ru"},s=void 0;else if("merge"===cleverapps.config.type){var o="vertical",
r=Wysiwyg.VIDEO_SIZES[cleverapps.wysiwyg.hierarchy.getSelectedScenario().properties.resolution];r.width>=r.height&&(o="horizontal"),i={en:o},s="idle"}var a=i[e.language]||i.en;if(this.setAnimation(0,a,!1),s&&this.addAnimation(0,s,!0),e.effect&&cleverapps.audio.playSound(bundles[e.effect.bundle].urls[e.effect.sound]),!0===e.hero||"true"===e.hero){var c=new HeroView;e.heroPosition&&c.setPositionRound(e.heroPosition),this.addChild(c)}setTimeout(function(){t.trigger(Wysiwyg.EVENTS.CLIP_COMPLETED)},e.duration||3e3)}});AdsLogo.BUNDLES=["screenshots","ads_logo"],AdsLogo.PROPERTIES=[{name:"hero",type:"string",items:["true","false"]},{name:"heroPosition",type:"position",value:{x:{align:"center"},y:{align:"center",dy:-340}}},{name:"effect",type:"sound",bundles:["ads_logo"],value:{sound:"logo_effect_1",bundle:"ads_logo"}},{name:"duration",type:"number",value:3e3}],cleverapps.styles.AdsLogo={x:{align:"center"},y:{align:"center"},effect:bundles.ads_logo.urls.logo_effect_1,name:{start:{
en:"animation_en",ru:"animation_ru"},idle:{en:"animation_en_idle",ru:"animation_ru_idle"}}};var AdsTree=cc.Node.extend({ctor:function(e,t){if(this._super(),this.setAnchorPoint2(),this.stage=0,"string"==typeof(e=e||{}).animationType?this.type=cleverapps.styles.AdsTree[e.animationType.toUpperCase()]:this.type=e.animationType||cleverapps.styles.AdsTree.TREE,this.animation=new cleverapps.Spine(this.type.animation),this.animation.setAnimation(0,"idle_0",!0),this.animation.setPositionRound(this.type),this.addChild(this.animation),this.type.loopedEffect&&this.runAction(new cc.RepeatForever(new cc.Sequence(new cc.CallFunc(function(){cleverapps.audio.playSound(this.type.loopedEffect)}.bind(this)),new cc.DelayTime(6)))),this.setContentSize(cleverapps.styles.AdsTree),t.on(Wysiwyg.EVENTS.PROGRESS_CHANGED,this.incProgress.bind(this),this),e.isPreview)var n=0,s=setInterval(function(){this.incProgress(n),1<=(n+=.05)&&clearInterval(s)}.bind(this),300)},incProgress:function(e){var t=Math.floor((
this.type.stages-1)*e);t!==this.stage?(this.stage=t,this.animation.setAnimationAndIdleAfter("transition_"+(this.stage-1),"idle_"+this.stage),cleverapps.audio.playSound(this.type.growEffect),this.type.additionalEffect&&setTimeout(function(){cleverapps.audio.playSound(this.type.additionalEffect.sound)}.bind(this),this.type.additionalEffect.delay||0)):(this.animation.setAnimationAndIdleAfter("transition_"+this.stage+"_pass","idle_"+this.stage),cleverapps.audio.playSound(this.type.passEffect))}});AdsTree.BUNDLES=["ads_tree"],AdsTree.PROPERTIES=[{name:"animationType",type:"string",items:["tree","dog","cat","snowman"]}],cleverapps.styles.AdsTree={TREE:{animation:bundles.ads_tree.jsons.tree_json,stages:11,x:{align:"center",dx:100},y:{align:"center",dy:280},growEffect:bundles.ads_tree.urls.progress_effect,passEffect:bundles.ads_tree.urls.foliage_effect},DOG:{animation:bundles.ads_tree.jsons.dog_json,stages:7,x:{align:"center",dx:100},y:{align:"center",dy:150},
growEffect:bundles.ads_tree.urls.progress_effect,passEffect:bundles.ads_tree.urls.dog_yip_effect},CAT:{animation:bundles.ads_tree.jsons.cat_json,stages:7,x:{align:"center",dx:100},y:{align:"center",dy:250},growEffect:bundles.ads_tree.urls.progress_effect,passEffect:bundles.ads_tree.urls.cat_meow_effect,loopedEffect:bundles.ads_tree.urls.cat_purr_effect},SNOWMAN:{animation:bundles.ads_tree.jsons.snowman_json,stages:11,x:{align:"center",dx:100},y:{align:"center",dy:80},growEffect:bundles.ads_tree.urls.snowman_progress_effect,passEffect:bundles.ads_tree.urls.snowman_pass_effect},width:200,height:400};var AdsGame=cc.Node.extend({ctor:function(e,t){this._super(),this.properties=e||{},this.eventBus=t,this.generatesEvents=this.properties.generatesEvents||[],this.listensEvents=this.properties.listensEvents||[];var n=this.levelNo=this.properties.levelNo?this.properties.levelNo:0,s=cleverapps.wysiwyg.episode.getLevel(n);if(s.content=cleverapps.wysiwyg.episode.getLevelContent(n),
cleverapps.LocalPushes.FakeSender.sendPush=function(){},cleverapps.LocalPushes.FakeSender.cancelPush=function(){},this.customTools={capture:new CaptureTool(this)},this.properties.isPreview)return this.createPreview(n,s);GamePlayer.instance&&GamePlayer.instance.stop(),Game.currentGame&&Game.currentGame.stop&&(Game.currentGame.stop(),Game.currentGame=void 0),new Game(s),this.overrideBasicGameBehavior(),-1!==this.listensEvents.indexOf(Wysiwyg.EVENTS.CLIP_STARTED)&&t.on(Wysiwyg.EVENTS.CLIP_STARTED,this.play.bind(this),this)},createPreview:function(e,t){var n=cleverapps.UI.generateOnlyText("Game level "+e,cleverapps.styles.FONTS.ADS_GAME_CAPTION_EDITOR_TEXT);return this.setContentSize(n.getContentSize()),n.setPositionRound(this.width/2,this.height/2),this.setLocalZOrder(20),this.addChild(n),new FakeGame(t.content)},overrideBasicGameBehavior:function(){var n=Metha.prototype.registerControl;Metha.prototype.registerControl=function(e,t){"handBlockView"!==e&&"comboBar"!==e&&n.call(this,e,t)},
cleverapps.Combo.prototype.increaseLevel=function(){},ComboView.prototype.onChangeLevel=function(){},"solitaire"===cleverapps.config.type&&this.overrideSolitaireBehavior(),"board"===cleverapps.config.type&&this.overrideWordGamesBehavior(),"stacks"===cleverapps.config.subtype&&this.overrideStacksBehavior()},play:function(e){if(e=e||[],"solitaire"===cleverapps.config.type){var t=Game.currentGame.table.getScreen().cards.length;e=["relax"].concat(cleverapps.arrayFill(t,void 0)).concat(["finish"]),Game.currentGame.shiftCard()}else"board"===cleverapps.config.type&&(e=Game.currentGame.board.words.length);-1!==this.generatesEvents.indexOf(Wysiwyg.EVENTS.GAME_STARTED)&&this.eventBus.trigger(Wysiwyg.EVENTS.GAME_STARTED),this.player=GamePlayer.Create(void 0,{finger:{image:this.properties.finger?bundles[this.properties.finger.bundle].frames[this.properties.finger.image]:void 0},progressChanged:function(e){-1!==this.generatesEvents.indexOf(Wysiwyg.EVENTS.PROGRESS_CHANGED)&&this.eventBus.trigger(
Wysiwyg.EVENTS.PROGRESS_CHANGED,e)}.bind(this)}),this.player.play({actions:e,delay:this.properties.actionsDelay||0,initialDelay:this.properties.playDelay||0},this.onGameFinished.bind(this))},onGameFinished:function(){setTimeout(this.runFinishAnimation.bind(this),this.properties.finishAnimationDelay||0),setTimeout(function(){cleverapps.flags.reset(),"match3"===cleverapps.config.type&&Game.currentGame.stop(),-1!==this.generatesEvents.indexOf(Wysiwyg.EVENTS.CLIP_COMPLETED)&&this.eventBus.trigger(Wysiwyg.EVENTS.CLIP_COMPLETED)}.bind(this),this.properties.clipCompletedDelay||1200),this.properties.winSound&&cleverapps.audio.playSound(bundles[this.properties.winSound.bundle].urls[this.properties.winSound.sound])},runFinishAnimation:function(){this.properties.finishAnimation===AdsGame.FINISH_ANIMATIONS.FADE_OUT&&this.getParent().getParent().children.forEach(function(e){"clipBg"!==e.tag&&(e.setCascadeOpacityEnabledRecursively(!0),e.runAction(new cc.Sequence(new cc.FadeOut(1.2))))})},
cleanup:function(){"solitaire"===cleverapps.config.type&&(CardView.viewCache={},CardView.movingNode&&(CardView.movingNode.removeFromParent(),CardView.movingNode=void 0))},overrideSolitaireBehavior:function(){VictoryLoseAnimations.animateVictory=function(e){e()},Hand.prototype.bonusForLeftCards=function(e){e()},MarkView.prototype.show=function(){},TriPeaks.prototype.showHint=function(){},CardView.movingNode=new cc.Node,CardView.movingNode.setLocalZOrder(19),cc.director.getRunningScene().addChild(CardView.movingNode);var n=Game.currentGame.levelContent.screens[0].length;this._playCard=TriPeaks.prototype.playCard,TriPeaks.prototype.playCard=function(e){var t=(n-Game.currentGame.table.countOfCardsToPlay())/n;-1!==this.generatesEvents.indexOf(Wysiwyg.EVENTS.PROGRESS_CHANGED)&&this.eventBus.trigger(Wysiwyg.EVENTS.PROGRESS_CHANGED,t),cleverapps.audio.playSound(bundles.ads_background_music.urls.coins_effect),this._playCard.call(Game.currentGame,e)}.bind(this)},overrideStacksBehavior:function(
){cleverapps.flags.bonusBlocksDisabled=!0,BaseBlockView.prototype.showUpAnimation=function(){var e=this.block.getShowUpDuration(),t=BaseBlockView.alignInTheGrid(this.block.x,this.block.y);this.stopAllActions(),this.runAction(new cc.MoveTo(e,t).easing(cc.easeIn(2)))},BaseBlockView.prototype.fall=function(e,t){this.stopAllActions();var n=.07*this.block.y,s=Math.min(.1*(this.y-t.y),50);this.runAction(new cc.Sequence(new cc.DelayTime(n),new cc.MoveTo(e,t.x,t.y-s).easing(cc.easeIn(2)),new cc.MoveTo(.2,t.x,t.y+s/4).easing(cc.easeIn(2)),new cc.MoveTo(.2,t.x,t.y-s/4).easing(cc.easeIn(2)),new cc.MoveTo(.2,t.x,t.y).easing(cc.easeIn(2))))},KeypadView.prototype.status=function(e,t){e===WordGame.STATUSES.BOARD&&t.forEach(function(e){var t=new cleverapps.Spine(bundles.game.jsons.remove_letter_sparkles_json);this.animationsContainer.addChild(t),t.setPositionRound(BaseBlockView.alignInTheGrid(e.x,e.y)),this.runAction(new cc.Sequence(new cc.DelayTime(.1),new cc.CallFunc(function(){t.setAnimation(0,
"animation",!1),t.setCompleteListenerRemove()})))}.bind(this))}},overrideWordGamesBehavior:function(){Game.currentGame.on("DiscoveredWord",function(e){var t=Game.currentGame.board.words.length,n=(t-Game.currentGame.board.getUndiscoveredWords().length)/t;-1!==this.generatesEvents.indexOf(Wysiwyg.EVENTS.PROGRESS_CHANGED)&&this.eventBus.trigger(Wysiwyg.EVENTS.PROGRESS_CHANGED,n,e)}.bind(this))}});AdsGame.FINISH_ANIMATIONS={},AdsGame.FINISH_ANIMATIONS.NONE="none",AdsGame.FINISH_ANIMATIONS.FADE_OUT="fade out",cleverapps.overrideFonts(cleverapps.styles.FONTS,{ADS_GAME_CAPTION_EDITOR_TEXT:{size:36,color:cleverapps.styles.COLORS.BLACK,stroke:{color:cleverapps.styles.COLORS.WHITE,size:2}}}),AdsGame.BUNDLES=["game","ads_sfx_common","ads_finger"],AdsGame.PROPERTIES=[{name:"levelNo",type:"level",value:0},{name:"isGame",value:!0},{name:"winSound",type:"sound",bundles:["ads_sfx_common"],value:{bundle:"ads_sfx_common",sound:"win_1"}},{name:"finishAnimation",type:"string",
value:AdsGame.FINISH_ANIMATIONS.NONE,items:cleverapps.values(AdsGame.FINISH_ANIMATIONS)},{name:"finishAnimationDelay",type:"number",value:0},{name:"generatesEvents",type:"string",items:cleverapps.values(Wysiwyg.EVENTS),multiselect:!0,value:cleverapps.values(Wysiwyg.EVENTS)},{name:"listensEvents",type:"string",items:cleverapps.values(Wysiwyg.EVENTS),multiselect:!0,value:[Wysiwyg.EVENTS.CLIP_STARTED]},{name:"playDelay",type:"number",value:0},{name:"actionsDelay",type:"number",value:0},{name:"clipCompletedDelay",type:"number",value:1200},{name:"finger",type:"image",bundles:["ads_finger"],value:{image:"finger_png",bundle:"ads_finger"}}];var AdsPlayButton=cleverapps.UI.Button.extend({ctor:function(e,t){var n=cleverapps.styles.AdsPlayButton,s={text:Messages.get("Play").toUpperCase(),font:cleverapps.styles.FONTS.PLAY_BUTTON_TEXT,width:e.width||n.width,height:e.height||n.height,contentOffset:n.contentOffset,onClicked:function(){}}
;e.images?s.button_images=cleverapps.UI.Button.Images[e.images]:(s.button_png=bundles.buttons_main.frames.play_button_png,s.button_on_png=bundles.buttons_main.frames.play_button_on_png),this._super(s),this.baseScale=e.scale||1;var i=new FingerView({image:e.finger?bundles[e.finger.bundle].frames[e.finger.image]:bundles.ads_finger.frames.finger_png});this.addChild(i),i.setPositionRound(this.width/2,this.height/2),i.delay(.5),i.fadeIn(new cc.p(0,0));for(var o=0;o++<10;)i.press(),i.delay(.3),i.unPress(),i.delay(.3);i.run({}),e.isPreview||(this.setScale(0),this.runAction(new cc.ScaleTo(.4,e.scale||1).easing(cc.easeBackOut()))),e.duration&&setTimeout(function(){t.trigger(Wysiwyg.EVENTS.CLIP_COMPLETED)},e.duration)}});AdsPlayButton.BUNDLES=["ads_finger","ads_buttons"],AdsPlayButton.PROPERTIES=[{name:"duration",type:"number"},{name:"finger",type:"image",bundles:["ads_finger"],value:{image:"finger_png",bundle:"ads_finger"}}],-1!==["merge","match3"].indexOf(cleverapps.config.type)&&(
AdsPlayButton.PROPERTIES.push({name:"images",type:"string",items:function(){return Object.keys(cleverapps.UI.Button.Images)}}),cleverapps.extend(cleverapps.UI.Button.Images,{button_purpure:{button_png:bundles.ads_buttons.frames.ads_purpure_button,button_on_png:bundles.ads_buttons.frames.ads_purpure_button_on,button_off_png:bundles.ads_buttons.frames.ads_purpure_button}})),cleverapps.styles.AdsPlayButton={width:300,height:140,x:{align:"center"},y:{align:"center",dy:-300}};var AdsPrizeBox=cc.Node.extend({ctor:function(){this._super(),this.shadow=new ShadowLayer,this.setContentSize2(this.shadow.width,this.shadow.height),this.setPositionRound(cleverapps.styles.AdsPrizeBox)},showUp:function(){var e=cleverapps.overrideStyles(cleverapps.styles.ShadowView,cleverapps.styles.AdsPrizeBox.shadow,!0);this.shadow.setOpacity(e.startOpacity),this.shadow.runAction(new cc.FadeTo(e.duration,e.opacity)),this.addChild(this.shadow),e=cleverapps.styles.AdsPrizeBox.animation
;var t=this.animation=new cleverapps.Spine(e.json,e.scale);t.setAnimationAndIdleAfter("start_box","closed_box"),this.addChild(t),t.setPositionRound(this.width/2,this.height/2+e.offsetY),cleverapps.audio.playSound(bundles.video_ads.urls.emergence_box_effect)},open:function(){this.animation&&(this.animation.setAnimationAndIdleAfter("opening_box","open_box_idle"),cleverapps.audio.playSound(bundles.video_ads.urls.jump_box_effect))}});cleverapps.styles.AdsPrizeBox={x:{align:"center"},y:{align:"center"},animation:{scale:1.3,offsetY:140,json:bundles.video_ads.jsons.boosters_sale_prize_json},shadow:{startOpacity:210}};var AdsTransition=cleverapps.Spine.extend({ctor:function(e){var t=cleverapps.styles.AdsTransition;e=e||{},this._super(t.json),this.setPositionRound(t),e.isPreview||this.setAnimation(0,"close",!1),this.setLocalZOrder(e.zOrder||10),cleverapps.audio.playSound(bundles.ads_transition.urls.transition_effect)}});AdsTransition.BUNDLES=["ads_transition","transition"],
cleverapps.styles.AdsTransition={x:{align:"center"},y:{align:"center"},json:bundles.transition.jsons.transition_json};var AdsFireworks=Fireworks.extend({ctor:function(e){var t=(e=e||{}).sound?cleverapps.audio.playSound(bundles[e.sound.bundle].urls[e.sound.sound]):void 0;this._super(!0===e.loop&&!e.isPreview,t),this.setAnchorPoint2()}});AdsFireworks.BUNDLES=["puzzle15","finger","ads_finger","fireworks"],AdsFireworks.PROPERTIES=[{name:"position",value:{x:{align:"bottom"},y:{align:"left"}}},{name:"sound",type:"sound",bundles:["ads_background_music"]}];var AdsSprite=cc.Node.extend({ctor:function(e){if(this._super(),this.setAnchorPoint2(),(e=e||{}).image&&e.image.bundle&&bundles[e.image.bundle]&&bundles[e.image.bundle].frames[e.image.image]){var t=cleverapps.UI.createScale9Sprite(bundles[e.image.bundle].frames[e.image.image],cleverapps.UI.Scale9Rect.TwoPixelXY);t.setContentSize(e.width||t.width,e.height||t.height),this.addChild(t),this.setContentSize(t.getContentSize()),t.setPositionRound(
this.width/2,this.height/2)}}});AdsSprite.BUNDLES=["ads_title"],AdsSprite.PROPERTIES=[{name:"image",type:"image",bundles:["ads_title","ads_menu","ads_sprites"],value:{image:"newyork_bg",bundle:"ads_title"}}];var AdsSpine=cc.Node.extend({ctor:function(e){if(this._super(),this.setAnchorPoint2(),(e=e||{}).spine&&e.spine.bundle&&bundles[e.spine.bundle]&&bundles[e.spine.bundle].jsons[e.spine.json]){var t=this.spine=new cleverapps.Spine(bundles[e.spine.bundle].jsons[e.spine.json]);this.addChild(t),this.setContentSize(e.contentWidth||t.getContentSize().width,e.contentHeight||t.getContentSize().height),t.setPositionRound(this.width/2,this.height/2);var n=e.spine.animation,s=cc.loader.getRes(bundles[e.spine.bundle].jsons[e.spine.json]);if(s){var i=Object.keys(s.animations);-1===i.indexOf(n)&&(n=i[0])}var o=e.spine.idle;o?(t.setAnimation(0,n,!1),t.addAnimation(0,o,e.spine.looped)):t.setAnimation(0,n,e.spine.looped)}},setSkin:function(e){this.spine.setSkin(e)}});AdsSpine.BUNDLES=["ads_spines",
"dialogues"],AdsSpine.PROPERTIES=[{name:"spine",type:"spine",bundles:["ads_spines"],value:{json:"grandpa_json",bundle:"ads_spines",animation:"animation",looped:!1}},{name:"contentWidth",type:"number"},{name:"contentHeight",type:"number"}];var AdsText=cc.Node.extend({ctor:function(e,t){this._super(),this.setAnchorPoint2();var n=(e=e||{}).LocalizedText&&e.LocalizedText[cleverapps.settings.language]?e.LocalizedText[cleverapps.settings.language]:e.text,s=cleverapps.UI.generateOnlyText(n||"Sample text",e.font||cleverapps.styles.FONTS.BUTTON_TEXT);e.width&&e.height&&(s.setDimensions(e.width,0),s.fitToHeight(e.height)),s.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER),this.addChild(s),this.setContentSize(s.getContentSize()),s.setPositionRound(this.width/2,this.height/2),"byLetter"===e.appear&&s.byLetterAnimation({speed:.02,callback:function(){setTimeout(function(){e.isPreview||(t.trigger(Wysiwyg.EVENTS.CLIP_COMPLETED),this.removeFromParent(!0))}.bind(this),
void 0===e.beforeCompleteDelay?1700:e.beforeCompleteDelay)}.bind(this)})}});AdsText.PROPERTIES=[{name:"LocalizedText",type:"localizedText"},{name:"font",type:"font"},{name:"appear",type:"string",items:["instant","byLetter"],value:"instant"},{name:"beforeCompleteDelay",type:"number",value:1700}];var AdsSound=cc.Node.extend({ctor:function(e,t){if(this._super(),this.setAnchorPoint2(),(e=e||{}).isPreview){var n=cleverapps.UI.createSprite(bundles.wysiwyg.frames.sound_icon);this.setContentSize(cleverapps.styles.AdsSound),n.setPositionRound(this.width/2,this.height/2),this.addChild(n)}e.sound&&!e.isPreview&&(e.startOnEvent&&t.on(e.startOnEvent,function(){"true"===e.isDisk?cleverapps.audio.insertDisk(bundles[e.sound.bundle].urls[e.sound.sound]):this.audio=cleverapps.audio.playSound(bundles[e.sound.bundle].urls[e.sound.sound],{loop:"true"===e.loop})}.bind(this),this),e.stopOnEvent&&t.on(e.stopOnEvent,function(){"true"===e.isDisk?"true"===e.fadeOut?cleverapps.audio.fadeOut(2e3
):cleverapps.audio.eject():cleverapps.audio.stopSound(this.audio)}.bind(this),this))}});cleverapps.styles.AdsSound={width:68,height:60},AdsSound.BUNDLES=["ads_background_music"],AdsSound.PROPERTIES=[{name:"sound",type:"sound",bundles:["ads_background_music"]},{name:"startOnEvent",type:"string",items:["none"].concat(cleverapps.values(Wysiwyg.EVENTS)),value:"none"},{name:"stopOnEvent",type:"string",items:["none"].concat(cleverapps.values(Wysiwyg.EVENTS)),value:"none"},{name:"fadeOut",type:"string",items:["true","false"],value:"false"},{name:"isDisk",type:"string",items:["true","false"],value:"false"},{name:"loop",type:"string",items:["true","false"],value:"false"}];var AdsWordsResult=cc.Node.extend({ctor:function(e,t){this._super(),this.setAnchorPoint2(),this.properties=e;var n=Game.currentGame.board.words;this.styles=cleverapps.styles.AdsWordsResult;var s=this.title=this.createTitle(),i=this.createWordsList(n);this.line=new cc.Scale9Sprite(bundles.ads_words_result.frames.line_png),
this.line.setContentSize2(this.styles.line.width,this.styles.line.height);var o=new cleverapps.Layout([i,this.line,s],{direction:cleverapps.UI.VERTICAL,margin:this.styles.margin});this.addChild(o),i.y-=this.styles.words.titleMargin,this.setContentSize2(o.getContentSize()),o.setPositionRound(this.width/2,this.height/2),this.showUp(),setTimeout(function(){t.trigger(Wysiwyg.EVENTS.CLIP_COMPLETED)},e.duration||3e3)},showUp:function(){var e=+this.age.getString();this.age.setString(0),this.age.countToAnimation(e,.4),this.properties.isPreview||cleverapps.audio.playSound(bundles.ads_words_result.urls.show_effect),[this.prefix,this.age,this.postfix,this.line,this.wordsLayoutTitle].concat(this.words.reverse()).forEach(function(e,t){e.setCascadeOpacityEnabledRecursively(!0),e.setOpacity(0),e.runAction(new cc.Sequence(new cc.DelayTime(.05*t),new cc.FadeIn(.8)))})},createWordsList:function(e){this.words=e.map(function(e){return cleverapps.UI.generateTTFText(e.toUpperCase(),
cleverapps.styles.FONTS.ADS_WORDS_RESULT_TEXT)});var t=new cleverapps.Layout(this.words,{direction:cleverapps.UI.VERTICAL,margin:this.styles.words.margin}),n=this.wordsLayoutTitle=cleverapps.UI.generateTTFText(Messages.get("WordsAmount",{amount:e.length}).toUpperCase(),cleverapps.styles.FONTS.ADS_WORDS_RESULT_TEXT);return new cleverapps.Layout([t,n],{direction:cleverapps.UI.VERTICAL,margin:this.styles.words.titleMargin})},createTitle:function(){var e=this.prefix=cleverapps.UI.generateOnlyText(this.properties.localizedPrefix[cleverapps.settings.language].toUpperCase(),cleverapps.styles.FONTS.ADS_WORDS_RESULT_TITLE),t=this.postfix=cleverapps.UI.generateOnlyText(this.properties.localizedPostfix[cleverapps.settings.language].toUpperCase(),cleverapps.styles.FONTS.ADS_WORDS_RESULT_TITLE),n=this.age=cleverapps.UI.generateOnlyText(18,cleverapps.styles.FONTS.ADS_WORDS_RESULT_AGE);return new cleverapps.Layout([t,n,e],{direction:cleverapps.UI.VERTICAL,margin:this.styles.title.margin})}})
;AdsWordsResult.TYPE_GRANDPA="grandpa",AdsWordsResult.DEFAULT={localizedPrefix:{en:"Your brain is",de:"Dein Gehirn ist",es:"Tu cerebro tiene",fr:'Votre cerveau a"',it:"Il tuo cervello ha",ja:"",nl:"Je brein is",pt:"Seu crebro tem",ru:" "},localizedPostfix:{en:"years old",de:"Jahre alt",es:"aos",fr:"ans",it:"anni",ja:"",nl:"jaar oud",pt:"anos",ru:""}},AdsWordsResult.BUNDLES=["ads_words_result"],AdsWordsResult.PROPERTIES=[{name:"localizedPrefix",type:"localizedText",value:AdsWordsResult.DEFAULT.localizedPrefix},{name:"localizedPostfix",type:"localizedText",value:AdsWordsResult.DEFAULT.localizedPostfix},{name:"duration",type:"number",value:3e3}],cleverapps.styles.AdsWordsResult={title:{margin:-20},words:{margin:0,titleMargin:20},line:{width:400,height:4}},cleverapps.overrideFonts(cleverapps.styles.FONTS,{ADS_WORDS_RESULT_TITLE:{size:50,color:cleverapps.styles.COLORS.WHITE},ADS_WORDS_RESULT_AGE:{size:90,color:cleverapps.styles.COLORS.WHITE},ADS_WORDS_RESULT_TEXT:{
size:35,color:cleverapps.styles.COLORS.WHITE}});var AdsExclamations=cc.Node.extend({ctor:function(e,t){this._super(),this.properties=e,this.setAnchorPoint2(),this.isMuted=this.properties.isPreview,this.messageId=0,this.messageNo=0,this.setContentSize2(cleverapps.styles.AdsExclamations),e.isPreview&&this.runAnimation(!0),t.on(Wysiwyg.EVENTS.PROGRESS_CHANGED,this.incProgress.bind(this),this)},incProgress:function(e){1!==e&&(this.messageNo%2==0&&setTimeout(this.runAnimation.bind(this),1e3),this.messageNo++)},runAnimation:function(e){var t=new cleverapps.Spine(bundles.ads_exclamations.jsons["exclamation_"+this.messageId]);this.addChild(t),t.setAnimation(0,"animation_"+cleverapps.settings.language,!1),t.setPositionRound(this.width/2,this.height/2),t.setCompleteListenerRemove(function(){e&&this.runAnimation(e)}.bind(this)),this.isMuted||cleverapps.audio.playSound(bundles.ads_exclamations.urls["exclamation_effect_"+this.messageId]),this.messageId++,
bundles.ads_exclamations.jsons["exclamation_"+this.messageId]||(this.messageId=0)}});cleverapps.styles.AdsExclamations={width:400,height:100},AdsExclamations.BUNDLES=["ads_exclamations"];var AdsMenu=cc.Node.extend({ctor:function(e,t){this._super(),this.setAnchorPoint2(),this.properties=e,this.eventBus=t,e.isPreview||(e.delay?setTimeout(this.pick.bind(this),e.delay):this.eventBus.on(Wysiwyg.EVENTS.CLIP_STARTED,this.pick.bind(this),this)),this.setContentSize(this.properties.width,this.properties.height)},pick:function(){if(!(this.nestedComponents.length<this.properties.option||this.properties.option<1)){var n=function(e,t){e.nestedComponents.forEach(function(e){e.replaceParentSamePlace(t),n(e,t)})};this.nestedComponents.forEach(function(e){n(e,e),e.baseScale=e.getScale()});var s=this.nestedComponents[this.properties.option-1],t=[];this.properties.halfwayOptions&&(t=this.properties.halfwayOptions.replace(/\s/g,"").split(",").map(function(e){return this.nestedComponents[parseInt(e)-1]
}.bind(this)));var e=cc.director.getRunningScene(),i=new FingerView(this.properties.finger?{image:bundles[this.properties.finger.bundle].frames[this.properties.finger.image]}:{});i.scheduleUpdate(),i.update=function(e){this.nestedComponents.forEach(function(e){var t=e.getRelativeCoordinates(i),n=cc.rect(0,0,e.width,e.height);cc.rectContainsPoint(n,t)?e.setScale(e.baseScale+.03):e.setScale(e.baseScale-.03)})}.bind(this),i.setLocalZOrder(1e3),i.finger.setOpacity(255),i.setVisible(!0),e.addChild(i),i.setPositionRound(e.width+i.width,0),i.replaceParentSamePlace(this.parent);var o=i.getRelativeCoordinates(s);i.y=o.y,i.delay(1),i.addAction(function(e){var n=[];t.forEach(function(e){var t=i.getRelativeCoordinates(e);n.push(new cc.MoveTo(.7,t.x,t.y).easing(cc.easeOut(1))),n.push(new cc.DelayTime(.2))}),n.push(new cc.MoveTo(.7,o.x,o.y).easing(cc.easeOut(1))),n.push(new cc.DelayTime(.2)),n.push(new cc.CallFunc(e)),i.runAction(new cc.Sequence(n))}.bind(this)),i.addAction(function(e){
i.unscheduleUpdate();var t=s.getScale();s.runAction(new cc.Sequence(new cc.DelayTime(.15),new cc.ScaleTo(.1,1.1*t),new cc.CallFunc(function(){s.spine&&s.spine.data.skins.backlight&&s.spine.setSkin("backlight")}),new cc.ScaleTo(.3,t).easing(cc.easeBackOut()))),e()}.bind(this)),i.press(),i.addAction(function(e){this.properties.clickSound&&cleverapps.audio.playSound(bundles.ads_sfx_common.urls[this.properties.clickSound.sound]),this.properties.selectionSound&&cleverapps.audio.playSound(bundles.ads_sfx_common.urls[this.properties.selectionSound.sound]),e()}.bind(this)),i.unPress(),i.fadeOut(),i.addAction(function(){setTimeout(function(){this.eventBus.trigger(Wysiwyg.EVENTS.CLIP_COMPLETED)}.bind(this),this.properties.afterPickDelay)}.bind(this)),i.run({})}}});AdsMenu.BUNDLES=["ads_menu"],AdsMenu.PROPERTIES=[{name:"option",type:"number",value:1},{name:"halfwayOptions",type:"string",value:"2,3"},{name:"clickSound",type:"sound",bundles:["ads_sfx_common"],value:{bundle:"ads_sfx_common"}},{
name:"selectionSound",type:"sound",bundles:["ads_sfx_common"],value:{bundle:"ads_sfx_common",sound:"character_selection"}},{name:"width",type:"number",value:600},{name:"height",type:"number",value:200},{name:"afterPickDelay",type:"number",value:1e3},{name:"finger",type:"image",bundles:["ads_finger"],value:{image:"finger_png",bundle:"ads_finger"}}];var AdsCounter=cc.Node.extend({ctor:function(e,t){this._super(),this.setAnchorPoint2(),this.properties=e,this.text=cleverapps.UI.generateOnlyText(0,e.font),this.addChild(this.text),this.setContentSize2(this.text.getContentSize()),this.text.setPositionRound(this.width/2,this.height/2),-1!==(e.listensEvents||[]).indexOf(Wysiwyg.EVENTS.PROGRESS_CHANGED)&&t.on(Wysiwyg.EVENTS.PROGRESS_CHANGED,this.incProgress.bind(this),this)},incProgress:function(){this.text.countToAnimation(+this.text.getString()+this.properties.step,.4),this.text.runAction(new cc.Sequence(new cc.ScaleTo(.3,1.2),new cc.ScaleTo(.1,1)))}});AdsCounter.PROPERTIES=[{name:"font",
type:"font",value:cleverapps.styles.FONTS.WHITE_TEXT},{name:"step",type:"number",value:50},{name:"listensEvents",type:"string",items:cleverapps.values(Wysiwyg.EVENTS),multiselect:!0,value:[Wysiwyg.EVENTS.PROGRESS_CHANGED]}];var AdsShadowLayer=cc.Node.extend({ctor:function(t,e){this._super();var n=Wysiwyg.VIDEO_SIZES[cleverapps.wysiwyg.hierarchy.getSelectedScenario().properties.resolution];this.setAnchorPoint2(),this.setContentSize2(n);var s=new cc.LayerColor(new cc.Color(0,0,0,255),n.width,n.height);s.setOpacity(0),s.setVisible(!1),this.addChild(s),e.on(Wysiwyg.EVENTS.CLIP_STARTED,function(){setTimeout(function(){s.setVisible(!0);var e=[new cc.FadeTo(t.riseTime/1e3,t.opacity)];t.duration&&(e.push(new cc.DelayTime(t.duration/1e3)),e.push(new cc.FadeTo(t.riseTime/1e3,0)),e.push(new cc.CallFunc(function(){s.setVisible(!1)}))),s.runAction(new cc.Sequence(e))},t.delayBeforeFadeIn)},this)}});AdsShadowLayer.PROPERTIES=[{name:"delayBeforeFadeIn",type:"number",value:0},{name:"riseTime",
type:"number",value:300},{name:"opacity",type:"number",value:110},{name:"duration",type:"number",value:0}];var MergePuzzleLogic=function(e,t,n){this.fieldWidth=e||7,this.fieldWidth=Math.max(this.fieldWidth,5),this.fieldWidth=Math.min(this.fieldWidth,8),this.fieldHeight=t||7,this.fieldHeight=Math.max(this.fieldHeight,5),this.fieldHeight=Math.min(this.fieldHeight,8),this.game=n,this.goalsCount=Math.floor((this.fieldWidth*this.fieldHeight-1)/3),this.goalsDone=0,this.justMovedUnits=[]};MergePuzzleLogic.prototype.createUnits=function(){for(var e=[],r=this.game.map,a=1e4,c=[[{x:0,y:0},{x:1,y:0},{x:3,y:0}],[{x:0,y:1},{x:2,y:1},{x:4,y:0}],[{x:3,y:1},{x:1,y:2},{x:1,y:3}],[{x:2,y:2},{x:4,y:1},{x:0,y:2}],[{x:1,y:1},{x:4,y:2},{x:3,y:2}]],l=0;l<this.goalsCount;l++){for(var p;p=cleverapps.Random.random(20),-1!==e.indexOf(p););e.push(p),[0,1,2].forEach(function(e){var t,n;if(l<c.length)t=c[l][e].x,n=c[l][e].y;else{var s=!1;do{if(t=cleverapps.Random.random(r.width),n=cleverapps.Random.random(r.height)
,2!==t||0!==n){var i=r.bfs(t,n,{type:p}).length;if(s=void 0===r.getUnit(t,n)&&i<3,0==a--){r.listAvailableGrounds().forEach(function(e){r.remove(Map2d.LAYER_UNITS,e.x,e.y)},this),this.createUnits(r);break}}}while(!s)}var o=new Puzzle15Unit(r,{type:p,x:t,y:n});r.add(Map2d.LAYER_UNITS,t,n,o)}.bind(this))}},MergePuzzleLogic.prototype.getPlayActions=function(){var e=[],t=this.game.map,n=t.layers[Map2d.LAYER_UNITS].map(function(e){return e.slice()});do{var s=this.findMove();s.unit.move(s.path),this.afterMove(t,s,!0),e.push(s)}while(this.goalsCount!==this.goalsDone);t.layers[Map2d.LAYER_UNITS]=n;for(var i=0;i<t.width;i++)for(var o=0;o<t.height;o++){var r=t.getUnit(i,o);void 0!==r&&(r.x=i,r.y=o)}return this.goalsDone=0,e},MergePuzzleLogic.prototype.findMove=function(){var n=0,s=void 0,i=void 0;return this.game.map.listAvailableUnits().filter(function(e){return e.canMove()&&-1===this.justMovedUnits.indexOf(e)}.bind(this)).forEach(function(e){var t=this.game.logic.estimateMoves(this.game.map,e,0
);(t.estimate>n||t.estimate===n&&i&&t.path.length<i.length)&&(n=t.estimate,s=e,i=t.path)}.bind(this)),this.justMovedUnits.push(s),3<this.justMovedUnits.length&&this.justMovedUnits.shift(),{unit:s,path:i}},MergePuzzleLogic.prototype.estimateMoves=function(n,e,s){for(var t,i=-1,o=void 0,r=0;r<this.fieldWidth*this.fieldHeight;r++){var a=r%this.fieldWidth,c=(r-a)/this.fieldWidth;if(void 0===n.getUnit(a,c)){n.remove(Map2d.LAYER_UNITS,e.x,e.y);var l=n.bfs(a,c,e).length;n.add(Map2d.LAYER_UNITS,e.x,e.y,e);var p=n.findPath(e,{x:a,y:c});p&&(i<l||l===i&&p.length<o.length)&&(i=l,t={x:a,y:c},o=p)}}var d=(3-s)*i*(3===i?3:1);if(s<2&&3!==i&&t){var u=e.x,h=e.y;n.add(Map2d.LAYER_UNITS,t.x,t.y,e),n.remove(Map2d.LAYER_UNITS,e.x,e.y),e.x=t.x,e.y=t.y,s++;var g=0;n.listAvailableUnits().filter(function(e){return e.canMove()}).forEach(function(e){var t=this.estimateMoves(n,e,s).estimate;g<t&&(g=t)}.bind(this)),d+=g,n.remove(Map2d.LAYER_UNITS,t.x,t.y),n.add(Map2d.LAYER_UNITS,u,h,e),e.x=u,e.y=h}return{
estimate:d,path:o}},MergePuzzleLogic.prototype.afterMove=function(t,e,n,s){var i=t.bfs(e.unit.x,e.unit.y,e.unit);2<i.length&&(i.forEach(function(e){t.getUnit(e.x,e.y).delete(n)}.bind(this)),this.goalsDone++,!n&&s&&s(this.goalsDone/this.goalsCount))};var PicturePuzzleLogic=function(e,t,n){this.fieldWidth=e||3,this.fieldWidth=Math.max(this.fieldWidth,3),this.fieldWidth=Math.min(this.fieldWidth,5),this.fieldHeight=t||3,this.fieldHeight=Math.max(this.fieldHeight,3),this.fieldHeight=Math.min(this.fieldHeight,5),this.game=n,this.goalsCount=this.fieldWidth*this.fieldHeight-1,this.goalsDone=0};PicturePuzzleLogic.prototype.createUnits=function(){var e=this.game.map,t={x:this.fieldWidth-1,y:this.fieldHeight-1};e.remove(Map2d.LAYER_UNITS,t.x,t.y);for(var n=0;n<this.fieldWidth*this.fieldHeight-1;n++){var s=n%this.fieldWidth,i=(n-s)/this.fieldWidth,o=new Puzzle15Unit(e,{type:n,x:s,y:i,hideableIcon:!0});e.add(Map2d.LAYER_UNITS,s,i,o)}this.path=[];var r=void 0;do{o=cleverapps.Random.choose(
e.listAvailableUnits().filter(function(e){return e.canMove()&&r!==e}));e.add(Map2d.LAYER_UNITS,t.x,t.y,o),e.remove(Map2d.LAYER_UNITS,o.x,o.y);var a=o.x,c=o.y;if(o.x=t.x,o.y=t.y,t.x=a,t.y=c,this.afterMove(e),this.path.push({unit:o,path:[{x:t.x,y:t.y}]}),r=o,50<this.path.length)break}while(1!==this.goalsDone||this.goalsDone<3&&30<this.path.length);(this.path.length<15||50<this.path.length)&&this.createUnits()},PicturePuzzleLogic.prototype.getPlayActions=function(){return this.stepsCounter=this.path.length+cleverapps.Random.random(8,15),this.path.reverse()},PicturePuzzleLogic.prototype.afterMove=function(e,t,n,s){this.goalsDone=e.listAvailableUnits().filter(function(e){return e.isPlaceMatchType()}.bind(this)).length,!n&&s&&s(this.goalsDone===this.goalsCount?1:this.stepsCounter--)};var StaticPuzzleLogic=function(e,t,n){this.fieldWidth=e||9,this.fieldWidth=Math.max(this.fieldWidth,5),this.fieldWidth=Math.min(this.fieldWidth,10),this.fieldHeight=t||13,this.fieldHeight=Math.max(
this.fieldHeight,5),this.fieldHeight=Math.min(this.fieldHeight,15),this.game=n,this.goalsCount=Math.floor(this.fieldWidth*this.fieldHeight/3)};StaticPuzzleLogic.prototype.createUnits=function(){this.actions=[];for(var o=this.game.map,r=1e4,e=0;e<this.goalsCount;e++){var a=cleverapps.Random.random(20),c={units:[]};[0,1,2].forEach(function(){var e,t,n=!1;do{e=cleverapps.Random.random(o.width),t=cleverapps.Random.random(o.height);var s=o.bfs(e,t,{type:a}).length;if(n=void 0===o.getUnit(e,t)&&s<3,0==r--){o.listAvailableGrounds().forEach(function(e){o.remove(Map2d.LAYER_UNITS,e.x,e.y)},this),this.createUnits(o);break}}while(!n);var i=new Puzzle15Unit(o,{type:a,x:e,y:t,static:!0});o.add(Map2d.LAYER_UNITS,e,t,i),c.units.push(i)}.bind(this)),this.actions.push(c)}},StaticPuzzleLogic.prototype.getPlayActions=function(){return this.actions.slice(0,7)};var AdsPuzzle15=cc.Node.extend({ctor:function(e,t){this._super(),this.setAnchorPoint2(),this.properties=e,this.eventBus=t,
this.generatesEvents=e.generatesEvents||[],this.listensEvents=e.listensEvents||[];var n=e.type?AdsPuzzle15.TYPES[e.type]:MergePuzzleLogic;this.logic=new n(e.fieldWidth,e.fieldHeight,this),this.map=new Map2d(Array(this.logic.fieldHeight).fill("2".repeat(this.logic.fieldWidth)));var s=cleverapps.styles.AdsPuzzle15[e.type]||cleverapps.styles.AdsPuzzle15.MERGE,i=this.map.width*s.cell.width+(this.map.width-1)*s.margin+2*s.padding,o=this.map.height*s.cell.height+(this.map.height-1)*s.margin+2*s.padding;this.setContentSize(i,o),this.logic.createUnits(),this.showUp(),e.isPreview||(this.actions=this.logic.getPlayActions().concat(["finish"]),Game.currentGame=this,Puzzle15UnitView.movingNode=new cc.Node,Puzzle15UnitView.movingNode.setLocalZOrder(1e4),this.addChild(Puzzle15UnitView.movingNode)),-1!==this.listensEvents.indexOf(Wysiwyg.EVENTS.CLIP_STARTED)&&t.on(Wysiwyg.EVENTS.CLIP_STARTED,this.play.bind(this),this)},showUp:function(){
var e=cleverapps.styles.AdsPuzzle15[this.properties.type]||cleverapps.styles.AdsPuzzle15.MERGE,t=cleverapps.UI.createScale9Sprite(e.bg);if(t.setContentSize(this.width+e.bgPadding,this.height+e.bgPadding),t.setPosition(this.width/2,this.height/2),this.addChild(t,-1),"PICTURE"===this.properties.type){var n=new cc.Sprite(bundles.puzzle15.frames.move_arrows);this.counterText=cleverapps.UI.generateImageText("00",cleverapps.styles.FONTS.PUZZLE15_COUNTER_TEXT);var s=new cleverapps.Layout([n,this.counterText],{direction:cleverapps.UI.HORIZONTAL,margin:e.moves.margin});s.setPositionRound(e.moves),this.addChild(s)}this.slots={};for(var i=0;i<this.map.height;i++)for(var o=0;o<this.map.width;o++){var r=new cc.Node;(this.slots[o+i*this.map.width]=r).setContentSize(e.cell);var a=this.map.getUnit(o,i);if(a){var c=new Puzzle15UnitView(a,e);c.setPositionRound(r.width/2,r.height/2),r.addChild(c)}r.setPositionRound(o*e.cell.width+e.margin*o+e.cell.offset.x,this.height-(i+1
)*e.cell.height-e.margin*i+e.cell.offset.y),this.addChild(r)}},play:function(){setTimeout(function(){(new Puzzle15Player).play({actions:this.actions,delay:100},function(){-1!==this.generatesEvents.indexOf(Wysiwyg.EVENTS.CLIP_COMPLETED)&&this.eventBus.trigger(Wysiwyg.EVENTS.CLIP_COMPLETED)}.bind(this))}.bind(this),1e3),this.counterText&&this.counterText.setString(this.logic.stepsCounter+1)},afterSuccessMove:function(e){if("PICTURE"!==this.properties.type&&cleverapps.audio.playSound(bundles.puzzle15.urls.open_cubes_effect),-1!==this.generatesEvents.indexOf(Wysiwyg.EVENTS.PROGRESS_CHANGED)&&this.eventBus.trigger(Wysiwyg.EVENTS.PROGRESS_CHANGED,e),1===e){var t=new Fireworks(!1);if(t.createFirework(),cleverapps.audio.playSound(bundles.puzzle15.urls.puzzle_click_effect),t.setPositionRound(cleverapps.styles.AdsPuzzle15.firework),this.addChild(t),"PICTURE"===this.properties.type){var n=cleverapps.styles.AdsPuzzle15.PICTURE,s=this.map.width*this.map.height-1,i=this.slots[s],
o=new Puzzle15UnitView(new Puzzle15Unit(this.map,{type:s,x:this.map.width-1,y:this.map.height-1,hideableIcon:!0}),n);o.setPositionRound(i.width/2,i.height/2),o.setScale(.1),i.addChild(o),o.runAction(new cc.ScaleTo(.3,1)),setTimeout(function(){var e=new cc.Sprite(bundles.puzzle15.frames.pictureFull);e.setPositionRound(this.width/2+n.cell.offset.x,this.height/2+n.cell.offset.y),e.runAction(new cc.ScaleTo(.5,1.02)),this.addChild(e)}.bind(this),500)}}else this.counterText&&this.counterText.setString(e)},cleanup:function(){Game.currentGame=void 0,Puzzle15UnitView.movingNode&&(Puzzle15UnitView.movingNode.removeFromParent(),Puzzle15UnitView.movingNode=void 0)}});cleverapps.styles.AdsPuzzle15={MERGE:{margin:10,cell:{width:70,height:70,offset:{x:20,y:-14}},icon:{offset:{x:-6,y:6}},padding:20,bg:bundles.puzzle15.frames.table_frame,bgPadding:20},PICTURE:{margin:0,cell:{width:206,height:206,offset:{x:0,y:6}},icon:{offset:{x:0,y:2}},padding:0,bg:bundles.puzzle15.frames.picture_frame,bgPadding:64,
moves:{x:{align:"center"},y:{align:"top",dy:190},margin:15}},firework:{x:{align:"left"},y:{align:"bottom"}}},cleverapps.overrideFonts(cleverapps.styles.FONTS,{PUZZLE15_COUNTER_TEXT:{name:"default",size:40}}),AdsPuzzle15.TYPES={MERGE:MergePuzzleLogic,PICTURE:PicturePuzzleLogic,STATIC:StaticPuzzleLogic},AdsPuzzle15.BUNDLES=["puzzle15","finger","ads_finger","fireworks"],AdsPuzzle15.PROPERTIES=[{name:"fieldWidth",type:"number"},{name:"fieldHeight",type:"number"},{name:"type",type:"string",items:Object.keys(AdsPuzzle15.TYPES)},{name:"isGame",value:!0},{name:"generatesEvents",type:"string",items:cleverapps.values(Wysiwyg.EVENTS),multiselect:!0,value:[Wysiwyg.EVENTS.PROGRESS_CHANGED,Wysiwyg.EVENTS.CLIP_COMPLETED]},{name:"listensEvents",type:"string",items:cleverapps.values(Wysiwyg.EVENTS),multiselect:!0,value:[Wysiwyg.EVENTS.CLIP_STARTED]}];var Puzzle15Player=function(){GamePlayer.call(this,{},{finger:{image:bundles.ads_finger.frames.finger_png}})};Puzzle15Player.prototype=Object.create(
GamePlayer.prototype),(Puzzle15Player.prototype.constructor=Puzzle15Player).prototype.playAction=function(e,t){if(!this.finger.isShown){var n=e.units?e.units[0]:e.unit;return this.finger.fadeIn(this.scene.getRelativeCoordinates(this.getUnitView(n))),this.finger.isShown=!0,void this.finger.runOnce(this.playAction.bind(this,e,t))}"finish"===e?this.fingerFadeOut(function(){setTimeout(t,1500)}):e.path?this.fingerAction(this.getUnitView(e.unit),function(){e.unit.move(e.path,this.game.slots,function(){this.finger.finger.replaceParentSamePlace(cc.director.getRunningScene()),this.game.logic.afterMove(this.game.map,e,!1,function(e){this.game.afterSuccessMove(e)}.bind(this)),t()}.bind(this))}.bind(this)):e.units&&this.pickUnitsAction(e.units,function(){this.finger.finger.replaceParentSamePlace(cc.director.getRunningScene()),e.units.forEach(function(e){e.delete()}),this.game.afterSuccessMove(),t()}.bind(this))},Puzzle15Player.prototype.getUnitView=function(e){
var t=this.game.slots[e.x+e.y*this.game.map.width];return t&&0<t.getChildren().length?t.getChildren()[0]:void 0},Puzzle15Player.prototype.fingerAction=function(t,n){var e=this.scene.getRelativeCoordinates(t);this.game.logic.goalsDone>this.game.logic.goalsCount/3&&this.game.logic.goalsDone<2*this.game.logic.goalsCount/3&&.9<Math.random()?this.finger.moveZigzag(e):this.finger.moveTo(e),this.finger.press(),this.finger.addAction(function(e){cleverapps.audio.playSound(bundles.puzzle15.urls.puzzle_click_effect),this.finger.finger.replaceParent(t),this.finger.finger.setPositionRound(t.width/2,t.height/2),n(),e()}.bind(this)),this.finger.runOnce()},Puzzle15Player.prototype.pickUnitsAction=function(e,s){e.forEach(function(t,n){this.finger.moveTo(this.scene.getRelativeCoordinates(this.getUnitView(t))),this.finger.press(),this.finger.addAction(function(e){cleverapps.audio.playSound(bundles.puzzle15.urls.puzzle_click_effect),this.getUnitView(t).select(),2===n&&s(),e()}.bind(this))}.bind(this)),
this.finger.runOnce()};var Puzzle15Unit=function(e,t){this.map=e,this.type=t.type,this.x=t.x,this.y=t.y,this.hideableIcon=t.hideableIcon,this.static=t.static,cleverapps.EventEmitter.call(this)};Puzzle15Unit.prototype=Object.create(cleverapps.EventEmitter.prototype),(Puzzle15Unit.prototype.constructor=Puzzle15Unit).prototype.isMergeable=function(e){return e.type===this.type},Puzzle15Unit.prototype.isPlaceMatchType=function(){return this.y*this.map.width+this.x===this.type},Puzzle15Unit.prototype.canMove=function(){for(var e=0;e<ISO_NEIGHBORS.length;e++){var t=this.x+ISO_NEIGHBORS[e].x,n=this.y+ISO_NEIGHBORS[e].y;if(!(t<0||n<0||t>=this.map.width||n>=this.map.height)&&void 0===this.map.getUnit(t,n))return!0}return!1},Puzzle15Unit.prototype.move=function(e,t,n){var s=e[e.length-1];this.map.add(Map2d.LAYER_UNITS,s.x,s.y,this),this.map.remove(Map2d.LAYER_UNITS,this.x,this.y),t&&this.trigger("unitMoved",e,t,n),this.x=s.x,this.y=s.y},Puzzle15Unit.prototype.delete=function(e){this.map.remove(
Map2d.LAYER_UNITS,this.x,this.y),e||this.trigger("unitDeleted")};var Puzzle15UnitView=cc.Sprite.extend({ctor:function(e,t){this.unit=e,this.styles=t,this._super(this.unit.hideableIcon?bundles.puzzle15.frames.pictureTile:bundles.puzzle15.frames.tile);var n=this.icon=new cc.Sprite(bundles.puzzle15.frames["unit"+(e.type+1)]);this.addChild(n),n.setPositionRound(this.width/2+t.icon.offset.x,this.height/2+t.icon.offset.y),this.unit.on("unitMoved",this.move.bind(this),this),this.unit.on("unitDeleted",this.delete.bind(this),this),this.unit.hideableIcon&&this.updateIcon()},move:function(i,e,t){this.replaceParentSamePlace(Puzzle15UnitView.movingNode);var n=this.getScale();this.setScale(.95*n);var o=[];setTimeout(function(){cleverapps.audio.playSound(bundles.puzzle15.urls.cubes_effect)},50),i.forEach(function(e,t){var n=0===t?this.unit.x:i[t-1].x,s=0===t?this.unit.y:i[t-1].y;o.push(new cc.MoveBy(.15,(e.x-n)*(this.styles.cell.width+this.styles.margin),-(e.y-s)*(
this.styles.cell.height+this.styles.margin)))}.bind(this)),o.push(new cc.CallFunc(function(){this.replaceParentSamePlace(e[i[i.length-1].x+i[i.length-1].y*this.unit.map.width]),t&&t(),this.unit.hideableIcon&&this.updateIcon()}.bind(this))),o.push(new cc.Sequence(new cc.ScaleTo(.1,1.05*n),new cc.ScaleTo(.1,n).easing(cc.easeBackOut()))),this.runAction(new cc.Sequence(o))},select:function(){this.replaceParentSamePlace(Puzzle15UnitView.movingNode);var e=new cc.Sprite(bundles.puzzle15.frames.detach_square);this.addChild(e),e.setPositionRound(this.width/2+this.styles.icon.offset.x,this.height/2+this.styles.icon.offset.y),setTimeout(function(){cleverapps.audio.playSound(bundles.puzzle15.urls.cubes_effect)},50)},delete:function(){this.runAction(new cc.Sequence(new cc.CallFunc(function(){if(this.unit.static){var e=new cc.Sprite(bundles.puzzle15.frames.unit_star);e.setPosition(this.width/2,this.height/2),e.setScale(0),this.addChild(e),e.replaceParentSamePlace(this.getParent()),e.runAction(
new cc.Sequence(new cc.ScaleTo(.3,1),new cc.DelayTime(.3),new cc.ScaleTo(.2,0),new cc.RemoveSelf))}else{var t=new cleverapps.Spine(bundles.puzzle15.jsons.sparkle_json);t.setAnimation(0,"animation",!1),t.setTimeScale(2),t.setPosition(this.width/2,this.height/2),t.setCompleteListenerRemove(),this.getParent().addChild(t)}}.bind(this)),new cc.ScaleTo(.2,0),new cc.RemoveSelf))},updateIcon:function(){this.icon.setSpriteFrame(bundles.puzzle15.frames[(this.unit.isPlaceMatchType()?"picture":"digit")+(this.unit.type+1)])}}),Assets=function(s){this.components=Object.keys(Assets.COMPONENTS).filter(function(e){var t=Assets.COMPONENTS[e];return!(t.type&&cleverapps.config.type!==t.type||t.subtype&&cleverapps.config.subtype!==t.subtype)}).map(function(e){var n=new AssetComponent(e,Assets.COMPONENTS[e]);return n.on("componentMovedToScene",function(e,t){s.addComponent(n,e,t)}),n}.bind(this))};Assets.GROUPS={SIMPLE:"Simple",WITHPROGRESS:"With progress",GAMEBLOCKS:"Game blocks",
GAMESPECIFIC:"Game specific"},Assets.COMPONENTS={AdsSprite:{ctor:function(){return AdsSprite},group:Assets.GROUPS.SIMPLE,preview:{caption:"Sprite",icon:bundles.wysiwyg.frames.adssprite}},AdsSpine:{ctor:function(){return AdsSpine},group:Assets.GROUPS.SIMPLE,preview:{caption:"Spine",icon:bundles.wysiwyg.frames.adsspine}},AdsText:{ctor:function(){return AdsText},group:Assets.GROUPS.SIMPLE,preview:{caption:"Text",icon:bundles.wysiwyg.frames.adstext}},AdsSound:{ctor:function(){return AdsSound},group:Assets.GROUPS.SIMPLE,preview:{caption:"Sound",icon:bundles.wysiwyg.frames.adssound}},AdsShadowLayer:{ctor:function(){return AdsShadowLayer},group:Assets.GROUPS.SIMPLE,preview:{caption:"ShadowLayer",icon:bundles.wysiwyg.frames.adsshadowlayer}},AdsTree:{ctor:function(){return AdsTree},group:Assets.GROUPS.WITHPROGRESS,preview:{caption:"Spine with stages",icon:bundles.wysiwyg.frames.adstree}},AdsCounter:{ctor:function(){return AdsCounter},group:Assets.GROUPS.WITHPROGRESS,preview:{caption:"Counter",
icon:bundles.wysiwyg.frames.adscounter}},AdsAgeCounter:{ctor:function(){return AdsAgeCounter},group:Assets.GROUPS.WITHPROGRESS,preview:{caption:"Age counter",icon:bundles.wysiwyg.frames.adsage}},AdsScale:{ctor:function(){return AdsScale},group:Assets.GROUPS.WITHPROGRESS,preview:{caption:"Scale",icon:bundles.wysiwyg.frames.adsscale}},AdsProgressBar:{ctor:function(){return AdsProgressBar},group:Assets.GROUPS.WITHPROGRESS,preview:{caption:"Progress bar",icon:bundles.wysiwyg.frames.adsprogressbar}},AdsTransition:{ctor:function(){return AdsTransition},group:Assets.GROUPS.GAMEBLOCKS,preview:{caption:"Transition",icon:bundles.wysiwyg.frames.adstransition}},AdsFireworks:{ctor:function(){return AdsFireworks},group:Assets.GROUPS.GAMEBLOCKS,preview:{caption:"Fireworks",icon:bundles.wysiwyg.frames.adsfireworks}},AdsLogo:{ctor:function(){return AdsLogo},group:Assets.GROUPS.GAMEBLOCKS,preview:{caption:"Logo animation",icon:bundles.wysiwyg.frames.adslogo}},AdsPlayButton:{ctor:function(){
return AdsPlayButton},group:Assets.GROUPS.GAMEBLOCKS,preview:{caption:"Play button",icon:bundles.wysiwyg.frames.adsplay}},AdsGame:{ctor:function(){switch(cleverapps.config.type){case"merge":return AdsMergeGame;case"match3":return AdsMatch3Game;case"board":return AdsWordGame;default:return AdsGame}},group:Assets.GROUPS.GAMEBLOCKS,preview:{caption:"Game",icon:bundles.wysiwyg.frames.adsgame}},AdsPuzzle15:{ctor:function(){return AdsPuzzle15},group:Assets.GROUPS.GAMEBLOCKS,preview:{caption:"Puzzle 15",icon:bundles.wysiwyg.frames.adspuzzle15}},AdsMenu:{ctor:function(){return AdsMenu},group:Assets.GROUPS.GAMEBLOCKS,preview:{caption:"Menu",icon:bundles.wysiwyg.frames.adsmenu}},AdsEnergyFeast:{ctor:function(){return AdsEnergyFeast},group:Assets.GROUPS.GAMEBLOCKS,type:"merge",preview:{caption:"EnergyFeast",icon:bundles.wysiwyg.frames.adsenergyfeast}},AdsCardTable:{ctor:function(){return AdsCardTable},group:Assets.GROUPS.GAMESPECIFIC,type:"solitaire",preview:{caption:"Card table",
icon:bundles.wysiwyg.frames.adstable}},AdsHandBlock:{ctor:function(){return AdsHandBlock},group:Assets.GROUPS.GAMESPECIFIC,type:"solitaire",preview:{caption:"Hand block",icon:bundles.wysiwyg.frames.adshand}},AdsKeypad:{ctor:function(){return AdsKeypad},group:Assets.GROUPS.GAMESPECIFIC,type:"board",preview:{caption:"Keypad",icon:bundles.wysiwyg.frames.adskeypad}},AdsCurrent:{ctor:function(){return AdsCurrent},group:Assets.GROUPS.GAMESPECIFIC,type:"board",preview:{caption:"Current",icon:bundles.wysiwyg.frames.adscurrent}},AdsHintButton:{ctor:function(){return AdsHintButton},group:Assets.GROUPS.GAMESPECIFIC,type:"board",preview:{caption:"AdsHintButton",icon:bundles.wysiwyg.frames.adshintbooster}},AdsShuffleButton:{ctor:function(){return AdsShuffleButton},group:Assets.GROUPS.GAMESPECIFIC,type:"board",preview:{caption:"AdsShuffleButton",icon:bundles.wysiwyg.frames.adsshuffle}},AdsHint:{ctor:function(){return AdsHint},group:Assets.GROUPS.GAMESPECIFIC,subtype:"stacks",preview:{caption:"Hint",
icon:bundles.wysiwyg.frames.adshint}},AdsWordsList:{ctor:function(){return AdsWordsList},group:Assets.GROUPS.GAMESPECIFIC,type:"board",preview:{caption:"Words list",icon:bundles.wysiwyg.frames.adswordslist}},AdsWordsResult:{ctor:function(){return AdsWordsResult},group:Assets.GROUPS.GAMESPECIFIC,type:"board",preview:{caption:"Words result",icon:bundles.wysiwyg.frames.adswordsresult}},AdsExclamations:{ctor:function(){return AdsExclamations},group:Assets.GROUPS.GAMESPECIFIC,type:"board",preview:{caption:"Exclamations",icon:bundles.wysiwyg.frames.adsexclamations}},AdsMap2d:{ctor:function(){return AdsMap2d},group:Assets.GROUPS.GAMESPECIFIC,type:"merge",preview:{caption:"Map2d",icon:bundles.wysiwyg.frames.adsmap2d}},AdsSidebar:{ctor:function(){return AdsSidebar},group:Assets.GROUPS.GAMESPECIFIC,type:"merge",preview:{caption:"Sidebar",icon:bundles.wysiwyg.frames.adssidebar}},AdsMenubar:{ctor:function(){return AdsMenubar},group:Assets.GROUPS.GAMESPECIFIC,type:"merge",preview:{
caption:"Menubar",icon:bundles.wysiwyg.frames.adsmenubar}},AdsPixel:{ctor:function(){return AdsPixel},group:Assets.GROUPS.GAMESPECIFIC,type:"merge",preview:{caption:"Pixel",icon:bundles.wysiwyg.frames.adspixelsswarm}},AdsField:{ctor:function(){return AdsField},group:Assets.GROUPS.GAMESPECIFIC,type:"match3",preview:{caption:"Field",icon:bundles.wysiwyg.frames.adsfield}},AdsInfoPanel:{ctor:function(){return AdsInfoPanel},group:Assets.GROUPS.GAMESPECIFIC,type:"match3",preview:{caption:"InfoPanel",icon:bundles.wysiwyg.frames.adsinfopanel}},AdsControlsPanel:{ctor:function(){return AdsControlsPanel},group:Assets.GROUPS.GAMESPECIFIC,type:"match3",preview:{caption:"ControlsPanel",icon:bundles.wysiwyg.frames.adscontrolspanel}}};var CaptureTool=function(e){this.component=e,this.withLanguageSelection="board"===cleverapps.config.type};CaptureTool.prototype.action=function(){this.withLanguageSelection?this.showLanguages():this.playCapture()},CaptureTool.prototype.showLanguages=function(){if(
this.languageWindow)return this.languageWindow.removeFromParent(),void delete this.languageWindow;var t,n=cleverapps.styles.CaptureTool;t=this.component.properties.actions.scenarios[this.component.properties.actions.scenario]?JSON.parse(this.component.properties.actions.scenarios[this.component.properties.actions.scenario]):{};for(var e=cleverapps.Settings.getAvailableLanguages().map(function(e){return new cleverapps.UI.Button({button_png:t[e]?bundles.wysiwyg.frames.button_on:bundles.wysiwyg.frames.button_off,button_on_png:t[e]?bundles.wysiwyg.frames.button_on:bundles.wysiwyg.frames.button_off,text:e,font:cleverapps.styles.FONTS.EDITOR_TEXT,onClicked:function(){cleverapps.settings.setLanguage(e),Messages.preload(e,this.playCapture.bind(this)),this.languageWindow.removeFromParent(),delete this.languageWindow}.bind(this),width:n.languageButton.width,height:n.languageButton.height})}.bind(this)),s=[];0<e.length;){var i=e.splice(0,4);s.push(new cleverapps.Layout(i,{
margin:n.languageButton.margin,direction:cleverapps.UI.HORIZONTAL}))}this.languageWindow=new cleverapps.Layout(s,{margin:n.languageButton.margin,direction:cleverapps.UI.TOP_TO_BOTTOM}),this.component.addChild(this.languageWindow),this.languageWindow.setPositionRound(n.languageWindow);var o=new cc.Scale9Sprite(bundles.wysiwyg.frames.window_bg);o.setContentSize2(this.languageWindow.width+n.languageButton.margin,this.languageWindow.height+n.languageButton.margin),this.languageWindow.addChild(o),o.setPositionRound(this.languageWindow.width/2,this.languageWindow.height/2),o.setLocalZOrder(-1)},CaptureTool.prototype.createSceneButton=function(e,t){var n=cleverapps.styles.CaptureTool.button;return new cleverapps.UI.Button({width:n.width,height:n.height,button_png:bundles.buttons.frames.window_button_png,button_on_png:bundles.buttons.frames.window_button_on_png,button_off_png:bundles.buttons.frames.window_button_disabled_png,text:e,font:cleverapps.styles.FONTS.DIRECTORY_ITEM_TEXT,onClicked:t})
},CaptureTool.prototype.createSceneButtons=function(){var e=cleverapps.styles.CaptureTool.button,t=cc.director.getRunningScene(),n=this.createSceneButton("START",function(){n.runAction(new cc.Sequence(new cc.ScaleTo(.3,0),new cc.RemoveSelf)),s.runAction(new cc.Sequence(new cc.DelayTime(.4),new cc.CallFunc(function(){s.setVisible(!0),s.setScale(0)}),new cc.ScaleTo(.3,1),new cc.CallFunc(function(){s.runAction(new cc.RepeatForever(new cc.Sequence(new cc.ScaleTo(.5,1.2),new cc.ScaleTo(.5,1))))}))),this.startCapture()}.bind(this));n.setPositionRound(e),n.runAction(new cc.RepeatForever(new cc.Sequence(new cc.ScaleTo(.5,1.2),new cc.ScaleTo(.5,1)))),t.addChild(n,9999);var s=this.createSceneButton("STOP",this.finishCapture.bind(this));if(s.setPositionRound(e),s.setVisible(!1),t.addChild(s,9999),"merge"===cleverapps.config.type){var i=this.createSceneButton("ADD DELAY",function(){if(cleverapps.capturedScenario){var e=parseFloat(prompt("enter delay (sec)"));e&&cleverapps.capturedScenario.push({
type:"delay",delay:e})}});i.setPositionRound(cleverapps.styles.CaptureTool.delayButton),t.addChild(i,9999);var o=this.createSceneButton("ADD SCROLL TO",function(){if(cleverapps.capturedScenario){var e=Game.currentGame.map.getScreenCenterCell();e&&(cleverapps.Notification.create("Added scroll to cell: x="+e.x+" y="+e.y),cleverapps.capturedScenario.push({type:"scroll_to",cellPosition:e}))}});o.setPositionRound(cleverapps.styles.CaptureTool.scrollToButton),t.addChild(o,9999)}},CaptureTool.prototype.playCapture=function(){cleverapps.capturedScenario=[],cleverapps.metha.display({focus:"WysiwygCaptureScenario",action:function(s){this.component.properties.flags&&this.component.properties.flags.forEach(function(e){cleverapps.flags.wysiwyg[e]=!0}),Game.currentGame=void 0;var e=this.component.properties.levelNo||0;LevelManager.getInstance().setLevel({episodeNo:cleverapps.wysiwyg.episode.episodeNo,levelNo:e}),LevelManager.getInstance().playLevel(function(){if(this.createSceneButtons(),
"merge"===cleverapps.config.type){var e=cc.director.getRunningScene().scroll,t=e.innerContent.width/2-Game.currentGame.map.getAdsMapView().scroll.properties.scrollX,n=e.innerContent.height/2-Game.currentGame.map.getAdsMapView().scroll.properties.scrollY;cc.director.getRunningScene().scroll.scrollTo({x:t,y:n},1)}s()}.bind(this))}.bind(this)})},CaptureTool.prototype.startCapture=function(){"board"===cleverapps.config.type?this.overrideForWordGames():"match3"===cleverapps.config.type?this.overrideForMatch3():"merge"===cleverapps.config.type&&this.overrideForMerge()},CaptureTool.prototype.finishCapture=function(){var e,t=prompt("enter name for the set of steps:",this.component.properties.actions.scenario)||"default";if(this.withLanguageSelection){e={scenarios:cleverapps.clone(this.component.properties.actions.scenarios),scenario:t};var n=JSON.parse(e.scenarios[t]||"{}");n[cleverapps.settings.language]=cleverapps.capturedScenario,e.scenarios[t]=JSON.stringify(n,void 0,1)}else(e={
scenarios:cleverapps.clone(this.component.properties.actions.scenarios),scenario:t}).scenarios[t]=JSON.stringify(cleverapps.capturedScenario,void 0,1);cleverapps.wysiwyg.hierarchy.changeItemProperty(cleverapps.wysiwyg.hierarchy.selectedItem,"actions",e),cleverapps.wysiwyg.inspector.showItemProperties(),cleverapps.capturedScenario=void 0,Game.currentGame&&Game.currentGame.stop(),this.restoreOverrides(),cleverapps.setupDesignResolution(),WysiwygScene.open(cleverapps.wysiwyg,cleverapps.wysiwyg.hierarchy.selectedItem.id)},CaptureTool.prototype.restoreOverrides=function(){"board"===cleverapps.config.type?this.restoreOverridesForWordGames():"match3"===cleverapps.config.type?this.restoreOverridesForMatch3():"merge"===cleverapps.config.type&&this.restoreOverridesForMerge()},CaptureTool.prototype.restoreOverridesForWordGames=function(){Keypad.prototype.__push&&(Keypad.prototype.push=Keypad.prototype.__push),Keypad.prototype.__pop&&(Keypad.prototype.pop=Keypad.prototype.__pop),
Keypad.prototype.__status&&(Keypad.prototype.status=Keypad.prototype.__status),HintBooster.prototype.__onPressed&&(HintBooster.prototype.onPressed=HintBooster.prototype.__onPressed),"undefined"!=typeof ShuffleBooster&&ShuffleBooster.prototype.__onPressed&&(ShuffleBooster.prototype.onPressed=ShuffleBooster.prototype.__onPressed),ShuffleButton.prototype.__onClicked&&(ShuffleButton.prototype.onClicked=ShuffleButton.prototype.__onClicked)},CaptureTool.prototype.restoreOverridesForMatch3=function(){Field.prototype.__move&&(Field.prototype.move=Field.prototype.__move)},CaptureTool.prototype.restoreOverridesForMerge=function(){cleverapps.flags.reset(),Unit.prototype.__move&&(Unit.prototype.move=Unit.prototype.__move,Unit.prototype.__move=void 0),Merge.prototype.__gameEvent&&(Merge.prototype.gameEvent=Merge.prototype.__gameEvent,Merge.prototype.__gameEvent=void 0),ResourceCollectible.prototype.__collect&&(ResourceCollectible.prototype.collect=ResourceCollectible.prototype.__collect,
ResourceCollectible.prototype.__collect=void 0),SideBarIconView.prototype.__onPressed&&(SideBarIconView.prototype.onPressed=SideBarIconView.prototype.__onPressed,SideBarIconView.prototype.__onPressed=void 0)},CaptureTool.prototype.overrideForMerge=function(){SideBarIconView.prototype.__onPressed||(SideBarIconView.prototype.__onPressed=SideBarIconView.prototype.onPressed),SideBarIconView.prototype.onPressed=function(){var e={type:"pressed_sidebar_icon",iconName:this.model.constructor.name};this.model.mission&&(e.missionType=this.model.mission.type),cleverapps.capturedScenario.push(e),SideBarIconView.prototype.__onPressed.call(this)};var e=cleverapps.wysiwyg.hierarchy.selectedItem;e&&e.parentItem&&this.findComponentsToAdd(e.parentItem).forEach(function(e){var t=cleverapps.wysiwyg.wysiwygPreview.componentsByIds[e.id];t.properties.isPreview=!1,t.properties.isGameCapture=!0;var n=new SceneComponentView(t,this.eventBus);cc.director.getRunningScene().addChild(n)}.bind(this))
;ResourceCollectible.prototype.__collect||(ResourceCollectible.prototype.__collect=ResourceCollectible.prototype.collect),ResourceCollectible.prototype.collect=function(e){ResourceCollectible.prototype.__collect.call(this,e),Game.currentGame.harvest(this.unit)},Merge.prototype.__gameEvent||(Merge.prototype.__gameEvent=Merge.prototype.gameEvent),Merge.prototype.gameEvent=function(e,t){if(-1===[Merge.SPAWN,Merge.SPEED_UP].indexOf(e)){var n=[];t.unit&&n.push(new cc.p(t.unit.x,t.unit.y)),t.affected&&(Array.isArray(t.affected)?t.affected.map(function(e){n.push(new cc.p(e.x,e.y))}):n.push(new cc.p(t.affected.x,t.affected.y))),cleverapps.capturedScenario.push({type:e,units:n,prizes:t.prizes&&t.prizes.map(function(e){return{code:e.code,stage:e.stage}})})}this.trigger("gameEvent",e,t)},Unit.prototype.__move||(Unit.prototype.__move=Unit.prototype.move),Unit.prototype.move=function(e,t){cleverapps.capturedScenario&&cleverapps.capturedScenario.push({type:"move",units:[{x:this.x,y:this.y},{x:e,y:t}
]}),Unit.prototype.__move.call(this,e,t)},Game.currentGame.on("adsPixelCollectPrize",function(e){cleverapps.capturedScenario.push({type:"pixel_collect",pixelId:e})},this);var n=cleverapps.UI.ZoomHandler.prototype.zoomTo;cleverapps.UI.ZoomHandler.prototype.zoomTo=function(e,t){e=Math.round(100*e)/100,cleverapps.capturedScenario&&(0<cleverapps.capturedScenario.length&&"zoom_to"===cleverapps.capturedScenario[cleverapps.capturedScenario.length-1].type?cleverapps.capturedScenario[cleverapps.capturedScenario.length-1].zoom=e:cleverapps.capturedScenario.push({type:"zoom_to",zoom:e})),cleverapps.Notification.create("Zoom to: "+e),n.call(this,e,t)}},CaptureTool.prototype.overrideForMatch3=function(){cleverapps.Random.seed(this.component.properties.seed),Field.prototype.__move||(Field.prototype.__move=Field.prototype.move),Field.prototype.move=function(e,t){cleverapps.capturedScenario.push({start:{x:e.x,y:e.y},finish:{x:t.x,y:t.y}}),Field.prototype.__move.call(this,e,t)}},
CaptureTool.prototype.overrideForWordGames=function(){Keypad.prototype.__push||(Keypad.prototype.__push=Keypad.prototype.push),Keypad.prototype.__pop||(Keypad.prototype.__pop=Keypad.prototype.pop),Keypad.prototype.__status||(Keypad.prototype.__status=Keypad.prototype.status),HintBooster.prototype.__onPressed||(HintBooster.prototype.__onPressed=HintBooster.prototype.onPressed),"undefined"==typeof ShuffleBooster||ShuffleBooster.prototype.__onPressed||(ShuffleBooster.prototype.__onPressed=ShuffleBooster.prototype.onPressed),ShuffleButton.prototype.__onClicked||(ShuffleButton.prototype.__onClicked=ShuffleButton.prototype.onClicked);var t=[];Keypad.prototype.push=function(e){e instanceof KeypadLetter?t.push({index:e.index}):t.push({x:e.x,y:e.y}),Keypad.prototype.__push.call(this,e)},Keypad.prototype.pop=function(){t.pop(),Keypad.prototype.__pop.call(this)},Keypad.prototype.status=function(){cleverapps.capturedScenario.push({letters:t}),t=[],Keypad.prototype.__status.apply(this,arguments)},
HintBooster.prototype.onPressed=function(){cleverapps.capturedScenario.push({type:"hint"}),HintBooster.prototype.__onPressed.apply(this,arguments)},"undefined"!=typeof ShuffleBooster&&(ShuffleBooster.prototype.onPressed=function(){cleverapps.capturedScenario.push({type:"shuffle"}),ShuffleBooster.prototype.__onPressed.apply(this,arguments)});var e=$(KeypadView).get().shuffleButton;if(e){var n=e.settings.onClicked;e.settings.onClicked=function(){cleverapps.capturedScenario.push({type:"shuffle"}),n.apply(this,arguments)}}},CaptureTool.prototype.findComponentsToAdd=function(e){var t=[];return e.children.forEach(function(e){-1!==["AdsPixel","AdsSidebar"].indexOf(e.assetName)?t.push(e):t=t.concat(this.findComponentsToAdd(e))}.bind(this)),t},cleverapps.styles.CaptureTool={button:{x:{align:"right",dx:-50},y:{align:"bottom",dy:100},width:150,height:60},delayButton:{x:{align:"right",dx:-50},y:{align:"bottom",dy:200}},scrollToButton:{x:{align:"right",dx:-50},y:{align:"bottom",dy:300}},
languageButton:{width:60,height:60,margin:5},languageWindow:{x:{align:"center"},y:{align:"center",dy:150}}};var AdsMap2d=cc.Node.extend({ctor:function(e){this._super(),this.disableTools=!0,this.properties=e;var t=Wysiwyg.VIDEO_SIZES[cleverapps.wysiwyg.hierarchy.getSelectedScenario().properties.resolution];if(this.setContentSize2(t),this.setPositionRound(t.width/2,t.height/2),Game.currentGame){this.setTerrain(e.terrain||"default");var s,n=this.view=new Map2dView(Game.currentGame.map);if(n.scroll=this,n.customHighlightColor=e.customHighlight&&e.customHighlight.color||cleverapps.styles.COLORS.WHITE,Map2d.prototype.getAdsMapView=function(){return n},this.addChild(n),n.setPosition(e.scrollX,e.scrollY),this.baseScale=e.baseScale||1,this.zoomTo(1,0),e.isPreview)cleverapps.UI.onDrag(n,{swallowTouches:!0,onTouchBegan:function(){"AdsMap2d"===cleverapps.wysiwyg.hierarchy.selectedItem.assetName&&(s=n.getPosition())},onDragMove:function(e){
"AdsMap2d"===cleverapps.wysiwyg.hierarchy.selectedItem.assetName&&n.setPosition(Math.round(s.x+e.dx),Math.round(s.y+e.dy))},onDragEnd:function(e){if("AdsMap2d"===cleverapps.wysiwyg.hierarchy.selectedItem.assetName){var t=Math.round(s.x+e.dx),n=Math.round(s.y+e.dy);cleverapps.wysiwyg.hierarchy.changeItemProperty(cleverapps.wysiwyg.hierarchy.selectedItem,"scrollX",t),cleverapps.wysiwyg.hierarchy.changeItemProperty(cleverapps.wysiwyg.hierarchy.selectedItem,"scrollY",n),cleverapps.wysiwyg.inspector.showItemProperties()}}})}else cleverapps.Notification.create("Game component required!")},scrollTo:function(e,t,n){if((e=this.view.convertToNodeSpace(this.view.convertToWorldSpace(new cc.p(e.x,e.y)))).x-=this.view.width/2,e.y-=this.view.height/2,void 0===t){var s=this.properties.scrollSpeed||AdsMap2d.SCROLL_SPEED;t=cc.pDistance(this.view.getPosition(),cc.p(-e.x,-e.y))/s}this.view.runAction(new cc.Sequence(new cc.MoveTo(t,-e.x,-e.y),new cc.CallFunc(n)))},zoomTo:function(e,t){this.runAction(
new cc.ScaleTo(t,this.baseScale*e).easing(cc.easeInOut(1.7)))},setTerrain:function(e){var s="default"===e?"tiles":"ads_map2d_terrain_"+e;if(cleverapps.overrideStyles(cleverapps.styles.ViewReader,{borderLocks:{upBoth:[bundles[s].frames.level1_up_corner,bundles[s].frames.level1_up_both,bundles[s].frames.level2_up_corner,bundles[s].frames.level2_up_both,bundles[s].frames.level1_up_right_only,bundles[s].frames.level1_up_left_only,bundles[s].frames.level2_up_right_only,bundles[s].frames.level2_up_left_only],upLeft:[bundles[s].frames.level1_up_left_only_last,bundles[s].frames.level2_up_left_only_last,bundles[s].frames.level1_left_inner,bundles[s].frames.level1_left_inner_last,bundles[s].frames.level2_left_inner,bundles[s].frames.level2_left_inner_last],upRight:[bundles[s].frames.level1_up_right_only_last,bundles[s].frames.level2_up_right_only_last,bundles[s].frames.level1_right_inner,bundles[s].frames.level1_right_inner_last,bundles[s].frames.level2_right_inner,
bundles[s].frames.level2_right_inner_last]}}),"default"===e)return ViewReader.__calcGrowType&&(ViewReader.calcGrowType=ViewReader.__calcGrowType),ViewReader.__calcBorderTypeUp&&(ViewReader.calcBorderTypeUp=ViewReader.__calcBorderTypeUp),ViewReader.__calcBorderTypeDown&&(ViewReader.calcBorderTypeDown=ViewReader.__calcBorderTypeDown),ViewReader.__calcBorderTypeLeft&&(ViewReader.calcBorderTypeLeft=ViewReader.__calcBorderTypeLeft),ViewReader.__calcBorderTypeRight&&(ViewReader.calcBorderTypeRight=ViewReader.__calcBorderTypeRight),void(ViewReader.__parse&&(ViewReader.parse=ViewReader.__parse));var t=function(e){if(e)for(var t in bundles[s].frames){if(e.split("#").reverse()[0]===t)return bundles[s].frames[t]}return e};ViewReader.__calcGrowType||(ViewReader.__calcGrowType=ViewReader.calcGrowType),ViewReader.calcGrowType=function(e){return t(ViewReader.__calcGrowType(e))},ViewReader.__calcBorderTypeUp||(ViewReader.__calcBorderTypeUp=ViewReader.calcBorderTypeUp),
ViewReader.calcBorderTypeUp=function(e){return t(ViewReader.__calcBorderTypeUp(e))},ViewReader.__calcBorderTypeDown||(ViewReader.__calcBorderTypeDown=ViewReader.calcBorderTypeDown),ViewReader.calcBorderTypeDown=function(e){return t(ViewReader.__calcBorderTypeDown(e))},ViewReader.__calcBorderTypeLeft||(ViewReader.__calcBorderTypeLeft=ViewReader.calcBorderTypeLeft),ViewReader.calcBorderTypeLeft=function(e){return t(ViewReader.__calcBorderTypeLeft(e))},ViewReader.__calcBorderTypeRight||(ViewReader.__calcBorderTypeRight=ViewReader.calcBorderTypeRight),ViewReader.calcBorderTypeRight=function(e){return t(ViewReader.__calcBorderTypeRight(e))},ViewReader.__parse||(ViewReader.__parse=ViewReader.parse),ViewReader.parse=function(e,t){switch(e){case Map2d.TILE_GREEN_LEVEL_1:case Map2d.TILE_GREEN_LEVEL_2:var n=(t.pointer.x+t.pointer.y)%2;return[new cc.Sprite(n?bundles[s].frames.ground_1:bundles[s].frames.ground_2)]}return ViewReader.__parse(e,t)}}});AdsMap2d.BUNDLES=["game","ads_map2d",
"ads_map2d_terrain_ice","ads_map2d_terrain_purple","ads_map2d_terrain_sand"],AdsMap2d.TERRAINS=["default","ice","sand","purple"],AdsMap2d.SCROLL_SPEED=300,AdsMap2d.PROPERTIES=[{name:"scrollX",type:"number",value:0},{name:"scrollY",type:"number",value:0},{name:"baseScale",type:"number",value:1},{name:"position",value:{x:{align:"center"},y:{align:"center"}}},{name:"terrain",type:"string",items:AdsMap2d.TERRAINS,value:AdsMap2d.TERRAINS[0]},{name:"customHighlight",type:"color",value:{color:cleverapps.styles.COLORS.WHITE}},{name:"scrollSpeed",type:"number",value:AdsMap2d.SCROLL_SPEED}],cleverapps.styles.AdsMap2d={collectAnimation:{position:{x:{align:"center"},y:{align:"center",dy:30}},scale:1}};var AdsSidebar=cc.Node.extend({ctor:function(e,t){this._super(),this.properties=e,this.eventBus=t;var n=Wysiwyg.VIDEO_SIZES[cleverapps.wysiwyg.hierarchy.getSelectedScenario().properties.resolution];if(e.isGameCapture)SideBar.prototype.refreshAllIcons=function(){};else{
var s=this.sideBarView=new SideBarView({size:n});s.setPositionRound(0,0),s.setLocalZOrder(1),this.addChild(s)}for(;cleverapps.sideBar.icons.length;)cleverapps.sideBar.icons[0].removeFromSideBar();e.icons.forEach(function(e){var t=cleverapps.sideBar.getDefaultIconByClassName(window[e]);t&&cleverapps.sideBar.addIcon(t)}),e.missions&&e.missions.forEach(function(e){var t=new Mission(Mission[e]),n=new MissionIcon(t);cleverapps.sideBar.addIcon(n)}),SideBar.prototype.getIconToClickOn=this.getIconToClickOn.bind(this)},getIconToClickOn:function(e,t){for(var n=0;n<this.sideBarView.slots.length;n++){var s=this.sideBarView.slots[n];if(s.iconView&&s.iconView.model&&s.iconView.model.constructor.name===e){if("MissionIcon"===e){if(s.iconView.model.mission.type===t)return s;continue}return s}}}});AdsSidebar.PROPERTIES=[{name:"icons",type:"string",multiselect:!0,items:["QuestsSideBarIcon","OrdersIcon","UnitsLibraryIcon","UnitsShopIcon"],value:[]},{name:"missions",type:"string",multiselect:!0,items:[
"TYPE_ENERGY_FEAST"],value:[]},{name:"position",value:{x:{align:"center"},y:{align:"center"}}}];var AdsMenubar=cc.Node.extend({ctor:function(t){this._super(),this.properties=t;var e=Wysiwyg.VIDEO_SIZES[cleverapps.wysiwyg.hierarchy.getSelectedScenario().properties.resolution];this.setAnchorPoint2(),MenuBar.prototype.isAvailableOnScene=function(e){return-1===["CryptexItem","BonusRoundTimerItem","ExpItem"].indexOf(e.name)};var n=MenuBarItemView.prototype.makeHideable;MenuBarItemView.prototype.makeHideable=function(){this.hidePosition=cc.p(this.x,cleverapps.styles.AdsMenubar.deltaY),n.call(this)},this.setGameLevel(),this.setGold(),this.setLives(),this.setCoins(),this.setWands(),this.setWorkers();var s=new MenuBarView(e.width,this);cleverapps.menuBar.items.forEach(function(e){void 0!==cleverapps.metha.onControlsListeners[e.getControlName()]&&cleverapps.metha.onControlsListeners[e.getControlName()](t.items&&-1!==t.items.indexOf(e.getControlName()),!0)}),
MenuBarItemView.prototype.makeHideable=n,s.setAnchorPoint2(),this.setContentSize2(s.getContentSize()),s.setPositionRound(this.width/2,this.height/2)},setGameLevel:function(){GameLevelMenuBarItem.prototype.getCurrentValue=function(){return{level:this.properties.level||2,currentExp:this.properties.currentExp||200,thresholdExp:this.properties.thresholdExp||300}}.bind(this)},setGold:function(){cleverapps.user.gold=this.properties.gold||85},setLives:function(){cleverapps.lives.amount=this.properties.livesAmount||109,LivesMenuBarItem.prototype.getTotal=function(){return this.properties.livesTotal||cleverapps.Lives.MAX_REGEN_AMOUNT}.bind(this)},setCoins:function(){Game.currentGame.coins=this.properties.coins||45},setWands:function(){Game.currentGame.wands=this.properties.wands||3},setWorkers:function(){Game.currentGame.workers.countRegularFree=function(){return this.properties.workersAmount||2}.bind(this),WorkersMenuBarItem.prototype.getTotal=function(){return this.properties.workersTotal||2
}.bind(this)}});AdsMenubar.PROPERTIES=[{name:"items",type:"string",multiselect:!0,items:function(){return cleverapps.menuBar.items.map(function(e){return e.getControlName()})},value:[]},{name:"position",value:{x:{align:"center"},y:{align:"center"}}},{name:"level",type:"number",value:2},{name:"currentExp",type:"number",value:200},{name:"thresholdExp",type:"number",value:300},{name:"gold",type:"number",value:85},{name:"livesAmount",type:"number",value:109},{name:"livesTotal",type:"number"},{name:"coins",type:"number",value:45},{name:"wands",type:"number",value:3},{name:"workersAmount",type:"number",value:2},{name:"workersTotal",type:"number",value:2}],cleverapps.styles.AdsMenubar={deltaY:200};var AdsMergeGame=AdsGame.extend({ctor:function(e,t){this._super(e,t),this.properties.flags&&this.properties.flags.forEach(function(e){cleverapps.flags.wysiwyg[e]=!0})},createPreview:function(e,t){var n=this._super(e,t);return n.map=new Map2d(t.content.map,{visibleBox:t.content.visibleBox,
waterBorder:0,regions:t.content.regions,decorators:t.content.decorators}),n.fogs=new Fogs([]),MergeEditor.InsertDefaults(n.map,t.content.field),Game.currentGame.pixelsPlanner||(Game.currentGame.pixelsPlanner={}),Game.currentGame.pixelsPlanner.restart=function(){},n},overrideBasicGameBehavior:function(){Merge.prototype.playMergeSound=function(){var e=this.properties.mergeSound&&this.properties.mergeSound.sound;cleverapps.audio.playSound(e?bundles.ads_sfx_common.urls[e]:bundles.ads_sfx_common.urls.merge_effect1)}.bind(this),Game.currentGame.workers.regular.forEach(function(e){new WorkerView(e)}),Unit.prototype.__handleDragStart?Unit.prototype.handleDragStart=Unit.prototype.__handleDragStart:Unit.prototype.__handleDragStart=Unit.prototype.handleDragStart;var e=this.properties.unitMovementSound;Unit.prototype.handleDragStart=function(){return setTimeout(function(){e&&cleverapps.audio.playSound(bundles.ads_sfx_common.urls[e.sound])},600),Unit.prototype.__handleDragStart.call(this)}},
play:function(){var e=JSON.parse(this.properties.actions.scenarios[this.properties.actions.scenario]||"[]");if(e.length&&(e.unshift({type:"show_finger",position:{x:this.properties.fingerX||0,y:this.properties.fingerY||0}}),e.push("finish")),cleverapps.styles.MenuBar.GameLevelItem||(cleverapps.styles.MenuBar.GameLevelItem={}),!cleverapps.styles.MenuBar.GameLevelItem.target){var t=new cc.Node;this.addChild(t);var n=this.parent.getRelativeCoordinates(t);t.setPositionRound(-n.x,-n.y),t.registerTarget(cleverapps.styles.MenuBar.GameLevelItem)}this._super(e)}});AdsGame.PROPERTIES.push({name:"fingerX",type:"number",value:0},{name:"fingerY",type:"number",value:0},{name:"flags",type:"string",multiselect:!0,items:function(){return Object.keys(cleverapps.flags.wysiwyg)},value:function(){return Object.keys(cleverapps.flags.wysiwyg)}},{name:"actions",type:"actions",value:{scenarios:{},scenario:void 0}},{name:"mergeSound",type:"sound",bundles:["ads_sfx_common"],value:{sound:"merge_effect1",
bundle:"ads_sfx_common"}},{name:"unitMovementSound",type:"sound",bundles:["ads_sfx_common"],value:{bundle:"ads_sfx_common"}}),cleverapps.styles.AdsMergeGame={button:{x:{align:"right",dx:-200},y:{align:"bottom",dy:100},width:200,height:60},delayButton:{x:{align:"right",dx:-200},y:{align:"bottom",dy:200}},scrollToButton:{x:{align:"right",dx:-200},y:{align:"bottom",dy:300}}};var AdsEnergyFeast=cc.Node.extend({ctor:function(e){this._super(),this.properties=e,EnergyFeastMissionWindow.prototype.createTable=this.createTable.bind(this);var t=cleverapps.styles.EnergyFeastMissionWindow,n=new cleverapps.Spine(bundles.energy_feast.jsons.energy_feast_json);n.setAnchorPoint2(),n.setPositionRound(t.background),n.setAnimation(0,"animation",!0);var s=new cc.Node;s.setAnchorPoint2(),s.setContentSize2(n.width,n.height),s.addChild(n),this.setAnchorPoint2(),this.setContentSize2(n.width,n.height);var i=this.createTable();i.setAnchorPoint2(),i.setPositionRound(t.table),s.addChild(i)
;var o=cleverapps.UI.generateOnlyText("messages:EnergyFeastMissionWindow.title",cleverapps.styles.FONTS.ENERGY_FEAST_MAIN_TITLE_TEXT);o.setAnchorPoint2(),o.setPositionRound(t.mainTitle),o.fitTo(t.mainTitle.width,t.mainTitle.height),s.addChild(o);var r=new cleverapps.CountDownView(new cleverapps.CountDown(AdsEnergyFeast.TIMELEFT,{onFinish:function(){}}),{font:cleverapps.styles.FONTS.ENERGY_FEAST_TIMER_TEXT});r.setAnchorPoint2(),r.setPositionRound(t.timer),s.addChild(r),this.addChild(s,-1),s.setPositionRound(t.background),e.isPreview||(this.visible=!1)},createTable:function(){var e=cleverapps.styles.EnergyFeastMissionWindow.table,s=[],t=ScenarioHelper.getPlayerNames(cleverapps.settings.language),i=ScenarioHelper.getAvatarPostfix(cleverapps.settings.language);return t.forEach(function(e,t){var n={amount:713-63*t,avatar:{avatar:bundles.screenshots.frames["avatar_"+(1+t)+i],id:t},id:t,place:t+1,text:e};t===this.properties.place-1&&(n.player=!0,n.amount=this.properties.amount,
this.properties.avatar&&this.properties.avatar.image&&(n.avatar.avatar=bundles.screenshots.frames[this.properties.avatar.image]),this.properties.playerName&&(n.text=this.properties.playerName)),s.push(n)}.bind(this)),cleverapps.missionManager.table.createTableView({id:Mission.TYPE_ENERGY_FEAST,data:s,dataIcon:Missions[Mission.TYPE_ENERGY_FEAST].gameIcon,options:{styles:e}})}});AdsEnergyFeast.BUNDLES=["energy_feast","screenshots"],AdsEnergyFeast.TIMELEFT=246792006,AdsEnergyFeast.PROPERTIES=[{name:"playerName",type:"string"},{name:"place",type:"number",value:1},{name:"amount",type:"number",value:417},{name:"avatar",type:"image",bundles:["screenshots"],value:{bundle:"screenshots"}}];var AdsPixel=cc.Node.extend({ctor:function(e,t){if(this._super(),this.properties=e,Game.currentGame&&Game.currentGame.map.getAdsMapView){if(e.uid||cleverapps.wysiwyg.hierarchy.changeItemProperty(cleverapps.wysiwyg.hierarchy.selectedItem,"uid",Date.now()%1e6),this.uid=e.uid,this.setAnchorPoint2(),e.isPreview){
var n;(n=new cc.Node).setAnchorPoint2(),n.setContentSize2(cleverapps.styles.PixelView.width,cleverapps.styles.PixelView.height);var s=new cleverapps.Spine(bundles.merge.jsons.pixels_json);switch(s.setPositionRound(cleverapps.styles.PixelView.animation),s.setAnimation(0,"animation",!0),n.addChild(s),e.type){case PixelsSwarm.PIXEL_TYPE_FRUIT:s.setSkin("standart");break;case PixelsSwarm.PIXEL_TYPE_ENERGY:s.setSkin("energy")}this.addChild(n),this.setContentSize2(n.getContentSize()),n.setPositionRound(this.width/2,this.height/2)}else{PixelView.prototype.update=function(e){cc.Node.prototype.update.call(this,e);var t=this.speed.x,n=this.speed.y;this.setPosition({x:this.x+e*t,y:this.y+e*n})};var i=this.mapView=Game.currentGame.map.getAdsMapView(),o=Wysiwyg.VIDEO_SIZES[cleverapps.wysiwyg.hierarchy.getSelectedScenario().properties.resolution],r=cc.rect(Math.round(i.width/2-o.width/1/2-i.x),Math.round(i.height/2-o.height/1/2-i.y),Math.round(o.width/1),Math.round(o.height/1)),a={x:1.2*r.width,
y:1.2*r.height};n=this.pixelView=new PixelView({type:e.type,pixelsSwarmView:{model:{pixelCollectPrize:this.pixelCollectPrize.bind(this)}},distance:a,onDie:function(){}}),this.addChild(n),setTimeout(function(){var e=cc.director.getRunningScene();e=e.map&&e.map.animations?e.map.animations:i.animations,n.replaceParentSamePlace(e)}.bind(this),0)}Game.currentGame.adsPixelViews||(Game.currentGame.adsPixelViews={}),Game.currentGame.adsPixelViews[this.uid]=n}else cleverapps.Notification.create("Game and Map2d components required!")},pixelCollectPrize:function(e,t){if(e.type===PixelsSwarm.PIXEL_TYPE_FRUIT){var n=new Unit({code:this.properties.prize,stage:this.properties.stage});if(!Game.currentGame.spawn([n],e,{fromNode:!0,parentWorldPosition:t,sound:bundles.merge.urls.spawn_beetle_effect}).length)return Game.currentGame.trigger("adsPixelCollectPrize",this.properties.uid),!0}else if(e.type===PixelsSwarm.PIXEL_TYPE_ENERGY){for(var s=0;s<3;s++){
var i=cleverapps.sideBar.getIconToClickOn&&cleverapps.sideBar.getIconToClickOn("MissionIcon",Mission.TYPE_ENERGY_FEAST)||this,o=new cc.Sprite(bundles.flying.frames.flying_energy_png);o.setScale(cleverapps.styles.MergeScene.flyingIcons.scale),o.setLocalZOrder(1e3-s),o.setPositionRound(e.getPosition()),this.mapView.animations.addChild(o),this.jumpCollectAnimation(s,3,o,i)}return Game.currentGame.trigger("adsPixelCollectPrize",this.properties.uid),!0}return!1},jumpCollectAnimation:function(e,t,n,s){var i=cleverapps.styles.MergeScene.jumpCollect.jumpBoth,o={dist:{x:i.x1+e*(i.x2-i.x1)/t,y:i.y1+Math.random()*(i.y2-i.y1)},sound:bundles.merge.urls.coins_drop_effect,soundDelay:.3,parent:cc.director.getRunningScene(),callback:function(){n.runAction(new cc.Sequence(new cc.DelayTime(.3),new cc.CallFunc(function(){cleverapps.UI.collectAnimation(n,s)}.bind(this))))}.bind(this)};n.setVisible(!1),n.runAction(new cc.Sequence(new cc.DelayTime(.1*e+.1*Math.random()),new cc.Show,new cc.CallFunc(function(
){var e=n.getScale();n.setScale(.5*e),o.spawn=new cc.ScaleTo(.4,1.2*e),cleverapps.UI.jumpAnimation(n,o.dist,o)})))}});AdsPixel.PROPERTIES=[{name:"uid",type:"number"},{name:"type",type:"string",items:[PixelsSwarm.PIXEL_TYPE_FRUIT,PixelsSwarm.PIXEL_TYPE_ENERGY],value:PixelsSwarm.PIXEL_TYPE_FRUIT},{name:"prize",type:"string",items:["wheat","candies","apple","strawberry","mushrooms","corn"],value:"wheat"},{name:"stage",type:"number",value:0},{name:"amountEnergy",type:"number",value:5}];var AutomergeHelper={findAffectedWithCrystal:function(s){var i=Game.currentGame.map,o=i.getUnit(s.lastX,s.lastY);return ISO_NEIGHBORS.map(function(e){var t=i.getUnit(s.lastX+e.x,s.lastY+e.y);i.add(Map2d.LAYER_UNITS,s.lastX,s.lastY,t);var n=s.listMergeAtPoint(s.lastX,s.lastY);return i.add(Map2d.LAYER_UNITS,s.lastX,s.lastY,o),n||[]}).sort(function(e,t){return t.length-e.length})[0]},handleDragMove:function(t,n,e){e.unhighlightMerge();var s=Game.currentGame.map.bfs(t,n,e);(s=s.filter(function(e){return!(
e.x===t&&e.y===n)}))&&2<=s.length?e.highlightMerge([s]):"crystal"===e.code&&e.isLast()&&(s=AutomergeHelper.findAffectedWithCrystal(e))&&3<=s.length&&(s=s.filter(function(e){return!(e.x===t&&e.y===n)}),e.highlightMerge([s]))},handleDragEnd:function(n){var t=n.listMergeAtPoint(n.lastX,n.lastY);if(!t&&"crystal"===n.code&&n.isLast()){var e=(t=AutomergeHelper.findAffectedWithCrystal(n)).filter(function(e){return!(e.x===n.lastX&&e.y===n.lastY)})[0];e&&(n.lastX=e.x,n.lastY=e.y)}if(t&&3<=t.length){var s=cc.p(0,0);t.forEach(function(e){s.x+=e.x,s.y+=e.y}),s.x=Math.round(s.x/t.length),s.y=Math.round(s.y/t.length);var i=t.slice().sort(function(e,t){return Math.abs(e.x-s.x)+Math.abs(e.y-s.y)-(Math.abs(t.x-s.x)+Math.abs(t.y-s.y))})[0];t.forEach(function(e){var t=Game.currentGame.map.getUnit(e.x,e.y);t.highlight(),t.onStartAnimateMerge(i)}),Game.currentGame.counter.setTimeout(function(){t.forEach(function(e){var t=Game.currentGame.map.getUnit(e.x,e.y);t.unhighlight(),t.onStopAnimateMerge(n)})
;var e=Game.currentGame.map.getUnit(n.lastX,n.lastY);Game.currentGame.merge(t,n,e,{centerUnitPos:i})},700)}}};cleverapps.styles.UnitAnchors={candies:{stage1:{anchorX:.48,anchorY:.44},stage2:{anchorX:.49,anchorY:.41},stage3:{anchorX:.49,anchorY:.4},stage4:{anchorY:.42},stage5:{anchorX:.46,anchorY:.34},stage6:{anchorX:.5,anchorY:.46}},coins:{stage1:{anchorX:.46,anchorY:.42},stage2:{anchorX:.4,anchorY:.38},stage3:{anchorX:.44,anchorY:.32},stage4:{anchorX:.41,anchorY:.28},stage5:{anchorX:.44,anchorY:.28},stage6:{anchorX:.5,anchorY:.31},stage7:{anchorX:.5,anchorY:.31},stage8:{anchorX:.5,anchorY:.31}},stonesource:{stage1:{anchorY:.3},stage2:{anchorY:.4},stage3:{anchorY:.2},stage4:{anchorY:.32},stage5:{anchorY:.22},stage6:{anchorY:.28}},sacks:{stage1:{anchorY:.22},stage2:{anchorX:.46,anchorY:.22},stage3:{anchorX:.42,anchorY:.22}},stone:{stage1:{anchorX:.5,anchorY:.4},stage2:{anchorX:.55,anchorY:.4},stage3:{anchorX:.46,anchorY:.35},stage4:{anchorY:.35},stage5:{anchorY:.32},stage6:{anchorY:.22
},stage7:{anchorX:.54,anchorY:.18},stage8:{anchorX:.41,anchorY:.16},stage9:{anchorX:.36,anchorY:.18},stage10:{anchorX:.49,anchorY:.32},stage11:{anchorX:.49,anchorY:.32}},treasure:{stage1:{anchorX:.42,anchorY:.39},stage2:{anchorX:.43,anchorY:.3},stage3:{anchorX:.45,anchorY:.28}},woodsource:{stage1:{anchorX:.47,anchorY:.2},stage2:{anchorY:.25},stage3:{anchorY:.44,anchorY:.22},stage4:{anchorX:.46,anchorY:.26},stage5:{anchorY:.25},stage6:{anchorX:.52,anchorY:.26}},wheat:{stage1:{anchorX:.48,anchorY:.29},stage2:{anchorX:.49,anchorY:.32},stage3:{anchorX:.5,anchorY:.3},stage4:{anchorY:.32},stage5:{anchorX:.5,anchorY:.3},stage6:{anchorX:.51,anchorY:.36}},wood:{stage1:{anchorX:.48,anchorY:.41},stage2:{anchorX:.5,anchorY:.44},stage3:{anchorX:.52,anchorY:.37},stage4:{anchorX:.54,anchorY:.35},stage5:{anchorY:.39},stage6:{anchorX:.52,anchorY:.24},stage7:{anchorY:.24},stage8:{anchorX:.47,anchorY:.15},stage9:{anchorY:.34},stage10:{anchorY:.34}},king:{stage4:{anchorY:.15}},dwarf:{stage1:{anchorX:.43,
anchorY:.35},stage2:{anchorY:.25}},bear:{stage1:{anchorX:.38,anchorY:.34},stage2:{anchorX:.38,anchorY:.3},stage3:{anchorX:.35,anchorY:.3},stage4:{anchorX:.3,anchorY:.25},stage5:{anchorX:.32,anchorY:.22},stage6:{anchorX:.28,anchorY:.23},stage7:{anchorY:.25}},worker:{stage1:{anchorX:.49,anchorY:.46},stage2:{anchorX:.46,anchorY:.47},stage3:{anchorX:.47,anchorY:.4},stage4:{anchorX:.54,anchorY:.33},stage5:{anchorX:.53,anchorY:.2}},freechest:{stage1:{anchorX:.48,anchorY:.31}},herochest:{stage1:{anchorX:.48,anchorY:.34}},rubies:{stage1:{anchorX:.44,anchorY:.36},stage2:{anchorX:.44,anchorY:.43},stage3:{anchorY:.4},stage4:{anchorX:.48,anchorY:.37},stage5:{anchorX:.38,anchorY:.34},stage6:{anchorX:.43,anchorY:.34}},wands:{stage1:{anchorY:.2},stage2:{anchorY:.22},stage3:{anchorY:.2},stage4:{anchorX:.6,anchorY:.2},stage5:{anchorY:.2},stage6:{anchorY:.2}},apple:{stage1:{anchorX:.43,anchorY:.31},stage2:{anchorX:.49,anchorY:.31},stage3:{anchorY:.35},stage4:{anchorX:.5,anchorY:.34},stage5:{anchorX:.44,
anchorY:.22},stage6:{anchorX:.5,anchorY:.4}},wagon:{stage1:{anchorX:.5,anchorY:.38},stage2:{anchorX:.5,anchorY:.36},stage3:{anchorX:.46,anchorY:.32},stage4:{anchorY:.35},stage5:{anchorY:.32},stage6:{anchorY:.22},stage7:{anchorY:.22},stage8:{anchorY:.2},stage9:{anchorY:.22},stage10:{anchorX:.5,anchorY:.28},stage11:{anchorX:.5,anchorY:.28}},woodgenerator:{stage1:{anchorX:.48,anchorY:.3},stage2:{anchorX:.48,anchorY:.3},stage3:{anchorX:.48,anchorY:.3}},crystal:{stage1:{anchorX:.46,anchorY:.32},stage2:{anchorX:.46,anchorY:.3},stage3:{anchorX:.46,anchorY:.24},stage4:{anchorX:.47,anchorY:.22}},stonechest:{stage1:{anchorX:.46,anchorY:.36},stage2:{anchorX:.46,anchorY:.32},stage3:{anchorX:.48,anchorY:.3}},wagonchest:{stage1:{anchorX:.48,anchorY:.36},stage2:{anchorX:.46,anchorY:.32},stage3:{anchorX:.48,anchorY:.28}},strawberry:{stage1:{anchorX:.46,anchorY:.4},stage2:{anchorX:.48,anchorY:.43},stage3:{anchorX:.5,anchorY:.41},stage4:{anchorX:.47,anchorY:.38},stage5:{anchorX:.47,anchorY:.3},stage6:{
anchorX:.45,anchorY:.43}},wagonsource:{stage1:{anchorX:.5,anchorY:.2},stage2:{anchorX:.5,anchorY:.2},stage3:{anchorY:.49,anchorY:.22},stage4:{anchorX:.49,anchorY:.35},stage5:{anchorX:.48,anchorY:.23},stage6:{anchorX:.51,anchorY:.34}},woodchest:{stage1:{anchorX:.46,anchorY:.36},stage2:{anchorX:.46,anchorY:.32},stage3:{anchorX:.48,anchorY:.28}},mushrooms:{stage1:{anchorX:.5,anchorY:.41},stage2:{anchorX:.5,anchorY:.37},stage3:{anchorX:.5,anchorY:.4},stage4:{anchorX:.5,anchorY:.33},stage5:{anchorX:.46,anchorY:.22},stage6:{anchorX:.5,anchorY:.42}},corn:{stage1:{anchorX:.46,anchorY:.4},stage2:{anchorX:.48,anchorY:.4},stage3:{anchorX:.5,anchorY:.4},stage4:{anchorX:.48,anchorY:.42},stage5:{anchorX:.47,anchorY:.33},stage6:{anchorX:.48,anchorY:.43}},stonegenerator:{stage1:{anchorX:.48,anchorY:.3},stage2:{anchorX:.5,anchorY:.26},stage3:{anchorX:.49,anchorY:.28}},wagongenerator:{stage1:{anchorX:.48,anchorY:.3},stage2:{anchorX:.33,anchorY:.22},stage3:{anchorX:.37,anchorY:.21}},elf:{stage1:{
anchorX:.44,anchorY:.3},stage2:{anchorX:.48,anchorY:.3},stage3:{anchorX:.44,anchorY:.28},stage4:{anchorX:.42,anchorY:.29},stage5:{anchorX:.37,anchorY:.28},stage6:{anchorX:.41,anchorY:.27},stage7:{anchorX:.4,anchorY:.24},stage8:{anchorX:.5,anchorY:.16}},warlock:{stage1:{anchorX:.48,anchorY:.38},stage2:{anchorX:.51,anchorY:.38},stage3:{anchorX:.48,anchorY:.38},stage4:{anchorX:.44,anchorY:.37},stage5:{anchorX:.44,anchorY:.35},stage6:{anchorX:.43,anchorY:.32},stage7:{anchorX:.41,anchorY:.3},stage8:{anchorX:.39,anchorY:.29},stage9:{anchorX:.53,anchorY:.16}},rubiesplant:{stage1:{anchorY:.22},stage2:{anchorX:.47,anchorY:.19},stage3:{anchorX:.51,anchorY:.17}},magicplant:{stage1:{anchorX:.47,anchorY:.52},stage2:{anchorX:.5,anchorY:.38},stage3:{anchorX:.51,anchorY:.35},stage4:{anchorX:.46,anchorY:.24},stage5:{anchorX:.45,anchorY:.23},stage6:{anchorX:.5,anchorY:.16},stage7:{anchorX:.45,anchorY:.22},stage8:{anchorX:.5,anchorY:.21},stage9:{anchorX:.54,anchorY:.2}},troll:{stage1:{anchorX:.5,
anchorY:.4},stage2:{anchorX:.5,anchorY:.4},stage3:{anchorX:.5,anchorY:.35},stage4:{anchorX:.5,anchorY:.33},stage5:{anchorX:.5,anchorY:.3},stage6:{anchorX:.48,anchorY:.31},stage7:{anchorX:.48,anchorY:.31},stage8:{anchorX:.47,anchorY:.3},stage9:{anchorX:.42,anchorY:.26},stage10:{anchorX:.56,anchorY:.18}},bamboochest:{stage1:{anchorX:.54,anchorY:.36},stage2:{anchorX:.54,anchorY:.34},stage3:{anchorX:.54,anchorY:.29}},bamboogenerator:{stage1:{anchorX:.43,anchorY:.28},stage2:{anchorY:.27},stage3:{anchorX:.54,anchorY:.24}},bamboosource:{stage1:{anchorY:.25},stage2:{anchorX:.55,anchorY:.17},stage3:{anchorY:.26},stage4:{anchorY:.24},stage5:{anchorY:.25},stage6:{anchorY:.3}},bamboo:{stage1:{anchorX:.5,anchorY:.38},stage2:{anchorX:.5,anchorY:.36},stage3:{anchorX:.46,anchorY:.32},stage4:{anchorY:.35},stage5:{anchorY:.32},stage6:{anchorY:.22},stage7:{anchorY:.22},stage8:{anchorY:.2},stage9:{anchorY:.22},stage10:{anchorX:.49,anchorY:.33},stage11:{anchorX:.49,anchorY:.33}},sapphiresource:{stage1:{
anchorX:.49,anchorY:.22},stage2:{anchorX:.53,anchorY:.26},stage3:{anchorY:.24},stage4:{anchorX:.48,anchorY:.25},stage5:{anchorY:.21},stage6:{anchorX:.49,anchorY:.27}},sapphiregenerator:{stage1:{anchorX:.56,anchorY:.15},stage2:{anchorX:.53,anchorY:.23},stage3:{anchorX:.48,anchorY:.17}},dragonmine:{stage1:{anchorX:.52,anchorY:.27}},decorator:{stage1:{anchorX:.46,anchorY:.37}},sapphire:{stage1:{anchorX:.48,anchorY:.36},stage2:{anchorX:.47,anchorY:.37},stage3:{anchorX:.42,anchorY:.37},stage4:{anchorX:.42,anchorY:.36},stage5:{anchorX:.46,anchorY:.33},stage6:{anchorX:.44,anchorY:.31},stage7:{anchorX:.47,anchorY:.29},stage8:{anchorX:.43,anchorY:.25},stage9:{anchorX:.45,anchorY:.24},stage10:{anchorX:.44,anchorY:.23},stage11:{anchorX:.49,anchorY:.35},stage12:{anchorX:.49,anchorY:.35}},sapphirechest:{stage1:{anchorX:.46,anchorY:.36},stage2:{anchorX:.48,anchorY:.32},stage3:{anchorX:.47,anchorY:.32}}},cleverapps.styles.UnitAnimations={worker:{stage5:{idle:1e3,idle1:100,idle2:100}},dwarf:{stage2:{
animation:100,animation2:100,idle:800}},king:{stage4:{animation:800,animation2:100,animation3:100}},bear:{stage7:{animation1:100,animation2:100,idle:800}},elf:{stage8:{animation:100,animation2:100,idle:800}},warlock:{stage9:{animation:100,animation2:100,idle:800}},troll:{stage10:{animation:100,animation2:100,idle:800}},wands:{stage1:{animation:100,animation2:50,animation3:50,idle:3600},stage2:{animation:100,idle:1800},stage3:{animation:100,idle:1800},stage4:{animation:100,idle:1800},stage5:{animation:100,idle:1800},stage6:{idle:1e3}},woodgenerator:{stage1:{animation:100,idle:1e3},stage2:{animation:100,idle:1e3},stage3:{animation:100,idle:1e3}},stonegenerator:{stage1:{animation:100,idle:1e3},stage2:{animation:100,idle:1e3},stage3:{animation:100,idle:1e3}},wagongenerator:{stage1:{animation:100,idle:1e3},stage2:{animation:100,idle:1e3},stage3:{animation:100,idle:1e3}},bamboogenerator:{stage1:{animation:100,idle:1e3},stage2:{animation:100,idle:1e3},stage3:{animation:100,idle:1e3}},
sapphiregenerator:{stage1:{animation:100,idle:1e3},stage2:{animation:100,idle:1e3},stage3:{animation:100,idle:1e3}}},cleverapps.styles.SCENE_MAX_WIDTH=3900,cleverapps.styles.HORIZONTAL_MODE_WIDTH=2e3,cleverapps.styles.COLORS=cleverapps.overrideColors(cleverapps.styles.COLORS,{TITLE_COLOR_YELLOW:new cc.Color(134,56,10,255),TITLE_SHADOW:new cc.Color(255,251,126,255)}),cleverapps.styles.DECORATORS=cleverapps.overrideStyles(cleverapps.styles.DECORATORS,{WHITE_TEXT_STROKE:{color:cleverapps.styles.COLORS.BLACK,size:2},TITLE_TEXT_SHADOW:{color:cleverapps.styles.COLORS.TITLE_SHADOW,direction:cc.size(0,-2),blur:1}}),cleverapps.overrideFonts(cleverapps.styles.FONTS,{DIALOGUE_PERSON_TITLE_TEXT:{size:44,color:cleverapps.styles.COLORS.LIGHT_TEXT_COLOR,stroke:cleverapps.styles.DECORATORS.LIGHT_TEXT_STROKE,shadow:cleverapps.styles.DECORATORS.LIGHT_TEXT_SHADOW},STARTER_PACK_REWARD:{size:30,color:cleverapps.styles.COLORS.LIGHT_TEXT_COLOR,stroke:cleverapps.styles.DECORATORS.LIGHT_TEXT_STROKE,
shadow:cleverapps.styles.DECORATORS.LIGHT_TEXT_SHADOW},SHOP_USER_GOLD_TEXT:{name:"nostroke"},ROW_PLAYER_TEXT:{size:30,color:cleverapps.styles.COLORS.LIGHT_TEXT_COLOR,shadow:cleverapps.styles.DECORATORS.LIGHT_TEXT_SHADOW},ROW_TEXT:{size:30,color:cleverapps.styles.COLORS.LIGHT_TEXT_COLOR,shadow:cleverapps.styles.DECORATORS.LIGHT_TEXT_SHADOW},BATTLEPASS_TITLE_TEXT:{size:50,color:cleverapps.styles.COLORS.DARK_TEXT_COLOR},BATTLEPASS_TIMER_TEXT:{size:45,color:cleverapps.styles.COLORS.LIGHT_TEXT_COLOR,stroke:cleverapps.styles.DECORATORS.LIGHT_TEXT_STROKE,shadow:cleverapps.styles.DECORATORS.LIGHT_TEXT_SHADOW},BATTLEPASS_PROGRESS_TEXT:{size:38,color:cleverapps.styles.COLORS.LIGHT_TEXT_COLOR,stroke:cleverapps.styles.DECORATORS.LIGHT_TEXT_STROKE,shadow:cleverapps.styles.DECORATORS.LIGHT_TEXT_SHADOW},BATTLEPASS_PROGRESS_IMAGE_TEXT:{size:42,color:cleverapps.styles.COLORS.LIGHT_TEXT_COLOR,stroke:cleverapps.styles.DECORATORS.LIGHT_TEXT_STROKE,shadow:cleverapps.styles.DECORATORS.LIGHT_TEXT_SHADOW},
BATTLEPASS_TICKET_TEXT:{size:45,color:cleverapps.styles.COLORS.LIGHT_TEXT_COLOR,stroke:cleverapps.styles.DECORATORS.LIGHT_TEXT_STROKE,shadow:cleverapps.styles.DECORATORS.LIGHT_TEXT_SHADOW},BATTLEPASS_TICKET_SMALL_TEXT:{size:30,color:cleverapps.styles.COLORS.LIGHT_TEXT_COLOR,stroke:cleverapps.styles.DECORATORS.LIGHT_TEXT_STROKE,shadow:cleverapps.styles.DECORATORS.LIGHT_TEXT_SHADOW},BATTLEPASS_BUTTON_TEXT:{size:60,color:cleverapps.styles.COLORS.LIGHT_TEXT_COLOR,stroke:cleverapps.styles.DECORATORS.LIGHT_TEXT_STROKE,shadow:cleverapps.styles.DECORATORS.LIGHT_TEXT_SHADOW},BATTLEPASS_DESCRIPTION_TEXT:{size:50,color:cleverapps.styles.COLORS.DARK_TEXT_COLOR},BATTLEPASS_REWARD_TEXT:{size:68,color:cleverapps.styles.COLORS.LIGHT_TEXT_COLOR,stroke:cleverapps.styles.DECORATORS.LIGHT_TEXT_STROKE,shadow:cleverapps.styles.DECORATORS.LIGHT_TEXT_SHADOW}}),cleverapps.overrideStyles(cleverapps.styles.GameScene,{startAnimation:{scale:1}}),cleverapps.overrideStyles(cleverapps.styles.NewVersionWindow,{
button:{width:220,height:90}}),cleverapps.overrideStyles(cleverapps.styles.RestartWindow,{button:{width:220,height:90}}),cleverapps.overrideStyles(cleverapps.styles.ReloadWindow,{padding:{x:0,y:80},Button:{width:220,height:90}}),cleverapps.overrideStyles(cleverapps.styles.BandButton,{width:120,height:266,position:{x:{align:"right",dx:-80},y:{align:"top",dy:40}},icon:{x:{align:"center"},y:{align:"bottom",dy:35}}}),cleverapps.overrideStyles(cleverapps.styles.LoadingScene,{showMessageOnRewrite:!0,barBg:{y:120,scale9:{width:1e3,height:41,padding:100}},bar:{x:0,y:0,scale9:{width:1e3,height:41,minWidth:30,padding:100}},message:{x:0,y:50}}),cleverapps.overrideStyles(cleverapps.styles.SceneControlButtonsView,{position:{x:{align:"right",dx:-78},y:{align:"top",dy:-33}}}),cleverapps.overrideStyles(cleverapps.styles.SceneControlButton,{scale:[.5,.7,1]}),cleverapps.styles.CommonButtons={width:200,height:74,contentOffset:{x:0,y:0},fitTo:!1,margin:4,padding:{left:20,right:20,top:5,bottom:10}},
cleverapps.overrideStyles(cleverapps.styles.SideBarSlot,{padding:{top:380,horizontal:110},wideModeScales:[.7,.9,1],margin:50}),cleverapps.overrideStyles(cleverapps.styles.PackWindow,{width:440,height:900,animation:{default:{idleDelay:-.7,dx:0,dy:50},starterPack0:{idleAnimation:"0_idle",introAnimation:"0_start"},starterPack:{idleAnimation:"1_idle",introAnimation:"1_start"},starterPack2:{idleAnimation:"2_idle",introAnimation:"2_start"}},rewards:{font:cleverapps.styles.FONTS.STARTER_PACK_REWARD,fontSize:50,delay:1.5,duration:.675,fitTo:{width:166},positions:{default:{gold:{x:144,y:-48},energy:{x:-126,y:-48},wands:{x:-256,y:15},coins:{x:10,y:18},worker:{x:-190,y:266}},starterPack:{gold:{x:215,y:270},energy:{x:300,y:12}},starterPack2:{gold:{x:214,y:270},energy:{x:258,y:-90},wands:{x:-210,y:-90},worker:{x:-196,y:266}}}},heroAnimation:{json:bundles.dialogues.jsons.king_json,animation:"dialogue_smile",scale:1.6,position:[{x:{align:"center",dx:-510},y:{align:"bottom",dy:70}},{x:{align:"center",
dx:-510},y:{align:"bottom",dy:70}},{x:{align:"left",dx:240},y:{align:"bottom",dy:70}}]}}),cleverapps.overrideStyles(cleverapps.styles.RewardWindow,{rewards:{padding:{y:80},dy:20}}),cleverapps.overrideStyles(cleverapps.styles.MinimalDialogue,{person:{offsetX:0,offsetY:0},maxWidth:1500,text:{arrow:void 0,padding:{fromWallX:0,x:90,y:120},bg:{offsetX:5,offsetY:-8,padding:{x:40,y:28}}}}),cleverapps.overrideStyles(cleverapps.styles.DialogueView,{widthPadding:8,positions:{bottom:{y:30}},text:{padding:{fromWallX:50,x:50,y:50},arrow:{img:bundles.dialogues.frames.arrow_png,y:{align:"top",dy:23},offsetX:"relative"}},persons:{default:{animation:"dialogue",idleAnimation:"idle",styles:{width:550,height:500,jsonPos:{x:{align:"center"},y:{align:"center"}}}}}}),cleverapps.overrideStyles(cleverapps.styles.DialoguePersonTitleView,{y:{align:"top",dy:0},text:{padding:{x:30,y:1},offset:{y:-1}}}),cleverapps.overrideStyles(cleverapps.styles.DialoguePersonView,{mobileScale:1,scale:1}),
cleverapps.overrideStyles(cleverapps.styles.DialogueView,{persons:{worker:cleverapps.overrideStyles(cleverapps.styles.DialogueView.persons.default,{styles:{title:"messages:Dialogue.person.worker",json:bundles.dialogues.jsons.worker_json,minimalJson:bundles.dialogues_minimal.jsons.worker_minimal_json,offsetY:-60}},!0),dwarf:cleverapps.overrideStyles(cleverapps.styles.DialogueView.persons.default,{styles:{title:"messages:Dialogue.person.dwarf",json:bundles.dialogues.jsons.dwarf_json,minimalJson:bundles.dialogues_minimal.jsons.dwarf_minimal_json,offsetY:-80}},!0),king:cleverapps.overrideStyles(cleverapps.styles.DialogueView.persons.default,{styles:{width:700,title:"messages:Dialogue.person.king",json:bundles.dialogues.jsons.king_json,minimalJson:bundles.dialogues_minimal.jsons.king_minimal_json,offsetY:-60}},!0),bear:cleverapps.overrideStyles(cleverapps.styles.DialogueView.persons.default,{styles:{width:700,title:"messages:Dialogue.person.bear",json:bundles.dialogues.jsons.bear_json,
minimalJson:bundles.dialogues_minimal.jsons.bear_minimal_json,offsetX:85,offsetY:10}},!0),elf:cleverapps.overrideStyles(cleverapps.styles.DialogueView.persons.default,{styles:{title:"messages:Dialogue.person.elf",json:bundles.dialogues.jsons.elf_json,minimalJson:bundles.dialogues_minimal.jsons.elf_minimal_json,offsetX:0,offsetY:40}},!0),warlock:cleverapps.overrideStyles(cleverapps.styles.DialogueView.persons.default,{styles:{title:"messages:Dialogue.person.warlock",json:bundles.dialogues.jsons.warlock_json,minimalJson:bundles.dialogues_minimal.jsons.warlock_minimal_json,offsetX:0,offsetY:-20}},!0),troll:cleverapps.overrideStyles(cleverapps.styles.DialogueView.persons.default,{styles:{title:"messages:Dialogue.person.troll",json:bundles.dialogues.jsons.troll_json,minimalJson:bundles.dialogues_minimal.jsons.troll_minimal_json,offsetY:-45}},!0)}}),cleverapps.overrideStyles(cleverapps.styles.DialogueView,{persons:{worker_right:cleverapps.overrideStyles(
cleverapps.styles.DialogueView.persons.worker,{position:"right"},!0),dwarf_right:cleverapps.overrideStyles(cleverapps.styles.DialogueView.persons.dwarf,{position:"right"},!0),king_right:cleverapps.overrideStyles(cleverapps.styles.DialogueView.persons.king,{position:"right"},!0),bear_right:cleverapps.overrideStyles(cleverapps.styles.DialogueView.persons.bear,{position:"right"},!0),elf_right:cleverapps.overrideStyles(cleverapps.styles.DialogueView.persons.elf,{position:"right"},!0),warlock_right:cleverapps.overrideStyles(cleverapps.styles.DialogueView.persons.warlock,{position:"right"},!0),troll_right:cleverapps.overrideStyles(cleverapps.styles.DialogueView.persons.troll,{position:"right"},!0)}}),cleverapps.overrideStyles(cleverapps.styles.ShadowView,{opacity:150}),cleverapps.extend(cleverapps.UI.Button.Images,{button_blue:{button_png:bundles.buttons.frames.blue_button_png,button_on_png:bundles.buttons.frames.blue_button_on_png,
button_off_png:bundles.buttons.frames.window_button_disabled_png},small_button_blue:{button_png:bundles.buttons.frames.small_blue_button,button_on_png:bundles.buttons.frames.small_blue_button_on,button_off_png:bundles.buttons.frames.small_blue_button},button_green:{button_png:bundles.buttons.frames.window_button_png,button_on_png:bundles.buttons.frames.window_button_on_png,button_off_png:bundles.buttons.frames.window_button_disabled_png},button_red:{button_png:bundles.buttons_main.frames.red_button,button_on_png:bundles.buttons_main.frames.red_button_on,button_off_png:bundles.buttons_main.frames.window_button_disabled_png}}),cleverapps.overrideStyles(cleverapps.styles.GiftContentView,{width:640,minHeight:160}),cleverapps.overrideStyles(cleverapps.styles.TransitionAnimation,{loading:!1}),cleverapps.overrideStyles(cleverapps.styles.ShopUserGoldView,{person:!1,bg:!1,items:{gold:{scale:.55,dy:-3}}}),cleverapps.overrideStyles(cleverapps.styles.SmallTileButton,{contentOffset:{x:0,y:2}}),
cleverapps.overrideStyles(cleverapps.styles.LargeTileButton,{contentOffset:{x:0,y:2}}),cleverapps.overrideStyles(cleverapps.styles.ProductPriceView,{regularFontOffsetY:-4}),cleverapps.overrideStyles(cleverapps.styles.ConfirmExitWindow,{width:700,animation:!1,text:{y:{align:"center",dy:50},width:700}}),cleverapps.override(cleverapps.styles.Row,{size:{width:760,height:82},placeBadges:{x:0,y:2},place:{x:85,y:4},avatar:{position:{x:164,y:3}},text:{x:370,y:2,width:300},reward:{x:556,y:0},prizes:[{banner:void 0,icon:bundles.merge.frames.first_place_prize_png,scale:.6,y:6},{banner:void 0,icon:bundles.merge.frames.second_place_prize_png,scale:.6,y:6},{banner:void 0,icon:bundles.merge.frames.third_place_prize_png,scale:.75,y:6}],data:{size:{width:140,height:60},position:{x:672,y:3},amount:{x:99,y:2,width:75}}});var MineSweeper=function(){BaseGame.call(this),this.width=MineSweeper.WIDTH,this.height=MineSweeper.HEIGHT,this.cellsToOpen=this.width*this.height-MineSweeper.CONFIG.b}
;MineSweeper.CONFIG={b:11,energy:14,coins:16,gold:2},MineSweeper.prototype=Object.create(BaseGame.prototype),(MineSweeper.prototype.constructor=MineSweeper).ELEMENT_OPENED=0,MineSweeper.ELEMENT_BOMB="b",MineSweeper.ELEMENT_OPENED_BOMB="bo",MineSweeper.ELEMENT_EXPLODED_BOMB="be",MineSweeper.ELEMENT_EMPTY="e",MineSweeper.ELEMENT_RUBY="gold",MineSweeper.ELEMENT_ENERGY="energy",MineSweeper.ELEMENT_COIN="coins",MineSweeper.WIDTH=8,MineSweeper.HEIGHT=7,MineSweeper.REPLAY_PRICE=20,MineSweeper.prototype.generateField=function(n,s){var e,t;this.reward={},this.board=[],this.bombs=[],this.prizes=[];var i=function(e,t){return Math.abs(e-s)<=1&&Math.abs(t-n)<=1},o=0;for(e=0;e<this.height;e++)for(t=0;t<this.width;t++)i(e,t)&&o++;var r=function(e,t){var n=[];for(var s in e)for(var i=0;i<e[s];i++)n.length<t&&n.push(s);for(;n.length<t;)n.push(MineSweeper.ELEMENT_EMPTY);return cleverapps.Random.randomSeed(),n=cleverapps.Random.shuffle(n)}(MineSweeper.CONFIG,this.width*this.height-o);for(this.board=[],
e=0;e<this.height;e++)for(this.board.push([]),t=0;t<this.width;t++)if(i(e,t))this.board[e].push(MineSweeper.ELEMENT_EMPTY);else{var a=r.pop();this.board[e].push(a),a===MineSweeper.ELEMENT_BOMB?this.bombs.push({col:t,row:e}):-1!==[MineSweeper.ELEMENT_RUBY,MineSweeper.ELEMENT_ENERGY,MineSweeper.ELEMENT_COIN].indexOf(a)&&this.prizes.push({col:t,row:e})}this.cellsToOpen=this.width*this.height-this.bombs.length,this.trigger("cellsToOpen",this.cellsToOpen)},MineSweeper.prototype.hasElement=function(e,t){return!(t<0||e<0||t>=this.height||e>=this.width)&&(!this.board||this.board[t][e]!==MineSweeper.ELEMENT_OPENED&&this.board[t][e]!==MineSweeper.ELEMENT_OPENED_BOMB&&this.board[t][e]!==MineSweeper.ELEMENT_EXPLODED_BOMB)},MineSweeper.prototype.getPrizeValue=function(e){return e===MineSweeper.ELEMENT_ENERGY?cleverapps.Random.random(3,5):e===MineSweeper.ELEMENT_COIN?cleverapps.Random.random(2,3):cleverapps.Random.random(1,2)},MineSweeper.prototype.openField=function(){this.trigger("openField"),
this.prizes.forEach(function(e){this.board[e.row][e.col]!==MineSweeper.ELEMENT_OPENED&&this.trigger("showPrize",{col:e.col,row:e.row,prize:{type:this.board[e.row][e.col]}})}.bind(this)),this.bombs.forEach(function(e){this.board[e.row][e.col]!==MineSweeper.ELEMENT_OPENED_BOMB&&this.trigger("showBomb",{col:e.col,row:e.row})}.bind(this))},MineSweeper.prototype.win=function(){this.board||this.generateField(0,0),this.openField(),this.trigger("win"),this.finish(),setTimeout(function(){this.trigger("victory")}.bind(this),1e3)},MineSweeper.prototype.explode=function(e){cleverapps.audio.fadeOut(),this.board[e.row][e.col]=MineSweeper.ELEMENT_EXPLODED_BOMB,e.callback=function(){this.openField(),this.trigger("lose")}.bind(this),this.trigger("bomb",e)},MineSweeper.prototype.open=function(e,t){if(!(t<0||e<0||t>=this.height||e>=this.width)&&(this.board||this.generateField(e,t),
this.board[t][e]!==MineSweeper.ELEMENT_OPENED&&this.board[t][e]!==MineSweeper.ELEMENT_OPENED_BOMB&&this.board[t][e]!==MineSweeper.ELEMENT_EXPLODED_BOMB)){if(this.board[t][e]===MineSweeper.ELEMENT_BOMB)return this.board[t][e]=MineSweeper.ELEMENT_OPENED_BOMB,this.pause(),this.trigger("open",{row:t,col:e,bomb:!0}),void setTimeout(function(){this.trigger("askContinue",{row:t,col:e})}.bind(this),500);var n=this.board[t][e];this.board[t][e]=MineSweeper.ELEMENT_OPENED;var s=this.countBombsNearby(e,t),i={row:t,col:e,bombs:s};if(this.cellsToOpen--,this.trigger("cellsToOpen",this.cellsToOpen),this.trigger("open",i),s||(this.open(e-1,t-1),this.open(e,t-1),this.open(e+1,t-1),this.open(e-1,t),this.open(e+1,t),this.open(e-1,t+1),this.open(e,t+1),this.open(e+1,t+1)),-1!==[MineSweeper.ELEMENT_RUBY,MineSweeper.ELEMENT_ENERGY,MineSweeper.ELEMENT_COIN].indexOf(n)){var o=this.getPrizeValue(n);this.trigger("prize",{col:e,row:t,prize:{type:n,amount:o}}),this.reward[n]=(this.reward[n]||0)+o}this.isFinished(
)&&this.win()}},MineSweeper.prototype.listNearby=function(e,t){for(var n=[],s=e-1;s<=e+1;s++)if(0<=s&&s<this.width)for(var i=t-1;i<=t+1;i++)0<=i&&i<this.height&&this.board[i][s]!==MineSweeper.ELEMENT_OPENED&&n.push({row:i,col:s});return n},MineSweeper.prototype.countBombsNearby=function(e,t){return this.listNearby(e,t).filter(function(e){return this.board[e.row][e.col]===MineSweeper.ELEMENT_BOMB||this.board[e.row][e.col]===MineSweeper.ELEMENT_OPENED_BOMB||this.board[e.row][e.col]===MineSweeper.ELEMENT_EXPLODED_BOMB}.bind(this)).length},MineSweeper.prototype.isFinished=function(){return 0===this.cellsToOpen};var MineGameScene=cleverapps.FixedWidthScene.extend({ctor:function(){this._super(cleverapps.Environment.SCENE_MINE),this.mineGame=new MineSweeper,this.createCellsToOpen(),this.createGameNode(),this.createGuideButton(),this.background.animation.replaceParentSamePlace(this.scene,{keepScale:!0}),cleverapps.eventLogger.logEvent(cleverapps.EVENTS.MINESWEEPER_START)},
createGuideButton:function(){var e=cleverapps.styles.MineGameScene.guideButton,t=new cleverapps.UI.Button({button_png:bundles.minesweeper.frames.guide_button_png,button_on_png:bundles.minesweeper.frames.guide_button_on_png,onClicked:function(){cleverapps.metha.display({focus:"GuideMine",action:function(e){new MineGuideWindow,cleverapps.metha.onceNoWindowsListener=e}.bind(this)})}.bind(this)});t.baseScale=e.wideModeScales[cleverapps.wideMode.mode],t.setScale(t.baseScale),t.setPositionRound(e),this.scene.addChild(t),cleverapps.UI.makeHideable(t,cleverapps.UI.VERTICAL),cleverapps.metha.registerControl("guideButton",t)},createGameNode:function(){var e=cleverapps.styles.MineGameScene;this.gameNode=new MineSweeperNode(this.mineGame),this.scene.addChild(this.gameNode),this.gameNode.setPositionRound(e.minigame),this.mineGame.on("win",this.gameFinish.bind(this),this),this.mineGame.on("lose",this.hideCellsToOpen.bind(this),this),this.mineGame.on("victory",this.hideCellsToOpen.bind(this),this),
this.mineGame.on("askContinue",this.askContinue.bind(this),this),this.mineGame.on("cellsToOpen",this.cellsToOpenChange.bind(this),this)},hideCellsToOpen:function(){this.cellsToOpenProgress.runAction(new cc.Sequence(new cc.FadeOut(.3),new cc.RemoveSelf))},createCellsToOpen:function(){var e=cleverapps.styles.MineGameScene.cellsToOpen;this.cellsToOpenProgress=new ScaledProgressBar({progress:bundles.minesweeper.frames.progressbar}),this.cellsToOpenProgress.setAnchorPoint(0,.5),this.cellsToOpenProgress.setDimension(e.width,this.cellsToOpenProgress.height),this.cellsToOpenProgress.setPositionRound(e),this.scene.addChild(this.cellsToOpenProgress),this.cellsToOpenProgress.setCascadeOpacityEnabled(!0),this.cellsToOpen=cleverapps.UI.generateImageText("0/"+this.mineGame.cellsToOpen,cleverapps.styles.FONTS.MINESWEEPER_PROGRESS),this.cellsToOpen.baseScale=this.cellsToOpen.scale,this.cellsToOpen.total=this.mineGame.cellsToOpen,this.cellsToOpen.setPositionRound(e.text),
this.cellsToOpenProgress.addChild(this.cellsToOpen)},cellsToOpenChange:function(e){var t=Math.floor((this.cellsToOpen.total-e)/this.cellsToOpen.total*100);this.cellsToOpenProgress.animatedChange(t-this.cellsToOpenProgress.getPercentage()),this.cellsToOpen.setString(this.cellsToOpen.total-e+"/"+this.cellsToOpen.total),this.cellsToOpen.stopAllActions(),this.cellsToOpen.runAction(new cc.Sequence(new cc.ScaleTo(.15,1.3*this.cellsToOpen.baseScale),new cc.ScaleTo(.15,1*this.cellsToOpen.baseScale)))},askContinue:function(t){var n=!1;cleverapps.metha.display({focus:"loseMine",actions:[function(e){new MineContinueWindow({reward:this.mineGame.reward,callback:function(){n=!0}}),cleverapps.metha.onceNoWindowsListener=e}.bind(this),function(e){n?(this.mineGame.resume(),e()):this.mineGame.explode(t)}.bind(this)]})},gameFinish:function(){cleverapps.eventLogger.logEvent(cleverapps.EVENTS.MINESWEEPER_VICTORY),cleverapps.metha.display({focus:"VictoryMine",actions:[function(e){setTimeout(e,1e3)},
function(e){new MineVictoryWindow({reward:this.mineGame.reward}),cleverapps.metha.onceNoWindowsListener=e}.bind(this)]})},getBackgroundStyles:function(){return{background:bundles.minesweeper.urls.background,animation:bundles.minesweeper.jsons.bg_json,scale:cleverapps.styles.MineGameScene.background.scale,parallax:!1}},getAudioStyles:function(){return{res:bundles.minesweeper.urls.mine_music,delay:1}},closeAction:function(){var n=this._super;cleverapps.metha.display({focus:"ConfirmMineExit",action:function(e){var t=!1;new ConfirmExitWindow({text:"messages:ConfirmExitWindow.text",reward:cleverapps.extend({gold:0,coins:0,energy:0},this.mineGame.reward),onAction:function(){t=!0}}),cleverapps.metha.onceNoWindowsListener=function(){e(),t&&n()}.bind(this)}.bind(this)})}});MineGameScene.BUNDLES=function(){return["minesweeper"]},cleverapps.styles.MineGameScene={minigame:{x:{align:"center"},y:{align:"center",dy:-67}},guideButton:{x:{align:"left",dx:65},y:{align:"top",dy:-30},wideModeScales:[.5,.7
,1]},cellsToOpen:{x:{align:"center",dx:4},y:{align:"bottom",dy:49},width:960,text:{x:{align:"center"},y:{align:"center",dy:1}}},background:{scale:1.14}};var MineSweeperNode=cc.Node.extend({ctor:function(e){this.game=e,this._super(),this.createFieldNode(),this.createScore(),this.createPerson(),this.game.on("open",this.open.bind(this),this),this.game.on("bomb",this.bomb.bind(this),this),this.game.on("prize",this.prize.bind(this),this),this.game.on("openField",this.openField.bind(this),this),this.game.on("showBomb",this.showBomb.bind(this),this),this.game.on("showPrize",this.showPrize.bind(this),this),this.game.on("resumed",this.onContinue.bind(this),this),this.game.on("win",this.onWin.bind(this),this),this.game.on("victory",this.onVictory.bind(this),this),this.game.on("lose",this.onLose.bind(this),this),this.controls()},onVictory:function(){this.hideTopBlock(),this.hideFieldNode(),this.person&&this.person.runAction(new cc.Sequence(new cc.MoveBy(.2,cc.p(0,
-this.person.height*this.person.scale)),new cc.RemoveSelf))},hideFieldNode:function(){this.fieldNode.runForAllChildren(function(e){e.setCascadeOpacityEnabled(!0)},{selfRun:!0}),this.fieldNode.runAction(new cc.Sequence(new cc.FadeOut(.3),new cc.RemoveSelf))},hideTopBlock:function(){this.topBlock.runAction(new cc.Sequence(new cc.FadeOut(.3),new cc.RemoveSelf))},onLose:function(){var e=cleverapps.styles.MineSweeperNode;this.hideTopBlock();var t=cleverapps.UI.generateOnlyText("messages:minesweeper.youLose",cleverapps.styles.FONTS.MINESWEEPER_TEXT_TOP);t.setPositionRound(e.loseText),this.addChild(t),t.setScale(0),t.runAction(new cc.Sequence(new cc.DelayTime(.3),new cc.ScaleTo(.3,1)));var n=cleverapps.UI.generateOnlyText("messages:minesweeper.youLoseContinue",cleverapps.styles.FONTS.MINESWEEPER_TEXT_EXIT);n.setPositionRound(e.exitText),this.addChild(n),n.setOpacity(0),n.runAction(new cc.Sequence(new cc.DelayTime(.5),new cc.FadeIn(.3))),cc.eventManager.addListener({
event:cc.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:!0,onTouchBegan:function(){this.exit||(this.exit=!0,cleverapps.metha.distract({focus:"backToMain",action:function(e){cleverapps.metha.gotoMainScene(e)}}))}.bind(this)},this)},onWin:function(){this.person&&this.person.setAnimation(0,"dialogue_smile",!0),cleverapps.audio.playSound(bundles.minesweeper.urls.victory_sfx)},onContinue:function(){this.person&&this.person.setAnimationAndIdleAfter("dialogue_smile_short","idle"),cleverapps.audio.playSound(bundles.minesweeper.urls.buy_continue_sfx),cleverapps.audio.playSound(bundles.minesweeper.urls.miner_good_sfx)},controls:function(){cc.eventManager.addListener({event:cc.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:!0,onTouchBegan:this.onTouchBegan.bind(this),onTouchEnded:this.onTouchEnded.bind(this)},this.fieldNode),cc.eventManager.addListener({event:cc.EventListener.MOUSE,onMouseMove:this.onMouseMove.bind(this)},this.fieldNode)},calculateIndex:function(e){
var t=this.fieldNode.convertTouchToNodeSpace(e),n=cc.rect(0,0,this.fieldNode.width,this.fieldNode.height);if(cc.rectContainsPoint(n,t)){var s=cleverapps.styles.MineSweeperNode.cell,i=Math.floor(t.x/s.width),o=Math.floor(t.y/s.height);return{row:Math.max(Math.min(o,MineSweeper.HEIGHT-1),0),col:Math.max(Math.min(i,MineSweeper.WIDTH-1),0)}}},onTouchBegan:function(e){return!(!this.game.running||this.game.paused)&&!!this.calculateIndex(e)},onTouchEnded:function(e){if(this.game.running&&!this.game.paused&&!this.hammerAnimation){var t=this.calculateIndex(e);if(t&&this.game.hasElement(t.col,t.row)){var n=cleverapps.styles.MineSweeperNode.hammer;this.hammerAnimation=!0;var s=new cleverapps.Spine(bundles.minesweeper.jsons.custom_cursor_json,n.scale),i=this.field[t.row][t.col];s.setPositionRound(n),s.setLocalZOrder(10),i.getParent().addChild(s),s.replaceParentSamePlace(this.getParent()),s.setCompleteListener(function(){s.runAction(new cc.Sequence(new cc.ScaleTo(.15,0),new cc.RemoveSelf))}),
s.setAnimation(0,"animation",!1),this.runAction(new cc.Sequence(new cc.DelayTime(.35),new cc.CallFunc(function(){this.hammerAnimation=!1,this.game.open(t.col,t.row)}.bind(this))))}}},onMouseMove:function(e){if(this.game.running&&!this.game.paused){var t=this.calculateIndex(e);if(t&&this.game.hasElement(t.col,t.row))if(void 0===this.index||100*t.row+t.col!==100*this.index.row+this.index.col)this.index=t,this.field[t.row][t.col].setAnimation(1,"hover",!1)}},createFieldNode:function(){this.fieldNode=this.createField(),this.addChild(this.fieldNode),this.setAnchorPoint2(),this.setContentSize2(this.fieldNode.getContentSize()),this.fieldNode.setPositionRound(this.width/2,this.height/2)},createScore:function(){var i=cleverapps.styles.MineSweeperNode;this.scores={};var e=[MineSweeper.ELEMENT_RUBY,MineSweeper.ELEMENT_ENERGY,MineSweeper.ELEMENT_COIN].map(function(e){var t=new cc.Sprite(this.getRewardIcon(e));t.setScale(i.topBlock.icon.scale);var n=cleverapps.UI.generateImageText("0",
cleverapps.styles.FONTS.MINESWEEPER_TEXT_TOP);n.setLocalZOrder(1),n.baseScale=n.scale;var s=new cleverapps.Layout([n,t],{direction:cleverapps.UI.HORIZONTAL,margin:i.topBlock.scoreMargin});return s.rewardText=n,(this.scores[e]=s).setCascadeOpacityEnabled(!0),s},this),t=new cleverapps.Layout(e,{direction:cleverapps.UI.HORIZONTAL,margin:i.topBlock.betweenScores});t.setCascadeOpacityEnabled(!0);var n=cleverapps.UI.generateOnlyText("messages:minesweeper.prize",cleverapps.styles.FONTS.MINESWEEPER_TEXT_TOP),s=this.topBlock=new cleverapps.Layout([t,n],{direction:cleverapps.UI.VERTICAL,margin:i.topBlock.margin});this.addChild(s),s.setCascadeOpacityEnabled(!0),s.setPositionRound(i.topBlock)},createField:function(){var n=cleverapps.styles.MineSweeperNode;this.field=[];for(var e=0;e<this.game.height;e++){for(var t=[],s=0;s<this.game.width;s++){var i=new cleverapps.Spine(bundles.minesweeper.jsons.minesweeper,n.cell.scale);i.setSkin((e+s)%2==0?"1":"2"),i.setAnimation(0,"idle",!0),t.push(i)}
this.field.push(t)}var o=this.field.map(function(e){return new cleverapps.Layout(e.map(function(e){var t=new cc.Node;return t.setAnchorPoint2(),t.setContentSize2(n.cell.width,n.cell.height),e.setPositionRound(t.width/2,t.height/2),t.addChild(e),t}),{direction:cleverapps.UI.HORIZONTAL})});return new cleverapps.Layout(o,{direction:cleverapps.UI.VERTICAL})},openField:function(){for(var e=0;e<this.field.length;e++)for(var t=0;t<this.field[e].length;t++){var n=this.field[e][t];this.game.hasElement(t,e)&&n.setAnimation(1,"boom",!1)}},bomb:function(e){var t=this.field[e.row][e.col];t.setLocalZOrder(1),t.replaceParentSamePlace(this),t.bomb.removeFromParent(),t.setAnimation(2,"bomb",!1),cleverapps.audio.playSound(bundles.minesweeper.urls.pickaxe_sfx),t.runAction(new cc.Sequence(new cc.DelayTime(1),new cc.CallFunc(function(){this.person&&this.person.setAnimationAndIdleAfter("dialogue_fail1","dialogue_fail"),cleverapps.audio.playSound(bundles.minesweeper.urls.bomb_sfx)}.bind(this)),
new cc.CallFunc(e.callback)))},showBomb:function(e){var t=this.field[e.row][e.col],n=t.bomb=new cleverapps.Spine(bundles.minesweeper.jsons.minesweeper);n.setLocalZOrder(t.getLocalZOrder()-1),t.getParent().addChild(n),n.setPositionRound(t.getPosition()),n.setAnimation(0,"bomb_idle",!1)},getRewardIcon:function(e){switch(e){case MineSweeper.ELEMENT_RUBY:return bundles.menubar.frames.coin_png;case MineSweeper.ELEMENT_ENERGY:return bundles.menubar.frames.life_png;case MineSweeper.ELEMENT_COIN:return bundles.menubar.frames.merge_coin_png}},createReward:function(e){var t=this.field[e.row][e.col],n=new cc.Sprite(this.getRewardIcon(e.prize.type));n.setScale(.9);var s=cleverapps.styles.MineSweeperNode,i=new cc.Node;return i.setAnchorPoint2(),i.setContentSize2(s.cell),i.addChild(n),n.setPositionRound(i.width/2,i.height/2),i.setPositionRound(t.getPosition()),i.setCascadeOpacityEnabled(!0),i.setLocalZOrder(1),t.getParent().addChild(i),i},showPrize:function(e){this.createReward(e).runAction(
new cc.Spawn(new cc.ScaleTo(1,1).easing(cc.easeBackOut()),new cc.FadeIn(1)))},prize:function(e){var t=this.createReward(e),n=cleverapps.styles.MineSweeperNode.prize;cleverapps.UI.jumpCollectAnimation(t,{jump:{dist:{x:2*Math.random()*n.dx-n.dx,y:-Math.random()*n.dy-3*n.dy}},collect:{speed:2600,target:this.scores[e.prize.type]},callback:function(){cleverapps.audio.playSound(bundles.minesweeper.urls.mine_vin_sfx),this.updateRewardAmount(e.prize)}.bind(this)})},createPerson:function(){if(cleverapps.wideMode.mode===cleverapps.WideMode.HORIZONTAL){var e=cleverapps.styles.MineSweeperNode.person,t=this.person=new cleverapps.Spine(bundles.dialogues.jsons.miner_json,e.scale);t.setAnchorPoint2(),t.setPositionRound(e),t.setAnimation(0,"idle",!0),t.setLocalZOrder(1),this.addChild(t)}},open:function(e){var t=this.field[e.row][e.col];if(t.setAnimation(1,"boom",!1),cleverapps.audio.playSound(bundles.minesweeper.urls.pickaxe_sfx),e.bombs){var n=cleverapps.UI.generateImageText(e.bombs,
cleverapps.styles.FONTS.MINESWEEPER_BOMBS);n.setColor(cleverapps.styles.MineSweeperNode.bombs["color"+e.bombs]),n.setPositionRound(cleverapps.styles.MineSweeperNode.bombs),t.getParent().addChild(n)}e.bomb?(this.showBomb(e),this.person&&this.person.setAnimationAndIdleAfter("dialogue_sad1","dialogue_sad"),cleverapps.audio.playSound(bundles.minesweeper.urls.miner_fail_sfx)):(this.person&&this.person.setAnimationAndIdleAfter("dialogue_smile_short","idle"),cleverapps.audio.playSound(bundles.minesweeper.urls.miner_good_sfx))},updateRewardAmount:function(e){this.rewardTimeouts||(this.rewardTimeouts={}),this.rewardTimeouts[e.type]||(this.rewardTimeouts[e.type]=0),this.rewardTimeouts[e.type]+=e.amount,this.scores[e.type].stopAllActions(),this.scores[e.type].runAction(new cc.Sequence(new cc.DelayTime(.15),new cc.CallFunc(function(e){this.scores[e].rewardText.setString(this.game.reward[e]),this.scores[e].rewardText.runAction(new cc.Sequence(new cc.ScaleTo(.1,
1.4*this.scores[e].rewardText.baseScale),new cc.ScaleTo(.25,1*this.scores[e].rewardText.baseScale)));var t=cleverapps.UI.animateDelta(this.rewardTimeouts[e],{});this.rewardTimeouts[e]=void 0,this.addChild(t),t.setPosition(t.getRelativeCoordinates(this.scores[e].rewardText)),t.y+=cleverapps.styles.MineSweeperNode.prize.delta}.bind(this,e.type))))}});cleverapps.overrideFonts(cleverapps.styles.FONTS,{MINESWEEPER_BOMBS:{name:"default",size:70,color:cleverapps.styles.COLORS.LIGHT_TEXT_COLOR,stroke:cleverapps.styles.DECORATORS.LIGHT_TEXT_STROKE,shadow:cleverapps.styles.DECORATORS.LIGHT_TEXT_SHADOW},MINESWEEPER_TEXT_TOP:{name:"default",size:55,color:cleverapps.styles.COLORS.LIGHT_TEXT_COLOR,stroke:cleverapps.styles.DECORATORS.LIGHT_TEXT_STROKE,shadow:cleverapps.styles.DECORATORS.LIGHT_TEXT_SHADOW},MINESWEEPER_PROGRESS:{name:"default",size:45,color:cleverapps.styles.COLORS.LIGHT_TEXT_COLOR,stroke:cleverapps.styles.DECORATORS.LIGHT_TEXT_STROKE,
shadow:cleverapps.styles.DECORATORS.LIGHT_TEXT_SHADOW},MINESWEEPER_TEXT_EXIT:{size:40,color:cleverapps.styles.COLORS.LIGHT_TEXT_COLOR,stroke:cleverapps.styles.DECORATORS.LIGHT_TEXT_STROKE,shadow:cleverapps.styles.DECORATORS.LIGHT_TEXT_SHADOW}}),cleverapps.styles.MineSweeperNode={topBlock:{margin:0,betweenScores:60,scoreMargin:17,x:{align:"center"},y:{align:"top",dy:240},icon:{scale:.7}},loseText:{x:{align:"center"},y:{align:"top",dy:200}},person:{scale:1.3,x:{align:"center",dx:-880},y:{align:"center",dy:-130}},prize:{dx:100,dy:50,margin:20,padding:0,delta:30},reward:{amount:{x:{align:"center",dx:20},y:{align:"bottom",dy:0}}},hammer:{x:{align:"center"},y:{align:"center"},scale:1.2},bombs:{x:{align:"center"},y:{align:"center",dy:-3},color1:new cc.Color(62,113,235,255),color2:new cc.Color(56,215,66,255),color3:new cc.Color(219,81,46,255),color4:new cc.Color(222,207,42,255),color5:new cc.Color(189,67,204,255),color6:new cc.Color(79,178,183,255),color7:new cc.Color(218,57,84,255),
color8:new cc.Color(100,49,221,255)},cell:{width:123,height:123,scale:1.22},exitText:{x:{align:"center"},y:{align:"bottom",dy:-125}}};var MineContinueWindow=Window.extend({onWindowLoaded:function(e){this.reward=cleverapps.extend({gold:0,coins:0,energy:0},e.reward),this.callback=e.callback,this._super({name:"minecontinuewindow",title:"messages:MineContinueWindow.title",content:this.createContent(),adjustToContent:!0,notCloseByTouchInShadow:!0}),this.addPerson()},addPerson:function(){if(cleverapps.wideMode.mode===cleverapps.WideMode.HORIZONTAL){var e=cleverapps.styles.MineContinueWindow.person,t=this.person=new cleverapps.Spine(bundles.dialogues.jsons.miner_json);t.setAnchorPoint2(),t.setPositionRound(e),t.setAnimation(0,"dialogue_sad",!0),t.setScale(e.scaleX,e.scaleY),t.setLocalZOrder(1),this.addChild(t);var n=t.height*e.scaleY;t.y-=n,t.runAction(new cc.MoveBy(.4,0,n).easing(cc.easeBackOut()))}},createContent:function(){var e=cleverapps.styles.MineContinueWindow,
t=cleverapps.UI.generateOnlyText("messages:MineContinueWindow.description",cleverapps.styles.FONTS.MINESWEEPERCONTINUE_TEXT);t.setAnchorPoint2(),t.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER),t.setDimensions(e.details.width,0);var n=this.createRewards();n.setAnchorPoint2();var s=new cleverapps.Layout([n,t],{direction:cleverapps.UI.VERTICAL,margin:e.details.margin,padding:e.details.padding});s.setAnchorPoint2(),s.setPositionRound(s.width/2,s.height/2);var i=cleverapps.UI.createScale9Sprite(bundles.minesweeper.frames.details_background,cleverapps.UI.Scale9Rect.TwoPixelXY);i.setContentSize(s.width,s.height),i.setAnchorPoint2(),i.addChild(s);var o=this.createButtons();return o.setAnchorPoint2(),new cleverapps.Layout([o,i],{direction:cleverapps.UI.VERTICAL,margin:e.margin,padding:e.padding})},createRewards:function(){var e=cleverapps.styles.MineContinueWindow.rewards,t=new cc.Sprite(bundles.reward_icons.frames.reward_gold_png),n=new cc.Sprite(bundles.reward_icons.frames.reward_coin_png)
,s=new cc.Sprite(bundles.reward_icons.frames.reward_energy_png),i=cleverapps.UI.generateImageText("x"+this.reward.gold,cleverapps.styles.FONTS.MINESWEEPERCONTINUE_REWARDS_TEXT),o=cleverapps.UI.generateImageText("x"+this.reward.coins,cleverapps.styles.FONTS.MINESWEEPERCONTINUE_REWARDS_TEXT),r=cleverapps.UI.generateImageText("x"+this.reward.energy,cleverapps.styles.FONTS.MINESWEEPERCONTINUE_REWARDS_TEXT);return new cleverapps.GridLayout([t,n,s,i,o,r],{columns:3,direction:cleverapps.GridLayout.TOP_TO_BOTTOM,margin:e.margin,padding:e.padding})},createButtons:function(){var e=cleverapps.styles.MineContinueWindow.buttons,t=cleverapps.UI.generateOnlyText("messages:MineContinueWindow.continue.caption",cleverapps.styles.FONTS.DARK_TEXT);t.setDimensions(e.width,0),t.setHorizontalAlignment(cc.TEXT_ALIGNMENT_CENTER);var n=cleverapps.UI.generateOnlyText("messages:MineContinueWindow.giveup.caption",cleverapps.styles.FONTS.DARK_TEXT);n.setDimensions(e.width,0),n.setHorizontalAlignment(
cc.TEXT_ALIGNMENT_CENTER);var s=new UseGoldButton({price:MineSweeper.REPLAY_PRICE,image:bundles.reward_icons.frames.gold_small_png,font:cleverapps.styles.FONTS.MINESWEEPERCONTINUE_BUTTON_TEXT,button_images:cleverapps.UI.Button.Images.button_green,onClicked:function(){this.callback(),this.close(),cleverapps.eventLogger.logEvent(cleverapps.EVENTS.MINESWEEPER_CONTINUE),cleverapps.eventLogger.logEvent(cleverapps.EVENTS.MINESWEEPER_CONTINUE_RUBY,{amount:MineSweeper.REPLAY_PRICE})}.bind(this)},{width:e.width,height:e.height}),i=new cleverapps.UI.Button({text:"messages:GiveUp",font:cleverapps.styles.FONTS.MINESWEEPERCONTINUE_BUTTON_TEXT,width:e.width,height:e.height,onClicked:this.close.bind(this),button_images:cleverapps.UI.Button.Images.button_red});return new cleverapps.GridLayout([t,n,s,i],{columns:2,direction:cleverapps.GridLayout.TOP_TO_BOTTOM,margin:e.margin,padding:e.padding})}});cleverapps.overrideFonts(cleverapps.styles.FONTS,{MINESWEEPERCONTINUE_TEXT:{size:35,
color:cleverapps.styles.COLORS.LIGHT_TEXT_COLOR,stroke:cleverapps.styles.DECORATORS.LIGHT_TEXT_STROKE,shadow:cleverapps.styles.DECORATORS.LIGHT_TEXT_SHADOW},MINESWEEPERCONTINUE_REWARDS_TEXT:{size:70,color:cleverapps.styles.COLORS.LIGHT_TEXT_COLOR,stroke:cleverapps.styles.DECORATORS.LIGHT_TEXT_STROKE,shadow:cleverapps.styles.DECORATORS.LIGHT_TEXT_SHADOW},MINESWEEPERCONTINUE_BUTTON_TEXT:{size:80,color:cleverapps.styles.COLORS.LIGHT_TEXT_COLOR,stroke:cleverapps.styles.DECORATORS.LIGHT_TEXT_STROKE,shadow:cleverapps.styles.DECORATORS.LIGHT_TEXT_SHADOW}}),cleverapps.styles.MineContinueWindow={margin:25,padding:{x:65,top:90,bottom:60},person:{scaleX:-1.4,scaleY:1.4,x:{align:"center",dx:800},y:{align:"center",dy:-330}},details:{width:760,margin:30,padding:{x:50,top:30,bottom:40}},rewards:{margin:{x:130,y:10}},buttons:{width:400,height:136,margin:{x:50,y:15},padding:{x:0,y:0}}};var MineVictoryWindow=Window.extend({onWindowLoaded:function(e){this.reward=e.reward,this._super({
name:"minevictorywindow",content:this.createContent(),noBackground:!0}),this.addPerson()},createContent:function(){var e=cleverapps.styles.MineVictoryWindow,t=new cleverapps.Spine(bundles.minesweeper.jsons.victory_animation,e.animation.scale);t.setAnchorPoint2(),t.setPositionRound(e.animation),t.setAnimationAndIdleAfter("emergence","idle");var n=new cc.Node;n.setAnchorPoint2(),n.setContentSize2(e.width,t.height*t.scaleY),n.addChild(t);var s=new RewardsListComponent(cleverapps.extend({gold:0,coins:0,energy:0},this.reward),{font:cleverapps.styles.FONTS.MINEVICTORY_REWARDS_TEXT,iconScale:e.rewards.scale,margin:e.rewards.margin});s.setAnchorPoint2(),s.setPositionRound(e.rewards),s.setScale(0),n.addChild(s),s.runAction(new cc.Sequence(new cc.DelayTime(.5),new cc.ScaleTo(.2,1)));var i=cleverapps.UI.generateOnlyText("messages:MineVictoryWindow.title",cleverapps.styles.FONTS.MINEVICTORY_TITLE_TEXT);return i.setAnchorPoint2(),i.setPositionRound(e.title),i.fitTo(e.title.width,e.title.height),
i.setVisible(!1),i.setScale(.8),n.addChild(i),i.runAction(new cc.Sequence(new cc.DelayTime(.3),new cc.Show,new cc.ScaleTo(.1,1.1),new cc.ScaleTo(.05,1))),cleverapps.UI.onClick(n,this.close.bind(this)),n},addPerson:function(){var e=cleverapps.styles.MineVictoryWindow.person,t=this.person=new cleverapps.Spine(bundles.dialogues.jsons.miner_json);t.setAnchorPoint2(),t.setPositionRound(e),t.setAnimation(0,"dialogue_smile",!0),t.setScale(e.scaleX,e.scaleY),t.setLocalZOrder(1),this.addChild(t);var n=t.height*e.scaleY;t.y-=n,t.runAction(new cc.Sequence(new cc.DelayTime(.3),new cc.MoveBy(.4,0,n).easing(cc.easeBackOut())))},onClose:function(){Game.currentMiniGame.reward=this.reward,cleverapps.metha.distract({focus:"backToMain",action:function(e){cleverapps.metha.gotoMainScene(e)}})}});cleverapps.overrideFonts(cleverapps.styles.FONTS,{MINEVICTORY_TITLE_TEXT:{size:70,color:cleverapps.styles.COLORS.LIGHT_TEXT_COLOR,stroke:cleverapps.styles.DECORATORS.LIGHT_TEXT_STROKE,
shadow:cleverapps.styles.DECORATORS.LIGHT_TEXT_SHADOW},MINEVICTORY_REWARDS_TEXT:{size:60,color:cleverapps.styles.COLORS.LIGHT_TEXT_COLOR,stroke:cleverapps.styles.DECORATORS.LIGHT_TEXT_STROKE,shadow:cleverapps.styles.DECORATORS.LIGHT_TEXT_SHADOW}}),cleverapps.styles.MineVictoryWindow={width:1e3,animation:{x:{align:"center"},y:{align:"center"},scale:1.3},rewards:{x:{align:"center",dx:-25},y:{align:"center",dy:235},margin:30,scale:1.4},title:{x:{align:"center",dx:-15},y:{align:"center",dy:580},width:400,height:100},person:{scaleX:-1.4,scaleY:1.4,x:{align:"center",dx:600},y:{align:"center",dy:-285}}};var MineGuideWindow=GuideWindow.extend({onWindowLoaded:function(e){this._super(e,{name:"MineGuideWindow"})},getWindowTitle:function(e){return"messages:Units.dragonmine.stage1.name"},getUpperArrowStyle:function(){return cleverapps.styles.MineGuideWindow.upperArrow},createFirstStage:function(e){var t=cleverapps.styles.MineGuideWindow.firstStage,n=this.createStageBackgroundWithText(1,
Messages.get("MineGuideWindow.firstStage")),s=this.addContainer(n,t.container);return this.addSprite(s,bundles.guidewindow.frames.guide_stage_1,t.image),n},createSecondStage:function(e){var t=cleverapps.styles.MineGuideWindow.secondStage,n=this.createStageBackgroundWithText(2,Messages.get("MineGuideWindow.secondStage")),s=this.addContainer(n,t.container);return this.addSprite(s,bundles.guidewindow.frames.guide_stage_2,t.image),n},createThirdStage:function(e){var t=cleverapps.styles.MineGuideWindow.thirdStage,n=this.createStageBackgroundWithText(3,Messages.get("MineGuideWindow.thirdStage")),s=this.addContainer(n,t.container);return this.addSprite(s,bundles.guidewindow.frames.yellow_light,t.light),this.addSprite(s,bundles.guidewindow.frames.guide_prize,t.image),n}});cleverapps.styles.MineGuideWindow={upperArrow:{x:{align:"center"},y:{align:"center",dy:260}},firstStage:{container:{x:{align:"center"},y:{align:"center"}},image:{x:0,y:100,scale:.9}},secondStage:{container:{x:{align:"center"
},y:{align:"center"}},image:{x:6,y:120,scale:.9}},thirdStage:{container:{x:{align:"center"},y:{align:"center"}},image:{x:15,y:100},light:{x:0,y:90}}},"undefined"!=typeof mobileOkReturned&&mobileOkReturned||(cc.game.onStart=function(){cleverapps.onStart()},cc.game.run());
//# sourceMappingURL=main-aa0c156ee2.js.map
